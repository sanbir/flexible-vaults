"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[95885],{23402:(e,t,n)=>{n.d(t,{u:()=>i});n(296540);const o={viewBox:"0 0 20 20",fittedViewBox:"3.14 6.87 13.7 6.27",svg:(0,n(474848).jsx)("path",{d:"M15.586 11.003V9.036l-3.902 3.903a.625.625 0 0 1-.884 0L7.735 9.874 4.2 12.967a.625.625 0 1 1-.822-.94l3.975-3.478.097-.071a.626.626 0 0 1 .756.1l3.035 3.034 3.486-3.484H12.71a.625.625 0 0 1 0-1.25h3.5a.626.626 0 0 1 .625.625v3.5a.625.625 0 0 1-1.25 0"})},i=(0,n(340498).wt)("lineUptrend",o,"default")},260917:(e,t,n)=>{n.d(t,{K:()=>o});n(898992),n(354520);class o extends(()=>n(757695))().Store{getInitialState(){return{missingFields:[]}}setMissingFields(e){this.setState({missingFields:e})}clearErrors(){this.setState({missingFields:[]})}hasError(e){return this.state.missingFields.includes(e)}clearError(e){this.setState({missingFields:this.state.missingFields.filter((t=>t!==e))})}}},362452:(e,t,n)=>{n.d(t,{G:()=>Se});var o=n(296540),i=()=>n(59226),r=()=>n(484714),s=()=>n(590526),a=()=>n(401497),l=()=>n(295633),d=()=>n(493552),c=()=>n(743246),u=()=>n(758256),m=()=>n(201980),g=()=>n(905470),p=()=>n(711517),h=()=>n(69708),f=()=>n(100622),M=()=>n(534177),k=()=>n(741198),b=()=>n(687879),v=()=>n(22673),x=()=>n(232615),y=()=>n(729368),w=()=>n(366437),j=()=>n(295304),C=()=>n(547149),S=()=>n(298182),Y=n(474848);function I(e){const{store:t,placeholder:n,style:i,minHeight:s,footer:l,disabled:d=!1,onChange:c,onFocus:u,onBlur:m}=e,g=(0,r().v3)(),p=(0,k().Q7)({textStore:t,initialFocus:!1}),h=(0,a().eP)(),M=(0,a().IS)((()=>({container:{display:"flex",flexDirection:"column",width:"100%",minHeight:s??56,cursor:"text",borderRadius:(null==i?void 0:i.borderRadius)??12,border:(null==i?void 0:i.border)??(p.isFocused?`1px solid ${f().Tj.border.primary}`:`1px solid ${f().Tj.border.secondary}`),backgroundColor:(null==i?void 0:i.backgroundColor)??("dark"===h?f().Tj.background.elevated:f().Tj.background.primary),transition:"border-color 0.2s ease-in-out, min-height 0.3s ease-in-out"},textContainer:{padding:(null==i?void 0:i.padding)??12,maxHeight:240,overflow:"auto",fontSize:14},placeholder:{opacity:1,cursor:"text"}})),[p.isFocused,i,s,h]),b=(0,o.useCallback)((e=>{var t;null===(t=e.preventDefault)||void 0===t||t.call(e);const n=x().default.state;"editing"===n.mode&&C().createAndCommit({userAction:"InlineTextInput.handleEnter",environment:g,canUndo:!0,perform:e=>{j().$D({environment:g,editorMode:"default",string:"\n",multiSelection:n.multiSelection,disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:e})}})}),[g]),v=(0,o.useRef)(null),I=(0,o.useCallback)((e=>{e.target===v.current&&p.focus()}),[p]),T=(0,o.useCallback)((()=>{p.focus(),null==u||u()}),[u,p]),A=(0,o.useCallback)((()=>{p.blur(),null==m||m()}),[m,p]);return(0,Y.jsxs)("div",{style:M.container,role:"textbox",ref:v,onPointerDown:I,children:[(0,Y.jsx)(y().A,{style:M.textContainer,placeholder:n,disabled:d,onChange:c,store:t,placeholderStyle:M.placeholder,pasteBehavior:"inline",disableSlashCommands:!0,disableEmbedMenu:!0,disableEmojiCommands:!1,disableComment:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableEnter:!1,onEnter:b,onTab:()=>!0,onUntab:()=>!0,onFocus:T,onBlur:A,disableMobileActionBar:!0,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!0,disableSuggestEdit:!0,inPageFind:w().Os.none,usePopupForMentionOnMobile:!0,disableMentions:!1,disabledMentionTypes:S().md}),l]})}var T=()=>n(312788),A=()=>n(383036),L=()=>n(127833),P=()=>n(250910),R=()=>n(807449),B=()=>n(695115),E=()=>n(546926),H=()=>n(26697),D=()=>n(890492),_=()=>n(81068),F=()=>n(663639),O=()=>n(736847),V=()=>n(584262),q=()=>n(415566),z=()=>n(419942),K=()=>n(177256),U=()=>n(492414);function N(e){const{onConvertToPage:t,isConverting:n=!1}=e,i=(0,r().v3)(),s=(0,h().tz)(),{navigate:l}=(0,o.useContext)(T().E),d=(0,a().IS)((()=>({peekIconButton:{position:"absolute",insetInlineEnd:20,top:60,height:28,width:28,marginTop:-4,pointerEvents:"auto",zIndex:10,opacity:1,transition:"opacity 150ms ease"}})),[]),c=(0,o.useCallback)((e=>{const{pageStore:t,...n}=e,o=(0,U().Ay)({store:t,pageVisitSource:V().y8.LinkInPage,...n});l({environment:i,url:o})}),[l,i]),u=(0,o.useCallback)((async e=>{const n=await t();n&&c({pageStore:n,...e})}),[t,c]);return(0,Y.jsx)(P().A,{popupType:L().nl.Popup,renderOrigin:e=>(0,Y.jsx)(H().m,{renderTooltip:()=>s.formatMessage({id:"workflow.agent.instructions.convertAndPeekTooltip",defaultMessage:"Edit in page"}),render:t=>(0,Y.jsx)(B().A,{...(0,A().A)(e,t),style:d.peekIconButton,ariaLabel:s.formatMessage({id:"workflow.agent.instructions.convertAndPeekMenu",defaultMessage:"Edit in page"}),icon:K().A,size:"lg",colorVariant:"tertiary",disabled:n})}),render:e=>{const t=[{key:"side-peek",render:e=>(0,Y.jsx)(_().A,{...e,icon:(0,Y.jsx)(R().I,{icon:K().A,colorVariant:"secondary"}),title:s.formatMessage({id:"workflow.agent.instructions.convertAndOpenInSidePeek",defaultMessage:"Side peek"})}),action:async()=>{await u({openInSidePeek:!0}),e.close()}},{key:"center-peek",render:e=>(0,Y.jsx)(_().A,{...e,icon:(0,Y.jsx)(R().I,{icon:q().q,colorVariant:"secondary"}),title:s.formatMessage({id:"workflow.agent.instructions.convertAndOpenInCenterPeek",defaultMessage:"Center peek"})}),action:async()=>{await u({openInCenterPeek:!0}),e.close()}},{key:"full-page",render:e=>(0,Y.jsx)(_().A,{...e,icon:(0,Y.jsx)(R().I,{icon:z().o,colorVariant:"secondary"}),title:s.formatMessage({id:"workflow.agent.instructions.convertAndOpenFullPage",defaultMessage:"Full page"})}),action:async()=>{await u({}),e.close()}}],n={key:"open-options",render:e=>(0,Y.jsx)(O().A,{...e}),items:t};return(0,Y.jsx)(D().A,{menuType:E().gu.Popup,width:200,children:(0,Y.jsx)(F().A,{type:F().O.Vertical,initialFocus:void 0,sections:[n]})})}})}n(898992),n(737550);var W=()=>n(782482),$=()=>n(110525),X=()=>n(908006),G=()=>n(611648),Z=()=>n(150669),J=()=>n(795732),Q=()=>n(247860),ee=()=>n(301809),te=()=>n(722101),ne=()=>n(384944),oe=()=>n(662453),ie=()=>n(851240),re=()=>n(614699),se=()=>n(376254),ae=()=>n(68465),le=()=>n(518489),de=()=>n(151838),ce=()=>n(642732),ue=()=>n(206051),me=()=>n(53436),ge=()=>n(326496);function pe(e){const{instructionsPageStore:t,showButton:n,isCompact:i=!1,onHandlePeek:s}=e,l=(0,r().v3)(),d=(0,h().tz)(),{navigate:c}=(0,o.useContext)(T().E),u=(0,a().IS)((()=>({actionBarWrapper:{position:"absolute",insetInlineEnd:i?8:16,top:i?4:16,pointerEvents:n?"auto":"none",zIndex:10,opacity:n?1:0,transition:"opacity 150ms ease"}})),[n,i]),m=(0,o.useCallback)((e=>{const n=(0,U().Ay)({store:t,pageVisitSource:V().y8.LinkInPage,...e});c({environment:l,url:n}),null==s||s()}),[t,c,l,s]);return(0,Y.jsx)("div",{style:u.actionBarWrapper,children:(0,Y.jsx)(me().E,{"aria-label":d.formatMessage({id:"workflow.agent.instructions.actionBar",defaultMessage:"Instructions actions"}),size:"lg",children:(0,Y.jsx)(ge().e,{onClick:()=>m({openInSidePeek:!0}),"aria-label":d.formatMessage({id:"workflow.agent.instructions.openInSidePeek",defaultMessage:"Open in side peek"}),iconLeading:K().A,tooltip:d.formatMessage({id:"workflow.agent.instructions.openInSidePeekTooltip",defaultMessage:"Open in side peek"})})})})}const he=256,fe=64,Me=16,ke=14,be=16,ve=4,xe=2,ye=2;function we(e){const{disableCollapsing:t=!1,disabled:n=!1,instructionsPageStore:i,isCompact:d=!1,isDatabaseAgent:c,onHandlePeek:u,showPeekButton:m=!0,showSelectableHoverMenuOverlay:g=!1,titlePlaceholder:p,workflowId:h}=e,f=(0,r().v3)(),{navigate:M}=(0,o.useContext)(T().E),[k,b]=(0,o.useState)(!1),y=(0,s().K8)((()=>(0,ae().ZE)(void 0,i)),[i]),w=(0,s().O$)(x().default),j=(0,s().O$)(ue().default),S=(0,s().uB)(void 0,Z().A),I=(0,s().uB)(void 0,Q().A);(0,ie().Ay)({pageStore:i,pageVisitStore:I});const A=(0,s().K8)((()=>{if("editing"===w.mode){var e;const t=w.multiSelection.start.store;let n=t.getRecordStoreUIRoot();if(!(n instanceof l().B)){let e,o=t.getRecordStoreUIParent();for(;null!=o;)o instanceof l().B&&(e=o),o=o.getRecordStoreUIParent();e&&(n=e)}if((null===(e=n)||void 0===e?void 0:e.id)===i.id)return!0}if(j.stores.length>0){if(j.stores.some((e=>{var t;let n=e.getRecordStoreUIRoot();if(!(n instanceof l().B)){let t,o=e.getRecordStoreUIParent();for(;null!=o;)o instanceof l().B&&(t=o),o=o.getRecordStoreUIParent();t&&(n=t)}return(null===(t=n)||void 0===t?void 0:t.id)===i.id})))return!0}return!1}),[w,j,i]),{pageInstructionsLastEditedTime:L,isLastAuthorThisUser:P}=(0,s().K8)((()=>({pageInstructionsLastEditedTime:i.getLastEditedTime(),isLastAuthorThisUser:i.getLastEditedById()===f.currentUser.id})),[i,f.currentUser.id]),R=(0,o.useRef)(void 0),B=(0,o.useRef)(!1),E=(0,o.useRef)(!1);(0,o.useEffect)((()=>{A&&!E.current&&(B.current=!1),E.current=A}),[A]),(0,o.useEffect)((()=>{B.current=!1}),[h]),(0,o.useEffect)((()=>{const e=R.current;void 0!==e?L<=e||(R.current=L,void 0!==h&&!B.current&&P&&((0,v().VB)({environment:f,workflowId:h,isDatabaseAgent:c}),B.current=!0)):R.current=L}),[f,A,c,L,h,P]);const H=(0,s().K8)((()=>{const e=i.getContentStores();if(e.length>1)return!0;if(1===e.length){const t=e[0].getTitleValue();return t.length>0&&t.some((e=>""!==e[0].trim()))}return!1}),[i]),D=A||H||t,_=(0,o.useCallback)((()=>b(!0)),[]),F=(0,o.useCallback)((()=>b(!1)),[]),O=(0,o.useCallback)((async e=>{if(e.target!==e.currentTarget)return;const t=i.getContentStores(),n=t.length>0?t[t.length-1]:void 0;if(n&&function(e){if(!e)return!1;return!0===je[e]}(n.getType())){const e=C().createAndCommit({userAction:"InstructionsComposer.handleContainerClick.ensureEmptyBlock",environment:f,canUndo:!0,perform:e=>{const t=ne().Wv({environment:f,type:"text",inMemoryRecordCache:i.inMemoryRecordCache,transaction:e,spaceId:i.pointer.spaceId});return te().BC({parentStore:i.getContentStore(),appendStore:t,transaction:e}).childStore}}).performResult;return await X().default.afterNextFlush(),(0,le().h)({environment:f,store:e}),void(0,ee().e)({store:e.getBlockTitleStore()})}const{clientX:o,clientY:r,target:s}=e;if(!(s instanceof Element))return;const a=(0,ce().E)(o,r,s);if(a&&a.selectable.props.onEditText){const e=r<=a.rect.top;C().createAndCommit({userAction:"InstructionsComposer.handleContainerClick.editText",environment:f,canUndo:!0,perform:t=>{var n,i;null===(n=(i=a.selectable.props).onEditText)||void 0===n||n.call(i,{isAtStartOfLine:o<=a.rect.left,isAtStartOfContainer:e,isClick:!0,transaction:t})}})}else{const e=t[0];if(!e)return;(0,le().h)({environment:f,store:e}),await X().default.afterNextFlush();const n=e.getBlockTitleStore();if(!n)return;(0,ee().e)({store:n})}}),[f,i]),V=d?xe:ke,q=d?ye:be,z=d?ve:Me,K=(0,a().IS)((()=>({composerContainer:{paddingTop:V,paddingInlineStart:z,paddingBottom:q,paddingInlineEnd:z,maxHeight:D?he:fe,overflow:D?"hidden":"visible",position:"relative",transition:"max-height 300ms ease"},scroller:{pointerEvents:"none",marginTop:0,marginBottom:0,marginInline:-z,paddingTop:0,paddingBottom:0,paddingInline:z,maxHeight:D?he-V-q:fe-V-q,transition:"max-height 300ms ease"},pageViewBlockWrapper:{pointerEvents:"auto"}})),[V,z,q,D]),U=(0,o.useCallback)((e=>{M({environment:f,url:e})}),[f,M]),N=(0,o.useCallback)((e=>{A&&e.preventDefault&&e.preventDefault()}),[A]);return(0,Y.jsx)($().B,{value:U,children:(0,Y.jsxs)("div",{style:K.composerContainer,onClick:O,onMouseMove:_,onMouseLeave:F,children:[m?(0,Y.jsx)(pe,{instructionsPageStore:i,isCompact:d,onHandlePeek:u,showButton:k}):void 0,(0,Y.jsx)(W().N,{debugName:"InstructionsComposer",capture:A,onSelectAll:N,children:(0,Y.jsx)(de().A,{store:i,isDefaultContainer:!0,isRootContainer:!0,disableRectangularSelection:!0,render:({selectableEvents:e,selectableHoverMenuOverlay:t})=>(0,Y.jsxs)(se().H,{type:G().A.Y,style:K.scroller,store:S,...e,children:[g?t:void 0,(0,Y.jsx)("div",{style:K.pageViewBlockWrapper,children:(0,Y.jsx)(re().Ay,{context:J().R.WorkflowInstructionsInInlineComposer,store:i,paddingBottom:20,disabled:n,disableTopControls:!0,titlePlaceholder:p,forceSelectTitleOnMount:!1})}),y?(0,Y.jsx)(oe().H7,{scrollerStore:S}):void 0]})})})]})})}const je={page:!0,collection_view:!0,collection_view_page:!0,external_object_instance_page:!0,form:!0,workflow:!0,code:!0,callout:!0,quote:!0,image:!0,video:!0,audio:!0,file:!0,pdf:!0,embed:!0,bookmark:!0,tweet:!0,drive:!0,gist:!0,invision:!0,mixpanel:!0,framer:!0,maps:!0,figma:!0,loom:!0,typeform:!0,codepen:!0,whimsical:!0,miro:!0,abstract:!0,sketch:!0,excalidraw:!0,replit:!0,hex:!0,deepnote:!0,drawing:!0,divider:!0,equation:!0,table_of_contents:!0,link_to_page:!0,link_to_collection:!0,breadcrumb:!0,ai_block:!0,transcription:!0};const Ce=(0,h().YK)({instructionsPlaceholder:{id:"workflow.agent.instructions.placeholder",defaultMessage:"What does your agent do?"},instructionsPageTitle:{id:"workflow.agent.instructions.pageTitle",defaultMessage:"Instructions"}});function Se(e){const{disableCollapsing:t,disabled:n,isCompact:x,minHeight:y=175,onHandlePeek:w,showInstructionsPeekButton:j=!0,workflowStore:C,workflowValidationErrorStore:S}=e,T=(0,h().tz)(),A=(0,r().v3)(),[L,P]=(0,o.useState)(!1),R=(0,o.useRef)(!1),B=(0,s().K8)((()=>{var e,t,n;if(C.table!==c().C0)return null===(n=C.getData())||void 0===n?void 0:n.instructions;return(null===(e=C.getDraftData())||void 0===e?void 0:e.instructions)??(null===(t=C.getData())||void 0===t?void 0:t.instructions)}),[C]),E=(0,o.useMemo)((()=>{if(C.table!==u().U6){if(C.table!==c().C0)(0,M().HB)(C);else if(void 0===B||(0,p().Zv)(B)){return C.getDataStore().getKeyStore("instructions")}}else if((0,p().Zv)(B)){return C.getDataStore().getKeyStore("instructions")}}),[C,B]),H=(0,s().K8)((()=>!!E&&(0,k().eo)(E)),[E]),D=(0,o.useMemo)((()=>{if((0,p().ap)(B))return l().B.createChildStore(C,B)}),[B,C]),_=(0,o.useMemo)((()=>(0,p().ap)(B)?"":(0,m().q4_)((0,p().rr)(B))),[B]),F=(0,o.useMemo)((()=>D||_.length>0||H?y??175:0),[D,_.length,H,y]),O=(0,a().IS)((()=>({instructionsInput:{backgroundColor:"transparent",padding:"18px 20px",border:"none"},readOnlyContainer:{minHeight:F,padding:"18px 20px",borderRadius:12,borderWidth:1,borderStyle:"solid",borderColor:f().Tj.border.secondary,backgroundColor:f().Tj.background.primary,display:"flex",alignItems:"center"}})),[F]),V=(0,o.useCallback)((()=>{S.clearError("instructions")}),[S]),q=(0,o.useCallback)((()=>{if(C.table!==c().C0)return;if(R.current)return;R.current=!0;const e=C.getData();(0,v().VB)({environment:A,workflowId:C.id,isDatabaseAgent:(0,g().uP)(e)})}),[A,C]),z=(0,o.useCallback)((()=>{V(),q()}),[V,q]),K=C.table===c().C0&&!n&&Boolean(E),U=T.formatMessage(Ce.instructionsPlaceholder),W=(0,o.useCallback)((async()=>{if(C.table===c().C0&&K&&!L){P(!0);try{const e=await b().ensureInstructionsPage({workflowStore:C,environment:A,title:T.formatMessage(Ce.instructionsPageTitle),draftInstructions:null==E?void 0:E.getValue()});return V(),e}finally{P(!1)}}}),[K,V,A,T,L,C,E]),$=(0,i().X)("custom_agent_page_instructions"),X=(0,s().K8)((()=>(0,g().uP)(C.getData())),[C]);return D?(0,Y.jsx)(we,{disableCollapsing:t,disabled:n,instructionsPageStore:D,isCompact:x,isDatabaseAgent:X,onHandlePeek:w,showPeekButton:j,titlePlaceholder:U,workflowId:C.table===c().C0?C.id:void 0}):(0,Y.jsxs)(Y.Fragment,{children:[E?(0,Y.jsx)(I,{placeholder:U,store:E,onChange:z,style:O.instructionsInput,disabled:n,minHeight:F}):(0,Y.jsx)("div",{style:O.readOnlyContainer,children:(0,Y.jsx)(d().D,{children:_||U})}),$&&K?(0,Y.jsx)(N,{isConverting:L,onConvertToPage:W}):void 0]})}},463620:(e,t,n)=>{n.d(t,{u:()=>m});n(296540);var o=()=>n(242422),i=()=>n(590526),r=()=>n(401497),s=()=>n(249046),a=()=>n(406094),l=()=>n(493552),d=()=>n(69708),c=()=>n(100622),u=n(474848);function m(e){const{workflowStore:t,onRequestIncrease:n,minified:m=!1}=e,g=(0,r().IS)((()=>({container:{paddingTop:14,paddingInlineEnd:16,paddingBottom:14,paddingInlineStart:20,backgroundColor:c().Tj.background.primary,border:`1px solid ${c().Tj.border.primary}`,borderRadius:14,marginBlock:12},containerMinified:{paddingTop:12,paddingInlineEnd:12,paddingBottom:12,paddingInlineStart:12,backgroundColor:c().Tj.background.primary,border:`1px solid ${c().Tj.border.primary}`,borderRadius:12,marginBlock:8}})),[]),p=(0,i().K8)((()=>{const e=t.getDraftData(),n=null==e?void 0:e.usage_limit,i=o().default.getConfig({configName:"custom_agent_sub_features"}),r=(null==i?void 0:i.default_run_limit)??100;return"runLimit"===(null==n?void 0:n.type)?n.maximum:r}),[t]),h=m?g.containerMinified:g.container,f=m?"captionMedium":"bodyMedium",M=m?"sm":"md",k=(0,u.jsxs)(s().Ye,{alignItems:"center",gap:4,children:[(0,u.jsx)(l().D,{styleKey:f,colorVariant:"primary",children:(0,u.jsx)(d().sA,{id:"workflow.runLimitReached.header",defaultMessage:"Run limit reached"})}),(0,u.jsx)(l().D,{styleKey:f,colorVariant:"secondary",children:(0,u.jsx)(d().sA,{id:"workflow.runLimitReached.count",defaultMessage:" · {maxRuns} / {maxRuns}",values:{maxRuns:p}})})]}),b=(0,u.jsx)(l().D,{styleKey:"captionRegular",colorVariant:"secondary",children:(0,u.jsx)(d().sA,{id:"workflow.runLimitReached.requestMessage",defaultMessage:"Request an increase to continue using this agent"})}),v=(0,u.jsx)(a().A,{onClick:n,size:M,children:(0,u.jsx)(d().sA,{id:"workflow.runLimitReached.requestIncrease",defaultMessage:"Request"})});return m?(0,u.jsxs)(s().wt,{gap:8,style:h,children:[k,b,v]}):(0,u.jsxs)(s().Ye,{alignItems:"center",justifyContent:"space-between",gap:12,style:h,children:[(0,u.jsxs)(s().wt,{gap:4,children:[k,b]}),v]})}},680514:(e,t,n)=>{n.d(t,{dr:()=>c,xX:()=>u});var o=()=>n(463086),i=()=>n(234459),r=()=>n(384944),s=()=>n(140992),a=()=>n(965454),l=()=>n(547149);const d=new Map;function c(e){if(e)return d.get(e)}function u(e){var t,n;const{threadStore:c,environment:u,spaceStore:m,userStore:g}=e;if(!c||!(0,a().Ci)(c))return c;const p=u.defaultRecordCache.inMemoryRecordCache;for(const o of p.cacheOverrides.slice())o.name===a().Ll&&p.removeCacheOverride(o);const h=c.getTranscript(),f=c.getParentId(),M=c.getParentTable(),k=null===(t=c.getData())||void 0===t?void 0:t.workflow_id,b=c.getType(),v=null===(n=c.getData())||void 0===n?void 0:n.title,x=c.getSpaceId()??m.id,{performResult:y}=l().createAndCommit({userAction:"databaseAgent.persistTemporaryThread",environment:u,canUndo:!0,perform:e=>{const t=(0,s().aP)({environment:u,spaceStore:m,userStore:g,transcript:h,transaction:e,threadId:c.id,workflowId:k,threadType:b});return f&&M&&r().zv({store:t,transaction:e,data:{parent_id:f,parent_table:M,space_id:x}}),v&&r().zv({store:t.getDataStore(),transaction:e,data:{title:v}}),t}});var w;return w=c.id,d.delete(w),y??o().E.createChildStore(m,{id:c.id,spaceId:x,table:i().To})}},724833:(e,t,n)=>{n.d(t,{h:()=>L});n(581454);var o=n(296540),i=()=>n(242422),r=()=>n(484714),s=()=>n(590526),a=()=>n(401497),l=()=>n(792057),d=()=>n(394888),c=()=>n(128933),u=()=>n(249046),m=()=>n(250910),g=()=>n(807449),p=()=>n(98126),h=()=>n(546926),f=()=>n(406094),M=()=>n(631524),k=()=>n(160432),b=()=>n(493552),v=()=>n(890492),x=()=>n(81068),y=()=>n(663639),w=()=>n(736847),j=()=>n(324254),C=()=>n(23402),S=()=>n(69708),Y=()=>n(100622),I=()=>n(687879),T=n(474848);const A=[100,250,500,1e3,1e4,1e5];function L(e){const{workflowStore:t,isOpen:n,onClose:L}=e,P=(0,r().v3)(),R=(0,S().tz)(),B=(0,s().K8)((()=>{const e=i().default.getConfig({configName:"custom_agent_sub_features"});return(null==e?void 0:e.available_run_increases)??A}),[]),E=(0,o.useMemo)((()=>Array.isArray(B)?B:A),[B]),[H,D]=(0,o.useState)(E[0]??100),[_,F]=(0,o.useState)(""),[O,V]=(0,o.useState)(!1),q=(0,a().IS)((()=>({container:{padding:32,width:480},dropdownButton:{width:"100%",height:36,paddingInline:12,backgroundColor:Y().Tj.background.primary,border:`1px solid ${Y().Tj.border.secondary}`,borderRadius:8,fontSize:14,color:Y().Tj.text.primary,display:"flex",alignItems:"center",justifyContent:"space-between"},chevronIcon:{flexShrink:0},reasonInput:{width:"100%",minHeight:120,padding:12,backgroundColor:Y().Tj.background.primary,border:`1px solid ${Y().Tj.border.secondary}`,borderRadius:8,resize:"vertical",fontSize:14,color:Y().Tj.text.primary}})),[]),z=(0,o.useCallback)((async()=>{if(!O){V(!0);try{await(0,I().requestWorkflowLimitIncrease)({environment:P,workflowStore:t,amount:H,reason:_}),c().D6({label:R.formatMessage({defaultMessage:"Request sent successfully",id:"workflows.requestLimitModal.success"})}),L()}catch(e){l().f1(R.formatMessage({defaultMessage:"Failed to request limit increase",id:"workflows.requestLimitModal.error"}))}finally{V(!1)}}}),[P,t,H,_,R,L,O]);return(0,T.jsx)(d().s,{isOpen:n,onDismiss:L,render:()=>(0,T.jsxs)(u().wt,{gap:32,style:q.container,children:[(0,T.jsxs)(u().wt,{alignItems:"center",gap:12,children:[(0,T.jsx)(g().I,{icon:C().u,size:48,colorVariant:"secondary"}),(0,T.jsx)(b().D,{styleKey:"titleSemibold",colorVariant:"primary",children:(0,T.jsx)(S().sA,{id:"workflows.requestLimitModal.title",defaultMessage:"Need additional runs?"})}),(0,T.jsx)(b().D,{styleKey:"bodyRegular",colorVariant:"secondary",children:(0,T.jsx)(S().sA,{id:"workflows.requestLimitModal.subtitle",defaultMessage:"Request to add more runs for this agent"})})]}),(0,T.jsxs)(u().wt,{gap:12,children:[(0,T.jsx)(b().D,{styleKey:"bodyMedium",colorVariant:"primary",children:(0,T.jsx)(S().sA,{id:"workflows.requestLimitModal.amountLabel",defaultMessage:"Amount"})}),(0,T.jsx)(m().A,{popupType:m().z.Popup,alignmentToOrigin:"start",placementToOrigin:"bottom",originGap:4,renderOrigin:e=>(0,T.jsxs)(M().p,{...e,style:q.dropdownButton,hoveredStyle:{background:"transparent"},pressedStyle:{background:"transparent"},children:[(0,T.jsx)("span",{children:R.formatMessage({id:"workflows.requestLimitModal.runsOption",defaultMessage:"{amount} runs"},{amount:R.formatNumber(H)})}),(0,T.jsx)(g().I,{icon:j().arrowChevronSingleDownSmallIcon,size:"sm",colorVariant:"tertiary",style:q.chevronIcon})]}),render:({close:e})=>(0,T.jsx)(v().A,{menuType:h().gu.Popup,children:(0,T.jsx)(y().A,{initialFocus:0,type:y().O.Vertical,sections:[{key:"amount-options",render:e=>(0,T.jsx)(w().A,{...e}),items:E.map((t=>({key:t,action:()=>{D(t),e()},render:e=>(0,T.jsx)(x().A,{...e,title:R.formatMessage({id:"workflows.requestLimitModal.runsOption",defaultMessage:"{amount} runs"},{amount:R.formatNumber(t)}),buttonStyle:{width:"100%",justifyContent:"flex-start",textAlign:"start"}})})))}]})})})]}),(0,T.jsxs)(u().wt,{gap:12,children:[(0,T.jsx)(b().D,{styleKey:"bodyMedium",colorVariant:"primary",children:(0,T.jsx)(S().sA,{id:"workflows.requestLimitModal.reasonLabel",defaultMessage:"Reason for increase"})}),(0,T.jsx)("textarea",{style:q.reasonInput,placeholder:R.formatMessage({id:"workflows.requestLimitModal.reasonPlaceholder",defaultMessage:"e.g., higher task volume, ongoing projects"}),value:_,onChange:e=>F(e.target.value)})]}),(0,T.jsxs)(u().wt,{gap:12,children:[(0,T.jsx)(k().A,{onClick:z,disabled:O||!_.trim(),colorPalette:"blue",size:"lg",style:{width:"100%"},children:O?(0,T.jsxs)(u().Ye,{alignItems:"center",gap:8,children:[(0,T.jsx)(p().k,{size:"sm"}),(0,T.jsx)(S().sA,{id:"workflows.requestLimitModal.submitting",defaultMessage:"Requesting..."})]}):(0,T.jsx)(S().sA,{id:"workflows.requestLimitModal.request",defaultMessage:"Request"})}),(0,T.jsx)(f().A,{onClick:L,disabled:O,size:"lg",style:{width:"100%"},children:(0,T.jsx)(S().sA,{id:"workflows.requestLimitModal.cancel",defaultMessage:"Cancel"})})]})]})})}},741198:(e,t,n)=>{n.d(t,{Jc:()=>h,Q7:()=>p,eo:()=>f});var o=n(296540),i=()=>n(908006),r=()=>n(484714),s=()=>n(852507),a=()=>n(590526),l=()=>n(380745),d=()=>n(755125),c=()=>n(232615),u=()=>n(186441),m=()=>n(301421),g=()=>n(260850);function p(e){const{textStore:t,initialFocus:n}=e,i=(0,r().v3)(),c=(0,a().K8)((()=>f(t)),[t]),u=(0,o.useCallback)((()=>{h(t)}),[t]),g=(0,o.useCallback)((()=>{!function(e){const{environment:t,textStore:n}=e;if(!f(n))return;const o=m().n.findNodeFromStore(n);null==o||o.blur(),(0,d().clear)({environment:t}),l().A.setKeyboardMode(!1)}({environment:i,textStore:t})}),[i,t]);return(0,s().w)((()=>{n&&u()})),(0,o.useMemo)((()=>({isFocused:c,focus:u,blur:g})),[c,u,g])}function h(e){i().default.afterNextFlush((()=>{(0,u().w)();const t=m().n.findNodeFromStore(e);null==t||t.focus(),(0,g().z)({store:e})}))}function f(e){return"empty"!==c().default.state.mode&&c().default.state.multiSelection.start.store.id===e.id}},971404:(e,t,n)=>{n.d(t,{V:()=>r,X:()=>s});var o=()=>n(597777);const i={"de-DE":{time:{"12h":"LT","24h":"H:mm",hidden:o().jk},month:"MMMM YYYY"},"da-DK":{time:{"12h":"LT","24h":"H:mm",hidden:o().jk},month:"MMMM YYYY"},"fi-FI":{time:{"12h":"LT","24h":"H:mm",hidden:o().jk},month:"MMMM YYYY"},"nb-NO":{time:{"12h":"LT","24h":"H:mm",hidden:o().jk},month:"MMMM YYYY"},"nl-NL":{time:{"12h":"LT","24h":"H:mm",hidden:o().jk},month:"MMMM YYYY"},"sv-SE":{time:{"12h":"LT","24h":"H:mm",hidden:o().jk},month:"MMMM YYYY"},"en-US":{time:{"12h":"LT","24h":"H:mm",hidden:o().jk},month:"MMMM YYYY"},"es-ES":{time:{"12h":"LT","24h":"H:mm",hidden:o().jk},month:"MMMM YYYY"},"es-LA":{time:{"12h":"LT","24h":"H:mm",hidden:o().jk},month:"MMMM YYYY"},"fr-FR":{time:{"12h":"LT","24h":"H:mm",hidden:o().jk},month:"MMMM YYYY"},"pt-BR":{time:{"12h":"LT","24h":"H:mm",hidden:o().jk},month:"MMMM YYYY"},"ko-KR":{time:{"12h":"LT","24h":"H:mm",hidden:o().jk},month:"YYYY[년] MMMM"},"zh-CN":{time:{"12h":"LT","24h":"H:mm",hidden:o().jk},month:"YYYY[年]MMM"},"zh-TW":{time:{"12h":"LT","24h":"H:mm",hidden:o().jk},month:"YYYY[年]MMM"},"ja-JP":{time:{"12h":"A h:mm","24h":"H:mm",hidden:o().jk},month:"YYYY[年]MMM"},"vi-VN":{time:{"12h":"LT","24h":"H:mm",hidden:o().jk},month:"MMMM YYYY"},"th-TH":{time:{"12h":"LT","24h":"H:mm",hidden:o().jk},month:"MMMM YYYY"},"id-ID":{time:{"12h":"LT","24h":"H:mm",hidden:o().jk},month:"MMMM YYYY"},"en-GB":{time:{"12h":"LT","24h":"H:mm",hidden:o().jk},month:"MMMM YYYY"},"he-IL":{time:{"12h":"LT","24h":"H:mm",hidden:o().jk},month:"MMMM YYYY"},"ar-SA":{time:{"12h":"LT","24h":"H:mm",hidden:o().jk},month:"MMMM YYYY"},pseudo:{time:{"12h":"A h:mm","24h":"H:mm",hidden:o().jk},month:"MMMM YYYY"}},r=["de-DE","fr-FR","he-IL"];function s(e){return i[e]}}}]);