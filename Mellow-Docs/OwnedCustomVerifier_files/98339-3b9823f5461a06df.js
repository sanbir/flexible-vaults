"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[98339],{27178:(e,t,o)=>{o.d(t,{ZN:()=>s,mN:()=>a,qo:()=>u});var r=()=>o(675133),n=()=>o(69708);const i=(0,n().YK)({default:{defaultMessage:"Default",id:"colors.select.lightGray"},gray:{defaultMessage:"Gray",id:"colors.select.gray"},brown:{defaultMessage:"Brown",id:"colors.select.brown"},orange:{defaultMessage:"Orange",id:"colors.select.orange"},yellow:{defaultMessage:"Yellow",id:"colors.select.yellow"},green:{defaultMessage:"Green",id:"colors.select.green"},blue:{defaultMessage:"Blue",id:"colors.select.blue"},purple:{defaultMessage:"Purple",id:"colors.select.purple"},pink:{defaultMessage:"Pink",id:"colors.select.pink"},red:{defaultMessage:"Red",id:"colors.select.red"}});function a(e){const t=i[e]||i.gray;return r().A.formatMessage(t)}const l=(0,n().YK)({default_background:{defaultMessage:"Default",id:"colors.blockColor.lightGray"},gray_background:{defaultMessage:"Gray",id:"colors.blockColor.gray"},brown_background:{defaultMessage:"Brown",id:"colors.blockColor.brown"},orange_background:{defaultMessage:"Orange",id:"colors.blockColor.orange"},yellow_background:{defaultMessage:"Yellow",id:"colors.blockColor.yellow"},teal_background:{defaultMessage:"Green",id:"colors.blockColor.green"},blue_background:{defaultMessage:"Blue",id:"colors.blockColor.blue"},purple_background:{defaultMessage:"Purple",id:"colors.blockColor.purple"},pink_background:{defaultMessage:"Pink",id:"colors.blockColor.pink"},red_background:{defaultMessage:"Red",id:"colors.blockColor.red"}});function s(e){const t=l[e];return r().A.formatMessage(t)}const c=(0,n().YK)({foregroundColorDefault:{id:"action.foregroundColor.default.name",defaultMessage:"Default text"},foregroundColorGray:{id:"action.foregroundColor.gray.name",defaultMessage:"Gray text"},foregroundColorBrown:{id:"action.foregroundColor.brown.name",defaultMessage:"Brown text"},foregroundColorOrange:{id:"action.foregroundColor.orange.name",defaultMessage:"Orange text"},foregroundColorYellow:{id:"action.foregroundColor.yellow.name",defaultMessage:"Yellow text"},foregroundColorGreen:{id:"action.foregroundColor.green.name",defaultMessage:"Green text"},foregroundColorBlue:{id:"action.foregroundColor.blue.name",defaultMessage:"Blue text"},foregroundColorPurple:{id:"action.foregroundColor.purple.name",defaultMessage:"Purple text"},foregroundColorPink:{id:"action.foregroundColor.pink.name",defaultMessage:"Pink text"},foregroundColorRed:{id:"action.foregroundColor.red.name",defaultMessage:"Red text"},backgroundColorGray:{id:"action.backgroundColor.gray.name",defaultMessage:"Gray background"},backgroundColorBrown:{id:"action.backgroundColor.brown.name",defaultMessage:"Brown background"},backgroundColorOrange:{id:"action.backgroundColor.orange.name",defaultMessage:"Orange background"},backgroundColorYellow:{id:"action.backgroundColor.yellow.name",defaultMessage:"Yellow background"},backgroundColorGreen:{id:"action.backgroundColor.green.name",defaultMessage:"Green background"},backgroundColorBlue:{id:"action.backgroundColor.blue.name",defaultMessage:"Blue background"},backgroundColorPurple:{id:"action.backgroundColor.purple.name",defaultMessage:"Purple background"},backgroundColorPink:{id:"action.backgroundColor.pink.name",defaultMessage:"Pink background"},backgroundColorRed:{id:"action.backgroundColor.red.name",defaultMessage:"Red background"},backgroundColorDefault:{id:"action.backgroundColor.default.name",defaultMessage:"Default background"}}),d={default:{...c.foregroundColorDefault},gray:{...c.foregroundColorGray},brown:{...c.foregroundColorBrown},orange:{...c.foregroundColorOrange},yellow:{...c.foregroundColorYellow},teal:{...c.foregroundColorGreen},blue:{...c.foregroundColorBlue},purple:{...c.foregroundColorPurple},pink:{...c.foregroundColorPink},red:{...c.foregroundColorRed},default_background:{...c.backgroundColorDefault},gray_background:{...c.backgroundColorGray},brown_background:{...c.backgroundColorBrown},orange_background:{...c.backgroundColorOrange},yellow_background:{...c.backgroundColorYellow},teal_background:{...c.backgroundColorGreen},blue_background:{...c.backgroundColorBlue},purple_background:{...c.backgroundColorPurple},pink_background:{...c.backgroundColorPink},red_background:{...c.backgroundColorRed}};function u(e){return d[e]}},47218:(e,t,o)=>{o.r(t),o.d(t,{arrowExpandDiagonalBottomLeftToTopRightIcon:()=>n,iconDefinition:()=>r});o(296540);const r={viewBox:"0 0 20 20",fittedViewBox:"3.23 3.23 13.54 13.54",svg:(0,o(474848).jsx)("path",{d:"M11.14 4.485h3.491l-4.073 4.073a.625.625 0 0 0 .884.884l4.073-4.073v3.49a.625.625 0 1 0 1.25 0v-5a.625.625 0 0 0-.625-.624h-5a.625.625 0 1 0 0 1.25M4.485 14.631l4.07-4.07a.625.625 0 0 1 .884.884l-4.07 4.07h3.49a.625.625 0 1 1 0 1.25h-5a.625.625 0 0 1-.624-.625v-5a.625.625 0 1 1 1.25 0z"})},n=(0,o(340498).wt)("arrowExpandDiagonalBottomLeftToTopRight",r,"default")},61188:(e,t,o)=>{o.d(t,{u:()=>y});o(581454);var r=()=>o(295633),n=()=>o(584262),i=()=>o(700500),a=()=>o(179034),l=()=>o(384944),s=()=>o(281948),c=()=>o(37450),d=()=>o(649813),u=()=>o(390650),m=()=>o(999140),g=()=>o(970501),f=()=>o(622811),p=()=>o(174254),S=()=>o(476297),v=()=>o(482871);function y(e){const{environment:t,collectionContextStore:o,before:y,store:b,groupsPointer:C,collectionStore:_,transaction:k,subitemPath:h,subitemInsertDirection:w,from:M}=e,P=o.collectionViewStore();if(!P)return;const x=o.groupsStore.getGroupState(C),B=null==x?void 0:x.groupUiParentStore,T=(null==x?void 0:x.resultsStore.state)||[];if(!B)return;const D=l().Wv({environment:t,type:i().xd.page,inMemoryRecordCache:b.inMemoryRecordCache,transaction:k,spaceId:P.pointer.spaceId});if(M){const e="collectionTypedView"===o.contextTypeFromStoreState?D.getAssociatedCollectionId():void 0;c().vH(t,{from:M,type:"page",new_page_id:D.id,creating_block_id:D.id,...u().sl(o,e)})}const R=(0,f().j)({environment:t,store:D,collectionStore:_,collectionContextStore:o,groupsPointer:C,shouldCoerce:!0,transaction:k}),L=o.defaultPageTemplateStore.state;L&&d().TB({title:"template",environment:t,store:D,templateStore:L,isKeyboard:!1,isCreateIn:!1,transaction:k,from:"collection_group_actions"});const V=r().B.createChildStore(B,{table:a().ev,id:D.id});h&&h.length>0&&(0,p().i)({environment:t,collectionContextStore:o,subitemPath:h,collectionStore:_,store:b,before:!1,insertBlockStore:V,insertDirection:w,transaction:k});const A=T.indexOf(b),I=y?A:A+1,O=[...T.slice(0,I),V,...T.slice(I)];if((0,v().z)({resultIds:O.map((e=>e.id)),collectionViewStore:P,collectionContextStore:o,transaction:k}),R){if(h){var z;const e="into"===w?b:null===(z=h[h.length-2])||void 0===z?void 0:z.value.store;return e?r().B.createChildStore(e,V.pointer):V}return(0,g().L)({environment:t,store:V}),(0,S().f)({environment:t,collectionContextStore:o}),V}s().VU({environment:t,store:V,peekMode:m().hH(o),resultsStore:null==x?void 0:x.resultsStore,collectionContextStore:o,pageVisitSource:n().y8.Create})}},160811:(e,t,o)=>{o.d(t,{D:()=>l});o(944114),o(581454);var r=()=>o(295633),n=()=>o(179034),i=()=>o(622811),a=()=>o(482871);function l(e){var t,o;const{environment:l,collectionContextStore:s,before:c,insertStores:d,store:u,groupsPointer:m,transaction:g}=e,f=s.collectionViewStore(),p=(null===(t=s.groupsStore.getGroupState(m))||void 0===t?void 0:t.resultsStore.state)||[],S=null===(o=s.groupsStore.getGroupState(m))||void 0===o?void 0:o.groupUiParentStore;if(!S)return[];const v=[];for(const a of d){const t=e.collectionStore??a.getAssociatedCollectionStore();t&&((0,i().j)({environment:l,store:a,collectionStore:t,collectionContextStore:s,groupsPointer:m,shouldCoerce:!0,transaction:g}),v.push(r().B.createChildStore(S,{table:n().ev,id:a.id})))}const y=p.indexOf(u),b=c?y:y+1,C=[...p.slice(0,b),...v,...p.slice(b)];return f&&(0,a().z)({resultIds:C.map((e=>e.id)),collectionViewStore:f,collectionContextStore:s,transaction:g}),s.groupsStore.setLimitIfGreater(m,C.length),v}},174254:(e,t,o)=>{o.d(t,{i:()=>n});var r=()=>o(499962);function n(e){const{environment:t,collectionContextStore:o,subitemPath:n,collectionStore:i,store:a,before:l,insertBlockStore:s,insertDirection:c,transaction:d}=e,u=o.currentSubitemFormatStoreForCollectionStore.state;if(!u)return;const m=i.getSchema()[u.property];if(!m||"relation"!==m.type)return;if("into"===c){var g;const e=n[n.length-1],o=e.value.store;return void r().j$({environment:t,sourceStore:o,destStore:s,position:l?{type:"before",before:null===(g=e.children[0])||void 0===g?void 0:g.value.store.id}:{type:"after"},propertyWithInverse:u,transaction:d})}const f=n[n.length-2];if(!f)return;const p=f.value.store;r().j$({environment:t,sourceStore:p,destStore:s,propertyWithInverse:u,position:l?{type:"before",before:a.id}:{type:"after",after:a.id},transaction:d})}},301948:(e,t,o)=>{o.d(t,{A:()=>a});o(296540);var r=()=>o(970236),n=()=>o(69708),i=o(474848);function a(e){return(0,i.jsx)(r().E,{color:"blue",style:e.style,content:(0,i.jsx)(n().sA,{id:"AlphaBadgeComponent.label",defaultMessage:"Alpha"})})}},317406:(e,t,o)=>{o.d(t,{$N:()=>Q,GB:()=>$,GZ:()=>H,L_:()=>ie,MQ:()=>oe,P7:()=>te,Pt:()=>ee,Tq:()=>ne,Xt:()=>K,bu:()=>N,cd:()=>re,dO:()=>ae,eW:()=>Z,k3:()=>W,n_:()=>q,sd:()=>J,v7:()=>j,vt:()=>X});o(944114),o(898992),o(672577),o(803949),o(581454),o(737550);var r=()=>o(906745),n=()=>o(135168),i=()=>o(726637),a=()=>o(908006),l=()=>o(929219),s=()=>o(295633),c=()=>o(301809),d=()=>o(584262),u=()=>o(433337),m=()=>o(13643),g=()=>o(604995),f=()=>o(416504),p=()=>o(763884),S=()=>o(209199),v=()=>o(496603),y=()=>o(534177),b=()=>o(299709),C=()=>o(896628),_=()=>o(384944),k=()=>o(857783),h=()=>o(281948),w=()=>o(766854),M=()=>o(160811),P=()=>o(61188),x=()=>o(210552),B=()=>o(833106),T=()=>o(499962),D=()=>o(339798),R=()=>o(357643),L=()=>o(390650),V=()=>o(999140),A=()=>o(440024),I=()=>o(970501),O=()=>o(206051),z=()=>o(957763),F=()=>o(295304),G=()=>o(260850),U=()=>o(547149),E=()=>o(839106),Y=()=>o(378518);function q(e){const{collectionViewStore:t,collectionContextStore:o,timelineState:r,environment:n}=e,i=n.currentUser.id,a=(0,Y().UA)(t.id),s=(0,Y().yG)(t,n),c=o.permissionScopesStore.state,d=v().sg((()=>{if(r.destroyed)return;const e={zoomLevel:r.zoomLevelStore.state,centerTimestamp:(0,Y().o$)(r)};p().K.set({userId:i,key:a,value:e})}),1e3),u=v().sg((()=>{if(r.destroyed||!l().A.state.online||!n.currentUser.isLoggedIn()||!c.canConfigureBlock)return;const e={zoomLevel:r.zoomLevelStore.state,centerTimestamp:(0,Y().o$)(r)},o=t.getFormat().timeline_preference;v().n4(o,e)||U().createAndCommit({userAction:"timelineActions.setRemotePreference",environment:n,canUndo:!0,perform:o=>{C().zA({stores:[t],update:{timeline_preference:e},transaction:o})}})}),5e3);r.savePreference=()=>{d(),u()},W({timelineState:r,environment:n,...s})}function W(e){const{timelineState:t,zoomLevel:o,centerTimestamp:r,environment:n}=e;t.zoomLevelStore.setState(o);const i=n.WindowSizeStore.state.width+2*Y().E6,l=(0,Y().C1)(o,i),s=r-l/2,c=r+l/2;t.currentRangeStore.setState({startTimestamp:s,endTimestamp:c});const{savePreference:d}=t;a().default.afterNextFlush((()=>{N({timelineState:t,centerTimestamp:r}),d&&d()}))}function N(e){const{timelineState:t,centerTimestamp:o}=e,{horizontalScroller:r,outerSizeObserver:n}=t;if(!r)return;const i=t.zoomLevelStore.state,{startTimestamp:a,endTimestamp:l}=t.currentRangeStore.state,s=n.rect.state.width;if(s===(0,Y().w0)(i,l-a))return;const c=(0,Y().w0)(i,o-a)-s/2;r.scrollLeft=((0,S().A1)()?-1:1)*c,t.scrollLeftStore.setState(c)}function K(e){const{environment:t,store:o,query:r,date:n,schema:i,transaction:a}=e,{timeline_by:l}=r;if(!l)return;const s=o.getAssociatedCollectionStore(),c=(null==s?void 0:s.getMappedProperty(l))??l,d=r.timeline_by_end?(null==s?void 0:s.getMappedProperty(r.timeline_by_end))??r.timeline_by_end:void 0,u=(0,Y().u9)({store:o,dateValue:n,query:r,schema:(null==s?void 0:s.getSchema())??i}),m=o.getPropertyValue(c),g=d?o.getPropertyValue(d):void 0;return _().zv({store:o.getPropertiesStore(),data:u,transaction:a}),x().O4({environment:t,store:o,dateProperty:{id:c,newValue:(null==u?void 0:u[c])??[],oldValue:m},otherDateProperty:d?{id:d,newValue:(null==u?void 0:u[d])??[],oldValue:g}:void 0}),o}function Q(e){var t;const{environment:o,timelineState:n,collectionStore:i,collectionContextStore:a,store:l,query:s,groupFormat:c,transaction:d}=e,u=n.zoomLevelStore.state,m=(0,Y().o$)(n),{snapUnit:p,getDateRangePlaceholderDuration:S}=Y().eM[u],{timeline_by:v}=s;if(!v)return;const y=null===(t=a.groupsStore.getGroupState(c))||void 0===t?void 0:t.resultsStore.state;if(!y)return;const b=r().DateTime.fromMillis(m),C=(0,Y().DY)(b,p),_=(0,Y().DY)(S(b),p),k=(0,Y().oJ)({startValue:(0,g().Ec)((0,f().P)()),snapUnit:p,desiredStart:C,desiredEnd:_});return K({environment:o,store:l,query:s,schema:i.getSchema(),date:k,transaction:d}),(0,M().D)({environment:o,collectionStore:i,before:!0,store:y[0],insertStores:[l],collectionContextStore:a,groupsPointer:c?[c]:[],transaction:d}),l}function j(e){const{type:t,timelineState:o,store:r,startX:n,query:i,schema:a,intl:l,environment:s,formulasModule:c}=e,{horizontalScroller:d}=o,{startTimestamp:u}=o.currentRangeStore.state;if(!d)return;(0,I().L)({environment:s,store:r});const m=d.scrollLeft,g=(0,Y().Ul)(m,d.scrollWidth,d.clientWidth),{stores:f}=O().default.state,p=v().oE(f.map((e=>{const t=(0,Y().GM)({store:e,query:i,schema:a,userId:s.currentUser.id,intl:l,formulasModule:c,environment:s});if(t)return{startValue:t,store:e}})));o.dragStateStore.setState({type:t,startStore:r,stores:p.map((({store:e})=>e)),startValues:p.map((({startValue:e})=>e)),temporaryValues:p.map((({startValue:e})=>e)),startX:n,startStartTimestamp:u,startScrollLeft:g})}function X(e){const{timelineState:t,store:o,startX:r,startY:n,schema:i,collectionContextStore:a,verticalScroller:l}=e,{horizontalScroller:s}=t,{startTimestamp:c}=t.currentRangeStore.state;if(!s||!l)return;const d=s.scrollLeft,u=l.scrollTop,m=(0,Y().GW)(a,o,i);t.drawStateStore.setState({startStore:o,startDependencyRelationPointers:m,temporaryDependencyRelationPointers:[...m],startX:r,startY:n,startScrollLeft:d,startScrollTop:u,startStartTimestamp:c,xOffsetPx:0,yOffsetPx:0,tryToCompleteDrawnArrow:!1})}function $(e){const{timelineState:t,currentX:o}=e,{horizontalScroller:r}=t,n=t.zoomLevelStore.state,i=t.dragStateStore.state,{startTimestamp:a}=t.currentRangeStore.state;if(!i||!r)return;const{type:l,startStartTimestamp:s,startValues:c,startScrollLeft:d,startX:u,startStore:m,stores:f}=i,p=Y().eM[n],{snapUnit:b}=p,C=r.scrollLeft,_=(0,Y().Ul)(C,r.scrollWidth,r.clientWidth)-d+((0,S().A1)()?u-o:o-u)+(0,Y().w0)(n,a-s),k=(0,Y().C1)(n,_),h=c[f.indexOf(m)];let w;if(l===Y().MB.LeftResizer){const{start:e}=(0,Y().yl)(h,b),t=e.plus(k);w=c.map((e=>{const o=(0,Y().oJ)({startValue:e,snapUnit:b,desiredStart:t});return(0,g().u7)(o)}))}else if(l===Y().MB.RightResizer){const{end:e}=(0,Y().yl)(h,b),t=e.plus(k);w=c.map((e=>{const o=(0,Y().oJ)({startValue:e,snapUnit:b,desiredEnd:t});return(0,g().rL)(o)}))}else l===Y().MB.ItemDrag?w=c.map((e=>{const{start:t,end:o}=(0,Y().yl)(e,b),r=t.plus(k),n=r.plus(o.valueOf()-t.valueOf());return(0,Y().oJ)({startValue:e,snapUnit:b,desiredStart:r,desiredEnd:n})})):(0,y().HB)(l);v().n4(i.temporaryValues,w)||t.dragStateStore.setState({...i,temporaryValues:w})}function H(e){const{timelineState:t,currentX:o,currentY:r,verticalScroller:n}=e,i=t.drawStateStore.state,a=t.zoomLevelStore.state,{startTimestamp:l}=t.currentRangeStore.state,{horizontalScroller:s}=t;if(!i||!s||!n)return;const{startDependencyRelationPointers:c,startStore:d,startX:u,startY:m,startScrollLeft:g,startScrollTop:f,startStartTimestamp:p}=i,y=s.scrollLeft,b=(0,Y().Ul)(y,s.scrollWidth,s.clientWidth),C=n.scrollTop,_=b-g+((0,S().A1)()?u-o:o-u)+(0,Y().w0)(a,l-p),k=C-f+(r-m),h=t.hoveredItemStore.state;if(h&&h!==d&&!c.some((e=>e.id===h.id))){const e=[...c,{table:"block",id:h.id,spaceId:h.getSpaceId()}];v().n4(i.temporaryDependencyRelationPointers,e)||t.drawStateStore.setState({...i,temporaryDependencyRelationPointers:e,xOffsetPx:void 0,yOffsetPx:void 0})}else t.drawStateStore.setState({...i,temporaryDependencyRelationPointers:[...c],xOffsetPx:_,yOffsetPx:k})}function Z(e){const{environment:t,collectionContextStore:o,timelineState:r,query:n,schema:i,transaction:a}=e,l=r.dragStateStore.state,{timeline_by:s}=n;if(!l||!s)return;const{temporaryValues:c,stores:d}=l;c.forEach(((e,r)=>{const l=d[r];K({environment:t,store:l,query:n,schema:i,transaction:a,date:e}),(0,b().E)({environment:t,collectionContextStore:o,block_id:l.id,property:s,property_type:"date",from:"timeline"})})),r.dragStateStore.setState(void 0)}function J(e){var t;const{timelineState:o,environment:r,transaction:n,collectionContextStore:i,isFullScreen:a,isRootChild:l}=e,c=o.drawStateStore.state,d=o.dateRangePlaceholderStore.state;if(!c)return;const{startStore:u,startDependencyRelationPointers:m,temporaryDependencyRelationPointers:g}=c;if(!u)return void o.drawStateStore.setState(void 0);let f;if(d.active){const{date:e,store:t,parentStore:a,groupFormat:l,newTimelineItemProps:s,existingTimelineItemProps:c}=d;if(t&&c){const{query:o,schema:i}=c;K({environment:r,store:t,query:o,schema:i,date:e,transaction:n}),f={table:"block",id:t.id,spaceId:u.getSpaceId()}}else if(s){const{query:o,schema:c,isFullScreen:d,canEditTimelineItems:m,subitemPath:g}=s,p=ae({environment:r,date:e,store:t,parentStore:a,query:o,schema:c,isFullScreen:d,groupFormat:l,canEditTimelineItems:m,collectionContextStore:i,subitemPath:g,transaction:n,from:"timeline_complete_draw"});p&&(f={table:"block",id:p.id,spaceId:u.getSpaceId()})}o.dateRangePlaceholderStore.setState({active:!1})}else f=g.find((e=>!m.includes(e)));const p=(0,Y().VC)(i);if(p){const{property:e}=p;f&&(T().j$({environment:r,propertyWithInverse:p,sourceStore:u,destStore:s().B.createChildStore(u,f),position:{type:"after"},transaction:n}),(0,b().E)({environment:r,collectionContextStore:i,block_id:u.id,property:e,property_type:"relation",from:"timeline",isFromBulkActionsToolbar:!1,isUnthrottled:!0})),o.drawStateStore.setState(void 0)}else D().R8({item:{type:"dependencies",from:"view_options"},collectionSettingsStore:i.settingsStore}),o.drawStateStore.setState({...c,tryToCompleteDrawnArrow:!0});const S=null===(t=f)||void 0===t?void 0:t.id;S&&(0,E().xY)(r,{...(0,L().sl)(i),...(0,E().ZR)({environment:r,collectionContextStore:i,timelineState:o,isFullScreen:a,isRootChild:l}),dependenciesPropertyID:null==p?void 0:p.property,blockedByStoreID:u.id,blockingStoreID:S})}function ee(e){const{timelineState:t,environment:o}=e;t.dragStateStore.state&&(t.dragStateStore.setState(void 0),(0,A().I)({environment:o}))}function te(e){const{timelineState:t,environment:o}=e;t.drawStateStore.state&&(t.drawStateStore.setState(void 0),(0,A().I)({environment:o}))}function oe(e){const{stores:t,collectionViewStore:o,schema:r,transaction:n}=e,i=o.getType(),a=(0,B().$)({collectionViewStore:o,schema:r}),l=[];a&&("calendar"===i?a.calendar_by&&l.push(a.calendar_by):"timeline"===i&&(a.timeline_by&&l.push(a.timeline_by),a.timeline_by_end&&l.push(a.timeline_by_end)));for(const s of t)for(const e of l)F().R9({environment:s.environment,store:s.getPropertyStore(e),value:void 0,transaction:n})}function re(e){const{dependency:t,collectionContextStore:o,environment:r,timelineState:n,isFullScreen:i,isRootChild:a}=e,l=(0,Y().VC)(o),c=o.collectionStore();if(!l||!c)return;const{property:d}=l,{store:u,relationPointer:m}=t,g=u.getSchema()[d];g&&"relation"===g.type&&(U().createAndCommit({userAction:"CollectionTimelineDependenciesOverlay.handleRemoveRelation",environment:r,canUndo:!0,perform:e=>{T().c3({environment:r,propertyWithInverse:l,sourceStore:u,destStore:s().B.createChildStore(u,m),transaction:e}),(0,b().E)({environment:r,block_id:m.id,property:d,property_type:g.type,from:"timeline",collectionContextStore:o,isFromBulkActionsToolbar:!1,isUnthrottled:!0})}}),(0,E().m2)(r,{...(0,L().sl)(o),...(0,E().ZR)({environment:r,collectionContextStore:o,timelineState:n,isFullScreen:i,isRootChild:a}),dependenciesPropertyID:d,blockedByStoreID:u.id,blockingStoreID:m.id}))}function ne(e){const{collectionViewStore:t,newProperty:o,transaction:r}=e;C().zA({stores:[t],update:{timeline_arrows_by:{property:o}},transaction:r})}function ie(e){var t;const{collectionContextStore:o,relationPropertyId:r,transaction:n}=e,i=o.collectionStore();if(!i)return;const a=r?i.getSchema()[r]:void 0,l="relation"===(null==a?void 0:a.type)&&a.property&&"relation"===(null===(t=i.getSchema()[a.property])||void 0===t?void 0:t.type)?a.property:void 0;C().zA({stores:[i],update:{collection_default_arrows_by:r,...i.getFormat().app_config_uri===m().dC?{app_uri_map:{...i.getFormat().app_uri_map?i.getFormat().app_uri_map:{},[u().yx.BlockingRelation]:r,[u().yx.BlockedRelation]:l}}:{}},transaction:n})}function ae(e){const{environment:t,transaction:o,date:r,parentStore:a,query:l,schema:s,isFullScreen:u,groupFormat:m,canEditTimelineItems:g,collectionContextStore:f,from:p}=e;if(!(0,z().E)(t,(0,n().f)(a)))return;const S=m?[m]:[],v=f.groupsStore.getGroupState(S);if(!v)return;if(a)return function(e){const{environment:t,transaction:o,date:r,store:n,parentStore:a,query:l,schema:s,groupFormat:u,canEditTimelineItems:m,collectionContextStore:g,subitemPath:f}=e;if(!n||!a)return;const p=u?[u]:[],S=(0,P().u)({environment:t,collectionContextStore:g,groupsPointer:p,store:n,before:!1,collectionStore:a,transaction:o,subitemPath:f,subitemInsertDirection:"into"});if(S){if(K({environment:t,store:S,query:l,schema:s,date:r,transaction:o}),i().A.isMobile)k().uK({environment:t,store:S,pageVisitSource:d().y8.Create});else if(S&&m){const e=S.getBlockTitleStore();(0,c().e)({store:e})}return S}}(e);f.searchQueryStore.state&&(0,R().S)({searchQuery:"",collectionContextStore:f,isFullScreen:u});const y=(0,w().Q)({environment:t,collectionContextStore:f,groupsPointer:S,shouldCoerce:!0,templateStore:f.defaultPageTemplateStore.state,transaction:o,from:{createBlock:p},inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache});if(!y)return;const b=y.coercionSucceeded,C=y.newStore;if(K({environment:t,store:C,query:l,schema:s,date:r,transaction:o}),i().A.isMobile)k().uK({environment:t,store:C,pageVisitSource:d().y8.Create});else if(b&&g){const e=C.getBlockTitleStore();(0,G().z)({store:e})}else h().VU({environment:t,store:C,peekMode:(0,V().hH)(f),resultsStore:null==v?void 0:v.resultsStore,collectionContextStore:f,pageVisitSource:d().y8.Create});return C}},357643:(e,t,o)=>{function r(e){const{searchQuery:t,collectionContextStore:o}=e;o.collectionViewStore()&&(o.searchQueryStore.setState(t||""),o.groupsStore.resetAllLimits())}o.d(t,{S:()=>r})},476297:(e,t,o)=>{o.d(t,{f:()=>g});var r=()=>o(907258),n=()=>o(675133),i=()=>o(792057),a=()=>o(439549),l=()=>o(789051),s=()=>o(314660),c=()=>o(680288),d=()=>o(418211),u=()=>o(547149);const m=(0,o(69708).YK)({removeSortingConfirmation:{id:"databaseActions.removeSortingConfirmationDialog.prompt",defaultMessage:"Would you like to remove sorting?"},removeSortingButton:{id:"databaseActions.removeSortingConfirmationDialog.removeSortingButton.label",defaultMessage:"Remove"},removeSortingCancel:{id:"databaseActions.removeSortingConfirmationDialog.cancelRemoveSortingButton.label",defaultMessage:"Donâ€™t remove"},removeCollectionSortingLibraryConfirmation:{id:"databaseActions.removeCollectionSortingLibraryConfirmationDialog.prompt",defaultMessage:"Would you like to change to manual sorting?"},removeCollectionSortingLibraryButton:{id:"databaseActions.removeCollectionSortingLibraryConfirmationDialog.removeSortingButton.label",defaultMessage:"Yes, use manual sort"},removeCollectionSortingLibraryCancel:{id:"databaseActions.removeCollectionSortingLibraryConfirmationDialog.cancelRemoveSortingButton.label",defaultMessage:"No, keep last edited"}});function g(e){const{environment:t,collectionContextStore:o}=e,g=o.collectionViewBlockStore(),f=o.collectionViewStore();if(!f||!g)return!1;const p=o.currentViewHasSort(),S=(0,l().gv)(o),v=p||S,y=f.getType(),b=o.permissionScopesStore.state,C=o.isInLibraryBlock();if(v&&y&&c().gP[y]&&b.canConfigureBlock){const{confirmationMessage:e,confirmButtonLabel:l,cancelButtonLabel:c}=C?{confirmationMessage:m.removeCollectionSortingLibraryConfirmation,confirmButtonLabel:m.removeCollectionSortingLibraryButton,cancelButtonLabel:m.removeCollectionSortingLibraryCancel}:{confirmationMessage:m.removeSortingConfirmation,confirmButtonLabel:m.removeSortingButton,cancelButtonLabel:m.removeSortingCancel};return i().ui({message:n().A.formatMessage(e),items:[{label:n().A.formatMessage(l),color:C?"blue":"red",onAccept:()=>{u().createAndCommit({userAction:"collectionGroupActions.offerToRemoveSort",environment:t,canUndo:!0,perform:e=>{if((0,s().f)({collectionViewStore:f,update:{sort:[]},transaction:e}),C&&(0,d().b)({collectionContextStore:o})){var n;const i=r().default.state.sidebarSpaceViewStore,l=null===(n=o.collectionViewStore())||void 0===n||null===(n=n.getCollectionSource())||void 0===n?void 0:n.type;!i||"private"!==l&&"shared"!==l||a().c2({environment:t,transaction:e,spaceViewStore:i,update:{type:"sortOption",value:"manual"},sectionType:l})}}});const e=o.temporaryStateStore.state;o.temporaryStateStore.setState({...e,sorts:void 0})}},{label:n().A.formatMessage(c),onAccept:()=>{}}],showCancel:!1,keepFocus:!0}),!0}return!1}},789051:(e,t,o)=>{o.d(t,{I6:()=>u,Ml:()=>c,gv:()=>g,y_:()=>d,ye:()=>m});o(898992),o(354520),o(672577),o(581454),o(737550);var r=()=>o(214388),n=()=>o(43864),i=()=>o(837788),a=()=>o(448801),l=()=>o(496603),s=()=>o(520994);function c(e,t){var o,c,d;const u=e.collectionViewStore();if(!u)return{combinatorFilter:void 0,filters:{moveOps:[],removed:[],updated:[],moved:[],added:[]},sorts:void 0};const m="persisted"===t?u.getQueryStore().getKeyStore("sort").getValue()||[]:(null===(o=e.normalizedQueryStore.state)||void 0===o?void 0:o.sort)||[],g=e.currentSortsStore.state,f="persisted"===t?u.getQueryStore().getKeyStore("filter").getValue():null===(c=e.normalizedQueryStore.state)||void 0===c?void 0:c.filter,p=e.currentCombinatorFilterStore.state,S="persisted"===t?(null===(d=u.getPropertyFiltersStore().getValue())||void 0===d?void 0:d.sort((0,s().I)()))||[]:function(e){const t=e.normalizedSchemaStore.state,o=e.normalizedFormatStore.state.property_filters||[];return l().oE(o.filter((o=>{const i=(0,n().hs)(o.filter,t),a=e.collectionViewBlockStore();if(t[o.filter.property]&&i&&(0,r().tn)(t,o.filter.property,i.filter,null==a?void 0:a.getRecordModel))return i&&{id:o.id,filter:i}})).sort((0,s().I)()))}(e),v=e.currentPropertyFiltersStore.state,y=S.map((e=>e.id)),b=v.map((e=>e.id)),{beforeOps:C,removeOps:_}=(0,a().i)(y,b),k=Array.from(_).filter((e=>!b.includes(e))),h=Object.keys(C).map((e=>({id:e,beforeId:C[e]}))),w=h.filter((({id:e})=>y.includes(e))).map((({id:e})=>e)),M=h.filter((({id:e})=>!y.includes(e))).map((({id:e})=>e)),P=v.filter((e=>S.find((t=>{if(e.id!==t.id)return!1;const o=l().mg(t),r=l().mg(e);return!l().n4((0,i().A)(r,"ignore-class-instances"),(0,i().A)(o,"ignore-class-instances"))})))).map((e=>e.id));return{combinatorFilter:l().n4(f,p)?void 0:{value:p},filters:{moveOps:h,removed:k,updated:P,moved:w,added:M},sorts:l().n4(m,g)?void 0:{value:g}}}function d(e){const t=c(e,"normalized");return Boolean(t.filters.moved.length>0||t.filters.added.length>0||t.filters.removed.length>0||t.filters.updated.length>0||void 0!==t.combinatorFilter||void 0!==t.sorts)}function u(e){const t=c(e,"normalized");return Boolean(t.filters.moved.length>0||t.filters.added.length>0||t.filters.removed.length>0||t.filters.updated.length>0||void 0!==t.combinatorFilter)}function m(e){const t=c(e,"normalized"),o=e.currentPropertyFiltersStore.state.filter((e=>!(0,r().t_)(e.filter))),n=t.filters.added.some((e=>o.some((t=>t.id===e))));return Boolean(n||t.filters.moved.length>0||t.filters.removed.length>0||t.filters.updated.length>0||void 0!==t.combinatorFilter)}function g(e){const t=c(e,"normalized");return Boolean(void 0!==t.sorts)}},839106:(e,t,o)=>{o.d(t,{AP:()=>s,VD:()=>d,ZR:()=>p,gp:()=>m,i6:()=>c,iH:()=>a,iT:()=>u,m2:()=>f,xY:()=>g,z2:()=>l});o(898992),o(354520);var r=()=>o(314529),n=()=>o(601002),i=()=>o(378518);function a(e,t){(0,n().W)(e,"timeline_view","timeline_view",5,t)}function l(e,t){(0,r().DO_NOT_USE_trackLegacy)(e,"timeline_zoom_level_update",t)}function s(e,t){(0,r().DO_NOT_USE_trackLegacy)(e,"timeline_today_click",t)}function c(e,t){(0,r().DO_NOT_USE_trackLegacy)(e,"timeline_shift_time_click",t)}function d(e,t){(0,r().DO_NOT_USE_trackLegacy)(e,"timeline_toggle_table_click",t)}function u(e,t){(0,r().DO_NOT_USE_trackLegacy)(e,"timeline_item_scroll_arrow_click",t)}function m(e,t){(0,r().DO_NOT_USE_trackLegacy)(e,"timeline_item_resize",t)}function g(e,t){(0,r().DO_NOT_USE_trackLegacy)(e,"timeline_dependency_arrow_add",t)}function f(e,t){(0,r().DO_NOT_USE_trackLegacy)(e,"timeline_dependency_arrow_delete",t)}function p(e){const{environment:t,collectionContextStore:o,timelineState:r,isFullScreen:n,isRootChild:a}=e,l=r.zoomLevelStore.state,s=o.normalizedFormatStore.state,c=(0,i().iw)({environment:t,format:s,isFullScreen:n,isRootChild:a}),d=c&&s.timeline_table_properties?s.timeline_table_properties.length:0,u=s.timeline_properties||[],m=u.filter((e=>"title"!==e.property));return{zoom_level:l,show_table:c,show_table_properties_count:d,show_timeline_title:u.length!==m.length,show_timeline_properties_count:m.length}}}}]);