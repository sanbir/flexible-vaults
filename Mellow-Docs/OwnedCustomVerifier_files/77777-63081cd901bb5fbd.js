"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[77777],{5269:(e,t,o)=>{o.d(t,{y:()=>u});var r=()=>o(590526),n=()=>o(732810),a=()=>o(330361),i=()=>o(179034),l=()=>o(534177),s=()=>o(908201);function u(e,t){const o=(0,s().Ks)();return(0,r().K8)((()=>{const r=e.getParentStore();if("button_block"===t){const t=function(e){const t=(0,a().g)(e);for(const o of t)if(o.table===i().ev&&o.isPageBlock())return o;return}(e);return null==t?void 0:t.getAssociatedCollectionStore()}if("button_property"===t)return null==o?void 0:o.collectionStore();if("event"===t){if(r&&r instanceof n().m)return r}else if("recurrence"===t);else if("assistant"===t){if(r&&r instanceof n().m)return r}else(0,l().HB)(t)}),[e,t,o])}},7667:(e,t,o)=>{o.d(t,{A:()=>g});o(898992),o(737550),o(296540);var r=()=>o(484714),n=()=>o(590526),a=()=>o(792057),i=()=>o(69708),l=()=>o(534177),s=()=>o(908201),u=()=>o(254497),c=()=>o(312296),p=()=>o(999140),d=()=>o(547149),m=o(474848);function g(){const e=(0,s().Ks)(),t=(0,r().v3)(),o=(0,n().K8)((()=>null==e?void 0:e.settingsStore),[e]);return function(r){if(!o||!r||!e)return;const n=e.collectionStore();if((0,l().O9)(n)){const e=p().KA({deletedSchema:n.getDeletedSchema(),property:r});if(e){var s;if("verification"===(null===(s=n.getDeletedSchema()[r])||void 0===s?void 0:s.type)){const e=n.getSchema(),t=Object.keys(e).some((t=>{var o;return"verification"===(null===(o=e[t])||void 0===o?void 0:o.type)}));if(t)return void a().ui({message:(0,m.jsx)(i().sA,{id:"deletedPropertyMenu.cannotRestoreDuplicateProperty.modal.verification",defaultMessage:"You can only have one verification property."}),showCancel:!1,keepFocus:!0,items:[{label:(0,m.jsx)(i().sA,{id:"deletedPropertyMenu.cannotRestoreDuplicateProperty.modal.dismissButton",defaultMessage:"Dismiss"}),onAccept:()=>{}}]})}d().createAndCommit({userAction:"deletedPropertyMenu.handleRestoreDeletedPropertyClick",environment:t,canUndo:!0,perform:o=>{(0,c().F)({environment:t,collectionStore:n,update:e.updateSchema,transaction:o}),(0,u().E)({collectionStore:n,update:e.updateDeletedSchema,transaction:o})}})}}}}},16707:(e,t,o)=>{o.d(t,{L:()=>p,g:()=>c});o(296540);var r=()=>o(401497),n=()=>o(572438),a=()=>o(239381),i=()=>o(69708),l=()=>o(100622),s=()=>o(214973),u=o(474848);function c(e){const{returnType:t}=e,o=(0,r().DP)(),c=(0,r().IS)((()=>({iconWrap:{display:"inline-block",fill:l().Tj.icon.secondary,height:"1em",position:"relative",verticalAlign:"-0.15em",width:"1em"},icon:{width:"100%"}})),[]),p=(0,a().Ix)(t);return(0,u.jsx)(n().R,{icon:(0,u.jsx)("span",{style:c.iconWrap,children:p(c.icon)}),index:0,theme:o,children:(0,u.jsx)(i().sA,{...s().CV.inlineCustomFormulaDefaultName})})}function p(){return(0,u.jsx)(i().sA,{...s().CV.inlineCustomFormulaDefaultName})}},23986:(e,t,o)=>{o.d(t,{y:()=>I});o(898992),o(354520),o(581454);var r=o(296540),n=()=>o(726637),a=()=>o(401497),i=()=>o(420802),l=()=>o(26697),s=()=>o(81068),u=()=>o(736847),c=()=>o(581793),p=()=>o(927826),d=()=>o(478367),m=()=>o(363170),g=()=>o(214388),y=()=>o(791089),h=()=>o(69708),f=()=>o(534177),v=()=>o(284371),x=()=>o(942715),S=()=>o(100622),b=()=>o(798971),C=o(474848);function k({handleSelectOperator:e,selectedItem:t}){const o=(0,a().IS)((()=>({buttonStyle:{fontSize:n().A.isMobile?16:12,height:20,lineHeight:"unset",marginInlineEnd:0,paddingInlineStart:2,paddingInlineEnd:2,textTransform:"lowercase",color:n().A.isMobile?S().Tj.palette.gray[900]:S().Tj.palette.gray[500]}})),[]);return(0,C.jsx)(x().A,{style:{height:20},innerButtonStyle:o.buttonStyle,selectedTitle:(0,C.jsx)(h().sA,{...t.text}),renderMenuSections:t=>[{key:"selectPersonOperator",render:e=>(0,C.jsx)(u().A,{...e}),items:Object.values(b().fJ).map((o=>({key:o.value,action:()=>{e(o),t.close()},render:e=>(0,C.jsx)(s().A,{...e,title:(0,C.jsx)(h().sA,{...o.text})})})))}]})}var j=()=>o(717322),A=()=>o(637573),T=()=>o(240865),M=()=>o(714202);function I(e){var t,o;const{collectionStore:x,formulaTypecheckContextValues:S,menuStore:I,onClose:P,onCommit:_,parentRecordStore:w,propertyChangedFilter:V,propertyId:N,propertySchema:R,shouldUseDefaultPropertyOperator:F}=e,B=(0,r.useMemo)((()=>{if(F)return"person_contains"}),[F]),O=(0,r.useMemo)((()=>{if("changes_to_any"!==V.operator)return(0,d().I)(V)&&"is_empty"!==V.operator&&(0,g().gc)(V)?(0,p().W)(V):[]}),[V]),[E,D]=(0,r.useState)((()=>{if(!O)return;const e=O.map((e=>{if("exact"===e.type)return e.value})).filter(f().O9);return{action:"replace",value:{type:"simple",value:(0,c().h)(e)}}})),[W,L]=(0,r.useState)((0,b().Oj)(B||V.operator)),K=(0,T().V)()??0,H=(0,A().r)()??0,z=(0,r.useMemo)((()=>K+H),[H,K]),q=(0,r.useRef)(),U=(0,r.useRef)(),[Y,G]=(0,r.useState)(!O),$=(0,r.useMemo)((()=>{var e;return(0,y().fromSimpleFormulaArrayValue)(null==E||null===(e=E.value)||void 0===e?void 0:e.value)}),[null==E||null===(t=E.value)||void 0===t?void 0:t.value]),Q=(0,r.useMemo)((()=>{var e;return function(e){const{allChecked:t,formulaValue:o,numTotalActors:r}=e;if(o&&o.length>0){return(0,y().fromSimpleFormulaArrayValue)(o).length===r||"partial"}if(t)return!0;return!1}({allChecked:Y,formulaValue:null==E||null===(e=E.value)||void 0===e?void 0:e.value,numTotalActors:z,propertySchema:R})}),[Y,null==E||null===(o=E.value)||void 0===o?void 0:o.value,R,z]),J=(0,r.useMemo)((()=>({collectionStore:x,property:N,type:"collection"})),[x,N]),Z=(0,r.useCallback)((()=>{const e=q.current||(null==E?void 0:E.value),t=U.current||W,o=e?(0,m().e)({textValue:e.value,propertySchema:R,blockCreatorPointer:void 0}):void 0,r=o&&o.length>0?{operator:t,value:o.map((e=>({type:"exact",value:e})))}:{operator:"person_contains"===t&&Y?"changes_to_any":"is_empty"};let n="partial";"changes_to_any"===t?n=!0:"is_empty"===t&&(n=!1),_({anyOptionCheckState:n,filter:r,propertyId:N}),P()}),[Y,null==E?void 0:E.value,P,_,W,N,R]),X=(0,r.useCallback)((e=>{q.current=e,D(e?{action:"replace",value:e}:void 0),1===R.limit&&Z()}),[Z,R.limit]),ee=(0,r.useCallback)((()=>{Q?(G(!1),$.length>0&&X(void 0)):G(!0)}),[Q,$.length,X]),te=(0,r.useCallback)((e=>{U.current=e.value,L(e.value),b().fJ[e.value].hasInput||X(void 0)}),[X]),oe=b().fJ[W],re=oe.hasInput,ne=!Y||$.length>0,ae=(0,a().IS)((()=>({header:{display:"flex",gap:"4px",alignItems:"center",overflow:"hidden"},propertyName:{...v().RC}})),[]),{headerDiv:ie,innerComponents:le}=(0,j().A)({currentSimpleFormulaValueTokens:$,formulaTypecheckContextValues:S,formulaValueContext:J,isDisabled:!ne,limit:void 0,onChange:X,onClose:P,showClearButton:!0,showGenericHeader:!1,showInputMenuItem:!0,value:null==E?void 0:E.value,parentRecordStore:w}),se=[oe.hasInput?{key:"any",render:e=>(0,C.jsx)(u().A,{...e,topBorder:!1}),items:[{key:"any-option-item",action:ee,render:()=>(0,C.jsxs)(C.Fragment,{children:[ie,(0,C.jsx)(s().A,{onClick:ee,focused:!0,icon:(0,C.jsx)(i().S,{onClick:ee,checked:!0===Q,size:14}),title:(0,C.jsx)(h().sA,{id:"automationEventTriggerPropertyChangedFilterMenu.anyOption.title",defaultMessage:"Any option"})})]})}]}:void 0,re?{key:"inner",render:e=>n().A.isMobile?le:(0,C.jsx)(u().A,{...e,topBorder:!0}),items:[{key:"inner-components-item",action:ee,render:()=>le}]}:void 0].filter(f().O9);return(0,C.jsx)(M().A,{type:"default",triggerActionMenuStore:I,onDone:Z,onClose:P,headerTitle:(0,C.jsxs)("div",{style:ae.header,children:[(0,C.jsx)(l().m,{placement:"bottom",render:e=>(0,C.jsx)("div",{...e,style:ae.propertyName,children:R.name}),renderTooltip:()=>R.name}),(0,C.jsx)(k,{handleSelectOperator:te,selectedItem:oe})]}),sections:se,customMenuProps:{leftOuterStyle:{flex:"unset"},rightOuterStyle:{flex:"unset"},titleOuterStyle:{flex:"unset"},topbarStyle:{justifyContent:"space-between"}}})}},27511:(e,t,o)=>{o.d(t,{a:()=>b,y:()=>v});o(898992),o(354520),o(672577),o(581454),o(296540);var r=()=>o(401497),n=()=>o(214388),a=()=>o(713998),i=()=>o(784892),l=()=>o(69708),s=()=>o(534177),u=()=>o(284371),c=()=>o(399762),p=()=>o(881690),d=()=>o(496401),m=()=>o(214973),g=()=>o(529135),y=()=>o(989064),h=o(474848);const f=5;function v(e){const t=(0,l().tz)(),{filter:o,limit:r=f,propertySchema:a,onClick:i}=e,u=a.name,c=(0,n().V6)(o),p=c.map((e=>"is_group"===e.type?e.value:void 0)).filter(s().O9),d=c.map((e=>"is_option"===e.type?e.value:void 0)).filter(s().O9),m=b({intl:t,groupValues:p,limit:r,optionValues:d,propertySchema:a}),g=b({intl:t,isText:!0,groupValues:p,limit:r,optionValues:d,propertySchema:a});return(0,h.jsx)(y().z,{onClick:i,tooltip:(0,h.jsx)(S,{propertyName:u,statusValues:g}),children:(0,h.jsx)(x,{propertyName:u,statusValues:m})})}function x({propertyName:e,statusValues:t}){const o=(0,l().tz)(),n=(0,r().IS)((()=>({content:{alignItems:"baseline",display:"flex",flexWrap:"wrap",whiteSpace:"pre",lineHeight:1.6},propertyName:{...u().RC,fontWeight:u().Wy.medium}})),[]),a=o.formatList(t,{style:"long",type:"disjunction"});return(0,h.jsx)("div",{style:n.content,children:(0,m().Yx)(o,{propertyName:(0,h.jsx)("span",{style:n.propertyName,children:e}),propertyValues:(0,d().d)(a)})})}function S({propertyName:e,statusValues:t}){const o=(0,l().tz)(),n=(0,r().IS)((()=>({propertyName:{...u().RC,fontWeight:u().Wy.medium}})),[]),a=o.formatList(t,{style:"long",type:"disjunction"});return(0,h.jsx)(h.Fragment,{children:(0,m().Yx)(o,{propertyName:(0,h.jsx)("span",{style:n.propertyName,children:e}),propertyValues:(0,d().d)(a)})})}function b({groupValues:e,intl:t,isText:o,limit:r,optionValues:n,propertySchema:l,tokenFormat:u=i().NY.Medium}){const d=l.groups||[],y=l.options||[],f=e.map((e=>{const t=d.find((t=>t.name===e));if(t)return o?t.name:(0,h.jsx)(c().q,{format:u,isSingle:!0,value:t.name,color:t.color,groupColor:null==t?void 0:t.color,showRemoveButton:!1,showEllipsis:!1},t.id)})).filter(s().O9),v=n.map((e=>{const r=(0,a().jy)(y,e);if(void 0===r)return o?(0,m().iy)(t):(0,h.jsx)(g().A,{tokenFormat:u},`missing_option_value_${e}`);if(o)return r.value;const n=d.find((e=>{var t;return null===(t=e.optionIds)||void 0===t?void 0:t.includes(r.id)}));return(0,h.jsx)(c().q,{format:u,isSingle:!0,value:r.value,color:r.color,groupColor:null==n?void 0:n.color,showRemoveButton:!1,showEllipsis:!0},r.id)})),x=[...f,...v];let S=[];if(void 0!==r&&x.length>r){const e=v.length-r,t=o?`+${e}`:(0,h.jsx)(p().A,{format:i().NY.Medium,isRound:!0,isSingle:!0,showRemoveButton:!1,value:`+${e}`},"More tokens");S=[...v.slice(0,r),t]}else S=x;return S}},32527:(e,t,o)=>{o.d(t,{E:()=>n});o(296540);const r={viewBox:"0 0 16 16",fittedViewBox:"2.67 2.3 10.65 11.35",svg:(0,o(474848).jsx)("path",{d:"M7.1 2.344a.625.625 0 0 0-.724.507l-.5 2.844h-1.98a.625.625 0 1 0 0 1.25h1.76l-.373 2.11H3.304a.625.625 0 0 0 0 1.25h1.76L4.6 12.932a.625.625 0 0 0 1.231.216l.501-2.843h2.483l-.463 2.627a.625.625 0 0 0 1.231.216l.501-2.843h2.02a.625.625 0 0 0 0-1.25h-1.8l.372-2.11h2.02a.625.625 0 0 0 0-1.25h-1.8l.463-2.627a.625.625 0 1 0-1.23-.217l-.502 2.844H7.145l.462-2.627a.625.625 0 0 0-.507-.724m-.547 6.71.371-2.109h2.483l-.372 2.11z"})},n=(0,o(340498).wt)("numberSmall",r,"small")},36697:(e,t,o)=>{o.d(t,{P:()=>l});o(296540);var r=()=>o(401497),n=()=>o(852424),a=()=>o(340498),i=o(474848);function l({style:e={},propertySchema:t}){const o=(0,r().DP)();return(0,i.jsx)(n().zB,{size:a().Ev.sm,theme:o,icon:t.icon,style:{...e,overflow:"visible"},type:t.type})}},89240:(e,t,o)=>{o.d(t,{r:()=>y});o(898992),o(823215),o(581454),o(737550);var r=o(296540),n=()=>o(726637),a=()=>o(420802),i=()=>o(81068),l=()=>o(736847),s=()=>o(214388),u=()=>o(69708),c=()=>o(534177),p=()=>o(974619),d=()=>o(790515),m=()=>o(714202),g=o(474848);function y(e){const{propertyId:t,menuStore:o,propertySchema:y,propertyChangedFilter:h,onClose:f,onCommit:v}=e,x=(0,r.useMemo)((()=>{if("changes_to_any"===h.operator){return(y.groups??[]).map((e=>({type:"is_group",value:e.name})))}return(0,s().H$)(h)&&(0,s().gc)(h)?(0,s().V6)(h):[]}),[h,y]),[S,b]=(0,r.useState)(x);(0,r.useEffect)((()=>{b(x)}),[x]);const C=(0,r.useMemo)((()=>function(e){const{propertySchema:t,selectedStatusOptions:o}=e,r=t.groups??[],n=t.options??[],a=r.map((e=>(0,d().Ze)({group:e,options:n,filterValues:o}))),i=a.every((e=>!0===e.groupCheckState)),l=a.some((e=>!1!==e.groupCheckState));return!!i||!!l&&"partial"}({propertySchema:y,selectedStatusOptions:S})),[y,S]),k=(0,r.useMemo)((()=>(y.groups??[]).map((e=>({type:"is_group",value:e.name})))),[y]),j=(0,p().T)({propertySchema:y,statusFilterValues:S,updateValue:e=>{b(e)},isMobile:n().A.isMobile,styles:{},visibleOptions:y.options??[]}),A=(0,r.useRef)((()=>{}));return(0,r.useEffect)((()=>{A.current=()=>{const e=0===S.length?{operator:"is_empty"}:{operator:"status_is",value:S};v({anyOptionCheckState:C,filter:e,propertyId:t,propertySchema:y}),f()}}),[C,f,v,t,y,S]),(0,g.jsx)(m().A,{type:"default",triggerActionMenuStore:o,onDone:()=>{A.current()},onClose:f,sections:[{key:"any",items:[{key:"any-option-item",action:()=>{!0===C?b([]):!1===C||"partial"===C?b(k):(0,c().HB)(C)},render:e=>(0,g.jsx)(i().A,{...e,icon:(0,g.jsx)(a().S,{checked:C,size:14,onClick:e.onClick}),title:(0,g.jsx)(u().sA,{id:"triggerPropertyChangedFilterMenu.anyOption.title",defaultMessage:"Any option"})})}],render:e=>(0,g.jsx)(l().A,{...e})},{key:"items",items:j,render:e=>(0,g.jsx)(l().A,{...e,topBorder:!0})}],headerTitle:(0,g.jsx)(u().sA,{id:"propertyChangedFilterHeader.status.title",defaultMessage:"{propertyName} set to",values:{propertyName:y.name}}),customMenuProps:{leftOuterStyle:{flex:"unset"},rightOuterStyle:{flex:"unset"},titleOuterStyle:{flex:"unset"},topbarStyle:{justifyContent:"space-between"}}})}},112588:(e,t,o)=>{o.d(t,{Y:()=>d,h:()=>p});o(944114),o(898992),o(354520),o(296540);var r=()=>o(590526),n=()=>o(764880),a=()=>o(927826),i=()=>o(437607),l=()=>o(546461),s=()=>o(397785),u=()=>o(989064),c=o(474848);function p(e){const{filter:t,propertySchema:o,onClick:n}=e,{automationStore:a}=(0,l().q8)(),i=(0,r().K8)((()=>d(t,a.getRecordModel)),[a.getRecordModel,t]),{title:p,tooltipTitle:m,styles:g}=(0,s().oG)({automationStore:a,actorOrGroupModels:i,messageType:"trigger",operator:t.operator,propertySchema:o});return(0,c.jsx)(u().z,{onClick:n,tooltip:(0,c.jsx)("span",{children:m}),children:(0,c.jsx)("div",{style:g.content,children:p})})}function d(e,t){const o=(0,a().W)(e),r=[];for(const a of o)if("exact"===a.type&&a.value)if("space_permission_group"===a.value.table){const e=t((0,i().S4)({spacePermissionGroupId:a.value.id,spaceId:a.value.spaceId}));r.push({type:"group",model:e})}else{const e=(0,n().xC)({pointer:a.value,getRecordModel:t});r.push({type:"actor",model:e})}return r}},113952:(e,t,o)=>{o.d(t,{N6:()=>n,_c:()=>i});const r=["enum_contains","enum_does_not_contain","enum_is","enum_is_not","is_empty","changes_to_any"];function n(e){const t=e;return r.includes(t)?t:"enum_contains"}const a=(0,o(69708).YK)({changesToAny:{id:"propertyTrigger.selectOperator.changesToAnyOption",defaultMessage:"Is edited"},isEmpty:{id:"propertyTrigger.selectOperator.isEmpty",defaultMessage:"Is cleared"},enumContains:{id:"propertyTrigger.selectOperator.enumContainsOption",defaultMessage:"Contains"},enumDoesNotContain:{id:"propertyTrigger.selectOperator.enumDoesNotContain",defaultMessage:"Does not contain"},enumIs:{id:"propertyTrigger.selectOperator.enumIs",defaultMessage:"Is"},enumIsNot:{id:"propertyTrigger.selectOperator.enumIsNot",defaultMessage:"Is not"}}),i={enum_contains:{hasInput:!0,isMulti:!0,isSingle:!1,labelText:a.enumContains,text:a.enumContains,value:"enum_contains"},enum_does_not_contain:{hasInput:!0,isMulti:!0,isSingle:!1,labelText:a.enumDoesNotContain,text:a.enumDoesNotContain,value:"enum_does_not_contain"},enum_is:{hasInput:!0,isMulti:!1,isSingle:!0,labelText:a.enumIs,text:a.enumIs,value:"enum_is"},enum_is_not:{hasInput:!0,isMulti:!1,isSingle:!0,labelText:a.enumIsNot,text:a.enumIsNot,value:"enum_is_not"},changes_to_any:{hasInput:!1,isMulti:!0,isSingle:!0,labelText:a.changesToAny,text:a.changesToAny,value:"changes_to_any"},is_empty:{hasInput:!1,isMulti:!0,isSingle:!0,labelText:a.isEmpty,text:a.isEmpty,value:"is_empty"}}},117862:(e,t,o)=>{o.d(t,{Y:()=>n,m:()=>a});var r=o(296540);const n=(0,r.createContext)({stepNumber:void 0});function a(){return(0,r.useContext)(n).stepNumber}n.displayName="AutomationStepNumberContext"},120423:(e,t,o)=>{o.d(t,{A:()=>d});o(581454),o(296540);var r=()=>o(726637),n=()=>o(401497),a=()=>o(81068),i=()=>o(736847),l=()=>o(942715),s=()=>o(352271),u=()=>o(69708),c=()=>o(100622),p=o(474848);function d({action:e,handleOnChange:t}){const o=(0,n().IS)((()=>({buttonStyle:{fontSize:r().A.isMobile?16:12,height:20,lineHeight:"unset",marginInlineEnd:0,paddingInlineStart:2,paddingInlineEnd:2,color:r().A.isMobile?c().Tj.palette.gray[900]:c().Tj.palette.gray[500]}})),[]),d=g[e||s().yP];return(0,p.jsx)(l().A,{alignmentToOrigin:"start",innerButtonStyle:o.buttonStyle,selectedTitle:(0,p.jsx)(u().sA,{...d.text}),renderMenuSections:e=>[{key:"ReplaceAddRemoveToggleOperator",render:e=>(0,p.jsx)(i().A,{...e}),items:Object.values(g).map((o=>({key:o.value,action:()=>{e.close(),t(void 0,o.value)},render:e=>(0,p.jsx)(a().A,{...e,title:(0,p.jsx)(u().sA,{...o.text})})})))}]})}const m=(0,u().YK)({replace:{id:"automations.propertyAction.button.replaceWith",defaultMessage:"Replace with..."},append:{id:"automations.propertyAction.button.add",defaultMessage:"Add..."},remove:{id:"automations.propertyAction.button.remove",defaultMessage:"Remove..."},toggle:{id:"automations.propertyAction.button.toggle",defaultMessage:"Toggle..."}}),g={replace:{text:m.replace,value:"replace"},append:{text:m.append,value:"append"},remove:{text:m.remove,value:"remove"},toggle:{text:m.toggle,value:"toggle"}}},142755:(e,t,o)=>{o.d(t,{F:()=>l});o(296540);var r=()=>o(401497),n=()=>o(718827),a=()=>o(100622),i=o(474848);function l(e){const{ariaLabel:t,disabled:o,icon:l,onClick:s,title:u}=e,c=(0,r().IS)((()=>({button:{alignItems:"center",border:`1px solid ${a().Tj.border.secondary}`,borderRadius:10,color:a().Tj.text.secondary,display:"flex",gap:8,justifyContent:"flex-start",padding:12},buttonHoveredStyle:{background:a().Tj.outlineButtonHoveredBackground},buttonPressedStyle:{background:a().Tj.buttonPressedBackground},iconContainer:{fill:a().Tj.icon.secondary,width:20,height:20,display:"flex",justifyContent:"center",alignItems:"center"},title:{fontSize:14,lineHeight:"20px"}})),[]);return(0,i.jsxs)(n().Ay,{ariaLabel:t,disabled:o,disabledFeedback:o,onClick:s,style:c.button,hoveredStyle:c.buttonHoveredStyle,pressedStyle:c.buttonPressedStyle,children:[l?(0,i.jsx)("div",{"aria-hidden":"true",style:c.iconContainer,children:l}):void 0,(0,i.jsx)("div",{style:c.title,children:u})]})}},153057:(e,t,o)=>{o.d(t,{A:()=>n});o(296540);const r={viewBox:"0 0 16 16",fittedViewBox:"3.66 2.37 8.68 11.26",svg:(0,o(474848).jsx)("path",{d:"M4.29 2.375a.625.625 0 0 0-.42 1.087L8.846 8l-4.978 4.538a.625.625 0 0 0 .421 1.087h7.42a.625.625 0 0 0 0-1.25H5.903l4.292-3.913a.625.625 0 0 0 0-.924L5.903 3.625h5.807a.625.625 0 0 0 0-1.25z"})},n=(0,o(340498).wt)("sumSmall",r,"small")},153893:(e,t,o)=>{o.d(t,{bK:()=>i,mK:()=>n});const r=["string_is","string_is_not","string_contains","string_does_not_contain","string_starts_with","string_ends_with","is_empty","changes_to_any"];function n(e){const t=e;return r.includes(t)?t:"string_is"}const a=(0,o(69708).YK)({changesToAny:{id:"propertyTrigger.textField.changesToAnyOption",defaultMessage:"Is edited"},isEmpty:{id:"propertyTrigger.textField.isEmpty",defaultMessage:"Is cleared"},stringIs:{id:"propertyTrigger.textField.stringIsOption",defaultMessage:"Is set to"},stringIsNot:{id:"propertyTrigger.textField.stringIsNotOption",defaultMessage:"Is not set to"},stringContains:{id:"propertyTrigger.textField.stringContainsOption",defaultMessage:"Contains"},stringDoesNotContain:{id:"propertyTrigger.textField.stringDoesNotContain",defaultMessage:"Does not contain"},stringStartsWith:{id:"propertyTrigger.textField.stringStartsWithOption",defaultMessage:"Starts with"},stringEndsWith:{id:"propertyTrigger.textField.stringEndsWithOption",defaultMessage:"Ends with"}}),i={string_is:{hasInput:!0,text:a.stringIs,value:"string_is"},string_is_not:{hasInput:!0,text:a.stringIsNot,value:"string_is_not"},string_contains:{hasInput:!0,text:a.stringContains,value:"string_contains"},string_does_not_contain:{hasInput:!0,text:a.stringDoesNotContain,value:"string_does_not_contain"},string_starts_with:{hasInput:!0,text:a.stringStartsWith,value:"string_starts_with"},string_ends_with:{hasInput:!0,text:a.stringEndsWith,value:"string_ends_with"},changes_to_any:{hasInput:!1,text:a.changesToAny,value:"changes_to_any"},is_empty:{text:a.isEmpty,value:"is_empty",hasInput:!1}}},159958:(e,t,o)=>{o.d(t,{Hn:()=>D,XN:()=>E,pj:()=>R,qj:()=>W});o(16280),o(944114),o(898992),o(354520),o(672577),o(581454),o(737550);var r=o(296540),n=()=>o(300474),a=()=>o(726637),i=()=>o(484714),l=()=>o(590526),s=()=>o(401497),u=()=>o(991003),c=()=>o(365917),p=()=>o(807449),d=()=>o(98126),m=()=>o(26697),g=()=>o(81068),y=()=>o(736847),h=()=>o(148307),f=()=>o(617871),v=()=>o(70899),x=()=>o(642557),S=()=>o(344417),b=()=>o(32527),C=()=>o(69708),k=()=>o(100622),j=()=>o(973647),A=()=>o(534177),T=()=>o(769864),M=()=>o(510683),I=()=>o(419357),P=()=>o(976792),_=()=>o(747938),w=()=>o(162969),V=o(474848);const N=(0,C().YK)({channelSearchPlaceholder:{id:"notificationRuleSettings.selectChannelView.searchInput.placeholder",defaultMessage:"Searchâ€¦"}});function R(e){const{currentNotificationChannels:t,onNotificationChannelSelect:o,onNotificationChannelSelectAll:v,onClose:x,onNewSlackAccountAdded:b,renderMenu:T,channelFilter:w,workflowExternalScopedConnectionPointer:R,isMultiSelectMode:O,shouldHideSlackAccountSection:W,shouldShowSelectAllChannels:L,isAllChannels:K,shouldShowImChannels:H,onClearSelection:z,shouldHideSelectedChannels:q=!1,searchPlaceholder:U=N.channelSearchPlaceholder,shouldShowTooltipsOnChannelNames:Y=!1,shouldShowFixedSearch:G=!1,moduleId:$,workflowId:Q}=e,J=(0,i().v3)(),Z=(0,C().tz)(),X=(0,l().O$)(c().A.completeSlackAuthentications),ee=e.currentExternalAuthentication??X[0],te=(0,r.useMemo)((()=>R?(0,P().zz)(R):ee?{type:"external",botId:ee.id}:void 0),[R,ee]);r.useEffect((()=>{const e=R?null==R?void 0:R.spaceId:null==ee?void 0:ee.space_id;te&&e&&D({environment:J,spaceId:e,externalAuthConfig:te,moduleId:$,workflowId:Q})}),[J,te,ee,R,$,Q]);const oe=(null==R?void 0:R.id)??(null==ee?void 0:ee.id),[re,ne]=r.useState(""),{loadedChannelsForAccount:ae,isLoading:ie}=E(te),le=(0,l().K8)((()=>c().A.integrations.state.find((e=>e.id===f().zG))),[]),se=(0,n().r)(),ue=r.useCallback((e=>{ee?o(e,ee.parent_id):R&&o(e,R.id),O||x()}),[o,ee,R,x,O]),ce=r.useCallback((()=>{const e=ee?ee.parent_id:null==R?void 0:R.id;e&&v&&v(e),O&&L||x()}),[ee,R,O,L,v,x]),pe=(0,s().IS)((()=>({icon:{marginInlineStart:8,width:12,height:12,color:k().Tj.text.tertiary},container:{backgroundColor:k().Tj.popoverBackground,marginTop:12,marginBottom:6},searchIcon:{width:14,height:14,marginInlineEnd:6,flexGrow:0,flexShrink:0,color:k().Tj.icon.primary},fixedSearchInput:{paddingBlock:4,borderBottom:`1px solid ${k().Tj.border.secondary}`}})),[]),de=r.useCallback((e=>{const{channel:o}=e,r=!K&&(null==t?void 0:t.some((e=>e.id===o.id)));if(!r||!q)return{key:o.id,render:e=>(0,V.jsx)(m().m,{renderTooltip:()=>o.name,disableTooltip:!Y,alignment:"center",placement:"right",render:t=>(0,V.jsx)(g().A,{...e,...t,icon:(0,V.jsx)(p().I,{icon:B({channel:o}),colorVariant:"tertiary",size:"sm"}),desktopIconStyle:{width:8},title:o.name,isChecked:r})}),action:()=>{ue(o)}}}),[K,t,ue,q,Y]),{publicChannels:me,privateChannels:ge,personalChannels:ye,imChannels:he}=r.useMemo((()=>function(e,t){const o=[],r=[],n=[],a=[];e.sort(((e,t)=>e.name.localeCompare(t.name)));for(const i of e)t&&!t(i)||("public"===i.type?o.push(i):"private"===i.type?r.push(i):"me"===i.type?n.push(i):"im"===i.type?a.push(i):(0,A().HB)(i.type));return{publicChannels:o,privateChannels:r,personalChannels:n,imChannels:a}}(ae,w)),[w,ae]),fe=r.useCallback((()=>me.map((e=>({menuListItem:de({channel:e}),channelName:e.name}))).filter(A().O9)),[me,de]),ve=r.useCallback((()=>ge.map((e=>({menuListItem:de({channel:e}),channelName:e.name}))).filter(A().O9)),[ge,de]),xe=r.useCallback((()=>ye.map((e=>({menuListItem:de({channel:e}),channelName:e.name}))).filter(A().O9)),[ye,de]),Se=r.useCallback((()=>he.map((e=>({menuListItem:de({channel:e}),channelName:e.name}))).filter(A().O9)),[he,de]),be=r.useCallback((()=>fe().map((({menuListItem:e,channelName:t})=>{if(F({channelName:t,query:re}))return e})).filter(A().O9)),[fe,re]),Ce=r.useCallback((()=>ve().map((({menuListItem:e,channelName:t})=>{if(F({channelName:t,query:re}))return e})).filter(A().O9)),[ve,re]),ke=r.useCallback((()=>xe().map((({menuListItem:e,channelName:t})=>{if(F({channelName:t,query:re}))return e})).filter(A().O9)),[xe,re]),je=r.useCallback((()=>Se().map((({menuListItem:e,channelName:t})=>{if(F({channelName:t,query:re}))return e})).filter(A().O9)),[Se,re]),Ae=r.useCallback((()=>ee?(0,_().qO)(ee).organizationName:"Workflows organization"),[ee]),Te=r.useCallback((()=>{if(!oe)return[];const e=[],o=be(),r=Ce(),n=ke(),a=je(),i=L&&O&&!re,l=Boolean(z&&!re&&((null==t?void 0:t.length)||K));return l&&z&&e.push({key:"clear-selection-section",render:e=>(0,V.jsx)(y().A,{...e}),items:[{key:"clear-selection",render:e=>(0,V.jsx)(g().A,{...e,title:(0,V.jsx)(C().sA,{id:"workflows.slack.clearSelection",defaultMessage:"Clear selection"}),isChecked:!1}),action:()=>z()}]}),i&&e.push({key:"select-all-channels",render:e=>(0,V.jsx)(y().A,{...e}),items:[{key:"all-channels",render:e=>(0,V.jsx)(g().A,{...e,title:(0,V.jsx)(C().sA,{id:"notificationRuleSettings.selectChannelView.selectAllChannels.label",defaultMessage:"All channels"}),isChecked:K}),action:ce}]}),n.length>0&&e.push({key:"personal-channels",render:e=>(0,V.jsx)(y().A,{...e,title:Ae(),topBorder:i||l}),items:n}),o.length>0&&e.push({key:"public-channels",render:e=>(0,V.jsx)(y().A,{...e,topBorder:n.length>0||i||l,title:0===n.length&&Ae()}),items:o}),r.length>0&&e.push({key:"private-channels",render:e=>(0,V.jsx)(y().A,{...e,topBorder:o.length>0||i||l,title:0===n.length&&o.length>0&&Ae()}),items:r}),H&&a.length>0&&e.push({key:"im-channels",render:e=>(0,V.jsx)(y().A,{...e,title:(0,V.jsx)(C().sA,{defaultMessage:"Direct Messages with Notion",id:"imChannels.title"})}),items:a}),e}),[oe,be,Ce,ke,je,L,O,re,z,null==t?void 0:t.length,K,H,ce,Ae]),Me=(0,u().A)(ie,500,300);if(!oe)return null;const Ie=[];return G||Ie.push({key:"search-input-section",items:[{key:"search-input-item",action:()=>{},render:e=>(0,V.jsx)("div",{children:(0,V.jsx)(I().Ay,{...e,inputLeft:(0,V.jsx)(I().Zf,{icon:S().magnifyingGlassSmallIcon}),inputRight:Me&&(0,V.jsx)(d().A,{style:{marginInlineEnd:2}}),showClearButton:!0,placeholder:Z.formatMessage(U),focusInitial:!a().A.isMobile,value:re,onChange:e=>{ne(e.target.value)}})})}],render:e=>(0,V.jsx)(y().A,{...e})}),Ie.push(...Te()),t||W||!le||Ie.push({key:"add-another-slack-account-section",items:[{key:"add-another-slack-account-item",action:async()=>{if(!se)return;const e=await M().Jq({environment:J,integration:le,spaceId:se,from:"collection_view_settings"});j().Q.isFail(e)||b()},render:e=>(0,V.jsx)(g().A,{...e,icon:(0,V.jsx)("img",{src:h().A.images.externalIntegrations.slackIconPng,style:{width:18,height:"auto"}}),title:(0,V.jsx)(C().sA,{id:"notificationRuleSettings.selectChannelView.setupAnotherSlackAccount.label",defaultMessage:"Add another Slack account"})})}],render:e=>(0,V.jsx)(y().A,{...e,topBorder:!0})}),(0,V.jsxs)(V.Fragment,{children:[G?(0,V.jsx)("div",{style:pe.fixedSearchInput,children:(0,V.jsx)(I().Ay,{...e,inputLeft:(0,V.jsx)(I().Zf,{icon:S().magnifyingGlassSmallIcon}),inputRight:Me&&(0,V.jsx)(d().A,{style:{marginInlineEnd:2}}),showClearButton:!0,placeholder:Z.formatMessage(U),focusInitial:!a().A.isMobile,value:re,onChange:e=>{ne(e.target.value)}})}):void 0,T(Ie)]})}function F(e){const{channelName:t,query:o}=e;return 0===o.length||t.toLocaleLowerCase().indexOf(o.trim().toLocaleLowerCase())>=0}function B(e){const{channel:t}=e;return"private"===t.type?x().lockSmallIcon:"me"===t.type||"im"===t.type?v().U:b().E}const O=15e3;function E(e){const t=(0,l().K8)((()=>{if(e)return w().c.getStateForBot(e)}),[e],{useDeepEqual:!0});return{loadedChannelsForAccount:(0,r.useMemo)((()=>null!=t&&t.channels?Object.values(t.channels):[]),[null==t?void 0:t.channels]),isLoading:(null==t?void 0:t.fetching)??!1}}async function D(e){const{environment:t,externalAuthConfig:o,spaceId:r,moduleId:n,workflowId:a}=e,i=w().c.getStateForBot(o);if(!(i.fetching||Date.now()-i.lastRefreshed<O)){if(w().c.updateStateForBot(o,{fetching:!0,lastRefreshed:Date.now(),failed:!1}),"workflow"===o.type&&n&&a){const e=await T().callApi({eventName:"getViaWorkflowModuleConfigurationUtil",environment:t,data:{workflowId:a,moduleId:n,spaceId:r,moduleType:"slack",callArguments:{functionName:"getExistingSlackChannels",functionArgs:[]}}});if("success"===e.type){if("getExistingSlackChannels"!==e.data.functionName)throw new Error("Invalid function name");w().c.addChannelsForBot(o,e.data.functionReturn)}else w().c.updateStateForBot(o,{failed:!0})}else{let e;for(;;){const n=await T().callApi({eventName:"getExternalNotificationChannels",environment:t,data:{spaceId:r,cursor:e,...o}});if("success"!==n.type){w().c.updateStateForBot(o,{failed:!0}),console.error(n.error);break}{const t={};for(const e of n.data.channels)t[e.id]=e;if(w().c.addChannelsForBot(o,t),e=n.data.cursor,!e)break}await new Promise((e=>setTimeout(e,0)))}}w().c.updateStateForBot(o,{fetching:!1})}}const W=r.forwardRef(((e,t)=>{const{channel:o,currentNotificationChannels:r,...n}=e;return(0,V.jsx)(g().A,{ref:t,...n,icon:(0,V.jsx)(p().I,{icon:B({channel:o}),colorVariant:"tertiary",size:"sm"}),desktopIconStyle:{width:8},title:o.name,isChecked:null==r?void 0:r.some((e=>e.id===o.id))})}));W.displayName="SlackChannelMenuItem"},160988:(e,t,o)=>{o.d(t,{xB:()=>H,Kn:()=>$,ck:()=>U,vV:()=>q});o(898992),o(737550);var r=o(296540),n=()=>o(726637),a=()=>o(590526),i=()=>o(401497),l=()=>o(250910),s=()=>o(807449),u=()=>o(695115),c=()=>o(863330),p=()=>o(69708),d=()=>o(100622),m=()=>o(534177),g=()=>o(284371),y=(o(354520),o(581454),()=>o(81068)),h=()=>o(736847),f=()=>o(942715),v=o(474848);function x({disabled:e,handleSelectOperator:t,selectedItem:o}){const a=(0,i().IS)((()=>({buttonWrap:{height:"initial"},buttonStyle:{fontSize:n().A.isMobile?14:12,height:18,lineHeight:"unset",marginInlineEnd:2,marginInlineStart:2,paddingInlineStart:2,paddingInlineEnd:2,textTransform:"lowercase",fontWeight:g().Wy.semibold,...e?{opacity:"unset",color:"unset"}:{color:d().Tj.text.tertiary}}})),[e]),l=Object.values(b).filter((e=>e.shown)),s=(0,r.useMemo)((()=>b[o].shown?b[o]:b.all),[o]);return(0,v.jsx)(f().A,{disabled:e,alignmentToOrigin:"start",style:a.buttonWrap,innerButtonStyle:a.buttonStyle,selectedTitle:(0,v.jsx)(p().sA,{...s.text}),renderMenuSections:e=>[{key:"selectTriggerOperator",render:e=>(0,v.jsx)(h().A,{...e}),items:l.map((o=>({key:o.value,action:()=>{t(o.value),e.close()},render:e=>(0,v.jsx)(y().A,{...e,title:(0,v.jsx)(p().sA,{...o.text})})})))}]})}const S=(0,p().YK)({all:{id:"automations.builderModal.propertyTrigger.all",defaultMessage:"All"},any:{id:"automations.builderModal.propertyTrigger.any",defaultMessage:"Any"}}),b={all:{text:S.all,value:"all",shown:!0},some:{text:S.any,value:"some",shown:!0},none:{shown:!1,value:"none"},any:{shown:!1,value:"any"}};var C=()=>o(546461),k=()=>o(656134),j=()=>o(813716),A=()=>o(142755),T=()=>o(675326),M=()=>o(214973),I=()=>o(997939);function P(){const e=(0,p().tz)(),{automationStore:t}=(0,C().q8)();if(!w(t))return null;const o=e.formatMessage(M().CV.triggerButtonClicked,{b:_});return(0,v.jsx)(I().X,{icon:T().S,tooltip:o,children:o})}function _(e){return(0,v.jsx)("span",{style:{fontWeight:g().Wy.medium},children:e})}function w(e){return(0,a().K8)((()=>Boolean(null==e?void 0:e.isTriggerType("button"))),[e])}function V(){const{automationStore:e}=(0,C().q8)(),{removePageAddedTrigger:t}=(0,j().p)(),o=(0,p().tz)(),r=(0,i().IS)((()=>({title:{fontWeight:g().Wy.medium}})),[]);if(!N(e))return null;const n=M().CH(o);return(0,v.jsx)(I().X,{icon:c().plusSmallIcon,onDelete:t,tooltip:n,children:(0,v.jsx)("div",{style:r.title,children:n})})}function N(e){return(0,a().K8)((()=>{if(null==e||!e.isTriggerType("event"))return!1;const t=e.getEventConfiguration();return Boolean(null==t?void 0:t.pagesAdded)}),[e])}var R=()=>o(897499),F=()=>o(892591),B=()=>o(970236),O=()=>o(740689),E=()=>o(104636),D=()=>o(548526),W=()=>o(621627);function L(){const{automationStore:e}=(0,C().q8)(),{removeRecurrenceTrigger:t}=(0,j().p)(),o=(0,i().IS)((()=>({title:{fontWeight:g().Wy.medium,display:"flex",gap:6,alignItems:"center"},badgeContainer:{alignItems:"center",display:"flex"},badge:{backgroundColor:d().Tj.background.tertiaryTranslucent,color:d().Tj.text.secondary,marginInlineStart:8}})),[]),r=function(e){return(0,a().K8)((()=>Boolean(null==e?void 0:e.isTriggerType("recurrence"))),[e])}(e),n=(0,a().K8)((()=>(0,E().NH)(e)),[e]);return r?(0,v.jsx)(I().X,{icon:O().o,onDelete:t,children:(0,v.jsxs)("div",{style:o.title,children:[(0,v.jsx)(p().sA,{id:"RecurrenceTrigger.title",defaultMessage:"<span>Every </span>{frequency}",values:{frequency:(0,v.jsx)(K,{}),span:e=>(0,v.jsx)("span",{style:{flex:0},children:e})}}),n?(0,v.jsx)(B().E,{style:o.badge,content:(0,v.jsx)("div",{style:o.badgeContainer,children:(0,v.jsx)(p().sA,{defaultMessage:"Completed",id:"automationSummaryCard.completedToken"})})}):void 0]})}):null}function K(){const e=(0,p().tz)(),{automationStore:t}=(0,C().q8)(),{changeRecurrenceSchedule:o}=(0,j().p)(),r=(0,a().K8)((()=>t.getRecurrence()),[t]),i=r?(0,E().LS)({intl:e,recurrence:r}):(0,v.jsx)(p().sA,{id:"RecurrenceTrigger.frequency",defaultMessage:"frequency"}),s=(0,W().$)({recurrence:r,onChange:o,disabled:!1,autoFocusIfNew:!0});return(0,v.jsx)(l().A,{...s,popupType:n().A.isMobile?l().z.SlideUp:l().z.Popup,placementToOrigin:"bottom",renderOrigin:e=>(0,v.jsx)(D().x,{...e,isCompact:!0,dropdownButtonType:"dropdown",hasActionRequired:!(0,m().O9)(r),children:i})})}const H="automation-list-item automation-list-item-modal",z=(0,p().YK)({newTriggerLabel:{defaultMessage:"New trigger",id:"collectionSettings.editAutomationView.triggerSection.newPlaceholder"},addTriggerLabel:{defaultMessage:"Add trigger",id:"collectionSettings.editAutomationView.triggerSection.placeholder"},addTriggerAriaLabel:{id:"collectionSettings.editAutomationView.addTrigger.iconButton",defaultMessage:"Add trigger"},builderModalTriggerTitleWithOperatorButton:{defaultMessage:"When {operatorButton} triggers occur",id:"builderModal.editAutomationView.triggerSection.titleWithOperator"},buttonBuilderTriggerTitleOrNoTriggers:{defaultMessage:"When",id:"builderModal.editAutomationView.buttonBuilderTriggerSection.title"}});function q(){return(0,i().IS)((()=>({wrap:{position:"relative",paddingInline:1},list:{display:"flex",flexDirection:"column"}})),[])}function U(e){const{children:t}=e;return(0,v.jsx)("div",{className:H,children:t})}function Y(e){const{children:t}=e,o=q();return(0,v.jsx)("div",{style:o.wrap,children:(0,v.jsx)("div",{style:o.list,children:t})})}function G(e){const{variant:t,hasAnyTriggers:o,disabled:n}=e,a=(0,k().j)(),i=(0,p().tz)(),d=(0,r.useMemo)((()=>({type:"eventTriggers"})),[]);return(0,v.jsx)(l().A,{alignmentToOrigin:"start",placementToOrigin:"bottom",popupType:a,render:e=>(0,v.jsx)(F().A,{initialState:d,buttonPopupParent:e}),renderOrigin:e=>"icon"===t?(0,v.jsx)(u().A,{...e,ariaLabel:i.formatMessage(o?z.addTriggerLabel:z.newTriggerLabel),icon:c().plusSmallIcon,disabled:n}):(0,v.jsx)(A().F,{...e,ariaLabel:i.formatMessage(z.addTriggerAriaLabel),icon:(0,v.jsx)(s().I,{icon:c().plusSmallIcon,size:"sm"}),disabled:n,title:(0,v.jsx)(p().sA,{...o?z.addTriggerLabel:z.newTriggerLabel})})})}function $(e){const{isEditable:t}=e,{showAnyPropertyTriggers:o,showButtonClickedTrigger:r,showPageAddedTrigger:l,showRecurrenceTrigger:s}=function(){const{automationStore:e}=(0,C().q8)(),t=w(e),o=N(e),r=(0,R().CD)(e),n=(0,a().K8)((()=>Boolean(e.isTriggerType("recurrence"))),[e]);return{showAnyPropertyTriggers:r,showPageAddedTrigger:o,showButtonClickedTrigger:t,showRecurrenceTrigger:n}}(),u=o||r||l||s,c=!s,m=(0,i().IS)((()=>({section:{display:"flex",flexDirection:"column",gap:4,width:"100%"},header:{alignItems:"center",display:"flex",flexDirection:"row"},title:{color:d().Tj.text.tertiary,fontSize:n().A.isMobile?14:12,lineHeight:1.3,fontWeight:g().Wy.medium}})),[]),{contextType:y}=(0,C().q8)(),h="button_property"===y||"button_block"===y;return(0,v.jsxs)("section",{style:m.section,children:[(0,v.jsx)("header",{style:m.header,children:(0,v.jsx)("div",{style:m.title,children:h?(0,v.jsx)(p().sA,{...z.buttonBuilderTriggerTitleOrNoTriggers}):(0,v.jsx)(Q,{disabled:!t})})}),(0,v.jsxs)(Y,{children:[r?(0,v.jsx)(P,{}):void 0,l?(0,v.jsx)(V,{}):void 0,o?(0,v.jsx)(R().Js,{}):void 0,t&&c||!u?(0,v.jsx)(G,{hasAnyTriggers:u,variant:"button",disabled:!t}):void 0,s?(0,v.jsx)(L,{}):void 0]})]})}function Q({disabled:e}){const{automationStore:t}=(0,C().q8)(),{updateTriggerOperator:o}=(0,j().p)(),n=(0,a().K8)((()=>{if(null==t||!t.isTriggerType("event"))return"some";const e=t.getEventConfiguration();return(null==e?void 0:e.pagePropertiesEdited.type)||"all"}),[t]),l=(0,a().K8)((()=>{if(null==t||!t.isTriggerType("event"))return 0;const e=t.getEventConfiguration(),o=null==e?void 0:e.pagePropertiesEdited;return o?"any"===o.type||"none"===o.type?0:"all"===o.type?(null===(r=o.all)||void 0===r?void 0:r.length)??0:"some"===o.type?(null===(n=o.some)||void 0===n?void 0:n.length)??0:void(0,m().HB)(o):0;var r,n}),[t]),s=(0,r.useCallback)((e=>{o(e)}),[o]),u=(0,i().IS)((()=>({title:{alignItems:"center",display:"flex",flexWrap:"wrap",height:24}})),[]);return(0,v.jsx)("div",{style:u.title,children:(0,v.jsx)(p().sA,{...l>0?z.builderModalTriggerTitleWithOperatorButton:z.buttonBuilderTriggerTitleOrNoTriggers,values:{operatorButton:(0,v.jsx)(x,{disabled:e,handleSelectOperator:s,selectedItem:n})}})})}},162969:(e,t,o)=>{o.d(t,{c:()=>i,m:()=>n});function r(e){switch(e.type){case"external":return`external-${e.botId}`;case"workflow":return`workflow-${e.workflowExternalScopedConnectionId}`;case"workflowExternal":return`workflowExternal-${e.externalConnectionId}`;case"universal":return`universal-${e.app}-${e.spaceId}`;default:throw(0,o(534177).HB)(e)}}const n={channels:{},fetching:!1,lastRefreshed:0,failed:!1};class a extends(()=>o(757695))().Store{getStateForBot(e){const t=r(e);return this.state[t]??n}updateStateForBot(e,t){this.setState({...this.state,[r(e)]:{...this.getStateForBot(e),...t}})}addChannelsForBot(e,t){const o=this.getStateForBot(e);this.setState({...this.state,[r(e)]:{...o,channels:{...o.channels,...t}}})}}const i=new a;(0,o(852832).exposeDebugValue)("ExternalNotificationChannelsStore",i)},166006:(e,t,o)=>{o.d(t,{Y:()=>j});var r=o(296540),n=()=>o(908006),a=()=>o(590526),i=()=>o(401497),l=()=>o(587031),s=()=>o(755125),u=()=>o(232615),c=()=>o(699143),p=()=>o(250910),d=()=>o(100622),m=()=>o(496603),g=()=>o(534177),y=()=>o(37450),h=()=>o(689355),f=()=>o(673477),v=()=>o(340498),x=()=>o(69708),S=o(474848);const b=(0,x().YK)({simpleFormulaMentionActionButtonAriaLabel:{id:"formulas.simpleFormulaMentionActionButton.ariaLabel",defaultMessage:"Mentions"},simpleFormulaMentionActionButtonTooltip:{id:"formulas.simpleFormulaMentionActionButton.tooltip",defaultMessage:"Mention a person, page, or date"}});function C(e){const{disabled:t,onClick:n}=e,a=(0,x().tz)(),l=(0,i().IS)((()=>({formulaIcon:{fill:d().Tj.icon.secondary,height:v().Ev.sm,width:v().Ev.sm},button:{height:20,width:20,borderRadius:4}})),[]),s=(0,r.useCallback)((()=>a.formatMessage(b.simpleFormulaMentionActionButtonTooltip)),[a]),u=(0,r.useCallback)((e=>(0,S.jsx)(o(695115).A,{...e,ariaLabel:a.formatMessage(b.simpleFormulaMentionActionButtonAriaLabel),disabled:t,disabledFeedback:t,icon:o(70899).U,iconStyle:l.formulaIcon,onClick:n,style:l.button})),[t,a,n,l]);return(0,S.jsx)(o(26697).m,{disableTooltip:t,renderTooltip:s,placement:"bottom",render:u})}var k=()=>o(805452);const j=r.forwardRef((function(e,t){const{allowedReturnTypes:v,disabled:x,disabledMentionTypes:b,disableEmojiCommands:j,disableFilters:A,disableFormulas:T,disableInsertedDeletedAnnotations:M,disableMentions:I,disableMobileActionBar:P,disableNewLines:_,disableStyleAnnotations:w,formulaInputButtonPopupStore:V,formulaTypecheckContextValues:N,onChange:R,onTextEnter:F,onTextStoreSelect:B,onTextStoreUnselect:O,onTextEsc:E,parentRecordStore:D,placeholder:W,rows:L,shouldShowErrorStyles:K,spaceId:H,style:z,value:q}=e,U=Boolean(x),Y=(0,o(792485).S)(),G=(0,o(484714).v3)(),$=(0,r.useRef)(null),Q=(0,a().uB)(V,o(118307).A),[J,Z,X]=r.useMemo((()=>{var e;const t=(null==q?void 0:q.type)??"simple",r=null==q?void 0:q.value;return[t,r,(0,g().O9)(r)?(null===(e=o(201980).q4_(r).match(/\n/g))||void 0===e?void 0:e.length)??0:0]}),[null==q?void 0:q.type,null==q?void 0:q.value]),ee="formula"===J,te=(0,r.useMemo)((()=>X>0||void 0!==L&&L>1),[X,L]),oe=r.useRef(!1),re=(0,r.useMemo)((()=>{if(R)return function(e){oe.current?oe.current=!1:R({type:J,value:e})}}),[R,J]),ne=(0,o(546461).K4)(),ae=null==ne?void 0:ne.automationStore,ie=(0,r.useMemo)((()=>ae?{automation_id:[[ae.id]]}:void 0),[ae]),{setValue:le,store:se}=(0,o(483795).AI)({initialValue:Z,onChange:re,properties:ie,shouldUseDefaultRecordCacheFallback:!0}),ue=(0,a().K8)((()=>se.getValue()),[se]);r.useEffect((()=>{(0,m().n4)(Z,ue)||(oe.current=!0,le(Z))}),[ue,le,Z]);const ce=r.useRef(N);r.useEffect((()=>{(0,m().n4)(N,ce.current)||(ce.current=N,(0,m().n4)(Z,ue)||(oe.current=!0),le(Z))}),[N,ue,le,Z]);const pe=(0,a().K8)((()=>!1!==(0,o(142096).j)(se)),[se]);r.useEffect((()=>{if(pe)return null==B||B(),function(){null==O||O()}}),[pe,B,O]);const de=(0,r.useMemo)((()=>({...b,reminder:!0,property:!0})),[b]),me=(0,r.useMemo)((()=>_?F:function(){const e=u().default.state;"editing"===e.mode&&o(547149).createAndCommit({userAction:"SimpleFormulaValueTextInput.handleEnter",environment:G,canUndo:!0,perform:t=>{o(295304).$D({disableEmojiCommands:!0,disableMentions:!0,disableSlashCommands:!0,editorMode:"default",environment:G,multiSelection:e.multiSelection,string:"\n",transaction:t})}}),null==F||F()}),[G,_,F]),ge=(0,r.useCallback)((()=>{const e=u().default.state;"editing"===e.mode&&(0,o(843427).K)(e.multiSelection)&&e.multiSelection.start.store===se||((0,o(260850).z)({store:se}),n().default.afterNextFlush((()=>{const e=null==$?void 0:$.current,t=null==e?void 0:e.getNode();t&&t.scrollTo({top:t.scrollHeight})})))}),[$,se]),ye=r.useRef(!1),he=r.useCallback((()=>{ye.current||((0,f().q6)(),(0,l().V)({dismissed:!1,trackCreateBlock:y().vH}),(0,h().V)()),ye.current=!1,ge()}),[ge]),fe=(0,r.useCallback)((e=>null==R?void 0:R(e)),[R]),ve=(0,r.useCallback)((e=>{e.stopPropagation(),async function(){ye.current=!0,(0,f().q6)(),null==B||B(),ge(),await n().default.afterNextFlush(),o(829300).Gf({environment:G,spaceStore:null==Y?void 0:Y.spaceStore,mentionSectionOrdering:["custom-formula","formula"],mentionTypes:{bot:!0,createPage:!1,date:!0,formulaContextVariable:!0,group:!0,team:!0,heading:!0,inviteUserToPage:!1,inviteUserToWorkspace:!1,page:!0,collection:!1,reminder:!1,templateVariable:!1,user:!0,slackSpecialMention:!1,property:!1}})}()}),[G,B,null==Y?void 0:Y.spaceStore,ge]),xe=(0,r.useCallback)((e=>{ge(),e.stopPropagation()}),[ge]),Se=(0,r.useCallback)((e=>{if(e.relatedTarget&&(e.currentTarget.contains(e.relatedTarget)||(0,o(253579).Rp)(e.relatedTarget)))return;const t=u().default.getState();if("editing"!==t.mode)return;t.multiSelection.start.store.id===se.id&&(0,s().clear)({environment:G}),(0,f().q6)(),(0,l().V)({dismissed:!1,trackCreateBlock:y().vH}),(0,h().V)()}),[G,se.id]),be=r.useCallback((async()=>{if("formula"===J){if(await(0,k().Cp)()){const e=(0,k().D2)(null==q?void 0:q.value);null==R||R(e)}}else"simple"===J?Q.setState({open:!0}):(0,g().HB)(J)}),[Q,R,null==q?void 0:q.value,J]),Ce=(0,r.useCallback)((()=>Q.setState({open:!1})),[Q]),ke=(0,r.useCallback)((()=>ge()),[ge]),je=(0,r.useCallback)((()=>{pe&&(0,s().clear)({environment:G})}),[G,pe]);r.useImperativeHandle(t,(()=>({blur:je,focus:ke})),[je,ke]);const Ae=(0,i().IS)((()=>{const e={whiteSpace:"pre-wrap",lineHeight:"20px",padding:"2px 4px",fontSize:14};return{containerWrap:{width:200,...z},formulaText:{...e,cursor:"pointer"},scroller:{flexGrow:1,height:void 0!==L?`calc(1em * ${1.5*L})`:void 0,maxHeight:"calc(1em * 6)",width:void 0!==L&&L>1||te?"100%":"auto"},text:{...e},textWrap:{cursor:"text",display:"flex",flexWrap:"wrap",justifyContent:"end",opacity:U?.4:void 0,width:"100%"},wrap:{background:d().Tj.inputBackground,borderRadius:6,boxShadow:d().Tj.inputBoxShadow,boxSizing:"border-box",cursor:"text",padding:2,...K&&{border:`1px solid ${d().Tj.red.text.accentPrimary}`,boxShadow:"none"}},actionButtonGroup:{alignSelf:"end",cursor:"unset",justifyContent:"end",paddingTop:2,paddingInlineEnd:2,paddingBottom:2,paddingInlineStart:0}}}),[U,te,L,K,z]),Te=!I||!T,Me=I||ee;return(0,S.jsx)(p().A,{buttonPopupStore:Q,popupType:o(726637).A.isMobile?p().z.SlideUp:p().z.Popup,render:()=>(0,S.jsx)(o(227124).A,{allowedReturnTypes:v,disabled:U,formulaTypecheckContextValues:N??[],onChange:fe,onClose:Ce,parentRecordStore:D,restrictUnaccessibleProperties:"cross_space_and_read_permissions",spaceId:H,value:q}),renderOrigin:e=>(0,S.jsx)("div",{onClick:xe,style:Ae.containerWrap,onBlur:Se,children:(0,S.jsx)(c().Y1,{align:"center",className:o(882722).CCX,direction:"vertical",gap:4,style:Ae.wrap,children:(0,S.jsxs)("div",{style:Ae.textWrap,children:[(0,S.jsx)(o(917150)._,{ref:$,style:Ae.scroller,type:o(611648).A.Y,children:"simple"===J?(0,S.jsx)(o(729368).A,{disableComment:!0,disabled:U,disabledMentionTypes:de,disableEmbedMenu:!0,disableEmojiCommands:j,disableFilters:A,disableInsertedDeletedAnnotations:M,disableMentions:I,disableMobileActionBar:P,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableShiftEnter:_,disableSlashCommands:!0,disableStyleAnnotations:w,formulaValueTypes:N??[],inPageFind:o(366437).Os.none,mentionSectionOrdering:["custom-formula","formula"],onDown:m().D_,onEnter:me,onFocus:he,onTab:m().D_,onUntab:m().D_,onUp:m().D_,onEsc:E,pasteBehavior:"inline",placeholder:W,store:se,style:Ae.text}):(0,S.jsx)("div",{...e,style:Ae.formulaText,children:(0,S.jsx)(o(475403).$,{formulaTypecheckContextValues:N,parentRecordStore:D,spaceId:H,value:q})})}),Te?(0,S.jsx)("div",{children:(0,S.jsxs)(c().Y1,{direction:"horizontal",gap:2,style:Ae.actionButtonGroup,children:[Me?void 0:(0,S.jsx)(C,{disabled:U,onClick:ve}),T?void 0:(0,S.jsx)(o(304359).F,{disabled:U,onClick:be,value:q})]})}):void 0]})})})})}))},214973:(e,t,o)=>{o.d(t,{$B:()=>p,CH:()=>j,CV:()=>a,Ee:()=>V,Fp:()=>L,HG:()=>A,JQ:()=>f,LK:()=>C,NW:()=>l,Od:()=>M,Oo:()=>s,Pb:()=>d,Pg:()=>T,Q$:()=>R,Re:()=>F,Rn:()=>_,SV:()=>x,T2:()=>I,TF:()=>h,Xr:()=>i,Yx:()=>B,_M:()=>S,_d:()=>D,_f:()=>v,a9:()=>E,cC:()=>k,dd:()=>W,f4:()=>g,f_:()=>m,iy:()=>O,kN:()=>K,n1:()=>N,o7:()=>c,qx:()=>b,rh:()=>w,uW:()=>y,vC:()=>u,yR:()=>P});o(898992),o(354520),o(581454);var r=()=>o(713998),n=()=>o(496401);const a=(0,o(69708).YK)({actionCheckboxPropertyChecked:{defaultMessage:"checked",id:"automations.action.checkboxProperty.checked"},actionCheckboxPropertySetSingle:{defaultMessage:"Set {propertyName} to {propertyValue}",id:"automations.action.checkboxProperty.single"},actionCheckboxPropertyUnchecked:{defaultMessage:"unchecked",id:"automations.action.checkboxProperty.unchecked"},actionDatePropertySetSingle:{defaultMessage:"Set {propertyName} to {propertyValue}",id:"automations.action.dateProperty.single"},actionNumberPropertySet:{defaultMessage:"{propertyName} {operator} {propertyValues}",id:"automations.action.numberPropertySet.title"},actionTextPropertySet:{defaultMessage:"{propertyName} {operator} {propertyValues}",id:"automations.action.textPropertySet.title"},actionPersonPropertySetSingle:{defaultMessage:"Set {propertyName} to {propertyValue}",id:"automations.action.personProperty.single"},actionPropertyReplaceWith:{defaultMessage:"Replace {propertyName} with {propertyValue}",id:"automations.action.property.replaceWith"},actionPropertyReplaceWithOthers:{defaultMessage:"Replace {propertyName} with {propertyValue} and {numOthers} {numOthers, plural, one {other} other {others}}",id:"automations.action.property.replaceWithOthers"},actionPropertyAdd:{defaultMessage:"Add {propertyValue} to {propertyName}",id:"automations.action.property.add"},actionPropertyAddWithOthers:{defaultMessage:"Add {propertyValue} and {numOthers} {numOthers, plural, one {other} other {others}} to {propertyName}",id:"automations.action.property.addWithOthers"},actionPropertyRemove:{defaultMessage:"Remove {propertyValue} from {propertyName}",id:"automations.action.property.remove"},actionPropertyRemoveWithOthers:{defaultMessage:"Remove {propertyValue} and {numOthers} {numOthers, plural, one {other} other {others}} from {propertyName}",id:"automations.action.property.removeWithOthers"},actionPropertyClear:{defaultMessage:"Clear {propertyName}",id:"automations.action.property.clear"},actionPropertyToggle:{defaultMessage:"Toggle {propertyValue} in {propertyName}",id:"automations.action.property.toggle"},actionPropertyToggleWithOthers:{defaultMessage:"Toggle {propertyValue} and {numOthers} {numOthers, plural, one {other} other {others}} in {propertyName}",id:"automations.action.property.toggleWithOthers"},actionRelationPropertySetSingle:{defaultMessage:"Set {propertyName} to {propertyValue}",id:"automations.action.relationProperty.single"},actionSelectPropertySetSingle:{defaultMessage:"Set {propertyName} to {propertyValue}",id:"automations.action.selectProperty.single"},actionStatusPropertySetSingle:{defaultMessage:"Set {propertyName} to {propertyValue}",id:"automations.action.statusProperty.single"},actionTextPropertySetSingle:{defaultMessage:"Set {propertyName} to {propertyValue}",id:"automations.action.textProperty.single"},actionDeletedProperty:{defaultMessage:"Edit a deleted property",id:"automations.action.deletedProperty"},triggerAnyPageAdded:{defaultMessage:"Page added",id:"automations.trigger.pageAdded.title"},triggerAnyPagePropertyEdit:{defaultMessage:"Any property edited",id:"automations.trigger.anyPagePropertyEdited.title"},triggerAnyPropertyEdit:{defaultMessage:"{propertyName} is edited",id:"automations.trigger.propertyChangesToAny.title"},triggerAnyPropertyClear:{defaultMessage:"{propertyName} is cleared",id:"automations.trigger.propertyCleared.title"},triggerButtonClicked:{defaultMessage:"<b>Button</b> is clicked",id:"automations.trigger.button.clicked"},triggerCheckboxPropertyChecked:{defaultMessage:"checked",id:"automations.trigger.checkboxProperty.checked"},triggerCheckboxPropertySet:{defaultMessage:"{propertyName} set to {propertyValues}",id:"automations.trigger.checkboxPropertySet.title"},triggerCheckboxPropertyUnchecked:{defaultMessage:"unchecked",id:"automations.trigger.checkboxProperty.unchecked"},triggerNumberPropertySet:{defaultMessage:"{propertyName} {operator} {propertyValues}",id:"automations.trigger.numberPropertySet.title"},triggerTextPropertySet:{defaultMessage:"{propertyName} {operator} {propertyValues}",id:"automations.trigger.textPropertySet.title"},triggerSelectPropertyIs:{id:"automations.trigger.selectPropertyIs.title",defaultMessage:"{propertyName} is set to {propertyValues}"},triggerSelectPropertyIsNot:{id:"automations.trigger.selectPropertyIsNot.title",defaultMessage:"{propertyName} is not set to {propertyValues}"},triggerMultiSelectPropertyContains:{id:"automations.trigger.multiSelectPropertyContains.title",defaultMessage:"{propertyName} contains {propertyValues}"},triggerMultiSelectPropertyDoesNotContain:{id:"automations.trigger.multiSelectPropertyDoesNotContain.title",defaultMessage:"{propertyName} does not contain {propertyValues}"},triggerStatusPropertySet:{defaultMessage:"{propertyName} set to {propertyValues}",id:"automations.trigger.statusPropertySet.singleProperty"},triggerPersonPropertyContainsSingle:{defaultMessage:"{propertyName} contains {propertyValue}",id:"automations.trigger.personPropertySet.singleProperty"},triggerPersonPropertyContainsMultiple:{defaultMessage:"{propertyName} contains any of {propertyValues}",id:"automations.trigger.personPropertySet.multipleProperties"},triggerPersonPropertyDoesNotContainSingle:{defaultMessage:"{propertyName} does not contain {propertyValue}",id:"automations.trigger.personPropertyDoesNotContain.singleProperty"},triggerPersonPropertyDoesNotContainMultiple:{defaultMessage:"{propertyName} does not contain any of {propertyValues}",id:"automations.trigger.personPropertyDoesNotContain.multipleProperties"},triggerRelationPropertyDoesNotContainSingle:{defaultMessage:"{propertyName} does not contain {propertyValue}",id:"automations.trigger.relationProperty.singleDoesNotContain"},triggerRelationPropertyDoesNotContainMultiple:{defaultMessage:"{propertyName} does not contain any of {propertyValue}",id:"automations.trigger.relationProperty.multipleDoesNotContain"},triggerRelationPropertyContainsMultiple:{defaultMessage:"{propertyName} contains any of {propertyValue}",id:"automations.trigger.relationProperty.multiple"},triggerRelationPropertyContainsSingle:{defaultMessage:"{propertyName} contains {propertyValue}",id:"automations.trigger.relationProperty.single"},triggerDeletedPropertyEdit:{defaultMessage:"Deleted property is edited",id:"automations.trigger.deletedPropertyEdited"},deletedPropertyOption:{defaultMessage:"Deleted option",id:"automations.values.deletedPropertyOption"},unknownValue:{defaultMessage:"Unknown value",id:"automations.values.unknownValue"},unknownPropertyTitle:{defaultMessage:"a property",id:"database.viewSettings.automationTab.unknownPropertyTitle"},triggerInvalidConfigurationTitle:{defaultMessage:"Invalid {propertyName} property configuration",id:"automations.trigger.invalidConfiguration"},inlineCustomFormulaDefaultName:{defaultMessage:"My value",id:"automations.formulas.inlineCustomFormulaDefaultName"}});function i(e){const{propertyName:t,propertyValue:o}=e;return{...a.actionCheckboxPropertySetSingle,values:{propertyName:t,propertyValue:o}}}function l(e){const{propertyName:t}=e;return{...a.actionPropertyClear,values:{propertyName:t}}}function s(e){const{propertyName:t,propertyValue:o}=e;return{...a.actionDatePropertySetSingle,values:{propertyName:t,propertyValue:o}}}function u(e){const{propertyName:t,propertyValues:o,operator:r}=e;return{...a.actionNumberPropertySet,values:{propertyName:t,propertyValues:o,operator:r}}}function c(e){const{propertyName:t}=e;return{...a.triggerInvalidConfigurationTitle,values:{propertyName:t}}}function p(e){const{propertyName:t,propertyValues:o,operator:r}=e;return{...a.actionTextPropertySet,values:{propertyName:t,propertyValues:o,operator:r}}}function d(e){const{propertyName:t,propertyValue:o}=e;return{...a.actionPersonPropertySetSingle,values:{propertyName:t,propertyValue:o}}}function m({elements:e,intl:t}){const o=e.length>3?e.length-2:0,r=o>0?2:3,a=t.formatList(e.slice(0,r),{style:"long",type:o>0?"unit":"conjunction"});return{numOthers:o,propertyValue:(0,n().d)(a,{display:"flex"})}}function g(e){const{numOthers:t=0,operator:o,propertyName:r,propertyValue:n}=e;let i;return i=!n||Array.isArray(n)&&0===n.filter((e=>Boolean(e))).length?a.actionPropertyClear:"append"===o?t>0?a.actionPropertyAddWithOthers:a.actionPropertyAdd:"remove"===o?t>0?a.actionPropertyRemoveWithOthers:a.actionPropertyRemove:"toggle"===o?t>0?a.actionPropertyToggleWithOthers:a.actionPropertyToggle:t>0?a.actionPropertyReplaceWithOthers:a.actionPropertyReplaceWith,{...i,values:{propertyName:r,propertyValue:n,numOthers:t}}}function y(e){const{propertyName:t,propertyValue:o}=e;return{...a.actionRelationPropertySetSingle,values:{propertyName:t,propertyValue:o}}}function h(e){const{propertyName:t,propertyValue:o}=e;return{...a.triggerRelationPropertyContainsSingle,values:{propertyName:t,propertyValue:o}}}function f(e){const{propertyName:t,propertyValue:o}=e;return{...a.triggerRelationPropertyContainsMultiple,values:{propertyName:t,propertyValue:o}}}function v(e){const{propertyName:t,propertyValue:o}=e;return{...a.triggerRelationPropertyDoesNotContainSingle,values:{propertyName:t,propertyValue:o}}}function x(e){const{propertyName:t,propertyValue:o}=e;return{...a.triggerRelationPropertyDoesNotContainMultiple,values:{propertyName:t,propertyValue:o}}}function S(e){const{propertyName:t,propertyValue:o}=e;return{...a.actionSelectPropertySetSingle,values:{propertyName:t,propertyValue:o}}}function b(e){const{propertyName:t,propertyValue:o}=e;return{...a.actionStatusPropertySetSingle,values:{propertyName:t,propertyValue:o}}}function C(e){const{propertyName:t,propertyValue:o}=e;return{...a.actionTextPropertySetSingle,values:{propertyName:t,propertyValue:o}}}function k(e){return e.formatMessage(a.actionDeletedProperty)}function j(e){return e.formatMessage(a.triggerAnyPageAdded)}function A(e){return e.formatMessage(a.triggerAnyPagePropertyEdit)}function T(e){return e.formatMessage(a.triggerDeletedPropertyEdit)}function M(e,t){const{propertyName:o}=t;return e.formatMessage(a.triggerAnyPropertyEdit,{propertyName:o})}function I(e,t){return e.formatMessage(a.triggerCheckboxPropertySet,t)}function P(e,t){const{propertyName:o}=t;return e.formatMessage(a.triggerAnyPropertyClear,{propertyName:o})}function _(e){const{propertyName:t,propertyValues:o,operator:r}=e;return{...a.triggerNumberPropertySet,values:{propertyName:t,propertyValues:o,operator:r}}}function w(e){const{propertyName:t,propertyValues:o,operator:r}=e;return{...a.triggerTextPropertySet,values:{propertyName:t,propertyValues:o,operator:r}}}function V(e,t){return e.formatMessage(a.triggerSelectPropertyIs,t)}function N(e,t){return e.formatMessage(a.triggerSelectPropertyIsNot,t)}function R(e,t){return e.formatMessage(a.triggerMultiSelectPropertyContains,t)}function F(e,t){return e.formatMessage(a.triggerMultiSelectPropertyDoesNotContain,t)}function B(e,t){return e.formatMessage(a.triggerStatusPropertySet,t)}function O(e){return e.formatMessage(a.deletedPropertyOption)}function E(e){const{propertyName:t,propertyValues:o}=e;return{...a.triggerPersonPropertyContainsSingle,values:{propertyName:t,propertyValue:o}}}function D(e){const{propertyName:t,propertyValues:o}=e;return{...a.triggerPersonPropertyContainsMultiple,values:{propertyName:t,propertyValues:o}}}function W(e){const{propertyName:t,propertyValues:o}=e;return{...a.triggerPersonPropertyDoesNotContainSingle,values:{propertyName:t,propertyValue:o}}}function L(e){const{propertyName:t,propertyValues:o}=e;return{...a.triggerPersonPropertyDoesNotContainMultiple,values:{propertyName:t,propertyValues:o}}}function K(e){const{limit:t,optionValues:o,propertySchema:n}=e,a=n.options??[],i=a.length>0,l=o.map((e=>{const t=i?(0,r().jy)(a,e):void 0;return t?{type:"option",value:t}:{type:"deleted",value:e}}));let s=l;if(void 0!==t&&l.length>t){const e=l.length-t;s=[...l.slice(0,t),{type:"truncation",value:`+${e}`}]}return s}},217028:(e,t,o)=>{o.d(t,{RY:()=>S,cn:()=>j,gI:()=>C,m9:()=>k,z$:()=>b});var r=o(296540),n=()=>o(590526),a=()=>o(401497),i=()=>o(250910),l=()=>o(118307),s=()=>o(852424),u=()=>o(765974),c=()=>o(69708),p=()=>o(100622),d=()=>o(534177),m=()=>o(284371),g=()=>o(680288),y=()=>o(656134),h=()=>o(741310),f=()=>o(923832),v=()=>o(541172),x=o(474848);function S(e){const{actionId:t,actionMenu:o,buttonPopupStore:r,disabled:n,onClick:i,propertySchema:l}=e,s=(0,a().IS)((()=>({icon:{fill:p().Tj.red.text.accentPrimary},propertyType:{color:p().Tj.palette.red[700]}})),[]),u=k({propertySchema:l}),c=j();return(0,x.jsx)(b,{actionId:t,actionMenu:o,buttonPopupStore:r,disabled:n,onClick:i,propertyType:l.type,styles:s,tooltip:c,children:u})}function b(e){const{actionId:t,actionMenu:o,buttonPopupStore:n,children:i,disabled:l,onClick:c,propertyType:g,styles:y,tooltip:v,tooltipPlacement:S}=e,b=(0,a().IS)((()=>({content:{color:p().Tj.red.text.accentPrimary,fontWeight:m().Wy.regular,whiteSpace:"normal"}})),[]),C=(0,r.useCallback)((e=>(0,x.jsx)(f().aX,{...e,actionId:t,actionMenu:o,buttonPopupStore:n,disabled:l,icon:(0,d().O9)(g)?s().LE[g]:u().exclamationMarkTriangleFillIcon,onClick:c,styles:y,hideDragHandle:!0,children:(0,x.jsx)("div",{style:b.content,children:i})})),[t,o,n,i,l,c,y,g,b]);return(0,x.jsx)(h().P,{renderOrigin:C,title:v,tooltipPlacement:S})}function C(e){const{actionId:t,propertyId:o,renderOrigin:a}=e,s=(0,y().j)(),u=(0,n().uB)(void 0,l().A),c=(0,r.useCallback)((()=>u.reset()),[u]);return(0,x.jsx)(i().A,{buttonPopupStore:u,popupType:s,render:()=>(0,x.jsx)(v().qM,{actionId:t,closeMenu:c,propertyId:o}),renderOrigin:a})}function k(e){const{propertySchema:t}=e,o=t.type,r=g().dC[o];return(0,x.jsx)(c().sA,{defaultMessage:"â€œ{propertyTypeDisplayName}â€ property type is not supported",id:"updateThisPageUnsupportedPropertyAction.updatedUnsupportedProperty.titleElement",values:{propertyTypeDisplayName:r}})}function j(){return(0,x.jsx)(c().sA,{defaultMessage:"Change property type or delete to enable this automation",id:"updateThisPageUnsupportedPropertyAction.updatedUnsupportedProperty.title"})}},218055:(e,t,o)=>{o.d(t,{O:()=>r});const r=(0,o(69708).YK)({maximumPeopleSelectedTooltip:{defaultMessage:"Maximum people selected",id:"valuePickerItem.maximumSelectedReached"}})},227124:(e,t,o)=>{o.d(t,{A:()=>u});var r=o(296540),n=()=>o(726637),a=()=>o(590526),i=()=>o(546926),l=()=>o(805452),s=o(474848);const u=(0,o(79926).Qz)(o(862292).T.formulas,((e,t)=>(0,s.jsx)(c,{...t,formulas:e})));function c(e){const{allowedReturnTypes:t,disabled:u,formulas:c,formulaTypecheckContextValues:p,onBack:d,onChange:m,onClose:g,parentRecordStore:y,restrictUnaccessibleProperties:h,spaceId:f,value:v}=e,x=(0,o(484714).v3)(),S=(0,r.useCallback)((async()=>{if(d)return void d();if("simple"===(null==v?void 0:v.type))return void g();if(await(0,l().Cp)()){const e=(0,l().D2)(null==v?void 0:v.value);m(e),g()}else g()}),[g,m,d,v]),b=(0,r.useCallback)((e=>{void 0!==e&&e[0][0].length?m({type:"formula",value:e}):m(void 0),g()}),[m,g]),C=(0,o(133518).i)(),k=(0,a().K8)((()=>{const e=(0,o(89053).i)(),r=(0,o(502856).MC)({collectionFeatureGates:e,experimentService:o(242422).default,getRecordModel:y.getRecordModel,loadRecordModel:y.loadRecordModel,spaceIdCreator:x.idCreator.getSpaceIdCreatorSync(f)});return{guaranteedPropertyIds:C,allowedReturnTypes:t,handleDataRequest:r,restrictUnaccessibleProperties:h,spaceId:f,valueTypes:p,featureGates:e}}),[t,p,y.getRecordModel,y.loadRecordModel,f,h,x.idCreator,C]),j=(0,a().K8)((()=>(0,l().m9)(v,p,y.getRecordModel)),[v,p,y.getRecordModel]);return k?(0,s.jsx)(o(890492).A,{disableBottomPadding:!0,disableHeaderBorder:!0,disableScroller:!0,hideMobileTopbar:!0,maxHeight:"unset",menuType:n().A.isMobile?i().gu.Modal:i().gu.Popup,width:n().A.isMobile?void 0:740,children:(0,s.jsx)(o(129574).v,{formulas:c,initialCode:j,typecheckContext:k,handleClose:b,handleCancel:S,parentSpaceId:f,disabled:u,getRecordModel:y.getRecordModel,autosave:!1})}):null}},238259:(e,t,o)=>{o.d(t,{E:()=>i});o(16280),o(898992),o(672577);var r=()=>o(247331),n=()=>o(791089),a=()=>o(201980);function i(e){const{action:t,currentSimpleFormulaValueTokens:o,onCheckboxClick:i,setCurrentTokens:l,value:s}=e;if(s.kind!==r().FormulaContextValueKind.ContextValue)throw new Error("Not implemented yet.");const u=Boolean(o.find((e=>(0,n().isAnnotationSimpleValueToken)(e)&&(0,a().s1Y)(e)&&(0,a().iVq)(e).id===s.id))),c=(0,a().CA$)({id:s.id});return{annotation:c,isChecked:u,itemAction:()=>{l("append"===t?u?(0,n().simpleFormulaValueWithoutToken)(o,c):[...o,c]:[c]),null==i||i()}}}},262509:(e,t,o)=>{o.d(t,{A:()=>v});o(296540);var r=()=>o(726637),n=()=>o(383036),a=()=>o(732810),i=()=>o(26697),l=()=>o(81068),s=()=>o(494379),u=()=>o(239381),c=()=>o(201980),p=()=>o(69708),d=()=>o(534177),m=()=>o(931077),g=()=>o(16006),y=()=>o(218055),h=()=>o(975969),f=o(474848);function v(e){var t;const{isChecked:o=!1,disabled:v,menuArgs:x,parentRecordStore:S}=e,b=(0,h().U)();let C;if("annotation"in e){const{annotation:t,formulaTypecheckContextValues:o}=e,r=(0,c().iVq)(t).id;C=(0,d().O9)(o)?(0,u().IV)(o,r):void 0}else C=e.contextValue;const k=(null===(t=C)||void 0===t?void 0:t.associatedCollectionForDisplay)&&a().m.createChildStore(S,C.associatedCollectionForDisplay),j=C&&(0,u().Ix)(C.type),A=r().A.isMobile?24:20;return C?(0,f.jsx)(i().m,{renderTooltip:()=>v?(0,f.jsx)(p().sA,{...y().O.maximumPeopleSelectedTooltip}):(0,u().E9)(C),placement:"right",render:e=>(0,f.jsx)(l().A,{isChecked:o,title:(0,f.jsx)("div",{style:{display:"flex"},children:C.name}),disabled:v,style:v?b.disabledMenuItem:void 0,icon:(0,d().O9)(C.stepNumberForDisplay)?(0,f.jsx)(m().Q,{number:C.stepNumberForDisplay,size:s().H.Medium}):j?j({width:A,height:A}):void 0,caption:k&&(0,f.jsx)(p().sA,{defaultMessage:"to {database}",id:"automations.AutomationTargetPickerMenu.VariableMenuItem.databaseCaption",values:{database:(0,f.jsx)(g().A,{store:k,style:{display:"inline"}})}}),...(0,n().A)(x,e)})}):null}},283088:(e,t,o)=>{o.d(t,{j:()=>a});var r=()=>o(792485),n=()=>o(590526);function a(){var e;const t=null===(e=(0,r().S)())||void 0===e?void 0:e.pageStore;return(0,n().K8)((()=>t&&(t.isPageBlock()||t.isCollectionViewPageWithContent())?t:void 0),[t])}},286595:(e,t,o)=>{o.d(t,{A:()=>n,e:()=>a});var r=()=>o(570270);class n extends r().K8{}class a extends r().y7{getInitialState(){return{stack:[],insertionPoint:void 0}}getInsertionPoint(){return this.getState().insertionPoint}setInsertionPoint(e){this.update((t=>({...t,insertionPoint:e})))}}},304359:(e,t,o)=>{o.d(t,{F:()=>m});var r=o(296540),n=()=>o(401497),a=()=>o(695115),i=()=>o(26697),l=()=>o(153057),s=()=>o(340498),u=()=>o(69708),c=()=>o(100622),p=o(474848);const d=(0,u().YK)({simpleFormulaFormulaActionButtonAriaLabel:{id:"formulas.simpleFormulaFormulaActionButton.ariaLabel",defaultMessage:"Formulas"},simpleFormulaFormulaActionButtonFormulaTooltip:{id:"formulas.simpleFormulaFormulaActionButton.formula.tooltip",defaultMessage:"Edit as formula"},simpleFormulaFormulaActionButtonSimpleFormulaTooltip:{id:"formulas.simpleFormulaFormulaActionButton.simpleFormula.tooltip",defaultMessage:"Edit as text"}});function m(e){const{disabled:t,onClick:o,value:m}=e,g="formula"===(null==m?void 0:m.type),y=(0,u().tz)(),h=(0,n().IS)((()=>({formulaIcon:{fill:g?c().Tj.blue.icon.accentPrimary:c().Tj.icon.secondary,height:s().Ev.sm,width:s().Ev.sm},button:{height:20,width:20}})),[g]),f=(0,r.useCallback)((()=>g?y.formatMessage(d.simpleFormulaFormulaActionButtonSimpleFormulaTooltip):y.formatMessage(d.simpleFormulaFormulaActionButtonFormulaTooltip)),[y,g]),v=(0,r.useCallback)((e=>(0,p.jsx)(a().A,{...e,ariaLabel:y.formatMessage(d.simpleFormulaFormulaActionButtonAriaLabel),disabled:t,disabledFeedback:t,icon:l().A,iconStyle:h.formulaIcon,onClick:o,style:h.button})),[t,y,o,h]);return(0,p.jsx)(i().m,{renderTooltip:f,placement:"bottom",render:v})}},340743:(e,t,o)=>{o.d(t,{G:()=>l});o(296540);var r=()=>o(401497),n=()=>o(100622),a=()=>o(284371),i=o(474848);function l(e){const{children:t,icon:o,shouldTruncateChildren:l}=e,s=(0,r().DP)(),u=(0,r().IS)((()=>{const e=(0,n().LD)(s,void 0);return{iconWrap:{flex:"0 0 auto"},textWrap:{...l?a().RC:{},flex:"1 1 auto"},wrap:{backgroundColor:e.backgroundColor,borderRadius:12,color:e.textColor,display:"inline-flex",gap:4,minWidth:l?50:void 0,padding:"0 8px"}}}),[l,s]);return(0,i.jsxs)("span",{style:u.wrap,children:[o?(0,i.jsx)("span",{"aria-hidden":"true",style:u.iconWrap,children:o}):void 0,(0,i.jsx)("span",{style:u.textWrap,children:t})]})}},383688:(e,t,o)=>{o.d(t,{Hk:()=>h,ZZ:()=>m,jl:()=>y});o(898992),o(354520),o(296540);var r=()=>o(401497),n=()=>o(807449),a=()=>o(652620),i=()=>o(980357),l=()=>o(69708),s=()=>o(284371),u=()=>o(340743),c=()=>o(214973),p=()=>o(989064),d=o(474848);function m(e){const t=(0,l().tz)(),{propertySchema:o,filter:r,onClick:n}=e;return(0,d.jsx)(p().z,{onClick:n,tooltip:h({filter:r,intl:t,propertySchema:o}),children:(0,d.jsx)(g,{propertySchema:o,filter:r})})}function g({propertySchema:e,filter:t}){const o=(0,l().tz)(),n=(0,r().IS)((()=>({propertyName:{...s().RC,fontWeight:s().Wy.medium},wrap:{alignItems:"center",display:"flex",whiteSpace:"pre"}})),[]),a=y({filter:t,intl:o,propertySchema:e,styles:n});return(0,d.jsx)("span",{style:n.wrap,children:a})}function y(e){const{filter:t,intl:o,propertySchema:r,styles:n}=e,a=r.name,i=t.value,l={propertyName:(0,d.jsx)("span",{style:n.propertyName,children:a}),propertyValues:(0,d.jsx)(f,{checkboxValue:i.value??!1})};return(0,c().T2)(o,l)}function h(e){const{filter:t,intl:o,propertySchema:r}=e,n={propertyName:r.name,propertyValues:!0===t.value.value?(0,d.jsx)(l().sA,{...c().CV.actionCheckboxPropertyChecked}):(0,d.jsx)(l().sA,{...c().CV.actionCheckboxPropertyUnchecked})};return(0,c().T2)(o,n)}function f(e){const{checkboxValue:t}=e,o=!0===t?(0,d.jsx)(n().I,{icon:a().h,size:"xs"}):(0,d.jsx)(n().I,{icon:i().u,size:"xs"}),r=!0===t?(0,d.jsx)(l().sA,{...c().CV.actionCheckboxPropertyChecked}):(0,d.jsx)(l().sA,{...c().CV.actionCheckboxPropertyUnchecked});return(0,d.jsx)(u().G,{icon:o,children:r})}},397785:(e,t,o)=>{o.d(t,{H:()=>j,hs:()=>k,oG:()=>b});o(944114),o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(354520),o(581454),o(296540);var r=()=>o(726637),n=()=>o(590526),a=()=>o(401497),i=()=>o(764880),l=()=>o(363170),s=()=>o(784892),u=()=>o(247331),c=()=>o(201980),p=()=>o(69708),d=()=>o(534177),m=()=>o(284371),g=()=>o(448693),y=()=>o(27356),h=()=>o(744951),f=()=>o(798971),v=()=>o(16707),x=()=>o(214973),S=o(474848);function b(e){const{messageType:t}=e,o=(0,p().tz)(),r=(0,a().IS)((()=>({content:{display:"flex",flexWrap:"wrap",whiteSpace:"pre"},propertyName:{...m().RC,fontWeight:m().Wy.medium},propertyValue:{...m().RC},propertyValueList:{display:"flex",flexBasis:"100%",listStyle:"none",margin:0,padding:0,width:"100%",columnGap:4,rowGap:4},inlineActorTokenContainer:{...m().RC,paddingBlockStart:1},inlineActorToken:{margin:0,paddingInlineEnd:0}})),[]),i=(0,n().K8)((()=>"action"===t?function(e){const{getRecordModel:t,automationStore:o,contextValues:r,intl:n,operator:a,propertySchema:i,styles:l,value:s}=e;let u;const c=(0,S.jsx)("span",{style:l.propertyName,children:i.name});if("formula"===(null==s?void 0:s.type))u=a?x().f4({operator:a,propertyName:c,propertyValue:(0,S.jsx)(v().g,{returnType:{type:"person"}})}):x().Pb({propertyName:c,propertyValue:(0,S.jsx)(v().g,{returnType:{type:"person"}})});else{const e=C({getRecordModel:t,propertySchema:i,value:s}),p=T(s,r),d=A({automationStore:o,actorOrGroupModels:e,values:p,showAsList:!1,styles:l}),m=e.length+p.length;u=a?x().f4({...x().f_({elements:Array.isArray(d)?d:[d],intl:n}),operator:a,propertyName:c}):0===m?x().NW({propertyName:c}):x().Pb({propertyName:c,propertyValue:d})}return(0,S.jsx)(p().sA,{...u})}({getRecordModel:e.getRecordModel,automationStore:e.automationStore,contextValues:e.contextValues,intl:o,propertySchema:e.propertySchema,styles:r,value:e.value,operator:e.operator}):"trigger"===t?function(e){const{automationStore:t,actorOrGroupModels:o,propertySchema:r,styles:n,operator:a}=e;if(!o)return null;const i=(0,S.jsx)("span",{style:n.propertyName,children:r.name}),l=A({automationStore:t,actorOrGroupModels:o,values:[],styles:n,showAsList:!0});let s;if(1===o.length){s=("person_contains"===a?x().a9:x().dd)({propertyName:i,propertyValues:l})}else{s=("person_contains"===a?x()._d:x().Fp)({propertyName:i,propertyValues:l})}return(0,S.jsx)(p().sA,{...s})}({automationStore:e.automationStore,actorOrGroupModels:e.actorOrGroupModels,propertySchema:e.propertySchema,operator:e.operator,styles:r}):void(0,d().HB)(t)),[t,e,o,r]);return{tooltipTitle:(0,n().K8)((()=>"action"===t?k({getRecordModel:e.getRecordModel,contextValues:e.contextValues,intl:o,propertySchema:e.propertySchema,styles:r,value:e.value}):"trigger"===t?j({actorOrGroupModels:e.actorOrGroupModels,intl:o,operator:e.operator,propertySchema:e.propertySchema,styles:r}):void(0,d().HB)(t)),[t,e,o,r]),title:i,styles:r}}function C(e){const{getRecordModel:t,propertySchema:o,value:r}=e,n=(0,l().e)({blockCreatorPointer:void 0,propertySchema:o,textValue:null==r?void 0:r.value,convertGroupPointersToBeComposite:!0}),a=[];for(const l of n)if("space_permission_group"===l.table){const e=t(l);if(!e)continue;a.push({type:"group",model:e})}else a.push({type:"actor",model:(0,i().xC)({getRecordModel:t,pointer:l})});return a}function k(e){const{getRecordModel:t,contextValues:o,intl:r,operator:n,propertySchema:a,styles:i,value:l}=e;let s;const u=(0,S.jsx)("span",{style:null==i?void 0:i.propertyName,children:a.name});if("formula"===(null==l?void 0:l.type))s=n?x().f4({operator:n,propertyName:u,propertyValue:(0,S.jsx)(v().L,{})}):x().Pb({propertyName:u,propertyValue:(0,S.jsx)(v().L,{})});else{const e=C({getRecordModel:t,propertySchema:a,value:l}),i=e.map((e=>(0,f().Mn)(r,e))),c=T(l,o),p=c.map((e=>e.tooltipName??e.name)),d=r.formatList([...i,...p],{style:"long",type:"conjunction"}),m=e.length+c.length;s=n?x().f4({propertyName:u,propertyValue:d,operator:n}):0===m?x().NW({propertyName:u}):x().Pb({propertyName:u,propertyValue:d})}return(0,S.jsx)(p().sA,{...s})}function j(e){const{actorOrGroupModels:t,intl:o,propertySchema:r,styles:n,operator:a}=e;if(!t)return null;const i=(0,S.jsx)("span",{style:null==n?void 0:n.propertyName,children:r.name}),l=t.map((e=>(0,f().Mn)(o,e))),s=o.formatList(l,{style:"long",type:"conjunction"});let u;if(1===t.length){u=("person_contains"===a?x().a9:x().dd)({propertyName:i,propertyValues:s})}else{u=("person_contains"===a?x()._d:x().Fp)({propertyName:i,propertyValues:s})}return(0,S.jsx)(p().sA,{...u})}function A(e){const{automationStore:t,actorOrGroupModels:o,styles:n,showAsList:a=!0,values:i}=e,l=o.filter((e=>"actor"===e.type)),u=o.filter((e=>"group"===e.type)),c=[...l.map(((e,t)=>(0,S.jsx)(g().Ay,{style:n.inlineActorToken,actor:e.model,showRemoveButton:!1,format:s().NY.Medium,isSingle:!1,hasPersonHoverCard:!1},t))),...u.map(((e,o)=>{if(e.model)return(0,S.jsx)(y().UISpacePermissionGroupToken,{parentStore:t,groupPointer:e.model.pointer,format:r().A.isMobile?g().Ay.Format.Large:g().Ay.Format.Medium,showRemoveButton:!1,shouldShrink:!0,isSingle:!0},o)})),...i.map(((e,t)=>(0,S.jsx)(h().F,{style:n.inlineFormulaValue,format:s().NY.Medium,isSingle:!1,value:e},t)))];return 1===c.length?(0,S.jsx)("div",{style:n.propertyValue,children:c[0]}):a?(0,S.jsx)("ul",{style:n.propertyValueList,children:c.map(((e,t)=>(0,S.jsx)("li",{children:(0,S.jsx)("div",{style:n.propertyValue,children:e},t)},t)))}):c.map(((e,t)=>(0,S.jsx)("div",{style:n.inlineActorTokenContainer,children:e},t)))}function T(e,t){const o=new Set(c().kNd(null==e?void 0:e.value).map((e=>e.id))),r=u().FormulaContextValueKind.ContextValue;return t.filter((e=>e.kind===r)).filter((e=>o.has(e.id)))}},403129:(e,t,o)=>{o.d(t,{A:()=>M});o(944114),o(581454);var r=o(296540),n=()=>o(726637),a=()=>o(401497),i=()=>o(245720),l=()=>o(546926),s=()=>o(890492),u=()=>o(663639),c=()=>o(736847),p=()=>o(69708),d=()=>o(100622),m=(o(898992),o(354520),()=>o(300474)),g=()=>o(882722),y=()=>o(247331),h=()=>o(791089),f=()=>o(496603),v=()=>o(729368),x=()=>o(366437),S=()=>o(166006),b=()=>o(821481),C=()=>o(483795),k=o(474848);const j=Object.freeze({property:!0});var A=()=>o(262509),T=()=>o(238259);function M(e){const{currentSimpleFormulaValueTokens:t,disableEmojiCommands:o,disableFormulas:M,disableFormattingAndMentions:I,disableMobileActionBar:P,formulaTypecheckContextValues:_,menuProps:w,onChange:V,onClose:N,parentRecordStore:R,showGenericHeader:F=!1,value:B}=e,{header:O,textInput:E,valueItems:D}=function(e){const{currentSimpleFormulaValueTokens:t,disableEmojiCommands:o,disableFormattingAndMentions:i,disableFormulas:l,disableMobileActionBar:s,formulaTypecheckContextValues:u,onChange:c,onClose:A,parentRecordStore:T,value:M}=e,I=(0,p().tz)(),P=(0,r.useMemo)((()=>u.filter((e=>"text"===e.type.type))),[u]),_=(0,m().r)(),w=(0,r.useCallback)((e=>{c({type:"simple",value:e})}),[c]),V=(0,r.useCallback)((e=>{w(e),A()}),[w,A]),N=(0,r.useCallback)((e=>{const t=void 0!==e[0]?(0,h().toSimpleFormulaSingleValue)(e[0]):void 0;V(t)}),[V]),{store:R}=(0,C().AI)({initialValue:null==M?void 0:M.value,onChange:w}),F=(0,a().eP)(),B=(0,a().IS)((()=>({textWrap:{borderRadius:6,lineHeight:"24px",padding:1,...n().A.isMobile?{boxShadow:"unset"}:{boxShadow:d().Tj.inputBoxShadow,margin:"0 12px"}},simpleFormulaText:{fontSize:12,width:"100%",...n().A.isMobile?{padding:"10px"}:{paddingTop:0,paddingInlineEnd:8,paddingBottom:8,paddingInlineStart:8}},text:{fontSize:12,maxHeight:120,overflow:"auto",...n().A.isMobile?{background:"light"===F?d().Tj.white:d().Tj.selectLightGray[200],margin:0,padding:"10px"}:{background:d().Tj.inputBackground,padding:"4px 10px"}}})),[F]),O=f().oE(P.map((e=>{if(e.kind===y().FormulaContextValueKind.ContextValue)return{action:"replace",currentSimpleFormulaValueTokens:t,id:e.id||"",setCurrentTokens:N,value:e}})));let E;return E=_&&T?(0,k.jsx)(S().Y,{...i?{disableDateMentions:!0,disableDateReminderMentions:!0,disableMentions:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0}:{},disabled:!1,disableEmojiCommands:o,disableFormulas:l,disableMobileActionBar:s,formulaTypecheckContextValues:u,onChange:c,onTextEnter:A,parentRecordStore:T,spaceId:_,placeholder:I.formatMessage(b().D.propertyValuePlaceholder),style:B.simpleFormulaText,value:M}):(0,k.jsx)("div",{className:g().CCX,style:B.textWrap,children:(0,k.jsx)(v().A,{disableComment:!0,disabled:!1,disableEmbedMenu:!0,disableEmojiCommands:o,disableMobileActionBar:s,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableSlashCommands:!0,...i?{disableDateMentions:!0,disableDateReminderMentions:!0,disableMentions:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0}:{},onEnter:A,pasteBehavior:"inline",store:R,style:B.text,inPageFind:x().Os.none,placeholder:I.formatMessage(b().D.propertyValuePlaceholder),disabledMentionTypes:j})}),{header:I.formatMessage(b().D.genericMenuHeader),textInput:E,valueItems:O}}({currentSimpleFormulaValueTokens:t,disableFormulas:M,disableEmojiCommands:o,disableFormattingAndMentions:I,disableMobileActionBar:P,formulaTypecheckContextValues:_,onChange:V,onClose:N,parentRecordStore:R,value:B})||{},W=(0,a().IS)((()=>({header:{...n().A.isMobile&&{borderBlockEnd:`1px solid ${d().Tj.border.secondaryTranslucent}`}}})),[]),L=(0,r.useMemo)((()=>D.map((e=>{const{annotation:t,itemAction:o}=(0,T().E)({action:e.action,currentSimpleFormulaValueTokens:e.currentSimpleFormulaValueTokens,setCurrentTokens:e.setCurrentTokens,value:e.value});return{key:e.id,render:e=>(0,k.jsx)(A().A,{annotation:t,disabled:!1,menuArgs:e,parentRecordStore:R}),action:o}}))),[D,R]),K=[];let H;L.length>0&&K.push({key:"textbox",render:e=>(0,k.jsx)(c().A,{...e}),items:L}),H=n().A.isMobile?{menuType:l().gu.Modal,right:(0,k.jsx)(p().sA,{...i().W.done}),onClickRight:N,minWidth:260}:{menuType:l().gu.Popup,maxHeight:"50vh",width:260,disableHeaderBorder:!0};const z=F&&(0,k.jsx)(c().A,{style:{paddingBottom:0},title:O}),q=(0,k.jsxs)("div",{style:W.header,children:[n().A.isMobile?void 0:(null==w?void 0:w.header)||z,(0,k.jsx)(c().A,{children:E})]}),U=(0,k.jsx)(u().A,{initialFocus:0,sections:K,type:u().O.Vertical});return{headerDiv:q,innerComponents:U,textMenu:(0,k.jsx)(s().A,{...H,...w,header:q,children:U})}}},423892:(e,t,o)=>{o.d(t,{LN:()=>i,W:()=>l,lD:()=>s,zQ:()=>u});o(296540);var r=()=>o(69708),n=()=>o(214973),a=o(474848);const i={checkbox_is_not:"checkbox",checkbox_is:"checkbox",enum_contains:"multi_select",enum_does_not_contain:"multi_select",enum_contains_all:"multi_select",enum_is_not:"select",enum_is:"select",number_does_not_equal:"number",number_equals:"number",number_greater_than_or_equal_to:"number",number_greater_than:"number",number_less_than_or_equal_to:"number",number_less_than:"number",person_contains:"person",person_does_not_contain:"person",relation_contains:"relation",relation_does_not_contain:"relation",status_is_not:"status",status_is:"status",string_contains:"text",string_does_not_contain:"text",string_ends_with:"text",string_is_not:"text",string_is:"text",string_starts_with:"text"},l={phone_number:"text",title:"text",url:"text",email:"text"},s={relation:["relation"],checkbox:["checkbox"],number:["number"],person:["person"],multi_select:["multi_select"],select:["select"],status:["status"],text:["email","phone_number","text","url"]};function u(e){return(0,a.jsx)(r().sA,{...n().o7({propertyName:e.name})})}},442120:(e,t,o)=>{o.d(t,{A:()=>p});var r=o(296540),n=()=>o(100622),a=()=>o(534177),i=o(474848);function l(e){switch(e){case"primary":return{background:n().oZ.frontBlueButtonBackground,boxShadow:n().Tj.buttonBoxShadow,color:"white"};case"secondary":return{background:n().oZ.frontSecondaryButtonBackground,boxShadow:`\n\t\t\t\t\t0 1px 2px rgba(15, 15, 15, 0.1),\n\t\t\t\t\tinset 0 0 0 1px ${n().IF.redWithAlpha(.3)}`,color:n().oZ.red};case"tertiary":case"aiTertiary":return{background:n().oZ.white,color:n().oZ.frontTextDark,border:"1px solid rgba(15, 15, 15, 0.15)",width:"100%",boxShadow:"0 1px 2px rgba(15, 15, 15, 0.05)"};case"quaternary":return{background:n().oZ.frontQuaternaryButtonBackground,border:`1px solid ${n().oZ.frontQuaternaryButtonBorder}`,boxShadow:"0 1px 2px rgba(15, 15, 15, 0.1)",color:"white"};case"aiPrimary":return{background:"#CA59FF",color:"white"};case"lightGray":return{background:n().Tj.background.tertiaryTranslucent,color:n().Tj.text.secondary};default:(0,a().HB)(e)}}function s(e,t){switch(e){case"primary":return{background:n().oZ.frontBlueButtonHoveredBackground};case"secondary":return{background:n().oZ.frontSecondaryButtonBackgroundHovered};case"tertiary":return{background:"light"===t?n().Tj.buttonHoveredBackground:n().IF.whiteWithAlpha(.8)};case"quaternary":return{background:n().oZ.frontQuaternaryButtonBackgroundHovered};case"aiPrimary":case"aiTertiary":return{background:"#C592DD"};case"lightGray":return{background:n().Tj.background.tertiaryTranslucent,color:n().Tj.text.primary};default:(0,a().HB)(e)}}function u(e,t){switch(e){case"primary":return{background:n().oZ.frontBlueButtonPressedBackground};case"secondary":return{background:n().Tj.buttonPressedBackground};case"tertiary":return{background:"light"===t?n().Tj.buttonPressedBackground:n().IF.whiteWithAlpha(.85)};case"quaternary":return{background:n().oZ.frontQuaternaryButtonBackgroundPressed};case"aiPrimary":case"aiTertiary":return{background:"#946EA6"};case"lightGray":return{background:n().Tj.state.pressed,color:n().Tj.text.primary};default:(0,a().HB)(e)}}function c(e,t){const{id:r,children:n,disabledFeedback:a,isFullWidth:c,isLoading:p,onClick:d,style:m,variant:g,disabled:y,...h}=e,f=(0,o(401497).eP)(),v={display:"inline-grid",alignItems:"center",justifyContent:"center",whiteSpace:"nowrap",height:36,borderRadius:4,fontSize:14,lineHeight:1,paddingInlineStart:12,paddingInlineEnd:12,fontWeight:o(284371).Wy.medium,...p&&{gridTemplateColumns:"1fr auto 1fr"},transition:"background-color color 150ms ease"};return(0,i.jsxs)(o(718827).Ay,{ref:t,id:r,onClick:d,style:{...v,...l(g),...m,...c&&{width:"100%",justifyContent:"center"}},hoveredStyle:s(g,f),pressedStyle:u(g,f),disabled:y||p,disabledFeedback:a,...h,children:[p?(0,i.jsx)(o(98126).A,{style:{marginInlineEnd:4,marginInlineStart:"auto"}}):null,(0,i.jsx)("div",{style:{display:"flex",alignItems:"center",textAlign:"center",justifyContent:"center"},children:n})]})}const p=r.memo(r.forwardRef(c),o(821062).A)},457050:(e,t,o)=>{o.d(t,{Iq:()=>I,UW:()=>A,WE:()=>w,eg:()=>_,oE:()=>T,xL:()=>j});o(898992),o(354520),o(581454),o(737550),o(296540);var r=()=>o(484714),n=()=>o(590526),a=()=>o(401497),i=()=>o(295633),l=()=>o(214388),s=()=>o(713998),u=()=>o(784892),c=()=>o(239381),p=()=>o(791089),d=()=>o(179034),m=()=>o(201980),g=()=>o(69708),y=()=>o(534177),h=()=>o(284371),f=()=>o(554548),v=()=>o(744951),x=()=>o(71304),S=()=>o(16707),b=()=>o(529135),C=()=>o(214973),k=o(474848);function j(e){const{automationContextValues:t,messageType:o,propertySchema:i,value:l}=e,s=(0,g().tz)(),u=(0,r().v3)(),c=(0,n().K8)((()=>l?I({automationContextValues:t,limit:i.limit,value:l}):[]),[t,i.limit,l]),p=(0,a().IS)((()=>({content:{alignItems:"center",display:"flex",flex:"1 1 auto",flexWrap:"wrap",minWidth:0,whiteSpace:"pre",lineHeight:1.6},operatorContent:{alignItems:"center",flexWrap:"wrap",gridGap:"1px"},propertyName:{...h().RC,fontWeight:h().Wy.semibold,minWidth:20},propertyValue:{...h().RC,minWidth:40},propertyValueList:{display:"flex",flexBasis:"100%",flexDirection:"column",listStyle:"none",margin:0,marginBlockStart:10,padding:0,rowGap:10,width:"100%"},propertyValueListItem:{display:"flex"},and:{marginInlineEnd:"4px",marginInlineStart:"4px"}})),[]),d=(0,n().K8)((()=>{if("action"===o)return function(e){const{intl:t,collectionStore:o,operator:r,propertySchema:n,relationPages:a,styles:i,value:l}=e,s=(0,k.jsx)("span",{style:i.propertyName,children:n.name});let u;const c="formula"===(null==l?void 0:l.type);u=c?(0,k.jsx)("div",{style:i.content,children:(0,k.jsx)(g().sA,{...C().uW({propertyName:s,propertyValue:(0,k.jsx)("span",{style:i.propertyValue,children:(0,k.jsx)(S().g,{returnType:{type:"block"}})})})})}):"replace"===r||"append"===r||"remove"===r||"toggle"===r?(0,k.jsx)("div",{style:{...i.content,...i.operatorContent},children:(0,k.jsx)(g().sA,{...C().f4({...C().f_({elements:a.map(((e,t)=>(0,k.jsx)(M,{propertySchema:n,collectionStore:o,value:e},t))),intl:t}),operator:r,propertyName:s})})}):0===a.length?(0,k.jsx)("div",{style:i.content,children:(0,k.jsx)(g().sA,{...C().NW({propertyName:s})})}):(0,k.jsx)("div",{style:i.content,children:(0,k.jsx)(g().sA,{...C().uW({propertyName:s,propertyValue:(0,k.jsx)("span",{style:i.propertyValue,children:(0,k.jsx)(M,{collectionStore:o,value:a[0],propertySchema:n})})})})});return u}({collectionStore:e.collectionStore,intl:s,operator:e.operator,propertySchema:e.propertySchema,relationPages:c,styles:p,value:e.value});if("trigger"===o){const{collectionStore:t,filter:o,propertySchema:r}=e;return function(e){const{availableTokens:t,collectionStore:o,operator:r,propertySchema:n,relationPages:a,styles:i}=e,l=(0,k.jsx)("span",{style:i.propertyName,children:n.name});let s;if(1===a.length){const e="relation_contains"===r?C().TF:C()._f;s=(0,k.jsx)("div",{style:i.content,children:(0,k.jsx)(g().sA,{...e({propertyName:l,propertyValue:(0,k.jsx)("span",{style:i.propertyValue,children:(0,k.jsx)(M,{availableTokens:t,collectionStore:o,propertySchema:n,value:a[0]})})})})})}else{const e="relation_contains"===r?C().JQ:C().SV;s=(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("div",{style:i.content,children:(0,k.jsx)(g().sA,{...e({propertyName:l,propertyValue:[]})})}),(0,k.jsx)("ul",{style:i.propertyValueList,children:a.map(((e,r)=>(0,k.jsx)("li",{style:i.propertyValueListItem,children:(0,k.jsx)(M,{availableTokens:t,collectionStore:o,propertySchema:n,value:e})},r)))})]})}return s}({availableTokens:o?_({collectionStore:t,filter:o,propertySchema:r}):void 0,collectionStore:e.collectionStore,operator:e.operator,propertySchema:e.propertySchema,relationPages:c,styles:p})}(0,y().HB)(o)}),[e,s,o,c,p]);return{tooltipTitle:(0,n().K8)((()=>{if("action"===o)return A({collectionStore:e.collectionStore,environment:u,intl:s,operator:e.operator,propertySchema:i,relationPages:c,value:e.value});if("trigger"===o){const{collectionStore:t,filter:o,propertySchema:r}=e;return T({availableTokens:o?_({collectionStore:t,filter:o,propertySchema:r}):void 0,collectionStore:e.collectionStore,environment:u,intl:s,operator:e.operator,propertySchema:e.propertySchema,relationPages:c})}(0,y().HB)(o)}),[e,u,s,o,i,c]),title:d,styles:p}}function A(e){const{collectionStore:t,environment:o,intl:r,operator:n,propertySchema:a,relationPages:l,value:s}=e,u=a.name;if("formula"===(null==s?void 0:s.type))return(0,k.jsx)(g().sA,{...C().uW({propertyName:u,propertyValue:(0,k.jsx)(S().L,{})})});const p=l.map((e=>{if("string"==typeof e){const n=i().B.createChildStore(t,{id:e,table:d().ev});return(0,x().tS)({environment:o,intl:r,store:n})}return(0,c().sM)(e)})).filter(y().O9),m=1===p.length?p[0]:r.formatList(p,{style:"long",type:"conjunction"});let h;return h="replace"===n||"append"===n||"remove"===n||"toggle"===n?C().f4({propertyName:u,propertyValue:m,operator:n}):0===p.length?C().NW({propertyName:u}):C().uW({propertyName:u,propertyValue:m}),(0,k.jsx)(g().sA,{...h})}function T(e){const{availableTokens:t,collectionStore:o,environment:r,intl:n,operator:a,propertySchema:l,relationPages:s}=e,u=s.map((e=>{if("string"==typeof e){if(!t||t.some((t=>t.id===e))){const t=i().B.createChildStore(o,{id:e,table:d().ev});return(0,x().tS)({environment:r,intl:n,store:t})}return C().iy(n)}return(0,c().sM)(e)})).filter(y().O9),p=l.name,m=1===u.length?u[0]:n.formatList(u,{style:"long",type:"conjunction"});let h;if(1===u.length){h=("relation_contains"===a?C().TF:C()._f)({propertyName:p,propertyValue:m})}else{h=("relation_contains"===a?C().JQ:C().SV)({propertyName:p,propertyValue:m})}return(0,k.jsx)(g().sA,{...h})}function M(e){const{availableTokens:t,collectionStore:o,value:r}=e;return!t||t.some((e=>e.id===r))?"string"==typeof r?(0,k.jsx)(f().A,{blockId:r,format:u().NY.Medium,isSingle:!0,noUnderline:!0,parentStore:o,shouldShrink:!0}):(0,k.jsx)(v().F,{format:u().NY.Medium,isSingle:!0,shouldShrink:!0,value:r}):(0,k.jsx)(b().A,{tokenFormat:u().NY.Medium},`missing_option_value_${r}`)}function I(e){const{automationContextValues:t,limit:o,value:r}=e;if(!r)return[];return(0,p().fromSimpleFormulaArrayValue)(r.value).slice(0,o).map((e=>{if("string"!=typeof e&&"boolean"!=typeof e){if((0,m().s1Y)(e)){const o=(0,m().iVq)(e).id,r=(0,c().IV)(t,o);if(!r)return;return r}if((0,m().jIt)(e)){var o;const t=null===(o=(0,m().i$F)(e))||void 0===o?void 0:o.id;if(!t)return;return t}}})).filter(y().O9)}function P(e){const{collectionStore:t,filter:o}=e,r=(0,l().Rh)(o),n=t.getSpaceId();return r.map((e=>{if(e.value&&"string"==typeof e.value)return{table:"block",id:e.value,spaceId:n}})).filter(y().O9)}function _(e){const{collectionStore:t,filter:o,propertySchema:r}=e,n=P({collectionStore:t,filter:o});return(0,s().bG)({getRecordModel:t.getRecordModel,propertySchema:r,relationValue:n,includeNoAccess:!0})}function w(e){const{collectionStore:t,filter:o}=e,r=P({collectionStore:t,filter:o});return{action:"replace",value:{type:"simple",value:(0,s().Ap)(r)}}}},457823:(e,t,o)=>{o.d(t,{HJ:()=>w,US:()=>N,WA:()=>P,be:()=>_,bx:()=>R,kU:()=>M,lg:()=>I,nO:()=>T,vH:()=>V});o(16280),o(944114),o(296540);var r=()=>o(675133),n=()=>o(792057),a=()=>o(929345),i=()=>o(302655),l=()=>o(807449),s=()=>o(890409),u=()=>o(236262),c=()=>o(206267),p=()=>o(912720),d=()=>o(798880),m=()=>o(973647),g=()=>o(534177),y=()=>o(384944),h=()=>o(479788),f=()=>o(324587),v=()=>o(546461),x=()=>o(122414),S=()=>o(89053),b=()=>o(326887),C=()=>o(594794),k=()=>o(547149),j=o(474848);const A=(0,o(69708).YK)({automationDeleteConfirmationMessage:{id:"slackAutomations.remove.confirmation.message",defaultMessage:"Delete {automationName}?"},automationDeleteAcceptLabel:{id:"slackAutomations.remove.confirmation.acceptLabel",defaultMessage:"Delete"},confirmDiscardChangesMessage:{id:"automations.confirmDiscardChanges.message",defaultMessage:"Discard unsaved changes to this automation?"},confirmDiscardChangesAccept:{defaultMessage:"Discard",id:"automations.confirmDiscardChanges.acceptLabel"},confirmDiscardOptionalFieldChangesMessage:{id:"automations.confirmDiscardToggleFieldChangesMessage.message",defaultMessage:"{hasName, select, true {Discard {fieldName} field?} other {Discard field?}}"}});function T(e){const{automationStore:t,collectionStore:o,environment:r,intl:n,from:a,builderType:l}=e;k().createAndCommit({environment:r,userAction:"collectionSettingsAutomationsActions.createDatabaseAutomation",canUndo:!0,perform:e=>{k().applyOperation({store:o,operation:{pointer:o.pointer,path:["format","automation_ids"],command:"listAfter",args:{id:t.id}},transaction:e});const a=i().d.createChildStore(o,t.pointer),l=t.getActionStores();for(const t of l){const o=t.getType();o&&f().addAutomationAction({actionId:t.id,actionType:o,automationStore:a,config:t.getConfig(),environment:r,intl:n,transaction:e})}let s;const u=t.getTrigger();(0,g().O9)(u)&&"event"!==u.type?"recurrence"===u.type?s={id:c().JW(),type:"recurrence",recurrence:u.recurrence}:(0,g().HB)(u):s={id:c().JW(),type:"event",event:(null==u?void 0:u.event)??{pagesAdded:!1,pagePropertiesEdited:{type:"none"},source:{pointer:o.getSpaceShardedPointer(),type:"collection"}}},y().eC({environment:r,inMemoryRecordCache:o.inMemoryRecordCache,table:p().yB,transaction:e,value:{action_ids:t.getActionIds(),alive:!0,id:t.id,parent_id:o.id,parent_table:o.table,properties:{name:t.getName()},space_id:o.getSpaceId(),status:"active",trigger:s}})}});const u=t.getModel();if((0,g().O9)(u)){const e=(0,v().To)(t);let o=[];e&&m().Q.isSuccess(e)&&(o=e.value.valueTypes),(0,x().CM)(((e,n,i)=>{const c=(0,h().Q)(r),p=s().sp({automationModel:u,builderType:l,formulaAnalyticsModule:n,formulasModule:e,formulaTypecheckContextValues:o,getRecordModel:t.getRecordModel,featureGates:(0,S().i)(),simpleFormulasModule:i}),d=a?{feature:{id:p.automation_id,from:a,type:"automation"}}:{};s().Dk(c,{...p,...d})}))}}function M(e){const{automationStore:t,collectionStore:o,environment:r,builderType:n,source:l}=e;k().createAndCommit({environment:r,userAction:"collectionSettingsAutomationsActions.saveDatabaseAutomation",canUndo:!0,perform:e=>{const r=i().d.createChildStore(o,t.pointer),n=t.getName(),l=r.getKeyStore("properties");y().zv({store:l,data:{name:n},transaction:e}),t.getStatus()!==r.getStatus()&&y().zv({store:r,data:{status:t.getStatus()},transaction:e});const s=t.getActionStores();if((0,b().$X)(r)&&(0,b().$X)(t))if(t.isTriggerType("event"))r.isTriggerType("event")||y().zv({store:r.getTriggerStore(),data:{type:"event"},transaction:e}),r.verifyTriggerType("event"),y().zv({store:r.getTriggerStore().getKeyStore("event"),data:t.getTriggerStore().getKeyStore("event").getValue(),transaction:e});else{if(!t.isTriggerType("recurrence"))throw new Error("Unexpected trigger type for automationStore");r.isTriggerType("recurrence")||y().zv({store:r.getTriggerStore(),data:{type:"recurrence"},transaction:e}),r.verifyTriggerType("recurrence"),y().zv({store:r.getTriggerStore().getKeyStore("recurrence"),data:t.getTriggerStore().getKeyStore("recurrence").getValue(),transaction:e})}const u=[];for(const t of s){const o=t.getModel();if(!o)continue;const n=a().b.createChildStore(r,t.pointer);y().KY({store:n,value:{alive:!0,config:o.getConfig(),id:o.id,parent_id:r.id,parent_table:r.table,space_id:r.getSpaceId(),type:o.type},transaction:e}),u.push(t.id)}y().zv({store:r,data:{action_ids:u},transaction:e})}});const u=t.getModel();(0,g().O9)(u)&&(0,x().CM)(((e,o,a)=>{const i=(0,v().To)(t);let c=[];i&&m().Q.isSuccess(i)&&(c=i.value.valueTypes);const p=(0,h().Q)(r),d=s().sp({automationModel:u,builderType:n,formulaAnalyticsModule:o,formulasModule:e,formulaTypecheckContextValues:c,getRecordModel:t.getRecordModel,featureGates:(0,S().i)(),simpleFormulasModule:a,source:l});s().SF(p,d)}))}async function I(e){const{intl:t,environment:o,collectionStore:r,existingAutomationStore:a,onDelete:l}=e,s=a.getNameWithDefault(t);(await n().Gh({message:t.formatMessage(A.automationDeleteConfirmationMessage,{automationName:s}),acceptLabel:t.formatMessage(A.automationDeleteAcceptLabel)})).accept&&(!function(e){const{environment:t,collectionStore:o,existingAutomationStore:r}=e;k().createAndCommit({environment:t,userAction:"collectionSettingsAutomationsActions.deleteAutomation",canUndo:!0,perform:e=>{const n=o.getFormatStore().getKeyStore("automation_ids"),a=i().d.createChildStore(o,r.pointer);k().applyOperation({store:n,operation:{pointer:n.pointer,path:n.path,command:"listRemove",args:{id:a.id}},transaction:e}),f().deleteAutomation({automationStore:a,environment:t,transaction:e})}})}({environment:o,collectionStore:r,existingAutomationStore:a}),null==l||l())}function P(e){const{automationStore:t,environment:o}=e;k().createAndCommit({environment:o,userAction:"collectionSettingsAutomationsActions.disableAutomation",canUndo:!0,perform:e=>{f().disableAutomation({automationStore:t,environment:o,transaction:e})}})}function _(e){const{automationStore:t,collectionStore:o,environment:r}=e;k().createAndCommit({canUndo:!0,environment:r,userAction:"collectionSettingsAutomationsActions.restartAutomation",perform:e=>{const r=i().d.createChildStore(o,t.pointer);f().restartAutomation({automationStore:r,transaction:e})}})}function w(e){const{automationStore:t,environment:o}=e;k().createAndCommit({environment:o,userAction:"collectionSettingsAutomationsActions.enableAutomation",canUndo:!0,perform:e=>{f().enableAutomation({automationStore:t,environment:o,transaction:e})}})}function V(e){const{automationStore:t,collectionStore:o,environment:r}=e,n=o.getFormatStore().getKeyStore("automation_ids"),a=(0,C().Z1)({environment:r,table:p().yB,spaceId:t.getSpaceId()}),i=r.currentUser.id?{id:r.currentUser.id,table:d().oo}:void 0;k().createAndCommit({environment:r,userAction:"",canUndo:!0,perform:e=>{f().duplicateAutomation({environment:r,sourceAutomationStore:t,targetAutomationId:a,transaction:e,actorPointer:i}),k().applyOperation({store:n,operation:{pointer:n.pointer,path:n.path,command:"listAfter",args:{id:a}},transaction:e})}})}async function N(e){const{hasPendingChanges:t}=e;if(!t)return!0;return(await n().Gh({acceptLabel:r().A.formatMessage(A.confirmDiscardChangesAccept),message:r().A.formatMessage(A.confirmDiscardChangesMessage),icon:(0,j.jsx)(l().I,{icon:u().trashIcon,size:"xl"})})).accept}async function R(e){const{fieldName:t}=e;return(await n().Gh({acceptLabel:r().A.formatMessage(A.confirmDiscardChangesAccept),message:r().A.formatMessage(A.confirmDiscardOptionalFieldChangesMessage,{fieldName:t,hasName:Boolean(t)}),icon:(0,j.jsx)(l().I,{icon:u().trashIcon,size:"xl"})})).accept}},475403:(e,t,o)=>{o.d(t,{$:()=>f});var r=o(296540),n=()=>o(484714),a=()=>o(590526),i=()=>o(401497),l=()=>o(79926),s=()=>o(609679),u=()=>o(534177),c=()=>o(284371),p=()=>o(354584),d=()=>o(712030),m=()=>o(29554),g=()=>o(562800),y=()=>o(246474),h=o(474848);function f(e){const{formulaTypecheckContextValues:t,parentRecordStore:o,spaceId:f,value:v}=e,x=(0,i().IS)((()=>({overflowWrap:{whiteSpace:"inherit"},textWrap:{alignItems:"center",display:"flex",fontFamily:c().vc(s().locale).githubMono}})),[]),S=function(e){const{formulaTypecheckContextValues:t,parentRecordStore:o,spaceId:s,value:c}=e,f=(0,n().v3)(),v=(0,n().Y0)(),x=(0,a().K8)((()=>f.KatexStore.getKatex()),[f]),S=(0,d().Ol)(),b=(0,i().DP)(),{value:C}=(0,l().fJ)(p().y),[k,j]=(0,r.useMemo)((()=>[null==c?void 0:c.value,(null==c?void 0:c.type)??"simple"]),[c]);return(0,a().K8)((()=>{if(!k)return"";if("simple"===j)return(0,m().S5)({disabled:!0,disableDateStyleAnnotations:!1,disableHover:!1,disableInsertedDeletedAnnotations:!1,disableStyleAnnotations:!1,disableSuggestionAnnotations:!1,emojiType:S,environment:f,formulaValueTypes:t,katex:x,parentBlockId:void 0,parentStore:o,renderedPageBlockId:void 0,textValue:{value:k,spaceId:s},theme:b});if("formula"===j){if(C){const e=(0,y()._)({currentUserId:f.currentUser.id,errorRanges:[],getPublicBaseUrlForPage:g().tN(f),isAndroid:v.isAndroid,isMobileNative:v.isMobileNative,isSafariOrIOS:v.isSafari||v.isIOS,isFirefox:v.isFirefox,isWindows:v.isWindows,parentSpaceId:s,Prism:C,store:o,textValue:k,theme:b,valueTypes:t});return(0,h.jsx)("div",{dangerouslySetInnerHTML:{__html:e}})}return""}(0,u().HB)(j)}),[C,v.isAndroid,v.isIOS,v.isMobileNative,v.isSafari,v.isFirefox,v.isWindows,S,f,t,x,o,s,b,j,k])}({formulaTypecheckContextValues:t??[],parentRecordStore:o,spaceId:f,value:v});return(0,h.jsx)("div",{style:x.textWrap,children:(0,h.jsx)("div",{style:x.overflowWrap,children:S})})}},477329:(e,t,o)=>{o.d(t,{$5:()=>S,JI:()=>x,Ww:()=>f,l5:()=>b});o(898992),o(354520),o(581454),o(296540);var r=()=>o(401497),n=()=>o(713998),a=()=>o(784892),i=()=>o(69708),l=()=>o(534177),s=()=>o(284371),u=()=>o(399762),c=()=>o(881690),p=()=>o(496401),d=()=>o(214973),m=()=>o(529135),g=()=>o(989064),y=o(474848);const h=5;function f(e){const t=(0,i().tz)(),{filter:o,propertySchema:r,onClick:n}=e,a={...s().RC,fontWeight:s().Wy.medium},u=o.value,c=r.name,d=(Array.isArray(u)?u:[u]).map((e=>e.value)).filter(l().O9),m=S({intl:t,isText:!0,limit:h,optionValues:d,propertySchema:r}),f=t.formatList(m,{style:"long",type:"disjunction"}),C=b({filter:o,propertySchema:r});if(!C)return null;const k=x(C)(t,{propertyName:(0,y.jsx)("span",{style:a,children:c}),propertyValues:(0,p().d)(f)});return(0,y.jsx)(g().z,{tooltip:k,onClick:n,children:(0,y.jsx)(v,{...C})})}function v(e){const{filter:t,propertySchema:o}=e,n=(0,i().tz)(),a=t.value,u=o.name,c=(Array.isArray(a)?a:[a]).map((e=>e.value)).filter(l().O9),d=S({intl:n,limit:h,optionValues:c,propertySchema:o}),m=n.formatList(d,{style:"long",type:"disjunction"}),g=(0,r().IS)((()=>({content:{alignItems:"baseline",display:"flex",flexWrap:"wrap",whiteSpace:"pre",lineHeight:1.6},propertyName:{...s().RC,fontWeight:s().Wy.medium}})),[]),f=b({filter:t,propertySchema:o});if(!f)return null;const v=x(f)(n,{propertyName:(0,y.jsx)("span",{style:g.propertyName,children:u}),propertyValues:(0,p().d)(m)});return(0,y.jsx)("div",{style:g.content,children:v})}function x({filter:e,propertySchema:t}){return"select"===t.type?"enum_is"===e.operator?d().Ee:d().n1:"enum_contains"===e.operator?d().Q$:d().Re}function S({intl:e,isText:t,limit:o,optionValues:r,propertySchema:i,tokenFormat:l=a().NY.Medium}){const s=i.options??[],p=r.map((o=>{const r=(0,n().jy)(s,o);return r?t?r.value:(0,y.jsx)(u().O,{value:r.value,color:r.color,format:l,isSingle:!0,showRemoveButton:!1},r.id):t?(0,d().iy)(e):(0,y.jsx)(m().A,{tokenFormat:l},`missing_option_value_${o}`)}));let g;if(void 0!==o&&p.length>o){const e=p.length-o,r=t?`+${e}`:(0,y.jsx)(c().A,{format:a().NY.Medium,isRound:!0,isSingle:!0,showRemoveButton:!1,value:`+${e}`},"More tokens");g=[...p.slice(0,o),r]}else g=p;return g}function b(e){const{filter:t,propertySchema:o}=e;if("select"===o.type){if("enum_is"===t.operator||"enum_is_not"===t.operator)return{filter:t,propertySchema:o}}else if("multi_select"===o.type&&("enum_contains"===t.operator||"enum_does_not_contain"===t.operator))return{filter:t,propertySchema:o};return!1}},496401:(e,t,o)=>{o.d(t,{d:()=>n});o(944114),o(296540);var r=o(474848);function n(e,t={}){if(!Array.isArray(e))return[e];const o=[];for(const n of e)if("string"==typeof n&&" "!==n[0]){const e=o.pop();o.push((0,r.jsxs)("div",{style:t,children:[e,n]}))}else o.push(n);return o}},527871:(e,t,o)=>{o.d(t,{V:()=>l});o(898992),o(354520),o(581454);var r=()=>o(907258),n=()=>o(103966),a=()=>o(534177),i=()=>o(615623);async function l(e){var t;const{triggerType:o,environment:l,automationStore:s,spaceId:u}=e;if(null==s||!s.isDefined())return!0;const c=(0,n().Z)(o),p=r().default.state,d=await(0,i().S)(l,{name:"premium_automations",spaceId:u,userId:null===(t=p.currentUserStore)||void 0===t?void 0:t.id});return c.isAvailableForContext({automation:s.getModel(),automationActions:s.getActionStores().map((e=>e.getModel())).filter(a().O9),hasPremiumAutomations:d})}},529135:(e,t,o)=>{o.d(t,{A:()=>d});o(296540);var r=()=>o(401497),n=()=>o(807449),a=()=>o(784892),i=()=>o(765974),l=()=>o(69708),s=()=>o(100622),u=()=>o(881690),c=()=>o(214973),p=o(474848);function d({key:e,tokenFormat:t=a().NY.Medium,isSingle:o,showRemoveButton:d,onClickRemove:m}){const g=(0,l().tz)(),y=(0,r().eP)(),h=(0,r().IS)((()=>{const e="light"===y?50:200,t="light"===y?700:900;return{tokenValueWrap:{display:"inline-flex",gap:"4px",alignItems:"baseline"},warningWrap:{alignSelf:"center"},token:{backgroundColor:s().Tj.palette.yellow[e]},textWrap:{color:s().Tj.palette.yellow[t]}}}),[y]);return(0,p.jsx)(u().A,{format:t,isSingle:o??!0,showRemoveButton:d??!1,onClickRemove:m,style:h.token,value:(0,p.jsxs)("span",{style:h.tokenValueWrap,children:[(0,p.jsx)("span",{style:h.warningWrap,children:(0,p.jsx)(n().I,{icon:i().exclamationMarkTriangleFillIcon,colorPalette:"orange",colorVariant:"accentPrimary"})}),(0,p.jsx)("span",{style:h.textWrap,children:(0,c().iy)(g)})]})},e)}},534674:(e,t,o)=>{o.d(t,{A:()=>c});var r=o(296540),n=()=>o(807449),a=()=>o(81068),i=()=>o(585639),l=()=>o(69708),s=()=>o(821481),u=o(474848);function c(e){const{value:t,onChange:o}=e,c=(0,r.useCallback)((()=>{o({type:"formula",value:null==t?void 0:t.value})}),[t,o]);return(0,u.jsx)(a().A,{icon:(0,u.jsx)(n().I,{icon:i().v,colorVariant:"secondary"}),title:(0,u.jsx)(l().sA,{...s().D.customFormula}),focused:!1,showExtensionArrow:!0,onClick:c})}},541172:(e,t,o)=>{o.d(t,{A5:()=>V,Ol:()=>N,qM:()=>w});o(898992),o(354520),o(672577);var r=o(296540),n=()=>o(484714),a=()=>o(590526),i=()=>o(79926),l=()=>o(807449),s=()=>o(890492),u=()=>o(81068),c=()=>o(663639),p=()=>o(736847),d=()=>o(454503),m=()=>o(105819),g=()=>o(236262),y=()=>o(69708),h=()=>o(534177),f=()=>o(813297),v=()=>o(339798),x=()=>o(527438),S=()=>o(908201),b=()=>o(457823),C=()=>o(862292),k=()=>o(324587),j=()=>o(546461),A=()=>o(366360),T=()=>o(76190),M=()=>o(781697),I=()=>o(283088),P=()=>o(813716),_=o(474848);function w(e){const{actionId:t,closeMenu:o,propertyId:l}=e,{maybePersistedTransactionActions:s}=(0,A().b)(),{automationStore:u,contextType:c}=(0,j().q8)(),p=(0,S().Ks)(),d=(0,n().v3)(),m=(0,y().tz)(),{value:g}=(0,i().fJ)(C().T.formulas),{value:h}=(0,i().fJ)(f().QV.automationTypecheck),M=(0,T().n)(u),P=(0,I().j)(),w=(0,a().K8)((()=>null==p?void 0:p.settingsStore),[p]),V=(0,a().K8)((()=>p&&(0,x().ZI)({collectionContextStore:p,timelineViewTab:"timeline"})),[p]),R=(0,a().K8)((()=>{const e=u.getActionStores().find((e=>e.id===t));if(null!=e&&e.isDefined())return e}),[u,t]),F=(0,r.useCallback)((()=>{R&&g&&h&&(s.createAndCommit({perform:e=>{k().removeAutomationAction({actionStore:R,automationStore:u,automationTypecheckModule:h,contextType:c,environment:d,formulasModule:g,intl:m,isSubscribed:M,transaction:e,pageStore:P})},userAction:"UnsupportedPropertyMenu.removeAction"}),null==o||o())}),[R,u,o,c,d,m,s,g,h,M,P]),B=(0,r.useMemo)((()=>{if(w&&V&&l)return async function(){await(0,b().US)({hasPendingChanges:!0})&&v().a2({collectionSettingsStore:w,item:{type:"property",formatKey:V,property:l}}),null==o||o()}}),[o,w,V,l]);return(0,_.jsx)(N,{onDelete:F,onEdit:B,stepType:"action"})}function V(e){const{closeMenu:t,propertyId:o}=e,n=(0,S().Ks)(),{removePropertyTrigger:i}=(0,P().p)(),l=(0,a().K8)((()=>null==n?void 0:n.settingsStore),[n]),s=(0,a().K8)((()=>n&&(0,x().ZI)({collectionContextStore:n,timelineViewTab:"timeline"})),[n]),u=(0,r.useCallback)((()=>{i(o),null==t||t()}),[t,o,i]),c=(0,r.useMemo)((()=>{if(l&&s&&o)return async function(){await(0,b().US)({hasPendingChanges:!0})&&v().a2({collectionSettingsStore:l,item:{type:"property",formatKey:s,property:o}}),null==t||t()}}),[t,l,s,o]);return(0,_.jsx)(N,{onDelete:u,onEdit:c,stepType:"trigger"})}function N(e){const{onDelete:t,onEdit:o,onRestore:n,stepType:a}=e,i=(0,M().e)({width:266}),f=(0,r.useMemo)((()=>(0,h().O9)(o)?{action:o,key:"edit-property-menu-item",render:e=>(0,_.jsx)(u().A,{...e,icon:(0,_.jsx)(l().I,{icon:m().pencilLineIcon}),title:(0,_.jsx)(y().sA,{defaultMessage:"Edit property",id:"unsupportedPropertyMenu.editMenuItem.title"})})}:void 0),[o]),v=(0,r.useMemo)((()=>(0,h().O9)(n)?{action:n,key:"restore-property-menu-item",render:e=>(0,_.jsx)(u().A,{...e,icon:(0,_.jsx)(l().I,{icon:d().arrowUTurnUpLeftIcon}),title:(0,_.jsx)(y().sA,{defaultMessage:"Restore property",id:"unsupportedPropertyMenu.restoreMenuItem.title"})})}:void 0),[n]),x=(0,r.useMemo)((()=>(0,h().O9)(t)?{action:t,key:"delete-property-menu-item",render:e=>(0,_.jsx)(u().A,{...e,icon:(0,_.jsx)(l().I,{icon:g().trashIcon}),title:"action"===a?(0,_.jsx)(y().sA,{id:"automationUnsupportedPropertyMenu.deleteAction.title",defaultMessage:"Delete action"}):(0,_.jsx)(y().sA,{id:"automationUnsupportedPropertyMenu.deleteTrigger.title",defaultMessage:"Delete trigger"})})}:void 0),[t,a]);return(0,_.jsx)(s().A,{...i,children:(0,_.jsx)(c().A,{initialFocus:0,sections:[{key:"actions-section",items:[f,v,x].filter(h().O9),render:e=>(0,_.jsx)(p().A,{...e})}],type:c().O.Vertical})})}},542550:(e,t,o)=>{o.d(t,{R:()=>A});o(898992),o(354520),o(581454);var r=o(296540),n=()=>o(590526),a=()=>o(401497),i=()=>o(26697),l=()=>o(736847),s=()=>o(214388),u=()=>o(713998),c=()=>o(791089),p=()=>o(696706),d=()=>o(179034),m=()=>o(534177),g=()=>o(284371),y=()=>o(726637),h=()=>o(81068),f=()=>o(942715),v=()=>o(69708),x=()=>o(100622),S=()=>o(615028),b=o(474848);function C({handleSelectOperator:e,selectedItem:t}){const o=(0,a().IS)((()=>({buttonStyle:{fontSize:y().A.isMobile?16:12,height:20,lineHeight:"unset",marginInlineEnd:0,paddingInlineStart:2,paddingInlineEnd:2,textTransform:"lowercase",color:y().A.isMobile?x().Tj.palette.gray[900]:x().Tj.palette.gray[500]}})),[]);return(0,b.jsx)(f().A,{style:{height:20},innerButtonStyle:o.buttonStyle,selectedTitle:(0,b.jsx)(v().sA,{...t.text}),renderMenuSections:t=>[{key:"selectRelationOperator",render:e=>(0,b.jsx)(l().A,{...e}),items:Object.values(S().Yx).map((o=>({key:o.value,action:()=>{e(o),t.close()},render:e=>(0,b.jsx)(h().A,{...e,title:(0,b.jsx)(v().sA,{...o.text})})})))}]})}var k=()=>o(626792),j=()=>o(714202);function A(e){var t;const{collectionStore:o,formulaTypecheckContextValues:y,menuStore:h,onClose:f,onCommit:v,parentRecordStore:x,propertyChangedFilter:A,propertyId:T,propertySchema:M,shouldUseDefaultPropertyOperator:I}=e,P=(0,r.useMemo)((()=>{if(I)return"relation_contains"}),[I]),_=(0,r.useMemo)((()=>"changes_to_any"===A.operator?[]:(0,s().Pq)(A)&&(0,s().gc)(A)?(0,s().Rh)(A):[]),[A]),w=(0,n().K8)((()=>o.getSpaceId()),[o]),[V,N]=(0,r.useState)((()=>{const e=_.map((e=>{if("exact"===e.type&&e.value&&w)return p().L3.fromSpaceShardRecordId({id:e.value,spaceId:w},d().ev)})).filter(m().O9);if(0!==e.length)return{action:"replace",value:{type:"simple",value:(0,u().Ap)(e)}}})),[R,F]=(0,r.useState)((0,S().L9)(P||A.operator)),B=(0,r.useRef)(R),O=(0,r.useRef)(),E=S().Yx[R],D=(0,n().K8)((()=>(0,c().setPropertyValueToSimpleFormulaReturnType)(o.getSpaceShardedPointer(),T,M)),[o,T,M]),W=(0,r.useMemo)((()=>({collectionStore:o,property:T,type:"collection"})),[o,T]),L=(0,r.useCallback)((()=>{const e=S().Yx[B.current],t=O.current||(null==V?void 0:V.value),o=null!=t&&t.value?(0,u().n)(t.value):void 0,r=o&&o.length>0?{operator:e.value,value:o.map((e=>({type:"exact",value:e.id})))}:{operator:"is_empty"};v({anyOptionCheckState:"changes_to_any"===e.value,filter:r,propertyId:T}),f()}),[null==V?void 0:V.value,f,v,T]),K=(0,r.useCallback)((e=>{O.current=e,N(e?{action:"replace",value:e}:void 0);const t=S().Yx[B.current];(1===M.limit&&(0,m().O9)(null==e?void 0:e.value)||!t.hasInput)&&L()}),[L,M.limit]),H=(0,r.useCallback)((e=>{B.current=e.value,F(e.value),S().Yx[e.value].hasInput||K(void 0)}),[K]),z=(0,a().IS)((()=>({header:{display:"grid",gridTemplateColumns:"auto auto",gridGap:"2px",alignItems:"center"},propertyName:{...g().RC}})),[]),q=(0,r.useMemo)((()=>{var e;return(0,c().fromSimpleFormulaArrayValue)(null==V||null===(e=V.value)||void 0===e?void 0:e.value)}),[null==V||null===(t=V.value)||void 0===t?void 0:t.value]),{headerDiv:U,innerComponents:Y}=(0,k().A)({currentSimpleFormulaValueTokens:q,formulaTypecheckContextValues:y,formulaValueContext:W,onChange:K,onClose:f,showClearButton:!0,showInputMenuItem:!0,collection:"block_array"===(null==D?void 0:D.type)?D.collection:void 0,value:null==V?void 0:V.value,parentRecordStore:x});return(0,b.jsx)(j().A,{type:"custom",triggerActionMenuStore:h,onDone:L,onClose:f,headerTitle:(0,b.jsxs)("div",{style:z.header,children:[(0,b.jsx)(i().m,{placement:"bottom",render:e=>(0,b.jsx)("div",{...e,style:z.propertyName,children:M.name}),renderTooltip:()=>M.name}),(0,b.jsx)(C,{handleSelectOperator:H,selectedItem:E})]}),subHeaderComponent:E.hasInput?(0,b.jsx)(l().A,{children:U}):void 0,customMenuProps:{leftOuterStyle:{flex:"unset"},rightOuterStyle:{flex:"unset"},titleOuterStyle:{flex:"unset"},topbarStyle:{justifyContent:"space-between"}},children:E.hasInput?Y:void 0})}},548526:(e,t,o)=>{o.d(t,{x:()=>p});var r=o(296540),n=()=>o(807449),a=()=>o(324254),i=()=>o(340498),l=()=>o(100622),s=()=>o(284371),u=o(474848);const c={height:"auto",maxWidth:"auto",paddingInline:4},p=(0,r.forwardRef)((function(e,t){const{children:p,disabled:m,hasActionRequired:g,errorIcon:y,icon:h,isCompact:f,isError:v,isSecondary:x,onClick:S,style:b,tooltipMessage:C,dropdownButtonType:k,dropdownIcon:j}=e,A=(0,o(484714).v3)(),T="dropdown"===k,M=(0,o(401497).IS)((()=>({button:{...d({isError:v,hasActionRequired:g,isSecondary:x,dropdownButtonType:k}),gap:2,padding:"0 6px",...f?c:void 0,...T&&{alignItems:"center",height:20,paddingBlock:0,marginBlock:0},...b},children:{...s().RC,lineHeight:"20px",flex:"1 1 auto",display:"grid",gridTemplateColumns:"auto auto",gap:2,...T&&{padding:"0 2px"}},icon:{width:i().Ev.sm,height:i().Ev.sm,marginInlineEnd:2,...v?{fill:l().Tj.red.icon.accentPrimary}:void 0},warningIcon:{color:l().Tj.red.icon.accentPrimary,fill:l().Tj.red.icon.accentPrimary,width:i().Ev.sm,height:i().Ev.sm,flex:"0 0 auto",marginInlineEnd:2},chevronIcon:{fill:l().Tj.icon.secondary,flex:"0 0 auto",height:i().Ev.sm,width:i().Ev.sm,...T&&{fill:"unset"}}})),[v,g,x,k,f,T,b]),I=(0,r.useMemo)((()=>h?()=>h(M.icon):void 0),[h,M.icon]),P=(0,r.useCallback)((()=>C??null),[C]),_=(0,r.useCallback)((e=>{(0,o(755125).clear)({environment:A}),(0,o(440024).I)({environment:A}),null==S||S(e),e.stopPropagation()}),[A,S]),w=y||o(158661).exclamationMarkTriangleFillSmallIcon,V=v?()=>w(M.warningIcon):I;return(0,u.jsx)(o(26697).m,{delayThreshold:0,disableTooltip:!Boolean(C),placement:"bottom",render:e=>"dropdown"===k?(0,u.jsxs)(o(442120).A,{...e,variant:v?"secondary":"lightGray",disabled:m,disabledFeedback:m,onClick:_,ref:t,style:M.button,children:[V?V():void 0,(0,u.jsx)("div",{style:M.children,children:p}),j?j(M.chevronIcon):(0,u.jsx)(n().I,{icon:a().arrowChevronSingleDownSmallIcon,size:"sm",colorVariant:"secondary",style:M.chevronIcon})]}):(0,u.jsxs)(o(631524).p,{...e,disabled:m,disabledFeedback:m,onClick:_,ref:t,shouldShrink:!0,style:M.button,colorPalette:v?"red":void 0,children:[v?null==V?void 0:V():null==I?void 0:I(),(0,u.jsx)("div",{style:M.children,children:p}),(0,u.jsx)(n().I,{icon:a().arrowChevronSingleDownSmallIcon,size:"sm",colorVariant:"secondary",style:M.chevronIcon})]}),renderTooltip:P})}));function d(e){const{isError:t,hasActionRequired:o,isSecondary:r,dropdownButtonType:n}=e;return t?{color:l().Tj.red.text.accentPrimary,..."dropdown"===n&&{boxShadow:"none"}}:o?{fontWeight:s().Wy.regular,color:l().Tj.text.secondary}:r?{color:l().Tj.text.secondary}:{fontWeight:s().Wy.regular,color:l().Tj.text.primary}}},570270:(e,t,o)=>{o.d(t,{K8:()=>n,y7:()=>a});o(18107),o(944114),o(967357);class r extends(()=>o(757695))().Store{getCurrentTab(){return this.getState().stack.at(-1)}push(e){this.update((t=>({...t,stack:[...t.stack,e]})))}pop(){this.update((e=>({...e,stack:e.stack.slice(0,e.stack.length-1)})))}replace(e){this.update((t=>({...t,stack:[...t.stack.slice(0,-1),e]})))}pushSettingsItem(e){return this.push(e)}popSettingsItem(){return this.pop()}replaceSettingsItem(e){return this.replace(e)}}class n extends r{getInitialState(){return{stack:[]}}}class a extends r{}},576241:(e,t,o)=>{o.d(t,{A:()=>m});var r=o(296540),n=()=>o(726637),a=()=>o(590526),i=()=>o(764880),l=()=>o(791089),s=()=>o(798880),u=()=>o(201980),c=()=>o(448693),p=()=>o(27356),d=o(474848);function m({handleRemoveToken:e,token:t,style:o,isDisabled:m,preventOnClickPropagation:g,parentRecordStore:y}){const h=n().A.isMobile?c().Ay.Format.Medium:c().Ay.Format.Small,f=(0,r.useCallback)((o=>{g&&(null==o||o.stopPropagation()),e&&e(t)}),[e,t,g]);return(0,a().K8)((()=>{if(!(0,l().isAnnotationSimpleValueToken)(t))return null;if((0,u().rie)(t)){const r=(0,u().NcG)(t);if(r){const t=(0,i().xC)({pointer:{table:s().oo,id:r},getRecordValue:y.getRecordModel});return null!=t&&t.asActor&&t.table===s().oo?(0,d.jsx)(c().Ay,{actor:t,format:h,showRemoveButton:Boolean(e)&&!m,onClickRemove:f,shouldShrink:!0,isSingle:!1,style:o,hasPersonHoverCard:!1},t.id):null}}if((0,u().RaC)(t)){const r=(0,u().cFJ)(t);return r?(0,d.jsx)(p().UISpacePermissionGroupToken,{parentStore:y,groupPointer:r,format:h,showRemoveButton:Boolean(e)&&!m,onClickRemove:f,shouldShrink:!0,isSingle:!0,style:o},r.id):null}return null}),[y,e,m,h,f,o,t])}},609281:(e,t,o)=>{o.d(t,{Y:()=>c});o(898992),o(354520),o(672577);var r=o(296540),n=()=>o(81068),a=()=>o(736847),i=()=>o(214388),l=()=>o(69708),s=()=>o(714202),u=o(474848);function c(e){const{propertyId:t,menuStore:o,propertySchema:c,propertyChangedFilter:p,onCommit:d,onClose:m}=e,g=(0,r.useMemo)((()=>"changes_to_any"===p.operator?[{type:"exact",value:!0},{type:"exact",value:!1}]:(0,i().Ui)(p)&&(0,i().gc)(p)?Array.isArray(p.value)?p.value:[p.value]:[]),[p]),[y,h]=(0,r.useState)(g),f=(0,r.useRef)(g),v=(0,r.useCallback)((e=>{if(Boolean(y.find((t=>t.value===e)))){const t=y.filter((t=>t.value!==e));h(t),f.current=t}else{const t=[...y,{type:"exact",value:e}];h(t),f.current=t}}),[y]),x=(0,r.useCallback)((()=>{const e=f.current||y,o=1===e.length?{operator:"checkbox_is",value:e[0]}:{operator:"changes_to_any"},r=2===e.length||1===e.length&&"partial";d({anyOptionCheckState:r,filter:o,propertyId:t}),m()}),[m,d,t,y]),S=Boolean(y.find((e=>!0===e.value))),b=Boolean(y.find((e=>!1===e.value)));return(0,u.jsx)(s().A,{type:"default",triggerActionMenuStore:o,onDone:x,onClose:m,sections:[{key:"select",render:e=>(0,u.jsx)(a().A,{...e,topBorder:!0}),items:[{key:"unchecked",render:e=>(0,u.jsx)(n().A,{...e,isChecked:b,isTokenTitle:!0,title:(0,u.jsx)(l().sA,{defaultMessage:"Unchecked",id:"propertyTrigger.checkbox.unchecked"})}),action:()=>v(!1)},{key:"checked",render:e=>(0,u.jsx)(n().A,{...e,isChecked:S,isTokenTitle:!0,title:(0,u.jsx)(l().sA,{defaultMessage:"Checked",id:"propertyTrigger.checkbox.checked"})}),action:()=>v(!0)}]}],headerTitle:(0,u.jsx)(l().sA,{id:"propertyTrigger.checkbox.title",defaultMessage:"{propertyName} set to",values:{propertyName:c.name}})})}},615028:(e,t,o)=>{o.d(t,{L9:()=>n,Yx:()=>i});const r=["relation_contains","relation_does_not_contain","is_empty","changes_to_any"];function n(e){const t=e;return r.includes(t)?t:"relation_contains"}const a=(0,o(69708).YK)({changesToAny:{id:"propertyTrigger.relationOperator.changesToAnyOption",defaultMessage:"Is edited"},isEmpty:{id:"propertyTrigger.relationOperator.isEmpty",defaultMessage:"Is cleared"},relationContains:{id:"propertyTrigger.relationOperator.relationContainsOption",defaultMessage:"Contains"},relationDoesNotContain:{id:"propertyTrigger.relationOperator.relationDoesNotContain",defaultMessage:"Does not contain"}}),i={relation_contains:{hasInput:!0,labelText:a.relationContains,text:a.relationContains,value:"relation_contains"},relation_does_not_contain:{hasInput:!0,labelText:a.relationDoesNotContain,text:a.relationDoesNotContain,value:"relation_does_not_contain"},changes_to_any:{hasInput:!1,text:a.changesToAny,labelText:a.changesToAny,value:"changes_to_any"},is_empty:{text:a.isEmpty,labelText:a.isEmpty,value:"is_empty",hasInput:!1}}},626792:(e,t,o)=>{o.d(t,{A:()=>H});o(944114),o(581454);var r=o(296540),n=()=>o(726637),a=()=>o(401497),i=()=>o(245720),l=()=>o(546926),s=()=>o(890492),u=()=>o(449279),c=()=>o(663639),p=()=>o(736847),d=()=>o(69708),m=(o(898992),o(354520),o(672577),()=>o(484714)),g=()=>o(590526),y=()=>o(79926),h=()=>o(352321),f=()=>o(452004),v=()=>o(898244),x=()=>o(247331),S=()=>o(239381),b=()=>o(791089),C=()=>o(187174),k=()=>o(201980),j=()=>o(778078),A=()=>o(496603),T=()=>o(805452),M=()=>o(821481),I=()=>o(534674),P=()=>o(106628),_=()=>o(361330),w=()=>o(120423),V=()=>o(674300),N=()=>o(784892),R=()=>o(554548),F=o(474848);function B({handleRemoveToken:e,isDisabled:t,token:o,parentRecordStore:a}){const i=(0,r.useCallback)((()=>{e&&e(o)}),[e,o]),l=(0,k().i$F)(o);if(!l)return null;const s=l.id;return(0,F.jsx)(R().A,{blockId:s,format:n().A.isMobile?N().NY.Medium:N().NY.Small,isSingle:!1,onClickRemove:i,parentStore:a,shouldShrink:!0,shouldWrap:!1,showRemoveButton:!t},s)}var O=()=>o(262509),E=()=>o(238259),D=()=>o(295633),W=()=>o(179034),L=()=>o(305390);function K({annotation:e,isChecked:t,menuArgs:o,parentRecordStore:r}){const n=(0,g().K8)((()=>{if((0,b().isAnnotationSimpleValueToken)(e)&&(0,k().jIt)(e))return(0,k().i$F)(e)}),[e]);if(!n)return null;const a=n.id,i=D().B.createChildStore(r,{id:a,table:W().ev});return(0,F.jsx)(L().A,{store:i,isChecked:t,hidePath:!0,...o})}function H(e){const{action:t,collection:o,currentSimpleFormulaValueTokens:N,formulaTypecheckContextValues:R,formulaValueContext:D,menuProps:W,onChange:L,onClose:H,showClearButton:z=!1,showFormulaValueItems:q=!1,showGenericHeader:U=!1,showInputMenuItem:Y=!1,showReplaceAddRemoveToggle:G=!1,value:$,parentRecordStore:Q}=e,J=(0,a().IS)((()=>({genericHeader:{paddingBottom:0},replaceAddRemoveToggleButton:{marginInlineStart:"8px",marginInlineEnd:"8px",marginTop:"8px"}})),[]),{footer:Z,header:X,menuListStore:ee,noResultsMessage:te,searchInput:oe,pageItems:re,replaceAddRemoveToggleButton:ne,valueItems:ae}=function(e){var t,o;const{action:a,collection:i,formulaTypecheckContextValues:l,formulaValueContext:s,onChange:u,onClose:c,showClearButton:p,showReplaceAddRemoveToggle:N,unlimitedCurrentSimpleFormulaValueTokens:R,value:O}=e,E=(0,m().v3)(),D=(0,m().Y0)(),W=(0,d().tz)(),{collectionStore:L,property:K}=s,H=(0,T().pg)(s),z=(0,g().K8)((()=>L.getSchema()[K]),[L,K]),q=(0,r.useMemo)((()=>{const e="relation"===(null==z?void 0:z.type)?(0,v().Nv)(z):void 0;return l.filter((t=>(0,S().o5)(t.type,{type:"block",collection:e},!0)))}),[l,z]),[U,Y]=(0,r.useState)(""),G=(0,g().uB)(void 0,f().$),$=(0,g().K8)((()=>!!(L&&K&&z&&(0,v().sO)(z))&&1===z.limit),[L,K,z]),Q=(0,y().fJ)(P().T.searchActions),[J]=(0,C().Yb)((async()=>{const e=U?(0,j().Ay)(U,q,(e=>e.kind===x().FormulaContextValueKind.ContextValue?e.name:"")):q;if("resolved"!==Q.status||!i)return;const t=Q.value,{results:o}=await t.searchPagesInCollection({environment:E,query:U,collectionId:i.id,limit:20,spaceId:i.spaceId,excludeTemplates:!0,source:"simple_formula_value_page_search",includePublicPagesWithoutExplicitAccess:!0,boostRecentlyViewedPages:!1});return{valueResults:e,pageResults:o}}),[U,q,Q.status,Q.value,i,E],{debounce:_().tu}),Z=H(R,"first").filter((e=>{if("string"!=typeof e&&"boolean"!=typeof e&&(0,k().jIt)(e)){var t,o;const r=null===(t=(0,k().i$F)(e))||void 0===t?void 0:t.id;if(r&&null!=J&&null!==(o=J.value)&&void 0!==o&&o.pageResults.includes(r))return!0}return!0})),X=(0,r.useCallback)((()=>{Y(""),G.setState({...G.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})}),[G]),ee=(0,r.useCallback)(((e,t)=>{u(e||O,t||a)}),[a,u,O]),te=(0,r.useCallback)((e=>{const t=H(e,"last");ee({type:"simple",value:(0,b().toSimpleFormulaArrayValue)(t)}),X(),$&&0!==t.length&&c()}),[H,ee,X,$,c]),oe=(0,r.useCallback)((()=>{te(Z.slice(0,Z.length-1))}),[Z,te]),re=(0,r.useCallback)((e=>{null==te||te((0,b().simpleFormulaValueWithoutToken)(Z,e))}),[Z,te]),ne=A().oE(Z.map(((e,t)=>"string"==typeof e||"boolean"==typeof e?null:(0,k().s1Y)(e)?(0,F.jsx)(V().A,{formulaTypecheckContextValues:l,handleRemoveToken:re,isDisabled:!1,token:e},t):(0,k().jIt)(e)?(0,F.jsx)(B,{parentRecordStore:L,handleRemoveToken:re,isDisabled:!1,token:e},t):null))),ae=(0,F.jsx)("div",{style:{...!n().A.isMobile&&{padding:"0 8px 4px 8px"}},children:(0,F.jsx)(h().Ay,{focus:!n().A.isMobile||void 0,focusAfterAnimation:!0,format:h().le.FilterValue,tokens:ne,placeholder:W.formatMessage(M().D.pageSearchPlaceholder),onRemoveLastToken:oe,onClearButtonClick:()=>te([]),value:U,onChange:e=>Y(e.target.value),dontShowBorderBottom:D.isAndroid,showClearButton:p})}),ie=(0,F.jsx)(I().A,{value:O,onChange:ee}),le=(0,F.jsx)(w().A,{action:a,handleOnChange:ee}),se=A().oE(((null===(t=J.value)||void 0===t?void 0:t.valueResults)||[]).map((e=>{const t=e.kind===x().FormulaContextValueKind.ContextValue&&e.id||"",o=Boolean(Z.find((e=>(0,b().isAnnotationSimpleValueToken)(e)&&(0,k().s1Y)(e)&&(0,k().iVq)(e).id===t)));return{action:"append",checkType:$?"single":"multi",isChecked:o,currentSimpleFormulaValueTokens:Z,id:t,setCurrentTokens:te,value:e}}))),ue=A().oE(((null===(o=J.value)||void 0===o?void 0:o.pageResults)||[]).map((e=>{const t=Boolean(Z.find((t=>{var o;return(0,b().isAnnotationSimpleValueToken)(t)&&(0,k().jIt)(t)&&(null===(o=(0,k().i$F)(t))||void 0===o?void 0:o.id)===e})));if(i){const o=(0,k().ld4)(e,i.spaceId);return{action:()=>{te(t?(0,b().simpleFormulaValueWithoutToken)(Z,o):[...Z,o])},isChecked:t,checkType:$?"single":"multi",annotation:o,id:e}}}))),ce=[...se,...ue];return{footer:ie,header:W.formatMessage(M().D.genericMenuHeader),menuListStore:G,noResultsMessage:0===ce.length&&J.value&&W.formatMessage(M().D.noResults),replaceAddRemoveToggleButton:Boolean(N)&&le,searchInput:ae,pageItems:ue,valueItems:se}}({action:t,collection:o,formulaTypecheckContextValues:R,formulaValueContext:D,onChange:L,onClose:H,showClearButton:z,showReplaceAddRemoveToggle:G,unlimitedCurrentSimpleFormulaValueTokens:N,value:$})||{},ie=[...(0,r.useMemo)((()=>q?ae.map((e=>{const{annotation:t,itemAction:o}=(0,E().E)({action:e.action,currentSimpleFormulaValueTokens:e.currentSimpleFormulaValueTokens,setCurrentTokens:e.setCurrentTokens,value:e.value});return{key:e.id,render:o=>(0,F.jsx)(O().A,{annotation:t,isChecked:e.isChecked,disabled:!1,formulaTypecheckContextValues:R,menuArgs:o,parentRecordStore:Q}),action:o}})):[]),[R,q,ae,Q]),...(0,r.useMemo)((()=>re?re.map((e=>({key:e.id,render:t=>(0,F.jsx)(K,{annotation:e.annotation,isChecked:e.isChecked,menuArgs:t,parentRecordStore:Q}),action:e.action}))):[]),[re,Q])],le=[];let se;ie.length>0&&le.push({key:"values",render:e=>(0,F.jsx)(p().A,{...e}),items:ie}),se=n().A.isMobile?{menuType:l().gu.Modal,right:(0,F.jsx)(d().sA,{...i().W.done}),onClickRight:H,minWidth:260,footer:Z&&(0,F.jsx)(p().A,{topBorder:!0,children:Z})}:{menuType:l().gu.Popup,maxHeight:"50vh",width:260,footer:Z&&(0,F.jsx)(p().A,{topBorder:!0,children:Z}),disableHeaderBorder:!0};const ue=U&&(0,F.jsx)(p().A,{style:J.genericHeader,title:X}),ce=(0,F.jsxs)(F.Fragment,{children:[n().A.isMobile?void 0:(null==W?void 0:W.header)||ue,Y?(0,F.jsx)(p().A,{children:oe}):void 0]}),pe=(0,F.jsxs)(F.Fragment,{children:[ne?(0,F.jsx)("div",{style:J.replaceAddRemoveToggleButton,children:ne}):void 0,te?(0,F.jsx)(p().A,{children:(0,F.jsx)(u().u,{title:te})}):void 0,ie.length>0?(0,F.jsx)(c().A,{type:c().O.Vertical,initialFocus:0,sections:le,store:ee}):void 0]});return{headerDiv:ce,innerComponents:pe,relationMenu:(0,F.jsx)(s().A,{...se,...W,header:ce,children:pe})}}},630550:(e,t,o)=>{o.d(t,{a:()=>S,c:()=>b});o(898992),o(672577);var r=o(296540),n=()=>o(484714),a=()=>o(590526),i=()=>o(79926),l=()=>o(69708),s=()=>o(813297),u=()=>o(908201),c=()=>o(862292),p=()=>o(324587),d=()=>o(546461),m=()=>o(366360),g=()=>o(76190),y=()=>o(283088),h=()=>o(813716),f=()=>o(7667),v=()=>o(541172),x=o(474848);function S(e){const{actionId:t,closeMenu:o,propertyId:u}=e,{maybePersistedTransactionActions:h}=(0,m().b)(),{automationStore:S,contextType:b}=(0,d().q8)(),C=(0,n().v3)(),k=(0,l().tz)(),{value:j}=(0,i().fJ)(c().T.formulas),{value:A}=(0,i().fJ)(s().QV.automationTypecheck),T=(0,g().n)(S),M=(0,y().j)(),I=(0,a().K8)((()=>{const e=S.getActionStores().find((e=>e.id===t));if(null!=e&&e.isDefined())return e}),[S,t]),P=(0,r.useCallback)((()=>{I&&j&&A&&(h.createAndCommit({perform:e=>{p().removeAutomationAction({actionStore:I,automationStore:S,automationTypecheckModule:A,contextType:b,environment:C,formulasModule:j,intl:k,isSubscribed:T,transaction:e,pageStore:M})},userAction:"UnsupportedPropertyMenu.removeAction"}),null==o||o())}),[I,S,A,o,b,C,j,k,T,h,M]),_=(0,f().A)(),w=(0,r.useMemo)((()=>()=>{_&&_(u),null==o||o()}),[o,_,u]);return(0,x.jsx)(v().Ol,{onDelete:P,onRestore:w,stepType:"action"})}function b(e){const{closeMenu:t,propertyId:o}=e,n=(0,u().Ks)(),{removePropertyTrigger:i}=(0,h().p)(),l=(0,a().K8)((()=>null==n?void 0:n.settingsStore),[n]),s=(0,a().K8)((()=>{const e=null==n?void 0:n.collectionStore();return Boolean(!(null!=e&&e.getSchema()[o]))&&Boolean(!(null!=e&&e.getDeletedSchema()[o]))}),[n,o]),c=(0,r.useCallback)((()=>{i(o),null==t||t()}),[t,o,i]),p=(0,f().A)(),d=(0,r.useMemo)((()=>()=>{l&&!s&&(p&&p(o),null==t||t())}),[t,l,p,s,o]);return(0,x.jsx)(v().Ol,{onDelete:c,onRestore:d,stepType:"trigger"})}},637573:(e,t,o)=>{o.d(t,{r:()=>l});var r=()=>o(907258),n=()=>o(484714),a=()=>o(590526),i=()=>o(379026);function l(){const e=(0,n().v3)();return(0,a().K8)((()=>{const{sidebarSpaceStore:t}=r().default.state;if(t)return(0,i().f)({environment:e,spaceId:t.id})}),[e])}},652620:(e,t,o)=>{o.d(t,{h:()=>a});o(296540);var r=o(474848);const n={viewBox:"0 0 16 16",fittedViewBox:"2.37 2.37 11.25 11.25",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{d:"M10.172 5.564a.625.625 0 0 0-.858.214L7.36 9.035 6.325 7.827a.625.625 0 1 0-.95.813l1.6 1.867a.625.625 0 0 0 1.01-.085l2.4-4a.625.625 0 0 0-.213-.858"}),(0,r.jsx)("path",{d:"M4.25 2.375c-1.036 0-1.875.84-1.875 1.875v7.5c0 1.036.84 1.875 1.875 1.875h7.5c1.036 0 1.875-.84 1.875-1.875v-7.5c0-1.036-.84-1.875-1.875-1.875zM3.625 4.25c0-.345.28-.625.625-.625h7.5c.345 0 .625.28.625.625v7.5c0 .345-.28.625-.625.625h-7.5a.625.625 0 0 1-.625-.625z"})]})},a=(0,o(340498).wt)("checkmarkSquareSmall",n,"small")},674300:(e,t,o)=>{o.d(t,{A:()=>u});o(296540);var r=()=>o(784892),n=()=>o(239381),a=()=>o(201980),i=()=>o(534177),l=()=>o(744951),s=o(474848);function u({formulaTypecheckContextValues:e,handleRemoveToken:t,isDisabled:o,token:u,style:c,iconSize:p,preventOnClickPropagation:d}){const m=(0,a().iVq)(u).id,g=(0,i().O9)(e)?(0,n().IV)(e,m):void 0;return g?(0,s.jsx)(l().F,{value:g,format:r().NY.Small,isSingle:!1,shouldShrink:!0,showRemoveButton:!o,style:c,onClickRemove:e=>{d&&(null==e||e.stopPropagation()),t(u,e)}}):null}},675326:(e,t,o)=>{o.d(t,{S:()=>n});o(296540);const r={viewBox:"0 0 20 20",fittedViewBox:"2.37 2.37 15.25 15.35",svg:(0,o(474848).jsx)("path",{d:"M8.901 8.802a.223.223 0 0 1 .367-.197l4.99 4.208a.224.224 0 0 1-.117.393l-1.83.208 1.842 3.31a.67.67 0 1 1-1.174.65l-1.805-3.241-1.07 1.576a.224.224 0 0 1-.409-.1zM6.376 12.74a.625.625 0 0 1 .884.884l-1.768 1.768a.625.625 0 1 1-.884-.884zM5.5 9.375a.625.625 0 1 1 0 1.25H3a.625.625 0 1 1 0-1.25zm11.5 0a.625.625 0 1 1 0 1.25h-2.5a.625.625 0 1 1 0-1.25zM4.608 4.608a.625.625 0 0 1 .884 0L7.26 6.376a.625.625 0 1 1-.884.884L4.608 5.492a.625.625 0 0 1 0-.884m9.9 0a.625.625 0 1 1 .884.884L13.624 7.26a.625.625 0 0 1-.884-.884zM10 2.375c.345 0 .625.28.625.625v2.5a.625.625 0 1 1-1.25 0V3c0-.345.28-.625.625-.625"})},n=(0,o(340498).wt)("cursorClick",r,"default")},714202:(e,t,o)=>{o.d(t,{A:()=>k,r:()=>M});var r=o(296540),n=()=>o(726637),a=()=>o(118884),i=()=>o(590526),l=()=>o(401497),s=()=>o(245720),u=()=>o(695115),c=()=>o(546926),p=()=>o(631524),d=()=>o(890492),m=()=>o(663639),g=()=>o(526278),y=()=>o(62900),h=()=>o(340498),f=()=>o(69708),v=()=>o(100622),x=()=>o(534177),S=()=>o(284371),b=o(474848);const C=(0,f().YK)({backButtonAriaLabel:{id:"notificationRuleSettingsMenu.backButton.ariaLabel",defaultMessage:"Back to previous step"}});function k(e){const{triggerActionMenuStore:t,customMenuProps:o,headerTitle:n,onClose:i,onDone:l,subHeaderComponent:s,type:u,width:c}=e,p=(0,r.useRef)(!1),d=(0,r.useCallback)((()=>{p.current=!0,null==l||l()}),[l]),m=M({triggerActionMenuStore:t,customMenuProps:o,onClose:i,onDone:d,subHeaderComponent:s,title:n,width:c});return(0,a().X)((()=>{const e=t.getState().stack,o=e[e.length-1];!p.current&&(0,x().O9)(o)&&"propertyChangedFilter"===o.type&&(null==l||l())})),"custom"===u?(0,b.jsx)(A,{...e,menuProps:m}):(0,b.jsx)(j,{...e,menuProps:m})}function j(e){const{sections:t,menuProps:o}=e;return(0,b.jsx)(d().A,{...o,children:(0,b.jsx)(m().A,{type:m().O.Vertical,initialFocus:0,sections:t})})}function A(e){const{children:t,menuProps:o}=e;return(0,b.jsx)(d().A,{...o,children:t})}function T(e){const{automationActionMenuStore:t,menuHeaderTitle:o,onDone:r,subHeaderComponent:n}=e,a=(0,f().tz)(),s=(0,i().K8)((()=>t.state.stack.length>1),[t]),c=(0,l().IS)((()=>({header:{display:"flex",alignItems:"center",color:v().Tj.text.secondary,fontWeight:S().Wy.medium,fontSize:S().J.UISmall.desktop,padding:8,justifyContent:"space-between"},leadingItems:{display:"flex",alignItems:"center",gap:6,overflow:"hidden",whiteSpace:"nowrap"},iconButtonStyle:{height:h().Ev.default,width:h().Ev.default}})),[]);return void 0!==o||s?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{style:c.header,children:[(0,b.jsxs)("div",{style:c.leadingItems,children:[s?(0,b.jsx)(u().A,{ariaLabel:a.formatMessage(C.backButtonAriaLabel),icon:y().arrowStraightLeftSmallIcon,style:c.iconButtonStyle,onClick:()=>{t.popSettingsItem()}}):void 0,o]}),r?(0,b.jsx)(p().p,{onClick:r,colorPalette:"blue",size:"xs",children:(0,b.jsx)(f().sA,{id:"automationTriggerActionMenu.doneButton.title",defaultMessage:"Done"})}):void 0]}),n]}):null}function M(e){const{triggerActionMenuStore:t,customMenuProps:o={},onClose:a,onDone:i,subHeaderComponent:l,title:p,width:d}=e,m=(0,f().tz)(),y=(0,r.useCallback)((()=>{1===t.getState().stack.length?a():t.popSettingsItem()}),[t,a]);return(0,r.useMemo)((()=>{let e;return e=n().A.isMobile?{...o,minWidth:260,menuType:c().gu.Modal,title:p,left:(0,b.jsx)(u().A,{ariaLabel:m.formatMessage(C.backButtonAriaLabel),icon:g().arrowStraightLeftIcon,size:"md",onClick:y}),right:(0,b.jsx)(f().sA,{...s().W.done}),onClickRight:()=>{null==i||i()},header:l}:{width:d??266,menuType:c().gu.Popup,maxHeight:"50vh",header:(0,b.jsx)(T,{automationActionMenuStore:t,menuHeaderTitle:p,subHeaderComponent:l,onDone:i})},e}),[t,o,m,i,y,l,p,d])}},717322:(e,t,o)=>{o.d(t,{A:()=>J});o(944114),o(581454);var r=o(296540),n=()=>o(726637),a=()=>o(401497),i=()=>o(245720),l=()=>o(546926),s=()=>o(890492),u=()=>o(449279),c=()=>o(663639),p=()=>o(736847),d=()=>o(69708),m=()=>o(100622),g=(o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(354520),o(908872),()=>o(908006)),y=()=>o(484714),h=()=>o(590526),f=()=>o(352321),v=()=>o(452004),x=()=>o(898244),S=()=>o(247331),b=()=>o(239381),C=()=>o(791089),k=()=>o(187174),j=()=>o(792071),A=()=>o(201980),T=()=>o(778078),M=()=>o(496603),I=()=>o(805452),P=()=>o(821481),_=()=>o(534674),w=()=>o(106628),V=()=>o(361330),N=()=>o(120423),R=()=>o(674300),F=()=>o(576241),B=o(474848);var O=()=>o(320865),E=()=>o(262509),D=()=>o(238259),W=()=>o(420802),L=()=>o(26697),K=()=>o(81068),H=()=>o(764880),z=()=>o(798880),q=()=>o(448693),U=()=>o(27356),Y=()=>o(698449),G=()=>o(218055),$=()=>o(975969);function Q({annotation:e,disabled:t,getRecordModel:o,isSelected:a,menuArgs:i,showPersonCheckbox:l}){const s=(0,d().tz)(),u=(0,$().U)(),c=(0,h().K8)((()=>{if((0,C().isAnnotationSimpleValueToken)(e)&&(0,A().rie)(e)){const t=(0,A().NcG)(e);if(t)return(0,H().xC)({pointer:{table:z().oo,id:t},getRecordValue:o})}}),[e,o]),p=(0,h().K8)((()=>{if((0,C().isAnnotationSimpleValueToken)(e)&&(0,A().RaC)(e)){const t=(0,A().cFJ)(e);if(t)return o(t)}}),[e,o]),m=(0,h().K8)((()=>{if(p)return(0,Y().Pf)({intl:s,groupName:p.name})}),[p,s]),g=n().A.isMobile?q().t_.Format.Large:q().t_.Format.Medium,y=(0,r.useMemo)((()=>null!=c&&c.asActor&&c.table===z().oo?(0,B.jsx)(q().t_,{isSingle:!0,shouldShrink:!0,format:g,userValue:c.asActor,hasPersonHoverCard:!1}):p&&m?(0,B.jsx)(U().UISpacePermissionGroupToken,{groupModel:p,groupPointer:p.pointer,isSingle:!0,shouldShrink:!0,format:g}):null),[c,p,m,g]);return(0,B.jsx)(K().A,{...i,...l?{icon:(0,B.jsx)(W().S,{checked:a,size:14,onClick:i.onClick})}:{},title:t?(0,B.jsx)(L().m,{renderTooltip:()=>(0,B.jsx)(d().sA,{...G().O.maximumPeopleSelectedTooltip}),placement:"right",render:e=>(0,B.jsx)("div",{style:{width:"100%"},...e,children:y})}):y,disabled:t,style:t?u.disabledMenuItem:void 0,isTokenTitle:!0})}function J(e){const{action:t,currentSimpleFormulaValueTokens:o,formulaTypecheckContextValues:W,formulaValueContext:L,getRecordModel:K,isDisabled:H,limit:z,menuProps:q,onChange:U,onClose:Y,showClearButton:G=!1,showFormulaValueItems:$=!1,showGenericHeader:J=!1,showInputMenuItem:Z=!1,showPersonCheckbox:X=!1,showReplaceAddRemoveToggle:ee=!1,value:te,parentRecordStore:oe}=e,re=(0,a().IS)((()=>({genericHeader:{paddingBottom:0},headerDiv:{paddingBlockEnd:n().A.isMobile?0:6,borderBlockEnd:n().A.isMobile?"none":`1px solid ${m().oZ.dividerColor}`},replaceAddRemoveToggleButton:{marginInlineStart:"8px",marginInlineEnd:"8px",marginTop:"8px"}})),[]),{errorMessage:ne,footer:ae,header:ie,isLoading:le,menuListStore:se,noResultsMessage:ue,replaceAddRemoveToggleButton:ce,searchInput:pe,userItems:de,valueItems:me}=function(e){var t,o,a;const{action:i,formulaTypecheckContextValues:l,formulaValueContext:s,isDisabled:u=!1,limit:c,onChange:p,onClose:m,showClearButton:O,showReplaceAddRemoveToggle:E,showSelectedPeople:D,unlimitedCurrentSimpleFormulaValueTokens:W,value:L,parentRecordStore:K}=e,H=(0,y().v3)(),z=(0,y().Y0)(),q=(0,d().tz)(),U="collection"===(null==s?void 0:s.type)?s.collectionStore.getRecordModel:j().b4_.constant(void 0),Y=(0,I().pg)(s),G=Y(W,"first"),$=(0,r.useMemo)((()=>l.filter((e=>(0,b().o5)(e.type,{type:"person"})))),[l]),[Q,J]=(0,r.useState)(""),Z=(0,h().uB)(void 0,v().$),X=(0,h().K8)((()=>{if("collection"!==s.type)return!1;const e=s.collectionStore.getSchema()[s.property];return e&&(0,x().sO)(e)?1===e.limit:void 0}),[s]),ee=(0,h().K8)((()=>"collection"===s.type?s.collectionStore.getSpaceId():""),[s]),[te]=(0,k().Yb)((async()=>{const e=Q?(0,T().Ay)(Q,$,(e=>e.kind===S().FormulaContextValueKind.ContextValue?e.name:"")):$,t=(0,C().fromSimpleFormulaArrayValue)(null==L?void 0:L.value).reduce(((e,t)=>(t&&(0,C().isAnnotationSimpleValueToken)(t)&&(0,A().rie)(t)&&e.push(t[1]),e)),[]),o=await w().T.searchActions.load(),r=await o.searchSpaceUsers({environment:H,query:Q,membersOnly:!1,limit:20+t.length}),n=o.searchSpaceGroups({query:Q,intl:q});let a=0,i=r[a];const l=[];for(;i&&l.length<20;)t.includes(i.id)&&!D||l.push(i.id),a+=1,i=r[a];return{valueResults:e,groupResults:n.map((e=>e.getGroupId())),userResults:l}}),[H,Q,D,$,null==L?void 0:L.value,q],{debounce:V().tu}),oe=(0,r.useCallback)((()=>{J(""),Z.setState({...Z.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})}),[Z]),re=(0,r.useCallback)(((e,t)=>{p(e||L,t||i)}),[i,p,L]),ne=(0,r.useCallback)((e=>{const t=Y(e,"last");re({type:"simple",value:(0,C().toSimpleFormulaArrayValue)(t)}),oe()}),[Y,re,oe]),ae=(0,r.useCallback)((()=>{ne(G.slice(0,G.length-1))}),[G,ne]),ie=(0,r.useCallback)((e=>{null==ne||ne((0,C().simpleFormulaValueWithoutToken)(G,e))}),[G,ne]),le=Boolean(c&&G.length>=c),se=M().oE(G.map(((e,t)=>"string"==typeof e||"boolean"==typeof e?null:(0,A().rie)(e)||(0,A().RaC)(e)?(0,B.jsx)(F().A,{parentRecordStore:K,handleRemoveToken:ie,token:e},t):(0,A().s1Y)(e)?(0,B.jsx)(R().A,{formulaTypecheckContextValues:l,handleRemoveToken:ie,isDisabled:u||le,token:e},t):null))),ue=new Set(M().oE(G.map((e=>(0,C().isAnnotationSimpleValueToken)(e)&&(0,A().s1Y)(e)&&(0,A().iVq)(e).id)))),ce=new Set(M().oE(G.map((e=>(0,C().isAnnotationSimpleValueToken)(e)&&(0,A().rie)(e)&&(0,A().NcG)(e))))),pe=new Set(M().oE(G.map((e=>{if((0,C().isAnnotationSimpleValueToken)(e)&&(0,A().RaC)(e)){const t=(0,A().FHi)(e);return null==t?void 0:t.groupId}})))),de=M().oE(((null===(t=te.value)||void 0===t?void 0:t.valueResults)||[]).map((e=>{const t=e.kind===S().FormulaContextValueKind.ContextValue&&e.id||"";if(!t||!ue.has(t)||D)return{action:"append",currentSimpleFormulaValueTokens:G,isDisabled:u||le,id:t,getRecordModel:U,setCurrentTokens:ne,value:e}}))),me=(e,t,o)=>{if(!t||D)return{action:()=>{t?ie(o):ne([...G,o]),X&&g().default.afterNextFlush((()=>{m()}))},annotation:o,getRecordModel:U,id:e,isDisabled:u||le,userIdOrGroupId:e,isSelected:t}},ge=M().oE(((null===(o=te.value)||void 0===o?void 0:o.userResults)||[]).map((e=>{const t=(0,A().P4h)(e);return me(e,ce.has(e),t)}))),ye=M().oE(((null===(a=te.value)||void 0===a?void 0:a.groupResults)||[]).map((e=>{const t=(0,A().dWL)(e,ee);return me(e,pe.has(e),t)}))),he=[...de,...ge,...ye],fe=(0,B.jsx)("div",{style:{...!n().A.isMobile&&{padding:"0 8px 4px 8px"}},children:(0,B.jsx)(f().Ay,{style:{maxHeight:6*parseInt(f().sA,10)},disabled:u||le,dontShowBorderBottom:z.isAndroid,focus:!n().A.isMobile||void 0,focusAfterAnimation:!0,format:f().le.FilterValue,onChange:e=>J(e.target.value),onClearButtonClick:()=>ne([]),onRemoveLastToken:ae,placeholder:q.formatMessage(P().D.personSearchPlaceholder),showClearButton:O,tokens:se,value:Q})}),ve=(0,B.jsx)(_().A,{value:L,onChange:re}),xe=(0,B.jsx)(N().A,{action:i,handleOnChange:re});return{errorMessage:te.error&&q.formatMessage(P().D.somethingWentWrong),footer:ve,header:q.formatMessage(P().D.genericMenuHeader),isLoading:!te.value&&!te.error,menuListStore:Z,noResultsMessage:0===he.length&&te.value&&q.formatMessage(P().D.noResults),replaceAddRemoveToggleButton:Boolean(E)&&xe,searchInput:fe,userItems:[...ge,...ye],valueItems:de}}({action:t,formulaTypecheckContextValues:W,formulaValueContext:L,isDisabled:H,limit:z,onChange:U,onClose:Y,showClearButton:G,showReplaceAddRemoveToggle:ee,showSelectedPeople:X,unlimitedCurrentSimpleFormulaValueTokens:o,value:te,parentRecordStore:oe})||{},ge=[...(0,r.useMemo)((()=>me&&$?me.map((e=>{const{annotation:t,itemAction:o}=(0,D().E)({action:e.action,currentSimpleFormulaValueTokens:e.currentSimpleFormulaValueTokens,setCurrentTokens:e.setCurrentTokens,value:e.value});return{key:e.id,render:o=>(0,B.jsx)(E().A,{annotation:t,disabled:e.isDisabled,formulaTypecheckContextValues:W,menuArgs:o,parentRecordStore:oe}),action:o}})):[]),[W,$,me,oe]),...(0,r.useMemo)((()=>de?de.map((e=>({key:e.userIdOrGroupId,render:t=>(0,B.jsx)(Q,{annotation:e.annotation,disabled:e.isDisabled,getRecordModel:K||e.getRecordModel,isSelected:e.isSelected,menuArgs:t,showPersonCheckbox:X}),action:e.action}))):[]),[K,X,de])],ye=[];let he;ge.length>0&&ye.push({key:"users",render:e=>(0,B.jsx)(p().A,{...e}),items:ge}),he=n().A.isMobile?{menuType:l().gu.Modal,minWidth:260,right:(0,B.jsx)(d().sA,{...i().W.done}),onClickRight:Y,footer:ae&&(0,B.jsx)(p().A,{topBorder:!0,children:ae})}:{menuType:l().gu.Popup,maxHeight:"50vh",width:260,footer:ae&&(0,B.jsx)(p().A,{topBorder:!0,children:ae}),disableHeaderBorder:!0};const fe=J&&(0,B.jsx)(p().A,{style:re.genericHeader,title:ie}),ve=(0,B.jsxs)("div",{style:re.headerDiv,children:[n().A.isMobile?void 0:(null==q?void 0:q.header)||fe,Z?pe:void 0]}),xe=(0,B.jsxs)(B.Fragment,{children:[ne?(0,B.jsx)(p().A,{children:(0,B.jsx)(u().u,{title:ne})}):void 0,le||ne||!ce?void 0:(0,B.jsx)("div",{style:re.replaceAddRemoveToggleButton,children:ce}),ue?(0,B.jsx)(p().A,{children:(0,B.jsx)(u().u,{title:ue})}):void 0,le?(0,B.jsx)(p().A,{children:(0,B.jsx)(O().A,{})}):void 0,ge.length>0?(0,B.jsx)(c().A,{type:c().O.Vertical,initialFocus:0,sections:ye,store:se}):void 0]});return{headerDiv:ve,innerComponents:xe,personArrayMenu:(0,B.jsx)(s().A,{...he,...q,header:ve,children:xe})}}},741310:(e,t,o)=>{o.d(t,{P:()=>s});var r=o(296540),n=()=>o(401497),a=()=>o(26697),i=()=>o(100622),l=o(474848);function s(e){const{caption:t,disable:o,renderOrigin:s,title:u,tooltipAlignment:c,tooltipPlacement:p,disableTooltip:d}=e,m=(0,n().IS)((()=>({tooltipTitle:{margin:0},tooltipCaption:{color:i().Tj.text.inverseSecondary,margin:0}})),[]),g=(0,r.useCallback)((()=>(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("p",{style:m.tooltipTitle,children:u}),(0,l.jsx)("p",{style:m.tooltipCaption,children:t})]})),[t,u,m.tooltipCaption,m.tooltipTitle]);return(0,l.jsx)(a().m,{alignment:c||"center",delayThreshold:800,disableTooltip:o||d,placement:p||"bottom",render:s,renderTooltip:g,textWrap:!0})}},744951:(e,t,o)=>{o.d(t,{F:()=>d});o(296540);var r=()=>o(494379),n=()=>o(247331),a=()=>o(239381),i=()=>o(340498),l=()=>o(100622),s=()=>o(534177),u=()=>o(931077),c=()=>o(848401),p=o(474848);function d(e){const{value:t,style:o}=e,d=e.iconStyle??{width:i().Ev.xs,height:i().Ev.xs,marginInlineEnd:4},m=(0,a().sM)(t);let g;if(t.kind===n().FormulaContextValueKind.ContextValue&&(0,s().O9)(t.stepNumberForDisplay)){const e=t.stepNumberForDisplay;g=()=>(0,p.jsx)(u().Q,{size:r().H.ExtraSmall,number:e,style:{marginInlineEnd:4}})}else{const e=(0,a().Ix)(t.type);if(e){const t=e;g=()=>t(d)}}return(0,p.jsx)(c().Ay,{...e,title:m,renderAvatar:g,shouldShrink:!0,style:{background:l().Tj.outlineBlueButtonPressedBackground,color:l().Tj.blue.text.accentPrimary,padding:"2px 4px",margin:0,...o}})}},747938:(e,t,o)=>{o.d(t,{Dy:()=>l,Os:()=>u,l$:()=>s,qO:()=>i});o(944114),o(898992),o(354520);var r=()=>o(617871),n=()=>o(792071),a=()=>o(402904);function i(e){if(e.integration_id!==r().zG)throw"Cannot render account for integration.";const t=/(.+) - (.+)/.exec(e.account_name);if(!t)return{accountName:e.account_name};const[,o,n]=t;return{organizationName:o,accountName:n}}function l(e){return n().Bj6.fromValue(a().As,e).getSlackWorkspaceId()}function s(e,t){return t?e.filter((e=>{const o=l(e);return!!o&&t(o)})):e}function u(e,t=""){const o={};for(const r of e){const{accountName:e,organizationName:n}=i(r);c({query:t,accountName:e,organizationName:n})&&(o[e]||(o[e]=[]),o[e].push({externalAuthentication:r,workspaceName:n}))}return o}function c(e){const{accountName:t,organizationName:o,query:r}=e;if(0===r.length)return!0;const n=t.toLocaleLowerCase().indexOf(r.trim().toLocaleLowerCase())>=0,a=!!o&&o.toLocaleLowerCase().indexOf(r.trim().toLocaleLowerCase())>=0;return n||a}},749311:(e,t,o)=>{o.d(t,{$R:()=>i,Qy:()=>n});const r=["number_does_not_equal","number_equals","number_greater_than","number_greater_than_or_equal_to","number_less_than","number_less_than_or_equal_to","is_empty","changes_to_any"];function n(e){const t=e;return r.includes(t)?t:"number_equals"}const a=(0,o(69708).YK)({changesToAny:{id:"propertyTrigger.numberField.changesToAnyOption",defaultMessage:"Is edited"},numberEquals:{id:"propertyTrigger.numberField.equalsOption",defaultMessage:"="},numberGreaterThanOrEqualTo:{id:"propertyTrigger.numberField.greaterThanOrEqualTo",defaultMessage:"â‰¥"},numberLessThanOrEqualTo:{id:"propertyTrigger.numberField.lessThanOrEqualTo",defaultMessage:"â‰¤"},isEmpty:{id:"propertyTrigger.numberField.isEmpty",defaultMessage:"Is cleared"},numberGreaterThan:{id:"propertyTrigger.numberField.greaterThan",defaultMessage:">"},numberLessThan:{id:"propertyTrigger.numberField.lessThan",defaultMessage:"<"},numberDoesNotEqual:{id:"propertyTrigger.numberField.doesNotEqualOption",defaultMessage:"â‰ "}}),i={number_equals:{hasInput:!0,text:a.numberEquals,value:"number_equals"},number_does_not_equal:{hasInput:!0,text:a.numberDoesNotEqual,value:"number_does_not_equal"},number_greater_than:{hasInput:!0,text:a.numberGreaterThan,value:"number_greater_than"},number_less_than:{hasInput:!0,text:a.numberLessThan,value:"number_less_than"},number_greater_than_or_equal_to:{hasInput:!0,text:a.numberGreaterThanOrEqualTo,value:"number_greater_than_or_equal_to"},number_less_than_or_equal_to:{hasInput:!0,text:a.numberLessThanOrEqualTo,value:"number_less_than_or_equal_to"},changes_to_any:{hasInput:!1,text:a.changesToAny,value:"changes_to_any"},is_empty:{text:a.isEmpty,value:"is_empty",hasInput:!1}}},798941:(e,t,o)=>{o.d(t,{VW:()=>g,aR:()=>m});o(296540);var r=()=>o(590526),n=()=>o(401497),a=()=>o(784892),i=()=>o(69708),l=()=>o(534177),s=()=>o(284371),u=()=>o(881690),c=()=>o(749311),p=()=>o(214973),d=o(474848);function m(e){const{numberValue:t,operator:o,propertySchema:m,messageType:y}=e,h=(0,i().tz)(),f=(0,n().IS)((()=>({content:{alignItems:"center",display:"flex",flexWrap:"wrap",whiteSpace:"pre",lineHeight:1.6},propertyName:{...s().RC,fontWeight:s().Wy.medium},propertyValue:{...s().RC,paddingBlockStart:4}})),[]),v=(0,r().K8)((()=>function(e){const{numberValue:t,operator:o,propertySchema:r,styles:n,messageType:s,intl:m}=e,g=(0,d.jsx)("span",{style:n.propertyName,children:r.name});let y;const h=m.formatMessage(c().$R[o].text).toLocaleLowerCase();"action"===s?y=p().vC({propertyName:g,propertyValues:(0,d.jsx)(u().A,{format:a().NY.Medium,isRound:!0,isSingle:!0,value:t,showRemoveButton:!1,style:{flex:"none"}}),operator:h}):"trigger"===s?y=p().Rn({propertyName:g,propertyValues:(0,d.jsx)(u().A,{format:a().NY.Medium,isRound:!0,isSingle:!0,value:t,showRemoveButton:!1,style:{flex:"none"}}),operator:h}):(0,l().HB)(s);return(0,d.jsx)(i().sA,{...y})}({intl:h,messageType:y,numberValue:t,operator:o,propertySchema:m,styles:f})),[y,t,o,m,f,h]);return{tooltipTitle:(0,r().K8)((()=>g({intl:h,messageType:y,numberValue:t,operator:o,propertySchema:m})),[h,y,t,o,m]),title:v,styles:f}}function g(e){const{numberValue:t,operator:o,propertySchema:r,messageType:n,intl:a}=e,s=r.name;let u;const m=a.formatMessage(c().$R[o].text).toLocaleLowerCase();return"action"===n?u=p().vC({propertyName:s,propertyValues:t,operator:m}):"trigger"===n?u=p().Rn({propertyName:s,propertyValues:t,operator:m}):(0,l().HB)(n),(0,d.jsx)(i().sA,{...u})}},798971:(e,t,o)=>{o.d(t,{Mn:()=>l,Oj:()=>i,fJ:()=>u});var r=()=>o(764880),n=()=>o(914462);const a=["person_contains","person_does_not_contain","is_empty","changes_to_any"];function i(e){const t=e;return a.includes(t)?t:"person_contains"}function l(e,t){return"actor"===t.type?(0,r().lR)(e,t.model):(0,n().n)({intl:e,permissionGroupModel:t.model})}const s=(0,o(69708).YK)({changesToAny:{id:"propertyTrigger.personField.changesToAnyOption",defaultMessage:"Is edited"},isEmpty:{id:"propertyTrigger.personField.isEmpty",defaultMessage:"Is cleared"},personContains:{id:"propertyTrigger.personField.personContainsOption",defaultMessage:"Contains"},personDoesNotContain:{id:"propertyTrigger.personField.personDoesNotContainOption",defaultMessage:"Does not contain"}}),u={person_contains:{hasInput:!0,text:s.personContains,labelText:s.personContains,value:"person_contains"},person_does_not_contain:{hasInput:!0,labelText:s.personDoesNotContain,text:s.personDoesNotContain,value:"person_does_not_contain"},changes_to_any:{hasInput:!1,text:s.changesToAny,labelText:s.changesToAny,value:"changes_to_any"},is_empty:{hasInput:!1,labelText:s.isEmpty,text:s.isEmpty,value:"is_empty"}}},805452:(e,t,o)=>{o.d(t,{Cp:()=>C,D2:()=>b,aS:()=>x,m9:()=>S,pg:()=>v});o(944114),o(898992),o(354520),o(581454),o(908872);var r=o(296540),n=()=>o(590526),a=()=>o(792057),i=()=>o(807449),l=()=>o(898244),s=()=>o(597777),u=()=>o(510916),c=()=>o(247331),p=()=>o(239381),d=()=>o(467248),m=()=>o(797809),g=()=>o(201980),y=()=>o(69708),h=()=>o(534177),f=o(474848);function v(e){const t=(0,n().K8)((()=>{if("collection"!==e.type)return;const t=e.collectionStore.getSchema()[e.property];let o;return t&&(0,l().sO)(t)&&(o=t.limit),o}),[e]);return(0,r.useCallback)(((e,o)=>(0,h().O9)(t)?"first"===o?e.slice(0,t):"last"===o?e.slice(-t):void(0,h().HB)(o):e),[t])}function x(e){var t;const o=null===(t=e.collectionStore.getSchema())||void 0===t?void 0:t[e.property];return o&&"date"===o.type?{dateFormat:o.date_format||s().vz,timeFormat:o.time_format||s().CE}:{dateFormat:s().vz,timeFormat:s().CE}}function S(e,t,o){if("simple"===(null==e?void 0:e.type)&&e.value){const r=e.value.reduce(((e,r)=>{const n=e.length>0;if((0,g().bHQ)(r)){if(n||!(0,g()._g9)(r)){const t=r[0];if(A(t)){const o=T(t);e.push((0,g().Ey_)(o))}else e.push((0,g().Ey_)(`"${t}"`))}}else if((0,g().BEe)(r)){const t=r[0];if(A(t)){const o=T(t);e.push((0,g().Ey_)(o))}else e.push((0,g().Ey_)(`"${t}"`))}else if((0,g().qXl)(r)){const n=function({mentionToken:e,contextValues:t,getRecordModel:o}){const r=(0,g().uPN)(e),n=(0,g().TVE)(r);if(n&&(0,g()._Nw)(n[1])){const e=n[1],r=e.property,i=(0,p()._H)(t,e.contextValueId);let l,s;if(i&&i.kind===c().FormulaContextValueKind.ContextValue&&"block"===i.type.type&&(s=i.type.collection),s){const e=o(s);var a;if(e)l=null===(a=e.getSchema()[r])||void 0===a?void 0:a.name}if(!l&&i&&((0,m().PJ)(r)?l=(0,u().i)(r):e.name&&(l=e.name)),l){const t=(0,g().CA$)({id:e.contextValueId}),o=(0,g().ESw)({property:r,name:l,collection:s});return[(0,g().wmz)(t),(0,g().Ey_)("."),(0,g().wmz)(o)]}}return}({mentionToken:r,contextValues:t,getRecordModel:o});if(n)e.push(...n);else{const t=(0,g().uPN)(r),o=(0,g().jhx)(t);if(o){const r=t.filter((e=>!(0,g().jcO)(e)));e.push((0,g().wmz)(o,r))}}}return e}),[]),n=e=>{const t=[];for(let o=0;o<e.length;o++){const r=e[o],n=e[o+1];t.push(r),!(o<e.length-1)||(0,g().bHQ)(r)&&"."===r[0]||n&&(0,g().bHQ)(n)&&("."===n[0]||n[0].startsWith("."))||t.push((0,g().Ey_)(" + "))}return t},a=e=>{const t=[];for(let o=0;o<e.length;o++){const r=e[o],n=e[o+1];(0,g().bHQ)(r)&&" + "===r[0]&&n&&(0,g().bHQ)(n)&&n[0].startsWith(".")||t.push(r)}return t},i=(0,g().__s)(a(n(r)));return i.length>0?i:void 0}return null==e?void 0:e.value}function b(e){if(!e||0===e.length)return;const t=[];for(let r=0;r<e.length;r++){const o=e[r];if((0,g().bHQ)(o)){const{result:e,skip:r}=k(o);if(r)continue;e&&t.push(e)}else if((0,g().qXl)(o)){const{result:n,skipCount:a}=j(o,e,r);n&&t.push(n),r+=a}else t.push(o)}const o=t.filter((e=>(0,g().N8A)(e).length>0));return 0!==o.length?{type:"simple",value:(0,g().__s)(o)}:void 0}async function C(){const{accept:e}=await a().Gh({acceptButtonType:"outline",acceptColor:void 0,acceptLabel:(0,f.jsx)(y().sA,{id:"formulaInputMenu.handleBack.convert",defaultMessage:"Convert"}),cancelButtonType:"outline",description:(0,f.jsx)(y().sA,{id:"formulaInputMenu.handleBack.description",defaultMessage:"Existing formula content will be lost"}),icon:(0,f.jsx)(i().I,{icon:d().i,size:36}),message:(0,f.jsx)(y().sA,{id:"formulaInputMenu.handleBack.message",defaultMessage:"Convert this variable from a formula to plain text?"})});return e}function k(e){const t=e[0];if(" + "===t)return{result:null,skip:!0};if("."===t)return{result:null,skip:!0};if(t.includes('"')&&t.includes("+")){if(t.match(/(?:[a-zA-Z_]\w*|\.\w+)\s*\(/))return{result:e,skip:!1};const o=t.match(/"(?:[^"\\]|\\.)*"/g);if(o){const e=o.map((e=>e.slice(1,-1).replace(/\\"/g,'"'))).join("");return{result:(0,g().Ey_)(e),skip:!1}}return{result:e,skip:!1}}const o=t.match(/^\s*\+\s*"(.*)"\s*$/);if(o)return{result:(0,g().Ey_)(o[1]),skip:!1};if(t.startsWith('"')&&t.endsWith('"')){const e=t.slice(1,-1);return{result:(0,g().Ey_)(e),skip:!1}}return{result:e,skip:!1}}function j(e,t,o){const r=(0,g().uPN)(e),n=(0,g().tVx)(r);if(!n)return{result:e,skipCount:0};if(o+2>=t.length)return{result:e,skipCount:0};const a=t[o+1],i=t[o+2];if(!(0,g().bHQ)(a)||"."!==a[0]||!(0,g().qXl)(i))return{result:e,skipCount:0};const l=(0,g().uPN)(i),s=(0,g().TVE)(l);if(!s)return{result:e,skipCount:0};const u=(0,g().iVq)(n),c=(0,g().GCe)(s),p=(0,g().ESw)({contextValueId:u.id,property:c.property,name:c.name,valueSnapshot:"current"});return{result:(0,g().wmz)(p),skipCount:2}}function A(e){return/(?:[a-zA-Z_]\w*|\.\w+)\s*\(/.test(e)}function T(e){return e.replace(/\s*\+\s*(\.[\w]+\s*\()/g,"$1")}},813716:(e,t,o)=>{o.d(t,{p:()=>b});o(944114),o(898992),o(354520),o(672577),o(581454),o(737550);var r=o(296540),n=()=>o(564884),a=()=>o(484714),i=()=>o(79926),l=()=>o(390527),s=()=>o(898244),u=()=>o(206267),c=()=>o(69708),p=()=>o(534177),d=()=>o(813297),m=()=>o(384944),g=()=>o(637759),y=()=>o(862292),h=()=>o(547149),f=()=>o(324587),v=()=>o(366360),x=()=>o(76190);const S="all";function b(){const{automationStore:e,collectionStore:t,maybePersistedTransactionActions:o}=(0,v().k)(),{value:b}=(0,i().fJ)(d().QV.automationTypecheck),{value:k}=(0,i().fJ)(y().T.formulas),j=(0,a().v3)(),A=(0,c().tz)(),T=(0,x().n)(e),M=(0,r.useMemo)((()=>({automation_id:e.id,collection_id:t.id,builder_type:"modal"})),[e.id,t.id]),I=(0,r.useCallback)((()=>{var t;if(e.isTriggerType("recurrence"))return{currentPropertyTriggers:[],triggerOperator:S};const o=null===(t=e.getTrigger())||void 0===t?void 0:t.event.pagePropertiesEdited,r="some"===(null==o?void 0:o.type)&&o.some,n="all"===(null==o?void 0:o.type)&&o.all,a=(null==o?void 0:o.type)||"some";return r||n?{currentPropertyTriggers:r||n||[],triggerOperator:a}:{currentPropertyTriggers:[],triggerOperator:a}}),[e]),P=(0,r.useCallback)(((t,r=S)=>{let n=r||S;("none"===r||"any"===r&&t.length>0)&&(n=S),o.createAndCommit({userAction:"automations.removePropertyTrigger",perform:o=>{h().applyOperation({store:e,operation:{pointer:e.pointer,command:"update",path:["trigger","event"],args:{pagePropertiesEdited:0===t.length?{type:"none"}:{type:n,[n]:t}}},transaction:o})}})}),[e,o]),_=(0,r.useCallback)((t=>{const{currentPropertyTriggers:r}=I();o.createAndCommit({userAction:"automations.updatePropertyTriggerOperator",perform:o=>{h().applyOperation({store:e,operation:{pointer:e.pointer,command:"update",path:["trigger","event"],args:{pagePropertiesEdited:{type:t,[t]:r}}},transaction:o})}})}),[e,I,o]);return{addPropertyTrigger:(0,r.useCallback)((e=>{const{currentPropertyTriggers:o,triggerOperator:r}=I();P([...o,e],r);const a=t.getSchema()[e.property];(0,n().u)({environment:j,event:{eventName:"automation_trigger_create",eventProperties:{automation_trigger:{type:"property",condition:r,property_types:null!=a&&a.type?[a.type]:[],property_configs:(0,p().O9)(e.filter.operator)&&(0,p().O9)(null==a?void 0:a.type)?[{operator:e.filter.operator,type:null==a?void 0:a.type}]:[]},...M}}})}),[M,t,j,I,P]),updatePropertyTrigger:(0,r.useCallback)((e=>{const{anyOptionCheckState:o,propertyId:r,currentFilter:a,propertySchema:i}=e,{currentPropertyTriggers:l,triggerOperator:u}=I();P((()=>{switch(o){case"partial":return C(l,(e=>e.property===r),(e=>({...e,filter:a})),{property:r,filter:a});case!0:return C(l,(e=>e.property===r),(e=>({...e,filter:{operator:"changes_to_any"}})),{property:r,filter:{operator:"changes_to_any"}});case!1:return(0,s().sS)(i)?C(l,(e=>e.property===r),(e=>({...e,filter:a})),{property:r,filter:a}):l.filter((e=>e.property!==r))}})(),u);const c=t.getSchema()[r];(0,n().u)({environment:j,event:{eventName:"automation_trigger_create",eventProperties:{automation_trigger:{type:"property",condition:u,property_types:null!=c&&c.type?[c.type]:[],property_configs:(0,p().O9)(a.operator)&&(0,p().O9)(null==c?void 0:c.type)?[{operator:a.operator,type:null==c?void 0:c.type}]:[]},...M}}})}),[M,t,j,I,P]),removePropertyTrigger:(0,r.useCallback)((e=>{const{currentPropertyTriggers:o,triggerOperator:r}=I();P(o.filter((t=>t.property!==e)),r);const a=t.getSchema()[e],i=o.find((t=>t.property===e));(0,n().u)({environment:j,event:{eventName:"automation_trigger_delete",eventProperties:{automation_trigger:{type:"property",condition:r,property_types:null!=a&&a.type?[a.type]:[],property_configs:(0,p().O9)(i)&&(0,p().O9)(i.filter.operator)&&(0,p().O9)(null==a?void 0:a.type)?[{operator:i.filter.operator,type:null==a?void 0:a.type}]:[]},...M}}})}),[M,t,j,I,P]),addPageAddedTrigger:(0,r.useCallback)((()=>{o.createAndCommit({userAction:"automations.addPageAddedTrigger",perform:t=>{h().applyOperation({store:e,operation:{pointer:e.pointer,command:"update",path:["trigger","event"],args:{pagesAdded:!0}},transaction:t})}}),(0,n().u)({environment:j,event:{eventName:"automation_trigger_create",eventProperties:{automation_trigger:{type:"page"},...M}}})}),[M,e,j,o]),removePageAddedTrigger:(0,r.useCallback)((()=>{o.createAndCommit({userAction:"automations.removePageAddedTrigger",perform:t=>{h().applyOperation({store:e,operation:{pointer:e.pointer,command:"update",path:["trigger","event"],args:{pagesAdded:!1}},transaction:t})}}),(0,n().u)({environment:j,event:{eventName:"automation_trigger_delete",eventProperties:{automation_trigger:{type:"page"},...M}}})}),[M,e,j,o]),addAnyPropertyEditedTrigger:(0,r.useCallback)((()=>{o.createAndCommit({userAction:"automations.addAnyPagePropertyEditedTrigger",perform:t=>{h().applyOperation({store:e,operation:{pointer:e.pointer,command:"update",path:["trigger","event"],args:{pagePropertiesEdited:{type:"any"}}},transaction:t})}}),(0,n().u)({environment:j,event:{eventName:"automation_trigger_create",eventProperties:{automation_trigger:{type:"property",condition:"any"},...M}}})}),[M,e,j,o]),removeAnyPropertyEditedTrigger:(0,r.useCallback)((()=>{o.createAndCommit({userAction:"automations.removeAnyPropertyEditedTrigger",perform:t=>{h().applyOperation({store:e,operation:{path:["trigger","event"],args:{pagePropertiesEdited:{type:"none"}},pointer:e.pointer,command:"update"},transaction:t})}}),(0,n().u)({environment:j,event:{eventName:"automation_trigger_delete",eventProperties:{automation_trigger:{type:"property",condition:"any"},...M}}})}),[M,e,j,o]),updateTriggerOperator:_,addEmptyRecurrenceTrigger:(0,r.useCallback)((()=>{o.createAndCommit({userAction:"automations.addEmptyRecurrenceTrigger",perform:t=>{m().KY({transaction:t,store:e.getKeyStore("trigger"),value:{type:"recurrence",id:u().JW()}}),b&&k&&(0,f().clearInvalidVariables)({environment:j,automationStore:e,automationTypecheckModule:b,contextType:"recurrence",formulasModule:k,intl:A,isSubscribed:T,transaction:t,pageStore:void 0}),(0,n().u)({environment:j,event:{eventName:"automation_trigger_create",eventProperties:{automation_trigger:{type:"recurrence"},...M}}})}})}),[e,b,k,A,o,M,j,T]),changeRecurrenceSchedule:(0,r.useCallback)((t=>{o.createAndCommit({userAction:"automations.changeRecurrenceSchedule",perform:o=>{m().zv({store:e.getKeyStore("trigger"),data:{recurrence:t?(0,l().convertFromUnpersistedRecurrenceConfig)(t):void 0},transaction:o})}})}),[e,o]),removeRecurrenceTrigger:(0,r.useCallback)((()=>{o.createAndCommit({userAction:"automations.removeRecurrenceTrigger",perform:o=>{m().KY({transaction:o,store:e.getKeyStore("trigger"),value:{type:"event",id:u().JW(),event:(0,g().B0)(t)}})}}),(0,n().u)({environment:j,event:{eventName:"automation_trigger_delete",eventProperties:{automation_trigger:{type:"recurrence"},...M}}})}),[M,e,t,j,o])}}function C(e,t,o,r){let n=!1;const a=e.map((e=>t(e)?(n=!0,o(e)):e));return n||a.push(r),a}},821481:(e,t,o)=>{o.d(t,{D:()=>r});const r=(0,o(69708).YK)({back:{defaultMessage:"Back",id:"formulas.SimpleFormulaValuePicker.back"},valuesFromThisAutomation:{defaultMessage:"From this automation",id:"formulas.SimpleFormulaValuePicker.valuesFromThisAutomation"},pickADate:{defaultMessage:"Pick a date",id:"formulas.SimpleFormulaValuePicker.pickADate"},clear:{defaultMessage:"Clear",id:"formulas.SimpleFormulaValuePicker.clear"},unchecked:{defaultMessage:"Unchecked",id:"formulas.SimpleFormulaValuePicker.checkbox.unchecked"},checked:{defaultMessage:"Checked",id:"formulas.SimpleFormulaValuePicker.checkbox.checked"},checkboxOptions:{defaultMessage:"Checkbox options",id:"formulas.SimpleFormulaValuePicker.checkbox.sectionHeader"},searchPlaceHolder:{defaultMessage:"Select one or more optionsâ€¦",id:"formulas.SimpleFormulaValuePicker.select.searchPlaceholder"},selectOptionsSectionHeader:{defaultMessage:"Select an option",id:"formulas.SimpleFormulaValuePicker.select.sectionHeader"},noResults:{defaultMessage:"No results",id:"formulas.simpleValuePicker.noResults"},pageSearchPlaceholder:{defaultMessage:"Search for one or more pagesâ€¦",id:"formulas.SimpleFormulaValuePicker.pages.searchPlaceholder"},pages:{defaultMessage:"Pages",id:"formulas.SimpleFormulaValuePicker.pages.sectionHeader"},somethingWentWrong:{defaultMessage:"Something went wrong.",id:"formulas.simpleValuePicker.errorMessage"},personSelect:{defaultMessage:"Select...",id:"formulas.SimpleFormulaValuePicker.chooseAValue"},personSearchPlaceholder:{defaultMessage:"Search for one or more peopleâ€¦",id:"formulas.SimpleFormulaValuePicker.people.searchPlaceholder"},propertyValuePlaceholder:{defaultMessage:"Enter a value",id:"formulas.SimpleFormulaValuePicker.general.propertyValuePlaceholder"},customFormula:{defaultMessage:"Custom formula",id:"formulas.SimpleFormulaValuePicker.customFormula"},peopleInWorkspace:{defaultMessage:"People",id:"formulas.SimpleFormulaValuePicker.people.sectionHeader"},genericMenuHeader:{defaultMessage:"Set property to",id:"formulas.SimpleFormulaValuePicker.genericMenuHeader"}})},822961:(e,t,o)=>{o.d(t,{E:()=>k});var r=o(296540),n=()=>o(401497),a=()=>o(26697),i=()=>o(736847),l=()=>o(662149),s=()=>o(214388),u=()=>o(713998),c=()=>o(201980),p=()=>o(100622),d=()=>o(534177),m=()=>o(284371),g=(o(581454),()=>o(726637)),y=()=>o(81068),h=()=>o(942715),f=()=>o(69708),v=()=>o(153893),x=o(474848);function S({handleSelectOperator:e,selectedItem:t}){const o=(0,n().IS)((()=>({buttonStyle:{fontSize:g().A.isMobile?16:12,height:20,lineHeight:"unset",marginInlineEnd:0,paddingInlineStart:2,paddingInlineEnd:2,textTransform:"lowercase",color:g().A.isMobile?p().Tj.palette.gray[900]:p().Tj.palette.gray[500]}})),[]);return(0,x.jsx)(h().A,{style:{height:20},innerButtonStyle:o.buttonStyle,selectedTitle:(0,x.jsx)(f().sA,{...t.text}),renderMenuSections:t=>[{key:"selectTextOperator",render:e=>(0,x.jsx)(i().A,{...e}),items:Object.values(v().bK).map((o=>({key:o.value,action:()=>{e(o),t.close()},render:e=>(0,x.jsx)(y().A,{...e,title:(0,x.jsx)(f().sA,{...o.text})})})))}]})}var b=()=>o(403129),C=()=>o(714202);function k(e){const{menuStore:t,onClose:o,propertyChangedFilter:g,propertyId:y,propertySchema:h,shouldUseDefaultPropertyOperator:f,parentRecordStore:k,formulaTypecheckContextValues:j,onCommit:A}=e,T=(0,r.useMemo)((()=>{if(f)return(0,u().DY)(h.type)?"string_is":"changes_to_any"}),[h.type,f]),M=(0,r.useMemo)((()=>{if("changes_to_any"!==g.operator&&(0,l().Y)(g)&&"is_empty"!==g.operator)return(0,s().gc)(g)?g.value.value:void 0}),[g]),[I,P]=(0,r.useState)((()=>(0,v().mK)(T||g.operator))),[_,w]=(0,r.useState)(M),V=(0,r.useRef)(_),N=(0,r.useRef)(I),R=(0,r.useMemo)((()=>{if(_)return{type:"simple",value:c().x9d(_)}}),[_]),F=(0,r.useCallback)((e=>{const t=c().k4p(null==e?void 0:e.value).trim(),o=t||void 0;w(o),V.current=o}),[]),B=(0,r.useCallback)((e=>{P(e.value),N.current=e.value,v().bK[e.value].hasInput||(w(void 0),V.current=void 0)}),[]),O=(0,r.useCallback)((()=>{const e=V.current||_,t=N.current||I;let r="partial";"changes_to_any"===t?r=!0:"is_empty"===t&&(r=!1);const n=(0,d().O9)(e)?{operator:t,value:{type:"exact",value:e}}:{operator:r?"changes_to_any":"is_empty"};A({anyOptionCheckState:r,filter:n,propertyId:y,propertySchema:h}),o()}),[o,A,y,h,I,_]),E=v().bK[I],D=(0,n().IS)((()=>({header:{display:"grid",gridTemplateColumns:"auto auto",gridGap:"2px",alignItems:"center"},propertyName:{...m().RC,color:p().Tj.text.secondary}})),[]),{headerDiv:W}=(0,b().A)({currentSimpleFormulaValueTokens:[],disableEmojiCommands:!0,disableFormulas:!0,disableFormattingAndMentions:!0,disableMobileActionBar:!0,formulaTypecheckContextValues:j,onChange:F,onClose:O,parentRecordStore:k,value:R});return(0,x.jsx)(C().A,{type:"custom",triggerActionMenuStore:t,onDone:O,onClose:o,headerTitle:(0,x.jsxs)("div",{style:D.header,children:[(0,x.jsx)(a().m,{placement:"bottom",render:e=>(0,x.jsx)("div",{...e,style:D.propertyName,children:h.name}),renderTooltip:()=>h.name}),(0,x.jsx)(S,{selectedItem:E,handleSelectOperator:B})]}),subHeaderComponent:E.hasInput?(0,x.jsx)(i().A,{children:W}):void 0,customMenuProps:{leftOuterStyle:{flex:"unset"},rightOuterStyle:{flex:"unset"},titleOuterStyle:{flex:"unset"},topbarStyle:{justifyContent:"space-between"}}})}},835346:(e,t,o)=>{o.d(t,{$:()=>M});o(898992),o(354520),o(581454);var r=o(296540),n=()=>o(726637),a=()=>o(484714),i=()=>o(401497),l=()=>o(420802),s=()=>o(352321),u=()=>o(26697),c=()=>o(81068),p=()=>o(736847),d=()=>o(214388),m=()=>o(713998),g=()=>o(784892),y=()=>o(69708),h=()=>o(496603),f=()=>o(534177),v=()=>o(284371),x=()=>o(249947),S=()=>o(399762),b=()=>o(942715),C=()=>o(100622),k=()=>o(113952),j=o(474848);function A({handleSelectOperator:e,selectedItem:t,type:o}){const a=(0,i().IS)((()=>({buttonStyle:{fontSize:n().A.isMobile?16:12,height:20,lineHeight:"unset",marginInlineEnd:0,paddingInlineStart:2,paddingInlineEnd:2,textTransform:"lowercase",color:n().A.isMobile?C().Tj.palette.gray[900]:C().Tj.palette.gray[500]}})),[]),l=(0,r.useMemo)((()=>{const e="multi_select"===o,t="select"===o;return Object.values(k()._c).filter((o=>e?o.isMulti:t?o.isSingle:void 0))}),[o]);return(0,j.jsx)(b().A,{style:{height:20},innerButtonStyle:a.buttonStyle,selectedTitle:(0,j.jsx)(y().sA,{...t.text}),renderMenuSections:t=>[{key:"selectSelectOperator",render:e=>(0,j.jsx)(p().A,{...e}),items:l.map((o=>({key:o.value,action:()=>{e(o),t.close()},render:e=>(0,j.jsx)(c().A,{...e,title:(0,j.jsx)(y().sA,{...o.text})})})))}]})}var T=()=>o(714202);function M(e){const{menuStore:t,onClose:o,propertyChangedFilter:b,propertyId:C,propertySchema:M,shouldUseDefaultPropertyOperator:I,onCommit:P}=e,{isAndroid:_}=(0,a().Y0)(),w=(0,y().tz)(),V=(0,r.useMemo)((()=>{if(I)return"select"===M.type?"enum_is":"multi_select"===M.type?"enum_contains":"changes_to_any"}),[M.type,I]),N=(0,r.useMemo)((()=>{if("changes_to_any"===b.operator){return(M.options??[]).map((e=>({type:"exact",value:e.value})))}if(!(0,d().v0)(b)&&!(0,d().as)(b))return[];if((0,d().gc)(b)){const e=(M.options??[]).map((e=>e.value));return(Array.isArray(b.value)?b.value:[b.value]).filter((t=>(0,f().O9)(t.value)&&e.includes(t.value)))}return[]}),[M,b]),[R,F]=(0,r.useState)(N),[B,O]=(0,r.useState)((0,k().N6)(V||b.operator)),[E,D]=(0,r.useState)(""),W=k()._c[B],L=(0,r.useCallback)((e=>{O(e.value)}),[]),K=(0,r.useMemo)((()=>{const e=M.options??[];return"changes_to_any"===B||0!==e.length&&(0!==R.length&&(R.length===e.length||"partial"))}),[M.options,B,R]),H=(0,r.useMemo)((()=>(M.options??[]).map((e=>({type:"exact",value:e.value})))),[M]),z=(0,r.useMemo)((()=>!0===K?[]:R.map((e=>{if(!e.value||!M.options)return;const t=(0,m().jy)(M.options,e.value);return t?(0,j.jsx)(S().O,{format:n().A.isMobile?g().NY.Large:g().NY.Small,isSingle:!1,value:t.value,color:t.color,showRemoveButton:!0,onClickRemove:()=>{const t=h().FF(R,e);F(t)}},t.id):void 0})).filter(f().O9)),[K,M.options,R]),q=(0,r.useMemo)((()=>(0,x().r9)({query:E,propertySchema:M,selectedValues:R,updateValue:e=>{D(""),F(e)},isMobile:n().A.isMobile,styles:{},isFormEditorView:!1})),[M,E,R]),U=(0,r.useRef)((()=>{}));(0,r.useEffect)((()=>{U.current=()=>{let e,t="partial";if("changes_to_any"===B)t=!0,e={operator:"changes_to_any"};else if("is_empty"===B)t=!1,e={operator:"is_empty"};else{const o=Array.isArray(R)?R:[R];0===o.length?(t=!1,e={operator:"is_empty"}):e={operator:B,value:o}}P({anyOptionCheckState:t,propertyId:C,filter:e,propertySchema:M}),o()}}),[o,P,C,M,B,R]);const Y=(0,i().IS)((()=>({header:{display:"grid",gridTemplateColumns:"auto auto",gap:2,alignItems:"center"},propertyName:{...v().RC}})),[]),G=[{key:"search",items:[{key:"input",action:()=>{},render:e=>(0,j.jsx)("div",{style:{...!n().A.isMobile&&{paddingTop:0,paddingInlineEnd:8,paddingBottom:4,paddingInlineStart:8}},children:(0,j.jsx)(s().Ay,{...e,focusInitial:!0,onClick:void 0,focusAfterAnimation:!0,format:s().le.FilterValue,tokens:z,placeholder:K?w.formatMessage({defaultMessage:"Any option",id:"selectPropertyChangedFilter.inputPlaceholder.anyOption"}):w.formatMessage({defaultMessage:"Select one or more optionsâ€¦",id:"selectPropertyChangedFilter.inputPlaceholder.searchPlaceholder"}),onRemoveLastToken:()=>{const e=R.slice(0,R.length-1);F(e)},onClearButtonClick:()=>{F([])},value:E,onChange:e=>{D(e.target.value)},dontShowBorderBottom:_,showClearButton:!0})})}],render:e=>(0,j.jsx)(p().A,{...e})},{key:"any",items:[{key:"any-option-item",action:()=>{!0===K?F([]):!1===K||"partial"===K?F(H):(0,f().HB)(K),D("")},render:e=>(0,j.jsx)(c().A,{...e,icon:(0,j.jsx)(l().S,{checked:K,size:14,onClick:e.onClick}),title:(0,j.jsx)(y().sA,{id:"selectPropertyChangedFilter.anyOption.title",defaultMessage:"Any option"})})}],render:e=>(0,j.jsx)(p().A,{...e,topBorder:!0})},q.length>0?{key:"options",items:q,render:e=>(0,j.jsx)(p().A,{...e,topBorder:!0})}:void 0].filter((e=>(0,f().O9)(e)));return(0,j.jsx)(T().A,{type:"default",triggerActionMenuStore:t,onDone:()=>{U.current()},onClose:o,sections:W.hasInput?G:[],headerTitle:(0,j.jsxs)("div",{style:Y.header,children:[(0,j.jsx)(u().m,{placement:"bottom",render:e=>(0,j.jsx)("div",{...e,style:Y.propertyName,children:M.name}),renderTooltip:()=>M.name}),(0,j.jsx)(A,{handleSelectOperator:L,selectedItem:W,type:"multi_select"===M.type?"multi_select":"select"})]}),customMenuProps:{leftOuterStyle:{flex:"unset"},rightOuterStyle:{flex:"unset"},titleOuterStyle:{flex:"unset"},topbarStyle:{justifyContent:"space-between"}}})}},862314:(e,t,o)=>{o.d(t,{A:()=>k});o(944114),o(581454);var r=o(296540),n=()=>o(726637),a=()=>o(245720),i=()=>o(546926),l=()=>o(890492),s=()=>o(663639),u=()=>o(736847),c=()=>o(69708),p=(o(898992),o(354520),()=>o(401497)),d=()=>o(247331),m=()=>o(791089),g=()=>o(201980),y=()=>o(100622),h=()=>o(496603),f=()=>o(419357),v=()=>o(821481),x=()=>o(534674),S=o(474848);var b=()=>o(262509),C=()=>o(238259);function k(e){const{currentSimpleFormulaValueTokens:t,formulaTypecheckContextValues:o,menuProps:k,onChange:j,onClose:A,showGenericHeader:T=!1,value:M,parentRecordStore:I}=e,{footer:P,header:_,numberInput:w,valueItems:V}=function(e){const{currentSimpleFormulaValueTokens:t,formulaTypecheckContextValues:o,onChange:a,onClose:i,value:l}=e,s=(0,c().tz)(),u=(0,p().eP)(),b=(0,p().IS)((()=>({inputOuterStyle:{fontSize:"12px",...n().A.isMobile?{boxShadow:"none",background:"light"===u?y().Tj.white:y().Tj.selectLightGray[200],borderRadius:0,minHeight:"45px"}:{}}})),[u]),C=o.filter((e=>"number"===e.type.type)),k=(0,r.useCallback)((e=>{a({type:"simple",value:e})}),[a]),j=(0,r.useCallback)((e=>{k(e),i()}),[k,i]),A=(0,r.useCallback)((e=>{const t=e.target.value;let o;o=""===t?void 0:[[t]],k(o)}),[k]),T=(0,r.useCallback)((e=>{const t=void 0!==e[0]?(0,m().toSimpleFormulaSingleValue)(e[0]):void 0;j(t)}),[j]),M=h().oE(C.map((e=>{if(e.kind===d().FormulaContextValueKind.ContextValue)return{action:"replace",currentSimpleFormulaValueTokens:t,id:e.id||"",setCurrentTokens:T,value:e}}))),I=(0,r.useMemo)((()=>{const e=t[0],o="string"==typeof e?e:(0,g().q4_)(null==l?void 0:l.value);return(0,S.jsx)(f().Ay,{focusInitial:!n().A.isMobile,onChange:A,value:o,type:"number",inputOuterStyle:b.inputOuterStyle,placeholder:s.formatMessage(v().D.propertyValuePlaceholder)})}),[t,A,s,b.inputOuterStyle,null==l?void 0:l.value]);return{footer:(0,S.jsx)(x().A,{value:l,onChange:a}),header:s.formatMessage(v().D.genericMenuHeader),numberInput:I,valueItems:M}}({formulaTypecheckContextValues:o,onChange:j,onClose:A,currentSimpleFormulaValueTokens:t,value:M})||{},N=(0,r.useMemo)((()=>V.map((e=>{const{annotation:t,itemAction:r}=(0,C().E)({action:e.action,currentSimpleFormulaValueTokens:e.currentSimpleFormulaValueTokens,setCurrentTokens:e.setCurrentTokens,value:e.value});return{key:e.id,render:e=>(0,S.jsx)(b().A,{annotation:t,disabled:!1,formulaTypecheckContextValues:o,menuArgs:e,parentRecordStore:I}),action:r}}))),[o,V,I]),R=[];let F;N.length>0&&R.push({key:"textbox",render:e=>(0,S.jsx)(u().A,{...e}),items:N}),F=n().A.isMobile?{menuType:i().gu.Modal,minWidth:260,onClickRight:A,right:(0,S.jsx)(c().sA,{...a().W.done})}:{menuType:i().gu.Popup,maxHeight:"50vh",width:260,footer:P&&(0,S.jsx)(u().A,{topBorder:!0,children:P}),disableHeaderBorder:!0};const B=T&&(0,S.jsx)(u().A,{style:{paddingBottom:0},title:_}),O=(0,S.jsxs)("div",{children:[n().A.isMobile?void 0:(null==k?void 0:k.header)||B,w]}),E=(0,S.jsx)(s().A,{initialFocus:0,sections:R,type:s().O.Vertical});return{headerDiv:O,innerComponents:E,numberMenu:(0,S.jsx)(l().A,{...F,...k,header:O,children:E})}}},880264:(e,t,o)=>{o.d(t,{Mh:()=>S,Zr:()=>v});var r=o(296540),n=()=>o(590526),a=()=>o(401497),i=()=>o(250910),l=()=>o(118307),s=()=>o(765974),u=()=>o(69708),c=()=>o(100622),p=()=>o(284371),d=()=>o(656134),m=()=>o(813716),g=()=>o(541172),y=()=>o(997939),h=()=>o(897499),f=o(474848);function v(e){const{propertySchema:t}=e,{property:o}=(0,r.useContext)(h()._B),{removePropertyTrigger:g}=(0,m().p)(),v=(0,a().IS)((()=>({content:{...p().RC,color:c().Tj.red.text.accentPrimary,fontWeight:p().Wy.medium,whiteSpace:"normal"},icon:{fill:c().Tj.red.text.accentPrimary},propertyName:{color:c().Tj.palette.red[700],fontWeight:p().Wy.semibold,whiteSpace:"nowrap"}})),[]),S=(0,d().j)(),C=(0,n().uB)(void 0,l().A),k=(0,r.useCallback)((()=>C.reset()),[C]),j=(0,r.useCallback)((()=>{g(o)}),[o,g]),A=function(e){const{propertySchema:t,styles:o}=e;return(0,f.jsx)(u().sA,{defaultMessage:"{propertyName} property is a cross-workspace relation",id:"crossWorkspaceRelationPropertyTrigger.title",values:{propertyName:(0,f.jsx)("span",{style:o.propertyName,children:t.name})}})}({propertySchema:t,styles:v}),T=function(e){const{propertySchema:t}=e;return(0,f.jsx)(u().sA,{defaultMessage:"{propertyName} property is a cross-workspace relation. Cross-workspace features are restricted in automations and will not work.",id:"crossWorkspaceRelationPropertyTrigger.tooltip",values:{propertyName:b({maxLength:20,text:t.name})}})}({propertySchema:t});return(0,f.jsx)(i().A,{buttonPopupStore:C,popupType:S,render:()=>(0,f.jsx)(x,{closeMenu:k,propertyId:o}),renderOrigin:e=>(0,f.jsx)(y().X,{...e,icon:s().exclamationMarkTriangleFillIcon,onDelete:j,styles:v,tooltip:T,children:(0,f.jsx)("div",{style:v.content,children:A})})})}function x(e){const{closeMenu:t,propertyId:o}=e,{removePropertyTrigger:n}=(0,m().p)(),a=(0,r.useCallback)((()=>{n(o),null==t||t()}),[t,o,n]);return(0,f.jsx)(g().Ol,{onDelete:a,stepType:"trigger"})}function S(e){const{propertySchema:t}=e;return(0,f.jsx)(u().sA,{defaultMessage:"{propertyName} property is a cross-workspace relation",id:"crossWorkspaceRelationPropertyTrigger.title",values:{propertyName:t.name}})}function b(e){const{maxLength:t,text:o,truncateCharacter:r}=e,n=r??"â€¦",a=Array.from(o);return a.length<=t?o:`${a.slice(0,t-1).join("")}${n}`}},892591:(e,t,o)=>{o.d(t,{A:()=>ne});var r=o(296540),n=()=>o(590526),a=()=>o(534177),i=()=>o(286595),l=(o(898992),o(354520),o(672577),o(581454),o(737550),o.n(o(844751))),s=()=>o(135168),u=()=>o(726637),c=()=>o(484714),p=()=>o(401497),d=()=>o(792057),m=()=>o(807449),g=()=>o(890492),y=()=>o(81068),h=()=>o(663639),f=()=>o(736847),v=()=>o(422540),x=()=>o(898244),S=()=>o(852424),b=()=>o(187174),C=()=>o(105819),k=()=>o(617668),j=()=>o(340498),A=()=>o(69708),T=()=>o(100622),M=()=>o(496603),I=()=>o(637759),P=()=>o(419357),_=()=>o(991249),w=()=>o(527871),V=()=>o(366360),N=()=>o(781697),R=()=>o(813716),F=o(474848);const B=(0,A().YK)({searchInputPlaceholder:{id:"automationEventTriggerMenu.searchInputPlaceholder.label",defaultMessage:"Search triggersâ€¦"},pageAddedCopy:{id:"automationEventTriggerMenu.pageAdded.title",defaultMessage:"Page added"},pagePropertiesEditedCopy:{id:"automationEventTriggerMenu.anyPropertyEdited.title",defaultMessage:"Any property edited"},recurrenceCopy:{id:"automationEventTriggerMenu.recurrence.title",defaultMessage:"Everyâ€¦"}});function O(e){const{automationTriggerMenuStore:t,onClose:o}=e,{automationStore:i,collectionStore:s}=(0,V().k)(),_=(0,p().DP)(),w=(0,A().tz)(),O=(0,R().p)(),D=(0,r.useMemo)((()=>({...O,closeMenu:o})),[O,o]),[L,K]=r.useState(""),H=(0,n().K8)((()=>s.getSpaceId()),[s]),z=(0,n().K8)((()=>s.getSchema()),[s]),q=(0,n().K8)((()=>i.getTrigger()),[i]),U=(0,n().K8)((()=>"event"===(null==q?void 0:q.type)&&q.event.pagesAdded),[q]),Y=(0,n().K8)((()=>e=>{const t=e[1];return!(0,x().nC)(t)||!(0,x().o2)(H,t)}),[H]),G=(0,n().K8)((()=>(0,v().nv)({collectionFormat:s.getFormat(),collectionSchema:z,filter:Y})),[s,z,Y]),$=(0,I().iX)({collectionSchema:z,propertyIds:G,searchTerm:L}),Q=(0,n().K8)((()=>"event"===(null==q?void 0:q.type)&&(U||"none"!==q.event.pagePropertiesEdited.type)),[q,U]),J=(0,n().K8)((()=>({isDefined:i.isDefined(),model:i.isDefined()?i.getModel():void 0,actionModels:i.isDefined()?i.getActionStores().map((e=>e.getModel())).filter(a().O9):[],spaceId:i.getSpaceId(),store:i.isDefined()?i:void 0})),[i]),Z=(0,p().IS)((()=>({propertyIcon:{width:16,height:16,color:T().Tj.icon.secondary}})),[]),X=(0,N().e)({maxHeight:"50vh",width:266}),ee=(0,c().v3)(),te=(0,F.jsx)(f().A,{isInput:!0,children:(0,F.jsx)(P().Ay,{focus:!u().A.isMobile,value:L,onChange:e=>{K(e.target.value)},placeholder:w.formatMessage(B.searchInputPlaceholder)})}),[{value:oe}]=(0,b().Yb)((async()=>await async function(e){const{environment:t,intl:o,searchInput:r,hasPageAddedTrigger:n,hasAnyEventConditions:a,automationTriggerValue:i,automationStoreState:s,closeMenu:u,addAnyPropertyEditedTrigger:c,addPageAddedTrigger:p,addEmptyRecurrenceTrigger:g}=e,h=o.formatMessage(B.pageAddedCopy),v=o.formatMessage(B.recurrenceCopy),x=o.formatMessage(B.pagePropertiesEditedCopy),{hasAnyPageEditedTrigger:S,specificPropertyChangedFilters:b}=W(i),j=M().oE([S||!l().test(r,x)?void 0:{key:"any_property_edited",action:async()=>{const e=await async function(e){const{hasSpecificPropertyChangedFilters:t}=e;if(!t)return!0;return await d().Gh({message:(0,F.jsx)(A().sA,{id:"automations.eventTriggerMenu.replaceTriggerConfirmation.message",defaultMessage:"Replace other triggers?"}),description:(0,F.jsx)(A().sA,{id:"automations.eventTriggerMenu.replaceTriggerConfirmation.description",defaultMessage:"Adding the â€˜Any property editedâ€™ trigger will replace all other property triggers."}),acceptLabel:(0,F.jsx)(A().sA,{id:"automations.eventTriggerMenu.replaceTriggerConfirmation.acceptLabel",defaultMessage:"Replace"})}).then((e=>e.accept))}({hasSpecificPropertyChangedFilters:b.length>0});e&&(c(),u())},render:e=>(0,F.jsx)(y().A,{...e,icon:(0,F.jsx)(m().I,{icon:C().pencilLineIcon,colorVariant:"secondary"}),title:x})},!n&&l().test(r,h)?{key:"page_added",action(){p(),u()},render:e=>(0,F.jsx)(y().A,{...e,icon:(0,F.jsx)(m().I,{icon:k().plusIcon,colorVariant:"secondary"}),title:h})}:void 0,!a&&l().test(r,v)?await E({environment:t,automationStoreState:s,closeMenu:u,addEmptyRecurrenceTrigger:g}):void 0]);return j.length>0?{key:"event_section",items:j,render:e=>(0,F.jsx)(f().A,{...e,title:(0,F.jsx)(A().sA,{id:"automationEventTriggerMenu.eventSection.title",defaultMessage:"Event"})})}:void 0}({environment:ee,intl:w,searchInput:L,styles:Z,hasPageAddedTrigger:U,hasAnyEventConditions:Q,automationTriggerValue:q,automationStoreState:J,closeMenu:D.closeMenu,addAnyPropertyEditedTrigger:D.addAnyPropertyEditedTrigger,addPageAddedTrigger:D.addPageAddedTrigger,addEmptyRecurrenceTrigger:D.addEmptyRecurrenceTrigger})),[ee,w,L,Z,U,Q,q,J,D.closeMenu,D.addAnyPropertyEditedTrigger,D.addPageAddedTrigger,D.addEmptyRecurrenceTrigger]),re=(0,n().K8)((()=>function(e){const{automationTriggerValue:t,automationTriggerMenuStore:o,showTopBorder:r,properties:n,collectionSchema:i,theme:l,actions:s}=e,{specificPropertyChangedFilters:u}=W(t),c=n.map((e=>{if(!u.find((t=>t.property===e)))return function(e){const{automationTriggerMenuStore:t,propertyId:o,collectionSchema:r,theme:n,actions:a}=e,i=r[o];if(!i)return;const l=(0,v().nq)(i);return{key:o,action:()=>{l?t.pushSettingsItem({type:"propertyChangedFilter",property:o}):(a.addPropertyTrigger({property:o,filter:{operator:"changes_to_any"}}),a.closeMenu())},render:e=>(0,F.jsx)(y().A,{...e,icon:(0,F.jsx)(S().zB,{icon:i.icon,type:i.type,size:j().Ev.sm,theme:n,style:{overflow:"visible"}}),title:i.name,showExtensionArrow:l})}}({propertyId:e,collectionSchema:i,theme:l,automationTriggerMenuStore:o,actions:s})})).filter(a().O9);if(0===c.length)return;return{key:"property_section",items:c,render:e=>(0,F.jsx)(f().A,{...e,topBorder:r,title:(0,F.jsx)(A().sA,{id:"automationEventTriggerMenu.pagePropertiesEditedSection.title",defaultMessage:"Property"})})}}({automationTriggerValue:q,automationTriggerMenuStore:t,showTopBorder:Boolean(oe),properties:$,collectionSchema:z,theme:_,actions:D})),[q,t,oe,$,z,_,D]),ne=r.useMemo((()=>{const e=[oe,re].filter(a().O9);return 0===e.length?[{key:"none",items:[{key:"none-item",action:()=>{},render:e=>(0,F.jsx)(y().A,{...e,disabled:!0,disabledFeedback:!0,title:(0,F.jsx)(A().sA,{id:"automations.eventTriggerMenu.noResultsItem",defaultMessage:"No results"})})}],render:e=>(0,F.jsx)(f().A,{...e})}]:e}),[oe,re]);return(0,F.jsx)(g().A,{...X,header:te,children:(0,F.jsx)(h().A,{type:h().O.Vertical,sections:ne,initialFocus:0})})}async function E(e){const{environment:t,automationStoreState:o,closeMenu:r,addEmptyRecurrenceTrigger:n}=e,a=await(0,w().V)({environment:t,automationStore:o.store,triggerType:"recurrence",spaceId:o.spaceId});return{key:"recurrence",action(){a?n():_().K(t,{upsell:{type:"product",product:"plus",limit:{type:"none"},trialability:"none"},from:"recurrence_automation",spaceStore:(0,s().f)(o.store)}),r()},render:e=>(0,F.jsx)(D,{...e,automationStoreState:o})}}const D=r.forwardRef((function(e,t){var r;const{automationStoreState:a,...i}=e,l=(0,p().IS)((()=>({wrap:{display:"flex",alignItems:"center",gap:6},upsellWrap:{marginInlineStart:6}})),[]),s=(0,c().v3)(),u=(0,b().Yb)((async()=>await(0,w().V)({environment:s,automationStore:a.store,triggerType:"recurrence",spaceId:a.spaceId})),[a.store,s,a.spaceId]),{spaceId:d,userId:g}=(0,n().K8)((()=>{var e;return{spaceId:a.spaceId,userId:null===(e=o(907258).default.state.currentUserStore)||void 0===e?void 0:e.id}}),[a]),h=null===(r=(0,o(528093)._)({name:"premium_automations",spaceId:d,userId:g}))||void 0===r?void 0:r.upsell;return(0,F.jsx)(y().A,{...i,ref:t,icon:(0,F.jsx)(m().I,{icon:o(443191).J,colorVariant:"secondary"}),title:(0,F.jsxs)("div",{style:l.wrap,children:[(0,F.jsx)(A().sA,{...B.recurrenceCopy}),u?(0,F.jsx)(o(147294).Ee,{newBadgeKey:"generalized_recurrence_automations",didUserEngage:!1,keyType:"date"}):h?(0,F.jsx)("div",{style:l.upsellWrap,children:(0,F.jsx)(o(112698).B,{upsell:h,analyticsName:"recurrence_automation"})}):null]})})}));function W(e){let t=!1,o=[];return"event"===(null==e?void 0:e.type)&&(t="any"===e.event.pagePropertiesEdited.type,t||("some"===e.event.pagePropertiesEdited.type?o=e.event.pagePropertiesEdited.some||[]:"all"===e.event.pagePropertiesEdited.type&&(o=e.event.pagePropertiesEdited.all||[]))),{hasAnyPageEditedTrigger:t,specificPropertyChangedFilters:o}}var L=()=>o(609281);function K(e){const{propertyId:t,automationTriggerMenuStore:o,propertySchema:n,propertyChangedFilter:a,onClose:i}=e,{updatePropertyTrigger:l}=(0,R().p)(),s=(0,r.useCallback)((e=>{l({anyOptionCheckState:e.anyOptionCheckState,propertyId:e.propertyId,currentFilter:e.filter})}),[l]);return(0,F.jsx)(L().Y,{propertyId:t,menuStore:o,propertySchema:n,propertyChangedFilter:a,onCommit:s,onClose:i})}var H=()=>o(310109),z=()=>o(947589),q=()=>o(546461);function U(e){const{automationTriggerMenuStore:t,onClose:o,propertyChangedFilter:n,propertySchema:a,propertyId:i,shouldUseDefaultPropertyOperator:l}=e,{updatePropertyTrigger:s}=(0,R().p)(),{typecheckResult:u,automationStore:c}=(0,q().q8)(),p=(0,r.useMemo)((()=>(0,H().getAllContextValues)(u)),[u]),d=(0,r.useCallback)((e=>{s({anyOptionCheckState:e.anyOptionCheckState,propertyId:e.propertyId,currentFilter:e.filter,propertySchema:e.propertySchema})}),[s]);return(0,F.jsx)(z().Q,{menuStore:t,onClose:o,onCommit:d,parentRecordStore:c,propertyChangedFilter:n,propertyId:i,propertySchema:a,shouldUseDefaultPropertyOperator:l,formulaTypecheckContextValues:p})}var Y=()=>o(23986);function G(e){const{automationTriggerMenuStore:t,collectionStore:o,onClose:n,propertyChangedFilter:a,propertySchema:i,propertyId:l,shouldUseDefaultPropertyOperator:s}=e,{updatePropertyTrigger:u}=(0,R().p)(),{automationStore:c,typecheckResult:p}=(0,q().q8)(),d=(0,r.useMemo)((()=>(0,H().getAllContextValues)(p)),[p]),m=(0,r.useCallback)((e=>{u({anyOptionCheckState:e.anyOptionCheckState,propertyId:e.propertyId,currentFilter:e.filter,propertySchema:i})}),[i,u]);return(0,F.jsx)(Y().y,{collectionStore:o,formulaTypecheckContextValues:d,menuStore:t,onClose:n,onCommit:m,parentRecordStore:c,propertyChangedFilter:a,propertyId:l,propertySchema:i,shouldUseDefaultPropertyOperator:s})}var $=()=>o(542550);function Q(e){const{automationTriggerMenuStore:t,collectionStore:o,onClose:n,propertyChangedFilter:a,propertySchema:i,propertyId:l,shouldUseDefaultPropertyOperator:s}=e,{updatePropertyTrigger:u}=(0,R().p)(),{automationStore:c,typecheckResult:p}=(0,q().q8)(),d=(0,r.useMemo)((()=>(0,H().getAllContextValues)(p)),[p]),m=(0,r.useCallback)((e=>{u({anyOptionCheckState:e.anyOptionCheckState,propertyId:e.propertyId,currentFilter:e.filter,propertySchema:i})}),[i,u]);return(0,F.jsx)($().R,{collectionStore:o,formulaTypecheckContextValues:d,menuStore:t,onClose:n,onCommit:m,parentRecordStore:c,propertyChangedFilter:a,propertyId:l,propertySchema:i,shouldUseDefaultPropertyOperator:s})}var J=()=>o(835346);function Z(e){const{automationTriggerMenuStore:t,onClose:o,propertyChangedFilter:n,propertyId:a,propertySchema:i,shouldUseDefaultPropertyOperator:l}=e,{updatePropertyTrigger:s}=(0,R().p)(),u=(0,r.useCallback)((e=>{s({anyOptionCheckState:e.anyOptionCheckState,propertyId:e.propertyId,currentFilter:e.filter,propertySchema:e.propertySchema})}),[s]);return(0,F.jsx)(J().$,{menuStore:t,onClose:o,onCommit:u,propertyChangedFilter:n,propertyId:a,propertySchema:i,shouldUseDefaultPropertyOperator:l})}var X=()=>o(89240);function ee(e){const{propertyId:t,automationTriggerMenuStore:o,propertySchema:n,propertyChangedFilter:a,onClose:i}=e,{updatePropertyTrigger:l}=(0,R().p)(),s=(0,r.useCallback)((e=>{l({anyOptionCheckState:e.anyOptionCheckState,propertyId:e.propertyId,currentFilter:e.filter,propertySchema:e.propertySchema})}),[l]);return(0,F.jsx)(X().r,{propertyId:t,menuStore:o,propertySchema:n,propertyChangedFilter:a,onCommit:s,onClose:i})}var te=()=>o(822961);function oe(e){const{automationTriggerMenuStore:t,onClose:o,propertyChangedFilter:n,propertySchema:a,propertyId:i,shouldUseDefaultPropertyOperator:l}=e,{updatePropertyTrigger:s}=(0,R().p)(),{automationStore:u,typecheckResult:c}=(0,q().q8)(),p=(0,r.useMemo)((()=>(0,H().getAllContextValues)(c)),[c]),d=(0,r.useCallback)((e=>{s({anyOptionCheckState:e.anyOptionCheckState,propertyId:e.propertyId,currentFilter:e.filter,propertySchema:e.propertySchema})}),[s]);return(0,F.jsx)(te().E,{menuStore:t,onClose:o,onCommit:d,parentRecordStore:u,propertyChangedFilter:n,propertyId:i,propertySchema:a,shouldUseDefaultPropertyOperator:l,formulaTypecheckContextValues:p})}function re(e){const{propertyId:t,automationTriggerMenuStore:o,onClose:r}=e,{automationStore:i,collectionStore:l}=(0,V().k)(),s=(0,n().K8)((()=>l.getSchema()),[l])[t],u=(0,n().K8)((()=>i.getTrigger()),[i]);let c=[];"event"===(null==u?void 0:u.type)&&("some"===u.event.pagePropertiesEdited.type?c=u.event.pagePropertiesEdited.some||[]:"all"===u.event.pagePropertiesEdited.type&&(c=u.event.pagePropertiesEdited.all||[]));const p=c.find((e=>e.property===t)),d=p??{property:t,filter:{operator:"changes_to_any"}};if(!s)return null;if(!(0,v().nq)(s))return null;const m=!(0,a().O9)(p);return"multi_select"===s.type||"select"===s.type?(0,F.jsx)(Z,{automationTriggerMenuStore:o,onClose:r,propertyChangedFilter:d.filter,propertyId:t,propertySchema:s,shouldUseDefaultPropertyOperator:m}):"status"===s.type?(0,F.jsx)(ee,{propertyId:t,automationTriggerMenuStore:o,propertySchema:s,propertyChangedFilter:d.filter,onClose:r}):"checkbox"===s.type?(0,F.jsx)(K,{automationTriggerMenuStore:o,onClose:r,propertyChangedFilter:d.filter,propertyId:t,propertySchema:s}):"person"===s.type?(0,F.jsx)(G,{automationTriggerMenuStore:o,collectionStore:l,onClose:r,propertyChangedFilter:d.filter,propertyId:t,propertySchema:s,shouldUseDefaultPropertyOperator:m}):"number"===s.type?(0,F.jsx)(U,{automationTriggerMenuStore:o,onClose:r,propertyChangedFilter:d.filter,propertyId:t,propertySchema:s,shouldUseDefaultPropertyOperator:m}):"email"===s.type||"phone_number"===s.type||"text"===s.type||"title"===s.type||"url"===s.type?(0,F.jsx)(oe,{automationTriggerMenuStore:o,onClose:r,propertyChangedFilter:d.filter,propertyId:t,propertySchema:s,shouldUseDefaultPropertyOperator:m}):"relation"===s.type?(0,F.jsx)(Q,{automationTriggerMenuStore:o,collectionStore:l,onClose:r,propertyChangedFilter:d.filter,propertyId:t,propertySchema:s,shouldUseDefaultPropertyOperator:m}):null}function ne(e){const{initialState:t,buttonPopupParent:o}=e,l=(0,n().K8)((()=>{const e=new(i().A);return e.setState({stack:[t]}),e}),[t]),s=(0,n().K8)((()=>l.getCurrentTab()),[l]),u=(0,r.useCallback)((()=>o.close()),[o]);return s?"eventTriggers"===s.type?(0,F.jsx)(O,{automationTriggerMenuStore:l,onClose:u}):"propertyChangedFilter"===s.type?(0,F.jsx)(re,{propertyId:s.property,automationTriggerMenuStore:l,onClose:u}):(0,a().HB)(s):null}},897499:(e,t,o)=>{o.d(t,{Js:()=>xe,_B:()=>ve,CD:()=>Se});o(898992),o(354520),o(581454),o(737550);var r=o(296540),n=()=>o(590526),a=()=>o(546461),i=()=>o(5269),l=()=>o(401497),s=()=>o(523389),u=()=>o(69708),c=()=>o(284371),p=()=>o(214973),d=()=>o(813716),m=()=>o(997939),g=o(474848);function y(){const{removeAnyPropertyEditedTrigger:e}=(0,d().p)(),t=(0,u().tz)(),o=(0,l().IS)((()=>({title:{fontWeight:c().Wy.medium}})),[]),r=p().HG(t);return(0,g.jsx)(m().X,{icon:s().pencilLineSmallIcon,onDelete:e,tooltip:r,children:(0,g.jsx)("div",{style:o.title,children:r})})}var h=()=>o(422540),f=()=>o(343462),v=()=>o(478367),x=()=>o(662149),S=()=>o(214388),b=()=>o(898244),C=()=>o(423892),k=()=>o(366360),j=()=>o(250910),A=()=>o(656134),T=()=>o(892591);function M(e){const{renderOrigin:t,property:o}=e,r=(0,A().j)();return(0,g.jsx)(j().A,{popupType:r,renderOrigin:t,render:e=>(0,g.jsx)(T().A,{initialState:{type:"propertyChangedFilter",property:o},buttonPopupParent:e})})}var I=()=>o(383688),P=()=>o(880264),_=()=>o(36697),w=()=>o(989064);function V({propertySchema:e,onClick:t}){return(0,g.jsx)(w().z,{onClick:t,icon:t=>(0,g.jsx)(_().P,{propertySchema:e,style:t}),tooltip:(0,g.jsx)(R,{propertyName:e.name}),children:(0,g.jsx)(N,{propertyName:e.name})})}function N({propertyName:e}){const t=(0,u().tz)(),o=(0,l().IS)((()=>({propertyName:{...c().RC,fontWeight:c().Wy.medium},wrap:{alignItems:"center",display:"flex",whiteSpace:"pre"}})),[]),r=p().yR(t,{propertyName:(0,g.jsx)("span",{style:o.propertyName,children:e})});return(0,g.jsx)("span",{style:o.wrap,children:r})}function R({propertyName:e}){const t=(0,u().tz)();return(0,g.jsx)(g.Fragment,{children:p().yR(t,{propertyName:e})})}function F({propertySchema:e,onClick:t}){return(0,g.jsx)(w().z,{onClick:t,icon:t=>(0,g.jsx)(_().P,{propertySchema:e,style:t}),tooltip:(0,g.jsx)(O,{propertyName:e.name}),children:(0,g.jsx)(B,{propertyName:e.name})})}function B({propertyName:e}){const t=(0,u().tz)(),o=(0,l().IS)((()=>({propertyName:{...c().RC,fontWeight:c().Wy.medium},wrap:{alignItems:"center",display:"flex",whiteSpace:"pre"}})),[]),r=p().Od(t,{propertyName:(0,g.jsx)("span",{style:o.propertyName,children:e})});return(0,g.jsx)("span",{style:o.wrap,children:r})}function O({propertyName:e}){const t=(0,u().tz)();return(0,g.jsx)(g.Fragment,{children:p().Od(t,{propertyName:e})})}var E=()=>o(798941);function D(e){const{filter:t,propertySchema:o,onClick:r}=e,{title:n,tooltipTitle:a,styles:i}=(0,E().aR)({numberValue:t.value.value,operator:t.operator,propertySchema:o,messageType:"trigger"});return(0,g.jsx)(w().z,{onClick:r,tooltip:(0,g.jsx)("span",{children:a}),children:(0,g.jsx)("div",{style:i.content,children:n})})}var W=()=>o(112588),L=()=>o(118307),K=()=>o(852424),H=()=>o(765974),z=()=>o(100622),q=()=>o(534177),U=()=>o(984714),Y=()=>o(630550);function G(e){const{deletedPropertySchema:t}=e,o=null==t?void 0:t.type,{property:a}=(0,r.useContext)(ve),{removePropertyTrigger:i}=(0,d().p)(),s=(0,l().IS)((()=>({content:{color:z().Tj.red.text.accentPrimary,fontWeight:c().Wy.regular,whiteSpace:"normal"},icon:{fill:z().Tj.red.text.accentPrimary},iconWrap:{background:z().Tj.red.background.secondaryTranslucent,borderRadius:4},propertyType:{color:z().Tj.palette.red[700]}})),[]),u=(0,A().j)(),p=(0,n().uB)(void 0,L().A),y=(0,r.useCallback)((()=>p.reset()),[p]),h=(0,r.useCallback)((()=>{i(a)}),[a,i]),f=(0,q().O9)(t)?(0,U().AJ)({propertySchema:t}):(0,U().Xl)(),v=(0,q().O9)(t)?(0,U().CH)():(0,U().Xl)();return(0,g.jsx)(j().A,{buttonPopupStore:p,popupType:u,render:()=>(0,g.jsx)(Y().c,{closeMenu:y,propertyId:a}),renderOrigin:e=>(0,g.jsx)(m().X,{...e,icon:(0,q().O9)(o)?K().LE[o]:H().exclamationMarkTriangleFillIcon,onDelete:h,styles:s,tooltip:v,children:(0,g.jsx)("div",{style:s.content,children:f})})})}var $=()=>o(133518),Q=()=>o(457050);function J(e){const{filter:t,propertySchema:o,onClick:r}=e,a=(0,$().F)(),{collectionStore:i}=(0,k().k)(),l=(0,n().K8)((()=>i.getSpaceId()),[i]),s=(0,n().K8)((()=>(0,b().o2)(l,o)),[o,l]),u=(0,n().K8)((()=>(0,Q().WE)({collectionStore:i,filter:t}).value),[i,t]),{title:c,tooltipTitle:p,styles:d}=(0,Q().xL)({automationContextValues:a,filter:t,collectionStore:i,operator:t.operator,propertySchema:o,messageType:"trigger",value:u});return s?(0,g.jsx)(P().Zr,{propertySchema:o}):(0,g.jsx)(w().z,{onClick:r,tooltip:(0,g.jsx)("span",{children:p}),children:(0,g.jsx)("div",{style:d.content,children:c})})}var Z=()=>o(477329),X=()=>o(27511),ee=()=>o(967823);function te(e){const{filter:t,propertySchema:o,onClick:r}=e,{title:n,tooltipTitle:a,styles:i}=(0,ee().w5)({textValue:t.value.value,operator:t.operator,propertySchema:o,messageType:"trigger"});return(0,g.jsx)(w().z,{onClick:r,tooltip:(0,g.jsx)("span",{children:a}),children:(0,g.jsx)("div",{style:i.content,children:n})})}var oe=()=>o(680288),re=()=>o(807449),ne=()=>o(890492),ae=()=>o(81068),ie=()=>o(663639),le=()=>o(736847),se=()=>o(236262),ue=()=>o(781697);function ce(e){const{closeMenu:t,propertyId:o}=e,{removePropertyTrigger:n}=(0,d().p)(),a=(0,r.useCallback)((()=>{n(o),null==t||t()}),[t,o,n]),i=(0,ue().e)({width:266}),l=(0,r.useMemo)((()=>({action:a,key:"delete-property-menu-item",render:e=>(0,g.jsx)(ae().A,{...e,icon:(0,g.jsx)(re().I,{icon:se().trashIcon}),title:(0,g.jsx)(u().sA,{id:"automationUnsupportedOperatorMenu.deleteTrigger.title",defaultMessage:"Delete trigger"})})})),[a]);return(0,g.jsx)(ne().A,{...i,children:(0,g.jsx)(ie().A,{initialFocus:0,sections:[{key:"actions-section",items:[l],render:e=>(0,g.jsx)(le().A,{...e})}],type:ie().O.Vertical})})}function pe({filter:e,propertySchema:t}){const o=(0,u().tz)(),{property:a}=(0,r.useContext)(ve),{removePropertyTrigger:i}=(0,d().p)(),s=(0,l().IS)((()=>({content:{color:z().Tj.red.text.accentPrimary,fontWeight:c().Wy.regular,whiteSpace:"normal"},icon:{fill:z().Tj.red.text.accentPrimary},iconWrap:{background:z().Tj.red.background.secondaryTranslucent,borderRadius:4},propertyType:{color:z().Tj.palette.red[700]}})),[]),p=(0,A().j)(),y=(0,n().uB)(void 0,L().A),h=(0,r.useCallback)((()=>y.reset()),[y]),f=(0,r.useCallback)((()=>{i(a)}),[a,i]),v=function(e){const{propertySchema:t}=e,o=t.type,r=t.name||oe().dC[o];return(0,g.jsx)(u().sA,{defaultMessage:"â€œ{propertyTypeDisplayName}â€ property type is incompatible with this step",id:"updateThisPageUnsupportedOperatorAction.updatedUnsupportedOperator.title",values:{propertyTypeDisplayName:r}})}({propertySchema:t,styles:s}),x=function(e){const{filter:t,intl:o}=e,r=C().LN[t.operator],n=(C().lD[r]||[]).map((e=>oe().dC[e])),a=o.formatList(n,{style:"long",type:"disjunction"});return(0,g.jsx)(u().sA,{defaultMessage:"Remove step or restore property to a valid type: {propertiesSupportedList}",id:"updateThisPageUnsupportedOperatorAction.unsupportedOperator.titleList",values:{propertiesSupportedList:a}})}({intl:o,filter:e}),S=t.type;return(0,g.jsx)(j().A,{buttonPopupStore:y,popupType:p,render:()=>(0,g.jsx)(ce,{closeMenu:h,propertyId:a}),renderOrigin:e=>(0,g.jsx)(m().X,{...e,icon:(0,q().O9)(S)?K().LE[S]:H().exclamationMarkTriangleFillIcon,onDelete:f,styles:s,tooltip:x,children:(0,g.jsx)("div",{style:s.content,children:v})})})}var de=()=>o(217028),me=()=>o(541172);function ge({propertySchema:e}){const{property:t}=(0,r.useContext)(ve),{removePropertyTrigger:o}=(0,d().p)(),a=(0,l().IS)((()=>({content:{color:z().Tj.red.text.accentPrimary,fontWeight:c().Wy.regular,whiteSpace:"normal"},icon:{fill:z().Tj.red.text.accentPrimary},iconWrap:{background:z().Tj.red.background.secondaryTranslucent,borderRadius:4},propertyType:{color:z().Tj.palette.red[700]}})),[]),i=(0,A().j)(),s=(0,n().uB)(void 0,L().A),u=(0,r.useCallback)((()=>s.reset()),[s]),p=(0,r.useCallback)((()=>{o(t)}),[t,o]),y=(0,de().m9)({propertySchema:e}),h=(0,de().cn)(),f=e.type;return(0,g.jsx)(j().A,{buttonPopupStore:s,popupType:i,render:()=>(0,g.jsx)(me().A5,{closeMenu:u,propertyId:t}),renderOrigin:e=>(0,g.jsx)(m().X,{...e,icon:(0,q().O9)(f)?K().LE[f]:H().exclamationMarkTriangleFillIcon,onDelete:p,styles:a,tooltip:h,children:(0,g.jsx)("div",{style:a.content,children:y})})})}function ye(e){const{collectionStore:t}=(0,k().k)(),{property:o,filter:r}=e,[a,i]=(0,n().K8)((()=>{var e,r;return[null===(e=t.getSchema())||void 0===e?void 0:e[o],null===(r=t.getDeletedSchema())||void 0===r?void 0:r[o]]}),[t,o]);if(!a)return(0,g.jsx)(G,{deletedPropertySchema:i});if(!(0,h().$0)(a))return(0,g.jsx)(ge,{propertySchema:a});const l=C().W[a.type]||a.type;return"changes_to_any"!==r.operator&&"is_empty"!==r.operator&&r.operator&&C().LN[r.operator]!==l?(0,g.jsx)(pe,{propertySchema:a,filter:r}):(0,h().nq)(a)?(0,g.jsx)(fe,{property:o,propertySchema:a,filter:r}):(0,g.jsx)(F,{propertySchema:a})}function he(e){const{filter:t,onClick:o,propertySchema:r}=e,{collectionStore:a}=(0,k().k)(),i=(0,n().K8)((()=>(0,b().nC)(r)&&(0,b().o2)(a.getSpaceId(),r)),[a,r]);return(0,b().nC)(r)&&i?(0,g.jsx)(P().Zr,{propertySchema:r}):"is_empty"===t.operator?(0,g.jsx)(V,{...e,propertySchema:r}):"changes_to_any"!==t.operator&&(0,S().gc)(t)?"checkbox"===r.type&&(0,S().Ui)(t)?(0,g.jsx)(I().ZZ,{filter:t,onClick:o,propertySchema:r}):"status"===r.type&&(0,S().H$)(t)?(0,g.jsx)(X().y,{filter:t,onClick:o,propertySchema:r}):"select"===r.type&&(0,S().v0)(t)||"multi_select"===r.type&&(0,S().as)(t)?(0,g.jsx)(Z().Ww,{filter:t,onClick:o,propertySchema:r}):"person"===r.type&&(0,v().I)(t)?(0,g.jsx)(W().h,{filter:t,onClick:o,propertySchema:r}):"number"===r.type&&(0,f().M)(t)?(0,g.jsx)(D,{filter:t,onClick:o,propertySchema:r}):"email"!==r.type&&"phone_number"!==r.type&&"text"!==r.type&&"title"!==r.type&&"url"!==r.type||!(0,x().Y)(t)?"relation"===r.type&&(0,S().Pq)(t)?(0,g.jsx)(J,{filter:t,onClick:o,propertySchema:r}):(0,g.jsx)(F,{onClick:o,propertySchema:r}):(0,g.jsx)(te,{filter:t,onClick:o,propertySchema:r}):(0,g.jsx)(F,{onClick:o,propertySchema:r})}function fe(e){const{filter:t,propertySchema:o,property:n}=e,a=(0,r.useCallback)((e=>(0,g.jsx)(he,{filter:t,onClick:e.onClick,propertySchema:o})),[t,o]);return(0,g.jsx)(M,{renderOrigin:a,property:n})}const ve=(0,r.createContext)({pagePropertiesEdited:[],property:""});function xe(){const{automationStore:e,contextType:t}=(0,a().q8)(),o=(0,i().y)(e,t),r=Se(e),l=(0,n().K8)((()=>{var t;if(!e||!e.isTriggerType("event"))return;const o=null===(t=e.getEventConfiguration())||void 0===t?void 0:t.pagePropertiesEdited;return"none"===(null==o?void 0:o.type)?void 0:o}),[e]),s=(0,n().K8)((()=>null==o?void 0:o.getSchema()),[o]);if(!r||!l)return null;if("any"===l.type)return(0,g.jsx)(y,{});if(!s)return null;let u=[];return"all"===l.type?u=l.all??[]:"some"===l.type&&(u=l.some??[]),u?(0,g.jsx)(g.Fragment,{children:u.map((({property:e,filter:t})=>(0,g.jsx)(ve.Provider,{value:{property:e,pagePropertiesEdited:u},children:(0,g.jsx)(ye,{property:e,filter:t})},e)))}):null}function Se(e){return(0,n().K8)((()=>{if(null==e||!e.isTriggerType("event"))return!1;const t=e.getEventConfiguration(),o=Boolean("none"!==(null==t?void 0:t.pagePropertiesEdited.type)),r=Boolean("all"===(null==t?void 0:t.pagePropertiesEdited.type)&&Boolean(null==t?void 0:t.pagePropertiesEdited.all)),n=Boolean("some"===(null==t?void 0:t.pagePropertiesEdited.type)&&Boolean(null==t?void 0:t.pagePropertiesEdited.some)),a=Boolean("any"===(null==t?void 0:t.pagePropertiesEdited.type));return o&&(r||n||a)}),[e])}ve.displayName="PropertyEditedTriggerContext"},923832:(e,t,o)=>{o.d(t,{aX:()=>Ce,OT:()=>ke,qt:()=>Te,h3:()=>Ae,ot:()=>be});var r=o.n(o(32485)),n=o(296540),a=()=>o(726637),i=()=>o(819121),l=()=>o(588316),s=()=>o(590526),u=()=>o(401497),c=()=>o(79926),p=()=>o(172489),d=()=>o(718827),m=()=>o(923744),g=()=>o(680474),y=()=>o(118307),h=()=>o(26697),f=()=>o(352271),v=()=>o(558842),x=()=>o(69708),S=()=>o(100622),b=()=>o(115512),C=()=>o(554283),k=()=>o(546461),j=()=>o(117862);function A(e){const{automationStore:t}=(0,k().q8)();return(0,s().K8)((()=>{var o;if(!e)return;const r=null===(o=t.getModel())||void 0===o?void 0:o.getLastFailedReason();return r&&r.actionId===e?r:void 0}),[t,e])}var T=()=>o(366360),M=()=>o(973647),I=()=>o(653417),P=o(474848);function _({actionId:e}){const{typecheckResult:t}=(0,k().q8)(),{suppressActionErrors:o}=(0,T().b)(),r=(0,s().K8)((()=>{if(M().Q.isSuccess(t)&&!o.includes(e)){return(t.value.actionValidationFailures[e]||[]).length>0}return!1}),[e,o,t]);return{hasTypecheckErrors:r,typecheckErrorMessage:r?(0,P.jsx)(x().sA,{...I().automationErrorMessages.generalErrorMessage}):null}}o(898992),o(354520),o(581454);var w=()=>o(534177);function V({disabled:e}){const{automationStore:t}=(0,k().q8)(),{hideDragHandle:o}=(0,T().b)(),r=(0,s().K8)((()=>t.getActionStores().map((e=>e.isDefined()&&e.hasConcern("display")?e:null)).filter(w().Pe)),[t]);return o||1===r.length||e}o(18107),o(967357);var N=()=>o(493552);function R(e){const{actionId:t}=e,{warnings:o,errors:r}=function(e){const{typecheckResult:t}=(0,k().q8)();return(0,s().K8)((()=>e&&t?M().Q.isFail(t)?{errors:void 0,warnings:void 0}:{errors:t.value.actionValidationFailures[e],warnings:t.value.actionValidationWarnings[e]}:{errors:void 0,warnings:void 0}),[t,e])}(t),n=null==r?void 0:r.at(0);if(n){const e=(0,I().getErrorMessagesForActionValidationFailure)({failure:n});return(0,P.jsx)(N().D,{colorPalette:"red",colorVariant:"secondary",styleKey:"captionRegular",children:(0,P.jsx)(x().sA,{...e.forAction})})}const a=null==o?void 0:o.at(0);if(a){const e=(0,I().getErrorMessagesForActionValidationFailure)({failure:a});return(0,P.jsx)(N().D,{colorPalette:"yellow",colorVariant:"secondary",styleKey:"captionRegular",children:(0,P.jsx)(x().sA,{...e.forAction})})}return null}var F=()=>o(699143),B=()=>o(265060),O=()=>o(340498);const E=(0,O().xh)("xMarkCircle",{default:{loader:()=>o.e(59028).then(o.bind(o,378409))},small:{loader:()=>o.e(59028).then(o.bind(o,904691))},fill:{loader:()=>o.e(59028).then(o.bind(o,637433))},fillSmall:{loader:()=>o.e(59028).then(o.bind(o,126912))}},["close","cross","delete","remove","cancel"]),D=(0,x().YK)({heading:{id:"automations.errorBanner.heading",defaultMessage:"An error occurred while running this action"}});function W(e){const{children:t}=e,o=(0,x().tz)(),r=(0,u().IS)((()=>({container:{backgroundColor:S().Tj.red.background.secondary,padding:"8px 12px"},iconContainer:{height:20,width:20,display:"flex",alignItems:"center",justifyContent:"center"},content:{color:S().Tj.red.text.secondary}})),[]);return(0,P.jsx)("div",{style:r.container,children:(0,P.jsxs)(F().Y1,{gap:8,direction:"horizontal",children:[(0,P.jsx)("div",{style:r.iconContainer,children:(0,P.jsx)(B().Q,{iconGroup:E,variantName:"small",colorPalette:"red",colorVariant:"secondary"})}),(0,P.jsxs)(F().Y1,{gap:4,direction:"vertical",style:r.content,children:[(0,P.jsx)(N().D,{styleKey:"bodyBold",children:o.formatMessage(D.heading)}),t?(0,P.jsx)(N().D,{styleKey:"bodyMedium",children:t}):void 0]})]})})}const L=(0,x().YK)({errorMessage:{id:"automations.externalHttpRequestFailedError.message",defaultMessage:"Received {errorCode} error from {host}"}});function K(e){const{failureReason:t}=e,o=(0,x().tz)();return(0,P.jsx)(W,{children:o.formatMessage(L.errorMessage,{host:t.host,errorCode:t.errorCode})})}var H=()=>o(300474),z=()=>o(920198),q=()=>o(484714),U=()=>o(732810),Y=()=>o(784892),G=()=>o(201980),$=()=>o(881690),Q=()=>o(712030),J=()=>o(29554);const Z=(0,x().YK)({errorMessageWithDetails:{id:"automations.formulaExecutionError.messageWithDetails",defaultMessage:"Could not evaluate formula property {propertyName} for the page {pageMention} in {databaseMention}"},errorMessageFallback:{id:"automations.formulaExecutionError.messageFallback",defaultMessage:"Could not evaluate a formula in this action"},unknown:{id:"automations.formulaExecutionError.unknown",defaultMessage:"Unknown"},unknownProperty:{id:"automations.formulaExecutionError.unknownProperty",defaultMessage:"Unknown property"}});function X(e){const{failureReason:t}=e,o=t.errorSource;return(0,P.jsx)(W,{children:o?(0,P.jsx)(ne,{errorSource:o}):(0,P.jsx)(x().sA,{...Z.errorMessageFallback})})}function ee(e){const{annotation:t,disabled:o=!1}=e,r=(0,x().tz)(),n=(0,q().v3)(),a=(0,u().DP)(),i=(0,z().L)(),l=(0,s().K8)((()=>{if(!t||!i)return(0,P.jsx)($().A,{format:Y().NY.Inline,value:r.formatMessage(Z.unknown),isSingle:!0,backgroundColor:S().Tj.red.background.tertiary,color:S().Tj.red.text.secondary});const e={value:[(0,G().Ey_)(" ",[t])],spaceId:i.id};return(0,J().S5)({disabled:o,disableDateStyleAnnotations:!1,disableHover:!1,disableLinks:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableSuggestionAnnotations:!1,emojiType:(0,Q().FN)(n),environment:n,formulaValueTypes:[],katex:n.KatexStore.getKatex(),parentStore:i,textValue:e,theme:a})}),[t,o,n,a,r,i]);return(0,P.jsx)("span",{children:l})}function te(e){const{blockId:t}=e,o=(0,H().r)(),r=t?(0,G().ld4)(t,o):void 0;return(0,P.jsx)(ee,{annotation:r})}function oe(e){const{collectionId:t}=e,o=(0,H().r)(),r=t?(0,G().ETy)({collectionId:t,spaceId:o,parentCvbId:void 0}):void 0;return(0,P.jsx)(ee,{annotation:r})}function re(e){const{propertyId:t,propertyName:o,collectionId:r}=e,n=(0,H().r)(),a=t&&r?(0,G().ESw)({property:t,collection:{table:"collection",id:r,spaceId:n},name:o}):void 0;return(0,P.jsx)(ee,{annotation:a,disabled:!0})}function ne(e){const{errorSource:t}=e,o=(0,x().tz)(),r=(0,z().L)(),n=(0,s().K8)((()=>r?U().m.createChildStore(r,{id:t.collectionId,table:"collection"}):null),[t,r]),a=(0,s().K8)((()=>{if(n){const e=n.getSchema()[t.propertyId];return null!=e&&e.name?e.name:t.propertyId}return o.formatMessage(Z.unknownProperty)}),[t,n,o]);return t?(0,P.jsx)(x().sA,{...Z.errorMessageWithDetails,values:{propertyName:(0,P.jsx)(re,{propertyId:t.propertyId,propertyName:a,collectionId:t.collectionId}),pageMention:(0,P.jsx)(te,{blockId:t.blockId}),databaseMention:(0,P.jsx)(oe,{collectionId:t.collectionId})}}):null}function ae(e){const{failureReason:t}=e;switch(t.type){case"external_http_request_failed":return(0,P.jsx)(K,{failureReason:t});case"formula_execution_error":return(0,P.jsx)(X,{failureReason:t});case"unknown":return(0,P.jsx)(W,{});default:return null}}var ie=()=>o(127833),le=()=>o(250910),se=()=>o(695115),ue=()=>o(126617);const ce={viewBox:"0 0 20 20",fittedViewBox:"2.37 1.09 15.25 17.81",svg:(0,P.jsx)("path",{d:"m10.6 5.241 1.458-1.458a.625.625 0 1 1 .884.884l-2.5 2.5a.625.625 0 0 1-.884 0l-2.5-2.5a.625.625 0 0 1 .884-.884L9.35 5.191V1.72a.625.625 0 1 1 1.25 0zM2.375 10c0 1.036.84 1.875 1.875 1.875h11.5a1.875 1.875 0 0 0 0-3.75H4.25c-1.036 0-1.875.84-1.875 1.875m1.875-.625h11.5a.625.625 0 1 1 0 1.25H4.25a.625.625 0 0 1 0-1.25m5.308 3.458a.625.625 0 0 1 .884 0l2.5 2.5a.625.625 0 1 1-.884.884l-1.408-1.408v3.466a.625.625 0 1 1-1.25 0v-3.516l-1.458 1.458a.625.625 0 1 1-.884-.884z"})},pe=(0,O().wt)("rectangleCompressVertical",ce,"default"),de={viewBox:"0 0 20 20",fittedViewBox:"2.37 1.09 15.25 17.81",svg:(0,P.jsx)("path",{d:"M10.442 1.278a.625.625 0 0 0-.884 0l-2.5 2.5a.625.625 0 1 0 .884.884L9.4 3.204v3.52a.625.625 0 0 0 1.25 0v-3.47l1.408 1.408a.625.625 0 1 0 .884-.884zM9.35 13.275v3.466l-1.408-1.408a.625.625 0 1 0-.884.884l2.5 2.5c.244.244.64.244.884 0l2.5-2.5a.625.625 0 0 0-.884-.884L10.6 16.791v-3.516a.625.625 0 1 0-1.25 0M4.5 6.125H8v1.25H4.5a.875.875 0 0 0-.875.875v3.5c0 .483.392.875.875.875H8v1.25H4.5a2.125 2.125 0 0 1-2.125-2.125v-3.5c0-1.174.951-2.125 2.125-2.125m11 6.5H12v1.25h3.5a2.125 2.125 0 0 0 2.125-2.125v-3.5A2.125 2.125 0 0 0 15.5 6.125H12v1.25h3.5c.483 0 .875.392.875.875v3.5a.875.875 0 0 1-.875.875"})},me=(0,O().wt)("rectangleExpandVertical",de,"default"),ge=(0,x().YK)({moreLabel:{id:"automationBaseStepElement.moreActionsMenu.title",defaultMessage:"More"},collapseLabel:{id:"automationBaseStepElement.moreActionsMenu.collapseLabel",defaultMessage:"Collapse"},expandLabel:{id:"automationBaseStepElement.moreActionsMenu.expandLabel",defaultMessage:"Expand"}});function ye(e){const{actionMenu:t,disabled:o,buttonPopupStore:r}=e,n=(0,x().tz)(),i=(0,u().eP)(),l=(0,u().IS)((()=>({container:{display:"flex",gap:1,padding:2,borderRadius:6,boxShadow:`0px 0px 0px 1px ${S().Tj.border.secondary}, 0px 2px 4px 0px rgba(0, 0, 0, ${"dark"===i?.08:.04})`,backgroundColor:S().Tj.background.elevated},iconButton:{height:24,width:24,flexShrink:0,borderRadius:4},moreIcon:{height:O().Ev.sm,width:O().Ev.sm},collapseToggleIcon:{height:O().Ev.default,width:O().Ev.default}})),[i]);return(0,P.jsxs)("div",{style:l.container,children:[e.collapsible?(0,P.jsx)(h().m,{renderTooltip:()=>(0,P.jsx)(x().sA,{...he(e.isCollapsed)}),render:t=>(0,P.jsx)(se().A,{...t,ariaLabel:n.formatMessage(he(e.isCollapsed)),disabled:o,disabledFeedback:o,hasBackground:!0,icon:e.isCollapsed?me:pe,iconStyle:l.collapseToggleIcon,style:l.iconButton,onClick:e.onCollapseToggled})}):void 0,(0,P.jsx)(le().A,{alignmentToOrigin:"center",buttonPopupStore:r,originGap:0,placementToOrigin:"bottom",popupType:a().A.isMobile?ie().nl.SlideUp:ie().nl.Popup,render:()=>t,renderOrigin:e=>(0,P.jsx)(se().A,{...e,ariaLabel:n.formatMessage(ge.moreLabel),disabled:o,disabledFeedback:o,hasBackground:!0,icon:ue().ellipsisSmallIcon,iconStyle:l.moreIcon,style:l.iconButton})})]})}function he(e){return e?ge.expandLabel:ge.collapseLabel}const fe="automation-list-item-base-step",ve="automation-list-item-base-step--drag-disabled",xe="automation-list-item-icon",Se="automation-list-item-drag-handle";function be(e){const{actionMenu:t,buttonPopupStore:o,children:r,disabled:i,icon:u,onClick:c,onMouseDown:p,onMouseEnter:d,onMouseLeave:m,subtitle:g,styles:h}=e,f=(0,s().uB)(o,y().A),[x,S]=(0,l().A)(),[b,k]=(0,C().B)(),j=(0,s().K8)((()=>f.getState().open),[f]),A=!i&&(a().A.isMobile||k||S||j),T=Ie({disabled:i,hasActionMenu:Boolean(t),isActionMenuVisible:A,overrideStyles:h}),M=(0,v().Px)(x,b),I=(0,n.useMemo)((()=>({...T.componentWrap,...T.border})),[T.border,T.componentWrap]);return(0,P.jsxs)("div",{className:fe,onClick:c,onMouseDown:p,onMouseEnter:d,onMouseLeave:m,ref:M,style:I,children:[(0,P.jsxs)("div",{style:T.headerWrap,children:[u?(0,P.jsx)("div",{"aria-hidden":"true",style:T.iconContainer,children:(0,P.jsx)("div",{style:T.iconWrap,children:u(T.icon)})}):void 0,(0,P.jsxs)("div",{style:T.titleAndSubtitleWrap,children:[(0,P.jsx)("div",{style:T.titleWrap,children:r}),g]})]}),t?(0,P.jsx)("div",{style:T.actionMenuWrap,children:(0,P.jsx)(ye,{actionMenu:t,buttonPopupStore:f,disabled:i})}):void 0]})}function Ce(e){const{actionId:t,actionMenu:o,buttonPopupStore:c,children:g,disabled:h,icon:f,onBlur:x,onClick:S,onFocus:b,onMouseDown:j,onMouseEnter:T,onMouseLeave:M,styles:I,subtitle:_,hideDragHandle:w}=e,[N,F]=(0,i().A)(),[B,O]=(0,l().A)(),[E,D]=(0,C().B)(),W=(0,s().uB)(c,y().A),L=(0,s().K8)((()=>W.getState().open),[W]),K=(0,v().Px)(E,B),H=!h&&(a().A.isMobile||D||F||O||L);(0,n.useEffect)((()=>{function e(e){e.state.open||(0,p().k)()}return W.addListener(e),()=>{W.removeListener(e)}}),[W]);const z=Ie({disabled:h,hasActionMenu:Boolean(o),isActionMenuVisible:H,overrideStyles:I}),q=(0,u().IS)((()=>({buttonAndActionMenuWrap:{position:"relative"}})),[]),U=V({disabled:h}),Y=Boolean(w||U),{tooltipMessage:G,ariaLabel:$}=Me(),Q=A(t),{automationStore:J}=(0,k().q8)(),Z=(0,s().K8)((()=>null==J?void 0:J.getStatus()),[J]),X=Q&&"active"!==Z;return(0,P.jsxs)("div",{className:r()(fe,{[ve]:h||a().A.isMobile||Y}),ref:K,style:z.buttonWrap,children:[X?(0,P.jsx)(ae,{failureReason:Q}):void 0,(0,P.jsxs)("div",{style:q.buttonAndActionMenuWrap,children:[(0,P.jsx)(d().Ay,{disabled:h,disabledFeedback:h,ignoreLocalHoverState:!0,ignoreLocalPressedState:!0,onBlur:x,onClick:S,onFocus:b,onMouseDown:j,onMouseEnter:T,onMouseLeave:M,ref:N,style:z.componentWrap,children:(0,P.jsxs)("div",{style:z.headerWrap,children:[f?(0,P.jsxs)("div",{"aria-hidden":"true",style:z.iconContainer,children:[(0,P.jsx)("div",{className:xe,style:z.iconWrap,children:f(z.icon)}),Y?void 0:(0,P.jsx)("div",{className:Se,style:z.iconWrap,children:(0,P.jsx)(m().j,{width:20,height:20,hideClickMessage:!0,dragTooltipMessage:G,"aria-label":$})})]}):void 0,(0,P.jsxs)("div",{style:z.titleAndSubtitleWrap,children:[(0,P.jsx)("div",{style:z.titleWrap,children:g}),_,t?(0,P.jsx)(R,{actionId:t}):void 0]})]})}),o?(0,P.jsx)("div",{style:z.actionMenuWrap,children:(0,P.jsx)(ye,{actionMenu:o,buttonPopupStore:W,disabled:h})}):void 0]})]})}function ke(e){return(0,P.jsx)(Ve,{actionId:e.actionId,canCollapse:e.canCollapse,children:(0,P.jsx)(je,{...e})})}function je(e){const{actionId:t,actionMenu:o,banner:i,buttonPopupStore:u,children:c,disabled:d,forceShowActionMenu:m,onMouseEnter:g,onMouseLeave:h,styles:f,hideDragHandle:x}=e,{hasTypecheckErrors:S}=_({actionId:t}),b=V({disabled:d}),j=Boolean(x||b),M=A(t),{automationStore:I}=(0,k().q8)(),w=(0,s().K8)((()=>null==I?void 0:I.getStatus()),[I]),N=M&&"active"!==w,[R,F]=(0,l().A)(),[B,O]=(0,C().B)(),E=(0,s().uB)(u,y().A),D=(0,s().K8)((()=>E.getState().open),[E]),{currentDraggingActionId:W}=(0,T().b)(),{isCollapsed:L,canCollapse:K,toggleCollapsed:H}=we(),z=(0,v().Px)(B,R),q=!d&&(m||a().A.isMobile||O||F||D);(0,n.useEffect)((()=>{function e(e){e.state.open||(0,p().k)()}return E.addListener(e),()=>{E.removeListener(e)}}),[E]);const U=Ie({disabled:d,hasActionMenu:Boolean(o),isActionMenuVisible:q,overrideStyles:f}),Y=(0,n.useMemo)((()=>({...U.buttonWrap,...W&&!j?{cursor:"grabbing"}:{}})),[W,U.buttonWrap,j]);return(0,P.jsxs)("div",{className:r()(fe,{[ve]:d||a().A.isMobile||j||S}),onMouseEnter:g,onMouseLeave:h,ref:z,style:Y,children:[N?(0,P.jsx)(ae,{failureReason:M}):void 0,i,(0,P.jsxs)("div",{style:U.componentWrap,children:[o?(0,P.jsx)("div",{style:U.actionMenuWrap,children:(0,P.jsx)(ye,{actionMenu:o,buttonPopupStore:E,disabled:d,...K?{collapsible:!0,isCollapsed:L,onCollapseToggled:H}:{collapsible:!1}})}):void 0,c]})]})}function Ae(e){const{actionId:t,actionRegistryItem:o,children:r,disabled:a,errorMessage:i,onMouseEnter:l,onMouseLeave:s,styles:u}=e,{typecheckErrorMessage:c}=_({actionId:t}),p=i||c,d=V({disabled:a}),g=Boolean(p||d),{tooltipMessage:y,ariaLabel:v}=Me(),{canCollapse:x,toggleCollapsed:S}=we(),b=Ie({disabled:a,hasActionMenu:!1,isActionMenuVisible:!1,overrideStyles:{...u,...x?{headerWrap:{cursor:"pointer"}}:{}}}),C=(0,n.useCallback)((()=>{!a&&x&&S()}),[x,a,S]),k=(0,f().qe)(o)?o.display:void 0;return(0,P.jsx)(h().m,{disableTooltip:!p,renderTooltip:()=>p,render:e=>(0,P.jsxs)("header",{onClick:C,onMouseEnter:l,onMouseLeave:s,...e,onFocus:e=>e.stopPropagation(),style:b.headerWrap,role:"button",children:[k?(0,P.jsxs)("div",{"aria-hidden":"true",style:b.iconContainer,children:[(0,P.jsx)("div",{className:xe,style:b.iconWrap,children:(0,P.jsx)(Pe,{display:k,isError:Boolean(p),hasSideEffects:o.hasNewReversableEffect})}),g?void 0:(0,P.jsx)("div",{className:Se,style:b.iconWrap,children:(0,P.jsx)(m().j,{width:20,height:20,hideClickMessage:!0,dragTooltipMessage:y,"aria-label":v})})]}):void 0,(0,P.jsx)("div",{style:b.titleWrap,children:r})]}),placement:"bottom",delayThreshold:0})}function Te(e){const{children:t,disabled:o,styles:r}=e,{isCollapsed:a}=we(),{value:i}=(0,c().fJ)(g().fM),l=Ie({disabled:o,hasActionMenu:!1,isActionMenuVisible:!1,overrideStyles:r}),[s,u]=(0,n.useState)(!1);if((0,n.useEffect)((()=>{u(!0)}),[a]),!i)return null;const{AnimatePresence:p,motion:d}=i;return(0,P.jsx)(p,{children:a?void 0:(0,P.jsxs)(d.div,{style:{display:"flex",flexDirection:"column"},initial:!!s&&{height:0},animate:{height:"auto"},exit:{height:0},children:[(0,P.jsx)("div",{style:l.collapsedDivider}),(0,P.jsx)("div",{style:l.bodyWrap,children:t})]})})}function Me(){const e=(0,x().tz)(),t=(0,j().m)();if(void 0===t)return{tooltipMessage:void 0,ariaLabel:void 0};return{tooltipMessage:(0,P.jsx)(x().sA,{defaultMessage:"Drag <medium>to move step {stepNumber}</medium>",id:"automations.dragHandle.dragToMoveStep.tooltip",values:{stepNumber:t,medium:e=>(0,P.jsx)("span",{style:{color:S().Tj.text.inverseSecondary},children:e})}}),ariaLabel:e.formatMessage({id:"automations.dragHandle.dragToMoveStep.ariaLabel",defaultMessage:"Drag to move step {stepNumber}"},{stepNumber:t})}}function Ie(e){const{disabled:t,hasActionMenu:o,isActionMenuVisible:r,overrideStyles:n}=e,a=(0,u().eP)();return(0,u().IS)((()=>({border:{border:"unset",boxShadow:`0px 0px 0px 1px ${S().Tj.border.secondary}, 0px 2px 4px 0px rgba(0, 0, 0, ${"dark"===a?.08:.04})`},buttonWrap:{background:S().Tj.background.elevated,border:"unset",boxShadow:`0px 0px 0px 1px ${S().Tj.border.secondary}, 0px 2px 4px 0px rgba(0, 0, 0, ${"dark"===a?.08:.04})`,overflow:"hidden",position:"relative",...null==n?void 0:n.buttonWrap},componentWrap:{background:S().Tj.background.elevated,display:"flex",flexDirection:"column",paddingInline:12,paddingBlock:12,position:"relative",overflow:"hidden",...t?{cursor:"default",pointerEvents:"none"}:{},...null==n?void 0:n.componentWrap},headerWrap:{display:"flex",flexDirection:"row",gap:8,marginInlineEnd:o?64:0,...t?{opacity:.4}:{},...null==n?void 0:n.headerWrap},iconContainer:{width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",position:"relative",flexShrink:0},iconWrap:{display:"flex",justifyContent:"center",alignItems:"center",width:20,height:20,...null==n?void 0:n.iconWrap},icon:{fill:S().Tj.text.secondary,height:"100%",width:16,...null==n?void 0:n.icon},titleWrap:{display:"flex",alignItems:"start",flex:"1 1 auto",fontSize:14,lineHeight:"20px",minWidth:0,whiteSpace:"pre",flexWrap:"wrap",...null==n?void 0:n.titleWrap},titleAndSubtitleWrap:{display:"flex",flexDirection:"column",gap:4,...null==n?void 0:n.titleAndSubtitleWrap},bodyWrap:{fontSize:14,marginBlockStart:12,marginBlockEnd:2,marginInline:2,marginTop:22,...null==n?void 0:n.bodyWrap},collapsedDivider:{borderTop:`1px solid ${S().Tj.border.secondary}`,insetInlineStart:0,marginTop:12,position:"absolute",width:"100%"},actionMenuWrap:{flex:"0 0 auto",height:26,position:"absolute",insetInlineEnd:8,top:8,zIndex:2,...r?{}:b().Qg}})),[12,t,o,r,n,a])}function Pe(e){const{display:t,hasSideEffects:o,isError:r}=e,n=(0,u().IS)((()=>({iconWrap:{width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,background:r?S().Tj.red.background.secondaryTranslucent:o?S().Tj.blue.background.secondaryTranslucent:S().Tj.background.tertiaryTranslucent,flexShrink:0},icon:{width:14,height:14,fill:r?S().Tj.red.icon.accentPrimary:o?S().Tj.blue.icon.accentPrimary:S().Tj.icon.secondary,margin:"0 auto"}})),[o,r]);return(0,P.jsx)("div",{style:n.iconWrap,children:t.icon(n.icon)})}const _e=(0,n.createContext)({canCollapse:!1,isCollapsed:!1,toggleCollapsed:()=>{}});function we(){return(0,n.useContext)(_e)}function Ve(e){const{actionId:t,children:o,canCollapse:r}=e,{collapsedActionIds:a,toggleActionIdCollapsed:i}=(0,T().b)(),l=(0,n.useMemo)((()=>a.includes(t)),[t,a]),s=(0,n.useCallback)((()=>{i(t)}),[t,i]);return(0,P.jsx)(_e.Provider,{value:{canCollapse:r,isCollapsed:l,toggleCollapsed:s},children:o})}_e.displayName="BaseStepElementCollapseContext"},947589:(e,t,o)=>{o.d(t,{Q:()=>k});var r=o(296540),n=()=>o(401497),a=()=>o(26697),i=()=>o(736847),l=()=>o(335997),s=()=>o(343462),u=()=>o(302322),c=()=>o(214388),p=()=>o(100622),d=()=>o(534177),m=()=>o(284371),g=(o(581454),()=>o(726637)),y=()=>o(81068),h=()=>o(942715),f=()=>o(69708),v=()=>o(749311),x=o(474848);function S({handleSelectOperator:e,selectedItem:t}){const o=(0,n().IS)((()=>({buttonStyle:{fontSize:g().A.isMobile?16:12,height:20,lineHeight:"unset",marginInlineEnd:0,paddingInlineStart:2,paddingInlineEnd:2,textTransform:"lowercase",color:g().A.isMobile?p().Tj.palette.gray[900]:p().Tj.palette.gray[500]}})),[]);return(0,x.jsx)(h().A,{style:{height:20},innerButtonStyle:o.buttonStyle,selectedTitle:(0,x.jsx)(f().sA,{...t.text}),renderMenuSections:t=>[{key:"selectNumberOperator",render:e=>(0,x.jsx)(i().A,{...e}),items:Object.values(v().$R).map((o=>({key:o.value,action:()=>{e(o),t.close()},render:e=>(0,x.jsx)(y().A,{...e,title:(0,x.jsx)(f().sA,{...o.text})})})))}]})}var b=()=>o(862314),C=()=>o(714202);function k(e){const{menuStore:t,onClose:o,propertyChangedFilter:g,propertyId:y,propertySchema:h,shouldUseDefaultPropertyOperator:f,parentRecordStore:k,formulaTypecheckContextValues:j,onCommit:A}=e,T=(0,r.useMemo)((()=>{if(f)return"number"===h.type?"number_equals":"changes_to_any"}),[h.type,f]),M=(0,r.useMemo)((()=>{if("changes_to_any"!==g.operator&&(0,s().M)(g)&&"is_empty"!==g.operator)return(0,c().gc)(g)?g.value.value:void 0}),[g]),[I,P]=(0,r.useState)((0,v().Qy)(T||g.operator)),[_,w]=(0,r.useState)(M),V=(0,r.useRef)(_),N=(0,r.useRef)(I),R=(0,r.useMemo)((()=>{if((0,d().O9)(_))return{type:"simple",value:(0,l().h)(_)}}),[_]),F=(0,r.useCallback)((e=>{const t=(0,u().M)(null==e?void 0:e.value);w(t),V.current=t}),[]),B=(0,r.useCallback)((e=>{P(e.value),N.current=e.value,v().$R[e.value].hasInput||(w(void 0),V.current=void 0)}),[]),O=(0,r.useCallback)((()=>{const e=V.current??_,t=N.current??I,r=(0,d().O9)(e)?{operator:t,value:{type:"exact",value:e}}:{operator:"is_empty"};let n="partial";"changes_to_any"===t?n=!0:"is_empty"===t&&(n=!1),A({anyOptionCheckState:n,filter:r,propertyId:y,propertySchema:h}),o()}),[I,_,o,A,y,h]),E=v().$R[I],D=(0,n().IS)((()=>({header:{display:"grid",gridTemplateColumns:"auto auto",gridGap:"4px",alignItems:"center"},propertyName:{...m().RC,color:p().Tj.text.primary}})),[]),{headerDiv:W}=(0,b().A)({currentSimpleFormulaValueTokens:[],formulaTypecheckContextValues:j,onChange:F,onClose:O,value:R,parentRecordStore:k});return(0,x.jsx)(C().A,{type:"custom",triggerActionMenuStore:t,onDone:O,onClose:o,headerTitle:(0,x.jsxs)("div",{style:D.header,children:[(0,x.jsx)(a().m,{placement:"bottom",render:e=>(0,x.jsx)("div",{...e,style:D.propertyName,children:h.name}),renderTooltip:()=>h.name}),(0,x.jsx)(S,{selectedItem:E,handleSelectOperator:B})]}),subHeaderComponent:E.hasInput?(0,x.jsx)(i().A,{children:W}):void 0,customMenuProps:{leftOuterStyle:{flex:"unset"},rightOuterStyle:{flex:"unset"},titleOuterStyle:{flex:"unset"},topbarStyle:{justifyContent:"space-between"}}})}},967823:(e,t,o)=>{o.d(t,{w5:()=>m,zl:()=>g});o(296540);var r=()=>o(590526),n=()=>o(401497),a=()=>o(784892),i=()=>o(69708),l=()=>o(534177),s=()=>o(284371),u=()=>o(881690),c=()=>o(153893),p=()=>o(214973),d=o(474848);function m(e){const{textValue:t,operator:o,propertySchema:m,messageType:y}=e,h=(0,i().tz)(),f=(0,n().IS)((()=>({content:{alignItems:"center",display:"flex",flexWrap:"wrap",whiteSpace:"pre",lineHeight:1.6},propertyName:{...s().RC,fontWeight:s().Wy.medium},propertyValue:{...s().RC,paddingBlockStart:4}})),[]),v=(0,r().K8)((()=>function(e){const{textValue:t,operator:o,propertySchema:r,styles:n,messageType:s,intl:m}=e,g=(0,d.jsx)("span",{style:n.propertyName,children:r.name});let y;const h=m.formatMessage(c().bK[o].text).toLocaleLowerCase();"action"===s?y=p().$B({operator:h,propertyName:g,propertyValues:(0,d.jsx)(u().A,{format:a().NY.Medium,isRound:!0,isSingle:!0,value:t,showRemoveButton:!1})}):"trigger"===s?y=p().rh({operator:h,propertyName:g,propertyValues:(0,d.jsx)(u().A,{format:a().NY.Medium,isRound:!0,isSingle:!0,value:t,showRemoveButton:!1})}):(0,l().HB)(s);return(0,d.jsx)(i().sA,{...y})}({messageType:y,operator:o,propertySchema:m,styles:f,textValue:t,intl:h})),[y,t,o,m,f,h]);return{tooltipTitle:(0,r().K8)((()=>g({messageType:y,operator:o,propertySchema:m,textValue:t,intl:h})),[y,o,m,t,h]),title:v,styles:f}}function g(e){const{textValue:t,operator:o,propertySchema:r,messageType:n,intl:a}=e,s=r.name;let u;const m=a.formatMessage(c().bK[o].text).toLocaleLowerCase();return"action"===n?u=p().$B({operator:m,propertyName:s,propertyValues:t}):"trigger"===n?u=p().rh({operator:m,propertyName:s,propertyValues:t}):(0,l().HB)(n),(0,d.jsx)(i().sA,{...u})}},975969:(e,t,o)=>{o.d(t,{U:()=>n});var r=()=>o(401497);function n(){return(0,r().IS)((()=>({disabledMenuItem:{cursor:"not-allowed",opacity:.4}})),[])}},976792:(e,t,o)=>{o.d(t,{YS:()=>i,q8:()=>a,zz:()=>l});o(898992),o(737550);var r=()=>o(383616),n=()=>o(966249);function a(e){return Boolean(e.state&&"connectionPointer"in e.state&&e.state.connectionPointer)}function i(e){const{connectionScopes:t,module:o}=e;if("slack"!==o.type)return!1;if(!a(o))return!1;const r=function(){const e=n().Nh.slack;if(!e)return[];const t=e.config.scopes;return t.production??t.local??[]}();return 0!==r.length&&r.some((e=>!(t??[]).includes(e)))}function l(e){if(e)return e.table===r().Kl?{type:"workflowExternal",externalConnectionId:e.id}:{type:"workflow",workflowExternalScopedConnectionId:e.id}}},980357:(e,t,o)=>{o.d(t,{u:()=>n});o(296540);const r={viewBox:"0 0 16 16",fittedViewBox:"2.37 2.37 11.25 11.25",svg:(0,o(474848).jsx)("path",{d:"M4.25 2.375c-1.036 0-1.875.84-1.875 1.875v7.5c0 1.036.84 1.875 1.875 1.875h7.5c1.036 0 1.875-.84 1.875-1.875v-7.5c0-1.036-.84-1.875-1.875-1.875zM3.625 4.25c0-.345.28-.625.625-.625h7.5c.345 0 .625.28.625.625v7.5c0 .345-.28.625-.625.625h-7.5a.625.625 0 0 1-.625-.625z"})},n=(0,o(340498).wt)("squareSmall",r,"small")},984714:(e,t,o)=>{o.d(t,{AJ:()=>f,CH:()=>v,Xl:()=>x,qR:()=>y,sF:()=>h,vu:()=>g});var r=o(296540),n=()=>o(590526),a=()=>o(401497),i=()=>o(250910),l=()=>o(118307),s=()=>o(69708),u=()=>o(100622),c=()=>o(656134),p=()=>o(630550),d=()=>o(217028),m=o(474848);function g(e){const{actionId:t,actionMenu:o,buttonPopupStore:r,disabled:n,onClick:i,propertySchema:l}=e,s=(0,a().IS)((()=>({icon:{fill:u().Tj.red.text.accentPrimary},iconWrap:{background:u().Tj.red.background.secondaryTranslucent,borderRadius:4},propertyType:{color:u().Tj.palette.red[700]}})),[]),c=f({propertySchema:l}),p=v();return(0,m.jsx)(d().z$,{actionId:t,actionMenu:o,buttonPopupStore:r,disabled:n,onClick:i,propertyType:l.type,styles:s,tooltip:p,tooltipPlacement:"bottom",children:c})}function y(e){const{actionId:t,actionMenu:o,buttonPopupStore:r,disabled:n,onClick:i}=e,l=(0,a().IS)((()=>({icon:{fill:u().Tj.red.text.accentPrimary},propertyType:{color:u().Tj.palette.red[700]}})),[]),s=x();return(0,m.jsx)(d().z$,{actionId:t,actionMenu:o,buttonPopupStore:r,disabled:n,onClick:i,styles:l,tooltip:s,children:s})}function h(e){const{actionId:t,propertyId:o,renderOrigin:a}=e,s=(0,c().j)(),u=(0,n().uB)(void 0,l().A),d=(0,r.useCallback)((()=>u.reset()),[u]);return(0,m.jsx)(i().A,{buttonPopupStore:u,popupType:s,render:()=>(0,m.jsx)(p().a,{actionId:t,closeMenu:d,propertyId:o}),renderOrigin:a})}function f(e){const{propertySchema:t}=e;return(0,m.jsx)(s().sA,{defaultMessage:"â€œ{propertyName}â€ property was deleted",id:"updateThisPageUnsupportedPropertyAction.updatedDeletedProperty.elementTitleText",values:{propertyName:t.name}})}function v(){return(0,m.jsx)(s().sA,{defaultMessage:"Restore property or delete to enable this automation",id:"updateThisPageUnsupportedPropertyAction.updatedDeletedProperty.title"})}function x(){return(0,m.jsx)(s().sA,{defaultMessage:"The property was permanently deleted",id:"updateThisPageUnsupportedPropertyAction.permanentlyDeleted.title"})}},989064:(e,t,o)=>{o.d(t,{z:()=>p});var r=o(296540),n=()=>o(590526),a=()=>o(366360),i=()=>o(813716),l=()=>o(997939),s=()=>o(36697),u=()=>o(897499),c=o(474848);function p(e){const{property:t}=(0,r.useContext)(u()._B),{collectionStore:o}=(0,a().k)(),{removePropertyTrigger:p}=(0,i().p)(),d=(0,r.useCallback)((()=>{p(t)}),[t,p]),m=(0,n().K8)((()=>o.getSchema()),[o])[t],g=m?e=>(0,c.jsx)(s().P,{propertySchema:m,style:e}):void 0;return(0,c.jsx)(l().X,{icon:g,onDelete:d,...e,children:e.children})}},997939:(e,t,o)=>{o.d(t,{X:()=>C});o(16280),o(898992),o(354520);var r=o(296540),n=()=>o(590526),a=()=>o(401497),i=()=>o(118307),l=()=>o(807449),s=()=>o(890492),u=()=>o(81068),c=()=>o(663639),p=()=>o(736847),d=()=>o(105819),m=()=>o(236262),g=()=>o(69708),y=()=>o(534177),h=()=>o(366360),f=()=>o(781697),v=()=>o(160988),x=()=>o(741310),S=()=>o(923832),b=o(474848);function C(e){const{onDelete:t,styles:o}=e,{disabled:l}=(0,h().b)(),s=Boolean(l),u=(0,n().uB)(void 0,i().A),c=(0,r.useCallback)((()=>{if(!t)throw new Error("onDelete is not implemented for trigger");t(),u.setState({open:!1})}),[u,t]),p=(0,r.useMemo)((()=>t?(0,b.jsx)(k,{onDelete:c}):null),[t,c]),d=(0,a().IS)((()=>({componentWrap:{borderRadius:10},buttonWrap:{borderRadius:10}})),[]),m=(0,r.useCallback)((t=>{const r=e.onClick?S().aX:S().ot;return(0,b.jsx)(r,{...t,actionMenu:p,buttonPopupStore:u,disabled:s,icon:e.icon,onClick:e.onClick,styles:{...o,...d},hideDragHandle:!0,children:e.children})}),[e.onClick,e.icon,e.children,p,u,s,o,d]);return(0,b.jsx)(v().ck,{children:(0,b.jsx)(x().P,{disable:s,renderOrigin:m,title:e.tooltip,tooltipPlacement:e.tooltipPlacement||"bottom",disableTooltip:!(0,y().O9)(e.tooltip)})})}function k(e){const{onClose:t,onEdit:o,onDelete:r}=e,n=(0,f().e)(),a=[o?{action:()=>{null==t||t(),o()},key:"edit",render:e=>(0,b.jsx)(u().A,{...e,icon:(0,b.jsx)(l().I,{icon:d().pencilLineIcon}),title:(0,b.jsx)(g().sA,{id:"automationBaseStepElement.moreActionsMenu.edit",defaultMessage:"Edit"})})}:void 0,r?{action:()=>{null==t||t(),r()},key:"delete",render:e=>(0,b.jsx)(u().A,{...e,icon:(0,b.jsx)(l().I,{icon:m().trashIcon}),title:(0,b.jsx)(g().sA,{id:"automationBaseStepElement.moreActionsMenu.delete",defaultMessage:"Delete"})})}:void 0].filter(y().O9);return(0,b.jsx)(s().A,{...n,children:(0,b.jsx)(c().A,{type:c().O.Vertical,sections:[{items:a,key:"items",render:e=>(0,b.jsx)(p().A,{enableActionSheetTitle:!0,topBorder:!0,...e})}],initialFocus:0})})}}}]);