"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[94522],{9140:(e,t,o)=>{o.d(t,{LI:()=>d,zu:()=>a,Gy:()=>u,Sh:()=>l,zp:()=>s});var n=()=>o(638681);const r=n().literals("anthropic-haiku-4.5","anthropic-haiku-4.5-thinking","anthropic-opus","anthropic-opus-4","anthropic-opus-4-thinking","anthropic-opus-4.1","anthropic-opus-4.1-thinking","anthropic-sonnet-3.7","anthropic-sonnet-3.7-thinking","anthropic-sonnet-4","anthropic-sonnet-4-thinking","anthropic-sonnet-alt","anthropic-sonnet-alt-no-thinking","anthropic-sonnet-alt-thinking","anyscale-gpt-oss-safeguard-20b","apple-danish","bedrock-anthropic-sonnet-3.7","bedrock-nova-lite","bedrock-nova-micro","bedrock-nova-pro","cerebras-deepseek-r1-distill-llama-70b","cerebras-llama3.1-8b","cerebras-llama3.3-70b","default","fireworks-deepseek-r1","fireworks-deepseek-r1-0528","fireworks-deepseek-v3","fireworks-ft-router-101","fireworks-ft-router-102","fireworks-gpt-oss-120b","fireworks-gpt-oss-20b","fireworks-gpt-oss-safeguard-120b","fireworks-kimi-k2","fireworks-llama-8b-finetune-v07-p50-cru6bgc4","fireworks-llama3-70b","fireworks-llama3.1-405b","fireworks-llama3.1-70b","fireworks-llama3.1-8b","fireworks-llama3.3-70b","fireworks-llama3.3-70b-dedicated","fireworks-mixtral-22b","fireworks-mixtral-7b","gateau-roule","gateau-roule-low-thinking","gemini-flash","gemini-pro","gingerbread","groq-gemma-7b-it","groq-gemma2-9b-it","groq-llama-70b","groq-llama-8b","groq-mixtral","oatmeal-cake","oatmeal-cookie","old-fashioned-donut","openai-chatgpt-4o-latest","openai-gpt-4.1","openai-gpt-4.1-mini","openai-gpt-4.1-nano","openai-gpt-4o","openai-gpt-4o-mini","openai-gpt-5-mini","openai-gpt-5-nano","openai-o1","openai-o1-mini","openai-o3","openai-o3-mini","openai-o4-mini","openai-turbo","openai-turbo-10","openai-turbo-8","openai-turbo-minimal-thinking","openai-turbo-thinking","orange-tart","orange-tart-minimal-thinking","oreo-cheesecake","vertex-gemini-1.5-flash","vertex-gemini-1.5-pro","vertex-gemini-2.0-flash","vertex-gemini-2.5-flash","vertex-gemini-2.5-pro"),i=n().union([n().object({required:{type:n().literals("asana","box","discord","github","gmail","google-calendar","google-drive","jira","linear","microsoft-teams","notion-calendar","notion-mail","outlook","salesforce","sharepoint","slack")},optional:{}}),n().object({required:{type:n().literal("ai-knowledge")},optional:{}}),n().object({required:{collectionId:n().uuid(),pageId:n().uuid(),type:n().literal("collection")},optional:{}}),n().object({required:{pageId:n().uuid(),type:n().literal("page")},optional:{}}),n().object({required:{type:n().literal("custom")},optional:{customConnectorId:n().string(),displayName:n().string(),thirdPartyId:n().string()}}),n().object({required:{type:n().literal("everything")},optional:{}}),n().object({required:{type:n().literal("helpdocs")},optional:{}}),n().object({required:{type:n().literal("labeler")},optional:{}}),n().object({required:{type:n().literal("notion-none")},optional:{}}),n().object({required:{type:n().literal("notion")},optional:{}}),n().object({required:{siteId:n().uuid(),type:n().literal("site")},optional:{}}),n().object({required:{type:n().literal("slackbot")},optional:{}}),n().object({required:{teamId:n().uuid(),type:n().literal("teamspace")},optional:{}}),n().object({required:{type:n().literal("universal-none")},optional:{}}),n().object({required:{type:n().literal("universal-workspace")},optional:{}}),n().object({required:{type:n().literal("web")},optional:{}}),n().object({required:{type:n().literal("workspace")},optional:{}})]),a=(n().union([n().object({required:{type:n().literals("asana","box","discord","github","gmail","google-calendar","google-drive","jira","linear","microsoft-teams","notion-calendar","notion-mail","outlook","salesforce","sharepoint","slack")},optional:{}}),n().object({required:{type:n().literal("ai-knowledge")},optional:{}}),n().object({required:{collectionId:n().uuid(),pageId:n().uuid(),type:n().literal("collection")},optional:{}}),n().object({required:{pageId:n().uuid(),type:n().literal("page")},optional:{}}),n().object({required:{type:n().literal("custom")},optional:{customConnectorId:n().string(),displayName:n().string(),thirdPartyId:n().string()}}),n().object({required:{type:n().literal("everything")},optional:{}}),n().object({required:{type:n().literal("googleDrive")},optional:{}}),n().object({required:{type:n().literal("helpdocs")},optional:{}}),n().object({required:{type:n().literal("labeler")},optional:{}}),n().object({required:{type:n().literal("notion-none")},optional:{}}),n().object({required:{type:n().literal("notion")},optional:{}}),n().object({required:{siteId:n().uuid(),type:n().literal("site")},optional:{}}),n().object({required:{type:n().literal("slackbot")},optional:{}}),n().object({required:{teamId:n().uuid(),type:n().literal("teamspace")},optional:{}}),n().object({required:{type:n().literal("universal-none")},optional:{}}),n().object({required:{type:n().literal("universal-workspace")},optional:{}}),n().object({required:{type:n().literal("web")},optional:{}}),n().object({required:{type:n().literal("workspace")},optional:{}})]),n().object({required:{type:n().literal("markdown-chat")},optional:{model:r}})),l=n().object({required:{scopeForNextSearch:i,type:n().literal("search")},optional:{filtersForNextSearch:n().object({required:{},optional:{ancestorsFilter:n().array(n().string()),createdByFilter:n().array(n().uuid()),dateRangeFilter:n().object({required:{},optional:{endDate:n().string(),startDate:n().string()}}),excludeCreatedByFilter:n().array(n().uuid()),teamspacesFilter:n().array(n().string()),titleOnlyFilter:n().boolean()}}),searchSessionId:n().string(),useWebSearch:n().boolean()}}),s=n().object({required:{type:n().literal("workflow")},optional:{addCitationData:n().boolean(),agentFollowupVariation:n().union([n().tuple([n().literal("button"),n().literal("default")]),n().tuple([n().literal("button"),n().literal("nudge")]),n().tuple([n().literal("default")]),n().tuple([n().literal("nudge")])]),availableConnectors:n().array(n().literals("asana","box","custom","discord","github","gmail","google-calendar","google-drive","jira","linear","microsoft-teams","notion-calendar","notion-mail","outlook","salesforce","sharepoint","slack")),enableAgentAutomations:n().boolean(),enableAgentCardCustomization:n().boolean(),enableAgentCreateDbTemplate:n().boolean(),enableAgentDashboards:n().boolean(),enableAgentDiffs:n().boolean(),enableAgentGenerateImage:n().boolean(),enableAgentIntegrations:n().boolean(),enableAgentQueryDataSources:n().boolean(),enableAgentRevertTool:n().boolean(),enableAgentSupportPropertyReorder:n().boolean(),enableAgentThreadTools:n().boolean(),enableAgentTodos:n().boolean(),enableAgentVerification:n().boolean(),enableAgentViewNotificationsTool:n().boolean(),enableCodegenIntegration:n().boolean(),enableCsvAttachmentSupport:n().boolean(),enableCustomAgents:n().boolean(),enableDatabaseAgents:n().boolean(),enableExperimentalIntegrations:n().boolean(),enableQueryCalendar:n().boolean(),enableQueryMail:n().boolean(),enableRunAgentTool:n().boolean(),enableScriptAgent:n().boolean(),enableScriptAgentAdvanced:n().boolean(),enableSetupModeTool:n().boolean(),enableSpeculativeSearch:n().boolean(),enableSystemPromptAsPage:n().boolean(),enableTpmThrottle:n().boolean(),enableUpdateAgentV2Tools:n().boolean(),enableUpdatePageAutofixer:n().boolean(),enableUpdatePageMarkdownTree:n().boolean(),enableUpdatePageOrderUpdates:n().boolean(),enableUpdatePageTreeDiff:n().boolean(),enableUpdatePageTreeDiffMetrics:n().boolean(),enableUpdatePageV2Tool:n().boolean(),enableUserSessionContext:n().boolean(),hasMailTrigger:n().boolean(),isCustomAgent:n().boolean(),isCustomAgentBuilder:n().boolean(),isDatabaseAgent:n().boolean(),isThreadStartedByAdmin:n().boolean(),mailTriggerTypes:n().array(n().literals("mail.email.received","mail.email.receivedorsent","mail.email.sent","mail.label.applied")),memoryDatabasePageId:n().uuid(),model:n().literals("anthropic-haiku-4.5","anthropic-haiku-4.5-thinking","anthropic-opus-4","anthropic-opus-4-thinking","anthropic-opus-4.1","anthropic-opus-4.1-thinking","anthropic-sonnet-3.7","anthropic-sonnet-3.7-thinking","anthropic-sonnet-4","anthropic-sonnet-4-thinking","anthropic-sonnet-alt","anthropic-sonnet-alt-no-thinking","anthropic-sonnet-alt-thinking","apple-danish","gateau-roule","gateau-roule-low-thinking","gemini-flash","gemini-pro","gingerbread","oatmeal-cake","oatmeal-cookie","openai-gpt-4.1","openai-gpt-4.1-mini","openai-gpt-5-mini","openai-gpt-5-nano","openai-turbo","openai-turbo-minimal-thinking","openai-turbo-thinking","orange-tart","orange-tart-minimal-thinking"),modelFromUser:n().boolean(),researchMode:n().boolean(),searchScopes:n().array(i),searchSessionId:n().string(),useCustomAgentDraft:n().boolean(),useReadOnlyMode:n().boolean(),useWebSearch:n().boolean(),use_draft_actor_pointer:n().boolean(),workflowId:n().string(),writerMode:n().boolean()}}),u=n().object({required:{type:n().literal("researcher")},optional:{searchScope:i,useWebSearch:n().boolean()}}),d=n().object({required:{},optional:{recentSearchToolResultsToKeep:n().number(),summarizeTokenThreshold:n().number()}})},94522:(e,t,o)=>{o.d(t,{Cq:()=>u,dh:()=>s,gy:()=>c,i4:()=>d});o(16280),o(898992),o(354520);var n=()=>o(824862),r=()=>o(743246),i=()=>o(758256),a=()=>o(915671),l=()=>o(534177);function s(e){var t;return(null===(t=e.getModel())||void 0===t?void 0:t.getData())||(0,a().bZ)()}function u(e){const{workflowPointer:t,threadPointer:o}=e,n=t??o;if(!n)throw new Error("No workflow definition pointer found");return n}function d(e){switch(e.table){case"workflow":return e.id;case"workflow_artifact":return e.getParentId();case"thread":const t=e.getConfig();return"workflow"===(null==t?void 0:t.type)?t.workflowId:void 0;default:(0,l().HB)(e)}}function c(e){var t,o;let a;switch(e.table){case i().U6:a=null===(t=e.getData())||void 0===t?void 0:t.runtime_actor_pointer;break;case r().C0:a=null===(o=e.getPublishedArtifactStore())||void 0===o||null===(o=o.getData())||void 0===o?void 0:o.runtime_actor_pointer;break;default:(0,l().HB)(e)}if(a&&a.table===n().GP)return a.id}},467273:(e,t,o)=>{function n(e){return"user"===e.type||"user-injected"===e.type||"agent-message"===e.type||"agent-prebuilt-prompt"===e.type}o.d(t,{z:()=>n})},791256:(e,t,o)=>{o.d(t,{NK:()=>M,HS:()=>R,oE:()=>Z,ZR:()=>x,Jz:()=>E,_R:()=>j,Hg:()=>w,zj:()=>L,o:()=>A,L2:()=>C,jT:()=>I,A3:()=>S,d$:()=>X,tC:()=>q,sQ:()=>z,_P:()=>U,Ft:()=>Q,av:()=>W,OT:()=>J,JK:()=>_,o6:()=>P,l0:()=>O,Pp:()=>H,hw:()=>G,SJ:()=>N,xE:()=>$,validateConfigStringAgainstValidators:()=>K});o(16280),o(18107),o(410838),o(944114),o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(967357),o(898992),o(823215),o(354520),o(672577),o(430670),o(581454),o(737550);var n=()=>o(907258),r=()=>o(295633),i=()=>o(744947),a=()=>o(467273);var l=()=>o(584262),s=()=>o(911676),u=()=>o(388821),d=()=>o(743246),c=()=>o(145820),p=()=>o(201980),g=()=>o(496603),b=()=>o(534177),f=()=>o(716500),h=()=>o(492414),m=()=>o(166442),y=()=>o(915189),k=()=>o(555102),v=()=>o(9140);function w(e,t){if(!t)return{cachedInferences:[],annotationInferences:[]};const{inferences:o,inferenceKeysToAnnotations:n,acceptedInferenceKeys:r}=e.getOrCreateClientAIChatThreadStore(t).state,i=new Map;for(const a of o)i.set(a.key,a);return{cachedInferences:g().oE(r.map((e=>i.get(e)))),annotationInferences:g().oE(Object.entries(n).map((([e,t])=>{const o=i.get(e);if(o)return{...o,value:{...o.value,input:{...o.value.input,annotation:t}}}})))}}function S(e){const{clientStore:t,threadStore:o}=e,n=null==o?void 0:o.id;if(!n)return{steps:[],allReady:!1};const r=(null==o?void 0:o.getMessageStores())??[],i=r.map((e=>e.getStep())).filter(b().O9)??[],a=new Set(i.map((e=>e.id))),l=t.getOrCreateClientAIChatThreadStore(n).state.temporarySteps;return{steps:[...i.map((e=>l.find((t=>t.id===e.id))??e)),...l.filter((e=>!a.has(e.id)))].filter((e=>"title"!==e.type)),allReady:r.every((e=>e.isReady()))}}function I(e){const t=e.find(z);if(t)return t.value}function A(e){return e.find(V)}function C(e){return I(e?e.getTranscript():[])}function j(e,t){const o=t.findIndex((t=>t.id===e.id));if(-1!==o)return t.slice(0,o).findLast((e=>"user"===e.type))}function q(e){return"helpdocs"===e?"helpdoc":e}function x(e){return"helpdoc"===e?"helpdocs":"all"===e?"notion":e}function T(e){const{result:t,environment:o}=e,n={resultId:t.id,positionWithinSource:t.positionWithinSource,traceId:t.traceId};if("notion"===t.type)return p().X$({...n,href:(0,h().J8)({store:new(r().B)(o,{table:"block",id:t.id}),fullyQualified:!1,pageVisitSource:l().y8.AIQna}),blockId:t.id,type:"block"});if("webpage"===t.type)return p().X$({...n,href:t.href,type:"webpage",url:(null==t?void 0:t.url)||""});if("helpdoc-section"===t.type)return p().X$({...n,type:"helpdoc-section",href:t.href,url:t.url,parentPageHref:t.parentPageHref});if("helpdocs"===t.type)return p().X$({...n,type:"helpdoc",href:t.href,url:t.url});return(0,f().K)(t.type).getCitationAnnotationFromSearchResult({result:t})}function P(e){const{results:t,spaceStore:o,environment:n,traceId:r}=e;return e=>{if(!o)return{annotations:[e],status:"missing_citation"};const i=t.flatMap(((e,t)=>((0,y().y$)(e.result,o)??[]).map((e=>({...e,position:t})))));return function({linkAnnotation:e,getRenderableSearchResultAndPositionById:t,environment:o}){const n=p().cQR(e);if(!n)return{annotations:[e],status:"other_link"};const r=n.indexOf("#citation:"),i=n.indexOf(s().N$);if(-1!==i){const r=t(decodeURIComponent(n.slice(i+s().N$.length)));if(!r)return{annotations:[e],status:"other_link"};const a=(0,y().OA)({result:r,environment:o});return{annotations:[(0,p().Sez)(a)],status:"other_link"}}if(-1!==r){const i=t(decodeURIComponent(n.slice(r+10)));return i?{annotations:[T({result:i,environment:o})],status:"citation"}:{annotations:[e],status:"missing_citation"}}return{annotations:[(0,p().Sez)(n)],status:"other_link"}}({linkAnnotation:e,getRenderableSearchResultAndPositionById:e=>{const t=i.find((t=>"notion"===t.type?decodeURIComponent(t.id)===e:decodeURIComponent(t.href)===e));if(t)return t?{...t,positionWithinSource:t.position,traceId:r}:void 0},environment:n})}}const R=/\[\]\((.*?)\)/g;function E(e){return e.replace(/\[([^\[\]]+?)\]\((.*?)\)/g,((e,t,o)=>`[${t}](${s().N$}${o})`)).replace(/\[\]\((.*?)\)/g,((e,t)=>`[citation](#citation:${t})`))}const M=3600;function D(e){var t;return(null==e||null===(t=e.getParentPointer())||void 0===t?void 0:t.table)===d().C0}function _(e){var t;return D(e)&&void 0!==(null==e||null===(t=e.getData())||void 0===t?void 0:t.run_id)}function B(e){const t=e.getData(),o=null==t?void 0:t.run_id,n=e.getSpaceId();if(o&&n)return i().t.createChildStore(e,{table:c().QR,id:o,spaceId:n})}function F(e){return"agent-tool-result"===e.type&&"result"===e.toolType}function U(e,t=M){const o=e.getUpdatedTime()??e.getCreatedTime();if(!o)return!1;return Date.now()-o>1e3*t}function $({threadStore:e,transcript:t,clientStore:o,stuckThresholdSeconds:n}){if(!e||!D(e))return;const r=B(e),i=null==r?void 0:r.getStatus();return"skipped"===i||function(e){return e.some(F)}(t)||function(e){return e.some((e=>"error"===e.type))}(t)||Q({clientStore:o,threadStore:e})?void 0:"failure"===i?"failure":"retryableFailure"===i?"retryableFailure":"running"===i&&U(e,n??M)?"stuck":void 0}function N(e){if(!e||!D(e))return!1;const t=B(e);return"pending"===(null==t?void 0:t.getStatus())}function Q({clientStore:e,threadStore:t}){return!!t&&(!!t.getIsInferenceLeaseActive()||e.getOrCreateClientAIChatThreadStore(t.id).state.loading)}function O(e){return"resultsBlended"===e.status||"resultsComplete"===e.status||"resultsPartial"===e.status||"generatingQuery"!==e.status&&"searching"!==e.status&&void(0,b().HB)(e)}function H(e){return"resultsComplete"===e.status||"resultsBlended"===e.status||"resultsPartial"!==e.status&&"generatingQuery"!==e.status&&"searching"!==e.status&&void(0,b().HB)(e)}function z(e){return"config"===e.type}function V(e){return"context"===e.type}function L(e){const{clientStore:t,threadStore:o}=e,n=C(o);return n||t.state.configForNewTranscripts}function K(e){if(e)try{const t=decodeURIComponent(e),o=JSON.parse(t);if(null==o||!o.type)return;if(!function(e){if(!e||!e.type)return!1;switch(e.type){case"search":return!!(null===v().Sh.validator(e));case"workflow":return!0;default:return!1}}(o))return;return o}catch{return}}function W(e){if(!e)return!0;return 0===S({clientStore:m().defaultClientAIChatStore,threadStore:e}).steps.length}function J(e){if(!e)return!1;return S({clientStore:m().defaultClientAIChatStore,threadStore:e}).steps.some((e=>(0,a().z)(e)||"agent-trigger"===e.type))}function X(e){var t;const{transcript:o}=e,r=o.findLast((e=>"context"===e.type));if(!r)return!1;return(r.value.collectionViewBlockId??r.value.blockId)!==(null===(t=n().default.state.mainEditorCurrentBlockStore)||void 0===t?void 0:t.id)}function G(e){const{config:t,hasAgentIntegrationsFeatureFlag:o}=e,n="workflow"===t.type&&t.isCustomAgent;return o&&!n}async function Z(e){const{agentChatIntegrations:t,environment:o,spaceStore:n,spaceViewStore:r}=e,i=u().RecordMap.create();await r.load();const a=r.getModel();if(!a)throw new Error("No space view model");i.addModel(a);const l=[];for(const s of t){await s.workflowModuleStore.load();const e=s.workflowModuleStore.getModel();if(!e)throw new Error("No workflow module model");i.addModel(e),l.push(e.pointer)}return(0,k().yQ)({activeRecordPointers:[],environment:o,inactiveRecordPointers:l,recordMap:i.getSize()>0?i:void 0,spaceStore:n})}},915189:(e,t,o)=>{o.d(t,{OA:()=>y,SF:()=>m,vs:()=>k,y$:()=>h});o(16280),o(898992),o(354520),o(672577),o(581454),o(814603),o(147566),o(198721);var n=()=>o(726637),r=()=>o(295633),i=()=>o(902006),a=()=>o(241178),l=()=>o(584262),s=()=>o(510818),u=()=>o(832443),d=()=>o(172385),c=()=>o(179034),p=()=>o(534177),g=()=>o(716500),b=()=>o(492414);function f(e){return"notion"!==e.type||"page"===e.citationLevel}function h(e,t){if("block"===e.type||"properties"===e.type)return;if("page"===e.type){var o;const n=(null===(o=e.blocks)||void 0===o?void 0:o.map((o=>({type:"notion",citationLevel:"block",store:r().B.createChildStore(t,{table:c().ev,id:o.id,spaceId:t.id}),id:o.id,pageId:e.pageId??e.id,title:e.title,path:e.path,text:o.text,lastEdited:e.lastEdited,badges:void 0,highlight:void 0}))))??[];return[{type:"notion",citationLevel:e.type,store:r().B.createChildStore(t,{table:c().ev,id:e.id,spaceId:t.id}),id:e.id,pageId:e.pageId??e.id,title:e.title,authorName:e.authorName,path:e.path,text:e.text,lastEdited:e.lastEdited,badges:e.badges,highlight:e.highlight},...n]}const n=u().tD.parseAssistantHref(e.id);if(n){if("helpdoc"===e.type){if("helpdoc"!==n.type)throw new Error(`Expected helpdocs result, but got ${n.type}`);return[{type:"helpdocs",href:e.id,id:e.id,title:e.title,text:(0,s().Mw)(e.text),lastEdited:e.lastEdited,url:n.url}]}if("helpdoc-section"===e.type){if("helpdoc-section"!==n.type)throw new Error(`Expected helpdoc-section result, but got ${n.type}`);return[{type:"helpdoc-section",href:e.id,id:e.id,parentPageHref:n.parentPageHref,title:e.title,text:(0,s().Mw)(e.text),lastEdited:e.lastEdited,url:n.url}]}if("webpage"===e.type){if("webpage"!==n.type)throw new Error(`Expected webpage result, but got ${n.type}`);return[{type:"webpage",href:e.id,id:e.id,title:e.title,text:(0,s().Mw)(e.text),lastEdited:e.lastEdited,url:n.url,domain:new URL(n.url).origin}]}if((0,i().SC)(e.type)){return(0,g().K)(e.type).generateRenderableResults({result:e,parsedHref:n})}}}function m(e,t){const o=h(e,t);return o?o.filter(f):[]}function y(e){const{result:t,environment:o}=e;if("notion"===t.type){const e=o.RouterStore.state.route;return"chat"===e.name?(0,d().EY)({isMobile:n().A.isMobile,currentRoute:e,pageId:t.store.id,pageVisitSource:l().y8.AIQna}):(0,b().Ay)({store:t.store,fullyQualified:!1,pageVisitSource:l().y8.AIQna})}return"slack"===t.type?(0,a().mQ)({...t}):"helpdocs"===t.type||"helpdoc-section"===t.type||"webpage"===t.type||(0,i().SC)(t.type)?t.url:void(0,p().HB)(t.type)}function k(e,t){var o;return null===(o=e.find((e=>e.key===t||"messages"in e.result&&e.result.messages.find((e=>e.messageId===t)))))||void 0===o?void 0:o.result}}}]);