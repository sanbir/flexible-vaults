"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[54892],{426433:(e,n,t)=>{t.d(n,{g:()=>j,i:()=>I});var a=t(296540),o=()=>t(564884),s=()=>t(484714),i=()=>t(590526),r=()=>t(852832),l=()=>t(69708),c=()=>t(534177),u=()=>t(934839),d=()=>t(209660),p=()=>t(179030),m=()=>t(135552),b=()=>t(511393),y=()=>t(529803),v=()=>t(150193),_=()=>t(807778),g=()=>t(671812),f=t(474848);const w={updatePaymentMethod:(0,f.jsx)(l().sA,{id:"subscription.payment_status_banner.update_payment_method",defaultMessage:"Update payment information"}),viewWorkspaceOwner:(0,f.jsx)(l().sA,{id:"subscription.payment_status_banner.view_workspace_owner",defaultMessage:"View workspace owner"}),confirmPayment:(0,f.jsx)(l().sA,{id:"subscription.payment_status_banner.confirm_payment",defaultMessage:"Confirm payment"})};function h(){return()=>{d().Ow()}}function A(e){const{messageType:n,overdueInvoiceCount:t=1}=e;switch(n){case"past_due_owner":return(0,f.jsx)(l().sA,{id:"subscription.payment_status_banner.payment_failed.past_due.workspace_owner",defaultMessage:"We couldn’t process {overdueInvoiceCount, plural, one {your last payment} other {{overdueInvoiceCount} payments}}. Please update your payment method or you may lose access to Notion soon.",values:{overdueInvoiceCount:t}});case"past_due_member":return(0,f.jsx)(l().sA,{id:"subscription.payment_status_banner.payment_failed.past_due.member",defaultMessage:"Please contact a workspace owner to update your payment method or you may lose access to Notion soon."});case"unpaid_owner":return(0,f.jsx)(l().sA,{id:"subscription.payment_status_banner.payment_failed.unpaid.workspace_owner",defaultMessage:"Access to Notion is limited to viewing because we couldn’t process {overdueInvoiceCount, plural, one {your last payment} other {{overdueInvoiceCount} payments}}.",values:{overdueInvoiceCount:t}});case"unpaid_member":return(0,f.jsx)(l().sA,{id:"subscription.payment_status_banner.payment_failed.unpaid.member",defaultMessage:"Access to Notion is limited to viewing. Contact a workspace owner to update your workspace’s payment method."});default:(0,c().HB)(n)}}function T(e){const{messageType:n,overdueInvoiceCount:t=1}=e;switch(n){case"past_due_owner":return(0,f.jsx)(l().sA,{id:"subscription.payment_status_banner.confirmation_required.past_due.workspace_owner",defaultMessage:"Please confirm {overdueInvoiceCount, plural, one {your subscription payment} other {{overdueInvoiceCount} payments}} or you may lose access to Notion soon.",values:{overdueInvoiceCount:t}});case"unpaid_owner":return(0,f.jsx)(l().sA,{id:"subscription.payment_status_banner.confirmation_required.unpaid.workspace_owner",defaultMessage:"Access to Notion is limited to viewing. Confirm {overdueInvoiceCount, plural, one {your subscription payment} other {{overdueInvoiceCount} payments}} to restore full access.",values:{overdueInvoiceCount:t}});case"unpaid_member":return(0,f.jsx)(l().sA,{id:"subscription.payment_status_banner.confirmation_required.unpaid.member",defaultMessage:"Access to Notion is limited to viewing. Contact a workspace owner to update your workspace’s payment method."});default:(0,c().HB)(n)}}function x(e){const{billingStatusData:n,uncollectibleExperienceEnabled:t}=e;if(null==n||!n.data)return;const{isWorkspaceOwner:a}=n,{invoiceHostedUrl:o,overdueInvoiceCount:s,bannerKey:i}=n.data;switch(i){case"past_due":return function(e){const{isWorkspaceOwner:n,invoiceHostedUrl:t,overdueInvoiceCount:a}=e,o=m().q.Yellow;return n?{bannerStyleKey:o,messageType:"past_due_owner",messageText:A({overdueInvoiceCount:a,messageType:"past_due_owner"}),callToActionText:w.updatePaymentMethod,callToActionHandler:(0,g().a)(t)}:{bannerStyleKey:o,messageType:"past_due_member",messageText:A({overdueInvoiceCount:a,messageType:"past_due_member"}),callToActionText:w.viewWorkspaceOwner,callToActionHandler:h()}}({isWorkspaceOwner:a,invoiceHostedUrl:o,overdueInvoiceCount:s});case"unpaid":if(t)return;return function(e){const{isWorkspaceOwner:n,invoiceHostedUrl:t,overdueInvoiceCount:a}=e,o=m().q.LightRed;return n?{bannerStyleKey:o,messageType:"unpaid_owner",messageText:A({overdueInvoiceCount:a,messageType:"unpaid_owner"}),callToActionText:w.updatePaymentMethod,callToActionHandler:(0,g().a)(t)}:{bannerStyleKey:o,messageType:"unpaid_member",messageText:A({overdueInvoiceCount:a,messageType:"unpaid_member"}),callToActionText:w.viewWorkspaceOwner,callToActionHandler:h()}}({isWorkspaceOwner:a,invoiceHostedUrl:o,overdueInvoiceCount:s});default:(0,c().HB)(i)}}function k(e){if(!e.data)return;const{isWorkspaceOwner:n}=e,{invoiceHostedUrl:t,bannerKey:a}=e.data;switch(a){case"past_due":return function(e,n,t){if(e)return{bannerStyleKey:m().q.Yellow,messageType:"past_due_owner",messageText:T({overdueInvoiceCount:t,messageType:"past_due_owner"}),callToActionText:w.confirmPayment,callToActionHandler:(0,g().a)(n)}}(n,t);case"unpaid":return function(e,n,t){const a=m().q.LightRed;return e?{bannerStyleKey:a,messageType:"unpaid_owner",messageText:T({overdueInvoiceCount:t,messageType:"unpaid_owner"}),callToActionText:w.confirmPayment,callToActionHandler:(0,g().a)(n)}:{bannerStyleKey:a,messageType:"unpaid_member",messageText:T({overdueInvoiceCount:t,messageType:"unpaid_member"}),callToActionText:w.viewWorkspaceOwner,callToActionHandler:h()}}(n,t);default:(0,c().HB)(a)}}function C(e){const{billingStatusData:n}=e;if(void 0===(null==n?void 0:n.data))return;const{overdueReason:t}=n.data;if(t)switch(t){case"payment_failed":return x(e);case"confirmation_required":return k(n);default:(0,c().HB)(t)}}function S(e){const n=y().A.state,t=(0,b().h)(e);return n&&n.data?{...n,isWorkspaceOwner:t}:void 0}function I(){const e=(0,s().v3)(),n=(0,i().K8)((()=>S(e)),[e]),t=(0,i().K8)((()=>(0,_().Jq)()),[]),l=(0,a.useMemo)((()=>C({billingStatusData:n,uncollectibleExperienceEnabled:t})),[n,t]);a.useEffect((()=>(["local","development","staging"].includes("production")&&(0,r().exposeDebugValue)("billingStatus",n),null!=n&&n.data&&l?(u().HQ({bannerStore:v().A,id:"BillingSubscriptionBanner",contentKey:"billing_subscription_status",styleKey:l.bannerStyleKey,prepend:!0}),(0,o().u)({environment:e,event:{eventName:"billing_subscription_banner_displayed",eventProperties:{isWorkspaceOwner:n.isWorkspaceOwner,...n.data}}})):u().zA({bannerStore:v().A,id:"BillingSubscriptionBanner"}),()=>{u().zA({bannerStore:v().A,id:"BillingSubscriptionBanner"})})),[e,n,l])}function j(e){const{legacyColor:n}=e,t=(0,s().v3)(),r=(0,i().K8)((()=>S(t)),[t]),l=(0,i().K8)((()=>(0,_().Jq)()),[]),c=(0,a.useMemo)((()=>C({billingStatusData:r,uncollectibleExperienceEnabled:l})),[r,l]),u=null==c?void 0:c.callToActionText,d=null==c?void 0:c.callToActionHandler,b=(0,a.useCallback)((e=>{void 0!==d&&d(e),null!=r&&r.data&&(0,o().u)({environment:t,event:{eventName:"billing_subscription_banner_action",eventProperties:{isWorkspaceOwner:r.isWorkspaceOwner,...r.data}}})}),[t,d,r]);return c?(0,f.jsx)(p().l,{label:c.messageText,display:"full-width",actions:[{label:u,onClick:e=>b(e)}],tint:(0,m().V)(n)}):null}},464762:(e,n,t)=>{t.d(n,{K:()=>f,M:()=>g});var a=t(296540),o=()=>t(564884),s=()=>t(920198),i=()=>t(59226),r=()=>t(484714),l=()=>t(741615),c=()=>t(795523),u=()=>t(69708),d=()=>t(934839),p=()=>t(209660),m=()=>t(179030),b=()=>t(135552),y=()=>t(176983),v=()=>t(150193),_=t(474848);function g(){const e=(0,r().v3)();return(0,_.jsx)(m().l,{label:(0,_.jsx)(u().sA,{id:"sanctions.missing_name_banner.banner_text",defaultMessage:"Please provide your name in the billing tab"}),display:"full-width",actions:[{label:(0,_.jsx)(u().sA,{id:"sanctions.missing_name_banner.cta_message",defaultMessage:"Click to update"}),onClick:()=>{p().Ow({currentTab:"billing",subtab:"address"}),(0,o().u)({environment:e,event:{eventName:"missing_name_sanctions_banner_clicked",eventProperties:{}}})}}],tint:"red"})}function f(){const e=(0,r().v3)(),n=function(){var e;const n=(0,i().X)("missing_name_banner"),t=(0,s().L)(),a=(0,l()._3)({spaceId:null==t?void 0:t.id}),o=(0,c().Fq)(a)&&!(0,c().Qx)(null==a?void 0:a.subscription),r=Boolean(null==a||null===(e=a.address)||void 0===e?void 0:e.name),u=(0,y().J)(t),d=null==a?void 0:a.provider,p="app_store"===d||"play_store"===d;return n&&u&&o&&!r&&!p}();a.useEffect((()=>(n?(d().HQ({bannerStore:v().A,id:"MissingNameBanner",contentKey:"missing_name",prepend:!0,styleKey:b().q.Red}),(0,o().u)({environment:e,event:{eventName:"missing_name_sanctions_banner_displayed",eventProperties:{}}})):d().zA({bannerStore:v().A,id:"MissingNameBanner"}),()=>{d().zA({bannerStore:v().A,id:"MissingNameBanner"})})),[e,n])}},577845:(e,n,t)=>{t.d(n,{U:()=>a});const a=new(t(29923).R)({key:"externalPagesBannerPreference",namespace:t(553737).Bq,important:!0,trackingType:"necessary"})},696751:(e,n,t)=>{t.d(n,{G:()=>w,U:()=>f});var a=t(296540),o=()=>t(920198),s=()=>t(230711),i=()=>t(907258),r=()=>t(484714),l=()=>t(590526),c=()=>t(278771),u=()=>t(124617),d=()=>t(69708),p=()=>t(534177),m=()=>t(934839),b=()=>t(179030),y=()=>t(135552),v=()=>t(49412),_=()=>t(150193),g=t(474848);function f(e){const{legacyColor:n}=e,t=(0,r().v3)(),a=t.currentUser.id,i=(0,o().L)(),u=(0,s().U2)(i),m=(0,l().K8)((()=>{var e;if(!i||!a||!u)return null;const n=null===(e=v().A.getData(t,{spaceId:i.id}))||void 0===e||null===(e=e.bannerIds)||void 0===e?void 0:e[0];if(!n)return null;const o=c().b.createChildStore(i,{id:n,table:"subscription_banner",spaceId:i.id});if(!o.isDefined())return null;const s=o.getBannerText();if(s)return(0,g.jsx)("span",{children:s});const r=Boolean(null==u?void 0:u.isWorkspaceOwner());return function(e,n){switch(e){case"uncollectible_past_due":return n?(0,g.jsx)(d().sA,{id:"subscription.payment_uncollectible.past_due.workspace_owner",defaultMessage:"Your workspace may lose editing capabilities soon due to past-due invoices. Please remit payment to avoid losing access to Notion. If you have any questions, please reach out to billing@makenotion.com."}):(0,g.jsx)(d().sA,{id:"subscription.payment_uncollectible.past_due.member",defaultMessage:"Your workspace may lose editing capabilities soon due to past-due invoices. Please remit payment to avoid losing access to Notion. If you have any questions, please reach out to billing@makenotion.com."});case"uncollectible_unpaid":return n?(0,g.jsx)(d().sA,{id:"subscription.payment_uncollectible.unpaid.workspace_owner",defaultMessage:"Your workspace is unable to edit due to past-due invoices. Please remit payment to avoid losing access to Notion. If you have any questions, please reach out to billing@makenotion.com."}):(0,g.jsx)(d().sA,{id:"subscription.payment_uncollectible.unpaid.member",defaultMessage:"Your workspace is unable to edit due to past-due invoices. Please remit payment to avoid losing access to Notion. If you have any questions, please reach out to billing@makenotion.com."});case"dunning":case"legacy_price":return;default:return(0,p().HB)(e)}}(o.getBannerKey(),r)}),[t,a,i,u]);return m?(0,g.jsx)(b().l,{label:m,display:"full-width",actions:[],tint:(0,y().V)(n)}):null}function w(){const e=(0,r().v3)(),n=(0,l().O$)(i().AppStoreSidebarSpaceStore),[t,o,s,d,b]=(0,l().K8)((()=>{var t;if(!n)return[];const a=null===(t=v().A.getData(e,{spaceId:n.id}))||void 0===t?void 0:t.bannerIds;if(a&&a.length>0){const e=a[0],t=c().b.createChildStore(n,{id:e,table:"subscription_banner",spaceId:n.id});if(!t.isDefined())return[];const o=t.getBannerKey(),s=t.getBannerType(),i=t.getAudience(),r=t.getBannerText();switch(s){case"warning":return[e,y().q.Yellow,o,i,r];case"alert":return[e,y().q.LightRed,o,i,r];case"info":return[e,y().q.LightBlue,o,i,r];case"uncollectible":return[e,"uncollectible_unpaid"===o?y().q.LightRed:y().q.Yellow,o,i,r];default:(0,p().HB)(s)}}return[]}),[e,n]);a.useEffect((()=>{if(t&&o){if(m().HQ({bannerStore:_().A,id:"SubscriptionUncollectibleBanner",contentKey:"arbitrary_subscription_banner",styleKey:o,prepend:!0}),s&&d){const n={banner:s,audience:d,text:""};b&&(n.text=b),(0,u().u)(e,{name:"subscription_uncollectible_banner_displayed",args:n})}}else m().zA({bannerStore:_().A,id:"SubscriptionUncollectibleBanner"});return()=>{m().zA({bannerStore:_().A,id:"SubscriptionUncollectibleBanner"})}}),[e,t,o,s,d,b])}},932737:(e,n,t)=>{t.d(n,{A:()=>g,b:()=>_});var a=()=>t(906745),o=t(296540),s=()=>t(300474),i=()=>t(741615),r=()=>t(795523),l=()=>t(97065),c=()=>t(69708),u=()=>t(934839),d=()=>t(209660),p=()=>t(179030),m=()=>t(135552),b=()=>t(150193),y=()=>t(775916),v=t(474848);function _(e){const{legacyColor:n}=e,t=(0,v.jsx)(c().sA,{id:"app.banner.trial_subscription.add_payment_method",defaultMessage:"Add a payment method to continue using your free trial. You will not be charged until the end of your trial period."}),a=(0,v.jsx)(c().sA,{id:"app.banner.trial_subscription.add_payment_method.call_to_action",defaultMessage:"Add payment method"});return(0,v.jsx)(p().l,{label:t,display:"full-width",actions:[{label:a,onClick:()=>{d().Ow({currentTab:"billing"})}}],tint:(0,m().V)(n)})}function g(){const e=(0,s().r)(),n=(0,i().lh)({spaceId:e}),t=(0,y().p)();let c;const d="admin"===(null==n?void 0:n.type)&&(0,r().i5)(n);c=!(!d||!t)&&(!(0,r().N8)(n)&&(!n.paymentMethod&&(!(0,l().DH)(t.offer.campaign)&&a().DateTime.now()>(null==d?void 0:d.minus({days:15}))))),o.useEffect((()=>(c?u().HQ({bannerStore:b().A,id:"SubscriptionTrialAddPaymentMethodBanner",contentKey:"subscription_trial_add_payment_method",styleKey:m().q.Yellow,prepend:!0}):u().zA({bannerStore:b().A,id:"SubscriptionTrialAddPaymentMethodBanner"}),()=>{u().zA({bannerStore:b().A,id:"SubscriptionTrialAddPaymentMethodBanner"})})),[c])}},966689:(e,n,t)=>{t.d(n,{G:()=>w,i:()=>f});var a=()=>t(906745),o=t(296540),s=()=>t(300474),i=()=>t(484714),r=()=>t(401497),l=()=>t(741615),c=()=>t(878126),u=()=>t(148307),d=()=>t(795523),p=()=>t(534177),m=()=>t(769864),b=()=>t(934839),y=()=>t(179030),v=()=>t(135552),_=()=>t(150193),g=t(474848);function f(e){const{legacyColor:n}=e,t=(0,s().r)(),b=(0,l().lh)({spaceId:t}),_=(0,d().q8)(b),f=(0,d().DS)(b),w=null==b?void 0:b.clock.externalId,[A,T]=(0,o.useState)(1),[x,k]=(0,o.useState)("second"),[C,S]=(0,o.useState)(!1),I=(0,i().v3)(),j=(0,r().IS)((()=>({message:{flexGrow:1,textWrap:"wrap"}})),[]);if(!t||!w||!_)return null;const B=async()=>{const e=a().dw.fromObject({[x]:A}),n=function(e){switch(e){case"month":return a().dw.fromObject({months:2});case"year":return a().dw.fromObject({years:2});default:(0,p().HB)(e)}}(_);if(e>n)return void h(`Cannot advance test clock by more than two billing intervals. The current billing interval is ${_}.`);S(!0);"success"===(await m().callApi({eventName:"stripeAdvanceTestClock",environment:I,data:{spaceId:t,epochSeconds:f.plus(e).toSeconds()}})).type?await Promise.all([c().T.resetData(I,{spaceId:t})]):h("Failed to advance test clock. Check server logs for details."),S(!1)},M=(0,g.jsxs)("div",{style:j.message,children:["The clock time is currently frozen at ",f.toLocaleString(a().DateTime.DATETIME_FULL)]}),K=[{label:(0,g.jsx)("input",{disabled:C,type:"number",value:A,style:{width:75,textAlign:"end"},onChange:e=>T(parseInt(e.target.value))}),onClick:()=>{}},{label:(0,g.jsxs)("select",{disabled:C,value:x,onChange:e=>{k(e.target.value)},children:[(0,g.jsx)("option",{value:"seconds",children:"seconds"}),(0,g.jsx)("option",{value:"minutes",children:"minutes"}),(0,g.jsx)("option",{value:"hours",children:"hours"}),(0,g.jsx)("option",{value:"days",children:"days"}),(0,g.jsx)("option",{value:"months",children:"months"}),(0,g.jsx)("option",{value:"years",disabled:"year"!==_,children:"years"})]}),onClick:()=>{}},{label:"Advance clock",onClick:()=>B()},{label:C?(0,g.jsx)("img",{src:u().A.images.clubPenguinDanceGif,alt:"loading...",style:{width:48}}):(0,g.jsx)("div",{style:{width:48}}),onClick:()=>{}}];return(0,g.jsx)(y().l,{label:M,display:"full-width",actions:K,tint:(0,v().V)(n)})}function w(){var e;const n=(0,s().r)(),t=(0,l().lh)({spaceId:n}),a=(0,d().Fq)(t)&&(null==t||null===(e=t.clock)||void 0===e?void 0:e.externalId);o.useEffect((()=>(a?b().HQ({bannerStore:_().A,id:"TestClockBanner",contentKey:"test_clock",styleKey:v().q.Yellow,prepend:!0}):b().zA({bannerStore:_().A,id:"TestClockBanner"}),()=>{b().zA({bannerStore:_().A,id:"TestClockBanner"})})),[a])}function h(e){}}}]);