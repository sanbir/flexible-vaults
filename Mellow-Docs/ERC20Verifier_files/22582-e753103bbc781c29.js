"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[22582,59042],{4688:(e,t,n)=>{n.r(t),n.d(t,{arrowStraightUpSmallIcon:()=>o,iconDefinition:()=>r});n(296540);const r={viewBox:"0 0 16 16",fittedViewBox:"3.05 2.12 9.9 11.76",svg:(0,n(474848).jsx)("path",{d:"M8.442 2.308a.625.625 0 0 0-.884 0l-4.32 4.32a.625.625 0 0 0 .884.884l3.253-3.253v9.017c0 .334.283.599.625.599a.61.61 0 0 0 .625-.599V4.26l3.253 3.253a.625.625 0 0 0 .884-.884z"})},o=(0,n(340498).wt)("arrowStraightUpSmall",r,"small")},33642:(e,t,n)=>{n.d(t,{YL:()=>o,qO:()=>r});const r=10,o=10},43972:(e,t,n)=>{n.d(t,{w:()=>l});n(296540);var r=()=>n(764880),o=()=>n(534177),i=()=>n(256863),a=()=>n(453697),s=n(474848);function l(e){const{actor:t}=e,n={size:e.size??14,style:{marginInlineEnd:2,...e.style}};return(0,r().H3)(t)?(0,s.jsx)(i().A,{botValue:t.asActor,...n}):(0,r().ps)(t)?(0,s.jsx)(a().A,{userValue:t.asActor,...n}):(0,r().h2)(t)?(0,s.jsx)(a().A,{userValue:void 0,...n}):void(0,o().HB)(t)}},51367:(e,t,n)=>{n.d(t,{Cu:()=>p,DL:()=>a,Jb:()=>d,Sq:()=>l,Y5:()=>s,gc:()=>u,wo:()=>c});var r=()=>n(564884),o=()=>n(917629),i=()=>n(866727);function a(e,t){const n=(0,o().h2)(t.callout_key);n&&(t.placement_key=(0,o().t9)(n)),(0,r().u)({environment:e,event:{eventName:"callout_show",eventProperties:{...t,callout_src:n?"static":"cio"}}})}function s(e,t){const n=(0,o().h2)(t.callout_key);n&&(t.placement_key=(0,o().t9)(n)),(0,r().u)({environment:e,event:{eventName:"callout_click",eventProperties:{...t,callout_src:n?"static":"cio"}}}),t.callout_key&&i().l.trackEvent("callout_click",{callout_key:t.callout_key,click_type:t.click_type,placement_key:t.placement_key})}function l(e,t){const n=(0,o().h2)(t.callout_key);n&&(t.placement_key=(0,o().t9)(n)),(0,r().u)({environment:e,event:{eventName:"callout_dismiss",eventProperties:{...t,callout_src:n?"static":"cio"}}})}function d(e,t){const n=(0,o().h2)(t.callout_key);n&&(t.placement_key=(0,o().t9)(n)),(0,r().u)({environment:e,event:{eventName:"callout_engagement",eventProperties:{...t,callout_src:n?"static":"cio"}}})}function c(e,t){const{eligible_callouts:n,required_arg_timeout:o,required_args_run_duration:i,eligibility_timeouts:a,blocklist:s}=t;(0,r().u)({environment:e,event:{eventName:"callout_coordinator_resolved",eventProperties:{eligible_callouts:n,required_arg_timeout:o,required_args_run_duration:i,eligibility_timeouts:a,blocklist:s}}})}function u(e,t){(0,r().u)({environment:e,event:{eventName:"callout_feature_interaction",eventProperties:t}})}function p(e,t){(0,r().u)({environment:e,event:{eventName:"callout_skipped",eventProperties:t}})}},51700:(e,t,n)=>{n.d(t,{SZ:()=>k,UO:()=>T,lx:()=>M});n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(354520),n(803949),n(581454);var r=n(296540),o=()=>n(907258),i=()=>n(755531),a=()=>n(726637),s=()=>n(484714),l=()=>n(590526),d=()=>n(723085),c=()=>n(710515),u=()=>n(737693),p=()=>n(854150),m=()=>n(245241),h=()=>n(69708),g=()=>n(187820),f=()=>n(848401),y=()=>n(297401),v=()=>n(852711),b=()=>n(957606),x=()=>n(106628),S=()=>n(51781),w=()=>n(322976),I=n(474848);function k({mode:e,title:t,teamIds:n,onChange:r,disabled:o,focused:i,onMenuDismiss:a,onMenuOpen:l,parentStore:d}){const c=(0,s().v3)(),p=(0,h().tz)(),g=(0,m().fg)(n);return(0,I.jsx)(w().A,{mode:e,title:t,icon:u().V,items:g||[],onChange:r,disabled:o,focused:i,renderFilter:(e,t)=>(0,I.jsx)(_,{item:e,args:t,parentStore:d}),renderToken:(e,t)=>(0,I.jsx)(B,{item:e,handlers:t,teamIds:n,parentStore:d}),renderItemForSummary:e=>(0,I.jsx)(j,{item:e,parentStore:d}),addItemLabel:(0,I.jsx)(h().sA,{defaultMessage:"Add a teamspace",id:"search.filterMenu.addATeamButton.label"}),labelText:{title:t,tokenInputPlaceholder:p.formatMessage({defaultMessage:"Search teamspaces",id:"search.filterMenu.searchTeams.placeholder"}),componentDebugName:"SearchTeamFilter"},performRequest:e=>M(e,c),renderResultMenuItem:(e,t)=>(0,I.jsx)(A,{item:e,props:t,parentStore:d}),onMenuDismiss:a,onMenuOpen:l,hasItemsSelected:Boolean(g&&(null==g?void 0:g.length)>0)})}const T=20;async function M({query:e,current:t},n){var r;const a=new Set(t),s=o().default.state.sidebarSpaceViewStore,l=(0,i().S)(),d=null===(r=o().default.state.currentUserStore)||void 0===r?void 0:r.id;if(!s||!l||!d)return[];const u=await(0,S().getActiveTeamsMetadataForUserInSpace)({userId:d,spaceStore:l,environment:n}),p=(0,b().dT)({spaceStore:l,teams:u}).map((e=>e.store));if(!e){const e=new Set((0,c().r)(s).map((e=>e.id)));if(p.map((e=>e.id)).forEach((t=>e.add(t))),e.size>0)return[...e]}const m=await x().T.searchActions.load();return(await m.searchTeams({query:e,spaceViewStore:s,teamStores:p})).filter((e=>!a.has(e.id))).slice(0,T).map((e=>e.id))}function C(e,t){return d().h.createChildStore(t,{table:p().yK,id:e})}function j({item:e,parentStore:t}){return(0,I.jsx)(I.Fragment,{children:C(e,t).getName()})}function A({item:e,props:t,parentStore:n}){const o=C(e,n);return(0,r.createElement)(v().A,{...t,key:e,teamStore:o})}function B({item:e,handlers:t,teamIds:n,parentStore:r}){const o=(0,m().fg)(n),i=1===(null==o?void 0:o.length),s=(0,l().K8)((()=>C(e,r)),[e,r]),d=(0,l().K8)((()=>s.getName()),[s]),c=(0,l().K8)((()=>function(e){const t=e.getIcon();return function(e){return(0,I.jsx)(g().B6,{disabled:!0,icon:t,iconRecordCategory:"teamspace",isEmptyPage:!1,size:e})}}(s)),[s]);return s?(0,I.jsx)(f().Ay,{format:a().A.isMobile?f().mI.Large:f().mI.Small,showRemoveButton:!0,isSingle:i,onClickRemove:t.onRemove,renderAvatar:c,title:d,style:{background:"transparent"}}):null}function _({item:e,args:t,parentStore:n}){const{disabled:r,onRemove:o,onClick:i}=t,s={menuItem:{minHeight:void 0,paddingTop:a().A.isMobile?12:4,paddingBottom:a().A.isMobile?12:4},menuItemTitle:{width:"100%"},labeledMenuItemTitle:{display:"inline-flex",alignItems:"center"},menuItemLabel:{marginInlineEnd:12}},l=C(e,n),d=(0,I.jsx)(y().A,{disabled:r,onClick:o});return(0,I.jsx)(v().A,{disabled:r,focused:!1,teamStore:l,right:d,style:s.menuItem,desktopTitleStyle:s.menuItemTitle,onClick:i},e)}},93723:(e,t,n)=>{function r(e){return e>=1e5?"100k-or-more":e>=5e4?"50k-100k":e>=1e4?"10k-50k":e>=5e3?"5k-10k":e>=1e3?"1k-5k":e>=500?"500-1k":e>=100?"100-500":e>=1?"1-100":"0"}n.d(t,{P:()=>r})},104556:(e,t,n)=>{n.d(t,{_:()=>o});n(296540);const r={viewBox:"0 0 20 20",fittedViewBox:"2.06 3.15 15.88 15.65",svg:(0,n(474848).jsx)("path",{d:"M7.793 18.678a1.91 1.91 0 0 0 2.33-.838l.348-.715c.177-.293.36-.658.535-1.005l.13-.257c.225-.442.431-.822.627-1.08l2.164-2.306h2.41a1.6 1.6 0 0 0 1.6-1.6V5.74a1.6 1.6 0 0 0-1.6-1.6H13.03l-1.227-.42-.021-.011a5.2 5.2 0 0 0-2.347-.553H5.126a1.844 1.844 0 0 0-1.78 2.32 1.84 1.84 0 0 0-.922 1.6c0 .284.067.547.18.78-.333.327-.54.782-.54 1.297 0 .429.145.817.388 1.124-.17.27-.272.592-.272.943 0 1.018.826 1.844 1.844 1.844h3.783c-.069.167-.15.33-.242.516v.001a6 6 0 0 0-.417 1.004v.002L6.64 16.36a1.913 1.913 0 0 0 1.144 2.315zm1.567-2.126-.345.71a.66.66 0 0 1-.781.247.66.66 0 0 1-.393-.804l.507-1.773v-.001c.08-.276.195-.512.336-.797l.014-.028c.134-.27.292-.59.408-.97a1.03 1.03 0 0 0-.988-1.323H4.023a.594.594 0 0 1-.593-.594.56.56 0 0 1 .27-.47.625.625 0 0 0-.066-1.086.56.56 0 0 1-.321-.511c0-.255.157-.467.398-.55a.625.625 0 0 0 .192-1.074.59.59 0 0 1-.23-.453c0-.334.263-.594.584-.594a.625.625 0 0 0 .452-1.057.594.594 0 0 1 .416-1.02h4.31c.593 0 1.17.13 1.703.381a.6.6 0 0 0 .161.083l1.424.488a.6.6 0 0 0 .202.033h.181v6.136l-2.275 2.425-.037.043c-.286.367-.547.86-.772 1.303l-.147.29c-.177.352-.334.665-.486.912zm4.846-5.324v-5.84h2.131a.35.35 0 0 1 .35.35v5.139a.35.35 0 0 1-.35.35z"})},o=(0,n(340498).wt)("handThumbsDown",r,"default")},109158:(e,t,n)=>{n.r(t),n.d(t,{iconDefinition:()=>o,notionFlatTintableIcon:()=>i});n(296540);var r=n(474848);const o={viewBox:"0 0 20 20",fittedViewBox:"1.5 1.49 17 17.01",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{d:"M12.475 11.304V6.65l-1.306-.25a.8.8 0 0 1 .152-.639q.21-.278.667-.278h2.738q.111.291-.014.528-.111.236-.43.375l-.446.208v7.809q-.39.18-.597.236a2 2 0 0 1-.514.056q-.417 0-.75-.195a2 2 0 0 1-.612-.597L7.542 8.497v4.864l1.39.25a.84.84 0 0 1-.153.653q-.208.277-.667.277-.292 0-.806-.013a35 35 0 0 0-.931-.014q-.361 0-.68.014-.306 0-.418.013a1 1 0 0 1-.056-.306q.001-.193.098-.36.112-.166.375-.264l.487-.195V6.538l-.875-.18q-.056-.375.152-.625t.667-.25H8.39z"}),(0,r.jsx)("path",{d:"M11.7 1.498c2.38 0 3.57 0 4.48.463.8.408 1.45 1.058 1.857 1.858.463.909.463 2.099.463 4.48v3.4c0 2.38 0 3.57-.463 4.479a4.25 4.25 0 0 1-1.857 1.857c-.91.464-2.1.463-4.48.463H8.3c-2.38 0-3.57 0-4.48-.463a4.25 4.25 0 0 1-1.857-1.857c-.463-.91-.463-2.1-.463-4.48v-3.4c0-2.38 0-3.57.463-4.48A4.25 4.25 0 0 1 3.82 1.962c.91-.463 2.1-.463 4.48-.463zM8.3 2.86c-1.213 0-2.04.001-2.68.053-.625.051-.95.144-1.182.261a2.9 2.9 0 0 0-1.262 1.263c-.118.23-.21.556-.261 1.18-.052.64-.054 1.469-.054 2.681v3.4c0 1.213.002 2.04.054 2.681.051.624.143.95.26 1.18a2.9 2.9 0 0 0 1.263 1.264c.231.117.557.21 1.181.26.64.053 1.468.054 2.68.054H11.7c1.213 0 2.04-.001 2.68-.054.625-.05.951-.143 1.181-.26.544-.277.986-.72 1.263-1.263.118-.23.21-.557.261-1.18.052-.641.054-1.469.054-2.682v-3.4c0-1.212-.002-2.04-.054-2.68-.051-.625-.143-.95-.26-1.181a2.9 2.9 0 0 0-1.263-1.263c-.231-.117-.557-.21-1.181-.26-.64-.053-1.468-.054-2.68-.054z"})]})},i=(0,n(340498).wt)("notionFlatTintable",o,"tintable")},112665:(e,t,n)=>{n.r(t),n.d(t,{badgeCheckIcon:()=>i,iconDefinition:()=>o});n(296540);var r=n(474848);const o={viewBox:"0 0 20 20",fittedViewBox:"1.57 1.57 16.86 16.86",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{d:"M12.806 8.074a.625.625 0 1 0-1.072-.643l-2.512 4.185-1.407-1.642a.625.625 0 1 0-.95.814l1.973 2.3a.625.625 0 0 0 1.01-.085z"}),(0,r.jsx)("path",{d:"M10.405 1.724a.625.625 0 0 0-.81 0L7.36 3.628l-2.926.233a.625.625 0 0 0-.573.574L3.628 7.36 1.724 9.595a.624.624 0 0 0 0 .81l1.904 2.234.233 2.926a.625.625 0 0 0 .574.573l2.926.234 2.234 1.904a.624.624 0 0 0 .81 0l2.234-1.904 2.926-.234a.625.625 0 0 0 .573-.573l.234-2.926 1.904-2.234a.624.624 0 0 0 0-.81L16.372 7.36l-.234-2.926a.625.625 0 0 0-.573-.573l-2.926-.234zM8.017 4.711 10 3.02l1.983 1.69c.1.085.224.136.355.147l2.597.207.207 2.597c.01.13.062.255.147.355L16.98 10l-1.69 1.983a.63.63 0 0 0-.147.355l-.207 2.597-2.597.207a.63.63 0 0 0-.355.147L10 16.98l-1.983-1.69a.63.63 0 0 0-.355-.147l-2.597-.207-.207-2.597a.63.63 0 0 0-.147-.355L3.02 10l1.69-1.983a.63.63 0 0 0 .147-.355l.207-2.597 2.597-.207a.63.63 0 0 0 .355-.147"})]})},i=(0,n(340498).wt)("badgeCheck",o,"default")},114912:(e,t,n)=>{n.d(t,{_:()=>c});n(296540);var r=()=>n(726637),o=()=>n(718827),i=()=>n(807449),a=()=>n(302501),s=()=>n(324254),l=()=>n(424400),d=n(474848);function c(e){return(0,d.jsx)(o().Ay,{onClick:e.onClick,hovered:e.focused,disabled:e.disabled,style:{width:"100%",...!r().A.isMobile&&{borderRadius:6},...e.buttonStyle},hoveredStyle:e.hoveredButtonStyle,pressedStyle:e.pressedButtonStyle,children:(0,d.jsx)(l().Ay,{...e,dontShrinkTitle:!0,right:(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center",whiteSpace:"nowrap",gap:4},children:[e.right?(0,d.jsx)(a().A,{isSecondaryColor:!0,children:e.right}):void 0,r().A.isMobile?void 0:(0,d.jsx)("div",{style:{flexShrink:0,transform:"right"===e.chevronType?"rotate(calc(var(--direction, 1) * -90deg))":void 0,transition:"transform 0.2s ease"},children:(0,d.jsx)(i().I,{icon:s().arrowChevronSingleDownSmallIcon,size:"xs",colorVariant:"tertiary"})})]})})})}},117219:(e,t,n)=>{n.d(t,{Cy:()=>M,iK:()=>T,qT:()=>C});n(898992),n(354520),n(581454);var r=n(296540),o=()=>n(212497),i=()=>n(560198),a=()=>n(484714),s=()=>n(401497),l=()=>n(79926),d=()=>n(882722),c=()=>n(695115),u=()=>n(26697),p=()=>n(302501),m=()=>n(951105),h=()=>n(187881),g=()=>n(176412),f=()=>n(564613),y=()=>n(558842),v=()=>n(69708),b=()=>n(100622),x=()=>n(496603),S=()=>n(284371),w=()=>n(354584),I=n(474848);const k=(0,v().YK)({copyColor:{defaultMessage:"Copied â€˜{stringValue}â€™",id:"uidoc.colors.copied"}});function T({children:e,style:t}){const n=(0,s().IS)((()=>({subheader:{fontSize:24,fontWeight:S().Wy.semibold,marginTop:36,marginBottom:8,lineHeight:1,...t}})),[t]);return(0,I.jsx)("div",{style:n.subheader,children:e})}function M({children:e,style:t,scrollContentRef:n}){const i=function(){const e=(0,a().v3)();return(0,r.useCallback)((async t=>{const n=t.length>N?`${t.slice(0,N)}...`:t;(await(0,o().jd)())({copiedMessage:{...k.copyColor,defaultMessage:`Copied '${n}'`},environment:e,stringValue:t})}),[e])}(),[d,u]=(0,r.useState)(!1),p=(0,r.useRef)(null),{value:h}=(0,l().fJ)(w().y),{renderChildren:g,githubUrl:y}=(0,r.useMemo)((()=>{if(P(e)){var t;const n=`https://github.com/makenotion/notion-next/tree/main/${e.fileName}#L${(null===(t=e.start)||void 0===t?void 0:t.line)??"1"}`;return{renderChildren:(e.source&&function(e){const t=e.split("\n"),n=t.map((e=>{var t;return(null===(t=e.match(/^\s*/))||void 0===t?void 0:t[0])??""})).filter(((e,t)=>""!==e&&0!==t));if(0===n.length)return e;const r=x().wq(n,(e=>e.length));if(!r||0===r.length)return e;return t.map((e=>e.startsWith(r)?e.slice(r.length):e)).join("\n")}(e.source))??e.source??e.value,githubUrl:n}}return{renderChildren:e}}),[e]),S=(0,s().IS)((()=>({code:{fontSize:"80%",fontFamily:"monospace",color:b().Tj.text.primary,borderRadius:"0.25em",background:"rgba(135, 131, 120, 0.15)",padding:"0.2em 0.4em",position:"relative",tabSize:2,margin:0,...t},buttonBar:{position:"absolute",insetInlineEnd:2,top:2,display:"flex",gap:4},button:{width:"1.55em",height:"1.55em"}})),[t]);(0,r.useLayoutEffect)((()=>{var t;const n="string"==typeof e?e:null===(t=p.current)||void 0===t?void 0:t.innerText;if(h&&n&&p.current){const e="tsx",t=h.highlight(n,h.languages[e],e);p.current.innerHTML=t}}));const T=(0,v().tz)();return(0,I.jsxs)("pre",{onMouseEnter:()=>{u(!0)},onMouseLeave:()=>{u(!1)},style:S.code,ref:n,children:[(0,I.jsx)("div",{ref:p,children:g}),d?(0,I.jsxs)("div",{style:S.buttonBar,children:[y?(0,I.jsx)(c().A,{ariaLabel:T.formatMessage({id:"uidoc.code.openInGithub",defaultMessage:"Open in Github"}),style:S.button,hasBackground:!0,icon:f().gitHubIcon,showShadow:!0,href:y,external:!0}):void 0,(0,I.jsx)(c().A,{ariaLabel:T.formatMessage({id:"uidoc.code.copy",defaultMessage:"Copy code"}),style:S.button,hasBackground:!0,icon:m().k,showShadow:!0,onClick:()=>{i((null==g?void 0:g.toString())||"")}})]}):void 0]})}function C(e){const[t,n]=(0,r.useState)(!1),[o,i]=(0,r.useState)(e.showTransparency??!1),a=e.showTransparencyToggle??t,l=(0,s().IS)((()=>({container:{position:"relative"},toggleButton:{position:"absolute",top:16,insetInlineEnd:14}})),[]);return(0,I.jsxs)("div",{onMouseEnter:()=>{n(!0)},onMouseLeave:()=>{n(!1)},style:l.container,children:[(0,I.jsx)(j,{marginTopBottom:e.marginTopBottom,isInverted:e.isInverted,showTransparency:o,children:(0,I.jsx)(A,{showSize:!!e.showSize&&t,showInsets:!!e.showInsets&&t,insetSize:24,children:(0,I.jsx)(_,{isInverted:e.isInverted,children:e.children})})}),a?(0,I.jsx)("div",{style:l.toggleButton,children:(0,I.jsx)(u().m,{renderTooltip:()=>o?"Hide transparency":"Show transparency",render:e=>(0,I.jsx)(c().A,{...e,icon:o?g().L:h().eyeFillIcon,size:"sm",ariaLabel:"Toggle transparency",onClick:()=>i(!o),hasBackground:!0,showShadow:!0})})}):null]})}function j(e){const{marginTopBottom:t,showTransparency:n}=e,o=(0,s().DP)(),i=B(),a=e.isInverted?i:o,l=(0,r.useMemo)((()=>({borderRadius:4,overflow:"hidden",border:`1px solid ${b().Tj.border.secondaryTranslucent}`,background:n?`repeating-conic-gradient(${a.background.primary} 0 25%, ${a.background.tertiary} 0 50%) 50% / 20px 20px`:a.background.primary,marginTop:t??12,marginBottom:t??12,color:a.text.primary})),[a,n,t]);return(0,I.jsx)("div",{className:"dark"===a.mode?d().Rsl:d().fRh,style:l,children:e.children})}function A(e){const{showInsets:t,showSize:n,insetSize:o,children:i}=e,a=(0,r.useRef)(null),l=(0,s().IS)((()=>{const e=t?"rgba(255, 105, 180, 1)":"rgba(255, 105, 180, 0)",n=`1px dashed ${e}`,r=`${o}px`,i="all 0.1s ease-in-out",a={t:{borderBottom:n,transition:i},l:{borderInlineEnd:n,transition:i},r:{borderInlineStart:n,transition:i},b:{borderTop:n,transition:i,position:"relative"}};return{grid:{display:"grid",gridTemplateColumns:`${r} auto ${r}`,gridTemplateRows:`${r} auto ${r}`,...a.t,...a.l,...a.r,...a.b},...a,tl:{...a.t,...a.l},tr:{...a.t,...a.r},bl:{...a.b,...a.l},br:{...a.b,...a.r},c:{position:"relative"},insetText:{color:e,fontSize:10,paddingInlineStart:(o-10)/2,fontFamily:S().Tf.githubMono,lineHeight:r,maxHeight:o,transition:i,position:"absolute"}}}),[t,o]);return(0,I.jsxs)("div",{style:l.grid,children:[(0,I.jsx)("div",{style:l.tl}),(0,I.jsx)("div",{style:l.t}),(0,I.jsx)("div",{style:l.tr}),(0,I.jsx)("div",{style:l.l}),(0,I.jsx)("div",{style:l.c,ref:a,children:i}),(0,I.jsx)(u().m,{forceVisibleState:n??t,renderTooltip:()=>{var e;return`${null===(e=a.current)||void 0===e?void 0:e.getBoundingClientRect().height}px`},placement:"right",render:()=>(0,I.jsx)("div",{style:l.r})}),(0,I.jsx)("div",{style:l.bl}),(0,I.jsx)(u().m,{placement:"bottom",forceVisibleState:n??t,renderTooltip:()=>{var e;return`${null===(e=a.current)||void 0===e?void 0:e.getBoundingClientRect().width}px`},render:()=>(0,I.jsx)("div",{style:l.b,children:(0,I.jsx)(p().A,{style:l.insetText,children:`${o}px inset`})})}),(0,I.jsx)("div",{style:l.br})]})}function B(){const e=(0,s().eP)();return(0,b().O4)({theme:"light"===e?"dark":"light"})}function _({children:e,isInverted:t}){const{mode:n}=B();return t?(0,I.jsx)(i().wX,{mode:n,children:e}):(0,y().Du)(e)}const N=25;function P(e){return Boolean(e&&"object"==typeof e&&("isSourceMacroResult"in e||"value"in e&&"source"in e))}const R=(0,r.createContext)(!1);R.displayName="UIDocExpandAllCode"},127720:(e,t,n)=>{n.d(t,{A:()=>T});var r=n(296540),o=()=>n(484714),i=()=>n(590526),a=()=>n(401497),s=()=>n(75435),l=()=>n(807449),d=()=>n(26697),c=()=>n(148307),u=()=>n(513402),p=()=>n(109158),m=()=>n(69708),h=()=>n(100622),g=()=>n(284371),f=()=>n(222917),y=()=>n(383070),v=()=>n(35392),b=()=>n(414706),x=()=>n(91232),S=()=>n(115512),w=()=>n(563253),I=()=>n(905487),k=n(474848);function T(){const e=(0,o().v3)(),t=(0,m().tz)(),n=(0,o().Y0)().isElectron,d=(0,a().IS)((()=>({listStyle:{...S().$t,...g().RC,display:"inline-flex",alignItems:"center",fontSize:S().Kw,color:h().Tj.text.tertiary,gap:20},inlineHint:{display:"flex",gap:6,alignItems:"center",height:"max-content"}})),[]),c=(0,i().K8)((()=>{var t;const n=null===(t=s().A.state.preferences)||void 0===t?void 0:t.isQuickSearchEnabled;return e.device.isElectron&&n}),[e.device.isElectron]),p=(0,r.useCallback)((()=>{(I().default.state.open||I().default.state.openAsPage)&&f().$n(e,{searchSessionId:I().default.state.sessionId})}),[e]),w=e.device.isMac,T=(0,i().K8)((()=>!y().zD.isSearchModalV2Enabled()),[]);return(0,k.jsxs)("ul",{style:d.listStyle,children:[T?(0,k.jsxs)("li",{style:d.inlineHint,children:[(0,k.jsx)(l().I,{icon:u().arrowUpDownSmallIcon,size:"xxs",colorVariant:"secondary"}),t.formatMessage({id:"searchFooter.helpText.selectHint",defaultMessage:"Select"})]}):void 0,T?(0,k.jsxs)("li",{style:d.inlineHint,children:[(0,k.jsx)(b().z,{shortcut:{enter:!0}}),t.formatMessage({id:"searchFooter.helpText.openHint",defaultMessage:"Open"})]}):void 0,(0,k.jsxs)("li",{style:d.inlineHint,children:[w?(0,k.jsx)(b().z,{shortcut:{command:!0,enter:!0}}):(0,k.jsx)(v().A,{name:"commandEnter"}),t.formatMessage({id:"searchFooter.helpText.newTab",defaultMessage:"Open in new tab"})]}),n?(0,k.jsxs)("li",{style:d.inlineHint,children:[w?(0,k.jsx)(b().z,{shortcut:{command:!0,key:"L"}}):(0,k.jsx)(v().A,{name:"copyLinkToCurrentPage"}),t.formatMessage({id:"searchFooter.helpText.copyLink",defaultMessage:"Copy link"})]}):void 0,c?(0,k.jsx)("li",{style:d.inlineHint,onClick:()=>{p(),(0,x().S)()},children:(0,k.jsx)(M,{environment:e,containerStyles:d.inlineHint})}):void 0]})}function M(e){const{environment:t,containerStyles:n}=e,[o,l]=(0,r.useState)(!1),c=(0,a().IS)((()=>({container:{...n,cursor:"pointer"},commandSearchHint:{display:"flex",alignItems:"center"},commandText:{padding:"2px 4px",borderRadius:4,background:o?h().Tj.buttonHoveredBackground:void 0},hintAndBadgeContainer:{display:"flex",gap:3,alignItems:"center",width:"max-content"},tooltip:{background:"transparent",boxShadow:"none"}})),[n,o]),u=t.device.isMac,p=(0,m().tz)(),{commandSearchShortcut:g,commandSearchShortcutToString:y}=(0,i().K8)((()=>{var e;const t=null===(e=s().A.state.preferences)||void 0===e?void 0:e.quickSearchShortcut;if(!t)return{commandSearchShortcut:void 0,commandSearchShortcutToString:void 0};const n=(0,w().z_)(t,u);return{commandSearchShortcut:n,commandSearchShortcutToString:(0,w().Vd)(n,u)}}),[u]),v=(0,r.useCallback)((()=>{(I().default.state.open||I().default.state.openAsPage)&&f().WF(t,{searchSessionId:I().default.state.sessionId})}),[t]);return(0,k.jsx)(d().m,{delayThreshold:400,placement:"bottom",originGap:8,disableTooltip:!u,renderTooltip:()=>(v(),(0,k.jsx)(C,{shortcut:y})),closeDelay:0,style:c.tooltip,render:e=>(0,k.jsxs)("div",{...e,style:c.container,onClick:()=>(0,x().S)(),onMouseEnter:t=>{e.onMouseEnter&&e.onMouseEnter(t),o||l(!0)},onMouseLeave:t=>{e.onMouseLeave&&e.onMouseLeave(t),o&&setTimeout((()=>{l(!1)}),200)},children:[(0,k.jsx)("span",{style:c.commandText,children:u?(0,k.jsx)(b().z,{shortcut:g}):y}),(0,k.jsx)("div",{style:c.commandSearchHint,children:o?(0,k.jsx)("span",{children:p.formatMessage({id:"searchFooter.commandSearch.editText",defaultMessage:"Click to edit shortcut"})}):(0,k.jsx)("div",{style:c.hintAndBadgeContainer,children:p.formatMessage({id:"searchFooter.commandSearch.defaultText",defaultMessage:"Command Search"})})})]})})}function C(e){const{shortcut:t}=e,n=c().A.images.commandSearch.tooltipPng,[o,i]=(0,r.useState)(!1);(0,r.useEffect)((()=>{const e=new Image;e.src=n,e.onload=()=>{i(!0)}}),[n]);const s=(0,a().eP)(),l=(0,a().IS)((()=>({container:{width:260,borderRadius:8,backgroundColor:"transparent"},textContainer:{whiteSpace:"break-spaces",padding:15,display:"flex",flexDirection:"column",gap:1,backgroundColor:"light"===s?h().Tj.palette.gray[700]:h().Tj.palette.gray[300],borderStartEndRadius:8,borderStartStartRadius:8},description:{fontWeight:g().Wy.regular,color:h().Tj.text.inverseSecondary},image:{width:"100%"}})),[s]);return o?(0,k.jsxs)("div",{style:l.container,children:[(0,k.jsxs)("div",{style:l.textContainer,children:[(0,k.jsx)("div",{children:(0,k.jsx)(m().sA,{id:"searchFooter.commandSearch.tooltip.header",defaultMessage:"Use search and Q&A anywhere"})}),(0,k.jsx)("div",{style:l.description,children:(0,k.jsx)(m().sA,{id:"searchFooter.commandSearch.tooltip.description",defaultMessage:"Try {shortcut} or click on {menuBarIcon} in your menubar to access search and Ask AI anytime, even with Notion minimized.",values:{shortcut:t,menuBarIcon:(0,k.jsx)(j,{})}})})]}),(0,k.jsx)("img",{style:l.image,src:n})]}):null}function j(){const e=(0,a().IS)((()=>({container:{display:"inline-block",position:"relative"},placeholder:{width:15,height:15,display:"inline-block"},flatMenuIcon:{position:"absolute",insetInlineStart:0,top:3}})),[]);return(0,k.jsxs)("div",{style:e.container,children:[(0,k.jsx)("span",{style:e.placeholder}),(0,k.jsx)("span",{style:e.flatMenuIcon,children:(0,k.jsx)(l().I,{icon:p().notionFlatTintableIcon,colorVariant:"inverseSecondary",size:"sm"})})]})}},148080:(e,t,n)=>{n.d(t,{g:()=>m,x:()=>p});n(581454);var r=n(296540),o=()=>n(726637),i=()=>n(401497),a=()=>n(736847),s=()=>n(245241),l=()=>n(69708),d=()=>n(428343),c=()=>n(933593),u=n(474848);function p(e){const{onSelect:t}=e,n=(0,l().tz)(),p=(0,d().Q)({filterCategory:"all",availableOffline:!0,searchQuery:""}),h=(0,i().IS)((()=>({sectionHeader:{marginBottom:"8px"},section:{marginBottom:"4px"}})),[]),g=(0,r.useCallback)(((e,n)=>{t({index:{local:e.indexLocal,global:e.index},event:e.event,selectedResult:{store:n,id:n.id,score:-1,spaceId:n.getSpaceId(),sources:[s().Ni.Local],featureGroups:[],originalPosition:0,serverEventProperties:void 0},fromSidePeekPanel:!1,context:"offline_pages"})}),[t]),f=(0,r.useMemo)((()=>{const e=p.sort(((e,t)=>t.lastModifiedTime-e.lastModifiedTime)).map((({pageBlockStore:e})=>({key:e.id,action:t=>g(t,e),render:t=>(0,r.createElement)(c().GC,{...t,store:e,inline:!o().A.isMobile,hidePath:!1,buttonStyle:{paddingInlineStart:1},type:"offline_pages",key:e.id})})));return[{key:"offline_pages",items:e,render:e=>(0,u.jsx)(a().A,{desktopTitleStyle:h.sectionHeader,style:h.section,title:n.formatMessage(m.offlinePages),children:e.children})}]}),[p,g,h.sectionHeader,h.section,n]);return f}const m=(0,l().YK)({offlinePages:{id:"search.default_page_body.offline_pages",defaultMessage:"Offline pages"}})},160907:(e,t,n)=>{n.d(t,{f:()=>a});var r=()=>n(907258),o=()=>n(755531),i=()=>n(712505);function a(){if(i().default.state.open)return i().default.state.targetStore;return r().default.state.mainEditorCurrentBlockStore??(0,o().S)()}},174192:(e,t,n)=>{n.d(t,{e:()=>O});n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(803949),n(737550);var r=n(296540),o=()=>n(564884),i=()=>n(920198),a=()=>n(933922),s=()=>n(726637),l=()=>n(484714),d=()=>n(852507),c=()=>n(590526),u=()=>n(401497),p=()=>n(675133),m=()=>n(560729),h=()=>n(792057),g=()=>n(128933),f=()=>n(94484),y=()=>n(420802),v=()=>n(31511),b=()=>n(406094),x=()=>n(160432),S=()=>n(302501),w=()=>n(245241),I=()=>n(201980),k=()=>n(69708),T=()=>n(100622),M=()=>n(284371),C=()=>n(769864),j=()=>n(383070),A=()=>n(660571),B=()=>n(798693);n(581454);function _(e){if(void 0===e)return[];return e.map((e=>({id:e.id,score:e.score,localSource:e.localSource,sources:e.sources,spaceId:e.spaceId,rankingSignals:e.rankingSignals??{}})))}var N=()=>n(702473),P=()=>n(287234),R=n(474848);const E=(0,k().YK)({additionalInformationPlaceholder:{id:"SearchBadResultsForm.additionalInformation.placeholder",defaultMessage:"What went wrong with this search? Please be as specific as possible."},additionalInformationPositivePlaceholder:{id:"SearchGoodResultsForm.additionalInformation.placeholder",defaultMessage:"What went well with this search? Please be as specific as possible."},submitFailed:{id:"SearchBadResultsForm.submitFailed",defaultMessage:"Failed to submit report"},submitSuccess:{id:"SearchBadResultsForm.submitSuccess",defaultMessage:"Your report has been submitted, thanks!"},title:{id:"SearchBadResultsForm.title",defaultMessage:"Give search feedback"},warning:{id:"SearchBadResultsForm.warning",defaultMessage:"The pages from the search results, the search query, and the feedback will be sent to Notion for quality improvement."},cancel:{id:"SearchBadResultsForm.cancel",defaultMessage:"Cancel"},submit:{id:"SearchBadResultsForm.submit",defaultMessage:"Submit"},urlPlaceholder:{id:"SearchBadResultsForm.url.placeholder",defaultMessage:"Link to page you were looking for..."},additionalInformationWarning:{id:"SearchBadResultsForm.additionalInformation.warning",defaultMessage:"The details you provided are too similar to your search keywords. To help us understand the issue, please describe what went wrong."},checkboxLabel:{id:"SearchBadResultsForm.followUpCheckbox",defaultMessage:"Allow Notion to contact me by email to follow up regarding this search"}});function O(e){const t=(0,l().v3)(),n=(0,k().tz)();(0,d().w)((()=>{(0,o().u)({environment:t,event:{eventName:"report_bad_search_modal_open",eventProperties:{}}})}));const[O]=(0,r.useState)(P().Ay),q=(0,i().L)(),[L,K]=(0,c().$y)(N().A),[z,V]=(0,r.useState)(""),[U,H]=(0,r.useState)(!1),[W,$]=(0,r.useState)(true),G=(0,r.useCallback)((()=>{(0,o().u)({environment:t,event:{eventName:"report_bad_search_submit",eventProperties:{}}}),W&&(0,o().u)({environment:t,event:{eventName:"report_bad_search_allow_follow_up",eventProperties:{}}}),function({serverResults:e,localResults:t,exposedSearchExperiments:n,debugInfo:r,productSurface:o,environment:i,allowFollowUp:a,searchStoreState:s,spaceStore:l}){var d,c,u;const m=N().A.getState(),y=_(e),v=_(t),b=void 0,x={query:s.query,limit:s.limit,debug:b},{publicAccessPermissionAncestorBlockId:S}=(0,B().E)(i),k=(0,A().e)({environment:i,input:x,spaceId:null==l?void 0:l.id,publicAccessPermissionAncestorBlockId:S,source:"report_bad_search"});if(!k)return;const T=j().zD.isSearchModalV2Enabled();let M,P=null;if(T){var O;P=document.querySelector(".search-2-snapshot-container"),M=null===(O=P)||void 0===O?void 0:O.outerHTML}else{var F;P=document.getElementsByClassName("notion-overlay-container notion-default-overlay-container")[0],M=null===(F=P)||void 0===F?void 0:F.outerHTML}const q=document.getElementsByClassName("notion-app-inner notion-dark-theme")[0],L=null==q?void 0:q.style.cssText,K=document.createElement("div");K.innerHTML=M||"",K.style.cssText=L||"",P&&K.firstElementChild&&function(e,t){const n=e.querySelectorAll("*"),r=t.querySelectorAll("*");D(e,t),n.forEach(((e,t)=>{const n=r[t];n&&D(e,n)}))}(P,K.firstElementChild);null===(d=K.querySelector("[data-search-suggested-text]"))||void 0===d||d.remove(),null===(c=K.querySelector("[data-search-snapshot-delete-nearest-overlay]"))||void 0===c||null===(c=c.closest("[data-portal]"))||void 0===c||c.remove(),function(e,t){const n=document.createElement("span");n.innerHTML="ðŸ’»";const r=document.createElement("span");r.innerHTML="â¬‡ï¸ðŸŒ";e.querySelectorAll(".notranslate.search-query-result-item").forEach(((e,o)=>{const i=e.querySelector("[data-search-icon-target]");let a;var s;i?a=i:a=null===(s=e.firstElementChild)||void 0===s||null===(s=s.children[1])||void 0===s||null===(s=s.firstElementChild)||void 0===s?void 0:s.firstElementChild;a&&o<t?a.appendChild(n.cloneNode(!0)):a&&a.appendChild(r.cloneNode(!0))}))}(K,v.length);const z=y.some((e=>e.sources.includes(w().Ni.VectorDBBlock)||e.sources.includes(w().Ni.VectorDBCollection)||e.sources.includes(w().Ni.VectorDBBlockOpenAI)||e.sources.includes(w().Ni.VectorDBCollectionOpenAI)||e.sources.includes(w().Ni.VectorDBBlockBGE)||e.sources.includes(w().Ni.VectorDBCollectionBGE)||e.sources.includes(w().Ni.VectorDBBlockBGE1024)||e.sources.includes(w().Ni.VectorDBCollectionBGE1024)||e.sources.includes(w().Ni.VectorDBBlockBGE4096)||e.sources.includes(w().Ni.VectorDBCollectionBGE4096)||e.sources.includes(w().Ni.VectorDBBlockE5)||e.sources.includes(w().Ni.VectorDBCollectionE5)));z&&y.splice(0,-20);const V=n??{},U={queryText:s.query.text.trim(),apiRequest:k,serverResults:JSON.stringify(y,null,2),localResults:JSON.stringify(v,((e,t)=>t instanceof Set?Array.from(t):t),2),additionalInformation:m.additionalInformation,desiredUrl:m.desiredUrl,renderedHtml:(0,I().xV3)(K.outerHTML),experiments:JSON.stringify(V,null,2),isVectorSearchEnabled:z,traceLogs:null==r||null===(u=r.traceLogs)||void 0===u?void 0:u.log,userId:i.currentUser.id??"",platform:i.device.platform,planType:(null==l?void 0:l.getPlanType())??"",allowFollowUp:a,source:w().m2.searchModal,productSurface:o,feedback:N().A.getState().feedback};C().callApi({eventName:"reportBadSearch",environment:i,data:U}).then((e=>{"failed"===e.type?h().f1((0,R.jsx)("h1",{children:p().A.formatMessage(E.submitFailed)})):g().D6({label:p().A.formatMessage(E.submitSuccess),durationMs:f().LX})})),N().A.reset()}({...e,spaceStore:q,environment:t,allowFollowUp:W,searchStoreState:e.reportBadSearchInputRequest?{...O.state,source:"quick_find",query:e.reportBadSearchInputRequest.query,limit:e.reportBadSearchInputRequest.limit}:O.state})}),[t,q,W,e,O]),Q=e=>{const t=e.target.value;K({...L,additionalInformation:t}),t.trim()===O.state.query.text.trim()?(V(n.formatMessage(E.additionalInformationWarning)),H(!0)):(V(""),H(!1))},Y=()=>{$(!W)},Z=(0,u().IS)((()=>({wrap:{display:"flex",flexDirection:"column",width:s().A.isMobile?"min(100%, 600px)":void 0,minHeight:128,maxHeight:s().A.isMobile?void 0:"max(calc(100vh - 78px), 300px)"},modalWrap:{width:"32rem",padding:24,fontSize:14,maxWidth:"100%"},modalTitle:{fontSize:16,fontWeight:M().Wy.medium},modalWarning:{fontSize:13,color:T().Tj.text.tertiary},titleContainer:{marginBottom:12},buttonArea:{display:"flex",justifyContent:"flex-end",marginTop:18,gap:6},feedbackArea:{marginTop:17,padding:8},warningMessage:{color:T().Tj.red.text.accentPrimary,marginTop:10},checkboxArea:{marginTop:12,display:"flex",gap:6,alignItems:"center"}})),[]);return(0,R.jsx)(m().A,{onDismiss:()=>F(t),render:()=>(0,R.jsx)(a().A,{allowMobileAutoScroll:!0,capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!1,render:e=>(0,R.jsx)("div",{style:Z.wrap,"data-search-snapshot-delete-nearest-overlay":!0,"data-mini-search-exclude-from-snapshot":!0,children:(0,R.jsxs)("div",{style:Z.modalWrap,...e,children:[(0,R.jsxs)("div",{style:Z.titleContainer,children:[(0,R.jsx)("div",{style:Z.modalTitle,children:n.formatMessage(E.title)}),(0,R.jsx)("div",{style:Z.modalWarning,children:n.formatMessage(E.warning)})]}),(0,R.jsx)(v().A,{placeholder:"thumbsUp"===L.feedback?n.formatMessage(E.additionalInformationPositivePlaceholder):n.formatMessage(E.additionalInformationPlaceholder),value:L.additionalInformation,onChange:Q,focusInitial:!0,inputStyle:{padding:8},style:Z.feedbackArea,textarea:!0}),z?(0,R.jsx)("div",{style:Z.warningMessage,children:z}):void 0,(0,R.jsx)(v().A,{placeholder:n.formatMessage(E.urlPlaceholder),value:L.desiredUrl,onChange:e=>{K({...L,desiredUrl:e.target.value})},style:Z.feedbackArea}),(0,R.jsxs)("div",{style:Z.checkboxArea,children:[(0,R.jsx)(y().S,{checked:W,onClick:Y,size:12}),(0,R.jsx)("div",{onClick:Y,children:(0,R.jsx)(S().A,{style:{cursor:"pointer"},isSmall:!0,children:n.formatMessage(E.checkboxLabel)})})]}),(0,R.jsxs)("div",{style:Z.buttonArea,children:[(0,R.jsx)(b().A,{size:"lg",onClick:()=>F(t),children:n.formatMessage(E.cancel)}),(0,R.jsx)(x().A,{colorPalette:"blue",size:"lg",onClick:G,disabled:U,children:n.formatMessage(E.submit)})]})]})})}),isOpen:L.open})}function F(e){(0,o().u)({environment:e,event:{eventName:"report_bad_search_abandon",eventProperties:{}}}),N().A.reset()}function D(e,t){const n=e.getAttribute("style");if(!n||!n.includes("var("))return;const r=window.getComputedStyle(e),o=[];for(const i of n.split(";")){const e=i.trim();if(!e)continue;const t=e.indexOf(":");if(-1===t){o.push(e);continue}const n=e.substring(0,t).trim();if(e.substring(t+1).trim().includes("var(")){const t=r.getPropertyValue(n).trim();t?o.push(`${n}: ${t}`):o.push(e)}else o.push(e)}t.setAttribute("style",o.join("; "))}},187881:(e,t,n)=>{n.r(t),n.d(t,{eyeFillIcon:()=>i,iconDefinition:()=>o});n(296540);var r=n(474848);const o={viewBox:"0 0 20 20",fittedViewBox:"0.96 4.19 18.07 11.62",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{d:"M10 8.894a1.104 1.104 0 1 1-.003 2.207A1.104 1.104 0 0 1 10 8.894"}),(0,r.jsx)("path",{d:"M10 4.194c3.878 0 7.26 2.075 8.862 5.127l.073.163c.126.333.126.7 0 1.033l-.073.163c-1.602 3.052-4.984 5.126-8.862 5.126-3.757 0-7.049-1.946-8.707-4.843l-.156-.283a1.46 1.46 0 0 1 0-1.359l.156-.283C2.95 6.141 6.243 4.194 10 4.194m0 2.496a3.307 3.307 0 0 0-3.306 3.307l.004.17A3.307 3.307 0 0 0 9.83 13.3l.17.004a3.305 3.305 0 0 0 3.3-3.137l.005-.17a3.307 3.307 0 0 0-3.135-3.303z"})]})},i=(0,n(340498).wt)("eyeFill",o,"fill")},199103:(e,t,n)=>{n.d(t,{H:()=>i});n(296540);var r=n(474848);const o={viewBox:"0 0 20 20",fittedViewBox:"4.12 2.37 11.75 15.25",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{d:"M9.134 5.001c-.236-.667-1.18-.667-1.415 0L6.28 9.084a.5.5 0 1 0 .943.332l.276-.784h1.857l.276.784a.5.5 0 0 0 .944-.332zm-.708 1.001.576 1.63h-1.15zM10.75 5a.5.5 0 0 0 0 1h2.5a.5.5 0 0 0 0-1zm.313 3a.5.5 0 0 1 .5-.5h1.687a.5.5 0 0 1 0 1h-1.687a.5.5 0 0 1-.5-.5M6.75 10.708a.5.5 0 0 0-.5.5v3.715a.5.5 0 0 0 .845.362l1.101-1.05a.25.25 0 0 1 .347.003l.675.657a.5.5 0 0 0 .734-.038l1.189-1.435a.25.25 0 0 1 .375-.01l1.368 1.467a.5.5 0 0 0 .866-.341v-3.33a.5.5 0 0 0-.5-.5zm2.554 2.435a.696.696 0 1 1 0-1.393.696.696 0 0 1 0 1.393"}),(0,r.jsx)("path",{d:"M6.25 2.375A2.125 2.125 0 0 0 4.125 4.5v11c0 1.174.951 2.125 2.125 2.125h7.5a2.125 2.125 0 0 0 2.125-2.125v-11a2.125 2.125 0 0 0-2.125-2.125zM5.375 4.5c0-.483.392-.875.875-.875h7.5c.483 0 .875.392.875.875v11a.875.875 0 0 1-.875.875h-7.5a.875.875 0 0 1-.875-.875z"})]})},i=(0,n(340498).wt)("docRichText",o,"default")},203031:(e,t,n)=>{n.d(t,{H:()=>m});var r=()=>n(920198),o=()=>n(907258),i=()=>n(484714),a=()=>n(590526),s=()=>n(929219),l=()=>n(574359),d=()=>n(201980),c=()=>n(383070),u=()=>n(475553),p=()=>n(303742);function m(e){const{intl:t,isNewElectronTab:n}=e,m=(0,i().v3)(),g=(0,u().y)(),f=!(0,a().O$)(s().e),y=(0,r().L)(),{currentSidebarSpaceViewStore:v,mainEditorCurrentBlockStore:b}=(0,a().K8)((()=>({currentSidebarSpaceViewStore:o().default.state.sidebarSpaceViewStore,mainEditorCurrentBlockStore:o().default.state.mainEditorCurrentBlockStore})),[],{debugName:"useSearchInputPlaceholder.appStoreStores"}),x=(0,a().K8)((()=>null==b?void 0:b.getTitleValue()),[b],{debugName:"useSearchInputPlaceholder.pageTitleValue"}),S=(0,a().K8)((()=>y&&(0,l().G)(m,y)),[m,y],{debugName:"useSearchInputPlaceholder.spaceName"}),w=(0,a().K8)((()=>c().zD.showSearchAiFeatures()),[],{debugName:"useSearchInputPlaceholder.showSearchAiFeatures"}),I=(0,a().K8)((()=>(0,p().o)(v)),[v],{debugName:"useSearchInputPlaceholder.isExternalPagesSearch"});return(0,a().K8)((()=>{if(g&&f)return t.formatMessage(h.offline);if(n)return t.formatMessage(h.newTab);if(S&&w)return t.formatMessage(h.searchOrAskQuestionInSpace,{spaceName:S});if(I)return t.formatMessage(h.externalPagesSearch);if(S)return t.formatMessage(h.searchInSpace,{spaceName:S});if(x){const e=100,n=(0,d().q4_)(x).slice(0,e);return t.formatMessage(h.namedPage,{pageTitle:n})}return t.formatMessage(h.unnamedPage)}),[t,n,f,g,x,I,w,S],{debugName:"useSearchInputPlaceholder.placeholderText"})}const h=(0,n(69708).YK)({offline:{id:"searchInputMenuItem.placeholder.offline",defaultMessage:"Search offline pagesâ€¦"},newTab:{id:"searchInputMenuItem.placeholder.newTab",defaultMessage:"Open in new tab..."},searchOrAskQuestionInSpace:{id:"searchInputMenuItem.placeholder.SearchOrAskQuestionInSpace",defaultMessage:"Search or ask a question in {spaceName}â€¦"},externalPagesSearch:{id:"searchInputMenuItem.placeholder.externalPagesSearch",defaultMessage:"Search external pagesâ€¦"},searchInSpace:{id:"searchInputMenuItem.placeholder.searchInSpace",defaultMessage:"Search {spaceName}â€¦"},namedPage:{id:"searchInputMenuItem.placeholder.namedPage",defaultMessage:"Search in {pageTitle}â€¦"},unnamedPage:{id:"searchInputMenuItem.placeholder.unnamedPage",defaultMessage:"Search in pageâ€¦"}})},203262:(e,t,n)=>{n.d(t,{g:()=>g});var r=n(296540),o=()=>n(726637),i=()=>n(484714),a=()=>n(401497),s=()=>n(695115),l=()=>n(26697),d=()=>n(506166),c=()=>n(340498),u=()=>n(620333),p=()=>n(69708),m=()=>n(322183),h=n(474848);function g(e){const{hasFilters:t,isShowingFilterBar:n,setIsShowingFilterBar:g}=e,f=(0,i().v3)(),y=(0,r.useRef)(!1),v=f.currentUser.id;(0,r.useEffect)((()=>{if(!v||y.current)return;!1===(0,u().YT)(v)&&!0===n&&g(!1),y.current=!0}),[v,n,g]);const b=(0,a().IS)((()=>({container:{marginInlineStart:4,display:"flex"},icon:{width:c().Ev.default,height:c().Ev.default}})),[]),x=(0,p().tz)(),S=n?x.formatMessage(m()._S.hide):x.formatMessage(m()._S.show),w=(0,r.useCallback)((()=>{const e=!n;v&&(0,u().M2)(v,e),g(e)}),[v,n,g]);return(0,h.jsx)(l().m,{renderTooltip:()=>(0,h.jsx)("div",{children:S}),placement:"bottom",alignment:"start",disableTooltip:o().A.isMobile,delayThreshold:400,render:e=>(0,h.jsx)("span",{style:b.container,children:(0,h.jsx)(s().A,{...e,icon:d().E,iconStyle:b.icon,ariaLabel:S,onClick:w,...t?{colorPalette:"blue",colorVariant:"accentPrimary"}:{}})})})}},220818:(e,t,n)=>{n.d(t,{t:()=>d});var r=()=>n(597777),o=()=>n(869190),i=()=>n(604995),a=()=>n(881431);function s(e,t){const n=i().C6.notionDateTimeToLuxon(e,t.locale);return(0,o().eV)({value:n,preset:"medium_with_time"})}const l=(0,n(69708).YK)({startAndEnd:{defaultMessage:"{startDate} - {endDate}",id:"searchHelpers.betweenStartAndEndDates"},afterStart:{defaultMessage:"After {startDate}",id:"searchHelpers.afterStartDate"},beforeEnd:{defaultMessage:"Before {endDate}",id:"searchHelpers.beforeEndDate"}});function d(e,t,n=r().vz){let o="",i="";return e.starting&&(o="date"===e.starting.type?(0,a().Y)(e.starting,t,n):s(e.starting,t)),e.ending&&(i="date"===e.ending.type?(0,a().Y)(e.ending,t,n):s(e.ending,t)),o&&i?t.formatMessage(l.startAndEnd,{startDate:o,endDate:i}):o?t.formatMessage(l.afterStart,{startDate:o}):t.formatMessage(l.beforeEnd,{endDate:i})}},224503:(e,t,n)=>{n.r(t),n.d(t,{browserAddIcon:()=>i,iconDefinition:()=>o});n(296540);var r=n(474848);const o={viewBox:"0 0 20 20",fittedViewBox:"-0.01 4.12 17.63 14.63",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{d:"M2.375 6.25c0-1.174.951-2.125 2.125-2.125h11c1.174 0 2.125.951 2.125 2.125v7.5a2.125 2.125 0 0 1-2.125 2.125H7.957a4.5 4.5 0 0 0 0-1.25H15.5a.875.875 0 0 0 .875-.875V7.5H3.625v3.252L3.5 10.75c-.388 0-.765.05-1.125.142zm2.258.184a.625.625 0 1 0 0-1.25.625.625 0 0 0 0 1.25m2.625-.625a.625.625 0 1 0-1.25 0 .625.625 0 0 0 1.25 0m1.375.625a.625.625 0 1 0 0-1.25.625.625 0 0 0 0 1.25"}),(0,r.jsx)("path",{d:"M7 15.25q-.001.32-.056.625A3.501 3.501 0 1 1 3.5 11.75h.011l.114.002A3.5 3.5 0 0 1 7 15.25m-6.125 0c0 .345.28.625.625.625h1.375v1.375a.625.625 0 1 0 1.25 0v-1.375H5.5a.625.625 0 1 0 0-1.25H4.125V13.25a.625.625 0 1 0-1.25 0v1.375H1.5a.625.625 0 0 0-.625.625"})]})},i=(0,n(340498).wt)("browserAdd",o,"default")},251200:(e,t,n)=>{n.d(t,{y:()=>o});var r=()=>n(44551);function o(){var e;null===r().electronApi||void 0===r().electronApi||null===(e=r().electronApi.closeQuickSearch)||void 0===e||e.call(r().electronApi)}},251383:(e,t,n)=>{n.d(t,{V:()=>a});var r=()=>n(943290),o=()=>n(483730),i=()=>n(358579);function a(e){const{environment:t,sessionId:n,operationIds:a}=e,s=o().default.getSessionContextOrThrow(n);s.caches.clear();const l=s.clearUncommittedOperations({onlyClearOperationIds:a}),d=0===s.uncommittedExecutableOperationsFromStoreState.length,c=(0,r().iL)(l);for(const r of l)"addBlockToPage"===r.command&&s.evaluatorFromStoreState.state.unmarkPageAsLoaded(r.blockNode.attributes.id);return(0,i().Z)({environment:t,sessionContext:s}),{allEditsRejected:d,editGroupsThatWereRejected:c}}},254704:(e,t,n)=>{n.d(t,{c:()=>y});var r=n(296540),o=()=>n(590526),i=()=>n(401497),a=()=>n(695115),s=()=>n(406094),l=()=>n(26697),d=()=>n(104556),c=()=>n(542101),u=()=>n(69708),p=()=>n(100622),m=()=>n(383070),h=()=>n(702473),g=()=>n(174192),f=n(474848);function y(e){const t=(0,u().tz)(),n=(0,o().K8)((()=>h().A.state.open),[]),y=(0,o().K8)((()=>m().zD.isSearchModalV2Enabled()),[]),v=(0,r.useCallback)((e=>{h().A.update((t=>({...t,open:!0,feedback:e})))}),[]),b=(0,i().IS)((()=>({container:{...e.buttonStyles,display:"flex",alignItems:"center",gap:4},iconButton:{height:20,width:20,padding:2},legacyButton:{...e.buttonStyles,display:"inline-block",fontSize:12,color:p().Tj.text.tertiary,padding:4,cursor:"pointer",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",userSelect:"none",height:"inherit",alignContent:"center"}})),[e.buttonStyles]);return(0,f.jsxs)(f.Fragment,{children:[y?(0,f.jsxs)("div",{style:b.container,children:[(0,f.jsx)(l().m,{placement:"top",renderTooltip:()=>(0,f.jsx)("div",{children:t.formatMessage({id:"search.feedback.tooltip.good",defaultMessage:"Useful results"})}),render:e=>(0,f.jsx)(a().A,{...e,onClick:()=>v("thumbsUp"),icon:c().r,ariaLabel:t.formatMessage({id:"search.feedback.thumbsUp",defaultMessage:"Search was helpful"}),style:b.iconButton})}),(0,f.jsx)(l().m,{placement:"top",renderTooltip:()=>(0,f.jsx)("div",{children:t.formatMessage({id:"search.feedback.tooltip.bad",defaultMessage:"Not useful results"})}),render:e=>(0,f.jsx)(a().A,{...e,onClick:()=>v("thumbsDown"),icon:d()._,ariaLabel:t.formatMessage({id:"search.feedback.thumbsDown",defaultMessage:"Search was not helpful"}),style:b.iconButton})})]}):(0,f.jsx)(s().A,{size:"lg",style:b.legacyButton,onClick:()=>v("thumbsDown"),children:t.formatMessage({defaultMessage:"Give search feedback",id:"search.header.badSearch.button.label"})}),n?(0,f.jsx)(g().e,{productSurface:e.productSurface,localResults:e.localResults,serverResults:e.serverResults,debugInfo:e.debugInfo,exposedSearchExperiments:e.exposedSearchExperiments,reportBadSearchInputRequest:e.reportBadSearchInputRequest}):void 0]})}},274981:(e,t,n)=>{n.d(t,{c:()=>f});n(16280);var r=n(296540),o=()=>n(17022),i=()=>n(221844),a=()=>n(484714),s=()=>n(79926),l=()=>n(510818),d=()=>n(884107),c=()=>n(108184),u=()=>n(485601),p=()=>n(43893),m=()=>n(659602),h=()=>n(547149),g=n(474848);function f(e){const{clientStep:t,disablePointerEvents:n}=e,f=(0,a().v3)(),{value:y}=(0,s().fJ)(m().g),{value:v}=(0,s().fJ)(d().R.clipboardActions),b=(0,r.useMemo)((()=>y&&v?o().e.withListenerIgnored((()=>function(e){const{environment:t,clientStep:n,clipboardActions:r,markdownLinkifyIt:o}=e,a=new(i().A)({name:"AssistantChatMessageListRenderer"}),s=h().createAndCommit({userAction:"AssistantChatMessageRenderer.temporaryListStoreForClientChatTextStep",environment:t,canUndo:!1,perform:e=>{const s=function(e){const{environment:t,clientStep:n,clipboardActions:r,transaction:o,markdownLinkifyIt:a}=e,s=new(i().A)({name:"AssistantChatMessageRenderer",isSyntheticAssistantData:!0}),d=t.currentUser.id;if(!d)throw new Error("No current user.");const c=e=>{const o=r.markdownToBlocks({environment:t,text:(0,l().e_)(n.text),transaction:e,inMemoryRecordCache:s,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:void 0});if(!o)return[];for(const t of o)s.setModelAndRole({pointer:t.pointer,userId:d},t.getModel(),"reader");return o};s.addCacheFallback(t.defaultRecordCache.inMemoryRecordCache);const u=h().createAndCommitOrAppend({userAction:"AssistantChatMessageRenderer.temporaryBlockStoresForClientChatTextStep",transaction:o,environment:t,perform:c,canUndo:!1});return u}({environment:t,clientStep:n,clipboardActions:r,transaction:e,markdownLinkifyIt:o});return c().wrapTemporaryBlocksInList({environment:t,stores:s,inMemoryRecordCache:a,transaction:e})}}).performResult;return s}({environment:f,clientStep:t,clipboardActions:v,markdownLinkifyIt:y}))):void 0),[t,f,y,v]);return(0,g.jsx)(u().c,{displayName:"AssistantChatStepContent",disabled:!0,style:n?{pointerEvents:"none"}:void 0,children:b?(0,g.jsx)(p().A,{store:b,disabled:!0,disableCommentMenu:!0,disableHoverMenu:!0,disableDrag:!0}):null})}},297799:(e,t,n)=>{n.d(t,{U:()=>b});n(581454);var r=n(296540),o=()=>n(484714),i=()=>n(590526),a=()=>n(401497),s=()=>n(79926),l=()=>n(807449),d=()=>n(493552),c=()=>n(81068),u=()=>n(736847),p=()=>n(40457),m=()=>n(69708),h=()=>n(601734),g=()=>n(756790),f=()=>n(87573),y=()=>n(794545),v=n(474848);function b(e){var t;const{onClick:n}=e,a=(0,m().tz)(),l=(0,o().v3)(),d=(0,s().fJ)(h().Aw),c=(0,i().K8)((()=>(0,g().p)().function),[]),p=(0,i().K8)((()=>{var e;const t=((null===(e=d.value)||void 0===e?void 0:e.templatePickerItems.getSuggestedTemplatesForSearch({persona:c,environment:l}).slice(0,3))??[]).map((e=>({key:e.name,action:()=>{n(),e.onClick()},render:t=>(0,v.jsx)(x,{focused:t.focused,template:e,args:t})})));return t}),[null===(t=d.value)||void 0===t?void 0:t.templatePickerItems,c,l,n]),y=(0,i().K8)((()=>!(0,f().q)(l)&&p.length>0),[l,p]),b=(0,r.useMemo)((()=>{if(y)return{items:p,key:"templates",render:e=>r.createElement(u().A,{...e,title:a.formatMessage(S.templateSuggestions)},e.children)}}),[y,p,a]);return b}function x(e){const{focused:t,template:n,args:r}=e,o=(0,a().IS)((()=>(0,y().eD)({view:"recents",focused:t})),[t]);return(0,v.jsx)(c().A,{...r,icon:n.icon,title:(0,v.jsx)(d().D,{styleKey:"bodyMedium",children:n.name}),style:o.outerStyle,buttonStyle:o.buttonStyle,right:(0,v.jsx)("span",{style:o.enterIconStyle,children:(0,v.jsx)(l().I,{icon:p().arrowTurnDownLeftSmallIcon,size:"xs",colorVariant:"secondary"})})})}const S=(0,m().YK)({templateSuggestions:{id:"search.templateSuggestions.header",defaultMessage:"Start with a template"}})},298697:(e,t,n)=>{n.d(t,{A:()=>l});n(581454);var r=n(296540),o=()=>n(401497),i=()=>n(874832),a=()=>n(100622),s=n(474848);function l({paragraphs:e}){const t=(0,o().IS)((()=>({skeletonRect:{borderRadius:4,backgroundColor:a().Tj.background.tertiaryTranslucent}})),[]),n=null==e?void 0:e.map(((e,n)=>{const o={height:e.lineHeight,marginTop:e.lineMargin,marginBottom:e.lineMargin},a={marginTop:e.sectionMargin,marginBottom:e.sectionMargin},l=[...Array(e.repeat||1)].map(((n,r)=>(0,s.jsx)("div",{style:a,children:e.sectionWidths.map(((e,n)=>(0,s.jsx)(i().P,{style:{...t.skeletonRect,...o,width:`${e}%`}},n)))},r)));return(0,s.jsxs)(r.Fragment,{children:[" ",l," "]},n)}));return(0,s.jsxs)(s.Fragment,{children:[" ",n," "]})}},302607:(e,t,n)=>{n.d(t,{O:()=>o});class r extends(()=>n(757695))().Store{getInitialState(){return{currentState:"default",lastStepLoadingCompletionUnixEpochMs:-1/0,aiWindowLastSeenUnixEpochMs:-1/0}}setAssistantLastViewedTime(){this.setState({...this.state,aiWindowLastSeenUnixEpochMs:Date.now()})}}const o=new r;(0,n(852832).exposeDebugValue)("AssistantOriginElementStore",o)},311563:(e,t,n)=>{n.d(t,{L:()=>M});n(581454);var r=n(296540),o=()=>n(907258),i=()=>n(484714),a=()=>n(590526),s=()=>n(401497),l=()=>n(250910),d=()=>n(807449),c=()=>n(546926),u=()=>n(890492),p=()=>n(854705),m=()=>n(100622),h=()=>n(496603),g=()=>n(222917),f=()=>n(840153),y=()=>n(650829),v=()=>n(383070),b=()=>n(187820),x=()=>n(321874),S=()=>n(905487),w=()=>n(384565),I=()=>n(294249),k=()=>n(44590),T=n(474848);function M(e){const{onPopupOpen:t,onPopupClose:n,onWorkspaceSwitch:s,mode:d}=e,p=(0,a().O$)(o().AppStoreSidebarSpaceStore),m=(0,a().K8)((()=>null==p?void 0:p.id),[null==p?void 0:p.id]),b=(0,i().v3)(),M=b.currentUser.id,j=(0,r.useCallback)((async e=>{const{newSpaceViewStore:t,associatedUserId:n,closeSwitcherPopupFn:r}=e,i=t.getSpaceId();if(t&&M&&i){var a;const e=null===(a=o().default.state.sidebarSpaceViewStore)||void 0===a?void 0:a.id,l=g().wr();e&&l&&i&&g().mg(b,{currentSearchSessionId:l,currentWorkspaceId:e,newWorkspaceId:i}),r(),o().default.update((e=>({...e,sidebarSpaceViewStore:t,sidebarSpaceStore:null==t?void 0:t.getSpaceStore()}))),M!==n&&await f().T({environment:b,newCurrentUserId:n}),v().zD.isAiEnabled()&&y().assistantDependency.load().then((({assistantActions:e})=>{e.clearAllAssistantSessions()})),S().default.closeAndResetMetricsState(),I()._.closeAndResetMetricsState(),w().default.reset(),x()._N({environment:b,analyticsFrom:"quick-search-switch-workspace",isQuickSearch:!0,mode:"agent"===d?"assistant":"search"}),null==s||s()}}),[M,b,d,s]),{spaceIcon:A,spaceName:B}=(0,a().K8)((()=>p?{spaceName:p.getName(),spaceIcon:p.getIcon()}:{spaceName:void 0,spaceIcon:void 0}),[p]),_=[...b.currentUser.loggedInUserIds],N=(0,a().K8)((()=>{var e;return h().hS(h().oE((null===(e=o().default.state.currentUserRootStore)||void 0===e?void 0:e.getSpaceViewStores())??[]),(e=>e.getSpaceId())).length>1}),[]);return p&&m&&M&&p&&(N||1!==_.length)?(0,T.jsx)(l().A,{popupType:l().z.Popup,renderOrigin:e=>(0,T.jsx)(C,{events:e,spaceIcon:A,spaceName:B}),render:e=>(0,T.jsx)(u().A,{menuType:c().gu.Popup,children:_.map(((t,n)=>(0,T.jsx)(k().ti,{onSpaceClick:n=>j({newSpaceViewStore:n.spaceViewStore,associatedUserId:t,closeSwitcherPopupFn:e.close}),userId:t,isLastUser:n===_.length-1,shouldShowNewWorkspaceButtonInUserSpaceView:!1,disableAccountActions:!0,close:e.close},`commandSearch-userworkspaces-${n}`)))}),onClick:t,onClose:n,disabled:!1,placementToOrigin:"bottom",alignmentToOrigin:"start",style:{marginInlineEnd:30}}):null}function C(e){const{events:t,spaceIcon:n,spaceName:o}=e,[i,a]=(0,r.useState)(!1),l=(0,s().IS)((()=>({wrapper:{display:"flex",alignItems:"center",gap:2,paddingInlineEnd:5,cursor:"pointer"},recordIcon:{backgroundColor:i?m().Tj.buttonHoveredBackground:void 0,padding:4,height:void 0,width:void 0}})),[i]);return(0,T.jsxs)("span",{...t,style:l.wrapper,onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),role:"button",children:[(0,T.jsx)(b().B6,{bucket:"public",disabled:!0,icon:n,iconRecordCategory:"workspace",isEmptyPage:!1,size:24,style:l.recordIcon,title:o}),(0,T.jsx)(d().I,{icon:p().arrowChevronSingleDownFillSmallIcon,size:"xxs",colorVariant:"tertiary"})]})}},322183:(e,t,n)=>{n.d(t,{Ac:()=>M,Ay:()=>N,_S:()=>E});n(944114),n(898992),n(581454),n(737550);var r=n(296540),o=()=>n(726637),i=()=>n(590526),a=()=>n(401497),s=()=>n(75435),l=()=>n(882722),d=()=>n(718827),c=()=>n(807449),u=()=>n(265060),p=()=>n(203717),m=()=>n(340498),h=()=>n(182183),g=()=>n(201980),f=()=>n(69708),y=()=>n(100622),v=()=>n(987267),b=()=>n(604018),x=()=>n(187820),S=()=>n(656894),w=()=>n(384565),I=()=>n(287234),k=()=>n(203262),T=n(474848);const M=48;function C(e){const{onTypingChange:t,onFocusChange:d,isOpen:u,showSpinner:p,onQueryChange:m,selectedResultStore:h,quickSearchMode:v,inputComboboxProps:b,searchResultStore:S}=e,k=(0,f().tz)(),C=(0,r.useRef)();(0,r.useEffect)((()=>()=>{C.current&&(window.clearTimeout(C.current),C.current=void 0)}),[]);const A=(0,i().O$)(I().B),B=(0,n(913063).o)(),N=(0,i().K8)((()=>n(92697).A.state.currentTab.isPinned),[]),E=(0,i().K8)((()=>n(905487).default.state.isNewElectronTab),[]),{isElectronTabSearchEnabledState:O,isPinnedTabNewTabEnabledState:F}=(0,i().K8)((()=>{var e,t;return{isElectronTabSearchEnabledState:null===(e=s().A.state.preferences)||void 0===e?void 0:e.isNewTabSearchEnabled,isPinnedTabNewTabEnabledState:null===(t=s().A.state.preferences)||void 0===t?void 0:t.isPinnedTabNewTabEnabled}}),[]),D=Boolean(E)&&Boolean(O)||Boolean(F)&&Boolean(N),q=(0,n(203031).H)({intl:k,isNewElectronTab:D}),L=(0,n(484714).Y0)(),K=(0,a().IS)((()=>({boxShadowStyle:{...L.isTablet&&{width:"100%"}},inputDesktop:{fontSize:18,height:M,paddingInlineStart:12,paddingInlineEnd:16,alignItems:"center",flexGrow:0,flexShrink:0,zIndex:1},inputMobile:{fontSize:16,border:"none",boxShadow:"none",borderRadius:7,lineHeight:"1.2",padding:"6px 8px",background:y().Tj.inputBackground},headerIcon:{height:24,width:24,display:"flex",alignItems:"center",justifyContent:"center"},input:{minWidth:0,...n(284371).RC},suggestedText:{whiteSpace:"pre",color:y().Tj.text.secondary},suggestedTextWrapper:{overflow:"hidden",textOverflow:"ellipsis"},autoCompletedText:{color:y().Tj.text.secondary,background:y().Tj.background.tertiaryTranslucent},suggestedTextInvisibleUserQuery:{whiteSpace:"pre-wrap",color:"transparent"},userInputAndSuggestedTextContainer:{display:"grid",gridTemplateColumns:"auto 1fr"}})),[L.isTablet]),z=(0,i().K8)((()=>I().zw.state.text),[]),V=o().A.isMobile?"extra-large":"transparent",U=(0,i().K8)((()=>{const e=Boolean(O)?B:[];return function(e,t,n,r,i,a){if(0===r.length||r.length>=20||o().A.isMobile||void 0===n)return;const s=g().k4p(n.getTitleValue()),l=s.replaceAll("\n"," "),d=s.slice(0,r.length),c=s.length>0&&d.toLocaleLowerCase()===r.toLocaleLowerCase(),u=c?l.substring(r.length):"";switch(!0){case t.isElectron&&i.some((e=>e.pageId===n.id)):return`${u} â€” ${e.formatMessage(R.switchTab)}`;case t.isElectron&&a:return`${u} â€” ${e.formatMessage(R.openInTab)}`;default:return`${u} â€” ${e.formatMessage(R.open)}`}}(k,L,h,z,e,D)}),[B,O,h,L,z,D,k]),H=(0,i().K8)((()=>n(702473).A.state.open),[]),W=(0,r.useMemo)((()=>U&&0!==z.trim().length?(0,T.jsxs)("div",{style:K.userInputAndSuggestedTextContainer,"data-search-suggested-text":!0,children:[(0,T.jsx)("span",{style:K.suggestedTextInvisibleUserQuery,children:z}),(0,T.jsx)("div",{style:{...K.suggestedTextWrapper},className:v&&!A?l().sbV:void 0,children:(0,T.jsx)("span",{style:K.autoCompletedText,children:U})})]}):""),[U,z,K.userInputAndSuggestedTextContainer,K.suggestedTextInvisibleUserQuery,K.suggestedTextWrapper,K.autoCompletedText,v,A]),$=o().A.isMobile?K.inputMobile:K.inputDesktop,G={...K.input,width:0===z.length&&v?`min(${q.length}ch, 100%)`:"100%"},Q=(0,i().K8)((()=>null==h?void 0:h.getIcon()),[h]),Y=(0,i().K8)((()=>(0,x().Te)(h)),[h]),Z=Boolean(z.trim())&&!o().A.isMobile,{handlePopupOpen:X,handlePopupClose:J}=(0,r.useContext)(n(870976).SearchStaticContext),ee=(0,r.useMemo)((()=>{if(v)return(0,T.jsx)(n(311563).L,{onPopupOpen:X,onPopupClose:J,mode:"search"});return(0,T.jsx)("div",{style:K.headerIcon,children:(()=>{switch(!0){case p:return(0,T.jsx)(n(98126).A,{size:"md"});case Z:return(0,T.jsx)(x().B6,{disabled:!0,icon:Q,iconRecordCategory:Y,isEmptyPage:Boolean(Q),size:20});case D:return(0,T.jsx)(c().I,{icon:n(224503).browserAddIcon,colorVariant:"secondary"});default:return(0,T.jsx)(c().I,{icon:n(207207).magnifyingGlassIcon,colorVariant:"secondary"})}})()})}),[v,K.headerIcon,X,J,p,Z,Q,Y,D]),te=(0,i().K8)((()=>n(383070).zD.isSearchConnectorTabSectionEnabled()),[]),ne=()=>{void 0===w().default.state.firstKeyStrokeTimeMs&&w().default.update((e=>({...e,firstKeyStrokeTimeMs:Date.now()}))),C.current&&window.clearTimeout(C.current),t(!0),C.current=window.setTimeout((()=>t(!1)),300)};return(0,T.jsxs)("div",{style:K.boxShadowStyle,children:[(0,T.jsx)("div",{style:{display:"flex",flex:1},className:v&&!A?l().sbV:void 0,children:(0,T.jsx)(n(31511).A,{format:V,placeholder:q,left:ee,value:z,suggestedText:W,suggestedTextStyle:K.suggestedText,focus:o().A.isMobile?void 0:u&&!H,focusInitial:!(0,n(201794).T)("supportsNativeHome")&&o().A.isMobile,focusAfterAnimation:!0,showClearButton:!0,right:!o().A.isMobile&&(0,T.jsx)(_,{quickSearchMode:v}),isRightLastElementOfInput:!0,selectAll:!0,onChange:e=>{ne();const t=String(e.target.value);m(t)},onClearButtonClick:P,style:$,inputStyle:G,...(0,n(383036).A)(b,{onFocus:()=>function(e){e(!0)}(d),onBlur:()=>function(e){e(!1)}(d)})})}),te?(0,T.jsx)(j,{searchResultsStore:S}):void 0]})}function j(e){const{searchResultsStore:t}=e,n=(0,i().K8)((()=>(0,b().wd)()),[]),r=(0,a().IS)((()=>({wrapperStyle:{display:"flex",alignItems:"center",marginInlineStart:8,marginBottom:8,marginTop:-4}})),[]),o=(0,i().K8)((()=>{const e=[];for(const o of n){var r;const n=(null===(r=t.state.universalResults)||void 0===r||null===(r=r[o])||void 0===r?void 0:r.length)??0;e.push({type:o,resultCount:n})}return e}),[n,t]);return(0,T.jsxs)("div",{style:r.wrapperStyle,children:[(0,T.jsx)(B,{searchResultStore:t}),o.map((({type:e,resultCount:n})=>(0,T.jsx)(A,{searchResultsStore:t,resultCount:n,connectorType:e},e)))]})}function A(e){const{connectorType:t,resultCount:n,searchResultsStore:o}=e,s=(0,i().K8)((()=>o.state.currentlySelectedUniversalSearchResultView===t),[t,o]),{icon:l,name:c}=(0,r.useMemo)((()=>({icon:p().G[t],name:v().w0[t]})),[t]),m=(0,r.useCallback)((()=>{o.update((e=>({...e,currentlySelectedUniversalSearchResultView:t})))}),[t,o]),h=(0,a().IS)((()=>({pillStyle:{display:"flex",alignItems:"center",marginInlineEnd:8,paddingInlineStart:12,paddingInlineEnd:12,paddingTop:6,paddingBottom:6,borderRadius:20,cursor:"pointer",userSelect:"none"},iconStyle:{height:14,width:14}})),[]);return(0,T.jsxs)(d().Ay,{style:h.pillStyle,onClick:m,focused:s,children:[(0,T.jsx)(u().Q,{iconGroup:l,variantName:"default",overrideSize:()=>h.iconStyle.width}),(0,T.jsx)("span",{style:{marginInlineStart:4,fontSize:12},children:c}),n>0?(0,T.jsx)("span",{style:{marginInlineStart:4,fontSize:12},children:n}):void 0]},t)}function B(e){const{searchResultStore:t}=e,n=(0,a().IS)((()=>({pillStyle:{display:"flex",alignItems:"center",marginInlineEnd:8,paddingInlineStart:12,paddingInlineEnd:12,paddingTop:6,paddingBottom:6,borderRadius:20,cursor:"pointer",userSelect:"none"},iconStyle:{height:m().Ev.sm,width:m().Ev.sm}})),[]),o=(0,i().K8)((()=>!Boolean(t.state.currentlySelectedUniversalSearchResultView)),[t]),s=(0,r.useCallback)((()=>{t.update((e=>({...e,currentlySelectedUniversalSearchResultView:void 0})))}),[t]);return(0,T.jsxs)(d().Ay,{style:n.pillStyle,onClick:s,focused:o,children:[(0,h().notionTintableIcon)(n.iconStyle),(0,T.jsx)("span",{style:{marginInlineStart:4,fontSize:12},children:(0,T.jsx)(f().sA,{id:"SearchInputMenuItem.Notion",defaultMessage:"Notion"})})]})}function _(e){const[t,n]=(0,i().K8)((()=>{const e=I().Ay.state.query.filters,t=(0,S().J)(e);return[I().Ay.state.filterBar.show,t]}),[]),o=(0,r.useCallback)((e=>I().Ay.setFilterBarVisibility(e)),[]);return(0,T.jsx)(k().g,{hasFilters:n,isShowingFilterBar:t,setIsShowingFilterBar:o})}const N=C;function P(){I().Ay.resetQuery({resetFilters:!0}),I().Ay.update((e=>({...e,source:"quick_find"})))}const R=(0,f().YK)({open:{id:"search.inputMenu.suggestedText.open",defaultMessage:"Open"},openInTab:{id:"search.inputMenu.suggestedText.openInTab",defaultMessage:"Open in tab"},switchTab:{id:"search.inputMenu.suggestedText.switchTab",defaultMessage:"Switch tab"}}),E=(0,f().YK)({hide:{id:"searchInputMenuItem.filterBarToggleButtonTooltip.hide",defaultMessage:"Hide filters"},show:{id:"searchInputMenuItem.filterBarToggleButtonTooltip.show",defaultMessage:"Show filters"}});C.displayName="SearchInputMenuItem"},332946:(e,t,n)=>{n.d(t,{sb:()=>rn,CX:()=>an,bJ:()=>dn});var r=n(296540),o=()=>n(692031),i=()=>n(212497),a=()=>n(933922),s=()=>n(242422),l=()=>n(782482),d=()=>n(726637),c=()=>n(484714),u=()=>n(590526),p=()=>n(401497),m=()=>n(929219),h=()=>n(988083),g=()=>n(882722),f=()=>n(245720),y=()=>n(546926),v=()=>n(890492),b=()=>n(791177),x=()=>n(584262),S=()=>n(175947),w=()=>n(69708),I=()=>n(100622),k=()=>n(496603),T=()=>n(222917),M=()=>n(492414),C=()=>n(825972),j=()=>n(691865);function A(e){var t,n;const{searchResultStore:r}=e,o=(0,j().y)({localResults:null===(t=r.state.localResults)||void 0===t?void 0:t.results,serverResults:null===(n=r.state.serverResults)||void 0===n?void 0:n.results}),i=r.state.focusedIndex,a=null==i?void 0:i.global,s=null==i?void 0:i.local;if(void 0===a||void 0===s)return;const l=[...r.state.fixedActionResults??[],...r.state.queryBasedActionResults??[]],d=a<l.length?l[a]:void 0;if(d)return d;const c=a-l.length;if(!o||o.length<=0||c<0)return;const u=o[c];return u?{type:"page_result",value:{index:{global:a,local:s},selectedResult:u}}:void 0}var B=()=>n(798693),_=()=>n(361330),N=()=>n(870976),P=()=>n(461131),R=()=>n(770167);const E=(0,k().sg)(R().Lj,_().ab),O=(0,k().sg)(R().Lj,_().ab);var F=()=>n(691298),D=()=>n(445283),q=()=>n(371231),L=()=>n(563594),K=()=>n(905487),z=()=>n(287234),V=()=>n(344235),U=()=>n(424400),H=()=>n(284371),W=()=>n(115512),$=()=>n(755531),G=()=>n(250910),Q=()=>n(736847),Y=n(474848);const Z={viewBox:"0 0 16 16",fittedViewBox:"1.87 1.87 12.25 12.25",svg:(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)("path",{d:"M4.9 5.905a.575.575 0 0 0 0 1.15h6.2a.575.575 0 0 0 0-1.15zm5.425 1.883h-4.65a.575.575 0 1 0 0 1.15h4.65a.575.575 0 1 0 0-1.15M6.721 9.672a.575.575 0 0 0 0 1.15H9.28a.575.575 0 1 0 0-1.15z"}),(0,Y.jsx)("path",{d:"M8 1.875a6.125 6.125 0 1 0 0 12.25 6.125 6.125 0 0 0 0-12.25M3.125 8a4.875 4.875 0 1 1 9.75 0 4.875 4.875 0 0 1-9.75 0"})]})},X=(0,n(340498).wt)("filterCircleSmall",Z,"small");var J=()=>n(42583),ee=()=>n(534177),te=()=>n(957606),ne=()=>n(402267),re=()=>n(742382),oe=()=>n(971736),ie=()=>n(51700),ae=()=>n(795783),se=()=>n(322976),le=(n(898992),n(354520),()=>n(907258)),de=()=>n(807449),ce=()=>n(81068),ue=()=>n(604995),pe=()=>n(416504),me=()=>n(177148),he=()=>n(253673),ge=()=>n(385226);function fe({onMenuDismiss:e}){const t=(0,c().v3)(),n=(0,u().K8)((()=>z().zw.state.filters),[]),r=function(e,t){const n=Ie(e);if(!n)return!1;if(!n.createdBy)return!1;const r=n.createdBy[0];return-1!==t.createdBy.indexOf(r)}(t,n),o=function(e){const{lastEditedTime:t}=we();return k().n4(t,e.lastEditedTime)}(n),i=(0,u().K8)((()=>function(e){const t=Se();if(!t)return!1;if(!t.ancestors)return!1;const n=t.ancestors[0];return-1!==e.ancestors.indexOf(n)}(n)),[n]);return r&&o&&i?null:(0,Y.jsxs)(ge().A,{title:(0,Y.jsx)(w().sA,{id:"search.filterMenu.quickFiltersSection.title",defaultMessage:"Quick filters"}),marginAfter:!0,children:[r?void 0:(0,Y.jsx)(be,{focused:!1,onMenuDismiss:e}),o?void 0:(0,Y.jsx)(xe,{focused:!1,onMenuDismiss:e}),i?void 0:(0,Y.jsx)(ve,{focused:!1,onMenuDismiss:e})]})}function ye({icon:e,title:t,filter:n,onMenuDismiss:r,focused:o}){const i={minHeight:void 0,paddingTop:d().A.isMobile?12:4,paddingBottom:d().A.isMobile?12:4};return(0,Y.jsx)(ce().A,{icon:(0,Y.jsx)(de().I,{icon:e}),focused:o,title:t,onClick:()=>function(e,t){(function(e){z().Ay.updateFilters(e)})(e),void(z().Ay.isDebugSidebarOpen()||z().Ay.setState({...z().Ay.state,isDebugSidebarOpen:!0})),t&&t()}(n,r),style:i})}function ve(e){const t=(0,u().K8)((()=>Se()),[]);return t?(0,Y.jsx)(ye,{icon:me().Y,title:(0,Y.jsx)(w().sA,{id:"search.filterMenu.quickFilters.inCurrentPage",defaultMessage:"In current page"}),filter:t,...e}):null}function be(e){const t=Ie((0,c().v3)());return t?(0,Y.jsx)(ye,{icon:he().personIcon,title:(0,Y.jsx)(w().sA,{id:"search.filterMenu.quickFilters.createdByMe",defaultMessage:"Created by me"}),filter:t,...e}):null}function xe(e){const t=we();return t?(0,Y.jsx)(ye,{icon:J().D,title:(0,Y.jsx)(w().sA,{id:"search.filterMenu.quickFilters.editedLastWeek",defaultMessage:"Edited last week"}),filter:t,...e}):null}function Se(){const{mainEditorCurrentBlockStore:e}=le().default.state;if(e&&e.id)return{ancestors:[e.id]}}function we(){return{lastEditedTime:{starting:ue().t0((0,pe().P)()),ending:ue().Ec((0,pe().P)())}}}function Ie(e){const{id:t}=e.currentUser;if(t)return{createdBy:[t]}}let ke=function(e){return e.Button="Button",e.Section="Section",e}({});function Te({mode:e},t){const o=(0,u().uB)(void 0,n(118307).A),i=(0,r.useRef)(null),a=(0,r.useRef)(null);return(0,r.useImperativeHandle)(t,(()=>({getClientHeight:()=>{if(null!==i.current){const e=i.current.getAnchor();return(null==e?void 0:e.clientHeight)??0}return null!==a.current?a.current.clientHeight:0}}))),e===ke.Button?(0,Y.jsx)(ze,{ref:i,buttonPopupStore:o}):e===ke.Section?(0,Y.jsx)(Ke,{ref:a,buttonPopupStore:o}):void(0,ee().HB)(e)}const Me=r.forwardRef(Te);function Ce(e){return t=>z().Ay.updateFilters({[e]:t})}function je({mode:e}){const t=(0,u().K8)((()=>z().Ay.state.query.filters.isDeletedOnly),[]);return(0,Y.jsx)(ae().J,{mode:e,focused:!1,title:(0,Y.jsx)(w().sA,{id:"search.filterMenu.deletedOnlyToggle.label",defaultMessage:"Deleted only"}),icon:n(236262).trashIcon,value:t||!1,onChange:Ce("isDeletedOnly")})}function Ae(){return(0,Y.jsx)(w().sA,{id:"search.filterMenu.moreFiltersSection.title",defaultMessage:"More filters"})}function Be(e){z().Ay.updateFilters({navigableBlockContentOnly:e})}function _e({mode:e}){const t=(0,u().K8)((()=>z().Ay.state.query.filters.navigableBlockContentOnly),[]);return(0,Y.jsx)(ae().J,{mode:e,focused:!1,title:(0,Y.jsx)(w().sA,{id:"search.filterMenu.onlyMatchTitlesToggle.label",defaultMessage:"Title only"}),icon:n(435644).a,value:t||!1,onChange:Be})}function Ne(e){return(0,Y.jsx)("div",{style:{marginInlineEnd:-8},children:(0,Y.jsx)(n(631524).p,{...e,iconLeading:X,size:"sm",colorPalette:"blue",children:(0,Y.jsx)(w().sA,{defaultMessage:"Add filter",id:"search.addFilter.button.label"})})})}function Pe(e){e.setState({...e.state,open:!1})}function Re({mode:e,buttonPopupStore:t}){const n=(0,r.useCallback)((()=>Pe(t)),[t]),o=(0,u().K8)((()=>z().Ay.state.query.filters.ancestors),[]);return(0,Y.jsx)(N().SearchStoresContext.Consumer,{children:({parentStore:t})=>(0,Y.jsx)(re().E,{mode:e,focused:!1,title:(0,Y.jsx)(w().sA,{id:"search.filterMenu.moreFilters.inPage",defaultMessage:"In"}),parentStore:t,blockIds:o,onMenuDismiss:n,onChange:Ce("ancestors"),peopleBlocksToInclude:"collection_view_page"})})}function Ee({mode:e,buttonPopupStore:t}){const n=(0,r.useCallback)((()=>Pe(t)),[t]),o=(0,u().K8)((()=>z().Ay.state.query.filters.createdBy),[]);return(0,Y.jsx)(N().SearchStoresContext.Consumer,{children:({parentStore:t})=>(0,Y.jsx)(oe().A,{mode:e,focused:!1,title:(0,Y.jsx)(w().sA,{id:"search.filterMenu.moreFilters.createdBy",defaultMessage:"Created by"}),parentStore:t,userIds:o,onMenuDismiss:n,onChange:Ce("createdBy")})})}function Oe({mode:e,buttonPopupStore:t}){const n=(0,r.useCallback)((()=>Pe(t)),[t]),o=(0,u().K8)((()=>z().Ay.state.query.filters.createdTime),[]);return(0,Y.jsx)(ne().A,{mode:e,focused:!1,title:(0,Y.jsx)(w().sA,{id:"search.filterMenu.moreFilters.created",defaultMessage:"Created"}),icon:J().D,value:o,onMenuDismiss:n,onChange:Ce("createdTime")})}function Fe({mode:e,buttonPopupStore:t}){const n=(0,r.useCallback)((()=>Pe(t)),[t]),o=(0,u().K8)((()=>z().Ay.state.query.filters.lastEditedTime),[]);return(0,Y.jsx)(ne().A,{mode:e,focused:!1,title:(0,Y.jsx)(w().sA,{id:"search.filterMenu.moreFilters.lastEdited",defaultMessage:"Last edited"}),icon:J().D,value:o,onMenuDismiss:n,onChange:Ce("lastEditedTime")})}function De({mode:e,buttonPopupStore:t}){const n=(0,r.useCallback)((()=>Pe(t)),[t]),o=(0,u().K8)((()=>z().Ay.state.query.filters.inTeams),[]);return(0,u().K8)((()=>(0,te().zI)({spaceStore:(0,$().S)()})>0),[])?(0,Y.jsx)(N().SearchStoresContext.Consumer,{children:({parentStore:t})=>(0,Y.jsx)(ie().SZ,{mode:e,focused:!1,title:(0,Y.jsx)(w().sA,{id:"search.filterMenu.moreFilters.inTeams",defaultMessage:"Teamspace"}),parentStore:t,teamIds:o,onMenuDismiss:n,onChange:Ce("inTeams")})}):null}function qe({activeFilters:e,mode:t,buttonPopupStore:n}){return(0,Y.jsxs)(r.Fragment,{children:[e.createdBy?(0,Y.jsx)(Ee,{buttonPopupStore:n,mode:t}):void 0,e.createdTime?(0,Y.jsx)(Oe,{buttonPopupStore:n,mode:t}):void 0,e.lastEditedTime?(0,Y.jsx)(Fe,{buttonPopupStore:n,mode:t}):void 0,e.ancestors?(0,Y.jsx)(Re,{buttonPopupStore:n,mode:t}):void 0,e.inTeams?(0,Y.jsx)(De,{buttonPopupStore:n,mode:t}):void 0]})}function Le({buttonPopupStore:e}){return(0,Y.jsxs)(v().A,{menuType:y().gu.ActionSheet,children:[(0,Y.jsx)(fe,{onMenuDismiss:()=>Pe(e)}),(0,Y.jsxs)(ge().A,{title:(0,Y.jsx)(Ae,{}),children:[(0,Y.jsx)(Ee,{buttonPopupStore:e,mode:se().C.Button}),(0,Y.jsx)(Oe,{buttonPopupStore:e,mode:se().C.Button}),(0,Y.jsx)(Fe,{buttonPopupStore:e,mode:se().C.Button}),(0,Y.jsx)(Re,{buttonPopupStore:e,mode:se().C.Button}),(0,Y.jsx)(De,{buttonPopupStore:e,mode:se().C.Button})]})]})}const Ke=r.forwardRef((function({buttonPopupStore:e},t){const r=(0,u().K8)((()=>z().Ay.state.query.filters),[]),o=(0,u().K8)((()=>(0,n(850913).u)(r)),[r]);return(0,Y.jsxs)(Q().A,{ref:t,disableMobilePadding:!0,disableMobileBorders:!0,children:[(0,Y.jsx)(_e,{mode:se().C.Section}),(0,Y.jsx)(je,{mode:se().C.Section}),(0,Y.jsx)(qe,{buttonPopupStore:e,activeFilters:o,mode:se().C.Section})]})})),ze=r.forwardRef((function({buttonPopupStore:e},t){const n=(0,r.useCallback)((()=>(0,Y.jsx)(Le,{buttonPopupStore:e})),[e]);return(0,Y.jsx)(G().A,{ref:t,popupType:G().z.SlideUp,buttonPopupStore:e,renderOrigin:e=>(0,Y.jsx)(Ne,{...e}),render:n})}));n(581454);const Ve=function(e){const t=r.useRef(),o=(0,w().tz)(),{activeOption:i,items:a}=r.useMemo((()=>function(e){const{currentSortBy:t,setSortBy:n,sortOptions:r,selectButton:o,intl:i}=e;let a=r[0];const s=r.map((e=>{const r=t.field,s=`${r}.${"relevance"===r?"":t.direction}`,l=e.key===s;return l&&(a=e),{key:e.key,action:()=>{n(e.sort),o&&o.current&&o.current.closeMenu()},render:t=>(0,Y.jsx)(ce().A,{...t,title:i.formatMessage(e.formattedName),isChecked:l})}}));return{activeOption:a,items:s}}({...e,selectButton:t,intl:o})),[e,t,o]),s=(0,p().IS)((()=>({selectedTitle:{color:I().Tj.text.secondary},label:{marginInlineEnd:2,fontSize:W().Kw,transform:"translateY(0.5px)"},innerButton:{color:I().Tj.text.secondary,fontWeight:H().Wy.semibold,fontSize:W().Kw,height:20,padding:"2px 4px",marginInlineEnd:1,transform:"translateY(0.5px)"},menu:{minWidth:200}})),[]),l=d().A.isMobile?(0,Y.jsx)(w().sA,{id:"search.sort.sortMenuTitle",defaultMessage:"Sort By"}):void 0;return(0,Y.jsx)(n(942715).A,{ref:e=>{e&&(t.current=e)},alignmentToOrigin:"start",selectedTitle:(0,Y.jsx)("div",{style:s.selectedTitle,children:o.formatMessage(i.formattedName)}),label:void 0,renderMenuSections:()=>[{key:"searchSortOrder",render:e=>(0,Y.jsx)(ge().A,{...e,title:l,desktopStyle:s.menu,disableDesktopPadding:!1}),items:a}],labelStyle:s.label,innerButtonStyle:s.innerButton})};var Ue=()=>n(649265);const He=function({isPublicPageSearch:e}){const t={menuItemMobile:{paddingBottom:0},titleWrapper:{flex:void 0,marginTop:-3,marginBottom:-1},showSidebarButton:()=>({padding:"0 4px",fontSize:W().Kw,fontWeight:H().Wy.medium,borderRadius:4,height:20,lineHeight:"20px"})},n={...d().A.isMobile&&t.menuItemMobile},r=e?void 0:(0,Y.jsx)($e,{});return(0,Y.jsx)(U().Ay,{title:(0,Y.jsx)(We,{}),right:r,textWrapperStyle:t.titleWrapper,style:n})};function We(){const e=(0,u().K8)((()=>z().zw.state.sort),[]);return(0,Y.jsx)(Ve,{currentSortBy:e,setSortBy:e=>{z().Ay.setState({...z().Ay.state,query:{...z().Ay.state.query,sort:e}})},sortOptions:Ue().w_})}function $e(){return d().A.isMobile?(0,Y.jsx)(Me,{mode:ke.Button}):null}var Ge=()=>n(322183),Qe=()=>n(664594),Ye=()=>n(920198),Ze=()=>n(977570),Xe=()=>n(637307),Je=()=>n(633220),et=(n(944114),()=>n(381175)),tt=()=>n(127833),nt=()=>n(493552),rt=()=>n(452004),ot=()=>n(201980),it=()=>n(680977),at=()=>n(36951),st=()=>n(166442),lt=()=>n(383070),dt=()=>n(300789),ct=()=>n(360457),ut=()=>n(528093),pt=()=>n(547149),mt=()=>n(947171),ht=()=>n(757695),gt=()=>n(107975),ft=()=>n(406094),yt=()=>n(629604);const vt=ht().Store.createClass(!1,{name:"RequestModalOpenStore"}),bt=ht().Store.createClass(!1,{name:"ResponseModalOpenStore"});const xt=function({searchResultStore:e,shouldShow:t,showSpinner:r}){const o=(0,u().uB)(void 0,bt),i=(0,u().uB)(void 0,vt);return t?(0,Y.jsx)(n(476277).A,{title:(0,Y.jsx)(n(127720).A,{}),shouldShowReportBadSearchButton:!0,right:(0,Y.jsx)(wt,{searchResultStore:e,requestModalOpenStore:i,responseModalOpenStore:o})}):null};function St(){return{footer:()=>({display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",fontSize:W().vQ}),footerText:{fontSize:W().Kw,...H().RC},inlineHint:{display:"inline",marginInlineEnd:16},resultCountWrapper:{display:"flex",alignItems:"center",...H().RC},resultCount:{fontWeight:H().Wy.medium},resultText:{verticalAlign:"middle",marginInlineEnd:6},spinner:{display:"inline",width:12,height:12,verticalAlign:"middle"},keyboardShortcut:{marginInlineEnd:4,marginBottom:1,fontVariant:"all-small-caps",fontSize:1.1*W().Kw},commandGlyph:{fontSize:.75*W().vQ},debugModalStyle:{maxHeight:"90vh",maxWidth:"90vw",height:"90vh",width:"90vw",overflow:"scroll",padding:10},navigationHints:{marginInlineStart:15}}}function wt({searchResultStore:e,requestModalOpenStore:t,responseModalOpenStore:n}){const{debug:r,showDebugInfo:o}=(0,u().K8)((()=>{const{debug:e,showDebugInfo:t}=P().Ay.state;return{debug:e,showDebugInfo:t}}),[]),i=(0,u().K8)((()=>{var t;return null===(t=e.state.serverResults)||void 0===t||null===(t=t.debugInfo)||void 0===t?void 0:t.response}),[e]),a=(0,u().O$)(t),s=(0,u().O$)(n);if(!r&&!o)return null;const{rawRequests:l,rawResponses:d}=i||{};return(0,Y.jsxs)(Y.Fragment,{children:[l?(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(gt().a,{open:a,innerStyle:St().debugModalStyle,onDismiss:()=>{t.setState(!1)},render:()=>(0,Y.jsx)(yt().H,{showCopyButton:!0,defaultCollapsed:!1,data:l})}),(0,Y.jsx)(ft().A,{size:"sm",colorPalette:"gray",colorVariant:"tertiary",onClick:()=>t.setState(!0),children:"Open Request"})]}):void 0,d?(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(gt().a,{open:s,innerStyle:St().debugModalStyle,onDismiss:()=>{n.setState(!1)},render:()=>(0,Y.jsx)(yt().H,{showCopyButton:!0,data:{rawResponses:d},defaultCollapsed:!1})}),(0,Y.jsx)(ft().A,{size:"sm",colorPalette:"gray",colorVariant:"tertiary",onClick:()=>n.setState(!0),children:"Open Response"})]}):void 0]})}n(672577),n(430670);var It=n(440961),kt=()=>n(611648),Tt=()=>n(449279),Mt=()=>n(663639),Ct=()=>n(245241),jt=()=>n(883476),At=()=>n(915189),Bt=()=>n(376254),_t=()=>n(496067),Nt=()=>n(718807),Pt=()=>n(321874),Rt=()=>n(933593);function Et(e){const{searchResultStore:t}=e,n=(0,u().O$)(le().AppStoreSidebarSpaceStore),r=(0,u().K8)((()=>{var e;const r=t.state.currentlySelectedUniversalSearchResultView;if(!r||!n)return[];return((null===(e=t.state.universalResults)||void 0===e?void 0:e[r])??[]).flatMap((({key:e,result:t})=>((0,At().SF)(t,n)??[]).filter((e=>"notion"!==e.type)).map((t=>({key:e,result:t}))))).filter(ee().O9)}),[t,n]),o=(0,p().IS)((()=>({container:{display:"flex",flexDirection:"column",gap:10,paddingInlineStart:20,paddingInlineEnd:20},noResultsPrompt:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:I().Tj.text.tertiary}})),[]);return n?0===r.length?(0,Y.jsx)("div",{style:o.noResultsPrompt,children:(0,Y.jsx)(w().sA,{defaultMessage:"No results",id:"SearchResultsMenuList.NoResults"})}):(0,Y.jsx)(Bt().H,{type:kt().A.Y,style:o.container,children:r.map((({key:e,result:t},n)=>(0,Y.jsx)(jt().V,{result:t,position:n},e)))}):null}const Ot=r.memo((function(e){var t,o,i,a,s;const[l,m]=(0,r.useState)(!1),{searchResultStore:h,localResults:f,serverResults:y,resultListStore:v,searchExperimentOverrides:b,assistantResultItem:x,subscribeToTopicItem:S,extraTopPadding:I,comboboxProps:T,isQueryNaturalLanguageQuestion:M}=e,C=(0,p().IS)((()=>({results:{paddingTop:I?8:4,flex:1,display:"flex",flexDirection:"column",overflow:"auto",height:"100%",paddingInlineStart:4,paddingInlineEnd:4},messageMenuItem:{...d().A.isMobile&&{background:void 0,boxShadow:void 0}},debugMessageMenuItemTextStyle:{whiteSpace:"pre-wrap",fontFamily:"monospace",marginTop:0},menuListContainer:{display:"flex",flexDirection:"column",marginTop:d().A.isMobile?13:void 0,marginBottom:4},section:{marginBottom:4}})),[I]),j=(0,c().v3)(),A=e.errorState,B=(0,r.useCallback)((()=>{h.endTimeToRenderServerResultsTiming(j)}),[h,j]),_=(0,u().K8)((()=>h.state.queryBasedActionResults??[]),[h]),{isNewElectronTab:R,searchSessionId:E}=(0,u().K8)((()=>({isNewElectronTab:Boolean(K().default.state.isNewElectronTab),searchSessionId:K().default.state.sessionId})),[]),O=(0,u().K8)((()=>{const{tabs:e,currentTab:t}=n(92697).A.state;return(0,n(646969).i)(e,t.id)}),[]),F=(0,u().K8)((()=>(0,n(620333).mk)({searchSessionId:K().default.state.sessionId,searchSessionFlowNumber:n(384565).default.state.numServerRequests})),[]),D=(0,u().K8)((()=>0===_.length?[]:_.map((e=>(0,n(5374).g)({environment:j,result:e,queryId:F,desktopProps:{electronTabs:O,isNewElectronTabSearch:R},searchSessionId:E,source:"quick_find",action:t=>{"full_search"!==e.eventName&&Pt().st({environment:j,reset:!0,searchResultStore:h})}})))),[_,j,F,O,R,h,E]),q=(0,u().K8)((()=>lt().zD.isDeepFindEnabled()),[]),L=(0,u().K8)((()=>{if(!x&&!S)return;return{key:"search-results-actions-section",render:e=>(0,Y.jsx)(Q().A,{...e,shouldShowBottomDivider:!1,disableMobilePadding:!0,disableMobileBorders:!0,title:q?void 0:(0,Y.jsx)(w().sA,{id:"search.searchActions.actions.text",defaultMessage:"Actions"}),titleClassName:g().J5z,style:C.section}),items:k().oE([S,x])}}),[x,S,q,C.section]),V=((null==L?void 0:L.items.length)??0)+_.length,U=(0,u().K8)((()=>h.state.serverResultsLoading),[h]),H=(0,n(385979).h)({resultsCount:((null==f?void 0:f.length)??0)+D.length,shouldShow:U,variant:"search-modal"}),W=(0,n(87573).Y)(),$=(0,r.useMemo)((()=>(0,n(641934).H)({intentBasedGrouping:W,localResults:f,serverResults:y})),[W,f,y]),G=(0,r.useCallback)((t=>{const{results:n,sectionTitle:o,compact:i,additionalResults:a}=t,{id:s,title:l}=function(e){if(!e)return{id:"allSearchResults",title:void 0};switch(e.type){case"unique-id":return{id:"uniqueIdSearchResults",title:(0,Y.jsx)(w().sA,{id:"search.searchResultBuckets.uniqueID.text",defaultMessage:"ID matches"})};case"jump-back-in":return{id:"jumpBackInSearchResults",title:(0,Y.jsx)(w().sA,{id:"search.searchResultBuckets.topResults.text",defaultMessage:"Top results"})};case"server":return{id:"serverOnlySearchResults",title:(0,Y.jsx)(w().sA,{id:"search.searchResultBuckets.server.text",defaultMessage:"{count}{maybeLowerBoundSign} results",values:{count:e.values.count,maybeLowerBoundSign:e.values.isLowerBound?"+":""}})};case"main":return{id:"mainSearchResults",title:(0,Y.jsx)(w().sA,{id:"search.searchResultBuckets.bestMatches.text",defaultMessage:"Best matches"})};default:(0,ee().HB)(e)}}(o),d=Boolean(n.length+((null==a?void 0:a.length)??0)>0),c=H.length>0&&"main"===(null==o?void 0:o.type);if(d||c)return{key:s,render:e=>(0,Y.jsx)(Q().A,{...e,shouldShowBottomDivider:!1,disableMobilePadding:!0,disableMobileBorders:!0,title:l,titleClassName:g().J5z,style:C.section}),items:k().oE([...a??[],...n.map(((t,n)=>function(e){var t;const{selectedResult:n,index:o,props:i,compact:a,onEndTimeToRenderServerResults:s}=e,{store:l}=n;let d;d=n.workflowData||l.isNavigableBlock()?l:l.getNavigableBlockStore();if(!d)return;const c=r.createRef(),u=Boolean(P().Ay.getDebugLevel()),p=u&&n.sources.includes(Ct().Ni.Local)?{id:n.id,localSource:n.localSource,score:n.score,localRelevancies:n.localRelevancies,frecencyScore:n.frecencyScore,personalizationBoost:n.personalizationBoost,terms:n.terms}:void 0,m=u&&(n.sources.includes(Ct().Ni.ElasticSearch)||n.sources.includes(Ct().Ni.VectorDBBlock)||n.sources.includes(Ct().Ni.VectorDBCollection)||n.sources.includes(Ct().Ni.VectorDBBlockOpenAI)||n.sources.includes(Ct().Ni.VectorDBCollectionOpenAI)||n.sources.includes(Ct().Ni.VectorDBBlockBGE)||n.sources.includes(Ct().Ni.VectorDBCollectionBGE)||n.sources.includes(Ct().Ni.VectorDBBlockBGE1024)||n.sources.includes(Ct().Ni.VectorDBCollectionBGE1024)||n.sources.includes(Ct().Ni.VectorDBBlockBGE4096)||n.sources.includes(Ct().Ni.VectorDBCollectionBGE4096)||n.sources.includes(Ct().Ni.VectorDBBlockE5)||n.sources.includes(Ct().Ni.VectorDBCollectionE5))?null===(t=i.debugInfo)||void 0===t||null===(t=t.response)||void 0===t?void 0:t.resultsDebugMap[l.id]:void 0,h=i.clusterInfo;return{key:`${l.id}:${o}`,action:e=>{const{event:t}=e;function r(e){const n=It.findDOMNode(e.current);return Boolean(n&&"target"in t&&t.target&&(n===t.target||n.contains(t.target)))}c.current&&r(c)||i.handleSelectResult({event:e.event,index:{local:e.indexLocal,global:e.index},selectedResult:n,fromSidePeekPanel:!1,context:"query_results"})},render:e=>{var t;return(0,Y.jsx)(Rt().GC,{...e,index:o,isFirstInSection:0===o,store:d,hidePath:!1,result:n,className:g().LF7,debugLocal:p,debugHits:m,debugAreaRef:c,clusterInfo:h,inline:a&&!u,inlineCaptionMinWidthPercentage:20,queryId:null===(t=n.serverEventProperties)||void 0===t?void 0:t["server-queryId"],type:"query_results",onEndTimeToRenderServerResults:s})}}}({selectedResult:t,index:n,props:e,compact:i,onEndTimeToRenderServerResults:B}))),...H])}}),[H,C.section,e,B]),Z=(0,u().K8)((()=>G({results:"intent-based-grouping"===$.type?$.sections.jumpBackInSearchResults:[],additionalResults:void 0,sectionTitle:{type:"jump-back-in"},compact:!0})),[G,$.sections,$.type]),X=(0,u().K8)((()=>{const e="intent-based-grouping"===$.type?$.sections.serverOnlySearchResults:[],{count:t,isLowerBound:n}=h.getResultCount();return G({results:e,additionalResults:void 0,sectionTitle:{type:"server",values:{count:t,isLowerBound:n}},compact:!1})}),[G,$.sections,$.type,h]),J=(0,u().K8)((()=>G({results:"uniqueIdSearchResults"in $.sections?$.sections.uniqueIdSearchResults:[],additionalResults:void 0,sectionTitle:{type:"unique-id"},compact:!1})),[G,$.sections]),te=(0,u().K8)((()=>G({results:"unique-id"===$.type?$.sections.nonUniqueIdSearchResults:"all"===$.type?$.sections.allSearchResults:[],additionalResults:D,sectionTitle:"unique-id"===$.type||V>0?{type:"main"}:void 0,compact:!1})),[G,$.type,$.sections,D,V]),ne=[L,Z,J,X,te].filter(ee().O9),re=null===(t=e.debugInfo)||void 0===t||null===(t=t.response)||void 0===t?void 0:t.parsedQueries,oe=null===(o=e.debugInfo)||void 0===o||null===(o=o.response)||void 0===o?void 0:o.detectedLanguages,ie=null===(i=e.debugInfo)||void 0===i?void 0:i.traceLogs,ae=null===(a=e.debugInfo)||void 0===a||null===(a=a.response)||void 0===a?void 0:a.debugUrls,{onMaybeLoadMoreResults:se}=e,le=(0,r.useCallback)(((e,t)=>{const n=e<=200;n&&!l&&se(),m(n),t.offsetFromTop&&z().Ay.update((e=>({...e,hasScrolled:!0})))}),[l,se]),de=0===((null==f?void 0:f.length)??0)&&0===D.length&&"serverError"in A&&"NoResultsFound"===(null===(s=A.serverError)||void 0===s?void 0:s.type),ce=(0,r.useMemo)((()=>de?0:null!=L&&L.items.length?M?0:L.items.length:0),[de,null==L?void 0:L.items.length,M]);return(0,Y.jsx)(N().SearchStaticContext.Consumer,{children:({queryResultsSectionRef:e})=>(0,Y.jsxs)("section",{style:C.results,ref:e,children:[k().Im(b)?void 0:Dt((0,Y.jsx)(yt().H,{data:{searchExperimentOverrides:b},showCopyButton:!1,showModalButton:!1,defaultCollapsed:!1}),C.debugMessageMenuItemTextStyle),re?(0,Y.jsx)(Y.Fragment,{children:Dt((0,Y.jsx)(yt().H,{data:{parsedQueries:re},customCollapsedRenderers:[Vt],showCopyButton:!0,showModalButton:!0,defaultCollapsed:!0}),C.debugMessageMenuItemTextStyle)}):void 0,oe?Dt((0,Y.jsx)(yt().H,{data:{detectedLanguages:oe},customCollapsedRenderers:[Kt]}),C.debugMessageMenuItemTextStyle):void 0,ie?Dt((0,Y.jsx)(yt().H,{data:{tracer:{traceLogs:ie}},customCollapsedRenderers:[Lt],defaultCollapsed:!0}),C.debugMessageMenuItemTextStyle):void 0,ae?Dt((0,Y.jsx)(yt().H,{data:{debugUrls:ae},defaultCollapsed:!0,customCollapsedRenderers:[Ht],showCopyButton:!0,showModalButton:!0,maxLinkValueLength:40}),C.debugMessageMenuItemTextStyle):void 0,ne?(0,Y.jsx)("div",{className:"search-results-list",children:(0,Y.jsx)(Mt().A,{type:Mt().O.Vertical,initialFocus:ce,store:v,disableKeyboardArrowWrap:!0,sections:ne,style:C.menuListContainer,comboboxProps:T})}):void 0,Ft(j,A,C.messageMenuItem)||(0,Y.jsx)(n(498521).A,{onChange:le})]})})}));function Ft(e,t,r){if(!t.isLoading)return t.showMajorError?(0,Y.jsx)(n(770979).A,{error:t.serverError,handleSearchDeletedOnly:()=>{const t=z().Ay.state.query.text;Pt().st({environment:e,reset:!1}),_t().A.setState({..._t().A.state,open:!0}),Nt().Ay.setState({...Nt().Ay.state,filter:t})}}):t.serverError&&t.serverError!==Ct().yq.NoResults?function(e,t){return(0,Y.jsx)(Q().A,{disableMobilePadding:!0,disableMobileBorders:!0,children:(0,Y.jsx)(Tt().u,{title:e,style:t})})}(t.serverError.message,r):void 0}function Dt(e,t){return(0,Y.jsx)(Q().A,{disableMobilePadding:!0,disableMobileBorders:!0,topBorder:!1,style:{marginTop:0,paddingTop:0},children:(0,Y.jsx)(U().Ay,{body:e,bodyStyle:t})})}function qt(e){const t=e.replaceAll(/\(MatchNoDocsQuery\("Matching no documents because no terms present"\)\)\^[0-9\.]/g,"").replaceAll(/MatchNoDocsQuery\("Matching no documents because no terms present"\)/g,"").replaceAll(/ConstantScore\(([^)]+):([^)]+)\)/g,"<i>$1</i>:<b>$2</b>").replace(/function score \(\((.*)\), functions:.*\)/,"$1").replaceAll("( ","(").replaceAll(" )",")").replaceAll("|","| <br/>").replaceAll(/([^( ]+):"([^"]+)"/g,'<i>$1</i>:<b>"$2"</b>').replaceAll(/([^( ]+):([^) ]+)/g,"<i>$1</i>:<b>$2</b>");return(0,Y.jsx)("span",{dangerouslySetInnerHTML:{__html:t}})}function Lt({data:e,keyPath:t}){if("traceLogs"===(null==t?void 0:t[0])&&k().Qd(e)&&Array.isArray(e.log)&&e.log.length>0){const{log:t,startTimeMs:n}=e;return{element:(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)("div",{children:(0,Y.jsx)("b",{children:`Trace started at ${n}`})}),t.map(((e,t)=>(0,Y.jsxs)("div",{children:[(0,Y.jsx)("span",{style:Ut,children:`[${e.timestamp-n}ms][${e.callerFileName.split(".")[0]}]`}),(0,Y.jsx)("span",{children:`${e.msg}`})]},t)))]}),expanded:!1}}return null}function Kt({data:e,keyPath:t}){return"detectedLanguages"===t.join(".")&&k().Qd(e)?{element:(0,Y.jsx)(Y.Fragment,{children:Object.entries(e).filter((([e,t])=>Boolean(t))).map((([e])=>e)).join(", ")||"None"}),expanded:!1}:null}const zt=["type","description","time_in_nanos"];function Vt({data:e,keyPath:t}){var n,r;const o=e,i=Object.values(o).find((e=>void 0!==e));if(!i)return null;if(!zt.every((e=>i[e])))return null;if(1===t.length)return{element:qt(i.description),expanded:!1};let a=i.description??"";return null!==(n=a)&&void 0!==n&&n.includes("permissions.teamIds")&&(a="PermissionsQuery"),null!==(r=a)&&void 0!==r&&r.includes("(_id:[")&&(a="BoostRecentPageIds"),{element:qt(a),expanded:!1}}const Ut={color:"blue"};function Ht({data:e}){const t=e;if(!t)return null;const n=Object.values(t).find((({clusterName:e})=>void 0!==e));if(n){const{clusterName:e}=n;return{element:(0,Y.jsx)(Y.Fragment,{children:e}),expanded:!1}}return{element:(0,Y.jsx)(Y.Fragment,{children:"unknown"}),expanded:!1}}w().sA,w().sA;var Wt=()=>n(852507),$t=()=>n(148307),Gt=()=>n(683274);function Qt(){const[e,t]=(0,r.useState)(!1),n=(0,c().v3)(),o=(0,w().tz)(),i=$t().A.images.unifiedFind.searchDeepFindTooltipPng;(0,Wt().w)((()=>{const e=new Image;e.src=i,e.onload=()=>t(!0),e.onerror=()=>t(!0)}));const a=(0,u().K8)((()=>z().zw.state.text),[]),{isQuickSearch:s}=(0,r.useContext)(N().SearchStaticContext),l=(0,r.useCallback)((()=>(0,at().Iu)({environment:n,query:(0,ot().x9d)(a),clientStore:st().defaultClientAIChatStore,config:{type:"search",searchSessionId:K().default.state.sessionId,scopeForNextSearch:{type:"everything"}},openInNewTab:K().default.state.isNewElectronTab,openUsingQuickSearchHandler:s,surface:"search_modal"})),[n,s,a]);return e?(0,Y.jsx)(Gt().l,{messageKey:"search_unified_find_result_tooltip",title:o.formatMessage(Yt.title),imageUrl:i,badge:o.formatMessage(Yt.newBadge),body:o.formatMessage(Yt.body),button:{text:o.formatMessage(Yt.tryIt),onClick:()=>{l(),(0,dt().a)(n,"search_unified_find_result_tooltip")}}}):null}const Yt=(0,w().YK)({tryIt:{id:"UnifiedFindUpsellTooltip.tryIt",defaultMessage:"Try it"},title:{id:"UnifiedFindUpsellTooltip.title",defaultMessage:"Search all sources with AI"},body:{id:"UnifiedFindUpsellTooltip.body",defaultMessage:"Get instant answers across all your apps"},newBadge:{id:"UnifiedFindUpsellTooltip.newBadge",defaultMessage:"New"}});const Zt=(0,w().YK)({untitledWorkspace:{defaultMessage:"Untitled workspace",id:"searchResultsBody.askAiInUntitledWorkspacePlaceholder"},askAiInSpace:{id:"searchResultsBody.askAiInSpace",defaultMessage:"in {name}"},unifiedFindAskAiMenuItemTitle:{id:"searchResultsBody.unifiedFindAskAiMenuItem.title",defaultMessage:"Search all sources with AI"},subscribeToTopicMenuItemTitle:{id:"searchResultsBody.subscribeToTopicMenuItem.title",defaultMessage:"Subscribe to this topic"},askAiMenuItemServiceDown:{id:"searchResultsBody.askAiMenuItem.serviceDown",defaultMessage:" â€” {icon} AI is currently unavailable"},askAiMenuItemTitle:{id:"searchResultsBody.askAiMenuItem.title",defaultMessage:"Ask AI"}});const Xt=function(e){const{searchResultStore:t,sxsMode:o,searchDebugColumnStore:i,extraTopPadding:a,comboboxProps:s}=e,l=(0,c().v3)(),d=(0,w().tz)(),m=(0,u().O$)(le().AppStoreSidebarSpaceStore),h=(0,u().K8)((()=>z().zw.state.text),[]),g=(0,u().uB)(void 0,rt().$),f=(0,u().K8)((()=>g.state.focus),[g]),{handleSelectSearchResult:y,isQuickSearch:v}=(0,r.useContext)(N().SearchStaticContext),{localResults:b,serverResults:S,clusterInfo:k,debugInfo:T,serverResultsLoading:M,searchExperimentOverrides:C,hasPublicAccessPermission:_,serverResultsAllLoaded:P}=(0,u().K8)((()=>{var e,n;const{hasPublicAccessPermission:r}=(0,B().E)(l);return{localResults:t.state.localResults,serverResults:t.state.serverResults,serverResultsLoading:t.state.serverResultsLoading,clusterInfo:null===(e=t.state.serverResults)||void 0===e?void 0:e.clusterInfo,debugInfo:null===(n=t.state.serverResults)||void 0===n?void 0:n.debugInfo,searchExperimentOverrides:i.state.searchExperimentOverrides,hasPublicAccessPermission:r,serverResultsAllLoaded:t.state.serverResultsAllLoaded}}),[t,i,l]),R=(0,u().K8)((()=>t.state.errorState),[t]),E=(0,r.useCallback)((()=>{!M&&!P&&void 0!==S&&z().Ay.update((e=>({...e,limit:e.limit+z().ZK,isScrolled:!0,source:"quick_find_scroll"})))}),[M,P,S]),O=(0,u().K8)((()=>(0,j().y)({localResults:null==b?void 0:b.results,serverResults:null==S?void 0:S.results})??[]),[b,S]),F=(0,u().K8)((()=>{let e;return e=m?(0,n(574359).G)(l,m):d.formatMessage(Zt.untitledWorkspace),d.formatMessage(Zt.askAiInSpace,{name:e})}),[m,l,d]),D=(0,u().K8)((()=>lt().zD.isDeepFindEnabled()),[]),q=(0,u().K8)((()=>K().default.state.sessionId),[]),L=(0,u().K8)((()=>K().default.state.isNewElectronTab),[]),{isNaturalLanguageQueryWithCredits:V,aiSearchResultItemVariant:U,aiUsageAvailability:W,hasCreditsForAiUsage:$}=(0,n(957046).T)({query:h,searchSessionId:q}),G="auto_streaming"===U,Q=$||null==W?void 0:W.upsell,Z=(0,u().K8)((()=>n(639919).R.isUnifiedFindDown()),[]),X=(0,p().IS)((()=>({container:{display:"flex",flexDirection:"column",width:o?"50%":"100%",overflow:"hidden"},resultsContainer:{display:"flex",flex:1,overflowY:"scroll"},askAiQueryContainer:{display:"flex",flexDirection:"row",width:o?"50%":"100%",flex:1,overflow:"hidden",alignItems:"center",color:I().Tj.text.primary,fontWeight:H().Wy.medium,fontSize:14},unifiedFindInnerTitle:{display:"flex",gap:4,alignItems:"center",...H().RC},query:{fontWeight:H().Wy.regular,marginInlineStart:6,...H().RC},textOverflow:{display:"contents",...H().RC},aiUnavailable:{display:"flex",alignItems:"center",gap:4,...H().RC},styledTextQuery:{display:"inline",alignItems:"baseline",...H().RC}})),[o]),{handleClick:J}=(0,n(408543).C)({upsell:Q,source:"ai_unified_find_search_modal",spaceStore:m}),ee=(0,u().K8)((()=>z().Ay.state.query.filters),[]),te=(0,r.useCallback)((async e=>{var t,r,o;if(Z)return;if(!$)return void(await J());const i={metric:n(711339).default.mark("ai_input_to_transcript_render"),surface:"search_modal"};st().defaultClientAIChatStore.setState({...st().defaultClientAIChatStore.state,userInputToTranscriptRenderMetric:i});const a=null!=e&&e.event?(0,et().V)(e.event):void 0,s=L||"tab"===a,d={type:"search",searchSessionId:q,scopeForNextSearch:{type:"everything"},filtersForNextSearch:{dateRangeFilter:{startDate:null===(t=ee.lastEditedTime.starting)||void 0===t?void 0:t.start_date,endDate:null===(r=ee.lastEditedTime.ending)||void 0===r?void 0:r.start_date},createdByFilter:ee.createdBy,titleOnlyFilter:ee.navigableBlockContentOnly,ancestorsFilter:ee.ancestors,teamspacesFilter:Array.isArray(ee.inTeams)?ee.inTeams:null===(o=ee.inTeams)||void 0===o?void 0:o.teamIds}},{agentDeepFindEnabled:c,useReadOnlyMode:u}=(0,n(962753).mq)(l,null==m?void 0:m.id),p=c?(0,n(844317).getWorkflowAgentConfig)({useReadOnlyMode:u,searchSessionId:q}):d,g=c?["injectSearchTool"]:void 0;(0,at().Iu)({environment:l,query:(0,ot().x9d)(h),clientStore:st().defaultClientAIChatStore,config:p,openInNewTab:s,openUsingQuickSearchHandler:v,surface:"search_modal",initialAgentActions:g})}),[J,l,null==m?void 0:m.id,$,Z,L,v,h,ee,q]),{setDismissUnifiedFindUpsell:ne,hasUserDismissedSearchModalUnifiedFindComponent:re,canDismissUnifiedFindUpsell:oe}=function(){const{spaceId:e,userId:t}=(0,u().K8)((()=>{var e,t;return{spaceId:null===(e=le().AppStoreSidebarSpaceStore.state)||void 0===e?void 0:e.id,userId:null===(t=le().default.state.currentUserStore)||void 0===t?void 0:t.userId}}),[]),n=(0,ut()._)({name:"ai_usage",spaceId:e,userId:t,amount:1}),o="available"===(null==n?void 0:n.type),i=(0,u().K8)((()=>{const e=le().default.state.currentUserSettingsStore;if(!e)return!1;if(o)return!1;return Boolean(e.getSettingsStore().getKeyStore("ai_search_modal_item_dismissed_by_user_without_ai_at").getValue())}),[o]),a=(0,c().v3)(),s=(0,r.useCallback)((()=>{const e=le().default.state.currentUserSettingsStore;e&&pt().createAndCommit({userAction:"debuggingHelpers.resetAiSearchModalItemDismissed",environment:a,canUndo:!0,userId:t,perform:t=>{(0,it().m)({userSettingsStore:e,data:{ai_search_modal_item_dismissed_by_user_without_ai_at:Date.now()},transaction:t})}})}),[a,t]);return{setDismissUnifiedFindUpsell:s,hasUserDismissedSearchModalUnifiedFindComponent:i,canDismissUnifiedFindUpsell:!o}}(),ie=(0,n(59226).X)("topic_subscriptions_posts_in_feed"),ae=(0,c().WS)(),se=(0,r.useCallback)((()=>{if(ae)return;if("auto_streaming"===U||"none"===U||re)return;return{type:"assistant",renderTitle:()=>(0,Y.jsxs)("div",{className:"notranslate",style:X.askAiQueryContainer,children:[(0,Y.jsx)("span",{style:X.textOverflow,children:D?(0,Y.jsxs)("div",{style:X.unifiedFindInnerTitle,children:[d.formatMessage(G?Zt.askAiMenuItemTitle:Zt.unifiedFindAskAiMenuItemTitle),Z?(0,Y.jsx)(nt().D,{as:"span",styleKey:"captionRegular",colorVariant:"tertiary",style:X.aiUnavailable,children:d.formatMessage(Zt.askAiMenuItemServiceDown,{icon:(0,Y.jsx)(de().I,{icon:n(553034).C})})}):(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(n(834474).O,{}),(0,Y.jsx)(nt().D,{styleKey:"captionRegular",colorVariant:"tertiary",style:X.styledTextQuery,children:` â€” "${h}"`})]})]}):d.formatMessage(Zt.askAiMenuItemTitle)}),D?null:(0,Y.jsx)("span",{style:X.query,children:h.length>0?' "Search query"':` ${F}`})]}),action:te}}),[ae,U,re,D,X.unifiedFindInnerTitle,X.aiUnavailable,X.styledTextQuery,X.askAiQueryContainer,X.textOverflow,X.query,d,G,Z,h,F,te]),ce=(0,u().K8)((()=>{if(!n(131448).default.isVisible("search_unified_find_result_tooltip"))return!1;return l.WindowSizeStore.state.width>=1260&&!Boolean(v)&&!Z}),[l.WindowSizeStore,Z,v]),ue=(0,r.useRef)(null),pe=(0,r.useCallback)((()=>{if(h.trim()&&ie)return{key:"SubscribeToTopicMenuItem",action:()=>{const e=h.trim();n(568008).OY({environment:l,name:e,creator:"human"}),n(812182).Iz({message:`Topic "${e}" added to your subscriptions`,icon:n(562042).f,actions:{primary:{title:"Go to Home",onAction:()=>{const e=n(696746).XH("main");e&&e.load().then((()=>{e.canRead()&&n(857783).uK({environment:l,store:e,pageVisitSource:x().y8.PersonalHomeUnknown})}))}}},presentationType:"transient"})},render:e=>(0,Y.jsx)(mt().A,{...e,type:"topic",title:(0,Y.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,Y.jsx)("span",{children:d.formatMessage(Zt.subscribeToTopicMenuItemTitle)}),(0,Y.jsx)(nt().D,{as:"span",styleKey:"captionRegular",colorVariant:"tertiary",style:{marginInlineStart:6,...H().RC},children:` â€” new content related to "${h.trim()}" will show up in Home`})]})})}}),[l,d,h,ie]),me=(0,u().K8)((()=>{if(o||"default"!==K().default.state.searchMode)return;if("auto_streaming"===U){const e={key:"AssistantStreamingElement",action:e=>{if(!ue.current)return;const t=(0,et().V)(null==e?void 0:e.event),n=K().default.state.isNewElectronTab,r=Boolean("tab"===t||n);ue.current.navigateToThread({openInNewTab:r})},render:e=>(0,Y.jsx)(n(576907).bF,{query:h,searchFilters:ee,searchResultsStore:t,searchSessionId:K().default.state.sessionId,menuListItemProps:e,ref:ue})};return e}const e=se();return e?function(e){const{environment:t,item:n,key:r,shouldShowDeepFindTooltip:o,shouldShowDismissButton:i,onClickDismissButton:a}=e;return{key:"SearchResults.SearchAssistantMenuItem"+(r?`.${r}`:""),action:async e=>{await n.action(e),o&&(0,dt().a)(t,"search_unified_find_result_tooltip")},render:e=>(0,Y.jsx)(tt().zD,{open:o,trapFocus:!1,keepFocus:!0,preventCaptureEsc:!0,placementToOrigin:"right",alignmentToOrigin:"start",popupType:tt().nl.Popup,disableMouseCapture:!0,preventScaleTransition:!0,preventOpacityTransition:!0,origin:(0,Y.jsx)(mt().A,{...e,...n,onClickDismissButton:a,shouldShowDismissButton:i,title:n.renderTitle()}),render:()=>(0,Y.jsx)(Qt,{}),style:{backgroundColor:"transparent",boxShadow:"none",padding:0,overflow:"visible",bottom:ct().g,insetInlineStart:ct().g}})}}({environment:l,key:"AssistantMenuListSearchItem",item:e,shouldShowDeepFindTooltip:ce,shouldShowDismissButton:!re&&oe,onClickDismissButton:()=>ne()}):void 0}),[o,U,se,l,ce,re,oe,h,ee,t,ne],{useDeepEqual:!0}),he=(0,u().K8)((()=>pe()),[pe]),ge=(0,u().K8)((()=>{const e=[];he&&e.push({type:"assistant",value:h}),me&&e.push({type:"assistant",value:h}),t.update((t=>({...t,fixedActionResults:e})));return e.length}),[me,he,h,t]),fe=(0,r.useCallback)((e=>g.update((t=>t.focus.isInitialized&&0===t.focus.section&&0===t.focus.indexLocal&&0===t.focus.indexGlobal||void 0!==O&&void 0!==t.focus.indexGlobal&&t.focus.indexGlobal<=O.length?t:{...t,focus:e.numberOfFixedActionResults>0?{section:1,indexLocal:0,indexGlobal:e.numberOfFixedActionResults,footerFocused:!1}:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}}))),[g,O]),ye=!1;(0,u().K8)((()=>{z().Ay.state.isSidePeekPanelOpen!==ye&&z().Ay.update((e=>({...e,isSidePeekPanelOpen:ye})))}),[ye]),(0,r.useEffect)((()=>{fe({numberOfFixedActionResults:ge})}),[O,ge,fe]),(0,r.useEffect)((()=>{void 0!==f.section&&void 0!==f.indexLocal&&void 0!==f.indexGlobal?t.update((e=>({...e,focusedIndex:{local:{section:f.section,indexLocal:f.indexLocal},global:f.indexGlobal}}))):t.update((e=>({...e,focusedIndex:void 0})))}),[f,t]),(0,u().K8)((()=>A({searchResultStore:t})),[t]);const ve=(0,u().K8)((()=>Boolean(t.state.currentlySelectedUniversalSearchResultView)),[t]);return(0,Y.jsxs)("div",{style:X.container,children:[ve?(0,Y.jsx)(Et,{searchResultStore:t}):(0,Y.jsxs)("div",{style:X.resultsContainer,children:[(0,Y.jsx)(Ot,{errorState:R,handleSelectResult:y,onMaybeLoadMoreResults:E,resultListStore:g,searchResultStore:t,localResults:null==b?void 0:b.results,serverResults:null==S?void 0:S.results,debugInfo:T,clusterInfo:k,publicAccessPermission:_,searchExperimentOverrides:C,assistantResultItem:me,subscribeToTopicItem:he,extraTopPadding:a,comboboxProps:s,isQueryNaturalLanguageQuestion:V}),null]}),(0,Y.jsx)(xt,{searchResultStore:t,showSpinner:M,shouldShow:!0})]})};const Jt=function(e){const{onSelect:t,comboboxProps:n}=e,o=(0,u().uB)(void 0,rt().$),i=(0,Ze().F)({}),a=(0,p().IS)((()=>({wrapper:{width:"100%",height:"100%",overflowX:"hidden",overflowY:"auto"}})),[]),s=(0,r.useMemo)((()=>i?i.results.map((e=>({key:e.store.id,render:t=>(0,Y.jsx)(Rt().GC,{...t,store:e.store,inline:!d().A.isMobile,hidePath:!1,buttonStyle:{paddingInlineStart:1},type:"recent_pages"}),action:n=>t({index:{local:n.indexLocal,global:n.index},event:n.event,selectedResult:e,fromSidePeekPanel:!1,context:"recent_pages"})}))):[]),[i,t]),l=(0,r.useMemo)((()=>[{key:"pages",items:s,render:e=>(0,Y.jsx)(Q().A,{title:(0,Y.jsx)(w().sA,{id:"search.default_page_body.pages",defaultMessage:"Pages"}),children:e.children})}]),[s]);return i?(0,Y.jsx)("div",{style:a.wrapper,children:(0,Y.jsx)(Mt().A,{store:o,type:Mt().O.Vertical,initialFocus:0,disableKeyboardArrowWrap:!0,sections:l,unfocusOnScroll:!0,comboboxProps:n})}):null};function en(e){const{searchContentPaneType:t,comboboxProps:n}=e,o=(0,Qe().T)(),i=(0,c().v3)(),{searchMobileFilterMenuRef:a,handleSelectSearchResult:s,searchResultStore:l,secondarySearchResultStore:m,handlePopupOpen:h,handlePopupClose:g}=(0,r.useContext)(N().SearchStaticContext),{parentStore:f}=(0,r.useContext)(N().SearchStoresContext),y=(0,u().K8)((()=>Boolean((0,P().I5)()&&P().nS.state.visible)),[]),v=(0,u().K8)((()=>{const e=l.state.errorState;return!1===e.isLoading&&e.showMajorError}),[l]),b=(0,p().IS)((()=>({sxsContainer:{display:"flex",flexDirection:"row",height:"100%",overflow:"hidden",maxWidth:"100%"}})),[]),x=(0,u().K8)((()=>z().zw.state.filters),[]),{shouldShowFilterBar:S,sort:w}=(0,u().K8)((()=>({shouldShowFilterBar:z().Ay.state.filterBar.show,sort:z().Ay.state.query.sort})),[]),I=(0,r.useCallback)((e=>z().Ay.updateFilters(e)),[]),k=(0,r.useCallback)((e=>{z().Ay.updateSort(e)}),[]),T=!d().A.isMobile&&!S,M=(0,r.useMemo)((()=>({searchResultStore:l,searchDebugColumnStore:P().E,sxsMode:y,extraTopPadding:T,comboboxProps:n})),[T,l,y,n]),C=(0,Ye().L)(),j=(0,u().K8)((()=>(0,Ze().a)({spaceStore:C,environment:i}).shouldShow),[C,i]);return(0,Y.jsxs)(Y.Fragment,{children:[!d().A.isMobile&&S&&o?(0,Y.jsx)(Je().S,{filters:x,onFiltersChange:I,sort:w,onSortChange:k,parentStore:f,onPopupOpen:h,onPopupClose:g}):void 0,"search_results"===t?(0,Y.jsxs)(Y.Fragment,{children:[!v&&d().A.isMobile?(0,Y.jsx)(Me,{mode:ke.Section,ref:a}):void 0,(0,Y.jsxs)("div",{style:b.sxsContainer,children:[(0,Y.jsx)(Xt,{...M}),y?(0,Y.jsx)(Xt,{...M,searchResultStore:m,searchDebugColumnStore:P().nS}):void 0]})]}):C?(0,Y.jsx)(Xe().Ay,{onSelect:s,spaceStore:C,extraTopPadding:T,comboboxProps:n}):j?(0,Y.jsx)(Jt,{onSelect:s,comboboxProps:n}):null]})}const tn=570,nn=500;function rn(e){const t=(0,c().v3)();return(0,r.useEffect)((()=>{(0,C().Dd)()||L().G(t,"searchContentPane")}),[t]),function(){const{searchResultStore:e,secondarySearchResultStore:t}=(0,r.useContext)(N().SearchStaticContext),{parentStore:n}=(0,r.useContext)(N().SearchStoresContext),o=(0,R().Nu)(n),i=(0,u().K8)((()=>Boolean((0,P().I5)()&&P().nS.state.visible)),[]);(0,R().nR)({dependencies:o,searchResultStore:e,debugColumnStore:P().E,enabled:!0,serverSearchFn:E}),(0,R().nR)({dependencies:o,searchResultStore:t,debugColumnStore:P().nS,enabled:i,serverSearchFn:O,preventUpdateSearchMetrics:!0})}(),(0,F().A)({shouldPreserveTextSelection:!0,shouldPreserveBlockSelection:!0,shouldRestoreSelection:!d().A.isMobile}),(0,Y.jsx)(a().A,{capture:!0,allowMenuList:!0,render:t=>(0,Y.jsx)(on,{...e,ignoreAreaEvents:t})})}function on(e){const{ignoreAreaEvents:t,quickSearchMode:n,onClose:a,searchContentPaneType:s}=e,{handleQueryChange:f,modalBodyMenuRef:S,searchResultStore:w,defaultBodyFocusedResult:C,handleCopySearchItemLink:j}=(0,r.useContext)(N().SearchStaticContext),[_,P]=(0,r.useState)(!1),[R,E]=(0,r.useState)(!1),[O,F]=(0,b().$)(),L=(0,c().v3)(),U=(0,c().Y0)(),H=(0,u().K8)((()=>z().Ay.state.query.text),[]),{isSearchMenuOpen:W,shouldShowDebugSidebar:$,hasPublicAccessPermission:G,shouldShowSpinner:Q}=(0,u().K8)((()=>{const e=Boolean(m().A.state.online),{hasPublicAccessPermission:t}=(0,B().E)(L);return{isSearchMenuOpen:K().default.state.open,shouldShowSpinner:e&&Boolean(H)&&w.state.serverResultsLoading&&!_,shouldShowDebugSidebar:dn({device:U,isPublicAccessPermissionForPage:t}),hasPublicAccessPermission:t}}),[_,w,U,L,H]),Z=(0,r.useMemo)((()=>k().sg((()=>{const{activeElement:e}=document;e instanceof HTMLInputElement&&e.blur()}),nn,{leading:!0})),[]),X=(0,r.useCallback)((()=>{R&&Z()}),[Z,R]),J=(0,r.useCallback)((e=>{E(e),e||U.isMobileNative&&q().m(L,h().i.willHide,0)}),[U.isMobileNative,L]),ee=(0,u().K8)((()=>A({searchResultStore:w})),[w]),te=C,ne=(0,r.useMemo)((()=>(0,Y.jsx)(Ge().Ay,{isOpen:n||W,onTypingChange:P,onFocusChange:J,showSpinner:Q,onQueryChange:f,quickSearchMode:n,selectedResultStore:"page_result"===(null==ee?void 0:ee.type)?ee.value.selectedResult.store:void 0,inputComboboxProps:O,searchResultStore:w})),[W,J,Q,f,n,ee,O,w]),re=(0,u().K8)((()=>an({searchContentPaneType:s,quickSearchMode:n,environment:L})),[s,n,L]),oe=(0,p().IS)((()=>({body:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column",zIndex:2},topbar:{height:void 0,marginTop:10,marginInlineStart:16,marginBottom:10,marginInlineEnd:16},topbarRightButtonWrapper:{flex:void 0,paddingInlineStart:16},topbarButton:{fontWeight:void 0,padding:0,color:I().Tj.text.secondary},scroller:{display:"flex",flexDirection:"row",flexWrap:"nowrap",justifyContent:"space-between",maxHeight:re.maxHeight,minHeight:re.minHeight}})),[re.maxHeight,re.minHeight]),ie=(0,r.useMemo)((()=>{if(d().A.isMobile){return{menuType:y().gu.Modal,left:ne,shouldRenderLeftDirectly:!0,width:n?"100vw":void 0,...sn({style:oe.topbarRightButtonWrapper,quickSearchMode:n,onClick:a}),header:"search_results"===s&&(0,Y.jsx)(He,{isPublicPageSearch:G}),disableHeaderShadow:!0,topbarStyle:oe.topbar,leftRightButtonStyle:oe.topbarButton,onScroll:ln(U)?X:void 0,bodyScrollerClassName:g().Smt,...t}}return{menuType:y().gu.Popup,maxHeight:re.maxHeight,minHeight:re.minHeight,maxWidth:"100%",...n?{width:"100vw"}:{},disableScroller:!0,scrollerStyle:oe.scroller,...t}}),[U,oe,t,ne,a,s,G,X,re.minHeight,re.maxHeight,n]),ae=te||ee,se=(0,r.useCallback)((e=>{if("page_result"!==(null==ae?void 0:ae.type))return;const{index:t,selectedResult:n}=ae.value;j({index:t,selectedResult:n,fromSidePeekPanel:e.source===T().rD.SidePeekPanel,context:"search_results"===s?"query_results":"recent_pages",source:e.source})}),[j,s,ae]),le=(0,r.useCallback)((async()=>{if(!L.device.isElectron||!ae||"page_result"!==ae.type)return;const e=ae.value.selectedResult.store,t=(0,M().J8)({store:e,collectionViewId:e.id,fullyQualified:!0,pageVisitSource:x().y8.SearchQuery});if(!t)return;const[n,r]=await Promise.all([(0,o().r)(),(0,i().jd)()]);r({environment:L,stringValue:t,copiedMessage:n.copiedLinkToClipboard}),se({source:T().rD.KeyboardShortcut})}),[L,se,ae]);return(0,Y.jsx)(l().N,{debugName:"SearchContentPane",capture:!0,onCopyLinkToCurrentPage:e=>{le()},onCopyLinkToPageInCommandSearch:e=>{le()},children:(0,Y.jsxs)(v().A,{...ie,className:g().Y0h,ref:S,children:[(0,Y.jsxs)("div",{style:oe.body,children:[(0,Y.jsx)(D().A,{}),d().A.isMobile?void 0:ne,(0,Y.jsx)(en,{searchContentPaneType:s,comboboxProps:F})]}),$?(0,Y.jsx)(V().s,{}):void 0]})})}function an(e){const{searchContentPaneType:t,quickSearchMode:n,environment:r}=e,o=s().default.getEligibleGroup({experimentId:"search_highlight_client_variant",defaultGroup:"control"});if(n)return{maxHeight:"100vh",minHeight:"100vh"};const i="two_pane_1_snippet"===o,a=r.WindowSizeStore.state.height,l=(0,S().jq)(r.device.isElectronMac),d="inline_2_snippets"===o,c=d?"search_results"===t?790:600:i?700:tn,u=`max(${"search_results"===t?i?70:d?80:70:i?70:d?65:50}vh, ${a>c+l?c:0}px)`;return{minHeight:u,maxHeight:u}}function sn({style:e,quickSearchMode:t,onClick:n}){return t?{rightOuterStyle:{display:"none"}}:{right:(0,Y.jsx)(w().sA,{...f().W.cancel}),onClickRight:n,rightOuterStyle:e}}function ln(e){return!!d().A.isMobile&&(!e.isIOS||e.isMobileNative)}function dn({device:e,isPublicAccessPermissionForPage:t}){return!t&&(!d().A.isMobile&&z().Ay.isDebugSidebarOpen())}},333603:(e,t,n)=>{n.d(t,{Y:()=>o});n(296540);const r={viewBox:"0 0 16 16",fittedViewBox:"3.05 4.97 9.9 5.58",svg:(0,n(474848).jsx)("path",{d:"M8.442 5.158a.625.625 0 0 0-.884 0l-4.32 4.32a.625.625 0 1 0 .884.884L8 6.484l3.878 3.878a.625.625 0 1 0 .884-.884z"})},o=(0,n(340498).wt)("arrowChevronSingleUpSmall",r,"small")},344235:(e,t,n)=>{n.d(t,{s:()=>O});n(581454);var r=n(296540),o=()=>n(242422),i=()=>n(726637),a=()=>n(590526),s=()=>n(420802),l=()=>n(81068),d=()=>n(563217),c=()=>n(281844),u=()=>n(69708),p=()=>n(100622),m=()=>n(534177),h=()=>n(795783),g=()=>n(322976),f=()=>n(461131),y=()=>n(287234),v=()=>n(401497),b=()=>n(250910),x=()=>n(546926),S=()=>n(631524),w=()=>n(890492),I=()=>n(663639),k=()=>n(736847),T=()=>n(324254),M=n(474848);function C(e){return(0,M.jsx)(b().A,{popupType:i().A.isMobile?b().z.SlideUp:b().z.Popup,renderOrigin:t=>(0,M.jsx)(A,{events:t,...e}),render:t=>(0,M.jsx)(j,{parent:t,...e})})}function j({parent:e,experiment:t,onChange:n}){const r=(0,v().IS)((()=>({menuOptionStyle:{color:p().oZ.mediumTextColor}})),[]);let o;o=i().A.isMobile?{menuType:x().gu.Modal,title:t.experimentId,right:(0,M.jsx)(u().sA,{defaultMessage:"Done",id:"appearanceSettings.modal.done"}),onClickRight:e.close}:{menuType:x().gu.Popup,width:250};const a=t.groups.map((o=>({key:o,action:r=>{n({experimentId:t.experimentId,group:o}),e.close()},render:(e,t)=>(0,M.jsx)(l().A,{...e,title:o,style:r.menuOptionStyle})})));return(0,M.jsx)(w().A,{...o,children:(0,M.jsx)(I().A,{type:I().O.Vertical,initialFocus:void 0,sections:[{key:t.experimentId,render:e=>(0,M.jsx)(k().A,{...e}),items:a}]})})}function A({experiment:e,events:t,searchExperimentOverrides:n}){const o=(0,v().IS)((()=>({experimentGroupButtonStyle:{overflowX:"hidden",justifyContent:"left",overflow:"hidden",marginInlineStart:6,color:p().Tj.text.secondary},rowContainer:{display:"flex",overflow:"hidden",flexDirection:"row"},groupCell:{overflow:"hidden"}})),[]);return(0,r.createElement)(S().p,{...t,size:"sm",key:e.experimentId,style:o.experimentGroupButtonStyle,iconTrailing:{icon:T().arrowChevronSingleDownSmallIcon,colorVariant:"tertiary",size:"xs"}},(0,M.jsx)("div",{style:o.rowContainer,children:(0,M.jsx)("div",{style:o.groupCell,children:n[e.experimentId]||e.group})}))}function B(){return{fontSize:14,lineHeight:1.2,color:p().Tj.text.secondary,marginInlineEnd:4,display:"flex",alignItems:"center",whiteSpace:"nowrap"}}const _=function(e){const{experiment:t}=e,{leftPaneDebugOverrides:n,rightPaneDebugOverrides:o,experimentDiffers:i,experimentAgreesButNondefault:s}=(0,a().K8)((()=>{const e=f().E.state.searchExperimentOverrides,n=f().nS.state.searchExperimentOverrides,r=(e[t.experimentId]??t.group)!==(n[t.experimentId]??t.group);return{leftPaneDebugOverrides:e,rightPaneDebugOverrides:n,experimentDiffers:r,experimentAgreesButNondefault:!r&&void 0!==n[t.experimentId]&&e[t.experimentId]!==t.group}}),[t]),l=(0,v().IS)((()=>({rowContainer:{backgroundColor:i?p().Tj.red.background.secondary:s?p().Tj.yellow.background.secondary:void 0},titleCell:{...B(),maxWidth:180,textOverflow:"ellipsis",overflow:"hidden"}})),[s,i]),d=(0,r.useCallback)((e=>{const{experimentId:t,group:n,store:r}=e;r.setState({...r.state,searchExperimentOverrides:{...r.state.searchExperimentOverrides,[t]:n}})}),[]);return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("div",{style:{...l.titleCell,...l.rowContainer},title:t.experimentId,children:t.experimentId.replace("search-","")}),(0,M.jsx)("div",{style:l.rowContainer,children:(0,M.jsx)(C,{experiment:t,searchExperimentOverrides:n,onChange:e=>{d({...e,store:f().E})}})}),(0,M.jsx)("div",{style:l.rowContainer,children:(0,M.jsx)(C,{experiment:t,searchExperimentOverrides:o,onChange:e=>{d({...e,store:f().nS})}})})]})};var N=()=>n(385226),P=()=>n(717137),R=()=>n(31511);function E(e){const{leftValue:t,rightValue:n,setLeftValue:o,setRightValue:i,placeholder:a,label:s}=e,{titleCell:l,rightTitleCell:d,leftTitleCell:c}=(0,v().IS)((()=>{const e=B();return{titleCell:e,rightTitleCell:{...e,color:n?e.color:p().Tj.text.tertiary,width:"95%"},leftTitleCell:{...e,color:t?e.color:p().Tj.text.tertiary,width:"95%"}}}),[t,n]),[u,m]=(0,r.useState)(n),[h,g]=(0,r.useState)(t);(0,r.useEffect)((()=>{void 0===n&&m(void 0),void 0===t&&g(void 0)}),[n,t]);const f=(0,r.useCallback)((()=>{i(u)}),[i,u]),y=(0,r.useCallback)((()=>{o(h)}),[o,h]),b=(0,r.useCallback)((e=>{m(e.target.value)}),[]),x=(0,r.useCallback)((e=>{g(e.target.value)}),[]);return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("div",{style:l,children:s}),(0,M.jsxs)(P().A,{debugName:"SearchStringOverrideControls",capture:!0,allowMenuList:!1,children:[(0,M.jsx)(R().A,{style:c,onBlur:y,value:h,onChange:x,placeholder:a}),(0,M.jsx)(R().A,{style:d,onBlur:f,value:u,onChange:b,placeholder:a})]})]})}function O(){const e=(0,r.useRef)(null),t=(0,a().K8)((()=>(0,m().WP)(d().hH).map((([e,t])=>({experimentId:e,experimentVersion:1,group:o().default.getEligibleGroup({experimentId:e,defaultGroup:"control"}),groups:["control",...t]})))),[]);return(0,M.jsx)(F,{ref:e,searchExperimentsToToggle:t})}const F=r.forwardRef((function({searchExperimentsToToggle:e},t){const r=(0,n(484714).v3)(),o=(0,u().tz)(),i={sidebar:{display:"flex",flexDirection:"column",width:380,minWidth:380,flexShrink:0,minHeight:400,height:"100%"},sidebarHidden:{display:"none"},header:{display:"flex",alignItems:"center",justifyContent:"flex-end",paddingTop:8,paddingBottom:8,paddingInlineEnd:8,paddingInlineStart:12,flexShrink:0,borderBottom:"1px solid rgba(55, 53, 47, 0.09)"},scrollableContent:{flex:1,overflowY:"auto",overflowX:"auto",paddingTop:12,paddingBottom:24}},s=D(),l=(0,a().K8)((()=>y().Ay.isDebugSidebarOpen()),[]),d=(0,a().K8)((()=>(0,n(87573).q)(r)),[r]),c={...i.sidebar,...s.sidebar,...!l&&i.sidebarHidden};return(0,M.jsxs)("aside",{ref:t,style:c,children:[(0,M.jsxs)("div",{style:i.header,children:[(0,M.jsx)("div",{style:{flex:1}}),(0,M.jsx)(n(695115).A,{onClick:W,icon:n(995847).xMarkSmallIcon,ariaLabel:o.formatMessage($.closeDebugSidebar),style:{...d&&(0,n(130119).g)({noDrag:!0})}})]}),(0,M.jsx)("div",{style:i.scrollableContent,children:(0,M.jsx)(q,{searchExperimentsToToggle:e})})]})}));function D(){return{sidebar:{backgroundColor:p().Tj.sidebarSecondaryBackground,borderInlineStart:`1px solid ${p().Tj.border.secondaryTranslucent}`}}}function q({searchExperimentsToToggle:e}){const{leftForcedClusterPattern:t,rightForcedClusterPattern:r,leftForcedBlockIds:s,rightForcedBlockIds:l}=(0,a().K8)((()=>({leftForcedClusterPattern:f().E.state.forcedClusterPattern,rightForcedClusterPattern:f().nS.state.forcedClusterPattern,leftForcedBlockIds:f().E.state.forcedBlockIds,rightForcedBlockIds:f().nS.state.forcedBlockIds})),[]);return(0,a().K8)((()=>(0,n(211134).PF)({env:"production",isAdminMode:i().A.isAdminMode,experimentService:o().default})),[])?(0,M.jsx)(N().A,{title:"Dev Tools",children:(0,M.jsxs)(n(756117).A,{animate:{height:"100%"},style:{overflow:"scroll"},children:[(0,M.jsx)(V,{}),(0,M.jsx)(U,{}),(0,M.jsx)(H,{}),(0,M.jsx)(z,{}),(0,M.jsxs)(N().A,{style:{marginTop:16},title:"Quick Switch",children:[(0,M.jsx)(K,{title:"No local at all",searchExperimentOverrides:{"search-no-local-blending":"on","search-debug-only-no-recent-boosting":"on"}}),(0,M.jsx)(K,{title:"No local results",searchExperimentOverrides:{"search-no-local-blending":"on"}}),(0,M.jsx)(K,{title:"No local boosting",searchExperimentOverrides:{"search-debug-only-no-recent-boosting":"on"}})]}),(0,M.jsx)(N().A,{style:{marginTop:16},title:"Dev Experiments",right:(0,M.jsx)(n(124092).p,{onClick:()=>{f().E.reset(),f().nS.reset()},style:{paddingInlineStart:0,paddingInlineEnd:0,height:"unset"},children:(0,M.jsx)(n(807449).I,{icon:n(477336).l,size:"sm"})}),children:(0,M.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"minmax(140px, 1fr) 100px 100px",gap:"8px",minWidth:"100%",maxWidth:"100%",paddingInlineStart:14},children:[(0,M.jsx)("div",{}),(0,M.jsx)("div",{}),(0,M.jsx)(L,{columnStore:f().nS}),e.map((e=>(0,M.jsx)(_,{experiment:e},e.experimentId))),(0,M.jsx)(E,{leftValue:t,rightValue:r,setLeftValue:e=>f().E.updateForcedClusterPattern(e),setRightValue:e=>f().nS.updateForcedClusterPattern(e),placeholder:"cluster-pattern",label:"forced cluster pattern"}),(0,M.jsx)(E,{leftValue:s,rightValue:l,setLeftValue:e=>f().E.updateForcedBlockIds(e),setRightValue:e=>f().nS.updateForcedBlockIds(e),placeholder:"block ids",label:"forced block ids"})]})})]})}):null}function L({columnStore:e}){const t=(0,a().K8)((()=>e.state.visible),[e]);return(0,M.jsx)(l().A,{icon:(0,M.jsx)(s().S,{checked:t,size:14,onClick:()=>e.update((e=>({...e,visible:!e.visible})))}),focused:!1,title:"Show",onClick:()=>e.update((e=>({...e,visible:!e.visible})))})}function K({title:e,searchExperimentOverrides:t}){return(0,M.jsx)(l().A,{focused:!1,title:e,onClick:()=>{f().nS.update((e=>({...e,visible:!1}))),f().E.update((e=>({...e,searchExperimentOverrides:t})))}})}function z(){return null}function V(){const e=(0,a().K8)((()=>f().Ay.state.showDebugInfo),[]);return(0,M.jsx)(h().J,{mode:g().C.Button,focused:!1,title:"Show debug info",icon:c().v,value:e,onChange:e=>{f().Ay.setState({...f().Ay.state,showDebugInfo:Boolean(e)})}})}function U(){const e=(0,a().K8)((()=>f().Ay.state.autoExpandDebugInfo),[]);return(0,M.jsx)(h().J,{mode:g().C.Button,focused:!1,title:"Auto-expand debug info",icon:c().v,value:e,onChange:e=>{f().Ay.setState({...f().Ay.state,autoExpandDebugInfo:Boolean(e)})}})}function H(){const e=(0,a().K8)((()=>"everything"===f().Ay.state.debug),[]);return(0,M.jsx)(h().J,{mode:g().C.Button,focused:!1,title:"Profile query",icon:c().v,value:e,onChange:e=>{f().Ay.setState({...f().Ay.state,debug:e?"everything":void 0})}})}function W(){y().Ay.update((e=>({...e,isDebugSidebarOpen:!1})))}const $=(0,u().YK)({closeDebugSidebar:{id:"searchDebugSidebar.close",defaultMessage:"Close debug sidebar"}})},358579:(e,t,n)=>{n.d(t,{Z:()=>i});n(898992),n(430670);var r=()=>n(371621),o=()=>n(980382);function i(e){const{environment:t,sessionContext:n}=e,i=n.getAllPendingExecutableOperations();if(0===i.length)return;const a=i.flatMap((({operations:e})=>e));(0,r().gv)({environment:t,operations:a,caches:n.caches,attributionActor:n.attributionActorFromStoreState}),(0,o().I)({environment:t,assistantSessionContext:n})}},360457:(e,t,n)=>{n.d(t,{S:()=>h,g:()=>m});n(296540);var r=()=>n(401497),o=()=>n(699143),i=()=>n(695115),a=()=>n(406094),s=()=>n(493552),l=()=>n(995847),d=()=>n(69708),c=()=>n(100622),u=()=>n(738471),p=n(474848);const m=8;function h(e){const{title:t,body:n,button:h,imageUrl:g,onDismiss:f,badge:y}=e,v=(0,d().tz)(),b=(0,r().IS)((()=>({container:{backgroundColor:"transparent",margin:m,display:"flex"},card:{maxWidth:232,minWidth:232,borderRadius:12,border:`1px solid ${c().Tj.border.primary}`,boxShadow:"0px 12px 36px -6px rgba(29, 27, 22, 0.08)",position:"relative",backgroundColor:c().Tj.background.elevated},dismissButton:{position:"absolute",top:12,insetInlineEnd:12,width:24,height:24,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:12,background:c().Tj.background.elevated},dismissButtonHover:{background:c().Tj.whiteButtonHoveredBackground},image:{background:"white",borderStartStartRadius:12,borderStartEndRadius:12,alignSelf:"stretch",height:142,width:"100%",objectFit:"cover"},badge:{display:"flex",alignItems:"center",justifyContent:"center",height:16,padding:"0px 4px",gap:2,borderRadius:4,background:c().Tj.blue.background.secondaryTranslucent,width:"fit-content"}})),[]);return(0,p.jsx)("div",{style:b.container,children:(0,p.jsxs)(o().Y1,{direction:"vertical",style:b.card,children:[(0,p.jsx)(u().A,{src:g,style:b.image}),(0,p.jsxs)(o().Y1,{gap:6,padding:"12px 16px 12px 12px",children:["string"==typeof y?(0,p.jsx)("div",{style:b.badge,children:(0,p.jsx)(s().D,{styleKey:"captionSmMedium",colorPalette:"blue",colorVariant:"accentPrimary",children:y})}):y,(0,p.jsx)(s().D,{styleKey:"bodySemibold",colorVariant:"primary",children:t}),(0,p.jsx)(s().D,{styleKey:"bodyRegular",colorVariant:"secondary",children:n})]}),(0,p.jsx)(o().Y1,{padding:"0px 12px 12px 12px",children:(0,p.jsx)(a().A,{size:"md",onClick:()=>h.onClick(),children:(0,p.jsx)(s().D,{styleKey:"bodyMedium",colorVariant:"primary",children:h.text})})}),f?(0,p.jsx)(i().A,{ariaLabel:v.formatMessage({id:"dismiss.dismissButton.label",defaultMessage:"Dismiss"}),hoveredStyle:b.dismissButtonHover,icon:l().xMarkSmallIcon,onClick:f,style:b.dismissButton}):void 0]})})}},371621:(e,t,n)=>{n.d(t,{BB:()=>_,CD:()=>R,_W:()=>N,gv:()=>A,r0:()=>j,y2:()=>C});n(16280),n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(354520),n(803949),n(581454);var r=()=>n(907258),o=()=>n(755531),i=()=>n(770063),a=()=>n(295633),s=()=>n(181856),l=()=>n(691309),d=()=>n(416504),c=()=>n(134025),u=()=>n(68263),p=()=>n(696706),m=()=>n(179034),h=()=>n(798880),g=()=>n(439180),f=()=>n(763824),y=()=>n(973647),v=()=>n(534177),b=()=>n(255460),x=()=>n(69769),S=()=>n(376049),w=()=>n(547149),I=()=>n(483730),k=()=>n(881480);async function T(e){const{environment:t,latentOperation:n,operationContext:i,inMemoryRecordCache:s,transaction:d}=e,c=(0,o().S)(),u=r().default.state.sidebarSpaceViewStore;if(!u||!c)throw new Error("No space or space view.");const p=new Set,{assistantOperation:h,type:g}=n;if("addBlockToPage"===g||"insertBlockAfter"===g){const e="addBlockToPage"===g?h.blockNode.attributes.id:h.insertBlockNode.attributes.id;p.add(e);const n=a().B.createChildStore(u,{id:(0,l().So)(e),table:m().ev}),{target:r}=i.addBlockToPage,o=c.id;let s;"insertBlockAfter"===g&&i.enforceDefaultInsertBehavior?(s={type:"page",id:h.parentId,spaceId:o},p.add(h.parentId)):"page"===r?(s={type:"page",id:i.addBlockToPage.pageId,spaceId:o},p.add(i.addBlockToPage.pageId)):"collection"===r?s={type:"collection",id:i.addBlockToPage.collectionId,spaceId:o}:"privatePages"===r?s={type:"space-private-pages",spaceId:o}:"team"===r?s={type:"team",id:i.addBlockToPage.teamspaceId,spaceId:o}:(0,v().HB)(r);const f={environment:t,value:s,blocksToMove:[n],transaction:d};"insertBlockAfter"===g?"team"===f.value.type||i.enforceDefaultInsertBehavior?await S().HY(f):await S().LC(f):"addBlockToPage"===g?await S().HY(f):(0,v().HB)(g)}else if("removeBlock"===g){const{actorPointer:e}=n.data,r=(0,l().o4)({assistantOperation:h,updateMetadata:{last_edited_by_table:e.table,last_edited_by_id:e.id,last_edited_time:Date.now()},includeRemoveFromParent:!0});for(const n of r){B({environment:t,operation:n,recordCache:s,transaction:d});const e=M({operation:n,environment:t,inMemoryRecordCache:s});e&&p.add(e)}}else if("addUnknownBlockToPage"===g){const{operations:e}=(0,l().rB)({latentOperation:n,shouldCreateUnknownBlock:!0});for(const n of e)B({environment:t,operation:n,recordCache:s,transaction:d})}else(0,v().HB)(g);return{editedPageIds:p}}function M(e){const{operation:t,environment:n,inMemoryRecordCache:r}=e;if(t.pointer.table===m().ev){const e=new(a().B)(n,t.pointer,{inMemoryRecordCache:r});if(e.isPageBlock())return e.id}}async function C(e){const{environment:t,transaction:n,operations:r,inMemoryRecordCache:o,operationContext:i}=e,a=new Set;for(const s of r)if("latentOperation"===s.type){const{latentOperation:e}=s,{editedPageIds:r}=await T({environment:t,latentOperation:e,operationContext:i,inMemoryRecordCache:o,transaction:n});r.forEach((e=>a.add(e)))}else if("operation"===s.type){const{operation:e}=s;B({environment:t,operation:e,recordCache:o,transaction:n});const r=M({operation:e,environment:t,inMemoryRecordCache:o});r&&a.add(r)}else(0,v().HB)(s);return{editedPageIds:a}}function j(e){var t;const{assistantOperation:n,attributionActor:o,caches:i,environment:a,currentUserId:s}=e,c=(0,k().g)().getSpaceId(),u=null===(t=r().default.state.sidebarSpaceViewStore)||void 0===t?void 0:t.id,p=y().Q.unwrap((0,l().Vz)({assistantOperation:n,actorPointer:o,getRecordValue:i.makeGetRecordValueFnFromUpdatesCache(s),spaceId:c,spaceViewId:u,currentTimeZone:(0,d().P)()}));return p.length>0&&A({environment:a,operations:p,caches:i,attributionActor:o}),p}function A(e){const{environment:t,operations:n,caches:o,attributionActor:i,operationContext:a}=e,d=t.currentUser.id;if(!d)throw new Error("No current user.");const c=p().L3.isEqual(i,{id:d,table:h().oo}),u=new Set;o.commitTransaction({environment:t,transactionActions:w(),perform(e,r,o){const{operations:i}=(0,l().g$)(n,a??(0,l().tF)({shouldRemoveBlocksFromParent:o}),!0);for(const n of i){if(!P(t,n))throw new(s().Te)("page_edit_insufficient_permissions","Insufficient permissions to perform this edit. Respond with a chat instead.");n.pointer.table===m().ev&&u.add(n.pointer.id),B({environment:t,operation:n,recordCache:r,transaction:e})}},userAction:"assistantActions.applyTemporaryOperations",userId:d,...!c&&{skipUpdatingEditedMetadata:!0},canUndo:!1});const g=r().default.state.mainEditorCurrentBlockStore;g&&b().YW(t,g,[...u])}function B(e){const{environment:t,operation:n,transaction:r,recordCache:o}=e;if((0,g().ph)(n))(0,x().I)({environment:t,operation:n,transaction:r,inMemoryRecordCache:o});else if(n.pointer.table===m().ev)(0,x().I)({environment:t,operation:n,transaction:r,inMemoryRecordCache:o});else if((0,c().$Y)(n)||(0,c().mP)(n)){const e=new(i().pm)({environment:t,pointer:n.pointer,path:n.path,recordStoreOptions:{inMemoryRecordCache:o}});w().applyOperation({store:e,operation:n,transaction:r})}else(0,v().HB)(n)}function _(e){const{shouldCreateUnknownBlock:t}=e,n=I().default.getActiveSession();if(null!=n&&n.assistantConfigurationStoreState.requestedOnPublicDomain)return(0,l().ze)();const o=r().default.state.sidebarSpaceViewStore;if(!o)throw new Error("No space view.");return(0,l().OS)({spaceViewId:o.id,shouldCreateUnknownBlock:t})}function N(e){const t=r().default.state.sidebarSpaceViewStore;if(!t)throw new Error("No space view.");let n;const{type:o}=e;if("page"===o)n={addBlockToPage:{target:"page",pageId:e.id}};else if("space-private-pages"===o)n={addBlockToPage:{target:"privatePages",spaceViewId:t.id}};else if("collection"===o)n={addBlockToPage:{target:"collection",collectionId:e.id}};else if("team"===o)n={addBlockToPage:{target:"team",teamspaceId:e.id}};else{if("space"===o)throw new Error("Move to Space not supported");(0,v().HB)(o)}return n}function P(e,t){const n=t.pointer,r=new(i().pm)({environment:e,pointer:n}).getRole();return!r||(0,u().p2)(r)}async function R(e){const{environment:t,assistantOperations:n}=e,r=[];for(const a of n)"createBlock"===a.command&&(0,v().O9)(a.databaseSchemaId)&&r.push({id:a.databaseSchemaId,table:m().ev});const o=r.map((e=>new(a().B)(t,e)));await f().lX(o,500,(e=>e.load()));const i=o.map((e=>e.DANGEROUSLY_INCORRECT_getCollectionStore())).filter(v().O9);await f().lX(i,500,(e=>e.load()))}},381684:(e,t,n)=>{n.d(t,{b:()=>x,g:()=>b});n(296540);var r=()=>n(484714),o=()=>n(590526),i=()=>n(401497),a=()=>n(609679),s=()=>n(730240),l=()=>n(26697),d=()=>n(302501),c=()=>n(424400),u=()=>n(736847),p=()=>n(764880),m=()=>n(869190),h=()=>n(69708),g=()=>n(311337),f=()=>n(706965),y=()=>n(715011),v=n(474848);function b(e){const{store:t,showWordCount:n}=e,a=(0,r().v3)(),s=(0,r().WS)(),m=(0,h().tz)(),b=(0,o().K8)((()=>x({store:t,intl:m})),[t,m]),S=(0,i().IS)((()=>({label:{marginTop:s?8:4,marginBottom:s?8:4}})),[s]);return(0,o().K8)((()=>(0,g().y)(a)),[a])||b&&!b.canAccess?null:(0,v.jsx)(u().A,{topBorder:!0,children:(0,v.jsx)(c().Ay,{shouldWrapTitle:!0,title:b?(0,v.jsx)(l().m,{placement:"right",render:e=>(0,v.jsxs)("div",{...e,children:[n?(0,v.jsx)(d().A,{isSmall:!0,isSecondaryColor:!0,isMultiline:!0,style:S.label,children:(0,v.jsx)(h().sA,{id:"pageMoreButton.wordCount.caption",defaultMessage:"Word count: {count}",values:{count:(0,v.jsx)(y().A,{store:t})}})}):void 0,(0,v.jsx)(d().A,{isSmall:!0,isSecondaryColor:!0,isMultiline:!0,style:S.label,children:(0,v.jsx)(h().sA,{id:"blockAuthorInfo.label",defaultMessage:"Last edited by {author}",values:{author:b.lastEditedBy.asActor?(0,p().lR)(m,b.lastEditedBy):void 0}})}),(0,v.jsx)(d().A,{isSmall:!0,isSecondaryColor:!0,style:S.label,children:b.lastEditedTime})]}),renderTooltip:()=>(0,v.jsx)(f().A,{store:t,compactFormat:!0})}):void 0,loading:!b})})}function x(e){const{store:t,intl:n}=e,r=t.getCreatedByPointer(),o=t.getCreatedTime(),i=t.getLastEditedByPointer(),l=t.getLastEditedTime();if(!t.canRead())return{canAccess:!1};if(r&&o&&l&&i){const e=(0,s().vt)({parentStore:t,pointer:r}),d=(0,m().jE)(o,a().locale,n),c=(0,s().vt)({parentStore:t,pointer:i}),u=(0,m().jE)(l,a().locale,n);if(!c)return;return{canAccess:!0,createdBy:e,createdTime:d,lastEditedBy:c,lastEditedTime:u}}}},385979:(e,t,n)=>{n.d(t,{h:()=>p});var r=n(296540),o=()=>n(401497),i=()=>n(874832),a=()=>n(340498),s=()=>n(100622),l=()=>n(496603),d=n(474848);const c={"search-modal":{maxNumberOfShimmers:8,hideBorders:!1,hidePathText:!1,size:"md"},"search-modal-minimal":{maxNumberOfShimmers:8,hideBorders:!0,hidePathText:!1,size:"md"},"mention-menu-page":{maxNumberOfShimmers:3,hideBorders:!0,hidePathText:!1,size:"sm"},"mention-menu-people":{maxNumberOfShimmers:3,hideBorders:!0,hidePathText:!0,size:"sm"}};function u(e){const{isLastShimmer:t,variant:n}=e,{hideBorders:u,hidePathText:p,size:m}=c[n],h=(0,r.useMemo)((()=>(0,l().XM)(["30%","45%","55%","60%","70%","75%","80%","90%"])),[]),g=(0,r.useMemo)((()=>(0,l().XM)(["10%","15%","20%","25%","30%","35%","55%","70%"])),[]),f=(0,o().IS)((()=>{const{titleHeight:e,pathHeight:n,iconSize:r,iconMarginInlineStart:o,containerMarginBottom:i}="md"===m?{titleHeight:18,pathHeight:12,iconSize:a().Ev.default,iconMarginInlineStart:6,containerMarginBottom:10}:{titleHeight:14,pathHeight:10,iconMarginInlineStart:4,iconSize:18,containerMarginBottom:8};return{resultContainer:{display:"flex",gap:10,boxShadow:u||t?void 0:`0 1px 0 ${s().Tj.border.secondaryTranslucent}`,marginTop:8,marginInlineEnd:8,marginBottom:i,marginInlineStart:6,paddingBottom:u?0:10},icon:{width:r,height:r,borderRadius:5,marginInlineStart:o},titleAndPath:{width:"100%",display:"flex",flexDirection:"column",gap:5},title:{height:e,borderRadius:5,width:h},path:{height:n,borderRadius:5,width:g}}}),[u,t,h,g,m]);return(0,d.jsxs)("div",{style:f.resultContainer,children:[(0,d.jsx)(i().P,{style:f.icon}),(0,d.jsxs)("div",{style:f.titleAndPath,children:[(0,d.jsx)(i().P,{style:f.title}),p?void 0:(0,d.jsx)(i().P,{style:f.path})]})]})}function p(e){const{resultsCount:t,shouldShow:n,variant:o}=e,{maxNumberOfShimmers:i}=c[o],a=i-t,s=n?Math.max(0,a):0;return(0,r.useMemo)((()=>Array.from({length:s},((e,t)=>({key:`shimmer-item-${t}`,action:()=>{},render:()=>(0,d.jsx)(u,{isLastShimmer:t===s-1,variant:o})})))),[s,o])}},402267:(e,t,n)=>{n.d(t,{A:()=>C});var r=n(296540),o=()=>n(782482),i=()=>n(726637),a=()=>n(590526),s=()=>n(127833),l=()=>n(30537),d=()=>n(807449),c=()=>n(631524),u=()=>n(160432),p=()=>n(81068),m=()=>n(381553),h=()=>n(340498),g=()=>n(69708),f=()=>n(100622),y=()=>n(534177),v=()=>n(56394),b=()=>n(297401),x=()=>n(707160),S=()=>n(602667),w=()=>n(220818),I=()=>n(976361),k=()=>n(385226),T=()=>n(322976),M=n(474848);const C=function({onChange:e,onMenuDismiss:t,showButtons:r,title:o,value:s,disabled:l,dateFormat:d,icon:c,mode:u,focused:p}){const m=(0,a().uB)(void 0,n(474962).A);return(0,n(852507).l)((()=>{R({value:s},m)})),i().A.isMobile?(0,M.jsx)(z,{onChange:e,onMenuDismiss:t,showButtons:r,title:o,value:s,disabled:l,dateFormat:d,icon:c,mode:u,store:m}):(0,M.jsx)(K,{onChange:e,onMenuDismiss:t,showButtons:r,title:o,value:s,disabled:l,dateFormat:d,focused:p,icon:c,mode:u,store:m})};function j(){return{buttonMenuItem:{color:f().Tj.text.secondary},activeMenuItem:{color:f().Tj.text.primary}}}function A(e){e.preventDefault&&e.preventDefault()}function B(e){e({starting:void 0,ending:void 0})}function _(){return{menuItem:{minHeight:void 0,paddingTop:i().A.isMobile?12:4,paddingBottom:i().A.isMobile?12:4},icon:{height:h().Ev.sm,width:h().Ev.sm,fill:"currentColor"},iconActiveDesktop:{fill:"currentColor",alignSelf:"flex-start",marginTop:2,marginInlineEnd:2},iconActiveDesktopWrapper:{marginTop:0},iconActiveMobile:{fill:"currentColor",marginTop:1,marginInlineEnd:6},popup:{paddingTop:12,paddingBottom:8},menuItemTitleDesktop:{width:"100%"},sectionMenuItem:{display:"flex"},summary:{display:"inline-flex"}}}function N(e,t){t||e.setState({...e.state,isOpen:!0,focus:"starting"})}function P(e,t,n,r,o){const{temporaryDateRange:i}=n.state;(0,S().a)(e)||(o||t(i),n.setState({...n.state,isOpen:!1,temporaryDateRange:{starting:void 0,ending:void 0}}),r&&r())}function R(e,t){if(!e.error)return t.setState({...t.state,temporaryDateRange:{...t.state.temporaryDateRange,...e.value}})}function E({disabled:e,icon:t,title:n,store:o}){const i=(0,r.useCallback)((()=>N(o,e)),[o,e]);return(0,M.jsx)(p().A,{disabled:e,focused:!1,icon:(0,M.jsx)(d().I,{icon:t}),title:n,onClick:i})}function O({disabled:e,title:t,value:n,dateFormat:o,onChange:i,store:a}){const s=(0,g().tz)(),l=(0,r.useCallback)((()=>N(a,e)),[a,e]),c=_(),u=(0,M.jsxs)("div",{style:c.summary,children:[(0,M.jsx)(d().I,{icon:m().Y,size:"sm",style:c.iconActiveMobile}),(0,w().t)(n,s,o)]});return(0,M.jsx)(I().A,{disabled:e,onClick:l,onClickClear:()=>B(i),label:t,title:u})}function F({disabled:e,value:t,dateFormat:n,focused:o,onChange:i,store:a}){const s=(0,g().tz)(),l=(0,r.useCallback)((()=>N(a,e)),[a,e]),c=_(),u=j(),h={...c.menuItem,...u.activeMenuItem},f=(0,w().t)(t,s,n),y=(0,M.jsx)(b().A,{onClick:()=>B(i),disabled:e});return(0,M.jsx)(p().A,{focused:o,disabled:e,icon:(0,M.jsx)(d().I,{icon:m().Y,size:"sm",style:c.iconActiveDesktop}),title:f,right:y,isTokenTitle:!0,alignIconTop:!0,onClick:l,desktopTitleStyle:c.menuItemTitleDesktop,desktopIconStyle:c.iconActiveDesktopWrapper,style:h})}function D({disabled:e,title:t,icon:n,focused:o,mode:i,store:a}){const s=(0,r.useCallback)((()=>N(a,e)),[a,e]),l=_(),c=j(),u={...l.menuItem,...c.buttonMenuItem,...i===T().C.Pill?{width:"fit-content",border:"solid 1px",paddingInlineStart:0,paddingInlineEnd:0,borderRadius:20,fontSize:12}:{}};return(0,M.jsx)(p().A,{focused:o,disabled:e,icon:(0,M.jsx)(d().I,{icon:n}),title:t,onClick:s,style:u})}function q({disabled:e,value:t,title:n,store:o}){const i=(0,r.useCallback)((()=>N(o,e)),[o,e]);return(0,M.jsx)(v().A,{on:Boolean(t.starting||t.ending),icon:(0,M.jsx)(d().I,{icon:m().Y,size:"sm",style:{fill:"currentColor"}}),title:(0,M.jsx)("span",{children:n}),onClick:i})}function L({onChange:e,onMenuDismiss:t,showButtons:n,title:o,value:i,store:s}){const l=(0,r.useCallback)((r=>P(r,e,s,t,n)),[e,s,t,n]),d=(0,r.useCallback)((e=>R(e,s)),[s]),p=(0,a().K8)((()=>function(e,t){const{temporaryDateRange:n}=t.state;return{...e,...n}}(i,s)),[s,i]);return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(x().A,{title:o,value:p,onUpdate:d,store:s,onDismiss:l}),n?(0,M.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",padding:"0px 10px"},children:[(0,M.jsx)(c().p,{colorPalette:"gray",style:{marginInlineStart:"auto",marginInlineEnd:8},onClick:l,children:(0,M.jsx)(g().sA,{defaultMessage:"Cancel",id:"searchDateFilter.cancelButton.label"})}),(0,M.jsx)(u().A,{colorPalette:"blue",onClick:()=>e(s.state.temporaryDateRange),children:(0,M.jsx)(g().sA,{defaultMessage:"Accept",id:"searchDateFilter.acceptButton.label"})})]}):void 0]})}function K({mode:e,onChange:t,onMenuDismiss:n,showButtons:d,title:c,value:u,disabled:p,dateFormat:m,focused:h,icon:g,store:f}){const v=(0,r.useCallback)((e=>P(e,t,f,n,d)),[t,f,n,d]),b=(0,r.useCallback)((()=>(0,M.jsx)(L,{onChange:t,onMenuDismiss:n,showButtons:d,title:c,value:u,store:f})),[t,n,d,c,u,f]),x=_(),S=e===T().C.Section,w=S?c:void 0,I=e===T().C.Section?(0,M.jsx)(F,{disabled:p,value:u,dateFormat:m,focused:h,onChange:t,store:f}):e===T().C.Button?(0,M.jsx)(D,{disabled:p,title:c,icon:g,focused:h,mode:e,store:f}):e===T().C.Pill?(0,M.jsx)(q,{disabled:p,value:u,title:c,store:f}):void(0,y().HB)(e),C=(0,a().K8)((()=>f.state.isOpen),[f]);return(0,M.jsx)(k().A,{title:w,marginAfter:S,children:(0,M.jsx)(o().N,{debugName:"SearchDateFilter",capture:C,onUp:A,onDown:A,onEnter:A,children:(0,M.jsx)(s().zD,{popupType:i().A.isMobile?l().n.SlideUp:l().n.Popup,open:C,origin:I,render:b,onDismiss:v,placementToOrigin:"bottom",alignmentToOrigin:"start",keepFocus:!0,style:x.popup})})})}function z({mode:e,onChange:t,onMenuDismiss:n,showButtons:o,title:i,value:d,disabled:c,dateFormat:u,icon:p,store:m}){const h=(0,a().K8)((()=>m.state.isOpen),[m]),g=(0,r.useCallback)((e=>P(e,t,m,n,o)),[t,m,n,o]),f=(0,r.useCallback)((()=>(0,M.jsx)(L,{onChange:t,onMenuDismiss:n,showButtons:o,title:i,value:d,store:m})),[t,n,o,i,d,m]),y=e===T().C.Section?(0,M.jsx)(O,{disabled:c,title:i,value:d,dateFormat:u,onChange:t,store:m}):(0,M.jsx)(E,{disabled:c,icon:p,title:i,store:m});return(0,M.jsx)(s().zD,{popupType:l().n.SlideUp,open:h,origin:y,render:f,onDismiss:g,preventScaleTransition:!0})}},409268:(e,t,n)=>{n.d(t,{s:()=>i});n(898992),n(672577);var r=n.n(n(791611)),o=()=>n(961232);function i(e){const t=o().A.find((t=>t.store===e));if(t){const e=t.getContentWrapEl();if(e)return r()(e.innerText)}return 0}},414706:(e,t,n)=>{n.d(t,{z:()=>f});n(296540);var r=()=>n(396896),o=()=>n(807449),i=()=>n(493552),a=()=>n(333603),s=()=>n(340498),l=n(474848);const d={viewBox:"0 0 16 16",fittedViewBox:"0.94 1.41 14.11 13.17",svg:(0,l.jsx)("path",{d:"M11.57 12.947c0 .903-.733 1.636-1.637 1.636H6.066a1.637 1.637 0 0 1-1.636-1.636v-3.23H2.2a1.25 1.25 0 0 1-.884-2.135l5.8-5.8a1.25 1.25 0 0 1 1.768 0l5.8 5.8a1.25 1.25 0 0 1-.884 2.134h-2.23zm-5.89 0c0 .187.133.343.309.379l.077.007h3.867l.079-.008c.15-.03.27-.15.3-.3l.008-.078v-4.4a.08.08 0 0 1 .049-.074l.031-.007h3.4L8 2.666l-5.8 5.8h3.4a.08.08 0 0 1 .08.08z"})},c=(0,s().wt)("arrowShapeUpSmall",d,"small");var u=()=>n(40457);const p={viewBox:"0 0 16 16",fittedViewBox:"2.37 2.37 11.26 11.26",svg:(0,l.jsx)("path",{d:"M4.667 2.375a2.292 2.292 0 0 0 0 4.583h1.042v2.084H4.667a2.292 2.292 0 1 0 2.291 2.291v-1.041h2.083v1.041a2.292 2.292 0 1 0 2.292-2.291h-1.041V6.958h1.041a2.292 2.292 0 1 0-2.292-2.291v1.041H6.958V4.667a2.29 2.29 0 0 0-2.291-2.292M3.625 4.667a1.042 1.042 0 1 1 2.083 0v1.041H4.667a1.04 1.04 0 0 1-1.042-1.041m6.666 0a1.042 1.042 0 1 1 1.042 1.041h-1.042zM6.958 9.042V6.958h2.084v2.084zm-3.333 2.291c0-.575.466-1.041 1.042-1.041h1.041v1.041a1.042 1.042 0 1 1-2.083 0m6.666 0v-1.041h1.042a1.042 1.042 0 1 1-1.042 1.041"})},m=(0,s().wt)("commandSmall",p,"small"),h={viewBox:"0 0 16 16",fittedViewBox:"2.44 3 11.11 10",svg:(0,l.jsx)("path",{d:"M5.647 3.002c.514 0 .948.284 1.152.75l3.47 7.822a.3.3 0 0 0 .106.125c.04.024.098.04.185.04h2.343c.354 0 .648.281.648.632a.636.636 0 0 1-.648.626h-2.58c-.265 0-.497-.056-.693-.182a1.23 1.23 0 0 1-.45-.558L5.696 4.43a.3.3 0 0 0-.105-.13.3.3 0 0 0-.165-.041H3.098a.635.635 0 0 1-.649-.632.63.63 0 0 1 .649-.626zm7.256 0c.356 0 .642.262.642.621a.625.625 0 0 1-.642.626H9.481a.63.63 0 0 1-.647-.626c0-.36.293-.621.647-.621z"})},g=(0,s().wt)("optionSmall",h,"small");function f(e){const{shortcut:t}=e;return t?(0,l.jsxs)(r().fI,{gap:2,alignItems:"center",children:[t.shift?(0,l.jsx)(o().I,{icon:c,size:"xxs",colorVariant:"secondary"}):void 0,t.control?(0,l.jsx)(o().I,{icon:a().Y,size:"xxs",colorVariant:"secondary"}):void 0,t.option?(0,l.jsx)(o().I,{icon:g,size:"xxs",colorVariant:"secondary"}):void 0,t.command?(0,l.jsx)(o().I,{icon:m,size:"xxs",colorVariant:"secondary"}):void 0,t.enter?(0,l.jsx)(o().I,{icon:u().arrowTurnDownLeftSmallIcon,size:"xxs",colorVariant:"secondary"}):void 0,t.key?(0,l.jsx)(i().D,{colorVariant:"secondary",styleKey:"captionRegular",children:1===t.key.length?t.key.toUpperCase():t.key}):void 0]}):null}},428343:(e,t,n)=>{n.d(t,{Q:()=>m});n(898992),n(354520),n(581454);var r=()=>n(755531),o=()=>n(484714),i=()=>n(590526),a=()=>n(295633),s=()=>n(179034),l=()=>n(69708),d=()=>n(534177),c=()=>n(860864),u=()=>n(968913),p=()=>n(959462);function m(e){const{searchQuery:t,filterCategory:n,availableOffline:m=!1,disable:h=!1}=e,g=(0,o().v3)(),f=(0,l().tz)(),y=(0,i().K8)((()=>{if(h)return[];const e=p().A.state.offlinePages??{};return Object.keys(e).map((o=>{var i;const l=e[o];if(void 0===l)return;const{is_explicitly_offlined_origin:p,is_autosynced_origin:h}=l;if(!p&&!h)return;if(m&&!(0,u().Bd)(o))return;if(!function(e){const{filterCategory:t,isExplicitlyOfflinedOrigin:n,isAutosyncedOrigin:r}=e;switch(t){case"all":return!0;case"manual":return n;case"autosynced":return r;default:(0,d().HB)(t)}}({filterCategory:n,isExplicitlyOfflinedOrigin:p,isAutosyncedOrigin:h}))return;const y=new(a().B)(g,{table:s().ev,id:o});if(Boolean(t)&&!function(e){const{pageBlockStore:t,searchQuery:n,intl:r}=e,{displayTitle:o}=(0,c().tL)({store:t,intl:r});if(void 0===o)return!1;return o.toLowerCase().includes(n.toLowerCase())}({pageBlockStore:y,searchQuery:t,intl:f}))return;if((null===(i=(0,r().S)())||void 0===i?void 0:i.id)!==y.getSpaceId())return;const v=y.getLastEditedTime();return{id:o,downloadStatus:l.download_status,isClickable:!1,lastModifiedTime:v,pageBlockStore:y,showOptions:p}})).filter(d().O9)}),[h,m,n,g,t,f]);return y}},433876:(e,t,n)=>{n.d(t,{A:()=>i});n(296540);var r=()=>n(100622),o=n(474848);const i=function(e){const t=(0,n(484714).v3)(),{modalStyle:i,alignItems:a="flex-start"}=e,s=(0,n(401497).IS)((()=>({modalStyle:{top:n(175947).jq(t.device.isElectronMac),borderRadius:12,overflow:"hidden",boxShadow:r().Tj.shadowLG,background:r().Tj.background.primary,...i}})),[t,i]);return n(726637).A.isMobile?(0,o.jsx)(n(127833).zD,{popupType:n(30537).n.SlideUp,open:e.open,render:e.renderContent,preventSlideUpTransition:e.disableAnimation,onDismiss:e.onDismiss,origin:e.origin,trapFocus:!1,ariaLabel:e.ariaLabel}):(0,o.jsx)(n(107975).a,{open:e.open,preventHideChildrenWhileOpening:!0,style:{alignItems:a},innerStyle:s.modalStyle,onDismiss:e.onDismiss,render:e.renderContent,origin:e.origin,isWaxPaper:e.modalIsWaxPaper,backgroundStyle:e.modalBackgroundStyle,transitionAppearance:e.disableAnimation?"none":void 0,ariaLabel:e.ariaLabel})}},436468:(e,t,n)=>{n.d(t,{jk:()=>Z,om:()=>ve,Xp:()=>ee,y5:()=>be,Ij:()=>xe,BM:()=>te,Rz:()=>Y,ld:()=>se,oc:()=>ue,w$:()=>de});n(16280),n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(354520),n(672577),n(430670),n(803949),n(581454),n(737550);var r=()=>n(906745),o=()=>n(496603),i=()=>n(763824),a=()=>n(183558),s=()=>n(973647),l=()=>n(534177),d=()=>n(720665),c=()=>n(933528),u=()=>n(902006),p=()=>n(241178),m=()=>n(992214),h=()=>n(700500),g=()=>n(15440),f=()=>n(356246),y=()=>n(657970),v=()=>n(335997),b=()=>n(302322),x=()=>n(581793),S=()=>n(363170),w=()=>n(898244),I=()=>n(713998),k=()=>n(604995),T=()=>n(651124),M=()=>n(236162),C=()=>n(416504),j=()=>n(390066),A=()=>n(206267),B=()=>n(792071),_=()=>n(72135),N=()=>n(251582),P=()=>n(433847),R=()=>n(388821),E=()=>n(179034),O=()=>n(519831),F=()=>n(869558),D=()=>n(437607),q=()=>n(798880),L=()=>n(797809),K=()=>n(201980),z=()=>n(181856),V=()=>n(510818),U=()=>n(832443),H=()=>n(353566),W=()=>n(252050),$=()=>n(706461),G=()=>n(471159);var Q=()=>n(586984);async function Y(e){const{pointer:t,intl:n,currentTimeZone:r}=e,o="loadRecordValue"in e?B().h0Y.fromLoadRecordValueFn(e.loadRecordValue):e.loadRecordModel,i=(0,P().ns)({pointer:t,loadRecordModel:o}),a=await ee({pointer:t,loadRecordModel:o,rootPointer:t,parentPointer:void 0,spaceId:t.spaceId,intl:n,currentTimeZone:r});if(!a)throw new(z().u7)(t.id,"Failed to build XML node");return{node:a,isNonSpaceShared:!(await i)}}async function Z(e){const{intl:t,textValue:n,allowsText:r,allowedTagNames:o,loadRecordModel:a,shouldUsePlaceholderRecordInformation:s,currentTimeZone:d,allowWebLoading:c=!1}=e,p=[],g=R().RecordMap.create(),f=K().RQ(n).flatMap((e=>K().uPN(e)));if(s&&a)throw new Error("Expected no loadRecordModelFn when using placeholder record information");if(!s&&!a)throw new Error("Expected loadRecordModelFn to be defined when not using placeholder record info");!s&&a&&await Promise.all(f.map((async e=>{if(K().jIt(e)){const t=K().i$F(e);if(!t)return;const n=await a(t);if(g.setModel(t,n),!n)return;const r=i().lX(n.getCollectionPointers(),100,(async e=>{g.setModel(e,await a(e))})),o=i().lX(n.getCollectionViewPointers(),100,(async e=>{g.setModel(e,await a(e))}));await Promise.all([r,o]);const{linkedCollectionPointers:s}=n.getAllLinkedAndSourceCollectionPointers(B().b4_.fromRecordMap(g));await i().lX(s,100,(async e=>{g.setModel(e,await a(e))}))}else if(K().rie(e)){const t={table:q().oo,id:K().NcG(e)};g.setModel(t,await a(t))}else if(K().RaC(e)){const t=K().FHi(e);if(!t)return;const{groupId:n,spaceId:r}=t,o={table:D().n,id:(0,D().gK)({spacePermissionGroupId:n,spaceId:r}),spaceId:r};g.setModel(o,await a(o))}else if(K().$ch(e)){const t=K().KdU(e);g.setModel(t,await a(t))}else if(K().muW(e)){const t=K().TSJ(e);g.setModel(t,await a(t))}})));const y=s?void 0:B().b4_.fromRecordMap(g);for(const i of K().RQ(n)){let e=p,n=!1,a=K().uPN(i);if(K().GiG(i)?a=[...a.filter((e=>!K().gir(e))),...a.filter((e=>K().gir(e)))]:K().qXl(i)&&(a=[...a.filter((e=>!K().iGj(e))),...a.filter((e=>K().iGj(e)))]),!a.some((e=>(0,K().O3D)(e)))){for(const r of a){(K().iGj(r)||K().gir(r))&&(n=!0);const a=K()._XS(r),s=he[a];if(!(0,l().Xk)(o,s))continue;let p;if("e"===s){if(!K().GiG(i)){n=!1;continue}p={type:"inline",tagName:s,attributes:{equation:K().u$N(i)},children:[]}}else if("a"===s){if(!K().sh$(r))throw new Error("Unexpected annotation for link annotation");const e=K().cQR(r);let t=(0,u().Tq)(e);t=c||"web"!==t?t:void 0,p=t?{type:"inline",tagName:s,attributes:{href:e,type:t,"external-id":(0,u().V9)(e)},children:[]}:{type:"inline",tagName:s,attributes:{href:e,type:void 0,"external-id":void 0},children:[]}}else if("mention-page"===s){if(!K().jIt(r))throw new Error("Unexpected annotation for page annotation");const e=K().v55(r);if(y){var v;const n=y({table:E().ev,id:e}),r=(null==n?void 0:n.DANGEROUSLY_INCORRECT_getCollectionPointer())??(null==n?void 0:n.getFirstCollectionPointerFromViews(y)),o=n?r&&(null===(v=y(r))||void 0===v?void 0:v.getName())||(null==n?void 0:n.getProperty("title")):K().x9d((0,m().mA)(t)),i=[{type:"text",value:(0,V().Pm)(K().q4_(o))}];if(n&&(0,h().Ef)(n.type)){if(!r)throw new Error("Unable to find collection for mention-database");p={type:"inline",tagName:"mention-database",attributes:{"database-id":(0,W().z5)(r.id)},children:i}}else p={type:"inline",tagName:s,attributes:{"page-id":(0,W().ew)(e)},children:i}}else{const t=[{type:"text",value:(0,V().Pm)("Page title")}];p={type:"inline",tagName:s,attributes:{"page-id":(0,W().ew)(e)},children:t}}}else if("mention-database"===s){if(!K().$ch(r))throw new Error("Unexpected annotation for database annotation");const e=K().KdU(r);if(y){var b;const n=e?(null===(b=y(e))||void 0===b?void 0:b.getName())??K().x9d("Unnamed collection"):K().x9d((0,m().mA)(t)),r=[{type:"text",value:(0,V().Pm)(K().q4_(n))}];p={type:"inline",tagName:s,attributes:{"database-id":(0,W().z5)(e.id)},children:r}}else{const t=[{type:"text",value:(0,V().Pm)("Collection title")}];p={type:"inline",tagName:s,attributes:{"database-id":(0,W().z5)(e.id)},children:t}}}else if("mention-data-source"===s){if(!K().muW(r))throw new Error("Unexpected annotation for database annotation");const e=K().TSJ(r);if(y){var x;const n=e?(null===(x=y(e))||void 0===x?void 0:x.getName())??K().x9d("Unnamed collection"):K().x9d((0,m().mA)(t)),r=[{type:"text",value:(0,V().Pm)(K().q4_(n))}];p={type:"inline",tagName:s,attributes:{"data-source-id":(0,W().z5)(e.id)},children:r}}else{const t=[{type:"text",value:(0,V().Pm)("Collection title")}];p={type:"inline",tagName:s,attributes:{"data-source-id":(0,W().z5)(e.id)},children:t}}}else if("mention-person"===s){if(!K().rie(r))throw new Error("Unexpected annotation for user annotation");const e=K().NcG(r);if(y){const n=y({table:q().oo,id:e});p={type:"inline",tagName:s,attributes:{"person-id":(0,W().ew)(e),"person-name":null==n?void 0:n.getDisplayName(t)},children:[]}}else p={type:"inline",tagName:s,attributes:{"person-id":(0,W().ew)(e),"person-name":"Person name"},children:[]}}else if("mention-date"===s){if(!K().qsB(r))throw new Error("Unexpected annotation for date annotation");const e=K().K7D(r),t=(0,k().kW)(e,d);let n,o;"date"===t.type?(n="mention-date",o={date:t.start_date}):"datetime"===t.type?(n="mention-datetime",o={date:t.start_date,time:t.start_time}):"daterange"===t.type?(n="mention-date-range",o={"start-date":t.start_date,"end-date":t.end_date}):(n="mention-datetime-range",o={"start-date":t.start_date,"start-time":t.start_time,"end-date":t.end_date,"end-time":t.end_time}),p={type:"inline",tagName:n,attributes:o,children:[]}}else if("h"===s){if(!K().YuY(r))throw new Error("Unexpected annotation for highlight annotation");p={type:"inline",tagName:s,attributes:{color:W().P8[K().uIc(r)]},children:[]}}else if("mention-link"===s){if(!K().ik2(r))throw new Error("Unexpected annotation for link mention annotation");const e=K().q1R(r);p={type:"inline",tagName:s,attributes:{title:e.title,href:e.href,description:e.description,icon_url:e.icon_url},children:[]}}else p={type:"inline",tagName:s,attributes:{},children:[]};e.push(p),e=p.children}if(!n&&r){const t=K().N8A(i);t.length>0&&e.push({type:"text",value:(0,V().Pm)(t)})}}}return p}function X(e){const{tagName:t,blockId:n,schemaId:r,attributes:o}=e;return(0,W().g5)(t),{type:"block",tagName:t,text:[],attributes:{id:n,...o},properties:{},schemas:{},children:[],parent:void 0,persisted:!0,schemaId:r}}function J(e){const t=le[e];return(0,l().O)(W().sA,t)}async function ee(e){const{pointer:t,loadRecordModel:n,rootPointer:r,parentPointer:o,spaceId:a,intl:s,currentTimeZone:d,viewedBlockIds:c=new Set}=e;if(c.has(t.id))return;c.add(t.id);const u=await n(t);if(!u)return;if(!J(u.type))return;const p=t.table===r.table&&t.id===r.id&&t.spaceId===r.spaceId,m=u.getFormatValue("suggestions");if(!p&&m&&m.some((e=>"insert"===e.type)))return;let f,y=t;const v=(0,W().ew)((null==o?void 0:o.id)??r.id),b=(0,h().Af)(u.type,u.getFormat());if(u.isType(h().xd.page)||u.isType(h().xd.collectionViewPage)&&b){var x;const e=null===(x=await(0,M().wC)({block:u,loadRecordModel:n}))||void 0===x?void 0:x.id,t=e?(0,W().z5)(e):void 0,i=u.getFormatValue("page_font"),a=u.getFormatValue("page_small_text")?"small":void 0,l=u.getFormatValue("page_full_width")?"full-width":void 0;if(p){const e=await(0,M().wC)({block:u,loadRecordModel:n});let r;r=e&&e.parent_table!==O().Vl?(0,W().ew)(e.parent_id):(0,W().ew)(u.id),f=X({tagName:u.isType(h().xd.collectionViewPage)&&b?"page":le[u.type],blockId:(0,W().ew)(u.id),attributes:{...i&&"comic"!==i?{"page-font":i}:{},...a?{"page-font-size":a}:{},...l?{"page-width":l}:{},...t?{"database-id":t}:{}},schemaId:r})}else f=X({tagName:"child-page",blockId:(0,W().ew)(`${u.id}/${(null==o?void 0:o.id)||r.id}`),attributes:{"page-id":(0,W().ew)(u.id),"database-id":t,"has-content":u.getContentLength()>0?"true":"false"},schemaId:v});await oe({node:f,block:u,loadRecordModel:n,intl:s,currentTimeZone:d}),!p&&t&&await async function(e){const{node:t,loadRecordModel:n,intl:r,currentTimeZone:o,block:i,maxBlocksToLoad:a=50,viewedBlockIds:s=new Set}=e,l=i.getContentPointers(),d=[];for(const c of l){const e=await ee({pointer:c,rootPointer:i.pointer,parentPointer:i.pointer,spaceId:i.getSpaceId(),loadRecordModel:n,intl:r,currentTimeZone:o,viewedBlockIds:s});if(e&&(d.push(e),d.length>=a))break}t.children.push(...d.slice(0,a))}({node:f,loadRecordModel:n,intl:s,currentTimeZone:d,block:u,maxBlocksToLoad:50,viewedBlockIds:c})}else if(u.type===h().xd.collectionView||u.isType(h().xd.collectionViewPage)&&!b)f=X({tagName:"database-views",blockId:(0,W().ew)(u.id),schemaId:(0,W().ew)(u.id),attributes:{}}),await oe({block:u,node:f,loadRecordModel:n,intl:s,currentTimeZone:d});else if(u.type===h().xd.alias){const e=u.getFormatValue("alias_pointer");if(!e||e.table!==E().ev)return;const t=await n(e);if(!t)return;if(t.type===h().xd.collectionView||t.type===h().xd.collectionViewPage)f=X({tagName:"link-database",blockId:(0,W().ew)(u.id),schemaId:v,attributes:{"database-id":(0,W().z5)(t.id)}});else{var S;const e=null===(S=await(0,M().wC)({block:u,loadRecordModel:n}))||void 0===S?void 0:S.getParentId();f=X({tagName:"link-page",blockId:(0,W().ew)(u.id),schemaId:v,attributes:{"page-id":(0,W().ew)(t.id),...e?{"database-id":(0,W().z5)(e)}:{}}})}await oe({node:f,block:t,loadRecordModel:n,intl:s,currentTimeZone:d})}else if(u.type===h().xd.table){const e=u.getFormatValue("table_block_row_header"),t=u.getFormatValue("table_block_column_header");f=X({tagName:le[u.type],blockId:(0,W().ew)(u.id),schemaId:v,attributes:{...e?{"header-row":"true"}:{},...t?{"header-column":"true"}:{}}})}else if(u.type===h().xd.tableRow){if(u.parent_table!==E().ev)return;const e=await n({table:u.parent_table,id:u.parent_id,spaceId:u.space_id});if(!e||e.type!==h().xd.table)return;f=X({tagName:le[u.type],blockId:(0,W().ew)(u.id),schemaId:v,attributes:{}});const t=e.getFormatValue("table_block_column_order")||[];for(const r of t){const e=(t.indexOf(r)+1).toString(),o={type:"property",tagName:"property-text",attributes:{name:e},children:await Z({textValue:u.getProperty(r),allowsText:W().GU["property-text"].text,allowedTagNames:W().GU["property-text"].inline,loadRecordModel:n,intl:s,currentTimeZone:d})};f.properties[e]=o}}else if(u.isType(h().xd.transclusionReference)){const e=u.getTransclusionReferenceTargetPointer();if(!e)return;f=X({tagName:le[u.type],blockId:(0,W().ew)(u.id),schemaId:v,attributes:{"synced-block-id":(0,W().ew)(e.id)}}),y=e}else if(u.getFormatValue("toggleable")&&(u.isType(h().xd.header)||u.isType(h().xd.subHeader)||u.isType(h().xd.subSubHeader)||u.isType(h().xd.header4))){const e=ce[u.type];f=X({tagName:"toggle",blockId:(0,W().ew)(u.id),schemaId:v,attributes:{size:e}}),await oe({block:u,node:f,loadRecordModel:n,intl:s,currentTimeZone:d})}else if(u.isType(h().xd.code)){const e=u.getLanguage().name,t=g().$K[e];f=X({tagName:"code-block",blockId:(0,W().ew)(u.id),schemaId:v,attributes:{language:t}}),await oe({block:u,node:f,loadRecordModel:n,intl:s,currentTimeZone:d})}else"unknown-block"===le[u.type]?(f=X({tagName:"unknown-block",blockId:(0,W().ew)(u.id),schemaId:v,attributes:{type:u.type}}),await oe({block:u,node:f,loadRecordModel:n,intl:s,currentTimeZone:d})):(f=X({tagName:le[u.type],blockId:(0,W().ew)(u.id),schemaId:v,attributes:{}}),await oe({block:u,node:f,loadRecordModel:n,intl:s,currentTimeZone:d}));if((0,l().Xk)(W().sW,f.tagName)){const e=u.getFormatValue("block_color");e&&(f.attributes.color=W().P8[e])}if(u.isType(h().xd.collectionViewPage)&&!b||u.isType(h().xd.collectionView)){const e=u.getCollectionViewIds(),t=(await i().lX(e,500,(async e=>await async function(e){const{pointer:t,parentPointer:n,loadRecordModel:r}=e,o=await r(t);if(!o)return;const i=await r(n);if(!i)return;const a=o.DANGEROUSLY_INCORRECT_getCollectionPointerWithBlockFallback(i);if(!a)return;const s=await r(a);if(!s)return;const l=(0,K().k4p)(s.getName()),d=o.getName(),c={type:"collectionView",tagName:"database-view",parent:(0,W().ew)(n.id),attributes:{id:(0,W().wn)(t.id),title:d??"","database-id":(0,W().z5)(s.id),"database-name":l},persisted:!0,schemaId:(0,W().ew)(n.id)};return c}({pointer:{table:F().Gy,id:e},loadRecordModel:n,rootPointer:r,intl:s,parentPointer:{table:E().ev,id:f.attributes.id}})))).filter(l().O9);f.children.push(...t)}else if(p||!(0,h().$I)(u.type)){let e;if(u.isType(h().xd.transclusionReference)){e=[];const t=u.getTransclusionReferenceTargetPointer();if(t){const r=await n(t);r&&(e=r.getRenderableContentIds())}}else e=u.getRenderableContentIds();const t=3e3,o=25,i=(await async function(e,t,n,r){const o=new Array(e.length);let i=!1;const a=setTimeout((()=>{i=!0}),n);try{const n=new Set;for(let a=0;a<e.length&&!i;a++){const s=a,l=e[a],d=(async()=>{try{if(i)return;const e=await r(l);i||(o[s]=e)}catch(e){i||(o[s]=void 0)}})().then((()=>{n.delete(d)}));if(n.add(d),n.size>=t&&await Promise.race(n),i)break}if(!i&&n.size>0){const e=new Promise((e=>{const t=setInterval((()=>{(i||0===n.size)&&(clearInterval(t),e())}),100)})),t=Array.from(n);await Promise.race([Promise.all(t),e])}}finally{clearTimeout(a)}return o}(e,o,t,(async e=>ee({pointer:{table:"block",id:e},loadRecordModel:n,rootPointer:r,parentPointer:y,spaceId:a,intl:s,currentTimeZone:d,viewedBlockIds:c})))).filter(l().O9);f.children.push(...i),i.forEach((e=>{e.parent=f}))}return f}async function te(e){const{loadRecordModel:t,collectionPointer:n,intl:r,currentTimeZone:o}=e,i=await t(n);if(!i)throw new(z().S2)(n.id,"Failed to build XML Node. No available collection model");const a=i.getParentPointer();if(a.table===O().Vl)throw new(z().S2)(n.id,"Unsupported operation for table");const s=await t(a);if(!s)throw new(z().QT)(n.id,"Failed to build XML node: missing block");if(!J(s.type))throw new(z().S2)(n.id,`Failed to build XML node: unsupported block type ${s.type}`);const l=R().RecordMapWithRole.create(),d=B().b4_.fromRecordMapWithRole(l),c={type:"collection",tagName:"database",parent:(0,W().ew)(a.id),attributes:{id:(0,W().z5)(n.id),title:i.getRenderTitle({getRecordModel:d,userTimeZone:(0,k().dB)(),intl:r})??""},persisted:!0,schemaId:(0,W().ew)(s.id),schemas:{},properties:{}},u=i.getDescription();if(u){const e={type:"property",tagName:"property-text",attributes:{name:"Description"},children:await Z({textValue:u,allowsText:!0,allowedTagNames:Object.keys(W()._S),loadRecordModel:t,intl:r,currentTimeZone:o})};c.properties.description=e}return await re({collectionPointedTo:i,node:c,loadRecordModel:t}),c}function ne(e){const t=e.getNormalizedSchema(),n=["title",...((0,j().L)(e.getFormat()||{},t,void 0,T().jf.Page).collection_page_properties||[]).map((({property:e})=>e))];return Object.entries(t).sort((([e],[t])=>n.indexOf(e)-n.indexOf(t)))}async function re({collectionPointedTo:e,node:t,loadRecordModel:n}){await Promise.all(ne(e).map((async([e,r])=>{if(!(0,a().Ut)(e)||!r)return;const o=`schema-${pe[r.type]}`;if((0,l().O)(W().U4,o))switch(o){case"schema-property-title":case"schema-property-text":case"schema-property-url":case"schema-property-email":case"schema-property-phone-number":case"schema-property-checkbox":case"schema-property-created-time":case"schema-property-created-by":case"schema-property-last-edited-by":case"schema-property-last-edited-time":{const e={type:"schema",tagName:o,attributes:{name:r.name,description:r.description},children:[]};t.schemas[r.name]=e;break}case"schema-property-date":{const e={type:"schema",tagName:o,attributes:{name:r.name,description:r.description},children:[]};t.schemas[r.name]=e;break}case"schema-property-number":{if("number"!==r.type)throw new Error(`Unexpected property schema type ${r.type}`);const e={type:"schema",tagName:o,attributes:{name:r.name,description:r.description,format:r.number_format||"number"},children:[]};t.schemas[r.name]=e;break}case"schema-property-person":{if("person"!==r.type)throw new Error(`Unexpected property schema type ${r.type}`);const e=1===r.limit?"1":"Infinity",n={type:"schema",tagName:o,attributes:{name:r.name,description:r.description,limit:e},children:[]};t.schemas[r.name]=n;break}case"schema-property-multi-select":case"schema-property-select":{if("select"!==r.type&&"multi_select"!==r.type)throw new Error(`Unexpected property schema type ${r.type}`);const e={type:"schema",tagName:o,attributes:{name:r.name,description:r.description},children:(r.options||[]).map((e=>({type:"inline",tagName:"schema-option",attributes:{option:e.value},children:[]})))};t.schemas[r.name]=e;break}case"schema-property-relation":{var i;if("relation"!==r.type)throw new Error(`Unexpected property schema type ${r.type}`);const e=1===r.limit?"1":"Infinity",a=(0,w().zO)(r),s=a?(0,W().z5)(a):void 0;if(!s)throw new Error("Cannot link to relation without table pointer");if(r.connectedRelation)break;const d=await n({id:s,table:O().Vl});if(!d)break;const c=d.getNormalizedSchema(),u=r.property&&(0,l().O)(c,r.property)?(null===(i=c[r.property])||void 0===i?void 0:i.name)??void 0:void 0,p={type:"schema",tagName:o,attributes:{name:r.name,description:r.description,limit:e,"database-id":s,"synced-property-name":u},children:[]};t.schemas[r.name]=p;break}case"schema-property-status":{if("status"!==r.type)throw new Error(`Unexpected property schema type ${r.type}`);const e={type:"schema",tagName:o,attributes:{name:r.name,description:r.description},children:(r.groups||[]).map((e=>({type:"inline",tagName:"schema-option-category",attributes:{category:e.name},children:(e.optionIds||[]).flatMap((e=>{var t;const n=null===(t=r.options)||void 0===t?void 0:t.find((t=>t.id===e));return n?{type:"inline",tagName:"schema-option",attributes:{option:n.value},children:[]}:[]}))})))};t.schemas[r.name]=e;break}default:(0,l().HB)(o)}})))}async function oe(e){const{block:t,node:n,loadRecordModel:o,intl:s,currentTimeZone:d}=e,c=t.DANGEROUSLY_INCORRECT_getCollectionPointer(),u=c&&await o(c);u&&"database-views"!==n.tagName&&await re({collectionPointedTo:u,node:n,loadRecordModel:o});const p=await(0,M().wC)({block:t,loadRecordModel:o}),m=p?ne(p):(0,h().$I)(t.type)?(0,l().WP)({title:(0,L().RX)(s).title}):void 0;if(m)await async function({propertySchemaByIdEntries:e,block:t,node:n,intl:o,collectionPointedTo:s,loadRecordModel:d,currentTimeZone:c}){const u=new Map;await(0,i().lX)(e,25,(async([e,n])=>{if(!(0,a().Ut)(e)||!n)return;const i=pe[n.type];if(!(0,l().O)(W().GU,i))return;const p="title"===e&&(null==s?void 0:s.getName())||t.getProperty(e);switch(i){case"property-title":{const t={type:"property",tagName:i,attributes:{name:n.name},children:await Z({textValue:p,allowsText:W().GU[i].text,allowedTagNames:W().GU[i].inline,loadRecordModel:d,intl:o,currentTimeZone:c})};u.set(e,t);break}case"property-text":{const t={type:"property",tagName:i,attributes:{name:n.name},children:await Z({textValue:p,allowsText:W().GU[i].text,allowedTagNames:W().GU[i].inline,loadRecordModel:d,intl:o,currentTimeZone:c})};u.set(e,t);break}case"property-url":{const t={type:"property",tagName:i,attributes:{name:n.name},children:await Z({textValue:I().jw(I().MO(p)),allowsText:W().GU[i].text,allowedTagNames:W().GU[i].inline,loadRecordModel:d,intl:o,currentTimeZone:c})};u.set(e,t);break}case"property-email":case"property-phone-number":{const t={type:"property",tagName:i,attributes:{name:n.name},children:await Z({textValue:p,allowsText:W().GU[i].text,allowedTagNames:W().GU[i].inline,loadRecordModel:d,intl:o,currentTimeZone:c})};u.set(e,t);break}case"property-person":{const r=B().Bj6.fromBlock(t),a={type:"property",tagName:i,attributes:{name:n.name},children:await Z({textValue:(0,x().h)((0,S().e)({textValue:p,propertySchema:n,blockCreatorPointer:r.getCreatedByPointer()})),allowsText:W().GU[i].text,allowedTagNames:W().GU[i].inline,loadRecordModel:d,intl:o,currentTimeZone:c})};u.set(e,a);break}case"property-created-by":case"property-last-edited-by":{let r;r="property-created-by"===i?t.getCreatedByPointer():t.getLastEditedByPointer();const a={type:"property",tagName:i,attributes:{name:n.name},children:await Z({textValue:(0,x().h)(r?[r]:[]),allowsText:W().GU[i].text,allowedTagNames:W().GU[i].inline,loadRecordModel:d,intl:o,currentTimeZone:c})};u.set(e,a);break}case"property-relation":{if("relation"!==n.type)throw new Error("Invalid type for property-relation");const t=(0,w().zO)(n);if(!t)throw new Error("Invalid database id for property-relation");const r=await d({table:O().Vl,id:t});if(!r)break;if(n.connectedRelation)break;const a=(0,W().z5)(r.id),s=(await I().jB({relationValue:(0,I().n)(p),loadRecordModel:d,relationLimit:n.limit??10})).map((e=>e.pointer)),l={type:"property",tagName:i,attributes:{name:n.name,"database-id":a},children:await Z({textValue:(0,I().Ap)(s),allowsText:W().GU[i].text,allowedTagNames:W().GU[i].inline,loadRecordModel:d,intl:o,currentTimeZone:c})};u.set(e,l);break}case"property-date":{const t={type:"property",tagName:i,attributes:{name:n.name},children:await Z({textValue:p,allowsText:W().GU[i].text,allowedTagNames:W().GU[i].inline,loadRecordModel:d,intl:o,currentTimeZone:c})};u.set(e,t);break}case"property-created-time":case"property-last-edited-time":{const a=r().DateTime.fromMillis(t[me[i]]),s={type:"property",tagName:i,attributes:{name:n.name},children:await Z({textValue:I().m5({type:"datetime",start_date:a.toISODate(),start_time:a.toFormat("HH:mm"),time_zone:a.zone.name}),allowsText:W().GU[i].text,allowedTagNames:W().GU[i].inline,loadRecordModel:d,intl:o,currentTimeZone:c})};u.set(e,s);break}case"property-checkbox":{const t={type:"property",tagName:i,attributes:{name:n.name,checked:(0,y().w)(p)?"true":"false"},children:await Z({textValue:p,allowsText:W().GU[i].text,allowedTagNames:W().GU[i].inline,loadRecordModel:d,intl:o,currentTimeZone:c})};u.set(e,t);break}case"property-select":case"property-multi-select":case"property-status":{let t;if("select"===n.type){const e=I().L3(p,n.options||[]);t=void 0!==e?[e]:[]}else if("multi_select"===n.type)t=I().o2(p,n.options||[]);else{if("status"!==n.type)throw new Error("Unexpected property schema type");{const e=I().RZ(p,n);t=void 0!==e?[e]:[]}}const r={type:"property",tagName:i,attributes:{name:n.name},children:t.map((e=>({type:"inline",tagName:"option",attributes:{option:e},children:[]})))};u.set(e,r);break}case"property-number":{if("number"!==n.type)throw new Error("Unexpected property schema type");const t=_().ZV(b().M(p),n.number_format,o),r={type:"property",tagName:i,attributes:{name:n.name,number:t},children:await Z({textValue:p,allowsText:W().GU[i].text,allowedTagNames:W().GU[i].inline,loadRecordModel:d,intl:o,currentTimeZone:c})};u.set(e,r);break}default:(0,l().HB)(i)}}));for(const[r,i]of e){if(!i)continue;const e=u.get(r);e&&(n.properties[i.name]=e)}}({propertySchemaByIdEntries:m,block:t,node:n,intl:s,loadRecordModel:o,collectionPointedTo:u,currentTimeZone:d});else for(const r of L().vn){const e=t.getProperty(r);if(e)if("title"===r)n.text.push(...await Z({textValue:e,allowsText:!0,allowedTagNames:(0,l().uv)(W()._S),loadRecordModel:o,intl:s,currentTimeZone:d}));else{const t=ie(r,e);t&&(n.attributes[r]=t)}}}function ie(e,t){if("checked"===e)return K().q4_(t)===f().I1?"true":"false"}const ae=Symbol("CitationToStrip");function se(e){const{getRecordModel:t,currentTimeZone:n}=e;if("text"===e.type){const{nodes:r,citationHandling:o}=e,i=function(e){return e.map(((t,n)=>{if(t===ae)return;const r=t;let o=K().N8A(r);return n<e.length&&e[n+1]===ae&&(o=o.trimEnd()),n>=0&&e[n-1]===ae&&(o=o.trimStart()),0!==o.length?K().Ey_(o,K().uPN(r)):void 0})).filter(l().O9)}(r.flatMap((e=>{if("inline"===e.type){const r=function(e){if("mention-date"===e||"mention-datetime"===e||"mention-date-range"===e||"mention-datetime-range"===e)return"d";if("mention-database"===e)return"p";const t=ye[e];return t}(e.tagName);if(!r)throw new Error(`Unknown inline element: ${e.tagName}`);const i=e.children;let a;if((0,l().O)(ge,r)){const n={node:e,getRecordModel:t};a=ge[r](n)}else{if(!function(e){if((0,l().O)(fe,e))return!0;return!1}(r))throw new Error(`Unsupported annotation type: ${r}`);a=[r]}if(!a)return[];const s=se({type:"text",nodes:i,getRecordModel:t,currentTimeZone:n})||[];if(K().iGj(a))return[K().Ey_(K().Sj,[a])];if(K().gir(a))return[K().Ey_(K().Yl$,[a])];if(K().sh$(a)&&(0,l().O9)(a[1])&&0===K().AhH(s)&&(0,l().O9)(o))if("createCitations"===o.type){const e=K().cQR(a),t=U().tD.parseAssistantHref(e);if(t){if("database_query_results"===t.type){const e=t.id;return[K().wmz(K().X$({type:"query_database_result",href:a[1],queryDatabaseResultId:e}))]}if("block"===t.type){const{blockId:e}=t;return[K().wmz(K().X$({href:a[1],blockId:e,type:"block"}))]}if("slack"===t.type){const{baseUrl:e,domain:n,channelId:r,messageId:i,threadTs:s}=t;return[K().wmz(K().X$({type:"slack",href:a[1],baseUrl:e,domain:n,channelId:r,messageId:i,threadTs:s,threadHref:o.getPageLevelCitationId(t.href)}))]}if("helpdoc"===t.type){const{url:e}=t;return[K().wmz(K().X$({href:a[1],url:e,type:t.type}))]}if("helpdoc-section"===t.type){const{url:e}=t;return[K().wmz(K().X$({href:a[1],url:e,type:t.type,parentPageHref:t.parentPageHref}))]}if("microsoft-teams"===t.type){const{url:e,channelId:n,messageId:r,threadTs:i,messageType:s}=t;return[K().wmz(K().X$({href:a[1],url:e,type:"microsoft-teams",channelId:n,messageId:r,threadTs:i,messageType:s,threadHref:o.getPageLevelCitationId(t.href)}))]}if("discord"===t.type){const{url:e}=t;return[K().wmz(K().X$({type:"discord",href:a[1],url:e}))]}if((0,c().aB)(t)){const{url:e}=t;return[K().wmz(K().X$({href:a[1],url:e,type:t.type,messageId:e}))]}if("webpage"===t.type){const{url:e}=t;return[K().wmz(K().X$({href:a[1],url:e,type:"webpage"}))]}if("citation_unsupported"===t.type)return[ae];(0,l().HB)(t)}}else{if("stripCitations"===o.type)return[ae];(0,l().HB)(o)}if(K().sh$(a)&&(0,l().O9)(a[1])){const e=K().cQR(a),t=U().tD.parseAssistantHref(e);if(t)if("slack"===t.type){const{baseUrl:e,domain:n,channelId:r,messageId:o,threadTs:i}=t,s=(0,p().mQ)({baseUrl:e,domain:n,channelId:r,messageId:o,threadTs:i});a=K().Sez(s)}else"google-drive"!==t.type&&"github"!==t.type&&"webpage"!==t.type&&"helpdoc"!==t.type&&"helpdoc-section"!==t.type||(a=K().Sez(t.url))}const d=a;return s.map((e=>K().Ey_(K().N8A(e),[d,...K().uPN(e)])))}if("text"===e.type)return[K().Ey_(e.value,[])];(0,l().HB)(e)}))),a="createCitations"!==(null==o?void 0:o.type)?i:function({tokens:e,getPageLevelCitationId:t}){const n=e=>{var n;if(!K().qXl(e))return;const r=null===(n=K().g2K(e[1]))||void 0===n?void 0:n[1].href;return r?t(r):void 0};return e.filter(((t,r)=>{if(0===r)return!0;const o=n(t);return!(0,l().O9)(o)||o!==n(e[r-1])}))}({tokens:i,getPageLevelCitationId:o.getPageLevelCitationId});return K().__s(a)}{const{property:r,nodes:i}=e;if("property-title"===r.tagName||"property-text"===r.tagName||"property-url"===r.tagName||"property-email"===r.tagName||"property-phone-number"===r.tagName)return se({type:"text",nodes:i,getRecordModel:t,currentTimeZone:n});if("property-person"===r.tagName){const e=o().oE(i.map((e=>"inline"===e.type&&"mention-person"===e.tagName?e.attributes["person-id"]:void 0)));return(0,x().h)(e.map((e=>({table:q().oo,id:e}))))}if("property-relation"===r.tagName){const e=o().oE(i.map((e=>{if("inline"===e.type&&"mention-page"===e.tagName)return e.attributes["page-id"]})));return(0,I().Ap)(e.map((e=>({table:E().ev,id:e}))))}if("property-date"===r.tagName){if(1!==i.length)throw new Error("Date property XML definition is invalid - should only have 1 mention");const e=i[0];if("inline"!==e.type)throw new Error("Date property XML definition should only have inline children");if("mention-date"===e.tagName)return I().m5({type:"date",start_date:e.attributes.date});if("mention-date-range"===e.tagName)return I().m5({type:"daterange",start_date:e.attributes["start-date"],end_date:e.attributes["end-date"]});if("mention-datetime"===e.tagName)return I().m5({type:"datetime",start_date:e.attributes.date,start_time:e.attributes.time,time_zone:n});if("mention-datetime-range"===e.tagName)return I().m5({type:"datetimerange",start_date:e.attributes["start-date"],end_date:e.attributes["end-date"],start_time:e.attributes["start-time"],end_time:e.attributes["end-time"],time_zone:n});throw new Error("Date property XML mention option is invalid")}if("property-checkbox"===r.tagName)return"true"===r.attributes.checked?f().h4:f().ZO;if("property-select"===r.tagName||"property-status"===r.tagName){const e=o().oE(i.map((e=>"inline"===e.type&&"option"===e.tagName?e.attributes.option:void 0)))[0];return I().U8(e)}if("property-multi-select"===r.tagName){const e=o().oE(i.map((e=>"inline"===e.type&&"option"===e.tagName?e.attributes.option:void 0)));return I().rK(e)}if("property-number"===r.tagName){const e=r.attributes.number,t=e?_().$J(e):void 0;return v().h(t)}if("property-created-time"===r.tagName||"property-last-edited-time"===r.tagName||"property-created-by"===r.tagName||"property-last-edited-by"===r.tagName)throw new Error(`You should not manually edit metadata of type ${r.tagName}.`);(0,l().HB)(r)}}const le={text:"text",page:"page",bulleted_list:"uli",numbered_list:"oli",toggle:"toggle",quote:"quote",factory:"factory",button:"button",to_do:"todo",column_list:"columns",column:"column",embed:"unknown-block",framer:"unknown-block",tweet:"unknown-block",gist:"unknown-block",drive:"unknown-block",figma:"unknown-block",loom:"unknown-block",typeform:"unknown-block",codepen:"unknown-block",audio:"unknown-block",maps:"unknown-block",invision:"unknown-block",image:"unknown-block",pdf:"unknown-block",video:"unknown-block",file:"unknown-block",bookmark:"unknown-block",temporary_ui:"unknown-block",equation:"math-block",code:"code-block",header:"h1",sub_header:"h2",sub_sub_header:"h3",header_4:"h4",collection_view:"database-views",collection_view_page:"database-views",breadcrumb:"breadcrumb",copy_indicator:"unknown-block",link_to_page:"link_to_page",link_to_collection:"link_to_collection",alias:"link-page",transclusion_container:"synced-block",transclusion_reference:"synced-block-reference",divider:"hr",callout:"callout",table_of_contents:"tableofcontents",whimsical:"unknown-block",miro:"unknown-block",abstract:"unknown-block",sketch:"unknown-block",excalidraw:"unknown-block",replit:"unknown-block",hex:"unknown-block",deepnote:"unknown-block",mixpanel:"unknown-block",post:"unknown-block",external_object_instance:"unknown-block",workflow:"unknown-block",transcription:"transcript",external_object_instance_page:"unknown-block",table:"table",table_row:"tr",tab:"tab",ai_block:"ai-block",drawing:"drawing",slide:"slide",mail:"mail-block",personal_home_page:"page",home_shortcuts:"page",form:"page",edit_reference:"page"},de={...(0,l().MU)((0,l().WP)(le).map((([e,t])=>[t,e]))),"child-page":"page","child-database":"page","link-page":"alias","link-database":"alias",page:"page"},ce={[h().xd.header]:"h1",[h().xd.subHeader]:"h2",[h().xd.subSubHeader]:"h3",[h().xd.header4]:"h4"},ue=(0,d().AH)(ce),pe={title:"property-title",text:"property-text",url:"property-url",email:"property-email",phone_number:"property-phone-number",checkbox:"property-checkbox",person:"property-person",created_by:"property-created-by",last_edited_by:"property-last-edited-by",file:"property-file",select:"property-select",multi_select:"property-multi-select",status:"property-status",number:"property-number",date:"property-date",created_time:"property-created-time",last_edited_time:"property-last-edited-time",last_visited_time:"property-last-visited-time",formula:"property-formula",rollup:"property-rollup",button:"property-button",auto_increment_id:"property-id",location:"property-location",verification:"property-verification",place:"property-geo-point",relation:"property-relation"},me=o().B8(pe),he={b:"b",i:"i",s:"s",c:"code","~":"~",_:"u","+":"+","-":"-",z:"z",u:"mention-person",r:"r",p:"mention-page",ds:"mention-data-source",dst:"dst",ce:"ce",pt:"pt",d:"mention-date",eoi:"eoi",tv:"tv",cm:"cm",m:"m",a:"a",h:"h",e:"e",et:"et",xt:"xt",st:"st",fpp:"fpp",fv:"fv",g:"group",t:"team",mark:"find-highlight",smark:"selected-find-highlight",ci:"ci",cit:"cit",tc:"tc",si:"si",sr:"sr",sa:"sa",sua:"sua",mabf:"mabf",dut:"dut",ht:"ht",lm:"mention-link",aic:"mention-database",tch:"tch",tsu:"tsu",plc:"plc",sm:"mention-slack",usc:"usc",sf:"sf",sfct:"sfct",sflet:"sflet",to:"to",so:"so",dm:"dm"},ge={u:({node:e})=>{if(!e.attributes["person-id"])throw new Error(`Missing attribute person-id for inline element ${e.tagName}`);return["u",e.attributes["person-id"]]},p:({node:e,getRecordModel:t})=>{if("mention-page"===e.tagName){if(!e.attributes["page-id"])throw new Error(`Missing attribute page-id for inline element ${e.tagName}`);return["p",e.attributes["page-id"]]}if("mention-database"===e.tagName){if(!e.attributes["database-id"])throw new Error(`Missing attribute database-id for inline element ${e.tagName}`);const n=t({id:e.attributes["database-id"],table:O().Vl}),r=null==n?void 0:n.getParentPointer();if((null==r?void 0:r.table)===E().ev)return["p",r.id]}else(0,l().HB)(e)},d:({node:e})=>"mention-date-range"===e.tagName?["d",{start_date:e.attributes["start-date"],end_date:e.attributes["end-date"],type:"daterange"}]:"mention-date"===e.tagName?["d",{start_date:e.attributes.date,type:"date"}]:"mention-datetime"===e.tagName?["d",{start_date:e.attributes.date,start_time:e.attributes.time,time_zone:(0,C().P)(),type:"datetime"}]:"mention-datetime-range"===e.tagName?["d",{start_date:e.attributes["start-date"],start_time:e.attributes["start-time"],end_date:e.attributes["end-date"],end_time:e.attributes["end-time"],time_zone:(0,C().P)(),type:"datetimerange"}]:void(0,l().HB)(e),a:({node:e})=>{if(!e.attributes.href)throw new Error(`Missing attribute href for inline element ${e.tagName}`);return["a",e.attributes.href]},h:({node:e})=>{if(!e.attributes.color)throw new Error(`Missing color attribute for inline element ${e.tagName}`);if(!W().Bt.includes(e.attributes.color))throw new Error(`Bad color attribute for inline element: ${e.attributes.color}`);return["h",W().BP[e.attributes.color]]},lm:({node:e})=>{if(!e.attributes.href)throw new Error(`Missing attribute href for inline element ${e.tagName}`);return["lm",{href:e.attributes.href,title:e.attributes.title,description:e.attributes.description,icon_url:e.attributes.icon_url}]},e:({node:e})=>{if(!e.attributes.equation)throw new Error(`Missing attribute equation for inline element ${e.tagName}`);return["e",e.attributes.equation]}},fe={[K().Ifu.Bold]:!0,[K().Ifu.Italic]:!0,[K().Ifu.Strike]:!0,[K().Ifu.Code]:!0,[K().Ifu.FormulaError]:!0,[K().Ifu.Underline]:!0,[K().Ifu.Inserted]:!0,[K().Ifu.Deleted]:!0,[K().Ifu.TemporaryComment]:!0,[K().Ifu.TemporaryCursor]:!0,[K().Ifu.TemporaryPage]:!0,[K().Ifu.TemporaryCitation]:!0,[K().Ifu.TemporaryCollection]:!0,[K().Ifu.TemporaryEquation]:!0,[K().Ifu.TemporarySelection]:!0,[K().Ifu.TemporaryFindHighlight]:!0,[K().Ifu.TemporarySelectedFindHighlight]:!0,[K().Ifu.TemporaryCommentHighlight]:!0,[K().Ifu.TitleOnly]:!0};const ye=(0,d().AH)(he);async function ve(e){return{type:"instructions",tagName:"instructions",attributes:{},children:e.shouldUsePlaceholderRecordInformation?await Z({textValue:e.textValue,allowsText:!0,allowedTagNames:W().qI,intl:e.intl,shouldUsePlaceholderRecordInformation:!0,currentTimeZone:e.currentTimeZone}):await Z({textValue:e.textValue,allowsText:!0,allowedTagNames:W().qI,loadRecordModel:e.loadRecordModel,intl:e.intl,currentTimeZone:e.currentTimeZone})}}function be(e){const{inlineNodes:t,idMapper:n,humanChatTag:r}=e,o=function(e){const{inlineNodes:t,idMapper:n}=e;return`<text>${t.map((e=>n.mapNodeKeyToCounter(e))).map((e=>(0,$().sD)({node:e,selection:void 0,namespace:"end_to_end"}))).join("")}</text>`}({inlineNodes:t,idMapper:n});return`<${r}>${o}</${r}>`}function xe(e){const t=function(e){const{chatValue:t,evaluatorState:n}=e,r=n.getIdMapper(),o=(0,G().gO)(n.parse(t),H().p$),i=(0,N().$d)((0,Q().dl)({allocateIdFn:()=>(0,W().ew)(A().Dt()),mapCounterToKey:e=>r.mapCounterToKey(e)}),o);return s().Q.isSuccess(i)?i.value.children:[]}({chatValue:e.humanChatValue,evaluatorState:e.evaluatorState});return t.flatMap((e=>{if("text"in e)return e.text})).filter(l().O9)}},438632:(e,t,n)=>{n.d(t,{PD:()=>u,cb:()=>d,hl:()=>p});n(16280),n(944114),n(898992),n(354520),n(803949),n(581454);var r=n.n(n(625473)),o=n.n(n(716471)),i=()=>n(496603),a=()=>n(534177),s=()=>n(634201),l=()=>n(201980);let d=function(e){return e[e.removed=-1]="removed",e[e.added=1]="added",e[e.same=0]="same",e}({});const c=1e4;function u(e,t){const n=new(o())({timeout:2,editCost:6}),r=n.main(t,e);return n.cleanupSemantic(r),r}function p(e){const t=performance.now(),{before:n,after:o,isIncompleteAfter:p,insertCursor:m}=e,h=l().AhH(n),g=l().AhH(o);if(Math.max(h,g)>c)return{diffValue:o,metrics:{beforeLength:h,afterLength:g,latencyMs:performance.now()-t}};const f={count:0,encoding:{},decoding:{},annotationEncoding:{},annotationDecoding:{}},y=e=>{const t=f.encoding[e];if(t)return t;{const t=String.fromCharCode(f.count);return f.count++,f.encoding[e]=t,f.decoding[t]=e,t}},v=e=>{const t=r()(e),n=f.annotationEncoding[t];if(n)return n;{const n=String.fromCharCode(f.count);return f.count++,f.annotationEncoding[t]=n,f.annotationDecoding[n]=e,n}},b=t=>i().Bq(l().RQ(t).map((t=>{let n=[];if("word"===e.mode||"wordUnderlineFinal"===e.mode){if("undefined"==typeof Intl||!Intl.Segmenter)throw new Error("Intl.Segmenter is not supported");{const e=new Intl.Segmenter(void 0,{granularity:"word"}).segment(t[0]);n=Array.from(e).map((e=>e.segment))}}else n=s().PE(t[0]);const r=n.map(y);if(l().qXl(t)){const e=l().uPN(t),n=l().jhx(e);n&&(r[0]=v({type:"mention",value:n}),e.forEach((e=>{l().iGj(e)||l().gir(e)||l().lfl(e)||(r.unshift(v({type:"start",value:e})),r.push(v({type:"end",value:e})))})))}else if(l().GiG(t)){const e=l().uPN(t),n=l().j1D(e);if(n){r[0]=v({type:"equation",value:n});for(const t of e)l().iGj(t)||l().gir(t)||l().lfl(t)||(r.unshift(v({type:"start",value:t})),r.push(v({type:"end",value:t})))}}else if(l().BEe(t)){l().uPN(t).forEach((e=>{r.unshift(v({type:"start",value:e})),r.push(v({type:"end",value:e}))}))}return r}))).join("");if(f.count>65535)throw new Error("This string has way too many different characters.");const x=u(b(o),b(n)),S=[];let w=[],I=0;const k=p?i().Kl(x,(e=>0===e[0]||1===e[0])):0;let T=!1;const M=e.insertionAnnotation,C=e.deletionAnnotation;x.forEach((([t,n])=>{n.split("").forEach((n=>{if(f.decoding[n]){const r=f.decoding[n];t===d.added?S.push([r,[...w,"wordUnderlineFinal"===e.mode?e.underlineAnnotation:M]]):t===d.removed&&(!p||I<=k)?"wordUnderlineFinal"!==e.mode&&S.push([r,[...w,C]]):(p&&m&&!T&&I===k+1&&(T=!0,S.push(["",[["tc"]]])),S.push([r,w]))}else{const r=f.annotationDecoding[n];if(t===d.added)if("mention"===r.type)S.push([l().Sj,[...w,"wordUnderlineFinal"===e.mode?e.underlineAnnotation:M,r.value]]);else if("start"===r.type)w=[...w,r.value];else if("end"===r.type)w=w.filter((e=>!i().n4(e,r.value)));else if("equation"===r.type){const e=l().U35(r.value),t=l().G0H(e,[...w,M]);S.push(t)}else(0,a().HB)(r);else if(t===d.removed){if("mention"===r.type)"wordUnderlineFinal"!==e.mode&&S.push([l().Sj,[...w,C,r.value]]);else if("equation"===r.type){const e=l().U35(r.value),t=l().G0H(e,[...w,C]);S.push(t)}}else if(t===d.same)if("mention"===r.type)S.push([l().Sj,[...w,r.value]]);else if("start"===r.type)w=[...w,r.value];else if("end"===r.type)w=w.filter((e=>!i().n4(e,r.value)));else if("equation"===r.type){const e=l().U35(r.value),t=l().G0H(e,w);S.push(t)}else(0,a().HB)(r)}})),p&&(I+=1)}));return{diffValue:l().__s(S),metrics:{beforeLength:h,afterLength:g,latencyMs:performance.now()-t}}}},439050:(e,t,n)=>{n.d(t,{T:()=>k,a:()=>T});n(581454);var r=n(296540),o=()=>n(590526),i=()=>n(401497),a=()=>n(127833),s=()=>n(30537),l=()=>n(807449),d=()=>n(546926),c=()=>n(890492),u=()=>n(81068),p=()=>n(663639),m=()=>n(736847),h=()=>n(452004),g=()=>n(112665),f=()=>n(349679),y=()=>n(69708),v=()=>n(100622),b=()=>n(56394),x=()=>n(385226),S=()=>n(322976),w=n(474848);const I=(0,y().YK)({allWithArchived:{id:"searchContentStatusFilter.allWithArchived",defaultMessage:"All pages (including archived)"},allWithoutArchived:{id:"searchContentStatusFilter.allWithoutArchived",defaultMessage:"All pages (excluding archived)"},verifiedOnly:{id:"searchContentStatusFilter.verifiedOnly",defaultMessage:"Verified pages only"}}),k="all_without_archived";function T(e){const{mode:t,title:n,value:T,onChange:M,onMenuDismiss:C,onMenuOpen:j}=e,A=(0,y().tz)(),B=(0,r.useMemo)((()=>[{key:"all_without_archived",value:"all_without_archived",title:A.formatMessage(I.allWithoutArchived)},{key:"all_with_archived",value:"all_with_archived",title:A.formatMessage(I.allWithArchived)},{key:"verified_only",value:"verified_only",title:A.formatMessage(I.verifiedOnly)}]),[A]),_=T??k,[N,P]=(0,r.useState)(!1),R=(0,o().uB)(void 0,h().$),E=(0,i().IS)((()=>({icon:{width:16,fill:"currentColor"},check:{color:v().Tj.text.primary}})),[]),O=(0,r.useCallback)((e=>{M(e),P(!1),null==C||C()}),[M,C]),F=(0,r.useCallback)((()=>{P(!0),null==j||j()}),[j]),D=(0,r.useCallback)((()=>{P(!1),null==C||C()}),[C]),q=(0,r.useCallback)((e=>e===_?(0,w.jsx)(l().I,{icon:f().checkmarkSmallIcon,size:"sm",style:E.check}):(0,w.jsx)("div",{style:E.check})),[_,E.check]),L=(0,r.useMemo)((()=>({key:"menuOptions",items:B.map((e=>({key:e.key,action:()=>O(e.value),render:t=>(0,w.jsx)(u().A,{...t,icon:q(e.value),title:e.title})}))),render:e=>(0,w.jsx)(m().A,{...e,title:null,loading:!1})})),[B,O,q]),K=(0,r.useCallback)((()=>(0,w.jsx)(c().A,{menuType:d().gu.Popup,header:null,maxHeight:250,width:260,children:(0,w.jsx)(p().A,{type:p().O.Vertical,store:R,initialFocus:0,sections:[L]})})),[R,L]),z=void 0!==T&&T!==k,V=(0,w.jsx)(b().A,{on:z,icon:(0,w.jsx)(l().I,{icon:g().badgeCheckIcon,fitToViewBox:"horizontal",style:E.icon}),title:(0,w.jsx)("span",{children:n}),onClick:F});return S().C.Pill,(0,w.jsx)(x().A,{children:(0,w.jsx)(a().zD,{popupType:s().n.Popup,originGap:4,placementToOrigin:"bottom",alignmentToOrigin:"start",open:N,render:K,onDismiss:D,keepFocus:!0,trapFocus:!0,origin:V,preventScaleTransition:!0})})}},445283:(e,t,n)=>{n.d(t,{A:()=>a});n(296540);var r=()=>n(401497),o=()=>n(100622),i=n(474848);function a(){(0,r().IS)((()=>({container:{margin:"8px 16px",background:o().Tj.palette.yellow[100],borderRadius:8,height:"fit-content"}})),[]);return(0,i.jsx)(i.Fragment,{})}},471159:(e,t,n)=>{n.d(t,{gO:()=>b});n(16280),n(18107),n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(967357),n(898992),n(823215),n(354520),n(672577),n(430670),n(581454),n(737550);var r=()=>n(496603),o=()=>n(534177),i=()=>n(412412),a=()=>n(252050),s=()=>n(968579),l=()=>n(762282),d=(n(803949),n.n(n(42833))),c=n.n(n(542922));const u={h1:{disableRules:["list"]},h2:{disableRules:["list"]},h3:{disableRules:["list"]},text:{disableRules:[]},uli:{disableRules:["heading"]},oli:{disableRules:[]},toggle:{disableRules:[]},quote:{disableRules:[]},todo:{disableRules:[]}};function p(e){return"element"===e.type&&void 0!==u[e.tagName]}class m extends l().o0{constructor(...e){super(...e),this.name="ConvertUliWithNumberToOli"}applyImpl(e,t){return e.map((e=>this.convertUliWithNumberToOli(e)))}convertUliWithNumberToOli(e){if("text"===e.type)return e;if("uli"===e.tagName){const t=(e.children.length>0&&"text"===e.children[0].type?e.children[0].value:"").match(/^(\d+)\.\s(.*)$/);if(t){const n=[...e.children.slice(1)];""!==t[2]&&n.unshift({type:"text",value:t[2]}),e={type:"element",tagName:"oli",attributes:{index:t[1]},children:n},this.markModified()}return e}return{...e,children:e.children.map((e=>this.convertUliWithNumberToOli(e)))}}}class h extends l().o0{constructor(...e){super(...e),this.name="ConvertMarkdownFormattingToXMLUsingMarkdownIt"}applyImpl(e,t){return e.flatMap((e=>this.convertMarkdownFormattingToXMLUsingMarkdownIt(e)))}convertMarkdownFormattingToXMLUsingMarkdownIt(e){if("text"===e.type)return e;if(p(e)){const t=(0,i()._o)(e,!1,0,!0),r=";!--childPlaceholder--;",o="\x3c!--childPlaceholder--\x3e",a="\x3c!--lt--\x3e",s="\x3c!--gt--\x3e",l=[],p=e.children.map((e=>"element"===e.type?(l.push(e),{type:"text",value:r}):e)).map((e=>(0,i()._o)(e,!1,0,!0))).join("").replaceAll("&lt;",a).replaceAll("&gt;",s).replaceAll(r,o),{disableRules:m}=u[e.tagName];let g=(0,n(128713).uY)({markdown:p,LinkifyIt:d(),MarkdownIt:c(),options:{breaks:!0},disable:["newline",...m]}).replace(/\n+/g,"\n").replace(/>\n+</g,"><").replace(/>\n$/,">").replace(/^\n/,"");for(const[e,n]of Object.entries(h.REPLACEMENTS))g=g.replaceAll(e,n);g=g.replace(new RegExp(o,"g"),(()=>{const e=l.shift();return e?(0,i()._o)(e,!1,0,!0):""})).replaceAll(a,"&lt;").replaceAll(s,"&gt;");let f=(0,i().BD)(g);1===f.length&&"element"===f[0].type&&"text"===f[0].tagName&&(f=f[0].children);const y={...e,children:f};return t!==(0,i()._o)(y,!1,0,!0)&&this.markModified(),y}return{...e,children:e.children.flatMap((e=>this.convertMarkdownFormattingToXMLUsingMarkdownIt(e)))}}}h.REPLACEMENTS={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#46;":".","<ul>":"","</ul>":"","<li>":"<uli>","</li>":"</uli>","<strong>":"<b>","</strong>":"</b>","<em>":"<i>","</em>":"</i>","<p>":"<text>","</p>":"</text>","<br>":"\n","<br/>":"\n"};class g extends l().o0{constructor(...e){super(...e),this.name="ConvertUnicodeBulletsToUlis"}applyImpl(e,t){return e.map((e=>this.convertUnicodeBulletsToUlis(e,!1)))}convertUnicodeBulletsToUlis(e,t){if("text"===e.type){const n=e.value.trim();if(n.startsWith("â€¢")){this.markModified();const e=n.replaceAll("â€¢","").trim();return t?{type:"text",value:e}:{type:"element",tagName:"uli",attributes:{},children:[{type:"text",value:e}]}}return e}const n="uli"===e.tagName||"oli"===e.tagName;return{...e,children:e.children.map((e=>this.convertUnicodeBulletsToUlis(e,n)))}}}class f extends l().o0{constructor(...e){super(...e),this.name="ConvertOlUliToOli"}applyImpl(e,t){return e.map((e=>this.convertOl(e)))}convertOl(e){return"text"===e.type?e:p(e)?(e=this.convertOlUliToOli(e),e=this.removeToDeleteNodes(e)):{...e,children:e.children.map((e=>this.convertOl(e)))}}convertOlUliToOli(e){if("element"===e.type&&"ol"===e.tagName){const t=e.children.filter((e=>"element"===e.type&&"uli"===e.tagName)),n=e.children.filter((e=>!("element"===e.type&&"uli"===e.tagName)));return{...e,tagName:"toDelete",children:[...t.map((t=>{var n;return{...t,tagName:"oli",attributes:{index:null===(n=e.attributes)||void 0===n?void 0:n.start}}})),...n]}}return"element"===e.type?{...e,children:e.children.map((e=>this.convertOlUliToOli(e)))}:e}removeToDeleteNodes(e){if("element"===e.type){let t=[];return e.children.forEach((e=>{"element"===e.type&&"toDelete"===e.tagName?(this.markModified(),t=t.concat(e.children)):t.push(this.removeToDeleteNodes(e))})),{...e,children:t}}return e}}class y extends l().o0{constructor(...e){super(...e),this.name="ConvertTextChildrenOfListItems"}applyImpl(e,t){return e.flatMap((e=>this.convertTextChildrenOfListItems(e)))}convertTextChildrenOfListItems(e){return"text"===e.type?e:"oli"===e.tagName||"uli"===e.tagName||"quote"===e.tagName?{...e,children:e.children.flatMap((e=>"element"===e.type&&"text"===e.tagName?(this.markModified(),e.children):e))}:{...e,children:e.children.map((e=>this.convertTextChildrenOfListItems(e)))}}}class v extends l().o0{constructor(...e){super(...e),this.name="CollapseRedundantParentTags"}applyImpl(e,t){return e.flatMap((e=>this.collapseRedundantParentTags(e)))}collapseRedundantParentTags(e){return"text"===e.type?e:p(e)?this.generalCollapse(e):{...e,children:e.children.map((e=>this.collapseRedundantParentTags(e)))}}generalCollapse(e){if("element"===e.type){for(const[t,[n,r]]of v.collapseRules){if(("hx"===n?/^h[1-3]$/.test(e.tagName):e.tagName===n)&&1===e.children.length&&"element"===e.children[0].type){const n=e.children[0],o="hx"===r?/^h[1-3]$/.test(n.tagName):n.tagName===r;if("element"===n.type&&o)return this.markModified(),{...n,tagName:"hx"===t?e.tagName:t,attributes:{...e.attributes,...n.attributes}}}}return{...e,children:e.children.map((e=>this.generalCollapse(e)))}}return e}}function b(e,t,n){const{nodes:r}=function({xmlNodes:e,state:t,debug:n=!1,autoFixerNamesToSkip:r}){let o="",a="";const s=[],l=new Set(r??[]),d=ee.filter((e=>!l.has(e.name)));for(const c of d)n&&(o=e.map((e=>(0,i()._o)(e))).join("")),e=c.apply(e,t),n&&c.modified()&&(a=e.map((e=>(0,i()._o)(e))).join(""),s.push({name:c.name,before:o,after:a}));return{nodes:e,activeAutoFixerNames:d.filter((e=>e.modified())).map((e=>e.name)),debugLogs:s}}({xmlNodes:e,state:t,debug:!1,autoFixerNamesToSkip:n});return r}v.collapseRules=[["oli",["uli","oli"]],["uli",["hx","uli"]],["hx",["hx","oli"]],["hx",["hx","text"]],["text",["text","text"]],["b",["b","b"]],["uli",["text","uli"]],["uli",["uli","text"]],["oli",["text","oli"]],["oli",["oli","text"]],["toggle",["toggle","text"]],["quote",["quote","text"]],["todo",["todo","text"]],["oli",["oli","text"]]];class x extends l().o0{constructor(...e){super(...e),this.name="CleanupSearchTags"}applyImpl(e,t){return e.map((e=>this.cleanupSearchTags(e)))}cleanupSearchTags(e){if("element"!==e.type)return e;if("search"!==e.tagName)return e;const t=Object.fromEntries(Object.entries(e.attributes).map((([e,t])=>{if("question"===e||"keywords"===e||"question-intl"===e)return[e,t];if("source"===e){const e=t;return s().Ut.includes(e)?["source",e]:void this.markModified()}if("lookback"===e)return["lookback",t];if("channel"===e)return["channel",t];if("sort"===e)return["sort",t];if("file-type"===e){const e=t;return s().Km.includes(e)?["file-type",e]:void this.markModified()}return"contributor"===e?["contributor",t]:"repo"===e?["repo",t]:"database"===e?["database",t]:"database-id"===e?(this.markModified(),["database",t]):"search-notion-help"===e&&"true"===t?["search-notion-help","true"]:void this.markModified()})).filter((e=>void 0!==e)));return{...e,attributes:t}}}class S extends l().o0{constructor(...e){super(...e),this.name="CollapseTableSectionTags"}applyImpl(e,t){return e.flatMap((e=>this.collapseTableSectionTags(e)))}collapseTableSectionTags(e){return"element"===e.type?"thead"===e.tagName||"tbody"===e.tagName||"tfoot"===e.tagName?(this.markModified(),e.children.flatMap((e=>this.collapseTableSectionTags(e)))):[{...e,children:e.children.flatMap((e=>this.collapseTableSectionTags(e)))}]:[e]}}class w extends l().o0{constructor(...e){super(...e),this.name="CitationATagInnerTextRemover"}applyImpl(e,t){return e.map((e=>"element"===e.type&&"chat"===e.tagName?{...e,children:e.children.flatMap((e=>this.ensureCitationATagsHaveNoInnerText(e)))}:e))}ensureCitationATagsHaveNoInnerText(e){if("element"===e.type){if("a"===e.tagName){const t=e.attributes.href;if(t&&/^[0-9]+$/.test(t)){e.children.length>0&&this.markModified();const t=e.children.flatMap((e=>this.ensureCitationATagsHaveNoInnerText(e)));return e.children=[],[...t,e]}}const{children:t,...n}=e;return[{...n,children:t.flatMap((e=>this.ensureCitationATagsHaveNoInnerText(e)))}]}return[e]}}class I extends l().o0{constructor(...e){super(...e),this.name="MarkdownInlineNodeConverter"}applyImpl(e,t){return e.map((e=>"element"===e.type&&"chat"===e.tagName?{...e,children:e.children.flatMap((e=>this.convertInlineMarkdownToXML(e,[])))}:e))}convertInlineMarkdownToXML(e,t){const n=t.some((e=>"element"===e.type&&("code-block"===e.tagName||"code"===e.tagName||"math-block"===e.tagName)));if("text"!==e.type||n)return"element"===e.type?[{...e,children:e.children.flatMap((n=>this.convertInlineMarkdownToXML(n,[...t,e])))}]:[e];{const t=/(\*\*|~~|\*|`)(.+?)\1/g,n=[];let r,o=0;for(;null!==(r=t.exec(e.value));){const[i,a,s]=r,l=e.value.slice(o,r.index);let d;switch(l&&n.push({type:"text",value:l}),a){case"**":d={type:"element",tagName:"b",attributes:{},children:[{type:"text",value:s}]};break;case"*":d={type:"element",tagName:"i",attributes:{},children:[{type:"text",value:s}]};break;case"`":d={type:"element",tagName:"code",attributes:{},children:[{type:"text",value:s}]};break;case"~~":d={type:"element",tagName:"s",attributes:{},children:[{type:"text",value:s}]}}if(!d)throw new Error("Unreachable");n.push(d),this.markModified(),o=t.lastIndex}const i=e.value.slice(o);return i&&n.push({type:"text",value:i}),n}}}class k extends l().o0{constructor(...e){super(...e),this.name="RemoveExtraSearchNotionHelpAttributes"}applyImpl(e,t){const n=e.map((e=>(0,i()._o)(e))).join(""),r=this.removeExtraSearchNotionHelpAttributes(e);return n!==r.map((e=>(0,i()._o)(e))).join("")&&this.markModified(),r}removeExtraSearchNotionHelpAttributes(e){let t=!1;return e.map((e=>("element"===e.type&&"search"===e.tagName&&a().HV in e.attributes&&(t?(this.markModified(),delete e.attributes[a().HV]):t=!0),e)))}}class T extends l().o0{constructor(...e){super(...e),this.name="DowngradeBlocksToTextInSimpleTables"}applyImpl(e,t){return e.map((e=>this.downgradeBlocksToTextInSimpleTables(e)))}downgradeBlocksToTextInSimpleTables(e){return"text"===e.type?e:"table"===e.tagName?{...e,children:e.children.flatMap((e=>this.maybeConvertToInlineNode(e)))}:{...e,children:e.children.map((e=>this.downgradeBlocksToTextInSimpleTables(e)))}}maybeConvertToInlineNode(e){if("text"===e.type||(0,l().Qz)(e))return[e];if("text"===e.tagName||"h2"===e.tagName||"h1"===e.tagName||"h3"===e.tagName||"quote"===e.tagName||"todo"===e.tagName||"toggle"===e.tagName||"callout"===e.tagName||"code-block"===e.tagName||"math-block"===e.tagName)return this.markModified(),e.children.flatMap((e=>this.maybeConvertToInlineNode(e)));if("uli"===e.tagName||"oli"===e.tagName){const t=e.children.flatMap((e=>this.maybeConvertToInlineNode(e)));return this.markModified(),[{type:"text",value:"Â· "},...t]}{const t=e.children.flatMap((e=>this.maybeConvertToInlineNode(e)));return[{...e,children:t}]}}}class M extends l().o0{constructor(...e){super(...e),this.name="TextWrapTopLevelInlineNodes"}applyImpl(e,t){return e.map((e=>"element"!==e.type||"chat"!==e.tagName&&"insert"!==e.tagName&&"insert-before"!==e.tagName&&"insert-after"!==e.tagName&&"create-page"!==e.tagName&&"replace"!==e.tagName?e:this.textWrapTopLevelInlineNodes(e)))}textWrapTopLevelInlineNodes(e){if("element"===e.type){const t=[],n=this.trimLeadingAndTrailingWhitespace(e.children),r=e=>{if(e&&"element"===e.type&&(0,l().Y7)(e)){const t=e.children.at(-1);return!t||(0,l().Qz)(t)}return!1};for(const e of n)if((0,l().Qz)(e)){this.markModified();const n=t.at(-1);"element"===(null==n?void 0:n.type)&&r(n)?n.children.push(e):t.push({type:"element",tagName:"text",attributes:{},children:[e]})}else t.push(e);return{...e,children:t}}return e}}class C extends l().o0{constructor(...e){super(...e),this.name="WrapNodesWithRequiredParent",this.wrapNodesMap={td:"tr",tr:"table"}}applyImpl(e,t){return e.map((e=>this.wrapNodesWithRequiredParent(e)))}wrapNodesWithRequiredParent(e){if("element"===e.type){let t=e;for(const n of(0,o().uv)(this.wrapNodesMap))t.tagName!==this.wrapNodesMap[n]&&e.children.some((e=>"element"===e.type&&e.tagName===n))&&(this.markModified(),t={...e,children:[{type:"element",tagName:this.wrapNodesMap[n],attributes:{},children:e.children}]});return{...t,children:t.children.map((e=>this.wrapNodesWithRequiredParent(e)))}}return e}}class j extends l().o0{constructor(...e){super(...e),this.name="UnwrapHTMLLists"}applyImpl(e,t){return e.flatMap((e=>this.unwrapHTMLLists(e,void 0)))}unwrapHTMLLists(e,t){return"element"===e.type?"ul"===e.tagName||"ol"===e.tagName?(this.markModified(),e.children.flatMap((t=>this.unwrapHTMLLists(t,e.tagName)))):"li"===e.tagName?(this.markModified(),[{...e,tagName:"ol"===t?"oli":"uli",children:e.children.flatMap((e=>this.unwrapHTMLLists(e,t)))}]):[{...e,children:e.children.flatMap((e=>this.unwrapHTMLLists(e,t)))}]:[e]}}class A extends l().o0{constructor(...e){super(...e),this.name="RemoveBlockIds"}applyImpl(e,t){return e.map((e=>this.removeBlockIds(e)))}removeBlockIds(e){if("element"===e.type){if((0,l().CD)(e)&&"unknown-block"!==e.tagName){e.attributes.id&&this.markModified();const t=r().cJ(e.attributes,"id");return{...e,attributes:t,children:e.children.map((e=>this.removeBlockIds(e)))}}return{...e,children:e.children.map((e=>this.removeBlockIds(e)))}}return e}}class B extends l().o0{constructor(...e){super(...e),this.name="FixCodeBlockLanguage"}applyImpl(e,t){return e.map((e=>this.fixCodeBlockLanguage(e)))}fixCodeBlockLanguage(e){if("element"===e.type){if("code-block"===e.tagName){const t=e.attributes.language;if(t&&!n(15440).yz.includes(t)){this.markModified();const t=r().cJ(e.attributes,"language");return{...e,attributes:t,children:e.children.map((e=>this.fixCodeBlockLanguage(e)))}}}return{...e,children:e.children.map((e=>this.fixCodeBlockLanguage(e)))}}return e}}class _ extends l().o0{constructor(...e){super(...e),this.name="SanitizeTextNodes"}applyImpl(e,t){const n=e.map((e=>(0,i()._o)(e))).join(""),o=r().oE(e.map((e=>this.sanitizeTextNodes(e))));return n!==(0,i().PJ)(o)&&(this.modified()||this.markModified()),o}sanitizeTextNodes(e){if("element"===e.type){if((0,o().O)(a().sA,e.tagName)&&a().sA[e.tagName].title){let t=!1;const n=[...e.children],r=[],o=[];for(;n.length>0;){const e=n.shift();if((0,l().Qz)(e))if(t){const t=[e];for(;n.length>0&&(0,l().Qz)(n[0]);)t.push(n.shift());const o=this.trimLeadingAndTrailingWhitespace(t);o.length>0&&r.push({type:"element",tagName:"text",attributes:{},children:o})}else o.push(e);else{const n=this.sanitizeTextNodes(e);n&&r.push(n),t=!0}}const i=[...this.trimLeadingAndTrailingWhitespace(o),...r];return{...e,children:i}}return(0,o().O)(a().GU,e.tagName)?{...e,children:this.trimLeadingAndTrailingWhitespace(e.children)}:{...e,children:e.children?r().oE(e.children.map((e=>this.sanitizeTextNodes(e)))):[]}}{const t=e.value.trim();if(t)return t!==e.value?{...e,value:t}:e}}}class N extends l().o0{constructor(...e){super(...e),this.name="TrimLinesBetweenBrTags"}applyImpl(e,t){return e.map((e=>this.trimLinesBetweenBrTags(e)))}trimLinesBetweenBrTags(e){if("element"===e.type){if(e.children.some((e=>"element"===e.type&&"br"===e.tagName))){const t=e.children.map((e=>{if("text"===e.type){const t=e.value.trim();return t!==e.value?(this.markModified(),{type:"text",value:t}):e}return this.trimLinesBetweenBrTags(e)}));return{...e,children:t}}return{...e,children:e.children.map((e=>this.trimLinesBetweenBrTags(e)))}}return e}}class P extends l().o0{constructor(...e){super(...e),this.name="ConvertBrToNewline"}applyImpl(e,t){return e.flatMap((e=>this.convertBrToNewline(e)))}convertBrToNewline(e){return"element"===e.type?"br"===e.tagName?(this.markModified(),[{type:"text",value:"\n"}]):[{...e,children:e.children.flatMap((e=>this.convertBrToNewline(e)))}]:[e]}}class R extends l().o0{constructor(...e){super(...e),this.name="RemoveTopLevelWhitespace"}applyImpl(e,t){return e.flatMap((e=>"text"===e.type?(this.markModified(),[]):[e]))}}class E extends l().o0{constructor(...e){super(...e),this.name="ClampHeaderLevel",this.headerRegex=/^h(\d+)$/}applyImpl(e,t){return e.map((e=>this.clampHeaderLevel(e)))}clampHeaderLevel(e){if("element"!==e.type)return e;let t=e.tagName;const n=e.tagName.match(this.headerRegex);if(n){parseInt(n[1],10)>3&&(this.markModified(),t="h3")}return{...e,tagName:t,children:e.children.map((e=>this.clampHeaderLevel(e)))}}}class O extends l().o0{constructor(...e){super(...e),this.name="MoveCreatePageInChatToTopLevel"}applyImpl(e,t){return e.flatMap((e=>this.moveCreatePageInChatToTopLevel(e)))}moveCreatePageInChatToTopLevel(e){if("element"===e.type&&"chat"===e.tagName){const t=e.children.filter((e=>"element"===e.type&&"create-page"===e.tagName));if(0===t.length)return[e];this.markModified();const n=e.children.filter((e=>!t.includes(e)));return[{...e,children:n},...t]}return[e]}}class F extends l().o0{constructor(...e){super(...e),this.name="TransformTopLevelApisInCreatePageToCreatePage"}applyImpl(e,t){return e.map((e=>this.transformTopLevelApisInCreatePageToCreatePage(e)))}transformTopLevelApisInCreatePageToCreatePage(e){const t=["page","insert"];if("element"===e.type&&"create-page"===e.tagName){let n,r=[];for(const o of e.children)"element"===o.type&&t.includes(o.tagName)?(n||(n=o),r=[...r,...o.children]):r.push(o);return n?(this.markModified(),{type:"element",tagName:"create-page",attributes:{...n.attributes,...e.attributes.in&&{in:e.attributes.in}},children:r}):e}return e}}class D extends l().o0{constructor(...e){super(...e),this.name="MoveTopLevelCreateOrPageToCreatePage"}applyImpl(e,t){return e.map((e=>this.moveTopLevelCreateOrPageToCreatePage(e)))}moveTopLevelCreateOrPageToCreatePage(e){return"element"===e.type&&"page"===e.tagName?(this.markModified(),{type:"element",tagName:"create-page",attributes:{},children:e.children}):"element"===e.type&&"create"===e.tagName&&1===e.children.length&&"element"===e.children[0].type&&"page"===e.children[0].tagName?(this.markModified(),{type:"element",tagName:"create-page",attributes:{},children:e.children[0].children}):e}}class q extends l().o0{constructor(...e){super(...e),this.name="TagNameMapper",this.inlineTagNameMap={strong:"b",p:"text",span:"inline",sub:"inline",sup:"inline"}}applyImpl(e,t){return e=(e=e.flatMap((e=>this.mapTagNames(e,this.inlineTagNameMap)))).map((e=>"element"===e.type&&"chat"===e.tagName?{...e,children:e.children.flatMap((e=>this.mapTagNames(e,{chat:"text"})))}:e))}mapTagNames(e,t){if("element"===e.type){const n=t[e.tagName.toLowerCase()];if(void 0!==n&&this.markModified(),"inline"===n){return{type:"text",value:e.children.map((e=>"text"===e.type?e.value:"")).join("")}}const r=n||e.tagName;return{...e,tagName:r,children:e.children.map((e=>this.mapTagNames(e,t)))}}return e}}class L extends l().o0{constructor(...e){super(...e),this.name="UnwrapEmptyBlocks"}applyImpl(e,t){return e.flatMap((e=>this.unwrapEmptyBlocks(e)))}unwrapEmptyBlocks(e){if("element"===e.type){return!e.children.every((e=>(0,l().CD)(e)))||"uli"!==e.tagName&&"oli"!==e.tagName&&"text"!==e.tagName&&"toggle"!==e.tagName&&"quote"!==e.tagName?[{...e,children:e.children.flatMap((e=>this.unwrapEmptyBlocks(e)))}]:(this.markModified(),e.children.flatMap((e=>this.unwrapEmptyBlocks(e))))}return[e]}}class K extends l().o0{constructor(...e){super(...e),this.name="UnwrapSyncedBlocks"}applyImpl(e,t){return e.flatMap((e=>this.unwrapSyncedBlocks(e)))}unwrapSyncedBlocks(e){return"element"===e.type?"synced-block-reference"===e.tagName||"synced-block"===e.tagName?(this.markModified(),e.children.flatMap((e=>this.unwrapSyncedBlocks(e)))):[{...e,children:e.children.flatMap((e=>this.unwrapSyncedBlocks(e)))}]:[e]}}class z extends l().o0{constructor(...e){super(...e),this.name="RemoveDisallowedBlocks"}applyImpl(e,t){return e.flatMap((e=>this.removeDisallowedBlocks(e)))}removeDisallowedBlocks(e){return"element"===e.type?z.removeBlockTagNames[e.tagName]?(this.markModified(),[]):[{...e,children:e.children.flatMap((e=>this.removeDisallowedBlocks(e)))}]:[e]}}z.removeBlockTagNames={"database-views":!0};class V extends l().o0{constructor(...e){super(...e),this.name="UnwrapBlocksInProperties"}applyImpl(e,t){return e.flatMap((e=>this.unwrapBlocksInProperties(e)))}unwrapBlocksInProperties(e){if("element"===e.type){if((0,l().YV)(e))return[{...e,children:e.children.flatMap((e=>this.unwrapBlocks(e)))}];{const t=e;return[{...t,children:t.children.flatMap((e=>this.unwrapBlocksInProperties(e)))}]}}return[e]}unwrapBlocks(e){if("element"===e.type){if((0,l().CD)(e))return this.markModified(),[...e.children.flatMap((e=>this.unwrapBlocks(e))),{type:"text",value:"\n"}];{const t=e;return[{...t,children:t.children.flatMap((e=>this.unwrapBlocks(e)))}]}}return[e]}}class U extends l().o0{constructor(...e){super(...e),this.name="RemoveUnsupportedProperties"}applyImpl(e,t){return e.flatMap((e=>this.removeUnsupportedProperties(e)))}removeUnsupportedProperties(e){return"element"===e.type?"property-created-time"===e.tagName||"property-last-edited-time"===e.tagName||"property-created-by"===e.tagName||"property-last-edited-by"===e.tagName?(this.markModified(),[]):[{...e,children:e.children.flatMap((e=>this.removeUnsupportedProperties(e)))}]:[e]}}class H extends l().o0{constructor(...e){super(...e),this.name="RemoveNonTitleProperties"}applyImpl(e,t){return e.flatMap((e=>"element"!==e.type||("create-page"!==e.tagName||e.attributes.in)&&"replace"!==e.tagName?[e]:this.removeNonTitleProperties(e)))}removeNonTitleProperties(e){return"element"===e.type?e.tagName.startsWith("property-")&&"property-title"!==e.tagName?(this.markModified(),[]):[{...e,children:e.children.flatMap((e=>this.removeNonTitleProperties(e)))}]:[e]}}class W extends l().o0{constructor(...e){super(...e),this.name="ConvertToggleToUli"}applyImpl(e,t){return e.map((e=>"element"===e.type&&"chat"===e.tagName?this.convertToggleToUli(e):e))}convertToggleToUli(e){return"element"===e.type?"toggle"===e.tagName?(this.markModified(),{...e,tagName:"uli",attributes:{},children:e.children.map((e=>this.convertToggleToUli(e)))}):{...e,children:e.children.map((e=>this.convertToggleToUli(e)))}:e}}class $ extends l().o0{constructor(...e){super(...e),this.name="RemoveATargetAttribute"}applyImpl(e,t){return e.map((e=>this.removeATargetAttribute(e)))}removeATargetAttribute(e){if("element"===e.type&&"a"===e.tagName&&e.attributes.target){const t=r().cJ(e.attributes,"target");return{...e,attributes:t,children:e.children.map((e=>this.removeATargetAttribute(e)))}}return e}}class G extends l().o0{constructor(...e){super(...e),this.name="JoinAdjacentTextNodes"}applyImpl(e,t){return e.map((e=>this.joinAdjacentTextNodes(e)))}joinAdjacentTextNodes(e){if("text"===e.type)return e;const t=[];for(const n of e.children){const e=t.at(-1);"text"===n.type&&e&&"text"===e.type&&""!==n.value?(this.markModified(),t[t.length-1]={type:"text",value:e.value+n.value}):t.push(this.joinAdjacentTextNodes(n))}return{...e,children:t}}}class Q extends l().o0{constructor(...e){super(...e),this.name="UnwrapPages"}applyImpl(e,t){return e.flatMap((e=>"element"!==e.type||"insert"!==e.tagName&&"chat"!==e.tagName?[e]:this.unwrapPages(e)))}unwrapPages(e){return"element"===e.type?"page"===e.tagName||"child-page"===e.tagName?(this.markModified(),e.children.flatMap((e=>this.unwrapPages(e)))):[{...e,children:e.children.flatMap((e=>this.unwrapPages(e)))}]:[e]}}class Y extends l().o0{constructor(...e){super(...e),this.name="RemoveProperties"}applyImpl(e,t){return e.map((e=>"element"!==e.type||"insert"!==e.tagName&&"chat"!==e.tagName?e:this.removeProperties(e)))}removeProperties(e){if("text"===e.type)return e;if(e.children.some(l().YV)){const t=e.children.flatMap((t=>"element"!==e.type?[t]:(0,l().YV)(t)?(this.markModified(),"property-title"===t.tagName?[{type:"element",attributes:{},tagName:"h1",children:t.children}]:[]):[t]));return{...e,children:t.map((e=>this.removeProperties(e)))}}return{...e,children:e.children.map((e=>this.removeProperties(e)))}}}class Z extends l().o0{constructor(...e){super(...e),this.name="TruncateSearches"}applyImpl(e,t){return this.truncateSearches(e)}truncateSearches(e){let t=0;return e.flatMap((e=>"element"!==e.type||"search"!==e.tagName?[e]:t<3?(t+=1,[e]):(this.markModified(),[])))}}class X extends l().o0{constructor(...e){super(...e),this.name="FillEmptyQueryDatabaseWithEmptySearch"}applyImpl(e,t){return e.map((e=>this.fillEmptyQueryDatabaseWithEmptySearch(e)))}fillEmptyQueryDatabaseWithEmptySearch(e){return"element"!==e.type||"query-database"!==e.tagName||e.children.length>0?e:(this.markModified(),{...e,children:[{type:"element",tagName:"search",attributes:{question:"",keywords:"",lookback:"default"},children:[]}]})}}class J extends l().o0{constructor(...e){super(...e),this.name="AutofixTypesInDatabaseQueryOutput"}applyImpl(e,t){return t?e.map((e=>this.autofixTypesInDatabaseQueryOutput(e,t))):e}autofixTypesInDatabaseQueryOutput(e,t){var n;if("element"!==e.type||"query-database"!==e.tagName)return e;const r=e.attributes.id;if(!r)return e;const o=null===(n=t.idMapper.keyMap.find((e=>e.counter===r)))||void 0===n?void 0:n.key;if(!o)return e;const i=t.collectionIdMap[o.key];if(!i)return e;const a=(0,l().uI)(e,(e=>this.fixQueryDatabaseFilterSortTypes(e,i.schemas)));return a}fixQueryDatabaseFilterSortTypes(e,t){if("element"!==e.type)return e;const n=e.tagName.startsWith("filter"),r=e.tagName.startsWith("sort");if(!n&&!r)return e;const o=e.attributes.name,i=Object.entries(t).filter((([e,t])=>e===o)).map((([e,t])=>t.tagName.replace(/^schema-property-/,""))),a=e.tagName.replace(/^(filter|sort)-property-/,"");return 0===i.length||i.includes(a)?e:(this.markModified(),{...e,tagName:`${n?"filter":"sort"}-property-${i[0]}`})}}const ee=[new x,new w,new I,new g,new q,new T,new N,new P,new R,new E,new M,new _,new C,new H,new U,new j,new A,new B,new F,new Q,new Y,new O,new D,new m,new h,new f,new y,new L,new v,new $,new K,new z,new W,new V,new G,new Z,new X,new k,new J,new S]},471327:(e,t,n)=>{n.d(t,{X:()=>h});n(296540);var r=()=>n(401497),o=()=>n(396896),i=()=>n(807449),a=()=>n(631524),s=()=>n(160432),l=()=>n(302501),d=()=>n(995847),c=()=>n(69708),u=()=>n(100622),p=()=>n(284371),m=n(474848);function h({title:e,description:t,onDismiss:n,icon:h,primaryAction:g,secondaryAction:f}){const y=(0,c().tz)(),v=(0,r().IS)((()=>({container:{position:"relative",width:"100%",padding:16},multiIconsRow:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:12},singleIconRow:{position:"absolute",top:10,insetInlineEnd:16},dismissButton:{marginTop:-7,marginInlineEnd:-7},title:{fontWeight:p().Wy.medium,fontSize:p().J.UIRegular.desktop,lineHeight:1.2,color:u().Tj.darkTextColor,marginBottom:6},description:{fontWeight:p().Wy.regular,fontSize:p().J.UISmall.desktop,color:u().Tj.text.secondary,marginBottom:12},primaryActionButton:{width:"100%",display:"flex",justifyContent:"center",whiteSpace:"normal"},secondaryActionButton:{width:"100%",display:"flex",justifyContent:"center"}})),[]),b=y.formatMessage({id:"prompt.dismissButton.ariaLabel",defaultMessage:"Close"});return(0,m.jsxs)("div",{style:v.container,children:[h?(0,m.jsxs)("div",{style:v.multiIconsRow,children:[(0,m.jsx)(i().I,{icon:h}),(0,m.jsx)(a().p,{size:"sm",style:v.dismissButton,onClick:n,"aria-label":b,iconLeading:{icon:d().xMarkSmallIcon,size:"xs"}})]}):(0,m.jsx)("div",{style:v.singleIconRow,children:(0,m.jsx)(a().p,{size:"sm",style:v.dismissButton,onClick:n,"aria-label":b,iconLeading:{icon:d().xMarkSmallIcon,size:"xs"}})}),(0,m.jsx)(l().A,{style:v.title,isMultiline:!0,children:e}),(0,m.jsx)(l().A,{style:v.description,isMultiline:!0,isSmall:!0,children:t}),(0,m.jsxs)(o().VP,{gap:8,children:[g?(0,m.jsx)(s().A,{colorPalette:"blue",size:"lg",style:v.primaryActionButton,onClick:e=>g.onClick(e),"aria-label":g.ariaLabel,children:g.text}):null,f?(0,m.jsx)(a().p,{colorPalette:"gray",style:v.secondaryActionButton,onClick:e=>f.onClick(e),"aria-label":f.ariaLabel,iconLeading:f.icon?{icon:f.icon,size:"sm"}:void 0,children:f.text}):null]})]})}},476277:(e,t,n)=>{n.d(t,{A:()=>l});var r=n(296540),o=()=>n(590526),i=()=>n(115512),a=()=>n(287234),s=n(474848);const l=function(e){const t=(0,n(401497).IS)((()=>({footer:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",fontSize:i().vQ,padding:"6px 8px"},footerWrapper:{flexShrink:0},footerText:{color:n(100622).Tj.text.tertiary,fontSize:i().Kw,...n(284371).RC}})),[]),l=(0,o().O$)(a().Qb),d=(0,o().K8)((()=>(0,n(211134).PF)({env:"production",isAdminMode:n(726637).A.isAdminMode,experimentService:n(242422).default})),[]),{searchResultStore:c}=(0,r.useContext)(n(870976).SearchStaticContext),u=(0,o().K8)((()=>{var e;return null===(e=c.state.localResults)||void 0===e?void 0:e.results}),[c]),{serverResults:p,debugInfo:m,exposedSearchExperiments:h}=(0,o().K8)((()=>{var e;const t=c.state.serverResults;return{serverResults:null==t?void 0:t.results,debugInfo:null==t?void 0:t.debugInfo,exposedSearchExperiments:null==t||null===(e=t.serverEventProperties)||void 0===e?void 0:e["server-searchExperiments"]}}),[c]);return(0,s.jsx)("footer",{style:t.footerWrapper,children:(0,s.jsxs)(n(736847).A,{topBorder:!0,style:t.footer,disableDesktopPadding:!0,children:[(0,s.jsx)(n(424400).Ay,{...e,style:t.footerText}),(0,s.jsxs)("div",{style:{display:"flex",gap:4},children:[e.shouldShowReportBadSearchButton?(0,s.jsx)(n(254704).c,{productSurface:n(245241).xi.searchModal,localResults:u,serverResults:p,debugInfo:m,exposedSearchExperiments:h}):void 0,d&&!l?(0,s.jsx)(n(631524).p,{onClick:()=>a().Ay.setState({...a().Ay.state,isDebugSidebarOpen:!0}),size:"sm",colorPalette:"gray",iconLeading:n(212727).gearIcon}):void 0]})]})})}},506166:(e,t,n)=>{n.d(t,{E:()=>i});n(296540);var r=n(474848);const o={viewBox:"0 0 20 20",fittedViewBox:"2.37 2.37 15.25 15.26",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{d:"M8.35 12.274a.625.625 0 0 0 0 1.25h3.3a.625.625 0 1 0 0-1.25zM13 9.844a.625.625 0 1 1 0 1.25H7a.625.625 0 0 1 0-1.25zm-7-2.43a.625.625 0 1 0 0 1.25h8a.625.625 0 1 0 0-1.25z"}),(0,r.jsx)("path",{d:"M10 2.375a7.625 7.625 0 1 0 0 15.25 7.625 7.625 0 0 0 0-15.25M3.625 10a6.375 6.375 0 1 1 12.75 0 6.375 6.375 0 0 1-12.75 0"})]})},i=(0,n(340498).wt)("filterCircle",o,"default")},513402:(e,t,n)=>{n.r(t),n.d(t,{arrowUpDownSmallIcon:()=>o,iconDefinition:()=>r});n(296540);const r={viewBox:"0 0 16 16",fittedViewBox:"1.67 2.48 12.66 11.03",directional:!0,svg:(0,n(474848).jsx)("path",{d:"M11.349 2.672a.625.625 0 0 0-.884 0L7.666 5.471a.625.625 0 1 0 .884.883l1.732-1.73v8.262a.625.625 0 1 0 1.25 0V4.623l1.73 1.731a.625.625 0 0 0 .885-.883zM5.093 2.49a.625.625 0 0 0-.625.624v8.263l-1.73-1.731a.625.625 0 1 0-.885.883l2.798 2.799c.244.244.64.244.884 0l2.798-2.798a.625.625 0 0 0-.883-.884l-1.732 1.73V3.115a.625.625 0 0 0-.625-.625"})},o=(0,n(340498).wt)("arrowUpDownSmall",r,"small")},534619:(e,t,n)=>{n.r(t),n.d(t,{ENGLISH_PERSONAL_PRONOUNS:()=>Ue,TEST_ONLY__getVisibleSpaceUserIds:()=>He,checkIsTrashEmpty:()=>Ce,executeSearchResultNavigation:()=>tt,filterAndRankUsers:()=>Fe,getLocalCacheFromAppState:()=>Se,getSpaceBotIds:()=>Pe,isPersonalPronoun:()=>Ve,searchActorsById:()=>Qe,searchBots:()=>Re,searchCollections:()=>je,searchCollectionsWithRecents:()=>Ae,searchEmailUser:()=>Ge,searchInstallableIntegrations:()=>Ee,searchLocalNavigableBlocks:()=>Be,searchMentionablePages:()=>Ye,searchPageIds:()=>Ie,searchPageIdsInAncestor:()=>Me,searchPagesInCollection:()=>ke,searchPagesInSpace:()=>we,searchPublicPages:()=>Xe,searchSpaceActorIds:()=>$e,searchSpaceActors:()=>We,searchSpaceBots:()=>Ne,searchSpaceGroups:()=>_e,searchSpaceUsers:()=>Le,searchTeams:()=>Je,searchUsers:()=>De,searchUsersByNameWithNoSpaces:()=>qe,searchVisibleSpaceUsers:()=>Ke});n(16280),n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(354520),n(672577),n(430670),n(581454);var r=n.n(n(844751)),o=()=>n(564884),i=()=>n(907258),a=()=>n(755531),s=()=>n(242422),l=()=>n(381175),d=()=>n(929219),c=()=>n(711339),u=()=>n(295633),p=()=>n(457205),m=()=>n(732810),h=()=>n(849255),g=()=>n(834051),f=()=>n(330361),y=()=>n(74351),v=()=>n(114775),b=()=>n(688610),x=()=>n(983610),S=()=>n(710515),w=()=>n(799288),I=()=>n(313491),k=()=>n(921940),T=()=>n(842599),M=()=>n(617871),C=()=>n(165358),j=()=>n(792071),A=()=>n(142748),B=()=>n(936802),_=()=>n(68263),N=()=>n(388821),P=()=>n(179034),R=()=>n(824862),E=()=>n(519831),O=()=>n(96689),F=()=>n(848538),D=()=>n(798880),q=()=>n(620333),L=()=>n(245241),K=()=>n(468006),z=()=>n(201980),V=()=>n(695608),U=()=>n(778078),H=()=>n(496603),W=()=>n(763824),$=()=>n(973647),G=()=>n(534177),Q=()=>n(769864),Y=()=>n(908928),Z=()=>n(165241),X=()=>n(257667),J=()=>n(518362),ee=()=>n(236341),te=()=>n(288782),ne=()=>n(47373),re=()=>n(499764),oe=()=>n(825972),ie=()=>n(41161);var ae=()=>n(698449),se=()=>n(696746),le=()=>n(671199),de=()=>n(384565),ce=()=>n(237321),ue=()=>n(977870),pe=()=>n(968172),me=()=>n(169626),he=()=>n(558407),ge=()=>n(271084),fe=()=>n(224701),ye=()=>n(134217);function ve({environment:e,localSearchAnalytics:t,eventProperties:n}){t&&(0,o().u)({environment:e,event:{eventName:"relation_property_menu_local_search_bug",eventProperties:{search_session_id:t.searchSessionId,...n}}})}var be=()=>n(884211),xe=()=>n(885117);async function Se({environment:e,localSearchAnalytics:t}){const{sidebarSpaceStore:n,sidebarSpaceViewStore:r,currentUserSettingsStore:o,currentUserStore:a}=i().default.state;if(!n)return;if(s().default.checkGate({gateName:"search_use_local_search_cache",enableEventTrailLogging:!0})){if(ve({environment:e,localSearchAnalytics:t,eventProperties:{search_step:"use_local_search_cache_before"}}),le().A.state.localSearchableBlocksCache)return ve({environment:e,localSearchAnalytics:t,eventProperties:{search_step:"use_local_search_cache_already_loaded"}}),le().A.state.localSearchableBlocksCache;ve({environment:e,localSearchAnalytics:t,eventProperties:{search_step:"use_local_search_cache_before_loading"}});try{await Promise.race([le().A.waitUntil((()=>Boolean(le().A.state.localSearchableBlocksCache))),new Promise(((e,t)=>setTimeout((()=>t(new Error("Cache load timeout"))),2e3)))])}catch(l){return void ve({environment:e,localSearchAnalytics:t,eventProperties:{search_step:"use_local_search_cache_timed_out"}})}return ve({environment:e,localSearchAnalytics:t,eventProperties:{search_step:"use_local_search_cache_after_loading"}}),le().A.state.localSearchableBlocksCache}return ve({environment:e,localSearchAnalytics:t,eventProperties:{search_step:"get_searchable_blocks_before"}}),await(0,xe().h)({environment:e,sidebarSpaceStore:n,sidebarSpaceViewStore:r,localSearchAnalytics:t,currentUserSettingsStore:o,currentUserStore:a})}async function we(e){const{environment:t,query:n,limit:r,currentPageId:o,searchSessionId:i,searchSessionFlowNumber:a,recentlyMentionedPageIds:s,spaceId:l,requireEditPermissions:d,excludeTemplates:c,source:u,boostRecentlyViewedPages:p,ignoresHighlight:m,filterOverrides:h,spaceStore:g,peopleBlocksToInclude:f}=e,y={results:[],recordMap:N().RecordMapWithRole.create().toJson(),total:0,trackEventProperties:void 0};if(!g)return y;const v=await Se({environment:t}),b=L().N2({isDeletedOnly:!1,navigableBlockContentOnly:!0,excludeTemplates:c,requireEditPermissions:d||void 0,...h}),x=await t.idCreator.getSpaceIdCreator(l),{filters:S,excludedBlockIds:w}=(0,q().CT)({peopleBlocksToInclude:f,spaceIdCreator:x,filters:b,excludedBlockIds:void 0}),I={field:"relevance"};if(!n&&v){const e=(0,be().searchAndRerankLocalPages)({query:{query:{text:n,filters:S,sort:I},limit:r},localCachedPages:v,userId:t.currentUser.id,environment:t,spaceStore:g});return e||y}const k=await Q().callApi({eventName:"search",environment:t,data:{type:L().Vz.BlocksInSpace,query:n,spaceId:l,currentPageId:o,searchSessionId:i,searchSessionFlowNumber:a,recentlyMentionedPageIds:s,limit:r,filters:S,sort:I,source:u,recentPagesForBoosting:p?(0,oe().cs)(pe().A.getWithoutSubscribing(l)):void 0,ignoresHighlight:m,excludedBlockIds:w}});if("failed"===k.type)throw k.error;return k.data}async function Ie(e){const t=await we(e);return{results:t.results.map((e=>e.id)),recordMap:t.recordMap}}async function ke(e){const{environment:t,query:n,collectionId:r,limit:o,spaceId:i,excludeTemplates:a,source:s,includePublicPagesWithoutExplicitAccess:l,boostRecentlyViewedPages:d,ignoresHighlight:c,localSearchAnalytics:u}=e,p=new Array;if(u){const e=JSON.stringify(localStorage).length/1024;ve({environment:t,localSearchAnalytics:u,eventProperties:{search_step:"load_records_before",local_storage_size_kb:Math.trunc(e)}})}const h=await Se({environment:t,localSearchAnalytics:u});ve({environment:t,localSearchAnalytics:u,eventProperties:{search_step:"load_records_after"}});const g=L().N2({isDeletedOnly:!1,navigableBlockContentOnly:!0,includePublicPagesWithoutExplicitAccess:l,excludeTemplates:a}),f={field:"relevance"},y=Q().callApi({eventName:"search",environment:t,data:{type:L().Vz.BlocksInCollection,query:n,spaceId:i,collectionId:r,limit:o,filters:g,sort:f,source:s,recentPagesForBoosting:d?(0,oe().cs)(pe().A.getWithoutSubscribing(i)):void 0,ignoresHighlight:c}});if(h){const e={table:E().Vl,id:r,spaceId:i},a=new(m().m)(t,e);await a.load();const s=(0,be().searchAndRerankLocalPages)({query:{query:{text:n,filters:a.isPageTreeCollection()?{...g,ancestors:[r]}:{...g,parentId:r},sort:f},limit:o},localCachedPages:h,userId:t.currentUser.id,environment:t,spaceStore:a.getSpaceStore()});s&&p.push(...s.results)}const v=await y;if("failed"===v.type){if(0===p.length)throw v.error}else{let e=v.data.results;n||(e=function({sort:e,unsorted:t,batchSize:n,currentUserId:r}){const o=Date.now();if("relevance"!==e.field)return t;const i=H().iv(t,n).map((e=>ie().A.sortFrecencyHighToLow({items:e,now:o,currentUserId:r,recordFrecency:!0})));return H().Bq(i)}({sort:f,batchSize:o,currentUserId:t.currentUser.id,unsorted:e})),p.push(...e)}return{results:H().oE(H().sb(p.map((e=>e.id))))}}async function Te(e){const{environment:t,query:n,ancestorId:r,limit:o,excludeTemplates:i,source:a,currentPageId:s,searchSessionId:l,searchSessionFlowNumber:d,recentlyMentionedPageIds:c,ignoresHighlight:u,includePublicPagesWithoutExplicitAccess:p,spaceId:m,peopleBlocksToInclude:h}=e,g=L().N2({navigableBlockContentOnly:!0,excludeTemplates:i,includePublicPagesWithoutExplicitAccess:p});let f,y=g;if(m){const e=await t.idCreator.getSpaceIdCreator(m),n=(0,q().CT)({peopleBlocksToInclude:h,spaceIdCreator:e,filters:g,excludedBlockIds:void 0});y=n.filters,f=n.excludedBlockIds}const v=await Q().callApi({eventName:"search",environment:t,data:{type:L().Vz.BlocksInAncestor,query:n,ancestorId:r,filters:y,sort:{field:"relevance"},limit:o,source:a,spaceId:m,currentPageId:s,searchSessionId:l,searchSessionFlowNumber:d,recentlyMentionedPageIds:c,ignoresHighlight:u,excludedBlockIds:f}});if("failed"===v.type)throw v.error;return v.data}async function Me(e){return{results:(await Te(e)).results.map((e=>e.id))}}async function Ce(e){const{sidebarSpaceStore:t,currentUserStore:n}=i().default.state;if(!t||!n)return!1;const r=await async function(e){const{environment:t,query:n,limit:r,spaceId:o}=e,i=0===n.trim().length?{field:"lastEdited",direction:"desc"}:{field:"relevance"},a=L().N2({isDeletedOnly:!0,navigableBlockContentOnly:!0,excludeTemplates:!1,editedBy:e.editedByIds||[],ancestors:e.ancestorIds||[],inTeams:e.teamspaceIds||[]}),s=await t.idCreator.getSpaceIdCreator(o),{filters:l,excludedBlockIds:d}=(0,q().CT)({peopleBlocksToInclude:"none",spaceIdCreator:s,filters:a,excludedBlockIds:void 0}),c=Q().callApi({eventName:"search",environment:t,data:{type:L().Vz.BlocksInSpace,query:n,filters:l,sort:i,limit:r,spaceId:o,source:"trash",excludedBlockIds:d}}),u=await c;if("failed"===u.type)throw u.error;{const{results:e,recordMap:t,total:n}=u.data;return{results:e.map((e=>e.id)),recordMap:N().RecordMapWithRole.create(t),endOfResultsReached:n===e.length}}}({environment:e,query:"",limit:1,spaceId:t.id,ancestorIds:[],editedByIds:[],teamspaceIds:[]});return 0===r.results.length}async function je(e,t){const{query:n,limit:r,source:o,requireEditPermissions:i,databaseType:a,spaceStore:s,searchSessionId:l,peopleBlocksToInclude:d}=t;if(!s)return{results:[],total:0};const c=s.id,u=L().N2({excludeTemplates:!0,requireEditPermissions:i,databaseType:a}),p=await e.idCreator.getSpaceIdCreator(c),{filters:m,excludedBlockIds:h}=(0,q().CT)({peopleBlocksToInclude:d,spaceIdCreator:p,filters:u,excludedBlockIds:void 0}),[g,f]=await Promise.all([et(e,{...t,spaceId:c,requireEditPermissions:i,databaseType:a,parentStore:s,excludedBlockIds:h}),Q().callApi({eventName:"search",environment:e,data:{type:L().Vz.CollectionsInSpace,query:n,spaceId:c,limit:r,filters:m,sort:{field:"relevance"},source:o,recentPagesForBoosting:(0,oe().cs)(pe().A.get(c)),searchSessionId:l,excludedBlockIds:h}})]),y=H().KC("success"===f.type?H().oE(f.data.results.map((e=>e.collectionId))):[],g).slice(0,r);return{results:y,total:"success"===f.type?f.data.total:y.length}}async function Ae(e){const{environment:t,collectionViewBlockStore:n,spaceStore:r,parentStore:o,query:i,limit:a,requireEditPermissions:s,databaseType:l,searchSessionId:d,peopleBlocksToInclude:c}=e;let u=[],p=0;if(!i){const e=t.currentUser.id;if(r){const n=t.idCreator.getSpaceIdCreatorSync(r.id),i=(0,B().FS)({spaceIdCreator:n}),a=(0,J().F)({currentUserId:e,spaceId:r.id});let s;switch(c){case"none":case"person_profiles":s=a.filter((e=>e!==i));break;case"all":case"collection_view_page":s=a;break;default:(0,G().HB)(c)}u=s.map((e=>m().m.createChildStore(o,{table:E().Vl,id:e})))}u=[...H().oE(null==n?void 0:n.getCollectionViewStores().map((e=>e.getCollectionStore()))),...u],l&&(u=u.filter((e=>{const t=e.getDatabaseType();return!!t&&l.includes(t)}))),u=H().hS(u,(e=>e.id)).filter((e=>!s||e.canEdit()))}const h=await je(t,{query:i,limit:a,source:"collection_settings_source",requireEditPermissions:s,databaseType:l,spaceStore:r,searchSessionId:d,peopleBlocksToInclude:c});return u=[...u,...h.results.map((e=>m().m.createChildStore(o,{table:E().Vl,id:e})))],p=h.total,u=u.filter((e=>!(0,b().z)(e)&&e.canRead())),await Promise.all(u.map((async e=>{await e.load()}))),{results:H().hS(u,(e=>e.id)).slice(0,a).map((e=>e.id)),total:p}}async function Be(e){const{environment:t,searchQuery:n,blockTypes:r,sidebarSpaceStore:o,sidebarSpaceViewStore:i,currentUserSettingsStore:a,currentUserStore:s,limit:l,parentId:c}=e,u=await(0,xe().h)({environment:t,sidebarSpaceStore:o,sidebarSpaceViewStore:i,currentUserSettingsStore:a,currentUserStore:s}),p={query:{text:n,filters:(0,L().N2)({requireEditPermissions:!1,isDeletedOnly:!1,excludeTemplates:!0,navigableBlockContentOnly:!0,blockTypes:r,parentId:c}),sort:{field:"relevance"}},limit:l},m=(0,be().getLocalFrecencyRankedSearchResultsWithStore)({query:p,localCachedPages:u,parentStore:o,spaceStore:o,isOnline:d().A.state.online,environment:t,shouldLimitLocalResultsWhenOnline:!1,applyScoreThresholdWhenOnline:!0,canUseLtr:!1});return m&&$().Q.isSuccess(m)?m.value.results.filter((e=>e.store.pathIsAccessibleAndAlive())):[]}function _e(e){const{query:t,intl:n,limit:r}=e,o=me().h.getAllGroups();if(0===o.length)return[];return(t?(0,U().Ay)(t,o,(e=>(0,ae().Pf)({intl:n,groupName:e.name})),{normalizeFuzzyScore:!0}):o).slice(0,r)}async function Ne(e){const{query:t,limit:n}=e,{sidebarSpaceStore:r}=i().default.state;if(!r)return[];return Re({parentStore:r,query:t,botIds:await Pe(e)}).slice(0,n)}async function Pe(e){const{environment:t}=e,{sidebarSpaceStore:n}=i().default.state;if(!n)return[];const r=n.id,[o,a]=await Promise.all([Y().Ju({environment:t,table:O().NX,id:r,type:"guest"}),Y().Ju({environment:t,table:O().NX,id:r,type:"workflow"})]);return H().sb([...o.botIds,...a.botIds])}function Re(e){const{parentStore:t,query:n,botIds:r}=e,o=H().oE(r.map((e=>{const n=p().v.createChildStore(t,{table:R().GP,id:e});if(n.getAlive())return n.getValue()})));return n?(0,U().Ay)(n,o,w().tb):o}async function Ee(e){const{query:t,environment:n,spaceId:r,botSettings:o}=e;if(!r)return[];const i=await Q().callApi({eventName:"searchIntegrations",environment:n,data:{query:t}});if("success"===i.type){const e=i.data.integrationIds,t=o&&o.integration_approval_statuses?Object.keys(o.integration_approval_statuses):[],n=Boolean(null==o?void 0:o.integration_restrictions),r=Boolean("approved_or_built_by_notion"===(null==o?void 0:o.integration_restrictions));return n?e.filter((e=>r?t.includes(e)||(0,M().CX)({integrationId:e}):t.includes(e))):e}if("failed"===i.type)throw i.error;(0,G().HB)(i)}const Oe=new Set(["gmail.com","yahoo.com","hotmail.com","outlook.com","icloud.com","aol.com"]);function Fe({query:e,users:t,minFuzzyScore:n,currentUserValue:r,spaceDomains:o}){return e?(0,U().Ay)(e,t,V().T2,{minScore:n,getSortScore:e=>{const{original:t,score:n}=e,i=t.email&&(0,T().zN)(t.email),a=r&&(0,T().zN)(r.email),s=i&&o.has(i),l=a===i,d=a&&Oe.has(a);return n*(s||l&&!d?-2:-1)}}):t}async function De({environment:e,parentStore:t,query:n,userIds:r,minFuzzyScore:a,placeSelfFirst:l}){var d;const u=c().default.mark("user_search_latency"),p=s().default.checkGate({gateName:"search_batch_load_users"}),m=W().lX(r,p?300:Math.max(r.length,1),(async e=>{const n=h().L.createChildStore(t,{table:D().oo,id:e});return await n.load(),n.getValue()}));(await(0,W().nQ)(1e4,[m])).timeout&&(C().log({level:"error",from:"searchActions.searchUsers",type:"UserStoreLoadTimeoutV1",error:{message:"The UserStore.load()'s took longer than 10 seconds"},data:{searchedUserIdCount:r.length,queryLength:n.length,parentStoreLoaded:t.isReady(),documentVisibilityState:document.visibilityState}}),(0,o().u)({environment:e,event:{eventName:"user_search_timeout",eventProperties:{searchedUserIdCount:r.length,queryLength:n.length,parentStoreLoaded:t.isReady(),documentVisibilityState:document.visibilityState}}}));const g=H().oE(await m);let f;const y=null===(d=i().default.state.currentUserStore)||void 0===d?void 0:d.userId;if(l&&y){const e=g.findIndex((e=>y===e.id));e>-1&&(f=g[e],g.splice(e,1))}const v=ge().k.state??{},b=Math.max(...Object.values(v));function x(e){var t;return e===(null===(t=i().default.state.currentUserRootStore)||void 0===t?void 0:t.userId)?b+1e-5:v[e]??0}const S=H().Im(v)?g:g.sort(((e,t)=>{const n=x(e.id);return x(t.id)-n})),w=new Set(t.getEmailDomains()),I=n?Fe({query:n,users:S,minFuzzyScore:a,currentUserValue:f,spaceDomains:w}):g;return c().default.measure(u,{environment:e}),f?[f,...I]:I}async function qe(e){const{environment:t,query:n,membersOnly:r}=e,o=(0,a().S)();if(!o)return[];if(Z().i({userId:t.currentUser.id,spaceId:o.id,debugFrom:"searchUsersByNameWithNoSpaces"})){const e=s().default.getConfigKey("email_alias_migration","mode"),i=await Q().callApi({eventName:"listUsers",environment:t,data:{cursor:void 0,membershipFilter:r?"members":void 0,limit:1,uniqueNameWithoutSpaces:n,spaceId:o.id,includeAliasSearch:(0,I().K)(e)}});if("success"!==i.type||0===i.data.users.length)return[];const a=h().L.createChildStore(o,{table:D().oo,id:i.data.users[0].id});await a.load();const l=a.getModel();return l?[l]:[]}return(await Ke({environment:t,query:n,membersOnly:r})).map((e=>j().Bj6.fromValue(D().oo,e)))}async function Le(e){const t=(0,a().S)(),n=Z().i({userId:e.environment.currentUser.id,spaceId:null==t?void 0:t.id,debugFrom:"searchSpaceUsers"});var r;t&&!ue().c.state.wasGetVisibleUsersCalled[t.id]&&C().log({level:"error",from:"searchSpaceUsers",type:"getVisibleUsersNotCalled",spaceId:t.id,data:{userId:null===(r=i().default.state.currentUserStore)||void 0===r?void 0:r.id,routeName:e.environment.RouterStore.state.route.name}});return n?async function(e){const{environment:t,membersOnly:n,minFuzzyScore:r=U().XR-1,placeSelfFirst:o,limit:a}=e,{sidebarSpaceStore:l,mainEditorCurrentBlockStore:d,currentUserStore:c}=i().default.state;if(!l)return[];const u=e.query.startsWith("@")?e.query.slice(1):e.query,p=ge().k.getSortedUserIds().slice(0,100),m=d&&!n?(0,re().i0)(d).flatMap((({permissionItem:e})=>(0,_().B2)(e)?[e.user_id]:[])):[],g=await De({environment:e.environment,parentStore:l,query:u,userIds:H().sb([...H().oE([null==c?void 0:c.userId]),...p,...m]),minFuzzyScore:r,placeSelfFirst:o});if(a&&g.length>=a)return g.slice(0,a);const f=s().default.getConfigKey("email_alias_migration","mode"),y=await Q().callApi({eventName:"listUsers",environment:t,data:{cursor:void 0,membershipFilter:n?"members":void 0,limit:a?a-g.length:100,query:u,spaceId:l.id,includeAliasSearch:(0,I().K)(f)}});if("success"!==y.type||0===y.data.users.length)return g;const v=y.data.users.sort(((e,t)=>{var n,r;const o=(null===(n=ge().k.state)||void 0===n?void 0:n[e.id])??0;return((null===(r=ge().k.state)||void 0===r?void 0:r[t.id])??0)-o})),b=await(0,W().lX)(v,v.length,(async e=>{const t=h().L.createChildStore(l,{table:D().oo,id:e.id});return await t.load(),t.getValue()})),x=H().hS([...g,...H().oE(b)],(e=>e.id)),S=new Set(l.getEmailDomains());return Fe({query:u,users:x,minFuzzyScore:r,currentUserValue:null==c?void 0:c.getValue(),spaceDomains:S})}(e):Ke(e)}async function Ke(e){const{sidebarSpaceStore:t}=i().default.state;if(!t)return[];const n=e.query.startsWith("@")?e.query.slice(1):e.query,r=await ze(e);return(await De({environment:e.environment,parentStore:t,query:n,userIds:r,minFuzzyScore:e.minFuzzyScore,placeSelfFirst:e.placeSelfFirst})).slice(0,e.limit)}async function ze(e){const{environment:t,membersOnly:n}=e,{sidebarSpaceStore:r}=i().default.state;if(!r)return[];await fe().iV({environment:t,spaceId:r.id});const o=x().subscriptionDataStoreInstance.state;if(!o)return[];const a=(0,ye().Be)(o).filter((e=>!(n&&!(0,F().MN)(e.membershipType)))),{mainEditorCurrentBlockStore:s,currentUserStore:l}=i().default.state,d=s&&!n?(0,re().i0)(s).flatMap((({permissionItem:e})=>(0,_().B2)(e)?[e.user_id]:[])):[],c=(0,ne().Qd)()&&s?function(e,t){const n=(0,y().U)(e);if(n){const e=new Set((0,K().gm)({membership:n.getRawMembership()}));return t.filter((t=>"none"!==t.membershipType||t.isPageGuest||t.isTeamGuest&&e.has(t.userId)))}return t.filter((e=>"none"!==e.membershipType||e.isPageGuest))}(s,a):a,u=c.map((e=>e.userId));return H().sb([...H().oE([null==l?void 0:l.userId]),...d,...u])}function Ve(e,t){return!(!t.startsWith("en-")||!Ue.has(e.toLowerCase()))}const Ue=new Set(["me","you","i"]),He=ze;async function We(e){const{query:t}=e,[n,r]=await Promise.all([Le({...e,placeSelfFirst:""===t||Ve(t,e.userLocale)}),Ne(e)]);return{users:n,bots:r}}async function $e(e){const[t,n]=await Promise.all([ze(e),Pe(e)]);return{userIds:t,botIds:n}}async function Ge(e,t){const n=(0,T().qh)(t);if((0,T().DT)(n)&&n){const t=await Q().callApi({eventName:"findUser",environment:e,data:{email:n}});if("failed"===t.type)throw t.error;const r=t.data;return r.value?{user:r.value.value}:{email:n}}return{}}async function Qe(e){const{query:t,userIds:n,botIds:r,store:o,environment:a}=e;let s=o;if(!s){const{sidebarSpaceStore:e}=i().default.state;if(!e)return{users:[],bots:[]};s=e}return{users:await De({environment:a,parentStore:s,query:t,userIds:n}),bots:Re({parentStore:s,query:t,botIds:r})}}async function Ye(e){const{nearBlock:t,environment:n,query:r,source:o,searchSessionId:a,searchSessionFlowNumber:s}=e,{sidebarSpaceStore:l}=i().default.state,d=(0,te().s)(),c="collection_view_page",u=t&&(0,re().i0)(t).find((({permissionItem:e})=>(0,_().FP)(e))),p=he().A.getMentionedIds(n.currentUser.id);if(l){return Ze(await we({environment:n,query:r,limit:20,spaceId:l.id,currentPageId:d,searchSessionId:a,searchSessionFlowNumber:s,recentlyMentionedPageIds:p,requireEditPermissions:!1,excludeTemplates:!0,source:o,boostRecentlyViewedPages:!0,ignoresHighlight:!0,spaceStore:l,peopleBlocksToInclude:c}))}if(u&&u.from.table===P().ev){return Ze(await Te({environment:n,query:r,limit:20,ancestorId:u.from.blockId,excludeTemplates:!0,source:o,currentPageId:d,searchSessionId:a,searchSessionFlowNumber:s,recentlyMentionedPageIds:p,ignoresHighlight:!0,peopleBlocksToInclude:c}))}return[]}function Ze(e){const{trackEventProperties:t,results:n}=e,r=(0,G().MU)((0,G().WP)(t).map((([e,t])=>[`server-${e}`,t])));return n.map((e=>({...e,serverEventProperties:r})))}async function Xe(e){const{environment:t,query:n,source:r,limit:o}=e,{sidebarSpaceStore:a}=i().default.state;if(!a)return[];return(await we({environment:t,query:n,limit:o||20,spaceId:a.id,requireEditPermissions:!0,excludeTemplates:!0,source:r,boostRecentlyViewedPages:!1,spaceStore:a,peopleBlocksToInclude:"none"})).results.filter((e=>{const t=u().B.createChildStore(a,{table:P().ev,id:e.id}),n=(0,g().E)(t);return(0,A().ot)(n)}))}async function Je({spaceViewStore:e,query:t,teamStores:n}){const r=H().oE(await Promise.all(n.map((async e=>(await e.load(),e.getValue()))))),o=(0,S().r)(e),i=new Set(o.map((e=>e.id)));return t?(0,U().Ay)(t,r,(e=>e.name),{getSortScore:e=>{const{original:t,score:n}=e;return n*(i.has(t.id)?-2:-1)}}):r}function et(e,t){const{query:n,limit:o,spaceId:i,requireEditPermissions:a,databaseType:s,excludedBlockIds:l}=t,d=[];if(o>0){const c=new AbortController;e.defaultRecordCache.inMemoryRecordCache.forEachRecord(e.currentUser.id,(({model:e,role:u})=>{if(e.table===E().Vl){const p=e.space_id===i,h=!a||(0,_().p2)(u);if(!p||!h||(0,se().Nh)(e.getParentId()))return;const g=e.getDatabaseType();if(!(!s||g&&s.includes(g)))return;const y=(0,z().q4_)(e.getName());if(!r().test(n,y))return;const b=m().m.createChildStore(t.parentStore,e.pointer),x=(0,f().g)(b);if(!(0,v().y)(x))return;const S=e.getParentPointer();if(l.includes(S.id))return;d.push(e.pointer.id),d.length>=o&&c.abort()}}),c.signal)}return d}function tt(e){const{result:t,context:n,queryId:r,trackSelectSearchItem:o,closeSearch:i,isCommandSearch:a,environment:s,electronTabs:d,isNewElectronTab:c,event:u,source:p}=e,m=t.store,h=(0,l().V)(u);if(o({result:t,isMetaClick:Boolean(h),context:n}),"query_results"===n&&de().default.update((e=>({...e,selectedQueryResult:!0}))),ce().A.setState({queryId:r,pageId:t.store.id,timeEntered:new Date}),h||i({shouldResetQuery:!1}),a){const e=(0,k().A)({pageModel:m.getModel(),pageId:m.id,pageVisitSource:p,queryId:r});(0,ee().N)(e)}else{const e=X().$f({result:t});if(!e)return;X().q9({searchResult:e,environment:s,pageVisitSource:p,queryId:r,openInNew:h,electronTabSearch:{tabs:d,isNewTab:Boolean(c)},context:n})}}},542101:(e,t,n)=>{n.d(t,{r:()=>o});n(296540);const r={viewBox:"0 0 20 20",fittedViewBox:"2.06 1.19 15.88 15.65",svg:(0,n(474848).jsx)("path",{d:"M12.207 1.322a1.91 1.91 0 0 0-2.33.838l-.348.715c-.177.292-.36.658-.535 1.005l-.13.257c-.225.442-.431.822-.627 1.08L6.073 7.521h-2.41a1.6 1.6 0 0 0-1.6 1.6v5.139a1.6 1.6 0 0 0 1.6 1.6H6.97l1.227.42.021.01c.73.366 1.528.554 2.347.554h4.309a1.844 1.844 0 0 0 1.78-2.32c.554-.318.922-.918.922-1.6 0-.284-.067-.547-.18-.78.333-.327.54-.782.54-1.297a1.8 1.8 0 0 0-.388-1.124c.17-.27.271-.592.271-.943a1.844 1.844 0 0 0-1.843-1.844h-3.783c.069-.167.15-.33.242-.516a6 6 0 0 0 .416-1.004l.001-.002.507-1.774a1.913 1.913 0 0 0-1.144-2.315zM10.64 3.449l.345-.71a.66.66 0 0 1 .781-.248c.32.128.488.471.393.804l-.507 1.773v.001c-.08.276-.195.512-.336.797l-.014.028c-.134.27-.292.59-.408.97a1.03 1.03 0 0 0 .988 1.323h4.095c.327 0 .593.267.593.594a.56.56 0 0 1-.27.47.625.625 0 0 0 .066 1.086.56.56 0 0 1 .322.511.58.58 0 0 1-.4.55.625.625 0 0 0-.191 1.074c.149.122.23.285.23.453a.586.586 0 0 1-.584.594.625.625 0 0 0-.452 1.057.594.594 0 0 1-.416 1.02h-4.31c-.593 0-1.17-.13-1.703-.381a.6.6 0 0 0-.161-.083l-1.424-.488a.6.6 0 0 0-.202-.033h-.181V8.475L9.169 6.05l.037-.043c.286-.367.547-.86.772-1.303l.147-.29a13 13 0 0 1 .515-.965M5.794 8.772v5.839H3.663a.35.35 0 0 1-.35-.35V9.122a.35.35 0 0 1 .35-.35z"})},o=(0,n(340498).wt)("handThumbsUp",r,"default")},551171:(e,t,n)=>{n.d(t,{C:()=>o});n(296540);const r={viewBox:"0 0 20 20",fittedViewBox:"2.37 4.12 15.25 11.75",svg:(0,n(474848).jsx)("path",{d:"M9.375 4.125H4.5A2.125 2.125 0 0 0 2.375 6.25v.965h7zm-7 7.41v-3.07h7v3.07zm0 1.25v.965c0 1.174.951 2.125 2.125 2.125h4.875v-3.09zm8.25 0v3.09H15.5a2.125 2.125 0 0 0 2.125-2.125v-.965zm7-1.25v-3.07h-7v3.07zm0-5.285v.965h-7v-3.09H15.5c1.174 0 2.125.951 2.125 2.125"})},o=(0,n(340498).wt)("viewTableFill",r,"fill")},560729:(e,t,n)=>{n.d(t,{A:()=>l});n(296540);var r=()=>n(726637),o=()=>n(127833),i=()=>n(30537),a=()=>n(107975),s=n(474848);function l(e){return r().A.isMobile?(0,s.jsx)(o().zD,{ariaLabel:e.ariaLabel,open:e.isOpen,popupType:i().n.SlideUp,origin:e.origin,onDismiss:e.onDismiss,render:e.render,style:e.style}):(0,s.jsx)(a().a,{ariaLabel:e.ariaLabel,open:e.isOpen,preventHideChildrenWhileOpening:!0,render:e.render,onDismiss:e.onDismiss,style:e.style,innerStyle:e.innerStyle,showCloseIcon:e.showCloseIcon})}},562042:(e,t,n)=>{n.d(t,{f:()=>o});n(296540);const r={viewBox:"0 0 16 16",fittedViewBox:"1.95 1.94 12.1 11.57",svg:(0,n(474848).jsx)("path",{d:"M8 1.95c-.27 0-.51.174-.594.431l-1.14 3.51H2.574a.625.625 0 0 0-.367 1.13l2.985 2.17-1.14 3.509a.625.625 0 0 0 .962.699L8 11.229l2.986 2.17a.625.625 0 0 0 .961-.699l-1.14-3.51 2.985-2.169a.625.625 0 0 0-.367-1.13h-3.69l-1.14-3.51A.625.625 0 0 0 8 1.95m-.686 4.759L8 4.597l.686 2.112a.625.625 0 0 0 .595.432h2.22L9.705 8.446a.625.625 0 0 0-.227.699l.686 2.112-1.797-1.305a.625.625 0 0 0-.734 0l-1.797 1.305.686-2.112a.625.625 0 0 0-.227-.699L4.5 7.141h2.22a.63.63 0 0 0 .595-.432"})},o=(0,n(340498).wt)("starSmall",r,"small")},568008:(e,t,n)=>{n.d(t,{EF:()=>s,OY:()=>l});n(581454);var r=()=>n(907258),o=()=>n(498212),i=()=>n(680977),a=()=>n(547149);function s(e){var t;const n=(null===(t=e.getSettings())||void 0===t?void 0:t.custom_topics)||{};return Object.entries(n).map((([e,t])=>({id:e,...t})))}function l(e){var t;const{environment:n,name:s,creator:l,description:d,icon:c}=e,u=r().default.state.currentUserSettingsStore;if(!u)return;const p=Date.now(),m=(0,o().lZ)(),h=(null===(t=u.getSettings())||void 0===t?void 0:t.custom_topics)||{};a().createAndCommit({userAction:"userTopicsActions.createTopic",environment:n,canUndo:!0,cellTarget:"main",perform:e=>{(0,i().m)({userSettingsStore:u,data:{custom_topics:{...h,[m]:{name:s,createdAt:p,updatedAt:p,creator:l,...d?{description:d}:{},...c?{icon:c}:{}}}},transaction:e})}})}},576907:(e,t,n)=>{n.d(t,{bF:()=>S});n(16280),n(18107),n(410838),n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(967357);var r=n(296540),o=()=>n(484714),i=()=>n(590526),a=()=>n(401497),s=()=>n(807449),l=()=>n(493552),d=()=>n(529099),c=()=>n(134025),u=()=>n(201980),p=()=>n(69708),m=()=>n(534177),h=()=>n(36951),g=()=>n(555102),f=()=>n(547149),y=n(474848);let v;function b(e){const{query:t,searchFilters:a,searchResultsStore:s,searchSessionId:l}=e,d=(0,o().v3)(),c=r.useMemo((()=>n(166442).defaultClientAIChatStore),[]),p=(0,i().O$)(g().bX),[f,y]=(0,r.useState)(void 0),[b,S]=(0,r.useState)({type:"loading"}),w=(0,r.useCallback)((e=>{if(!e||0===e.length)return;if(!p)throw new Error("No current space");S({type:"recomputing"});const t=(0,g().Kf)({environment:d,spaceStore:p.spaceStore,userStore:p.userStore,value:e});(0,n(140992).Wq)({clientStore:c,environment:d});const r=(0,g().Xd)({environment:d,inferenceContext:p,config:{type:"search",scopeForNextSearch:{type:"everything"},searchSessionId:l,filtersForNextSearch:{ancestorsFilter:null==a?void 0:a.ancestors,createdByFilter:null==a?void 0:a.createdBy,teamspacesFilter:(0,n(245241).fg)(null==a?void 0:a.inTeams),titleOnlyFilter:null==a?void 0:a.navigableBlockContentOnly}},addSteps:[t],surface:"auto_stream"}),o=(0,n(687879).addTranscriptToNewThreadAndRun)({environment:d,spaceStore:p.spaceStore,transcript:r,createdSource:"auto_stream"});return v&&(c.getOrCreateClientAIChatThreadStore(v).resetState(),v=o.id),y(o),o}),[d,c,l,p,a]);(0,r.useEffect)((()=>{w((0,u().x9d)(t))}),[w,t]);const I=(0,r.useRef)(new Set),k=(0,r.useCallback)((({results:e,disambiguationKey:t})=>{s&&!I.current.has(t)&&(s.update((t=>({...t,universalResults:e}))),I.current.add(t))}),[s]);(0,i().K8)((()=>{if(!f)return;const e=f.getTranscript(),t=e.at(-1);if("search"!==(null==t?void 0:t.type)||"resultsComplete"!==t.status&&"resultsBlended"!==t.status)if("search-chat"===(null==t?void 0:t.type)){const n=e.findLast((e=>"search"===e.type&&("resultsComplete"===e.status||"resultsBlended"===e.status)));let r=0;for(const[,e]of(0,m().WP)((null==n?void 0:n.results)??{}))r+=(null==e?void 0:e.length)??0;S({type:"completed",searchChatResult:t.value,resultCount:r,traceId:t.traceId})}else{var n;const e=null===(n=c.getOrCreateClientAIChatThreadStore(f.id).state)||void 0===n?void 0:n.temporarySteps;if(!e)return;const t=e.findLast((e=>"search-chat"===e.type)),r=e.findLast((e=>"search"===e.type&&"resultsPartial"===e.status));r&&k({results:r.results,disambiguationKey:`partial-${r.id}`}),t&&S({type:"streaming",currentStreamResult:t.value,traceId:t.traceId})}else k({results:t.results,disambiguationKey:t.id})}),[c,f,k]);const T=(0,r.useCallback)((e=>{f&&p&&((0,h().VK)({environment:d,oldThreadStore:void 0,newThreadStore:f,createdSource:"auto_stream",openInNewTab:e.openInNewTab}),x({threadStore:f,environment:d,spaceId:p.spaceStore.id}))}),[d,f,p]),M=(0,r.useCallback)((e=>{if(!p)return;const t=w(e.query);t&&((0,h().VK)({environment:d,oldThreadStore:void 0,newThreadStore:t,createdSource:"auto_stream",openInNewTab:e.openInNewTab}),x({threadStore:t,environment:d,spaceId:p.spaceStore.id}))}),[d,w,p]);return{latestThreadState:b,navigateToThreadStore:T,navigateToFreshThreadWithQuery:M,analyticsData:(0,r.useMemo)((()=>({thread_id:null==f?void 0:f.id,search_session_id:l})),[l,null==f?void 0:f.id])}}function x(e){const{threadStore:t,environment:n,spaceId:r}=e;f().createAndCommit({userAction:"SearchAutoStreamResultsBox.setThreadToUnifiedFindCreationSource",environment:n,canUndo:!1,perform:e=>{f().applyOperation({store:t,operation:c().op.update({pointer:t.pointer,path:[],args:{space_id:r,created_source:"full_page_chat"}}),transaction:e})}})}const S=(0,r.forwardRef)((function(e,t){const{query:o,searchFilters:c,searchResultsStore:h,menuListItemProps:g,searchSessionId:f}=e,v=(0,a().IS)((()=>({autoStreamResultsBox:{paddingTop:8,paddingInlineEnd:4,paddingInlineStart:2,width:"100%"},loadingWrapper:{display:"flex",alignItems:"center",gap:6,borderRadius:6,paddingBottom:8},askAiText:{fontWeight:500,fontSize:14},resultHeader:{display:"flex",alignItems:"center",gap:6},answerContainer:{boxShadow:n(100622).Tj.shadowXS,borderRadius:6,alignItems:"flex-start",minHeight:36,marginTop:2,marginBottom:2}})),[]),x=(0,i().K8)((()=>n(242422).default.getConfigKey("ai_auto_stream_config","debounceTimeMs")??1500),[]),S=(0,n(591779).lW)(o,x,((e,t)=>function(e,t){return e===t||!(!e||!t)&&e.trim()===t.trim()}(e,t))),{latestThreadState:T,navigateToThreadStore:M,navigateToFreshThreadWithQuery:C,analyticsData:j}=b({query:S,searchFilters:c,searchResultsStore:h,searchSessionId:f}),A=(0,r.useRef)(null),B=(0,r.useCallback)((e=>{const{openInNewTab:t}=e;S!==o?C({query:(0,u().x9d)(o),openInNewTab:t}):M({openInNewTab:t})}),[C,M,o,S]);(0,r.useImperativeHandle)(t,(()=>({navigateToThread:B})),[B]);const _=(0,r.useMemo)((()=>{const e=(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(n(758304).N,{styleKey:"captionMedium",animate:!0,colorVariant:"secondary",text:(0,y.jsx)(p().sA,{id:"SearchAutoStreamResultsBox.updatingStep",defaultMessage:"Thinking"})}),(0,y.jsx)(n(135221).A,{isTriColored:!0})]});switch(T.type){case"loading":return(0,y.jsxs)("div",{style:v.loadingWrapper,children:[(0,y.jsx)(s().I,{icon:d().aiFaceIcon,colorVariant:"primary"}),(0,y.jsx)("div",{style:v.askAiText,children:(0,y.jsx)(p().sA,{id:"SearchAutoStreamResultsBox.AskAI.loading",defaultMessage:"Ask AI â€”"})}),e]});case"recomputing":return(0,y.jsxs)("div",{children:[(0,y.jsxs)("div",{style:v.resultHeader,children:[(0,y.jsx)(s().I,{icon:d().aiFaceIcon,colorVariant:"primary"}),(0,y.jsx)("div",{style:v.askAiText,children:(0,y.jsx)(p().sA,{id:"SearchAutoStreamResultsBox.AskAI.streaming",defaultMessage:"Ask AI"})}),e]}),(0,y.jsx)(I,{alreadyStreamedAnswerContainerRef:A})]});case"streaming":return(0,y.jsxs)("div",{ref:A,children:[(0,y.jsxs)("div",{style:v.resultHeader,children:[(0,y.jsx)(s().I,{icon:d().aiFaceIcon,colorVariant:"primary"}),(0,y.jsx)("div",{style:v.askAiText,children:(0,y.jsx)(p().sA,{id:"SearchAutoStreamResultsBox.AskAI.streaming",defaultMessage:"Ask AI"})}),e]}),(0,y.jsx)(k,{streamingText:T.currentStreamResult,isFocused:g.focused,analyticsData:j,traceId:T.traceId})]},"answer");case"completed":return(0,y.jsxs)("div",{ref:A,children:[(0,y.jsxs)("div",{style:v.resultHeader,children:[(0,y.jsx)(s().I,{icon:d().aiFaceIcon,colorVariant:"primary"}),(0,y.jsx)("div",{style:v.askAiText,children:(0,y.jsx)(p().sA,{id:"SearchAutoStreamResultsBox.AskAI.query",defaultMessage:"Ask AI"})}),(0,y.jsx)(n(834474).O,{marginLeftOverride:4}),(0,y.jsx)(l().D,{styleKey:"captionRegular",colorVariant:"tertiary",children:(0,y.jsx)(p().sA,{defaultMessage:"â€” {resultCount, plural, one {{resultCount} result} other {{resultCount} results}}",id:"SearchAutoStreamResultsBox.AskAI.resultCount",values:{resultCount:T.resultCount}})})]}),(0,y.jsx)(k,{streamingText:T.searchChatResult,isFocused:g.focused,analyticsData:j,traceId:T.traceId})]},"answer");default:(0,m().HB)(T)}}),[j,T,g.focused,v]);return(0,y.jsx)(n(81068).A,{style:"recomputing"===T.type||"streaming"===T.type||"completed"===T.type?v.answerContainer:void 0,textWrapperStyle:v.autoStreamResultsBox,...g,title:_,right:(0,y.jsx)(w,{focused:g.focused})})}));function w(e){const{focused:t}=e,r=(0,a().IS)((()=>({right:{display:"flex",opacity:t?1:0,marginTop:8},rightContentWrapper:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"},rightIcon:{marginInlineEnd:6,marginTop:2}})),[t]);return(0,y.jsx)("div",{style:r.right,children:(0,y.jsxs)("div",{style:r.rightContentWrapper,children:[(0,y.jsx)("div",{style:{marginInlineEnd:4},children:(0,y.jsx)(l().D,{styleKey:"captionRegular",colorVariant:"tertiary",children:(0,y.jsx)(p().sA,{defaultMessage:"Open",id:"SearchAutoStreamResultsBox.AskAI.open"})})}),(0,y.jsx)(s().I,{icon:n(968610).arrowTurnDownLeftFillSmallIcon,size:"xs",colorVariant:"tertiary",style:r.rightIcon})]})})}function I(e){const{alreadyStreamedAnswerContainerRef:t}=e,o=(0,r.useMemo)((()=>{if(null==t||!t.current)return;const e=t.current.getBoundingClientRect().height-20,n=Math.max(1,Math.ceil(e/30)),r=[];return n>8?(r.push({lineHeight:20,lineMargin:5,sectionWidths:[100],repeat:5,sectionMargin:10}),r.push({lineHeight:20,lineMargin:5,sectionWidths:[85],repeat:Math.min(5,n-5),sectionMargin:10}),n>10&&r.push({lineHeight:20,lineMargin:5,sectionWidths:[70],repeat:n-10,sectionMargin:10})):r.push({lineHeight:20,lineMargin:5,sectionWidths:[100],repeat:n,sectionMargin:10}),r}),[t]);return null!==t.current&&o?(0,y.jsx)(n(298697).A,{paragraphs:o}):null}function k(e){const{streamingText:t}=e,i=r.useRef(null),s=r.useRef(null),[l,d]=(0,r.useState)(!1);(0,r.useEffect)((()=>{if(!l&&s.current&&i.current){s.current.scrollHeight>92&&d(!0)}}),[t,l]);const c=(0,o().v3)();(0,r.useEffect)((()=>{e.analyticsData.thread_id&&(0,n(564884).u)({environment:c,event:{eventName:"answer_stream_first_char_rendered",eventProperties:{...e.analyticsData,trace_id:e.traceId}}})}),[e.analyticsData,e.traceId,c]);const u=(0,a().IS)((()=>({containerStyle:{overflow:"hidden",position:"relative",marginTop:4,marginBottom:6,maxHeight:92,...l?{maskImage:"linear-gradient(black calc(100% - 36px), transparent calc(100% - -6px))",WebkitMaskImage:"linear-gradient(black calc(100% - 36px), transparent calc(100% - -6px))"}:{}},textStyle:{fontSize:14,lineHeight:"20px",fontWeight:n(284371).Wy.medium}})),[l,92]),p=(0,r.useMemo)((()=>({type:"assistantChatText",text:t,inferenceId:"unused"})),[t]);return(0,y.jsx)("div",{style:{position:"relative"},children:(0,y.jsx)("div",{ref:i,style:u.containerStyle,children:(0,y.jsx)("div",{ref:s,style:u.textStyle,children:(0,y.jsx)(n(274981).c,{clientStep:p,disablePointerEvents:!0})})})})}},586984:(e,t,n)=>{n.d(t,{C:()=>j,VY:()=>B,WR:()=>b,Y2:()=>k,ZE:()=>M,dF:()=>f,dl:()=>x,oZ:()=>h,pf:()=>T,tl:()=>A,wT:()=>y,wq:()=>C});n(898992),n(354520),n(581454),n(737550);var r=()=>n(973647),o=()=>n(534177),i=()=>n(251582),a=()=>n(181856),s=()=>n(832443),l=()=>n(252050),d=()=>n(162278),c=()=>n(228803),u=()=>n(233364),p=()=>n(331119);function m(e){return i().p.mapResult((0,p().U5)("insert-inside"),(t=>{const n=(0,p().ke)({inputAttributes:t.attributes,definitions:{id:{required:!0,values:!0,mappingMode:"block_counter"}},tagName:"insert-inside",mapCounterToKey:e.mapCounterToKey});if(r().Q.isFail(n))return n;const o=(0,u().x)(e),s=(0,i().$d)(i().p.sequence([i().p.choice([o["property-relation"],o["property-person"],o["property-multi-select"]]),i().p.eof((()=>new(a().yd)))]),t.children??[]);if(r().Q.isFail(s))return s;return{value:{type:"effect",tagName:"insert-inside",insertType:"property",attributes:n.value,children:[s.value[0]]}}}))}function h(e){return i().p.choice([i().p.try(m(e)),i().p.andThen(i().p.lookAhead(i().p.map((0,p().U5)("insert-inside"),(t=>{const{mapCounterToKey:n}=e;if(!(0,o().O9)(n)||!(0,o().O9)(t.attributes.id))return!1;const i=(0,r().j)((()=>n(t.attributes.id)));return!r().Q.isFail(i)&&"collection"===i.value.type}))),(t=>t?function(e){return i().p.mapResult((0,p().U5)("insert-inside"),(t=>{const n=(0,p().ke)({inputAttributes:t.attributes,definitions:{id:{required:!0,values:!0,mappingMode:"collection_counter"}},tagName:"insert-inside",mapCounterToKey:e.mapCounterToKey});if(r().Q.isFail(n))return n;const o=(0,i().$d)((0,p().nx)("insert-inside",[(0,d().vj)({allocateIdFn:e.allocateIdFn,allowMove:!0,allowUncited:!1,persisted:!1,mapCounterToKey:e.mapCounterToKey})]),t.children??[]);return r().Q.isFail(o)?o:{value:{type:"effect",tagName:"insert-inside",insertType:"blockIntoDatabase",attributes:n.value,children:o.value}}}))}(e):function(e){return i().p.mapResult((0,p().U5)("insert-inside"),(t=>{const n=(0,p().ke)({inputAttributes:t.attributes,definitions:{id:{required:!0,values:!0,mappingMode:"block_counter"}},tagName:"insert-inside",mapCounterToKey:e.mapCounterToKey});if(r().Q.isFail(n))return n;const o=(0,i().$d)((0,p().nx)("insert-inside",[(0,d().vj)({allocateIdFn:e.allocateIdFn,allowMove:!0,allowUncited:!1,persisted:!1,mapCounterToKey:e.mapCounterToKey})]),t.children??[]);return r().Q.isFail(o)?o:{value:{type:"effect",tagName:"insert-inside",insertType:"block",attributes:n.value,children:o.value}}}))}(e)))])}function g(e){return t=>{const a=i().p.mapResult((0,p().U5)(e),(n=>{const o=(0,p().ke)({inputAttributes:n.attributes,definitions:{id:{required:!0,values:!0,mappingMode:"block_counter"}},tagName:e,mapCounterToKey:t.mapCounterToKey});if(r().Q.isFail(o))return o;const a=(0,i().$d)((0,p().nx)(e,[(0,d().vj)({allocateIdFn:t.allocateIdFn,allowMove:!0,allowUncited:!1,persisted:!1,mapCounterToKey:t.mapCounterToKey})]),n.children??[]);if(r().Q.isFail(a))return a;return{value:{type:"effect",tagName:e,insertType:"block",attributes:o.value,children:a.value}}})),s=i().p.mapResult((0,p().U5)(e),(o=>{const a=(0,p().ke)({inputAttributes:o.attributes,definitions:{id:{required:!0,values:!0,mappingMode:"block_counter"},name:{required:!0,values:!0}},tagName:e,mapCounterToKey:t.mapCounterToKey});if(r().Q.isFail(a))return a;const s=(0,n(491810).D)({mapCounterToKey:t.mapCounterToKey}),l=(0,i().$d)((0,p().nx)(e,[(0,n(525704).M)(t),s["schema-property-text"]]),o.children??[]);if(r().Q.isFail(l))return l;return{value:{type:"effect",tagName:e,insertType:"table",attributes:a.value,children:l.value}}}));return i().p.andThen(i().p.lookAhead(i().p.map(i().p.any(),(t=>{var n;return"element"===t.type&&t.tagName===e&&(0,o().O9)(null===(n=t.attributes)||void 0===n?void 0:n.name)}))),(e=>e?s:a))}}const f=g("insert-before"),y=g("insert-after"),v=i().p.mapResult((0,p().U5)("action-button"),(e=>{const t=(0,p().ke)({inputAttributes:e.attributes,definitions:{name:{required:!0,values:!0},icon:{required:!1,values:!0},action:{required:!1,values:!0}},tagName:"action-button",mapCounterToKey:void 0});return r().Q.isFail(t)?t:{value:{name:t.value.name,icon:t.value.icon,action:t.value.action}}})),b=i().p.mapResult((0,p().U5)("chat-md"),(e=>{const t=e.attributes?Object.keys(e.attributes):[];if(t.length>0)return{error:new(a().LN)({tagName:"chat-md",attributeNames:t})};const n=(0,i().$d)((0,p().nx)("chat-md",[p().W6]),e.children??[]);if(r().Q.isFail(n))return n;const o={type:"effect",tagName:"chat-md",text:n.value.map((e=>e.value)).join("")};return{value:o}}));function x(e){return i().p.mapResult((0,p().U5)("chat"),(t=>{const n=t.attributes?Object.keys(t.attributes):[];if(n.length>0)return{error:new(a().LN)({tagName:"chat",attributeNames:n})};const o=(0,i().$d)((0,p().nx)("chat",[(0,d().st)(),(0,d().V8)({allocateIdFn:e.allocateIdFn,allowMove:!1,allowUncited:!0,persisted:!1,mapCounterToKey:e.mapCounterToKey}),i().p.map(v,(e=>({type:"action-button",value:e})))]),t.children??[]);if(r().Q.isFail(o))return o;const s=o.value.some((e=>"uncited"===e.type)),l=o.value.filter((e=>"uncited"!==e.type)),c=l.filter((e=>"block"===e.type)),u=l.filter((e=>"action-button"===e.type)),m=c.some((e=>e.hasUncited));return{value:{type:"effect",tagName:"chat",children:c,actionButtons:u.map((e=>e.value)),uncited:s||m}}}))}function S(e){return i().p.mapResult((0,p().U5)("delete"),(t=>{const n=(0,p().ke)({inputAttributes:t.attributes,definitions:{id:{required:!0,values:!0,mappingMode:"block_counter"}},tagName:"delete",mapCounterToKey:e.mapCounterToKey});if(r().Q.isFail(n))return n;const o=(0,p().x3)(t);if(r().Q.isFail(o))return o;return{value:{type:"effect",tagName:"delete",deleteType:"block",attributes:n.value}}}))}function w(e){return i().p.mapResult((0,p().U5)("delete"),(t=>{const n=(0,p().ke)({inputAttributes:t.attributes,definitions:{id:{required:!0,values:!0,mappingMode:"block_counter"}},tagName:"delete",mapCounterToKey:e.mapCounterToKey});if(r().Q.isFail(n))return n;const o=(0,u().x)(e),s=(0,i().$d)(i().p.sequence([i().p.choice([o["property-relation"],o["property-person"],o["property-multi-select"]]),i().p.eof((()=>new(a().nD)))]),t.children??[]);if(r().Q.isFail(s))return s;return{value:{type:"effect",tagName:"delete",deleteType:"property",attributes:n.value,children:[s.value[0]]}}}))}function I(e){return i().p.map((0,p().RB)({tagName:"delete",attributeDefinitions:{id:{required:!0,values:!0,mappingMode:"block_counter"},name:{required:!0,values:!0}},mapCounterToKey:e.mapCounterToKey}),(({attributes:e})=>({type:"effect",tagName:"delete",deleteType:"table-column",attributes:e})))}function k(e){return i().p.choice([i().p.try(S(e)),i().p.try(w(e)),I(e)])}function T(e){return i().p.mapResult((0,p().U5)("set-title"),(t=>{const n=(0,p().ke)({inputAttributes:t.attributes,definitions:{id:{required:!0,values:!0,mappingMode:"block_counter"}},tagName:"set-title",mapCounterToKey:e.mapCounterToKey});if(r().Q.isFail(n))return n;const o=(0,i().$d)((0,p().nx)("set-title",[(0,c().Et)({inlineNodesAllowed:l().qI,textAllowed:!0,parentTagName:"set-title",mapCounterToKey:e.mapCounterToKey})]),t.children??[]);if(r().Q.isFail(o))return o;return{value:{type:"effect",tagName:"set-title",attributes:n.value,children:o.value}}}))}function M(e){return i().p.mapResult((0,p().U5)("set-attribute"),(t=>{const{id:n,...o}=t.attributes??{};if(!n)return{error:new(a().HQ)({tagName:"set-attribute",attributeName:"id"})};if(!(0,s().D4)(n))return{error:new(a().qW)("id",n)};const i=e.mapCounterToKey?s().tD.mapCounterToKeyInMode({mapCounterToKey:e.mapCounterToKey},n,"block_counter","set-attribute"):{value:n};if(r().Q.isFail(i))return i;const l=i.value;if(0===Object.keys(o).length)return{error:new(a().Uc)};const d=(0,p().x3)(t);if(r().Q.isFail(d))return d;const c=Object.entries(o).map((([e,t])=>({key:e,value:t})));return{value:{type:"effect",tagName:"set-attribute",id:l,attributes:c}}}))}function C(e){return i().p.map((0,p().RB)({tagName:"set-tag-name",attributeDefinitions:{id:{required:!0,values:!0,mappingMode:"block_counter"},"tag-name":{required:!0,values:(0,o().uv)(l().sA)}},mapCounterToKey:e.mapCounterToKey}),(({attributes:e})=>({type:"effect",tagName:"set-tag-name",attributes:{id:e.id,newTagName:e["tag-name"]}})))}function j(e){return i().p.mapResult((0,p().U5)("set-property"),(t=>{const n=(0,p().ke)({inputAttributes:t.attributes,definitions:{id:{required:!0,values:!0,mappingMode:"block_counter"}},tagName:"set-property",mapCounterToKey:e.mapCounterToKey});if(r().Q.isFail(n))return n;const o=t.children.filter((e=>"element"===e.type)),a=(0,i().$d)(i().p.map(i().p.sequence([(0,u().Q)(e),i().p.manyTill((0,u().Q)(e),i().p.eof())]),(([e,t])=>[e,...t])),o);if(r().Q.isFail(a))return a;return{value:{type:"effect",tagName:"set-property",attributes:n.value,children:a.value}}}))}function A(e){return i().p.mapResult((0,p().U5)("persist-blocks"),(t=>{const n=t.attributes?Object.keys(t.attributes):[];if(n.length>0)return{error:new(a().LN)({tagName:"persist-blocks",attributeNames:n})};const o=(0,i().$d)((0,p().nx)("persist-blocks",[(0,d().V8)({allocateIdFn:e.allocateIdFn,allowMove:!1,allowUncited:!1,persisted:!1,mapCounterToKey:e.mapCounterToKey})]),t.children??[]);if(r().Q.isFail(o))return o;return{value:{type:"effect",tagName:"persist-blocks",children:o.value}}}))}function B(e){return i().p.mapResult((0,p().U5)("create"),(t=>{const n=t.attributes?Object.keys(t.attributes):[];if(n.length>0)return{error:new(a().LN)({tagName:"create",attributeNames:n})};const o=(0,i().$d)((0,p().nx)("create",[(0,d().V8)({allocateIdFn:e.allocateIdFn,allowMove:!1,allowUncited:!1,persisted:!1,mapCounterToKey:e.mapCounterToKey})]),t.children??[]);if(r().Q.isFail(o))return o;return{value:{type:"effect",tagName:"create",children:o.value}}}))}},602667:(e,t,n)=>{function r(e){return Boolean(e.target&&e.target instanceof HTMLElement&&e.target.classList.contains("rdp-day"))}n.d(t,{a:()=>r})},610884:(e,t,n)=>{n.d(t,{m:()=>R});var r=n(296540),o=()=>n(782482),i=()=>n(726637),a=()=>n(590526),s=()=>n(401497),l=()=>n(718827),d=()=>n(127833),c=()=>n(30537),u=()=>n(807449),p=()=>n(546926),m=()=>n(81068),h=()=>n(736847),g=()=>n(324254),f=()=>n(381553),y=()=>n(69708),v=()=>n(100622),b=()=>n(56394),x=()=>n(933117),S=()=>n(707160),w=()=>n(602667),I=()=>n(220818),k=()=>n(322976),T=()=>n(474962),M=()=>n(976361),C=()=>n(604995),j=()=>n(416504),A=()=>n(534177),B=n(474848);const _={today:(0,B.jsx)(y().sA,{defaultMessage:"Today",id:"searchDateFilter.quickActions.today.label"}),pastWeek:(0,B.jsx)(y().sA,{defaultMessage:"Last 7 days",id:"searchDateFilter.quickActions.last7Days.label"}),pastMonth:(0,B.jsx)(y().sA,{defaultMessage:"Last 30 days",id:"searchDateFilter.quickActions.last30Days.label"})};function N({date:e,onClick:t,onDismiss:n}){const r=(0,j().P)(),o=C().Ec(r),i=o;let a;const s=_[e];"today"===e?a=o:"pastWeek"===e?a=C().t0(r):"pastMonth"===e?a=C().ZG(r):(0,A().HB)(e);return(0,B.jsx)(m().A,{focused:!1,title:s,onClick:e=>{t({value:{starting:{type:"date",start_date:a.start_date},ending:{type:"date",start_date:i.start_date}}}),n(e)}})}var P=()=>n(385226);function R(e){const{initialValue:t,dateFilterType:n,onMenuDismiss:o,title:a,icon:s,disabled:l,onMenuOpen:d,dateFormat:c,mode:u,onChange:p}=e,{current:m}=(0,r.useRef)(e.store??new(T().A)({initialDateRange:t,shouldAlsoUpdateSearchStore:!1}));return(0,r.useEffect)((()=>{m.state.dateFilterType===n||m.update((e=>({...e,dateFilterType:n})))}),[n,m]),i().A.isMobile?(0,B.jsx)($,{onMenuDismiss:o,title:a,disabled:l,onMenuOpen:d,dateFormat:c,icon:s,store:m,mode:u,onChange:p}):(0,B.jsx)(W,{onMenuDismiss:o,title:a,disabled:l,onMenuOpen:d,icon:s,store:m,onChange:p})}function E(e){const{dateFilterType:t,nextState:n,store:r,onChange:o}=e;if(r.update((e=>({...e,temporaryDateRange:{...r.state.temporaryDateRange,...n},dateFilterType:t}))),o){const e=void 0!==n.starting&&void 0!==n.ending,r=void 0===n.starting&&void 0===n.ending;(e||r)&&o(t,{starting:n.starting,ending:n.ending})}}function O(e){return{lastEditedTime:(0,B.jsx)(y().sA,{id:"search.filterMenu.moreFilters.lastEdited",defaultMessage:"Last edited"}),createdTime:(0,B.jsx)(y().sA,{id:"search.filterMenu.moreFilters.created",defaultMessage:"Created"})}[e]}function F(e){e.preventDefault&&e.preventDefault()}function D(e,t,n){t||(n&&n(),e.setState({...e.state,isOpen:!0,focus:"starting"}))}function q(e,t,n,r){const{temporaryDateRange:o,dateFilterType:i}=t.state;(0,w().a)(e)||(E({dateFilterType:i,nextState:o,store:t,onChange:r}),t.setState({...t.state,isOpen:!1}),n&&n())}function L(e,t){const{dateFilterType:n}=e.state;E({dateFilterType:n,nextState:{starting:void 0,ending:void 0},store:e,onChange:t}),e.clearTemporaryDateRange()}function K({store:e,onChange:t}){const n=(0,a().K8)((()=>e.state.dateFilterType),[e]),r=(0,a().K8)((()=>e.state.temporaryDateRange??{starting:void 0,ending:void 0}),[e]),o={width:190,items:["createdTime","lastEditedTime"],selectedItem:n,getKey:e=>e,onSelect:n=>function(e,t,n,r){const{dateFilterType:o}=n.state;E({dateFilterType:e,nextState:t,store:n,onChange:r}),e!==o&&(E({dateFilterType:o,nextState:{starting:void 0,ending:void 0},store:n,onChange:r}),n.setState({...n.state,dateFilterType:e}))}(n,r,e,t),renderItem:e=>(0,B.jsx)(m().A,{title:O(e.value),...e}),renderOrigin:e=>(0,B.jsx)(l().Ay,{...e,style:{paddingInlineStart:4,paddingInlineEnd:4,borderRadius:4,flexShrink:0},children:(0,B.jsxs)("div",{style:{display:"flex",alignItems:"center",...!i().A.isMobile&&{color:v().Tj.text.secondary,fill:v().Tj.icon.tertiary,fontWeight:500,fontSize:12,lineHeight:"16px"}},children:[(0,B.jsx)("span",{style:{marginInlineEnd:4},children:O(n)}),(0,B.jsx)(u().I,{icon:g().arrowChevronSingleDownSmallIcon,size:"xs",colorVariant:"tertiary"})]})})};return(0,B.jsx)(x().A,{...o,menuTypeOverride:(0,p().PK)()})}function z({disabled:e,onMenuOpen:t,icon:n,title:o,store:i}){const a=(0,r.useCallback)((()=>D(i,e,t)),[i,e,t]),l=(0,s().IS)((()=>({icon:{height:14,width:14,fill:"currentColor"}})),[]);return(0,B.jsx)(m().A,{disabled:e,focused:!1,icon:n(l.icon),title:o,onClick:a})}function V({disabled:e,onMenuOpen:t,title:n,store:o,dateFormat:i,onChange:l}){const d=(0,y().tz)(),c=(0,r.useCallback)((()=>L(o,l)),[o,l]),p=(0,r.useCallback)((()=>D(o,e,t)),[o,e,t]),m=(0,a().K8)((()=>o.state.temporaryDateRange??{starting:void 0,ending:void 0}),[o]),h=(0,s().IS)((()=>({summary:{display:"inline-flex",gap:6}})),[]),g=(0,B.jsxs)("div",{style:h.summary,children:[(0,B.jsx)(u().I,{icon:f().Y,size:"sm"}),(0,I().t)(m,d,i)]});return(0,B.jsx)(M().A,{disabled:e,onClick:p,onClickClear:c,label:n,title:g})}function U({disabled:e,onMenuOpen:t,icon:n,title:o,store:i}){const s=(0,r.useCallback)((()=>D(i,e,t)),[i,e,t]),l=(0,a().K8)((()=>i.state.temporaryDateRange.starting),[i]);return(0,B.jsx)(b().A,{on:Boolean(l),icon:(0,B.jsx)(u().I,{icon:n,fitToViewBox:"horizontal"}),title:(0,B.jsx)("span",{children:o}),onClick:s})}function H({onMenuDismiss:e,title:t,store:n,onChange:o}){const i=(0,a().K8)((()=>n.state.dateFilterType),[n]),d=(0,a().K8)((()=>n.state.temporaryDateRange),[n]),c=(0,r.useCallback)((t=>q(t,n,e,o)),[n,e,o]),u=(0,r.useCallback)((e=>{if(e.error)return;n.setState({...n.state,temporaryDateRange:{...d,...e.value}});const{starting:t,ending:r}=n.state.temporaryDateRange;t&&r&&E({dateFilterType:i,nextState:{starting:t,ending:r},store:n,onChange:o})}),[i,d,n,o]),p=(0,r.useCallback)((()=>L(n,o)),[n,o]),m=(0,s().IS)((()=>({dateFilterHeader:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",paddingTop:4,paddingInlineEnd:4,paddingBottom:2,paddingInlineStart:4},clearButton:{color:v().Tj.text.secondary,fill:v().Tj.icon.tertiary,fontWeight:500,fontSize:12,lineHeight:"16px",paddingInlineStart:4,paddingInlineEnd:4,borderRadius:4,flexShrink:0},showBottomDivider:{boxShadow:`0 1px 0 ${v().Tj.border.secondaryTranslucent}`}})),[]);return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(h().A,{children:(0,B.jsxs)("div",{style:m.dateFilterHeader,children:[(0,B.jsx)(K,{store:n,onChange:o}),(0,B.jsx)(l().Ay,{style:m.clearButton,onClick:p,children:(0,B.jsx)(y().sA,{defaultMessage:"Clear",id:"searchDateFilter.clearButton.label"})})]})}),(0,B.jsxs)(h().A,{style:m.showBottomDivider,children:[(0,B.jsx)(N,{date:"today",onClick:u,onDismiss:c}),(0,B.jsx)(N,{date:"pastWeek",onClick:u,onDismiss:c}),(0,B.jsx)(N,{date:"pastMonth",onClick:u,onDismiss:c})]}),(0,B.jsx)(S().A,{title:t,value:d,onUpdate:u,store:n,onDismiss:c,hideDateInputMenuItems:!0})]})}function W({onMenuDismiss:e,title:t,disabled:n,onMenuOpen:i,icon:l,store:u,onChange:p}){const m=(0,a().K8)((()=>u.state.isOpen),[u]),h=(0,r.useCallback)((t=>q(t,u,e,p)),[u,e,p]),g=(0,s().IS)((()=>({sectionMenuItem:{display:"flex"}})),[]);return(0,B.jsx)(P().A,{style:g.sectionMenuItem,children:(0,B.jsx)(o().N,{debugName:"SearchGenericDateFilter",capture:m,onUp:F,onDown:F,onEnter:F,children:(0,B.jsx)(d().zD,{popupType:c().n.Popup,open:m,origin:(0,B.jsx)(U,{disabled:n,onMenuOpen:i,icon:l,title:t,store:u}),render:()=>(0,B.jsx)(H,{onMenuDismiss:e,title:t,store:u,onChange:p}),onDismiss:h,placementToOrigin:"bottom",alignmentToOrigin:"start",keepFocus:!0})})})}function $({mode:e,onMenuDismiss:t,title:n,disabled:o,onMenuOpen:i,dateFormat:s,icon:l,store:u,onChange:p}){const m=(0,r.useCallback)((e=>q(e,u,t,p)),[u,t,p]),h=(0,r.useCallback)((()=>(0,B.jsx)(H,{onMenuDismiss:t,title:n,store:u,onChange:p})),[t,n,u,p]),g=(0,a().K8)((()=>u.state.isOpen),[u]),f=e===k().C.Section?(0,B.jsx)(V,{disabled:o,onMenuOpen:i,title:n,store:u,dateFormat:s,onChange:p}):(0,B.jsx)(z,{disabled:o,onMenuOpen:i,icon:l,title:n,store:u});return(0,B.jsx)(d().zD,{popupType:c().n.SlideUp,open:g,origin:f,render:h,onDismiss:m,preventScaleTransition:!0})}},619403:(e,t,n)=>{n.r(t),n.d(t,{iconDefinition:()=>o,pageFillIcon:()=>i});n(296540);var r=n(474848);const o={viewBox:"0 0 20 20",fittedViewBox:"4.12 2.37 11.75 15.25",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{d:"M9.95 2.375h-3.7A2.125 2.125 0 0 0 4.125 4.5v11c0 1.174.951 2.125 2.125 2.125h7.5a2.125 2.125 0 0 0 2.125-2.125V8.3H12a2.05 2.05 0 0 1-2.05-2.05zM13.3 14.25a.55.55 0 0 1-.55.55h-5.5a.55.55 0 1 1 0-1.1h5.5a.55.55 0 0 1 .55.55m-.55-1.95h-5.5a.55.55 0 1 1 0-1.1h5.5a.55.55 0 0 1 0 1.1"}),(0,r.jsx)("path",{d:"M15.665 7.2a2.1 2.1 0 0 0-.412-.581L11.63 2.997c-.17-.17-.367-.31-.581-.412V6.25c0 .525.425.95.95.95z"})]})},i=(0,n(340498).wt)("pageFill",o,"fill")},629604:(e,t,n)=>{n.d(t,{H:()=>i});var r=()=>n(79926);const o=new(r().O2)("AdminReactJson",(async()=>Promise.all([n.e(29151),n.e(64038),n.e(83755)]).then(n.bind(n,839517)))),i=(0,r()._h)(o,(e=>e.AdminReactJson))},633220:(e,t,n)=>{n.d(t,{S:()=>ue});var r=n(296540),o=()=>n(664594),i=()=>n(755531),a=()=>n(726637),s=()=>n(590526),l=()=>n(401497),d=()=>n(611648),c=()=>n(435644),u=()=>n(42583),p=()=>n(763884),m=()=>n(69708),h=()=>n(100622),g=()=>n(496603),f=()=>n(376254),y=()=>n(656975),v=()=>n(957606),b=()=>n(439050),x=()=>n(742382),S=()=>n(971736),w=()=>n(51700),I=()=>n(795783),k=()=>n(322976),T=()=>n(271205),M=()=>n(905487),C=(n(581454),()=>n(675133)),j=()=>n(295633),A=()=>n(723085),B=()=>n(849255),_=()=>n(416504),N=()=>n(681873),P=()=>n(179034),R=()=>n(854150),E=()=>n(798880),O=()=>n(245241),F=()=>n(695608),D=()=>n(534177),q=()=>n(284371),L=()=>n(557504),K=()=>n(220818),z=n(474848);function V(e){const{filterUIName:t,filters:n,parentStore:r}=e,o=(0,l().IS)((()=>({title:{maxWidth:220,...q().RC}})),[]),i=(0,s().K8)((()=>{switch(t){case"personFilter":return function(e,t){const n=e.createdBy,r=C().A.getIntl(),o=g().oE(n.map((e=>{const n=B().L.createChildStore(t,{table:E().oo,id:e});return(0,F().c6)(r,n.getModel())})));return(0,N().G)(o,W)}(n,r);case"teamsFilter":case"dev_notInTeamFilter":return function(e,t){const n=(0,O().fg)(e.inTeams);if(!n)return[];const r=g().oE(n.map((e=>A().h.createChildStore(t,{table:R().yK,id:e}).getName())));return(0,N().G)(r,W)}(n,r);case"pageFilter":case"dev_notInPageFilter":return $(n,r);case"dateFilter":return function(e){const t=C().A.getIntl(),n=function(e){const t=L().z.createdTime(e.createdTime),n=L().z.lastEditedTime(e.lastEditedTime);if(t)return"createdTime";if(n)return"lastEditedTime";return}(e);if("createdTime"===n)return(0,K().t)(e.createdTime,t);if("lastEditedTime"===n)return(0,K().t)(e.lastEditedTime,t);return""}(n);case"titleToggle":case"contentStatusFilter":return[];default:(0,D().HB)(t)}}),[r,t,n]);return(0,z.jsx)("div",{style:o.title,children:(0,z.jsx)(m().sA,{defaultMessage:"{filterName}{colon} {filterOperator} {filterValues}",id:"search.filterBarFilter.title",values:{filterName:U(t),filterOperator:0===i.length?void 0:H(t,n),filterValues:i,colon:0===i.length?void 0:":"}})})}function U(e){switch(e){case"personFilter":return(0,z.jsx)(m().sA,{id:"search.filterMenu.moreFilters.person",defaultMessage:"Created by"});case"teamsFilter":return(0,z.jsx)(m().sA,{id:"search.filterMenu.moreFilters.inTeams",defaultMessage:"Teamspace"});case"pageFilter":return(0,z.jsx)(m().sA,{id:"search.filterMenu.moreFilters.inPage",defaultMessage:"In"});case"dateFilter":return(0,z.jsx)(m().sA,{id:"search.filterMenu.moreFilters.dateFilterLabel",defaultMessage:"Date"});case"titleToggle":return(0,z.jsx)(m().sA,{id:"search.filterMenu.onlyMatchTitlesToggle.label",defaultMessage:"Title only"});case"dev_notInPageFilter":return(0,z.jsx)(m().sA,{id:"[DO NOT TRANSLATE].search.filterMenu.notInPageFilter.label",defaultMessage:"[dev] Not in page"});case"dev_notInTeamFilter":return(0,z.jsx)(m().sA,{id:"[DO NOT TRANSLATE].search.filterMenu.notInTeamFilter.label",defaultMessage:"[dev] Not in teamspace"});case"contentStatusFilter":return(0,z.jsx)(m().sA,{id:"searchContentStatusFilter.filterTitle",defaultMessage:"Content status"})}(0,D().HB)(e)}function H(e,t){switch(e){case"personFilter":case"teamsFilter":case"pageFilter":case"dev_notInPageFilter":case"dev_notInTeamFilter":case"dateFilter":case"titleToggle":case"contentStatusFilter":return}(0,D().HB)(e)}function W(e){return", "}function $(e,t){const n=e.ancestors,r=g().oE(n.map((e=>{const n=j().B.createChildStore(t,{table:P().ev,id:e});return n.isDefined()?n.getModel().getRenderTitle({getRecordModel:n.getRecordModel,userTimeZone:(0,_().P)(),intl:C().A.getIntl()}):""})));return(0,N().G)(r,W)}var G=()=>n(610884),Q=(n(944114),n(898992),n(672577),()=>n(250910)),Y=()=>n(807449),Z=()=>n(546926),X=()=>n(890492),J=()=>n(81068),ee=()=>n(663639),te=()=>n(736847),ne=()=>n(582684),re=()=>n(56394),oe=()=>n(649265);function ie(e){const{sort:t,onSortChange:n,onMenuOpen:r,onMenuDismiss:o}=e,i=(0,m().tz)();return(0,z.jsx)(Q().A,{popupType:Q().z.Popup,renderOrigin:e=>function(e,t,n){const r=oe().w_.find((e=>g().n4(e.sort,n)))??oe().w_[0],o="relevance"===r.sort.field?ae.sort:r.formattedName,i="relevance"!==r.sort.field;return(0,z.jsx)(re().A,{disabled:!1,title:t.formatMessage(o),onClick:e.onClick,icon:(0,z.jsx)(Y().I,{icon:ne().arrowUpDownIcon}),on:i})}(e,i,t),render:e=>function(e){const{intl:t,sort:n,onSortChange:r}=e,o=oe().w_.findIndex((e=>g().n4(e.sort,n))),i=[];for(const a of oe().w_)i.push({key:a.key,render:e=>(0,z.jsx)(J().A,{...e,title:t.formatMessage(a.formattedName)}),action:()=>{r(a.sort)}});return(0,z.jsx)(X().A,{menuType:Z().gu.Popup,children:(0,z.jsx)(ee().A,{type:ee().O.Vertical,initialFocus:o<0?0:o,sections:[{key:"sortOptions",items:i,render:e=>(0,z.jsx)(te().A,{...e})}]})})}({...e,intl:i,sort:t,onSortChange:n}),disabled:!1,placementToOrigin:"bottom",alignmentToOrigin:"start",originGap:4,onClick:r,onClose:o})}const ae=(0,m().YK)({sort:{id:"search.sort.sortOrder.bestMatches.title",defaultMessage:"Sort"}}),se=(0,m().YK)({filterTitle:{id:"searchContentStatusFilter.filterTitle",defaultMessage:"Content status"}}),le="SearchFilterSettings",de={starting:void 0,ending:void 0},ce=["titleToggle","contentStatusFilter","personFilter","teamsFilter","pageFilter","dateFilter","dev_notInPageFilter","dev_notInTeamFilter"];function ue(e){const{filters:t,onFiltersChange:n,sort:C,onSortChange:j,parentStore:A,onPopupOpen:B,onPopupClose:_}=e,N=(0,o().T)(),[P,R]=(0,r.useState)((()=>{const e=p().K.get({userId:N,key:le}),t=null==e?void 0:e.filterOrder;if(!t)return ce;const n=ce.filter((e=>!t.includes(e)));return[...t,...n]})),E=(0,s().K8)((()=>M().default.state.isPublicPageSearch),[]),O=(0,s().K8)((()=>(0,v().zI)({spaceStore:(0,i().S)()})>0&&!E),[E]),F=!E,D=(0,l().IS)((()=>({scroller:{display:"flex",alignItems:"center",paddingTop:10,paddingInlineEnd:12,paddingBottom:10,paddingInlineStart:12},barContainer:{display:"flex",alignItems:"center"},scrollerContainer:{position:"relative",flexGrow:0,overflow:"hidden"},draggableList:{display:"flex",flexShrink:0,marginInlineStart:6},divider:{height:16,width:1,borderRadius:1,backgroundColor:h().Tj.border.secondary}})),[]),q=(0,r.useCallback)((e=>t=>n({[e]:t})),[n]),L=(0,r.useCallback)((e=>{const{onMenuDismiss:n,onMenuOpen:r}=e;if(F)return(0,z.jsx)(S().A,{mode:k().C.Pill,focused:!1,title:(0,z.jsx)(V,{filterUIName:"personFilter",filters:t,parentStore:A}),parentStore:A,userIds:t.createdBy,onMenuDismiss:n,onMenuOpen:r,onChange:q("createdBy")})}),[F,A,t,q]),K=(0,r.useCallback)((e=>{const{onMenuDismiss:n,onMenuOpen:r}=e;return O&&(0,z.jsx)(w().SZ,{mode:k().C.Pill,focused:!1,title:(0,z.jsx)(V,{filterUIName:"teamsFilter",filters:t,parentStore:A}),parentStore:A,teamIds:t.inTeams,onMenuDismiss:n,onMenuOpen:r,onChange:q("inTeams")})}),[A,t,q,O]),U=(0,r.useCallback)((e=>{const{onMenuDismiss:n,onMenuOpen:r}=e;return(0,z.jsx)(x().E,{mode:k().C.Pill,focused:!1,title:(0,z.jsx)(V,{filterUIName:"pageFilter",filters:t,parentStore:A}),parentStore:A,blockIds:t.ancestors,onMenuDismiss:n,onMenuOpen:r,onChange:q("ancestors"),peopleBlocksToInclude:"collection_view_page"})}),[A,t,q]),H=!1,W=(0,r.useCallback)((()=>null),[A,t,q,H]),$=(0,r.useCallback)((()=>null),[A,t,q,H]),Q=(0,r.useMemo)((()=>g().Im(t.createdTime)||g().n4(t.createdTime,de)?"lastEditedTime":"createdTime"),[t.createdTime]),Y=(0,r.useMemo)((()=>"createdTime"===Q?t.createdTime:t.lastEditedTime),[Q,t.createdTime,t.lastEditedTime]),Z=(0,r.useCallback)(((e,t)=>n({[e]:t})),[n]),X=(0,r.useCallback)((e=>{const{onMenuDismiss:n,onMenuOpen:r}=e,o={mode:k().C.Pill,focused:!1,title:(0,z.jsx)(V,{filterUIName:"dateFilter",filters:t,parentStore:A}),icon:u().D,initialValue:Y,dateFilterType:Q,onMenuDismiss:n,onMenuOpen:r,onChange:Z};return(0,z.jsx)(G().m,{...o})}),[Q,Y,t,A,Z]),J=(0,r.useCallback)((()=>!a().A.isMobile&&(0,z.jsx)(I().J,{mode:k().C.Pill,focused:!1,title:(0,z.jsx)(V,{filterUIName:"titleToggle",filters:t,parentStore:A}),icon:c().a,value:t.navigableBlockContentOnly||!1,onChange:q("navigableBlockContentOnly")})),[t,A,q]),ee=(0,m().tz)(),te=(0,y().Q)(),ne=(0,r.useCallback)((e=>{n({contentStatusFilter:e})}),[n]),re=(0,r.useCallback)((e=>{const{onMenuDismiss:n,onMenuOpen:r}=e;return te?(0,z.jsx)(b().a,{mode:k().C.Pill,title:ee.formatMessage(se.filterTitle),value:t.contentStatusFilter,onChange:ne,onMenuDismiss:n,onMenuOpen:r}):null}),[te,t.contentStatusFilter,ne,ee]),oe=(0,r.useCallback)((e=>{R(e);const t={filterOrder:e};p().K.set({userId:N,key:le,value:t})}),[N]),ae=(0,r.useMemo)((()=>({onMenuOpen:B||(()=>{}),onMenuDismiss:_||(()=>{})})),[B,_]),ue=(0,r.useMemo)((()=>({titleToggle:J(),personFilter:L(ae),teamsFilter:K(ae),pageFilter:U(ae),dateFilter:X(ae),contentStatusFilter:re(ae),dev_notInPageFilter:W(),dev_notInTeamFilter:$()})),[J,L,K,U,X,re,W,$,ae]),pe=(0,r.useCallback)((()=>(0,z.jsx)(T().Ay,{direction:"horizontal",keys:P,disableVerticalEdgeScroll:!0,disableHorizontalEdgeScroll:!0,renderKey:e=>ue[e],style:D.draggableList,onDrop:oe})),[P,ue,D.draggableList,oe]),me=(0,r.useCallback)((e=>{const{onMenuDismiss:t,onMenuOpen:n}=e;return(0,z.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,z.jsx)(ie,{sort:C,onSortChange:j,onMenuOpen:n,onMenuDismiss:t}),(0,z.jsx)("div",{style:D.divider})]})}),[C,j,D.divider]);return(0,z.jsx)("div",{style:D.barContainer,children:(0,z.jsx)("div",{style:D.scrollerContainer,children:(0,z.jsxs)(f().H,{type:d().A.X,style:D.scroller,children:[(0,z.jsx)(z.Fragment,{children:me(ae)}),(0,z.jsx)(z.Fragment,{children:pe()})]})})})}},637307:(e,t,n)=>{n.d(t,{sg:()=>O,Ay:()=>F,fQ:()=>P,mD:()=>R});n(944114),n(898992),n(354520),n(672577),n(803949),n(581454);var r=n(296540),o=()=>n(907258),i=()=>n(92697),a=()=>n(726637),s=()=>n(484714),l=()=>n(590526),d=()=>n(75435),c=()=>n(295633),u=()=>n(663639),p=()=>n(736847),m=()=>n(584262),h=()=>n(859384),g=()=>n(177148),f=()=>n(179034),y=()=>n(245241),v=()=>n(69708),b=()=>n(496603),x=()=>n(534177),S=()=>n(824188),w=()=>n(257667),I=()=>n(825972),k=()=>n(968172),T=()=>n(21899);var M=()=>n(599412),C=()=>n(321874),j=()=>n(905487),A=()=>n(5374),B=()=>n(933593),_=n(474848);const N=(0,v().YK)({newPage:{id:"searchDefaultBody.searchActionMenuItem.newPage",defaultMessage:"Create a new page"}});function P(e){const{environment:t,offsetFromBottom:n,spaceStore:r,setIsLoadingRecents:o,setEndOfRecentsReached:i,numRecents:a,setNumRecents:s,endOfRecentsReached:l,isLoadingRecents:d,incrementBy:c=50,isCrossWorkspace:u=!1}=e;if(n>200||d||l||!r)return;if(u){if((0,I().Dd)()){const e=a+c;s(e),e>200&&i(!0)}return}const p=k().A.getWithoutSubscribing(r.id),m=p[p.length-1],h=null==m?void 0:m.visitedAt;if(!h)return;const g=b().nF((async()=>{const e=t.currentUser.id;if(!e||!h)return;o(!0);const n=await S().loadMoreRecentPages(h,{environment:t,userId:e,spaceStore:r});o(!1),n||i(!0)}),300);if((0,I().Dd)()){const e=I().NK.state.length,t=Math.min(a+c,e);s(t),i(t>=e)}else g()}function R(e){const{environment:t,isNewElectronTab:n,electronTabs:r,intl:o,isSlipperySlopeEnabled:i}=e,a=o.formatMessage(i?{id:"sidebar.newPage.button",defaultMessage:"New page"}:N.newPage),s=i?g().Y:h().M;return(0,A().g)({environment:t,queryId:void 0,desktopProps:{isNewElectronTabSearch:Boolean(n),electronTabs:r},searchSessionId:void 0,source:"quick_find",action:()=>{C().st({environment:t,reset:!1})},result:{type:"client_action",eventName:"tab_new_page",value:{icon:s,title:a,behavior:"action",aliases:void 0,caption:void 0,action:()=>{const e=m().y8.SearchTabs;(async()=>{var n;const o=await(0,M().M)({environment:t,from:"electron_new_tab_search",pageVisitSource:e,navigateOnCreate:!1});o&&(await(null===(n=t.defaultRecordCache.persistedRecordCache)||void 0===n?void 0:n.flushPendingWrites()),w().q9({environment:t,pageVisitSource:e,openInNew:void 0,electronTabSearch:{tabs:r,isNewTab:!0},searchResult:{type:"custom",store:o},queryId:void 0,context:"new_page"}))})()}}}})}function E(e,t){return{store:e,id:e.id,score:-1,spaceId:e.getSpaceId(),sources:[y().Ni.Local],featureGroups:[],originalPosition:t,serverEventProperties:void 0}}function O({bucket:e}){switch(e){case"today":return(0,_.jsx)(v().sA,{id:"search.recentPagesTimeBuckets.today.text",defaultMessage:"Today"});case"yesterday":return(0,_.jsx)(v().sA,{id:"search.recentPagesTimeBuckets.yesterday.text",defaultMessage:"Yesterday"});case"past_week":return(0,_.jsx)(v().sA,{id:"search.recentPagesTimeBuckets.pastWeek.text",defaultMessage:"Past week"});case"past_30_days":return(0,_.jsx)(v().sA,{id:"search.recentPagesTimeBuckets.past30Days.text",defaultMessage:"Past 30 days"});case"older":return(0,_.jsx)(v().sA,{id:"search.recentPagesTimeBuckets.older.text",defaultMessage:"Older"})}(0,x().HB)(e)}const F=function(e){var t;const{onSelect:m,spaceStore:h,comboboxProps:g}=e,[y,S]=r.useState(!1),[M,A]=r.useState(!1),N=(0,l().K8)((()=>(0,I().Dd)()?30:-1),[]),[F,D]=r.useState(N),q=(0,l().uB)(void 0,n(452004).$),{section:L,indexLocal:K,indexGlobal:z}=(0,l().K8)((()=>q.state.focus),[q]),V=(0,s().v3)(),U=(0,v().tz)(),H=(0,s().Y0)(),W=(0,n(38554).U)(),$=(0,n(401497).IS)((()=>({wrapper:{paddingTop:8,width:"100%",height:"100%",overflowX:"hidden",overflowY:"auto",paddingInlineStart:4,paddingInlineEnd:4},sectionHeader:{marginBottom:8},section:{marginBottom:4},menuItemLabel:{lineHeight:"20px",fontSize:14,fontWeight:n(284371).Wy.medium}})),[]),{setDefaultBodyFocusedResult:G}=(0,r.useContext)(n(870976).SearchStaticContext),Q=(0,l().K8)((()=>{const e=n(712505).default.state,t=(0,n(747100).Gb)();return e.open&&(t||e.isOpening)?e.targetStore:o().default.state.mainEditorCurrentBlockStore}),[]),Y=(0,l().K8)((()=>(0,n(303742).o)(o().default.state.sidebarSpaceViewStore)),[]),Z=(0,l().K8)((()=>{const{currentUserRootStore:e}=o().default.state;if(Y&&e)return function(e){const{currentUserRootStore:t,currentPageStore:n,numRecents:r}=e;if(!t)return[];const o=(0,T().f)({currentUserRootStore:t}),i=[];o.forEach((e=>{const t=e.getSpaceId(),n=e.getSpaceStore();if(!n)return;const r=k().A.get(t);if(r){const e=r.map((e=>({...e,store:c().B.createChildStore(n.getPagesStore(),{table:f().ev,id:e.pageId,spaceId:t})})));i.push(...e)}}));const a=i.sort(((e,t)=>t.visitedAt-e.visitedAt)),s=(0,b().hS)(a,(e=>e.pageId)).filter((e=>e.pageId!==(null==n?void 0:n.id)));return r>0?s.slice(0,r):s}({currentUserRootStore:e,currentPageStore:Q,numRecents:F});const t=I().NK.state.filter((e=>e.pageId!==(null==Q?void 0:Q.id)));return F>0?t.slice(0,F):t}),[F,Y,Q]);(0,r.useEffect)((()=>()=>{G(void 0)}),[G]);const X=(0,l().K8)((()=>Boolean(j().default.state.isNewElectronTab)),[]),J=(0,n(913063).o)(),ee=(0,l().K8)((()=>n(383070).zD.isDeepFindEnabled()),[]),te=(0,l().K8)((()=>{var e;const t=[],r=null===(e=d().A.state.preferences)||void 0===e?void 0:e.isNewTabSearchEnabled;if(X&&r){const e=R({environment:V,isNewElectronTab:X,electronTabs:J,intl:U,isSlipperySlopeEnabled:W});if(t.push(e),W){const e=(0,n(5844).B)({environment:V,intl:U});t.push(e)}}return t}),[X,V,U,J,W]),ne=(0,l().K8)((()=>{var e;const t=H.isElectron&&(null===(e=d().A.state.preferences)||void 0===e?void 0:e.isNewTabSearchEnabled)&&(0,n(646969).i)(i().A.state.tabs,i().A.state.currentTab.id),r=j().default.state.isNewElectronTab;if(!h||!t||!r)return[];return t.slice(0,4).map(((e,t)=>{let r;if(e.pageId){var o;const n=(null===(o=Z.find((({pageId:t})=>e.pageId===t)))||void 0===o?void 0:o.store)??c().B.createChildStore(h,{table:f().ev,id:e.pageId}),i=E(n,t);r={key:`${n.id}:${e.id}`,action:e=>m({index:{local:e.indexLocal,global:e.index},event:e.event,selectedResult:i,fromSidePeekPanel:!1,additionalResultsCount:te.length,context:"tabs"}),render:e=>(0,_.jsx)(B().GC,{...e,inline:!0,store:n,result:i,hidePath:!1,buttonStyle:{paddingInlineStart:1},type:"tabs"})}}else if("chat"===e.type){const t=(0,_.jsx)("div",{style:{...$.menuItemLabel,marginInlineStart:2},children:(0,_.jsx)(v().sA,{id:"searchDefaultBody.searchTabMenuItem.notionAI",defaultMessage:"Notion AI"})});r={key:e.id,action:t=>w().HI({tabId:e.id,tabSectionId:e.tabSectionId,url:n(427704).JZ.chat,event:t.event,environment:V}),render:e=>(0,_.jsx)(n(947171).A,{type:"assistant",...e,title:t})}}return r})).filter(x().O9)}),[H.isElectron,m,h,te.length,Z,$.menuItemLabel,V]),re=(0,r.useMemo)((()=>{const e={};return Z.forEach((({pageId:t,visitedAt:n})=>e[t]=n)),e}),[Z]),oe=(0,l().K8)((()=>{const e=new Map;return Z.map(((t,n)=>{const r=I().ht(t.visitedAt),o="today"!==r&&"yesterday"!==r,i=E(t.store,n),s={key:`${t.store.id}:${n}`,action:e=>m({index:{local:e.indexLocal,global:e.index},event:e.event,selectedResult:i,fromSidePeekPanel:!1,additionalResultsCount:te.length+ne.length,context:"recent_pages"}),render:e=>(0,_.jsx)(B().GC,{...e,inline:!a().A.isMobile,store:t.store,result:i,hidePath:!1,lastViewed:o?re[t.store.id]:void 0,buttonStyle:{paddingInlineStart:1},type:"recent_pages"})},l={result:s,store:t.store};var d;e.has(r)?null===(d=e.get(r))||void 0===d||d.push(l):e.set(r,[l])})),e}),[te.length,Z,m,re,ne.length]),ie=(0,n(297799).U)({onClick:()=>C().st({environment:V,reset:!1})}),ae=(0,n(475553).y)(),se=!(0,l().O$)(n(929219).e),le=ae&&se,de=(0,n(148080).x)({onSelect:m}),ce=(0,l().K8)((()=>{const e=[];if(te.length>0&&e.push({key:"actions",items:te,render:e=>(0,_.jsx)(p().A,{title:ee?void 0:(0,_.jsx)(v().sA,{id:"search.actions.header",defaultMessage:"Actions"}),desktopTitleStyle:$.sectionHeader,style:$.section,children:e.children})}),ne.length>0&&e.push({key:"tabs",items:ne,render:e=>(0,_.jsx)(p().A,{title:(0,_.jsx)(v().sA,{id:"search.tabs.header",defaultMessage:"Tabs"}),desktopTitleStyle:$.sectionHeader,style:$.section,children:e.children})}),le)e.push(...de);else for(const[t,n]of oe.entries()){const r={key:t,items:n.map((e=>e.result)),render:e=>(0,_.jsx)(p().A,{title:(0,_.jsx)(O,{bucket:t}),desktopTitleStyle:$.sectionHeader,style:{...$.section},children:e.children})};e.push(r)}return ie&&e.push(ie),e}),[te,ne,le,ie,ee,$.sectionHeader,$.section,de,oe]),ue=(0,r.useCallback)((e=>P({environment:V,offsetFromBottom:e,spaceStore:h,setIsLoadingRecents:S,setEndOfRecentsReached:A,numRecents:F,setNumRecents:D,endOfRecentsReached:M,isLoadingRecents:y,isCrossWorkspace:Y})),[M,V,y,F,h,Y]),pe=void 0===L||null===(t=ce[L])||void 0===t?void 0:t.key,me=(0,l().K8)((()=>{var e;if(void 0===K||!pe)return;return(0,x().Xk)(I().Rj,pe)?null===(e=oe.get(pe))||void 0===e||null===(e=e[K])||void 0===e?void 0:e.store:void 0}),[K,pe,oe]);(0,r.useEffect)((()=>{void 0!==L&&void 0!==K&&void 0!==z&&"string"==typeof pe&&("actions"===pe?G({type:"assistant"}):(0,x().Xk)(I().Rj,pe)&&me&&G({type:"page_result",value:{index:{local:{indexLocal:K,section:L},global:z},selectedResult:E(me,z-te.length)}}))}),[te.length,G,z,L,K,pe,me]);const he=te.length,ge=!a().A.isMobile&&Z.length>0;return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)("div",{style:$.wrapper,children:[(0,_.jsx)(u().A,{store:q,type:u().O.Vertical,initialFocus:he,disableKeyboardArrowWrap:!0,sections:ce,unfocusOnScroll:!0,comboboxProps:g}),(0,_.jsx)(n(498521).A,{onChange:ue})]}),ge?(0,_.jsx)(n(476277).A,{title:(0,_.jsx)(n(127720).A,{}),shouldShowReportBadSearchButton:!1}):void 0]})}},639417:(e,t,n)=>{n.d(t,{R:()=>S});var r=n(296540),o=()=>n(590526),i=()=>n(401497),a=()=>n(807449),s=()=>n(265060),l=()=>n(605777),d=()=>n(12193),c=()=>n(742852),u=n(474848);const p={viewBox:"0 0 20 20",fittedViewBox:"2.96 1.99 14.08 15.13",svg:(0,u.jsx)("path",{d:"M7.3 2a.55.55 0 1 0 0 1.1h5.4a.55.55 0 0 0 0-1.1zM4.95 4.8a.55.55 0 0 1 .55-.55h9a.55.55 0 0 1 0 1.1h-9a.55.55 0 0 1-.55-.55m.138 1.625A2.125 2.125 0 0 0 2.963 8.55V15c0 1.174.951 2.125 2.125 2.125h9.825A2.125 2.125 0 0 0 17.038 15V8.55a2.125 2.125 0 0 0-2.125-2.125z"})},m=(0,n(340498).wt)("stackFill",p,"fill");var h=()=>n(941115),g=()=>n(100622),f=()=>n(534177),y=()=>n(187820);const v={notion:n(182183).notionTintableIcon,webpage:d().globeIcon,helpdocs:l().bookIcon,"helpdoc-section":l().bookIcon,...n(203717).G},b={"google-drive-spreadsheets":n(551171).C,"google-drive-presentation":m,"google-drive-document":n(619403).pageFillIcon,"google-drive-pdf":n(199103).H};function x(e){if(e&&function(e){for(const t of(0,f().uv)(b))if(t===e)return!0;return!1}(e))return e}function S(e){const{result:t,size:n,style:r,notStandaloneIcon:o}=e,a=(0,i().IS)((()=>{const e=Math.floor(20*n/16);return{wrapper:o?{}:{position:"relative",flexShrink:0,marginInlineEnd:2,marginTop:2,width:e,height:e}}}),[o,n]);return"notion"===t.type?(0,u.jsx)("div",{style:a.wrapper,children:(0,u.jsx)(w,{result:t,size:n,style:r})}):(0,u.jsx)("div",{style:a.wrapper,children:(0,u.jsx)(I,{result:t,size:n,style:r})})}function w(e){const{result:{store:t},size:n,style:r}=e,i=(0,o().K8)((()=>t.getIcon()),[t]),a=(0,o().K8)((()=>t.isEmptyPage()),[t]),s=(0,o().K8)((()=>(0,y().Te)(t)),[t]);return(0,u.jsx)(y().B6,{disabled:!0,icon:i,isEmptyPage:a,size:n,style:r,useInvertedColors:!1,iconRecordCategory:s})}function I(e){const{result:t,size:n,style:o}=e,[l,p]=(0,r.useState)(!1),m=(0,r.useMemo)((()=>x("google-drive"===t.type?`google-drive-${t.fileType}`:void 0)),[t]),f=(0,i().IS)((()=>{let e;switch(m){case"google-drive-presentation":e=g().Tj.palette.yellow[500];break;case"google-drive-spreadsheets":e=g().Tj.palette.green[500];break;case"google-drive-document":e=g().Tj.palette.blue[500]}return{icon:{...o,...e?{fill:e}:{},height:n,width:n,position:"relative"}}}),[n,o,m]);if(m)return b[m](f.icon);if("webpage"===t.type)return t.url.includes("github.com")?(0,u.jsx)(s().Q,{iconGroup:h().A,variantName:"default",overrideSize:()=>n}):l?(0,u.jsx)(a().I,{icon:d().globeIcon,style:f.icon}):(0,u.jsx)("img",{style:f.icon,src:`${t.domain}/favicon.ico`,onError:()=>p(!0),alt:`Favicon for ${t.url}`});{const e=v[t.type];return"custom"===t.type&&t.iconUrl?(0,u.jsx)("img",{src:t.iconUrl,style:f.icon,alt:t.title}):e?"function"==typeof e?e(f.icon):(0,u.jsx)(s().Q,{iconGroup:e,variantName:"default",overrideSize:()=>n}):(0,u.jsx)(a().I,{icon:c().linkIcon,style:f.icon})}}},646969:(e,t,n)=>{n.d(t,{i:()=>r});n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(354520),n(672577);function r(e,t){var n,r;const o=new Set,i=e.find((e=>e.id===t)),a=null==i?void 0:i.tabSectionId,s=i?`${i.type}-${null===(n=i.pagePointer)||void 0===n?void 0:n.spaceId}-${null===(r=i.pagePointer)||void 0===r?void 0:r.id}`:void 0;return o.add(s),e.filter((e=>{var t,n;if(a&&e.tabSectionId!==a)return!1;const r=`${e.type}-${null===(t=e.pagePointer)||void 0===t?void 0:t.spaceId}-${null===(n=e.pagePointer)||void 0===n?void 0:n.id}`;return!o.has(r)&&(o.add(r),!0)}))}},649265:(e,t,n)=>{n.d(t,{Bo:()=>r,Jq:()=>o,_9:()=>i,w_:()=>a});const r={"lastEdited.desc":"led","lastEdited.asc":"lea","created.desc":"ctd","created.asc":"cta"},o=(0,n(69708).YK)({bestMatches:{id:"search.sort.sortOrder.bestMatches",defaultMessage:"Best matches"},lastEditedNewestFirst:{id:"search.sort.sortOrder.lastEdited.newestFirst",defaultMessage:"Last edited: Newest first"},lastEditedOldestFirst:{id:"search.sort.sortOrder.lastEdited.oldestFirst",defaultMessage:"Last edited: Oldest first"},createdNewestFirst:{id:"search.sort.sortOrder.created.newestFirst",defaultMessage:"Created: Newest first"},createdOldestFirst:{id:"search.sort.sortOrder.created.oldestFirst",defaultMessage:"Created: Oldest first"}}),i=[{key:"lastEdited.desc",formattedName:o.lastEditedNewestFirst,sort:{field:"lastEdited",direction:"desc"}},{key:"lastEdited.asc",formattedName:o.lastEditedOldestFirst,sort:{field:"lastEdited",direction:"asc"}},{key:"created.desc",formattedName:o.createdNewestFirst,sort:{field:"created",direction:"desc"}},{key:"created.asc",formattedName:o.createdOldestFirst,sort:{field:"created",direction:"asc"}}],a=[{key:"relevance",formattedName:o.bestMatches,sort:{field:"relevance"}},...i]},656975:(e,t,n)=>{n.d(t,{Q:()=>i});var r=()=>n(242422),o=()=>n(590526);function i(){return(0,o().K8)((()=>{const e=r().default.checkGate({gateName:"archive_content"}),t="on"===r().default.getEligibleGroup({experimentId:"search_post_filter_archived_pages",defaultGroup:"control"});return e&&t}),[])}},663929:(e,t,n)=>{n.d(t,{e1:()=>h,hC:()=>f,vd:()=>y});n(581454);var r=n(296540),o=()=>n(401497),i=()=>n(265060),a=()=>n(902006),s=()=>n(203717),l=()=>n(374693),d=()=>n(469254),c=()=>n(100622),u=()=>n(534177),p=()=>n(284371),m=n(474848);function h(e){const t={...s().G,...d().V};return"notion"===e?l()._:t[e]}const g=5;function f(e){const{connectors:t,maxBubbles:n,iconSize:a,bubbleStyles:s,disableNumericalEllipsis:l}=e,d=(0,r.useMemo)((()=>[...t.slice(0,n)].reverse()),[t,n]),u=Math.max(0,t.length-n),f=(0,o().IS)((()=>({bubbleWrapper:{display:"flex",alignItems:"center",flexDirection:"row-reverse",justifyContent:"flex-end",marginInlineStart:g},bubble:{boxShadow:c().Tj.connectorBubbleShadow,borderRadius:"100%",width:20,height:20,backgroundColor:c().Tj.whiteButtonBackground,display:"flex",alignItems:"center",justifyContent:"center",marginInlineStart:-g,fontSize:9,fontWeight:p().Wy.medium,color:c().Tj.text.tertiary,...s}})),[s]);return 0===t.length?null:(0,m.jsxs)("div",{style:f.bubbleWrapper,children:[!l&&u>0?(0,m.jsx)("div",{style:f.bubble,children:(0,m.jsx)("div",{children:`+${u}`})}):void 0,d.map(((e,t)=>(0,m.jsx)("div",{style:f.bubble,children:(0,m.jsx)(i().Q,{iconGroup:h(e),overrideSize:()=>a,variantName:"default"})},`${e}-${t}`)))]})}function y(e){return"notion"===e.type?"notion":(0,a().SC)(e.type)?e.type:"everything"===e.type||"universal-workspace"===e.type||"workspace"===e.type||"page"===e.type||"collection"===e.type||"teamspace"===e.type||"site"===e.type||"notion-none"===e.type||"ai-knowledge"===e.type||"helpdocs"===e.type||"web"===e.type||"universal-none"===e.type||"slackbot"===e.type||"labeler"===e.type?void 0:(0,u().HB)(e.type)}},670693:(e,t,n)=>{n.d(t,{Z:()=>o});var r=()=>n(44551);function o(){var e;null===r().electronApi||void 0===r().electronApi||null===(e=r().electronApi.quickSearchReady)||void 0===e||e.call(r().electronApi)}},677590:(e,t,n)=>{n.d(t,{U:()=>d});n(898992),n(354520),n(581454);var r=()=>n(651784),o=()=>n(496603),i=()=>n(534177),a=()=>n(246766),s=()=>n(483730),l=()=>n(251383);function d(e){const{environment:t}=e,n=e.sessionId??s().default.getActiveSessionId(),d=n?s().default.getSessionContext(n):void 0;if(!n||!d)return;d.addTemporaryOperationsToUncommittedOperations();const{editGroupsThatWereRejected:c}=(0,l().V)({environment:t,sessionId:n}),u=t.RouterStore.state.route,p=(0,r().hZ)(u);if(p.length>0){const e=c.map((e=>"updatedPage"===e.type&&e.didCreatePage?e.pageId:void 0)).filter(i().O9);o().E$(p,e).length>0&&(0,a().navigate)({environment:t,url:d.urlAtStartOfSession})}d.caches.removeDefaultCacheOverride(t),s().default.setState({...s().default.state,...s().default.state.activeAiSessionId===n&&{activeAiSessionId:void 0}})}},683274:(e,t,n)=>{n.d(t,{l:()=>d});var r=n(296540),o=()=>n(484714),i=()=>n(300789),a=()=>n(51367),s=()=>n(360457),l=n(474848);function d(e){const{messageKey:t,button:n}=e,d=(0,o().v3)();(0,r.useEffect)((()=>{a().DL(d,{callout_key:t,placement_key:"Tooltip"})}),[d,t]);const c=(0,r.useCallback)((e=>{a().Y5(d,{callout_key:t,click_type:"primary_cta",placement_key:"Tooltip"}),e&&e()}),[d,t]),u=(0,r.useCallback)((()=>{a().Sq(d,{callout_key:t,dismiss_type:"announcement_card_dismiss",placement_key:"Tooltip"}),i().a(d,t)}),[d,t]);return(0,l.jsx)(s().S,{...e,button:{...n,onClick:()=>{c(n.onClick)}},onDismiss:u})}},691298:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(296540),o=()=>n(232615),i=()=>n(206051);const a=function({shouldPreserveTextSelection:e,shouldPreserveBlockSelection:t,shouldRestoreSelection:a,onClearSelection:s}){const l=(0,n(484714).v3)(),d=(0,r.useRef)(e),c=(0,r.useRef)(""),u=(0,r.useRef)({selectionState:null,textSelectionState:null}),p=(0,r.useCallback)((()=>u.current),[]),m=(0,r.useCallback)((()=>{c.current=window.location.href,o().default.hasSelection()&&(u.current.textSelectionState=o().default.cloneState()),(0,n(755125).clear)({environment:l}),t&&(i().default.isSelected()&&(u.current.selectionState=i().default.cloneState()),(0,n(440024).I)({environment:l}))}),[l,t]),h=(0,r.useCallback)((()=>{u.current={selectionState:null,textSelectionState:null},c.current="",null==s||s()}),[s]),g=(0,r.useCallback)((()=>{const{selectionState:e,textSelectionState:n}=u.current;window.location.href===c.current&&(n&&"mode"in n&&"editing"===n.mode&&o().default.setState({...o().default.state,...n}),t&&e&&i().default.setState({...i().default.state,...e})),h()}),[h,t]);return(0,n(852507).l)((()=>{d.current=e,e&&m()})),(0,r.useEffect)((()=>(d.current&&!e?a?g():h():!d.current&&e&&m(),d.current=e,()=>{a?g():h()})),[e,h,g,m,a]),{clearSavedSelection:h,restoreSavedSelection:g,getSavedSelection:p}}},691309:(e,t,n)=>{n.d(t,{Nc:()=>R,OS:()=>M,So:()=>D,Vg:()=>q,Vz:()=>T,g$:()=>B,l4:()=>E,o4:()=>_,qY:()=>A,rB:()=>P,tF:()=>C,ze:()=>j});n(16280),n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(354520),n(672577),n(430670),n(803949),n(581454);var r=()=>n(496603),o=()=>n(183558),i=()=>n(973647),a=()=>n(534177),s=()=>n(700500),l=()=>n(15440),d=()=>n(356246),c=()=>n(898244),u=()=>n(236162),p=()=>n(206267),m=()=>n(792071),h=()=>n(72135),g=()=>n(134025),f=()=>n(54821),y=()=>n(179034),v=()=>n(519831),b=()=>n(96689),x=()=>n(84520),S=()=>n(798880),w=()=>n(252050),I=()=>n(436468),k=()=>n(33642);function T(e){const t=function(e){const{legacyNonCrdt:t,assistantOperation:n,actorPointer:l,getRecordValue:d,spaceId:p,citationHandling:h,currentTimeZone:b}=e,x=Date.now(),S={last_edited_by_table:l.table,last_edited_by_id:l.id,last_edited_time:x},w={created_by_table:l.table,created_by_id:l.id,created_time:x,...S},k=m().b4_.fromGetRecordValueFn(d);let T=[];if("createBlock"===n.command){if("database"===n.blockNode.tagName)return{error:new Error("Invalid creation operation for database")};const e=k({table:y().ev,id:n.blockNode.attributes.id}),i={},u={};let x;if("toggle"===n.blockNode.tagName&&(0,a().O9)(n.blockNode.attributes.size)&&(x=I().oc[n.blockNode.attributes.size],u.toggleable=!0),x||(x=I().w$[n.blockNode.tagName]),!x)return{error:new Error(`Unknown block type: ${n.blockNode.tagName}`)};if(n.blockNode.attributes)for(const[t,r]of Object.entries(n.blockNode.attributes)){const e=L[t];if(e){const t=e(r,{spaceId:p,isCreate:!0});Object.assign(i,t.properties),Object.assign(u,t.format)}}const S=Object.values(n.blockNode.properties).find((e=>"property-title"===e.tagName)),j=S?S.children:n.blockNode.text,A={};if(n.databaseSchemaId){const e={table:y().ev,id:n.databaseSchemaId},t=d(e);if(!t)return{error:new Error("No collection view block")};const r=n.collectionId?{table:v().Vl,id:n.collectionId,spaceId:p}:(0,f().j6)({table:y().ev,value:t});if(!r)return{error:new Error("No collection pointer")};const o=d(r);if(!o)return{error:new Error("No collection")};const i=(0,c().Dp)(o);for(const[a,s]of Object.entries(n.blockNode.properties)){const e=Object.entries(i).find((([,e])=>(null==e?void 0:e.name)===a));if(!e)return{error:new Error(`Property not found: ${a}`)};const[t]=e;A[t]=(0,I().ld)({type:"property",property:s,nodes:s.children,getRecordModel:k,currentTimeZone:b})||[]}}if("unknown-block"===n.blockNode.tagName&&e)return{value:[{type:"latentOperation",latentOperation:{type:"addUnknownBlockToPage",assistantOperation:{command:"addUnknownBlockToPage",blockNode:n.blockNode,copiedFromBlock:e},data:{spaceId:p,actorPointer:l}}}]};if(p){const{operations:e}=m().zgg.assistantCreate({type:x,id:D(n.blockNode.attributes.id),space_id:p,properties:{title:(null==j?void 0:j.length)>0?(0,I().ld)({type:"text",nodes:j,citationHandling:h,getRecordModel:k,currentTimeZone:b}):void 0,...i,...A},content:n.blockNode.children.length>0?n.blockNode.children.map((e=>D(e.attributes.id))):void 0,parentPointer:n.blockNode.parent&&{table:y().ev,id:D(n.blockNode.parent.attributes.id),spaceId:p},createdBy:{table:w.created_by_table,id:w.created_by_id,spaceId:p},lastEditedBy:{table:w.last_edited_by_table,id:w.last_edited_by_id,spaceId:p},format:u,legacyNonCrdt:t});T.push(...e)}if("tr"===n.blockNode.tagName){var M,C;const e=n.blockNode.attributes.id,t=null===(M=n.blockNode.parent)||void 0===M?void 0:M.attributes.id;if(!t)return{error:new Error(`Parent not found: ${t}.`)};const i={table:y().ev,id:D(e)},a={table:y().ev,id:D(t)},l=d(a);if(!l)return{error:new Error(`Parent block not found: ${t}.`)};if(l.type!==s().xd.table)return{error:new Error("Parent block is not of type table.")};let c=(null===(C=l.format)||void 0===C?void 0:C.table_block_column_order)||[];const u=Object.values(n.blockNode.properties).sort(((e,t)=>parseInt(e.attributes.name)-parseInt(t.attributes.name)));if(c.length>0&&c.length!==u.length){const e=e=>({type:"property",tagName:"property-text",attributes:{name:e},children:[{type:"text",value:""}]});for(const t of r().y1(u.length,c.length)){const n=(t+1).toString();u.push(e(n))}}for(const n of u)if(u.indexOf(n)+1!==parseInt(n.attributes.name))return{error:new Error("Table row properties are not in order.")};if(0===c.length){c=u.map((()=>(0,o().Ay)()));const e={last_edited_by_table:w.last_edited_by_table,last_edited_by_id:w.last_edited_by_id,last_edited_time:w.last_edited_time};T.push(g().op.update({pointer:a,path:["format"],args:{table_block_column_order:c}}),g().op.update({pointer:a,path:[],args:e}))}const p=Object.fromEntries(u.map(((e,t)=>[c[t],e.children.length>0?(0,I().ld)({type:"property",nodes:e.children,property:e,getRecordModel:k,currentTimeZone:b}):void 0])));T.push(g().op.update({pointer:i,path:["properties"],args:p}))}}else{if("removeBlock"===n.command)return{value:[{type:"latentOperation",latentOperation:{type:"removeBlock",assistantOperation:n,data:{spaceId:p,actorPointer:l}}}]};if("moveBlock"===n.command)T=[{pointer:{table:y().ev,id:D(n.oldParentId)},command:"listRemove",path:["content"],args:{id:D(n.blockNode.attributes.id)}},g().op.update({pointer:{table:y().ev,id:D(n.parentId)},path:[],args:S}),{pointer:{table:y().ev,id:D(n.blockNode.attributes.id)},command:"update",path:[],args:{parent_id:D(n.parentId),parent_table:y().ev,alive:!0,...S}}];else if("insertBlockBefore"===n.command)T=[{pointer:{table:y().ev,id:D(n.parentId)},command:"listBefore",path:["content"],args:{id:D(n.insertBlockNode.attributes.id),before:n.beforeId?D(n.beforeId):void 0}},g().op.update({pointer:{table:y().ev,id:D(n.parentId)},path:[],args:S}),{pointer:{table:y().ev,id:D(n.insertBlockNode.attributes.id)},command:"update",path:[],args:{parent_id:D(n.parentId),parent_table:y().ev,alive:!0,...S}}];else if("insertBlockAfter"===n.command){if("page"===n.insertBlockNode.tagName)return{value:[{type:"latentOperation",latentOperation:{type:"insertBlockAfter",assistantOperation:n,data:{spaceId:p,actorPointer:l}}}]};T=N(n,S)}else if("setBlockText"===n.command)T=[{pointer:{table:y().ev,id:D(n.blockNode.attributes.id)},command:"update",path:["properties"],args:{title:n.text&&n.text.length>0?(0,I().ld)({type:"text",nodes:n.text,getRecordModel:k,currentTimeZone:b}):void 0}},g().op.update({pointer:{table:y().ev,id:D(n.blockNode.attributes.id)},path:[],args:S})];else if("setBlockAttribute"===n.command){const e=L[n.attribute];if(!e)return{value:[]};{const t=e(n.value,{spaceId:p,isCreate:!1}),r={table:y().ev,id:D(n.blockNode.attributes.id)};T=[...t.properties?[g().op.update({pointer:r,path:["properties"],args:t.properties})]:[],...t.format?[g().op.update({pointer:r,path:["format"],args:t.format})]:[],g().op.update({pointer:r,path:[],args:S})]}}else if("setBlockTagName"===n.command){const e=I().w$[n.tagName];if(!e)return{error:new Error(`Unknown tag name: ${n.tagName}`)};T=[{pointer:{table:y().ev,id:D(n.blockNode.attributes.id)},command:"update",path:[],args:{type:e,...S}}]}else if("setBlockProperty"===n.command){const{blockNode:e,property:t,parentBlockId:r}=n,i={table:y().ev,id:D(e.attributes.id)},a=r?{table:y().ev,id:D(r)}:void 0,l=d(i),p=a?d(a):void 0;if(!l)return{error:new Error(`Block not found: ${e.attributes.id}.`)};if("property-title"===t.tagName)T=[{pointer:{table:y().ev,id:D(n.blockNode.attributes.id)},command:"update",path:["properties"],args:{title:(0,I().ld)({type:"text",nodes:t.children,getRecordModel:k,currentTimeZone:b})}},g().op.update({pointer:{table:y().ev,id:D(n.blockNode.attributes.id)},path:[],args:S})];else if(l.type===s().xd.tableRow){var j;if(!a||!p)return{error:new Error(`Block not found: ${r}.`)};if(p.type!==s().xd.table)return{error:new Error("Parent block is not of type table.")};const e=Number(t.attributes.name);if(!Number.isInteger(e)||e<1)return{error:new Error(`Invalid column index: ${e}.`)};const n=(null===(j=p.format)||void 0===j?void 0:j.table_block_column_order)||[];if(e>n.length+1)return{error:new Error(`Column index too high: ${e}.`)};const l=n[e-1];let d,c;l?(d=l,c=[...n]):(d=(0,o().Ay)(),c=[...n,d]),T=[g().op.update({pointer:i,path:["properties"],args:{[d]:t.children.length>0?(0,I().ld)({type:"text",nodes:t.children,getRecordModel:k,currentTimeZone:b})||[]:null}}),g().op.update({pointer:i,path:[],args:S})],l||T.push(g().op.update({pointer:a,path:["format"],args:{table_block_column_order:c}}),g().op.update({pointer:a,path:[],args:S}))}else{const e=(0,u().zN)({getRecordValue:d,block:l});if(!e)return{error:new Error("Block is not in a database.")};const r=t.attributes.name,o=(0,c().Dp)(e),i=Object.entries(o).find((([,e])=>(null==e?void 0:e.name)===r));if(!i)return{error:new Error(`Property not found: ${r}`)};const[a]=i,s=(0,I().ld)({type:"property",property:t,nodes:t.children,getRecordModel:k,currentTimeZone:b});T=[{pointer:{table:y().ev,id:D(n.blockNode.attributes.id)},command:"update",path:["properties"],args:{[a]:s}},g().op.update({pointer:{table:y().ev,id:D(n.blockNode.attributes.id)},path:[],args:S})]}}else if("insertOrMoveTableColumns"===n.command){var A;const{blockNode:e,atIndex:t,insertOrMoves:r}=n,l={table:y().ev,id:D(e.attributes.id)},c=d(l);if(!c)return{error:new Error(`Block not found: ${e.attributes.id}.`)};if(c.type!==s().xd.table)return{error:new Error("Block is not of type table.")};const u=(null===(A=c.format)||void 0===A?void 0:A.table_block_column_order)||[],p=i().Q.map(r,(e=>{if("schema"===e.type){return{value:(0,o().Ay)()}}if("move"===e.type){const t=u[Number(e.attributes.name)-1];return t?{value:t}:{error:new Error(`Invalid column index: ${e.attributes.name}.`)}}(0,a().HB)(e)}));if(i().Q.isFail(p))return p;const m=p.value,h=[...u.slice(0,t).filter((e=>!m.includes(e))),...m,...u.slice(t).filter((e=>!m.includes(e)))];T=[g().op.update({pointer:l,path:["format"],args:{table_block_column_order:h}}),g().op.update({pointer:l,path:[],args:S})]}else if("removeTableColumn"===n.command){var B;const{blockNode:e,columnIndex:t}=n,r={table:y().ev,id:D(e.attributes.id)},o=d(r);if(!o)return{error:new Error(`Block not found: ${e.attributes.id}.`)};if(o.type!==s().xd.table)return{error:new Error("Block is not of type table.")};const i=(null===(B=o.format)||void 0===B?void 0:B.table_block_column_order)||[],a=i[t];if(!a)return{error:new Error(`Invalid column index: ${t}.`)};const l=[...i.slice(0,t),...i.slice(t+1)];T=[g().op.update({pointer:r,path:["format"],args:{table_block_column_order:l}}),g().op.update({pointer:r,path:[],args:S}),...(o.content||[]).flatMap((e=>{const t={table:y().ev,id:e},n=d(t);return n&&n.type===s().xd.tableRow?[g().op.update({pointer:t,path:["properties"],args:{[a]:null}}),g().op.update({pointer:t,path:[],args:S})]:[]}))]}else if("setBlockParent"===n.command){const e={table:y().ev,id:n.parentId};let t;const r=d(e);r&&(t=n.collectionId?{table:v().Vl,id:n.collectionId,spaceId:p}:(0,f().j6)({table:y().ev,value:r})),T=[{pointer:{table:y().ev,id:D(n.blockNode.attributes.id)},command:"update",path:[],args:{...t?{parent_id:D(t.id),parent_table:t.table}:{parent_id:D(e.id),parent_table:e.table},alive:!0,...S}}]}else{if("addBlockToPage"===n.command){return{value:[{type:"latentOperation",latentOperation:{type:"addBlockToPage",assistantOperation:n,data:{spaceId:p,actorPointer:l}}}]}}(0,a().HB)(n)}}return{value:T.map((e=>({type:"operation",operation:e})))}}(e);if(i().Q.isFail(t))return t;return{value:t.value.map((e=>{if("operation"===e.type||"latentOperation"===e.type)return e;(0,a().HB)(e)}))}}function M(e){const{spaceViewId:t,shouldCreateUnknownBlock:n}=e;return{addBlockToPage:{target:"privatePages",spaceViewId:t},enforceDefaultInsertBehavior:!0,shouldRemoveBlocksFromParent:!1,shouldCreateUnknownBlock:n}}function C(e){const{shouldRemoveBlocksFromParent:t}=e;return{addBlockToPage:{spaceViewId:void 0,target:"unlistedPages"},enforceDefaultInsertBehavior:!0,shouldRemoveBlocksFromParent:t,shouldCreateUnknownBlock:!1}}function j(){return{addBlockToPage:{target:"privatePages",spaceViewId:void 0},enforceDefaultInsertBehavior:!0,shouldRemoveBlocksFromParent:!1,shouldCreateUnknownBlock:!0}}function A(){return{addBlockToPage:{target:"privatePages",spaceViewId:void 0},enforceDefaultInsertBehavior:!0,shouldRemoveBlocksFromParent:!0,shouldCreateUnknownBlock:!0}}function B(e,t,n){const r=[],o=new Map;for(const i of e){if("operation"===i.type){r.push(i.operation);continue}const{latentOperation:e}=i,{type:s}=e;if("addBlockToPage"===s){const{assistantOperation:n,data:o}=e,{spaceId:i,actorPointer:a}=o,{addBlockToPage:s}=t,l=[{type:"user_permission",role:"editor",user_id:a.id}];"unlistedPages"===s.target&&l.push({type:"space_permission",role:"editor",unlisted_timestamp:Date.now()});const d={pointer:{table:y().ev,id:D(n.blockNode.attributes.id)},command:"update",path:[],args:{permissions:l,parent_id:i,parent_table:b().NX,alive:!0}},{spaceViewId:c}=s,u=c&&{pointer:{table:x().mu,id:c},command:"listAfter",path:["private_pages"],args:{id:D(n.blockNode.attributes.id)}};u&&r.push(u),r.push(d)}else if("insertBlockAfter"===s){const{actorPointer:t}=e.data;r.push(...N(e.assistantOperation,{last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now()}))}else if("removeBlock"===s){const{actorPointer:n}=e.data;r.push(..._({assistantOperation:e.assistantOperation,updateMetadata:{last_edited_by_table:n.table,last_edited_by_id:n.id,last_edited_time:Date.now()},includeRemoveFromParent:t.shouldRemoveBlocksFromParent}))}else if("addUnknownBlockToPage"===s){const{operations:i,replacedBlockIdMap:a}=P({latentOperation:e,shouldCreateUnknownBlock:t.shouldCreateUnknownBlock,legacyNonCrdt:n});r.push(...i),a.forEach(((e,t)=>{o.set(t,e)}))}else(0,a().HB)(s)}return{operations:r,replacedBlockIdMap:o}}function _(e){const{assistantOperation:t,updateMetadata:n,includeRemoveFromParent:r}=e;return(r?[{pointer:{table:y().ev,id:D(t.parentId)},command:"listRemove",path:["content"],args:{id:D(t.removeBlockNode.attributes.id)}}]:[]).concat([g().op.update({pointer:{table:y().ev,id:D(t.parentId)},path:[],args:n}),{pointer:{table:y().ev,id:D(t.removeBlockNode.attributes.id)},command:"update",path:[],args:{parent_id:D(t.parentId),parent_table:y().ev,alive:!1,...n}}])}function N(e,t){return[{pointer:{table:y().ev,id:D(e.parentId)},command:"listAfter",path:["content"],args:{id:D(e.insertBlockNode.attributes.id),after:e.afterId?D(e.afterId):void 0}},g().op.update({pointer:{table:y().ev,id:D(e.parentId)},path:[],args:t}),{pointer:{table:y().ev,id:D(e.insertBlockNode.attributes.id)},command:"update",path:[],args:{parent_id:D(e.parentId),parent_table:y().ev,alive:!0,...t}}]}function P(e){const{latentOperation:t,shouldCreateUnknownBlock:n,legacyNonCrdt:r}=e,{spaceId:o,actorPointer:i}=t.data,a=Date.now(),{blockNode:s,copiedFromBlock:l}=t.assistantOperation,d=[],c=new Map;if(n){const e={table:y().ev,id:D(p().Dt()),spaceId:o};let t;if(s.parent&&(t={table:y().ev,id:D(s.parent.attributes.id),spaceId:o}),!o)throw new Error("Invalid spaceId.");const{operations:n}=m().zgg.assistantCreate({id:e.id,type:l.type,space_id:o,properties:l.getProperties(),content:l.getContentIds(),format:l.getFormat(),parentPointer:t,createdBy:i,lastEditedBy:i,created_time:a,legacyNonCrdt:r});d.push(...n);for(const r of l.getFileIds())d.push({pointer:e,command:"copyFile",path:[],args:{source:l.pointer,fileId:r}});c.set(l.id,e.id),t&&d.push({pointer:t,path:["content"],command:"listReplace",args:{id:l.pointer.id,newId:e.id}})}else if(o){const{operations:e}=m().zgg.assistantCreate({type:l.type,space_id:o,id:l.id,properties:l.getProperties(),content:l.getContentIds(),format:l.getFormat(),createdBy:{table:i.table,id:i.id,spaceId:o},lastEditedBy:{table:i.table,id:i.id,spaceId:o},parentPointer:s.parent&&{table:y().ev,id:D(s.parent.attributes.id),spaceId:o},legacyNonCrdt:r});d.push(...e)}return{operations:d,replacedBlockIdMap:c}}function R(e){const t=new Set;for(const n of e)"latentOperation"===n.type?"removeBlock"===n.latentOperation.type?t.add(n.latentOperation.assistantOperation.removeBlockNode.attributes.id):"insertBlockAfter"===n.latentOperation.type?t.add(n.latentOperation.assistantOperation.insertBlockNode.attributes.id):"addBlockToPage"===n.latentOperation.type||"addUnknownBlockToPage"===n.latentOperation.type?t.add(n.latentOperation.assistantOperation.blockNode.attributes.id):(0,a().HB)(n.latentOperation):"operation"===n.type?n.operation.pointer.table===y().ev&&t.add(n.operation.pointer.id):(0,a().HB)(n);return[...t]}async function E({assistantDatabaseQuery:e,spaceId:t,loadRecordModel:n}){const r={databaseId:D(e.databaseId),filter:e.filter,sorts:e.sorts,limit:e.limit},i={table:v().Vl,id:r.databaseId,spaceId:t},a=await n(i);if(!a)throw new Error("No collection");const s=a.getNormalizedSchema(),l=a.getParentPointer();if(l.table===v().Vl)throw new Error("Unsupported parent object for collection");const d={...l,spaceId:t};return{collectionViewBlockPointer:d,collectionPointer:{...i,spaceId:d.spaceId},filter:O({groupFilter:r.filter,schema:s}),sort:r.sorts.map((e=>{const t=Object.keys(s).find((t=>{var n;return(0,o().Ut)(t)&&(null===(n=s[t])||void 0===n?void 0:n.name)===e.propertyName}));if(!t)throw new Error(`Invalid property name: ${e.propertyName}.`);return{property:t,direction:e.direction}})),aggregation:F({collectionSchema:s,aggregationRequest:e.aggregation}),limit:Math.min(r.limit||k().qO,k().qO)}}function O(e){const{groupFilter:t,schema:n}=e;return{operator:{any:"or",all:"and"}[t.operator],filters:t.filters.map((e=>{const{operator:t}=e;return"any"===t||"all"===t?O({groupFilter:e,schema:n}):"is"===t||"contains"===t||">"===t||"<"===t||"â‰¥"===t||"â‰¤"===t||"is empty"===t?function(e){const{filter:t,schema:n}=e,{propertyTagName:r,operator:i,not:s,attributes:l,children:d,propertyName:c}=t,u=Object.keys(n).find((e=>{var t;return(0,o().Ut)(e)&&(null===(t=n[e])||void 0===t?void 0:t.name)===c}));if(!u)throw new Error(`Invalid property name: ${c}.`);if("property-title"===r||"property-text"===r||"property-url"===r||"property-email"===r||"property-phone-number"===r){const e={empty:s?"is_not_empty":"is_empty",is:s?"string_is_not":"string_is",contains:s?"string_does_not_contain":"string_contains"};return{property:u,filter:"is empty"!==i&&(0,a().EI)(d)?{operator:e[i],value:{type:"exact",value:d[0].value}}:{operator:e.empty}}}if("property-person"===r||"property-created-by"===r||"property-last-edited-by"===r){const e={empty:s?"is_not_empty":"is_empty",contains:s?"person_does_not_contain":"person_contains"};return{property:u,filter:(0,a().EI)(d)?{operator:e[i],value:d.filter((e=>"mention-person"===e.tagName)).map((e=>{const t=e.attributes["person-id"];return{type:"exact",value:{table:S().oo,id:t}}}))}:{operator:e.empty}}}if("property-relation"===r){const e={empty:s?"is_not_empty":"is_empty",contains:s?"relation_does_not_contain":"relation_contains"};return{property:u,filter:(0,a().EI)(d)?{operator:e[i],value:d.map((e=>({type:"exact",value:e.attributes["page-id"]})))}:{operator:e.empty}}}if("property-date"===r||"property-created-time"===r||"property-last-edited-time"===r){if("is"===i&&!0===s)throw new Error("Data filter does not support 'is not' operator");const e={empty:s?"is_not_empty":"is_empty",is:"date_is",">":s?"date_is_on_or_before":"date_is_after","<":s?"date_is_on_or_after":"date_is_before","â‰¥":s?"date_is_before":"date_is_on_or_after","â‰¤":s?"date_is_after":"date_is_on_or_before"};if("is empty"===i)return{property:u,filter:{operator:e.empty}};let t;const n=d[0];if("mention-date"!==n.tagName)throw new Error("Invalid mention date in filter. This should never happen");return t={type:"date",start_date:n.attributes.date},{property:u,filter:{operator:e[i],value:{type:"exact",value:t}}}}if("property-checkbox"===r)return{property:u,filter:{operator:{is:s?"checkbox_is_not":"checkbox_is"}[i],value:{type:"exact",value:{true:!0,false:!1}[l.checked]}}};if("property-select"===r){const e={empty:s?"is_not_empty":"is_empty",is:s?"enum_is_not":"enum_is"};return{property:u,filter:(0,a().EI)(d)?{operator:e[i],value:d.map((e=>({type:"exact",value:e.attributes.option})))}:{operator:e.empty}}}if("property-multi-select"===r){const e={empty:s?"is_not_empty":"is_empty",contains:s?"enum_does_not_contain":"enum_contains"};return{property:u,filter:(0,a().EI)(d)?{operator:e[i],value:d.map((e=>({type:"exact",value:e.attributes.option})))}:{operator:e.empty}}}if("property-status"===r){const e={empty:s?"is_not_empty":"is_empty",is:s?"status_is_not":"status_is"};return{property:u,filter:(0,a().EI)(d)?{operator:e[i],value:d.map((e=>"option-category"===e.tagName?{type:"is_group",value:e.attributes.category}:"option"===e.tagName?{type:"is_option",value:e.attributes.option}:(0,a().HB)(e)))}:{operator:e.empty}}}if("property-number"===r){const e={empty:s?"is_not_empty":"is_empty",is:s?"number_does_not_equal":"number_equals",">":s?"number_less_than_or_equal_to":"number_greater_than","<":s?"number_greater_than_or_equal_to":"number_less_than","â‰¥":s?"number_less_than":"number_greater_than_or_equal_to","â‰¤":s?"number_greater_than":"number_less_than_or_equal_to"};if("is empty"===i)return{property:u,filter:{operator:e.empty}};const t=n[u];if(!t||"number"!==t.type)throw new Error("Invalid property type");const r=h().$J(l.number);if("number"!=typeof r)throw new Error("Invalid number");const o={property:u,filter:{operator:e[i],value:{type:"exact",value:r}}};return!s||">"!==i&&"<"!==i&&"â‰¥"!==i&&"â‰¤"!==i?o:{operator:"or",filters:[o,{property:u,filter:{operator:"is_empty"}}]}}(0,a().HB)(r)}({filter:e,schema:n}):void(0,a().HB)(t)}))}}function F(e){const{collectionSchema:t,aggregationRequest:n}=e;if(!n)return;const r=Object.entries(t).find((([,e])=>e&&e.name===n.attributes.name));if(!r)return;const o=r[0];return"aggregation-property-status"===n.tagName?{property:o,aggregator:"Count per group"===n.attributes.aggregation||"Percent per group"===n.attributes.aggregation?{operator:w().sk[n.attributes.aggregation],groupName:n.attributes.group}:w().sk[n.attributes.aggregation]}:{property:o,aggregator:w().sk[n.attributes.aggregation]}}function D(e){return e.split("/")[0]}function q(e){return e}const L={checked:e=>({properties:{checked:"true"===e?d().h4:d().ZO}}),color:e=>{if(!e)return{};const t=w().BP[e];if(!t)throw new Error(`Unrecognized assistant color: ${e}`);return{format:{block_color:t}}},"synced-block-id":(e,{spaceId:t})=>e?{format:{transclusion_reference_pointer:{id:e,table:y().ev,spaceId:t}}}:{},"page-font":e=>({format:{page_font:e&&(0,n(284371).PE)(e)?e:void 0}}),"page-font-size":e=>({format:{page_small_text:"small"===e}}),"page-width":e=>({format:{page_full_width:"full-width"===e}}),language:(e,t)=>{if(!e||!(0,l().Ll)(e))return{};const n=l().nD[e];return{properties:{language:[[n]]},...t.isCreate&&(0,l().Ys)(n).customRender?{format:{code_preview_format:"code"}}:{}}},index:e=>{if(!e)return{};const t=parseInt(e);return Number.isInteger(t)?{format:{list_start_index:t}}:{}}}},696419:(e,t,n)=>{n.d(t,{x:()=>a});var r=()=>n(564884),o=()=>n(93723),i=()=>n(438632);function a(e){const{environment:t,from:n,...a}=e,{diffValue:s,metrics:l}=(0,i().hl)(a);return(0,r().u)({environment:t,event:{eventName:"diff_text_value_latency",eventProperties:{time:l.latencyMs,from:n,implementation:"sync",before_length:(0,o().P)(l.beforeLength),after_length:(0,o().P)(l.afterLength)}}}),s}},702473:(e,t,n)=>{n.d(t,{A:()=>o});class r extends(()=>n(757695))().Store{getInitialState(){return{open:!1}}}const o=new r},703778:(e,t,n)=>{n.r(t),n.d(t,{iconDefinition:()=>o,linkSmallIcon:()=>i});n(296540);var r=n(474848);const o={viewBox:"0 0 16 16",fittedViewBox:"1.87 1.87 12.19 12.19",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{d:"M12.848 2.8a3.145 3.145 0 0 0-4.448 0L6.918 4.283a.625.625 0 0 0 .884.883l1.482-1.482c.74-.74 1.94-.74 2.68 0l.294.294c.74.74.74 1.94 0 2.68l-1.482 1.483a.625.625 0 1 0 .884.884l1.482-1.482a3.145 3.145 0 0 0 0-4.449z"}),(0,r.jsx)("path",{d:"M10.472 5.47a.625.625 0 0 0-.884 0L5.229 9.83a.625.625 0 1 0 .884.883l4.359-4.359a.625.625 0 0 0 0-.883"}),(0,r.jsx)("path",{d:"M5.167 6.918a.625.625 0 0 0-.884 0L2.8 8.4a3.146 3.146 0 0 0 0 4.448l.294.294a3.145 3.145 0 0 0 4.449 0l1.482-1.482a.625.625 0 0 0-.884-.884L6.66 12.258c-.74.74-1.94.74-2.68 0l-.295-.294c-.74-.74-.74-1.94 0-2.68L5.167 7.8a.625.625 0 0 0 0-.883"})]})},i=(0,n(340498).wt)("linkSmall",o,"small")},706965:(e,t,n)=>{n.d(t,{A:()=>f});n(296540);var r=()=>n(230711),o=()=>n(590526),i=()=>n(764880),a=()=>n(310442),s=()=>n(824862),l=()=>n(798880),d=()=>n(69708),c=()=>n(100622),u=()=>n(534177),p=()=>n(284371),m=()=>n(815585),h=()=>n(43972),g=n(474848);function f(e){const{store:t}=e,n=(0,d().tz)(),f=(0,o().K8)((()=>t.getCreatedTime()),[t]),y=(0,o().K8)((()=>t.getLastEditedTime()),[t]),v=(0,o().K8)((()=>{const e=t.getCreatedByPointer();if(e)return(0,i().xC)({pointer:e,getRecordValue:t.getRecordValue})}),[t]),b=(0,o().K8)((()=>{const e=t.getLastEditedByPointer();if(e)return(0,i().xC)({pointer:e,getRecordValue:t.getRecordValue})}),[t]),x=(0,o().K8)((()=>{const e=t.getSpaceStore();if(!e)return!1;const n=null==v?void 0:v.asActor;if(!n)return!1;const o=n.table;switch(o){case l().oo:return(0,r().dp)(e,n.id).isMember();case s().GP:return(0,r().Ts)(e,n.id).isMember();case a().yj:return!1;default:(0,u().HB)(o)}}),[t,v]),S=f?(0,m().nl)(f,{useCompactFormat:!0,useLowercase:!0}):"",w=y?(0,m().nl)(y,{useLowercase:!0,useCompactFormat:!0}):"";if(!(y?(0,m().nl)(y,{useLowercase:!0,useCompactFormat:!0,roundDownYears:!0}):""))return null;const I={display:"flex",gap:4,color:c().Tj.text.inverseSecondary,height:16,fontSize:12},k={size:14,style:{marginInlineEnd:2}};return(0,g.jsxs)(g.Fragment,{children:[(e=>{let t;if(null!=b&&b.asActor)t=(0,g.jsx)(d().sA,{defaultMessage:"Edited by {editor} {timestamp}",id:"pagePropertiesHeader.editedBy.label",values:{editor:(0,g.jsx)("span",{style:{fontWeight:p().Wy.medium,color:c().Tj.text.inversePrimary},children:(0,g.jsxs)("span",{style:{display:"flex"},children:[e?void 0:(0,h().w)({actor:b,...k}),(0,i().lR)(n,b)]})}),timestamp:w}});else{if(!w)return;r=w,t=(0,g.jsx)(d().sA,{defaultMessage:"Edited {timestamp}",id:"pagePropertiesHeader.edited.label",values:{timestamp:r}})}var r;return(0,g.jsx)("div",{style:{...I,marginTop:3,marginBottom:3},children:t})})(e.compactFormat),(e=>{let t;if(null!=v&&v.asActor&&x)t=(0,g.jsx)(d().sA,{id:"pagePropertiesHeader.createdBy.label",defaultMessage:"Created by {creator} {timestamp}",values:{creator:(0,g.jsx)("span",{style:{fontWeight:p().Wy.medium,color:c().Tj.text.inversePrimary},children:(0,g.jsxs)("span",{style:{display:"flex"},children:[e?void 0:(0,h().w)({actor:v,...k}),(0,i().lR)(n,v)]})}),timestamp:S}});else{if(!S)return;t=(0,g.jsx)(d().sA,{id:"pagePropertiesHeader.created.label",defaultMessage:"Created {timestamp}",values:{timestamp:S}})}return(0,g.jsx)("div",{style:{...I,marginBottom:4},children:t})})(e.compactFormat)]})}},715011:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(296540),o=()=>n(69708),i=()=>n(409268),a=n(474848);function s(e){const t=(0,r.useMemo)((()=>(0,i().s)(e.store)),[e.store]);return(0,a.jsx)(o().sA,{id:"pageWordCount.wordCount",defaultMessage:"{count, plural, one {# word} other {# words}}",values:{count:t}})}},742382:(e,t,n)=>{n.d(t,{E:()=>I});n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(354520),n(581454),n(296540);var r=()=>n(907258),o=()=>n(726637),i=()=>n(484714),a=()=>n(590526),s=()=>n(295633),l=()=>n(784892),d=()=>n(177148),c=()=>n(179034),u=()=>n(69708),p=()=>n(187820),m=()=>n(305390),h=()=>n(16006),g=()=>n(297401),f=()=>n(881690),y=()=>n(825972),v=()=>n(106628),b=()=>n(322976),x=n(474848);const S={token:{display:"flex",alignItems:"center"},icon:{marginInlineEnd:4}},w=(0,u().YK)({searchPages:{defaultMessage:"Search pages",id:"searchPageFilter.searchTokenFilter.tokenInput.placeholder"}});function I({mode:e,title:t,blockIds:n,onChange:o,disabled:a,focused:s,peopleBlocksToInclude:l,onMenuDismiss:c,onMenuOpen:p,parentStore:m}){const h=(0,u().tz)(),g=(0,i().v3)();return(0,x.jsx)(b().A,{mode:e,hasItemsSelected:(null==n?void 0:n.length)>0,title:t,icon:d().Y,items:n,onChange:o,focused:s,renderFilter:(e,t)=>(0,x.jsx)(j,{item:e,args:t,parentStore:m}),renderToken:(e,t)=>(0,x.jsx)(M,{item:e,handlers:t,blockIds:n,parentStore:m}),renderItemForSummary:e=>(0,x.jsx)(T,{item:e,parentStore:m}),addItemLabel:(0,x.jsx)(u().sA,{defaultMessage:"Add another page",id:"searchPageFilter.searchTokenFilter.addAPage.button"}),labelText:{title:t,tokenInputPlaceholder:h.formatMessage(w.searchPages),componentDebugName:"SearchPageFilter"},performRequest:({query:e,current:t})=>async function(e,t){const{query:n,current:o,peopleBlocksToInclude:i}=e,{sidebarSpaceStore:a}=r().default.state;if(!a)return[];const s=await v().T.searchActions.load(),l=n?(await s.searchPageIds({environment:t,query:n,limit:20,spaceId:a.id,requireEditPermissions:!1,excludeTemplates:!1,source:"ancestor_filter_page_search",boostRecentlyViewedPages:!0,spaceStore:a,peopleBlocksToInclude:i})).results:y().NK.state.map((e=>e.pageId)),d=new Set(o);return l.filter((e=>!d.has(e)))}({query:e,current:t,peopleBlocksToInclude:l},g),renderResultMenuItem:(e,t)=>(0,x.jsx)(C,{item:e,props:t,parentStore:m}),disabled:a,onMenuDismiss:c,onMenuOpen:p})}function k(e,t){return s().B.createChildStore(t,{table:c().ev,id:e})}function T({item:e,parentStore:t}){const n=k(e,t);return(0,x.jsx)(h().A,{store:n,shouldWrap:!0,maxLength:50})}function M({item:e,handlers:t,blockIds:n,parentStore:r}){const i=S,s=1===n.length,d=k(e,r),c=(0,a().K8)((()=>d.getIcon()),[d]),u=(0,a().K8)((()=>(0,p().Te)(d)),[d]),m=(0,x.jsxs)("div",{style:i.token,children:[(0,x.jsx)(p().B6,{disabled:!0,icon:c,iconRecordCategory:u,isEmptyPage:!1,size:20,style:i.icon}),(0,x.jsx)(h().A,{store:d})]});return(0,x.jsx)(f().A,{format:o().A.isMobile?l().NY.Large:l().NY.Small,value:m,showRemoveButton:!0,onClickRemove:t.onRemove,isSingle:s,shouldShrink:!0,backgroundColor:"transparent",shouldWrap:!1})}function C({item:e,props:t,parentStore:n}){const r=(0,a().K8)((()=>k(e,n)),[e,n]);return(0,x.jsx)(m().A,{...t,store:r})}function j({item:e,args:t,parentStore:n}){const{disabled:r,onRemove:i,onClick:a}=t,s={menuItem:{minHeight:void 0,paddingTop:o().A.isMobile?12:4,paddingBottom:o().A.isMobile?12:4},menuItemTitle:{width:"100%"},labeledMenuItemTitle:{display:"inline-flex",alignItems:"center"},menuItemLabel:{marginInlineEnd:12}},l=k(e,n),d=(0,x.jsx)(g().A,{disabled:r,onClick:i});return(0,x.jsx)(m().A,{disabled:r,focused:!1,store:l,right:d,style:s.menuItem,desktopTitleStyle:s.menuItemTitle,onClick:a})}},756790:(e,t,n)=>{n.d(t,{p:()=>i});var r=()=>n(907258),o=()=>n(313127);function i(){var e,t,n,i,a,s,l,d,c,u,p,m,h,g;const{sidebarSpaceStore:f,sidebarSpaceViewStore:y}=r().default.state,v=null==f?void 0:f.getSpaceSurveyData(),b=null==y?void 0:y.getUserSurveyData();return{function:null!=b&&null!==(e=b.function)&&void 0!==e&&e.value?(0,o().Tj)(null==b||null===(t=b.function)||void 0===t?void 0:t.value):void 0,role:null!=b&&null!==(n=b.role)&&void 0!==n&&n.value?(0,o().t_)(null==b||null===(i=b.role)||void 0===i?void 0:i.value):void 0,educationRole:null==b||null===(a=b.education_role)||void 0===a?void 0:a.value,educationLevel:null==b||null===(s=b.education_level)||void 0===s?void 0:s.value,useCases:null!=v&&null!==(l=v.use_cases)&&void 0!==l&&l.value?(0,o().h0)(null==v||null===(d=v.use_cases)||void 0===d?void 0:d.value):void 0,companySize:null!=v&&null!==(c=v.company_size)&&void 0!==c&&c.value?(0,o().JE)(null==v||null===(u=v.company_size)||void 0===u?void 0:u.value):void 0,intent:null!=v&&null!==(p=v.intent)&&void 0!==p&&p.value?(0,o().j9)(null==v||null===(m=v.intent)||void 0===m?void 0:m.value):void 0,categories:null==b||null===(h=b.categories)||void 0===h?void 0:h.value,collaborativeIntent:null==v||null===(g=v.collaborative_intent)||void 0===g?void 0:g.value}}},770979:(e,t,n)=>{n.d(t,{A:()=>v});n(296540);var r=()=>n(590526),o=()=>n(552712),i=()=>n(245241),a=()=>n(69708),s=()=>n(100622),l=()=>n(726637),d=()=>n(284371),c=()=>n(115512),u=n(474848);const p=function(e){const{style:t,captionStyle:r,title:o,caption:i}=e,a=g(),s={...a.menuItem,...t},l={...a.caption,...r};return(0,u.jsx)(n(424400).Ay,{...e,title:(0,u.jsx)(f,{title:o}),caption:(0,u.jsx)(h,{caption:i,captionStyle:l}),textWrapperStyle:g().text,style:s,captionStyle:l})};function m(){return{title:{color:s().Tj.text.secondary},caption:{color:s().Tj.text.tertiary}}}function h({captionStyle:e,caption:t}){if(!t)return null;const n={...e,...m().caption};return(0,u.jsx)("div",{style:n,children:t})}function g(){return{menuItem:{minHeight:void 0,...l().A.isMobile&&{background:void 0,boxShadow:void 0},paddingTop:32,paddingBottom:32},text:{textAlign:"center"},title:{margin:0,fontWeight:d().Wy.medium,fontSize:c().vQ,lineHeight:c().G6},caption:{fontSize:c().vQ}}}function f({title:e}){if(!e)return null;const t=g(),n=m(),r={...t.title,...n.title};return(0,u.jsx)("div",{role:"alert",style:r,children:e})}const y=(0,u.jsx)(a().sA,{defaultMessage:"No results",id:"searchErrorMenuItem.error.noResults"});const v=function(e){const t=(0,n(401497).IS)((()=>({menuItem:{marginTop:"auto",marginBottom:"auto"},caption:{marginTop:"auto"},reportProblemButton:{display:"inline",color:s().Tj.blue.text.accentPrimary},searchDeletedButton:{display:"inline",lineHeight:"25px",color:s().Tj.blue.text.accentPrimary}})),[]),l=(0,n(484714).v3)(),d=(0,r().K8)((()=>(0,n(466088).w)(l)),[l]),c=(0,r().K8)((()=>(0,n(87573).q)(l)),[l]),m=()=>{n(994877).SI({environment:l,from:"quick_find"})};function h(r,i){const s=function(r,i){if(r||i)return;const s=(0,n(656894).J)(g);if(!n(557504).z.isDeletedOnly(g.isDeletedOnly))return(0,u.jsx)(a().sA,{id:"searchErrorMenuItem.errorPrompt.searchDeleted",defaultMessage:"Some results may be in your deleted pages.{br}<searchdeleted>Search deleted pages</searchdeleted>",values:{searchdeleted:n=>(0,u.jsx)(o().N,{onClick:e.handleSearchDeletedOnly,style:t.searchDeletedButton,children:n}),br:(0,u.jsx)("br",{})}});return s?(0,u.jsx)(a().sA,{defaultMessage:"Try different search terms or filters",id:"searchErrorMenuItem.errorPrompt.searchTermsAndFilters"}):(0,u.jsx)(a().sA,{defaultMessage:"Try different search terms",id:"searchErrorMenuItem.errorPrompt.searchTerms"})}(r,i);return{title:y,caption:s}}const g=(0,r().K8)((()=>n(287234).Ay.state.query.filters),[]);return(0,u.jsx)(p,{...function(r,s){const l=e.error;switch(l.type){case i().yq.NoResults.type:return h(r,s);case i().yq.Offline.type:return function(){const e=(0,u.jsx)(a().sA,{defaultMessage:"Go online for more results.",id:"searchErrorMenuItem.errorPrompt.goOnline"});return{title:y,caption:e}}();case i().yq.RequestFailed.type:return{title:(0,u.jsx)(a().sA,{id:"searchErrorMenuItem.error.genericErrorMessage",defaultMessage:"Something went wrong"}),caption:(0,u.jsx)(a().sA,{id:"searchErrorMenuItem.errorPrompt.refreshOrReport",defaultMessage:"Try refreshing or <reportlink>report a problem</reportlink>.",values:{reportlink:e=>(0,u.jsx)(o().N,{onClick:m,style:t.reportProblemButton,children:e})}})};default:(0,n(534177).HB)(l)}}(c??!1,d),style:t.menuItem,captionStyle:t.caption,shouldWrapCaption:!0})}},794545:(e,t,n)=>{n.d(t,{CU:()=>N,Kr:()=>P,eD:()=>D});n(944114),n(898992),n(823215),n(354520),n(581454),n(737550);var r=n(296540),o=()=>n(726637),i=()=>n(590526),a=()=>n(401497),s=()=>n(396896),l=()=>n(807449),d=()=>n(493552),c=()=>n(798880),u=()=>n(536504),p=()=>n(69708),m=()=>n(100622),h=()=>n(284371),g=()=>n(187820),f=()=>n(128295),y=()=>n(126126),v=()=>n(751380);n(803949);class b extends(()=>n(757695))().Store{getInitialState(){return{pageIdToUsers:{},similarUserIdToLastVisitedPageId:{}}}getPageIdToActiveSimilarUsersCount(){const e={};for(const[t,r]of(0,n(534177).WP)(this.state.pageIdToUsers))e[t]=(null==r?void 0:r.length)??0;return e}}const x=new b;const S=6e4;function w(e){return Date.now()-e.timestamp>=e.numberOfMinutes*S}var I=()=>n(461131),k=()=>n(933593),T=()=>n(245241),M=()=>n(629604),C=n(474848);function j(e){const{data:t}=e,n=(0,i().K8)((()=>I().Ay.state.autoExpandDebugInfo),[]),r=(0,a().IS)((()=>({debugPanel:{padding:5,border:`1px solid ${m().Tj.border.secondary}`,marginTop:8,borderRadius:4}})),[]);return(0,C.jsx)("div",{style:r.debugPanel,onMouseDown:e=>{e.stopPropagation()},role:"presentation",children:(0,C.jsx)(M().H,{data:t,defaultCollapsed:!n,showCopyButton:!0,showModalButton:!1})})}function A(e){const{result:t,debugHits:n}=e,o=(0,r.useMemo)((()=>{var e;return(null===(e=t.sources)||void 0===e?void 0:e.includes(T().Ni.Local))??!1}),[t.sources]),i=(0,r.useMemo)((()=>{const e={};n&&n.length>0&&(e.debugHits=n);t.rankingSignals&&Object.keys(t.rankingSignals).length>0&&(e.rankingSignals=t.rankingSignals),o&&(e.debugLocal={id:t.id,localSource:t.localSource,score:t.score,localRelevancies:t.localRelevancies,frecencyScore:t.frecencyScore,personalizationBoost:t.personalizationBoost,terms:t.terms});return Array.isArray(t.featureGroups)&&t.featureGroups.length>0&&(e.featureGroups=t.featureGroups),Object.keys(e).length>0?e:null}),[t,n,o]);return i?(0,C.jsx)(j,{data:i}):null}n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698);var B=()=>n(993273);function _(e){const{badges:t,store:o,highlight:d,recordPathCaption:c,isRecentsView:u,isAgentResult:p,isCollection:g}=e,f=(0,a().IS)((()=>({divider:{color:m().Tj.text.secondary,fontSize:12},title:{fontWeight:h().Wy.medium,color:u?m().Tj.text.primary:m().Tj.text.secondary},titleHighlight:{color:m().Tj.text.primary}})),[u]);let y=null==d?void 0:d.title;!p&&null!=d&&d.title||(y=null==d?void 0:d.text);const b=(0,v().PO)({words:(0,v().oQ)(y),highlightText:(null==d?void 0:d.title)??(null==d?void 0:d.text),styleOverride:f.titleHighlight}),x=(0,i().K8)((()=>o.isReady()),[o]),S=(0,i().K8)((()=>{if(x)return p?(0,C.jsx)("span",{style:null==b?void 0:b.style,children:null==d?void 0:d.title}):(0,C.jsx)(n(16006).A,{store:o,style:f.title,highlighter:b})}),[o,b,f.title,x,d,p]),w=(0,r.useMemo)((()=>new Set(t.map((e=>e.type)))),[t]);return(0,C.jsxs)(s().fI,{gap:4,alignItems:"center",children:[S,g||w.has("is_collection")?(0,C.jsx)(B().se,{}):void 0,w.has("verified")?(0,C.jsx)(l().I,{icon:n(417104).badgeCheckFillSmallIcon,size:"sm",colorPalette:"blue",colorVariant:"accentPrimary"}):void 0,w.has("archived")?(0,C.jsx)(l().I,{icon:n(483034).archiveBoxFillSmallIcon,size:"sm",colorPalette:"gray",colorVariant:"secondary"}):void 0,w.has("current_page")?(0,C.jsx)(B().FN,{}):void 0,w.has("is_template")?(0,C.jsx)(B().rx,{}):void 0,w.has("popular_this_week")?(0,C.jsx)(B().oj,{}):void 0,w.has("most_viewed")?(0,C.jsx)(B().iY,{}):void 0,w.has("agent")?(0,C.jsx)(B().Kg,{}):void 0,c?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("span",{style:f.divider,children:"â€”"}),c]}):void 0]})}const N={padding:"4px 8px"},P=r.memo(r.forwardRef((function(e,t){const{focused:y,currentView:v,result:b,queryId:S,analytics:T,debugHits:M}=e,{highlight:j,store:A}=b,B=(0,p().tz)(),N=(0,n(484714).v3)();(0,n(852507).w)((()=>{var e,t;"results"===v&&(null==T||null===(e=T.setResultRenderTime)||void 0===e||e.call(T,b.id),(0,k().Rp)(b)&&(null==T||null===(t=T.endTimeToRenderServerResultsTiming)||void 0===t||t.call(T)));A.load(),n(106628).T.customAgentSearchService.load().then((({initializeWorkflowDataCache:e})=>e(N)))}));const P=(0,i().K8)((()=>(0,n(968913).Wi)(N,A.id)),[N,A]),L=(0,i().K8)((()=>"two_pane_1_snippet"===n(242422).default.getEligibleGroup({experimentId:"search_highlight_client_variant",defaultGroup:"inline_2_snippets"})),[]),K=(0,a().IS)((()=>({divider:{color:m().Tj.text.tertiary},pathHighlight:{color:L?m().Tj.blue.text.accentPrimary:m().Tj.text.primary,fontWeight:h().Wy.medium},pathText:{color:m().Tj.text.tertiary}})),[L]),z=(0,i().K8)((()=>A.isReady()),[A]),V=(0,i().K8)((()=>!!z&&A.isEmptyPage()),[A,z]),U=b.workflowData,H=void 0!==U,W=(0,i().K8)((()=>z?(0,g().Te)(A):void 0),[A,z]),$=(0,i().K8)((()=>A.getIcon()),[A]),G=(0,i().K8)((()=>{if(null!=U&&U.icon)return U.icon;const e=(0,u().Oy)({baseUrl:o().A.domainBaseUrl||"",shape:u().WJ,color:u().i});return(0,u().Hy)(e)}),[U]),Q=(0,r.useMemo)((()=>H?(0,C.jsx)(g().B6,{disabled:!0,icon:{pointer:A.pointer,icon:G},iconRecordCategory:"workflow",isEmptyPage:!0,size:20}):(0,C.jsx)(g().B6,{disabled:!0,icon:$,iconRecordCategory:W??"pageBlock",isEmptyPage:V,size:20})),[H,A.pointer,G,$,W,V]),Y=(0,i().K8)((()=>{if(void 0!==e.captionOverride)return(0,C.jsx)(d().D,{colorPalette:"gray",colorVariant:"secondary",styleKey:"captionRegular",children:e.captionOverride});if(H)return(0,C.jsx)(d().D,{colorPalette:"gray",colorVariant:"secondary",styleKey:"captionRegular",children:null==j?void 0:j.pathText});return(0,f().a6)(A)?(0,C.jsx)(R,{store:A,pathHighlight:null==j?void 0:j.pathText,styles:K}):void 0}),[e.captionOverride,A,null==j?void 0:j.pathText,K,H]),Z=(0,i().K8)((()=>A.id),[A]),X=(0,i().O$)(n(907258).AppStoreSidebarSpaceStore),J=(0,i().K8)((()=>x.state.similarUserIdToLastVisitedPageId),[]),ee=(0,r.useCallback)((e=>function(e){return!w({timestamp:e.timestamp,numberOfMinutes:2})}({timestamp:e.visitedAt})&&J[e.userId]===Z),[J,Z]),te=(0,i().K8)((()=>x.state.pageIdToUsers[Z]??[]),[Z]),ne=(0,i().K8)((()=>function(e){const{spaceStore:t,similarUsers:r,isUserPresentOnPage:o}=e,i=4;if(!t)return[];const a=[...r].sort(((e,t)=>{const n=o({userId:e.userId,visitedAt:e.visitedAt});return n!==o({userId:t.userId,visitedAt:t.visitedAt})?n?-1:1:t.visitedAt-e.visitedAt})).slice(0,i);return a.map((e=>{const r=n(849255).L.createChildStore(t,{table:c().oo,id:e.userId});return r.load(),{store:r,visitedAt:e.visitedAt,isPresent:o({userId:e.userId,visitedAt:e.visitedAt})}}))}({spaceStore:X,similarUsers:te,isUserPresentOnPage:ee})),[ee,te,X]),re=(0,i().K8)((()=>ne.every((e=>e.store.isReady()))),[ne]),oe=(0,r.useMemo)((()=>{if(!re)return null;const e=ne.length;return(0,C.jsx)("div",{style:{display:"flex"},children:ne.map((({store:t,visitedAt:n,isPresent:r},o)=>(0,C.jsx)("span",{style:{zIndex:e-o},children:(0,C.jsx)(O,{userStore:t,isPresent:r})},`search-user-presence-${t.id}-${Z}-${n}`)))})}),[re,Z,ne]),ie=(0,i().K8)((()=>"everything"===I().Ay.state.debug||I().Ay.state.showDebugInfo),[]),ae="recents"===v,se=(0,a().IS)((()=>D({view:v,focused:y})),[v,y]),le=ie&&"results"===v,de=(0,r.useMemo)((()=>void 0!==e.rightOverride?e.rightOverride:(0,C.jsxs)(s().fI,{gap:12,alignItems:"center",children:[oe,(0,C.jsx)("div",{"data-search-icon-target":"true",children:le?(0,C.jsx)(k().wS,{result:b}):(0,C.jsx)("span",{style:se.enterIconStyle,children:(0,C.jsx)(l().I,{icon:n(40457).arrowTurnDownLeftSmallIcon,size:"xs",colorVariant:"secondary"})})})]})),[e.rightOverride,oe,le,b,se.enterIconStyle]),ce=(0,i().K8)((()=>!ae&&(A.isType("link_to_collection")||A.isType("collection_view_page")||A.isType("collection_view"))),[ae,A]),ue=(0,i().K8)((()=>{const{isSurrogateCollection:e,collectionId:t}=b??{};return e&&t?n(732810).m.createChildStore(A,{table:n(519831).Vl,id:t}):void 0}),[b,A]),pe=(0,i().K8)((()=>(0,k().yD)({result:b,queryId:S})),[b,S]),me=ae||!b.highlight&&!ie,he=(0,i().K8)((()=>{const e=null==X?void 0:X.getModel();if(!e||!(0,n(470020).X)(e))return"none";return(0,n(470928).i1)(A).type}),[A,X]),ge=(0,i().K8)((()=>{const e=(0,n(288782).s)();return void 0!==e&&e===b.id}),[b.id]),fe=(0,r.useMemo)((()=>{const e=b.badges??[];for(const t of["verified","archived"])he!==t||e.some((e=>e.type===t))||e.push({type:t,properties:{},label:""});return ge&&e.push({type:"current_page",properties:{},label:""}),e}),[b.badges,he,ge]),ye=(0,r.useMemo)((()=>(0,C.jsx)(n(81068).A,{disabled:P,disabledFeedback:P,style:se.outerStyle,...e,onMouseDown:e.preventClickDefault?e=>e.preventDefault():void 0,ref:t,buttonStyle:se.buttonStyle,title:ue?(0,C.jsx)(n(301879).G,{collectionStore:ue,hideCollectionViewBlockIcon:!0}):(0,C.jsx)(_,{badges:fe,store:A,highlight:j,recordPathCaption:ae&&Y?Y:void 0,isRecentsView:ae,isAgentResult:H,isCollection:ce}),caption:ae?void 0:(0,C.jsx)(E,{store:A,intl:B,pathDisplay:Y,styles:K}),body:me?void 0:(0,C.jsx)(F,{workflowData:U,isDebugEnabled:ie,debugHits:M,result:b}),icon:Q,right:de,className:`notranslate ${n(882722).LF7}`})),[P,se,ae,e,t,ue,A,j,Y,H,ce,B,K,me,U,ie,M,Q,de,b,fe]),ve=N.device.isElectron,be=(0,r.useCallback)((async()=>{if(!ve||!pe)return;(await(0,n(212497).jd)())({environment:N,stringValue:pe,copiedMessage:q.copiedLinkToClipboard})}),[N,pe,ve]),xe=(0,r.useCallback)((e=>{e.preventDefault(),e.stopPropagation()}),[]);return pe?(0,C.jsx)(n(782482).N,{capture:e.focused,debugName:"Search2SearchResults",onCopyLinkToCurrentPage:e=>{be()},onCopyLinkToPageInCommandSearch:e=>{be()},children:(0,C.jsx)(n(620896).A,{href:pe,onClick:xe,children:ye},pe)}):ye})));function R(e){const{store:t,pathHighlight:n,styles:r}=e,o=(0,v().PO)({words:(0,v().oQ)(n),highlightText:n,styleOverride:r.pathHighlight});return(0,C.jsx)(f().Ay,{store:t,showFullPathInTooltip:!0,highlighter:o})}function E(e){const{store:t,intl:o,pathDisplay:a,styles:l}=e,d=(0,i().K8)((()=>(0,n(381684).b)({store:t,intl:o})),[t,o]),c=[a,(0,i().K8)((()=>{if(null==d||!d.canAccess)return;const e=(0,n(764880).lR)(o,d.createdBy);return(0,C.jsx)("span",{style:l.pathText,children:e})}),[d,l.pathText,o]),(0,i().K8)((()=>{const e=t.getLastEditedTime();if(e)return(0,C.jsx)("span",{style:l.pathText,children:o.formatMessage(q.lastEdited,{time:(0,n(815585).nl)(e,{useCompactFormat:!0})})})}),[o,t,l.pathText])].filter(Boolean);return(0,C.jsx)(s().fI,{gap:4,children:c.map(((e,t)=>(0,C.jsxs)(r.Fragment,{children:[t>0?(0,C.jsx)("span",{style:l.pathText,children:"â€¢"}):void 0,e]},t)))})}function O(e){const{userStore:t,isPresent:r}=e,o=(0,p().tz)(),s=(0,y().XE)((e=>(0,m().Nq)(t.id,e)),r),{name:l,email:d}=(0,i().K8)((()=>({name:(0,n(695608).c6)(o,t.getModel()),email:t.getEmail()})),[o,t]),c=(0,a().IS)((()=>({avatarOuterOutline:{...s.avatarOuterOutline,outlineColor:r?s.avatarOuterOutline.outlineColor:m().Tj.palette.gray[100]}})),[r,s.avatarOuterOutline]);return(0,C.jsx)(n(26697).m,{textWrap:!0,renderTooltip:()=>(0,C.jsxs)("div",{children:[(0,C.jsx)("div",{children:l}),(0,C.jsx)("div",{children:d})]}),render:e=>(0,C.jsx)("div",{style:c.avatarOuterOutline,...e,children:(0,C.jsx)("div",{style:s.avatarBorder,children:(0,C.jsx)(n(453697).A,{iconStyle:s.avatarInnerOutline,style:s.uiUserAvatarStyles,size:y().eQ,isOffline:!r,userStore:t,avatarShouldShowShadow:!0,initialOverrideStyle:s.initialColor})})})})}function F(e){const{workflowData:t,isDebugEnabled:n,debugHits:r,result:o}=e;return null!=t&&t.description?(0,C.jsx)("span",{children:t.description}):(0,C.jsxs)(C.Fragment,{children:[n?(0,C.jsx)(A,{result:o,debugHits:r}):null,(0,C.jsx)(k().Sh,{result:o})]})}function D(e){const{view:t,focused:n}=e,r="recents"===t;return{outerStyle:{paddingInlineStart:4,paddingBottom:o().A.isMobile?10:void 0,paddingTop:o().A.isMobile?10:void 0,alignItems:r?"center":void 0,...!r&&{minHeight:36}},buttonStyle:r?N:{padding:8},enterIconStyle:{width:12,height:12,color:m().Tj.text.secondary,visibility:n?"visible":"hidden"}}}const q=(0,p().YK)({lastEdited:{id:"search2.lastEdited",defaultMessage:"Edited {time}"},copiedLinkToClipboard:{id:"search2.copiedLinkToClipboard",defaultMessage:"Copied result link to clipboard"}})},795783:(e,t,n)=>{n.d(t,{J:()=>p});n(296540);var r=()=>n(726637),o=()=>n(807449),i=()=>n(100622),a=()=>n(56394),s=()=>n(574036),l=()=>n(976361),d=()=>n(385226),c=()=>n(322976),u=n(474848);function p({title:e,value:t,disabled:n,icon:o,style:i,onChange:a,focused:s,mode:l}){return r().A.isMobile?(0,u.jsx)(y,{title:e,value:t,disabled:n,icon:o,style:i,onChange:a,focused:s,mode:l}):(0,u.jsx)(f,{title:e,icon:o,value:t,style:i,onChange:a,focused:s,mode:l})}function m(e,t){t(!e)}function h(){return{menuItem:{minHeight:void 0,paddingTop:r().A.isMobile?12:4,paddingBottom:r().A.isMobile?12:4},icon:{height:14,width:14,fill:"currentColor"},sectionMenuItem:{display:"flex"}}}function g({mode:e,title:t,icon:n,value:r,style:l,onChange:d,focused:p}){const g=h(),f={menuItem:{color:i().Tj.text.secondary}},y={...g.menuItem,...f.menuItem,...l};return e===c().C.Pill?(0,u.jsx)(a().A,{on:r,hideChevron:!0,title:(0,u.jsx)("span",{children:t}),onClick:()=>m(r,d),icon:(0,u.jsx)(o().I,{icon:n,fitToViewBox:"horizontal"})}):(0,u.jsx)(s().A,{title:t,icon:n(g.icon),on:r,onClick:()=>m(r,d),style:y,focused:p})}function f({mode:e,title:t,icon:n,value:r,style:o,onChange:i,focused:a}){return(0,u.jsx)(d().A,{marginAfter:!1,style:h().sectionMenuItem,children:(0,u.jsx)(g,{title:t,icon:n,value:r,style:o,onChange:i,mode:e,focused:a})})}function y({mode:e,title:t,value:n,disabled:r,icon:o,style:i,onChange:a,focused:s}){return e===c().C.Button?(0,u.jsx)(g,{title:t,icon:o,value:n,style:i,onChange:a,mode:e,focused:s}):(0,u.jsx)(l().A,{disabled:r,onClick:()=>m(n,a),label:t,isToggle:!0,isToggleActive:n})}},817443:(e,t,n)=>{n.d(t,{L:()=>o});var r=()=>n(44551);function o(){var e;null===r().electronApi||void 0===r().electronApi||null===(e=r().electronApi.quickSearchRenderCompleted)||void 0===e||e.call(r().electronApi)}},834474:(e,t,n)=>{n.d(t,{O:()=>s});n(296540);var r=()=>n(590526),o=()=>n(663929),i=()=>n(604018),a=n(474848);function s(e){const{marginLeftOverride:t}=e,n=(0,r().K8)((()=>{const e=(0,i().wd)();return 0===e.length?["notion",...(0,i().kB)()]:["notion",...e]}),[]);return(0,a.jsx)("div",{style:{display:"flex",paddingTop:2,paddingBottom:2,marginInlineStart:t??8},children:(0,a.jsx)(o().hC,{connectors:n,maxBubbles:3,iconSize:12})})}},837073:(e,t,n)=>{n.d(t,{E:()=>o});n(898992),n(737550);var r=()=>n(850913);function o({query:e,filters:t}){return e.trim().length>0||void 0!==t&&function(e){const t=(0,r().u)(e),{navigableBlockContentOnly:n,...o}=t;return Object.values(o).some((e=>Boolean(e)))}(t)}},852711:(e,t,n)=>{n.d(t,{A:()=>d});var r=n(296540),o=n(474848);const i={viewBox:"0 0 16 16",fittedViewBox:"1.86 2.3 12.06 11.39",svg:(0,o.jsx)("path",{d:"M11.268 2.681 9.325 3.874a6.5 6.5 0 0 1-1.47.666v5.324a6.5 6.5 0 0 1 1.47.665l1.943 1.194zm1 9.413h.056a1.59 1.59 0 0 0 1.59-1.59V3.9a1.59 1.59 0 0 0-1.646-1.59zm-5.413-7.33q-.45.065-.91.065H3.381c-.84 0-1.52.68-1.52 1.52v1.706c0 .674.439 1.246 1.047 1.445h3.947zm-2.223 8.145L3.906 10.5h2.949v2.431a1.1 1.1 0 0 1-1.047.76h-.123a1.1 1.1 0 0 1-1.053-.782"})},a=(0,n(340498).wt)("megaphoneFillSmall",i,"fillSmall");var s=()=>n(69708);function l(e,t){const{teamStore:r,renderAsEveryoneMention:i}=e,l=(0,n(590526).K8)((()=>r.getName()),[r]);return(0,o.jsx)(n(81068).A,{...e,icon:i?(0,o.jsx)(n(807449).I,{icon:a,size:"sm"}):(0,o.jsx)(n(898808).x,{size:14,store:r,disabled:!0}),title:i?(0,o.jsx)(s().sA,{id:"posts.teamMenuItem.everyoneMention",defaultMessage:"@everyone"}):l,ref:t,inline:!0,caption:i?(0,o.jsx)(s().sA,{id:"posts.teamMenuItem.caption",defaultMessage:"Notifies everyone in the teamspace"}):void 0})}const d=r.forwardRef(l)},860864:(e,t,n)=>{n.d(t,{BM:()=>S,EB:()=>b,dX:()=>x,tL:()=>w});n(898992),n(354520),n(581454),n(296540);var r=()=>n(135168),o=()=>n(590526),i=()=>n(401497),a=()=>n(675133),s=()=>n(732810),l=()=>n(723085),d=()=>n(350013),c=()=>n(371722),u=()=>n(302501),p=()=>n(992214),m=()=>n(416504),h=()=>n(69708),g=()=>n(562969),f=()=>n(187820),y=n(474848);const v=(0,h().YK)({privateTeamspace:{id:"baseTable.pageCell.privateTeamspace",defaultMessage:"Private teamspace"},untitledPath:{id:"baseTable.pageCell.untitledPath",defaultMessage:"Untitled"}});function b({store:e,parentSpaceStore:t,rightIcon:n,inlineTitleContent:i,useThinTitle:a,skipUntitledStyling:s}){const l=(0,h().tz)(),d=(0,o().K8)((()=>t||(0,r().f)(e)),[t,e]),c=(0,o().K8)((()=>{var t;return null==e||null===(t=e.getModel())||void 0===t?void 0:t.getRenderIcon({getRecordModel:e.getRecordModel})}),[e]),{displayTitle:u,pageTitle:p}=(0,o().K8)((()=>w({store:e,intl:l})),[e,l]),m=(0,o().K8)((()=>(0,f().Te)(e)),[e]),g=(0,o().K8)((()=>S({blockStore:e,spaceStore:d,intl:l})),[e,d,l]);return(0,y.jsx)(x,{inlineTitleContent:i,mainIcon:(0,y.jsx)(f().B6,{icon:c,iconRecordCategory:m,size:20,isEmptyPage:!1,disabled:!0}),rightIcon:n,subTitle:g,title:u,titleOpacity:p||s?void 0:.25,useThinTitle:a})}function x({inlineTitleContent:e,mainIcon:t,rightIcon:n,subTitle:r,title:o,titleOpacity:a,useThinTitle:s}){const l=(0,i().IS)((()=>({container:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",padding:"8px 0",width:"100%",position:"relative",overflow:"hidden"},summaryContainer:{flex:1,overflow:"hidden"},iconContainer:{height:20,width:20,flexGrow:0,flexShrink:0,flexBasis:20,marginInlineEnd:12,display:"flex",justifyContent:"center",alignItems:"center",borderRadius:6},byline:{lineHeight:1.3,fontSize:12,opacity:.5},titleContainer:{alignItems:"center",flexDirection:"row",display:"flex"},title:{fontSize:14,fontWeight:s?400:500,...void 0!==a?{opacity:a}:{}}})),[a,s]);return(0,y.jsxs)("div",{style:l.container,children:[(0,y.jsx)("div",{style:l.iconContainer,children:t}),(0,y.jsxs)("div",{style:l.summaryContainer,children:[(0,y.jsxs)("div",{style:l.titleContainer,children:[(0,y.jsx)(u().A,{showTooltipWhenTruncated:!0,style:l.title,children:o}),e]}),(0,y.jsx)(u().A,{showTooltipWhenTruncated:!0,style:l.byline,children:r})]}),n]})}function S(e){const{intl:t,blockStore:n,spaceStore:r}=e;const o=n?(0,c().f)(n,{includeTeamHomeFeed:!1,includeDataSources:!0}).filter((e=>e.id!==n.id)).map((e=>{if(e instanceof l().h)return e.getName()||t.formatMessage(v.privateTeamspace);if(e instanceof d().N)return;const n=e.getModel();return(null==n?void 0:n.getRenderTitleWithPlaceholder({getRecordModel:e.getRecordModel,userTimeZone:(0,m().P)(),intl:a().A.getIntl()}))||t.formatMessage(v.untitledPath)})).filter((e=>void 0!==e)).reverse():[];return o.length>0?o.join("/"):null==r?void 0:r.getName()}function w({store:e,intl:t}){if(e instanceof s().m)return{pageTitle:e.getRenderTitle({intl:t,userTimeZone:(0,m().P)()}),displayTitle:(0,g().getCollectionNameOrDefault)({intl:t,collectionStore:e})};if(null==e||!e.canRead())return{pageTitle:void 0,displayTitle:(0,p().mA)(t)};const n=null==e?void 0:e.getModel();if(!n||!e)return{pageTitle:void 0,displayTitle:void 0};const r=e.getRecordModel,o=(0,m().P)(),i=n.getRenderTitle({getRecordModel:r,userTimeZone:o,intl:t}),a=n.getEmptyTitlePlaceholder({getRecordModel:r,userTimeZone:o,intl:t});return{pageTitle:i,displayTitle:i||a}}},866515:(e,t,n)=>{n.d(t,{n:()=>o});var r=n(296540);function o(e,t,n){const o=(0,r.useRef)(e),i=(0,r.useRef)(null);(0,r.useEffect)((()=>{o.current=e}),[e]),(0,r.useEffect)((()=>{const e=async()=>{i.current&&(clearTimeout(i.current),i.current=null),n&&(await o.current(),i.current=setTimeout(e,t))};return n&&e(),()=>{i.current&&(clearTimeout(i.current),i.current=null)}}),[n,t])}},870976:(e,t,n)=>{n.r(t),n.d(t,{DEFAULT_MODAL_WIDTH_WITH_SIDE_PEEK:()=>ge,INACTIVE_TIMEOUT_MS:()=>pe,Search:()=>fe,SearchStaticContext:()=>me,SearchStoresContext:()=>he,getSearchResultMetadata:()=>ve});n(944114),n(898992),n(803949),n(581454);var r=n(296540),o=()=>n(907258),i=()=>n(755531),a=()=>n(20022),s=()=>n(726637),l=()=>n(17022),d=()=>n(381175),c=()=>n(908006),u=()=>n(484714),p=()=>n(951500),m=()=>n(852507),h=()=>n(118884),g=()=>n(590526),f=()=>n(401497),y=()=>n(852273),v=()=>n(711339),b=()=>n(330361),x=()=>n(74351),S=()=>n(882722),w=()=>n(584262),I=()=>n(282834),k=()=>n(620333),T=()=>n(69708),M=()=>n(100622),C=()=>n(534177),j=()=>n(222917),A=()=>n(257667),B=()=>n(277942),_=()=>n(650829),N=()=>n(677590),P=()=>n(383070),R=()=>n(302607),E=()=>n(483730),O=()=>n(433876),F=()=>n(631611),D=()=>n(251200),q=()=>n(236341),L=()=>n(670693),K=()=>n(817443),z=()=>n(261999),V=()=>n(691865),U=()=>n(837073),H=()=>n(729970);var W=()=>n(656894),$=()=>n(470928),G=()=>n(913063),Q=()=>n(770906),Y=()=>n(869562),Z=()=>n(321874),X=()=>n(461131),J=()=>n(905487),ee=()=>n(245241),te=()=>n(287234);class ne extends(()=>n(757695))().Store{getInitialState(){return{queryBasedActionResults:void 0,fixedActionResults:void 0,localResults:void 0,serverResultsLoading:!1,serverResults:void 0,serverEventProperties:void 0,serverResultsAllLoaded:!1,errorState:re,selectedQueryResultQuery:void 0,timesToRender:new Map,focusedIndex:void 0}}setState(e){const t={...this.instanceState};if(!(0,n(821062).A)(this.instanceState,t))return;const r=function(e){const{newState:t,priorState:n}=e,{localResults:r,serverError:o,serverResultsLoading:i,serverResults:a}=t,s=Boolean(r),l=i?void 0:o;if(!s&&i)return!n.errorState.isLoading&&n.errorState.showMajorError?n.errorState:{isLoading:i};if(s)return{hasLocalResults:s,serverError:l,isLoading:!1,showMajorError:!1};if(l)return{hasLocalResults:s,serverError:l,isLoading:!1,showMajorError:!0};if(0===(null==a?void 0:a.results.length))return{hasLocalResults:s,serverError:ee().yq.NoResults,isLoading:!1,showMajorError:!0};return{hasLocalResults:s,serverError:l,isLoading:!1,showMajorError:!1}}({newState:e,priorState:t});super.setState({...e,errorState:r})}endTimeToRenderServerResultsTiming(e){this.state.timeToRenderServerResultsMetric&&(v().default.measure(this.state.timeToRenderServerResultsMetric.eventName,{environment:e,data:{query_length:this.state.timeToRenderServerResultsMetric.query_length,source:this.state.timeToRenderServerResultsMetric.source,search_session_id:this.state.timeToRenderServerResultsMetric.search_session_id,is_search_modal_v2:!1}}),this.update((e=>({...e,timeToRenderServerResultsMetric:void 0}))))}getResultCount(){const{serverResults:e,localResults:t}=this.state,n=(null==e?void 0:e.total)??(null==t?void 0:t.total)??0,r=Boolean(e&&n>=100);return{count:n,isLowerBound:Boolean(e&&t&&n<te().ZK)||r}}}const re={showMajorError:!1,isLoading:!1,hasLocalResults:!1,serverError:void 0};const oe=ne;var ie=()=>n(384565),ae=()=>n(237321),se=()=>n(332946),le=()=>n(322183),de=()=>n(933593),ce=n(474848);const ue=50,pe=120*n(720665).TD,me=r.createContext(null);me.displayName="SearchStaticContext";const he=r.createContext(null);he.displayName="SearchStoresContext";const ge=755;function fe(e){var t;const n=(0,u().v3)(),[l,b]=(0,r.useState)(),x=(0,r.useRef)(),B=(0,r.useRef)(),F=(0,r.useRef)(!0),ee=(0,g().K8)((()=>Boolean(J().default.state.open||J().default.state.openAsPage)),[],{debugName:"isOpen"}),ne=(0,r.useRef)(null),re=(0,r.useRef)(null),le=(0,r.useRef)(null),me=(0,g().K8)((()=>new oe),[],{debugName:"searchResultStore"}),he=(0,g().K8)((()=>new oe),[],{debugName:"secondarySearchResultStore"}),fe=(0,g().O$)(te().zw),Ie=fe.text.trim(),ke=(0,p().l)(fe.filters),Te=(0,U().E)({query:Ie,filters:ke}),{isDebugSidebarOpen:Me,isSidePeekPanelOpen:Ce,mode:je}=(0,g().K8)((()=>({isDebugSidebarOpen:te().Ay.state.isDebugSidebarOpen,isSidePeekPanelOpen:te().Ay.state.isSidePeekPanelOpen,mode:te().Ay.state.mode})),[]),Ae=(0,g().K8)((()=>me.state.localResults),[me]),Be=(0,g().K8)((()=>{var e;return(null===(e=me.state.serverResults)||void 0===e?void 0:e.results)??[]}),[me]),_e=(0,r.useMemo)((()=>(null==Ae?void 0:Ae.results)??[]),[null==Ae?void 0:Ae.results]),Ne=(0,r.useMemo)((()=>_e.length),[_e]),Pe=(0,r.useMemo)((()=>(null==Ae?void 0:Ae.total)??0),[null==Ae?void 0:Ae.total]),Re=(0,g().K8)((()=>(me.state.fixedActionResults??[]).length),[me],{debugName:"numberOfFixedActionResults"}),Ee=(0,g().K8)((()=>(me.state.queryBasedActionResults??[]).length),[me],{debugName:"numberOfQueryBasedActionResults"}),Oe=(0,g().K8)((()=>{var e;return(null===(e=me.state.localResults)||void 0===e?void 0:e.totalResultIds)??[]}),[me],{debugName:"totalLocalResultIds"}),Fe=(0,g().K8)((()=>{var e;return(null===(e=me.state.localResults)||void 0===e?void 0:e.allMatchingResultIds)??[]}),[me],{debugName:"allMatchingResultIds"}),De=Re+Ee,qe=(0,r.useCallback)((()=>function({searchResultsSection:e,modalBodyMenu:t,searchFilterMenu:n,actionItemCount:r}){if(!e)return 0;let o=0;if(s().A.isMobile){if(t instanceof Element&&null!==n){const e=t.getElementsByClassName(S().Smt)[0];e instanceof Element&&(o=e.clientHeight-n.getClientHeight()+e.scrollTop)}}else o=e.getBoundingClientRect().height+e.scrollTop;let i=0,a=0;const l=e.getElementsByClassName(S().J5z);for(let s=0;s<l.length;s++)a+=l[s].clientHeight;const d=e.getElementsByClassName(S().LF7);for(let s=0;s<d.length;s++){const e=d[s];if(!(o-a>e.clientHeight/2))break;i+=1,a+=e.clientHeight}return i-r}({searchResultsSection:ne.current,modalBodyMenu:le.current,searchFilterMenu:re.current,actionItemCount:De})),[De]),Le=(0,g().K8)((()=>me.state.timesToRender),[me],{debugName:"timesToRender"}),Ke=(0,g().K8)((()=>J().default.state.sessionId),[]),ze=(0,g().K8)((()=>J().default.state.openedTimeMs),[]),Ve=(0,g().O$)(te().JP),{numKeystrokes:Ue,numServerRequests:He,firstKeyStrokeTimeMs:We,numLocalRequests:$e}=(0,g().K8)((()=>({numKeystrokes:ie().default.state.numKeystrokes,numServerRequests:ie().default.state.numServerRequests,numLocalRequests:ie().default.state.numLocalRequests,firstKeyStrokeTimeMs:ie().default.state.firstKeyStrokeTimeMs})),[]),Ge=(0,g().K8)((()=>ie().default.state.hadMetaClick),[]),Qe=(0,g().K8)((()=>(0,V().y)({localResults:_e,serverResults:Be})),[_e,Be]),Ye=null==Qe?void 0:Qe.length,Ze=(0,T().tz)(),Xe=(0,r.useCallback)((e=>{const{selectedResult:t,index:n,fromSidePeekPanel:r,context:o,openedTimeMs:i,additionalResultsCount:a}=e,{serverEventProperties:l,store:d}=t,c=Date.now();return{...l,queryText:l&&l["server-query"]&&l["server-query"].query?l["server-query"].query:Ie,context:o,queryStringLength:Ie.length,numQueryTokens:I().qw(Ie).length,hasFilters:(0,W().J)(ke),activeFilters:ke,selectedItemIndex:n.global-(De+(a??0)),selectedItemLocalIndex:{section:n.local.section,index:n.local.indexLocal},numKeystrokes:Ue,fromSidePeekPanel:r,isSidePeekPanelOpen:Ce,isSidebarOpen:Me,timeToSelectMs:c-i,timeFromFirstKeyStrokeToSelectMs:We?c-We:c-i,sources:null==t?void 0:t.sources,localSources:[...(null==t?void 0:t.localSource)??[]],hadMetaClick:Ge,numResultsAboveFold:qe(),selectedSearchResultMetadata:ve(t,Fe),selectedSearchResultContent:void 0,allSearchResultMetadata:null==Qe?void 0:Qe.slice(0,ue).map((e=>ve(e))),totalSearchResultCount:Ye,searchSessionId:Ke,aiSessionId:void 0,traceId:void 0,searchSessionFlowNumber:He,originalPosition:null==t?void 0:t.originalPosition,numLocalResults:Ne,numTotalLocalResults:Pe,totalLocalResultIds:Oe,isMobile:s().A.isMobile,timeToRenderResult:Le.get(d.id),hasScrolled:Ve,verificationState:(0,$().i1)(t.store),searchSource:"quick_find"}}),[Ie,ke,De,Ue,Ce,Me,We,Ge,qe,Qe,Ye,Ke,He,Ne,Pe,Oe,Le,Ve,Fe]),Je=(0,r.useCallback)((({index:e,context:t,selectedResult:r,fromSidePeekPanel:o,source:i,additionalResultsCount:a})=>{ee&&Ke&&ze&&j().yN(n,{...Xe({index:e,context:t,selectedResult:r,fromSidePeekPanel:o,openedTimeMs:ze,additionalResultsCount:a}),source:i,searchSessionId:Ke})}),[Xe,n,ee,ze,Ke]),et=(0,r.useCallback)((()=>{if(!ee)return;clearTimeout(x.current),te().Ay.update((e=>({...e,hasScrolled:!1})));const e=F.current?"search_modal_first_open_lag":"search_modal_open_lag";F.current&&(F.current=!1),v().default.mark(e)}),[ee]),tt=(0,g().K8)((()=>"chat"===n.RouterStore.state.route.name),[n.RouterStore]),nt=(0,r.useCallback)((()=>{Z().Yc({resultStore:me,secondaryResultStore:he}),e.quickSearchMode?(J().default.closeAndResetMetricsState(),tt||(0,N().U)({environment:n})):J().default.reset()}),[n,tt,e.quickSearchMode,me,he]),rt=(0,g().K8)((()=>me.state.serverEventProperties),[me]),ot=(0,r.useCallback)((t=>{const{selectedQueryResult:r}=ie().default.state;if(Ue>0&&(He>0||$e>0)&&!r&&!Ge&&Ke&&ze&&ee){const e=Date.now(),t=e-ze;j().mG(n,{...rt,timeToAbandonMs:t,timeFromFirstKeyStrokeToAbandonMs:We?e-We:void 0,numKeystrokes:Ue,numResultsAboveFold:qe(),searchSessionId:Ke,searchSessionFlowNumber:He,hasScrolled:Ve,numLocalResults:Ne,numTotalLocalResults:Pe,isMobile:s().A.isMobile}),Z().jd({environment:n,query:Ie})}"assistant"===je&&"keydown"===(null==t?void 0:t.type)?(te().Ay.switchToSearchPane(),(0,z().f)(!1)):e.quickSearchMode?(J().default.closeAndResetMetricsState(),ie().default.reset(),r&&!Ge&&nt(),(0,D().y)()):(Z().st({environment:n,reset:!1}),me.update((e=>({...e,universalResults:void 0,currentlySelectedUniversalSearchResultView:void 0})))),"assistant"===je&&R().O.setAssistantLastViewedTime(),""===Ie&&"assistant"!==je&&te().Ay.reset(),x.current&&clearTimeout(x.current),x.current=window.setTimeout(nt,pe),!e.quickSearchMode&&s().A.isMobile&&Y().close(),Q().VI({environment:n,skipAnimation:!0}),ie().default.reset()}),[me,n,Ue,He,$e,Ge,Ke,ze,ee,je,e.quickSearchMode,Ie,rt,We,qe,Ve,Ne,Pe,nt]),it=(0,g().K8)((()=>E().default.getActiveSessionId()),[]),at=(0,g().K8)((()=>{if(it)return E().default.getSessionContext(it)}),[it]),st=(0,r.useCallback)(((t,r,o,i)=>{if(!e.quickSearchMode)return;const a=y().Ay;if("stopQueueingSubscriptions"in a&&a.stopQueueingSubscriptions(n),r){let e;e="tray-icon"===o?"quick-search-tray-icon":"shortcut"===o?"quick-search-shortcut":"debug-menu"===o?"quick-search-debug-menu":"quick-search";const t=("search"===je&&i||"assistant"===je&&!i)&&!(!ee&&r);i&&P().zD.shouldShowSearchMenuItemAskAI()?Z().sv({environment:n,from:t?"command_search_switching_panes":"command_search_shortcut",device:n.device}):!0!==i&&(te().Ay.update((e=>({...e,mode:"search"}))),t&&(e="command_search_switching_panes",it&&_().assistantDependency.load().then((({assistantAnalyticsActions:e})=>{e.trackAssistantClosed(n,{from:"command_search_switching_panes",sessionContext:at})})))),Z()._N({environment:n,analyticsFrom:e,isQuickSearch:!0,doNotTrackOpenSearchEvent:i}),c().default.afterNextFlush((()=>(0,K().L)()))}else ot()}),[at,it,n,ot,ee,je,e.quickSearchMode]),lt=(0,r.useCallback)((t=>{e.quickSearchMode&&ot()}),[ot,e.quickSearchMode]),dt=(0,r.useCallback)((()=>{Z().Yc({resultStore:me,secondaryResultStore:he}),e.quickSearchMode||(J().default.reset(),(0,N().U)({environment:n}))}),[n,e.quickSearchMode,me,he]),ct=(0,r.useCallback)((()=>{var t;const n=(0,i().S)()&&(null===(t=(0,i().S)())||void 0===t?void 0:t.id);B.current!==n&&(B.current=n,dt(),B.current&&o().default.state.currentUserStore&&e.quickSearchMode&&(0,L().Z)())}),[e.quickSearchMode,dt]),ut=(0,r.useRef)(),pt=(0,r.useRef)(),mt=(0,r.useRef)(),ht=(0,r.useRef)();(0,m().l)((()=>{var t;B.current=null===(t=(0,i().S)())||void 0===t?void 0:t.id,(0,i().S)()&&o().default.state.currentUserStore&&e.quickSearchMode&&(0,L().Z)(),o().default.addListener(ct),J().default.addListener(et),e.quickSearchMode?pt.current=a().JW.addListener(st):(ut.current=a().RS.addListener((()=>we(n,!1))),mt.current=a().lS.addListener((()=>{"chat"!==n.RouterStore.state.route.name&&we(n,!0)}))),A().w7.addListener(lt),ht.current=a().OW.addListener((()=>{Z()._N({environment:n,isNewElectronTab:!0,analyticsFrom:"new-tab"})}))})),(0,h().X)((()=>{var e,t,n,r;nt(),J().default.removeListener(et),A().w7.removeListener(lt),o().default.removeListener(ct),null===(e=pt.current)||void 0===e||e.call(pt),null===(t=ut.current)||void 0===t||t.call(ut),null===(n=mt.current)||void 0===n||n.call(mt),null===(r=ht.current)||void 0===r||r.call(ht),x&&(clearTimeout(x.current),x.current=void 0)}));const gt=(0,G().o)(),ft=(0,g().K8)((()=>J().default.state.isNewElectronTab),[]),yt=(0,r.useCallback)((({index:t,event:r,context:o,selectedResult:i,fromSidePeekPanel:a,additionalResultsCount:s})=>{if(!ee||!ze||!Ke)return;const l=(0,d().V)(r);"query_results"===o&&(ie().default.update((e=>({...e,selectedQueryResult:!0}))),me.update((e=>({...e,selectedQueryResultQuery:fe})))),j().bo(n,{...Xe({index:t,context:o,selectedResult:i,fromSidePeekPanel:a,openedTimeMs:ze,additionalResultsCount:s}),searchSource:"quick_find",searchSessionId:Ke,isMetaClick:Boolean(l)});const c=(null==rt?void 0:rt["server-queryId"])??(0,k().mk)({searchSessionId:Ke,searchSessionFlowNumber:He});let u;if("recent_pages"===o?u=w().y8.SearchRecents:"query_results"===o?u=w().y8.SearchQuery:"tabs"===o||"new_page"===o?u=w().y8.SearchTabs:"action"===o?u=w().y8.SearchCustomAction:"offline_pages"===o?u=w().y8.SearchOfflinePages:(0,C().HB)(o),n.device.isElectron&&e.quickSearchMode){const e=(0,de().yD)({result:i,queryId:c,pageVisitSource:u,scrollToBlockId:(0,H().p)(i)});e&&(0,q().N)(e)}else{const e=A().$f({result:i});if(!e)return;A().q9({searchResult:e,environment:n,pageVisitSource:u,queryId:c,openInNew:l,electronTabSearch:{tabs:gt,isNewTab:Boolean(ft)},context:o})}ae().A.setState({queryId:c,pageId:i.store.id,timeEntered:new Date}),l?ie().default.update((e=>({...e,hadMetaClick:!0}))):ot()}),[Xe,n,ot,ft,ee,He,ze,e.quickSearchMode,fe,me,Ke,rt,gt]),vt=(0,r.useMemo)((()=>({queryResultsSectionRef:ne,searchMobileFilterMenuRef:re,modalBodyMenuRef:le,handleSelectSearchResult:yt,handleCopySearchItemLink:Je,handleQueryChange:Se,handlePopupOpen:be,handlePopupClose:xe,searchResultStore:me,secondarySearchResultStore:he,defaultBodyFocusedResult:l,isQuickSearch:e.quickSearchMode,setDefaultBodyFocusedResult:b})),[l,Je,yt,e.quickSearchMode,me,he]),bt=Te?"search_results":"default_body",xt=function(e){const t=(0,u().v3)(),n=(0,g().K8)((()=>(0,se().CX)({searchContentPaneType:e,quickSearchMode:!1,environment:t})),[t,e]),r=(0,g().K8)((()=>(0,X().I5)()?"90vw":ge),[]);return(0,f().IS)((()=>({wrapper:{width:"100%",minHeight:n.minHeight,maxHeight:n.maxHeight,transform:"translate3d(0,0,0)",background:M().Tj.popoverBackground,maxWidth:r,borderRadius:12}})),[r,n]).wrapper}(bt);return e.quickSearchMode?(0,ce.jsx)(ye,{searchContentPaneType:bt,quickSearchMode:e.quickSearchMode,handleComponentClose:ot,parentStore:e.parentStore,staticContext:vt}):(0,ce.jsx)(O().A,{ariaLabel:Ze.formatMessage({id:"search.modal.ariaLabel",defaultMessage:"Search Notion"}),open:ee,onDismiss:ot,modalStyle:xt,modalBackgroundStyle:{background:"transparent"},modalIsWaxPaper:!0,alignItems:"stretch",disableAnimation:!s().A.isMobile||(null===(t=n.mobileNative)||void 0===t?void 0:t.supportsNativeHomeOnPhone())||!1,renderContent:()=>(0,ce.jsx)(ye,{searchContentPaneType:bt,quickSearchMode:e.quickSearchMode,handleComponentClose:ot,parentStore:e.parentStore,staticContext:vt})})}function ye(e){const{searchContentPaneType:t,quickSearchMode:n,handleComponentClose:r,parentStore:o,staticContext:i}=e,a=(0,g().O$)(te().B),l=(0,g().O$)(te().W5),d=n?F().wy.commandSearch:s().A.isMobile?F().wy.mobileSearch:F().wy.searchPane;return(0,ce.jsx)(me.Provider,{value:i,children:(0,ce.jsx)(he.Provider,{value:{parentStore:o},children:(0,ce.jsxs)(F().hP,{surface:d,children:[n&&!a?(0,ce.jsx)("div",{style:{position:"absolute",height:le().Ac,width:"100%"},className:S().sbV}):void 0,"search"===l?(0,ce.jsx)(se().sb,{quickSearchMode:n,searchContentPaneType:t,onClose:r}):(0,ce.jsx)(B().Yk,{quickSearchMode:n,searchContentPaneType:t,onClose:r})]})})})}function ve(e,t){const{store:n,highlight:r,sources:o,localSource:i}=e,a=t?t.indexOf(n.id):-1;return l().e.withListenerIgnored((()=>{var t,s,l,d,c;return{blockId:n.id,blockType:n.getType(),lowestNavigableAncestorId:null===(t=n.getNavigableBlockStore())||void 0===t?void 0:t.id,depth:(0,b().g)(n).length,matchesText:Boolean(null==r?void 0:r.text),matchesPathText:Boolean((null==r?void 0:r.pathText)||(null==r?void 0:r.title)),matchesTitle:Boolean(null==r?void 0:r.title),isNavigable:n.isNavigableBlock(),lastEditedTime:n.getLastEditedTime(),isTeamArchived:null===(s=(0,x().U)(n))||void 0===s?void 0:s.isArchived(),sources:o,localSource:[...i??[]],badges:(null===(l=e.badges)||void 0===l?void 0:l.map((e=>e.type)))??[],isCollectionPropertyMatch:void 0!==(null===(d=e.matchedCollectionProperties)||void 0===d?void 0:d.collectionText),isCollectionPropertyHighlight:void 0!==(null===(c=e.highlight)||void 0===c?void 0:c.collectionText),featureGroups:e.featureGroups,allMatchingLocalResultsIndex:a>=0?a:void 0}}))}function be(){te().Ay.setIsAnyPopupOpen(!0)}function xe(){te().Ay.setIsAnyPopupOpen(!1)}function Se(e){""!==e?(ie().default.update((e=>({...e,numKeystrokes:e.numKeystrokes+1}))),te().Ay.updateQueryText(e),"full-content"===J().default.state.searchMode&&J().default.update((e=>({...e,searchMode:"nav-local-only"})))):te().Ay.resetQuery({resetFilters:!1})}function we(e,t){t&&te().Ay.update((e=>({...e,mode:"assistant"}))),Z()._N({environment:e,analyticsFrom:"keyboard-shortcut-quick-search-hotkey",isQuickSearch:!1})}},877788:(e,t,n)=>{n.d(t,{w:()=>o});n(296540);const r={viewBox:"0 0 20 20",fittedViewBox:"2.4 2.39 15.2 14.52",svg:(0,n(474848).jsx)("path",{d:"M10 2.399c.27 0 .51.174.594.432l1.507 4.636h4.874a.625.625 0 0 1 .367 1.13L13.4 11.462l1.506 4.636a.625.625 0 0 1-.962.699L10 13.932l-3.943 2.865a.625.625 0 0 1-.962-.699L6.6 11.462 2.658 8.597a.625.625 0 0 1 .367-1.13h4.874L9.406 2.83A.625.625 0 0 1 10 2.399m0 2.647L8.948 8.285a.625.625 0 0 1-.595.432H4.95l2.754 2c.22.16.31.442.227.7l-1.052 3.238 2.755-2.001a.625.625 0 0 1 .734 0l2.755 2-1.052-3.237a.625.625 0 0 1 .227-.7l2.754-2h-3.405a.625.625 0 0 1-.594-.432z"})},o=(0,n(340498).wt)("star",r,"default")},881480:(e,t,n)=>{n.d(t,{g:()=>o});n(16280);var r=()=>n(160907);function o(){const e=(0,r().f)();if(!e)throw new Error("No available store");return e}},883476:(e,t,n)=>{n.d(t,{K:()=>q,V:()=>z});n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(581454);var r=n(296540),o=()=>n(726637),i=()=>n(484714),a=()=>n(852507),s=()=>n(590526),l=()=>n(401497),d=()=>n(996332),c=()=>n(396896),u=()=>n(807449),p=()=>n(631524),m=()=>n(584262),h=()=>n(604995),g=()=>n(955363),f=()=>n(417104),y=()=>n(142078),v=()=>n(49621),b=()=>n(69708),x=()=>n(100622),S=()=>n(534177),w=()=>n(284371),I=()=>n(720128),k=()=>n(128295),T=()=>n(16006),M=()=>n(447587),C=()=>n(117219),j=()=>n(362976),A=()=>n(29554),B=()=>n(751380),_=()=>n(492414),N=()=>n(933593),P=()=>n(298182),R=()=>n(827368),E=()=>n(915189),O=()=>n(639417),F=n(474848);const D=(0,b().YK)({unknownChannel:{id:"SlackResultTitle.unknownChannel",defaultMessage:"Unknown Channel"},showMore:{id:"GithubCodeBlock.showMore",defaultMessage:"Show more"}});function q(e){const{result:t,onMouseEnter:n,onMouseLeave:r,onClick:o,compact:i,hideArrowOnHover:a}=e;return"notion"===t.type?(0,F.jsx)(L,{result:t,position:e.position,onMouseEnter:n,onMouseLeave:r,onClick:o,compact:i,hideArrowOnHover:a}):(0,F.jsx)(z,{result:t,position:e.position,onMouseEnter:n,onMouseLeave:r,onClick:o,compact:i,hideArrowOnHover:a})}function L(e){var t,n;const{result:a,result:{store:c,badges:p},onMouseEnter:h,onMouseLeave:f,onClick:y,compact:v,hideArrowOnHover:b}=e,[S,T]=(0,r.useState)(!1),C=(0,r.useRef)(null),N=U({hovered:S,isDeepFindUxActive:!0,isCompactView:v??!1}),P=(0,i().v3)(),R=(0,r.useCallback)((e=>{T(!0),null==h||h(e)}),[h]),D=(0,r.useCallback)((e=>{T(!1),null==f||f(e)}),[f]),q=(0,r.useCallback)((e=>{null==y||y(e)}),[y]),L=a.highlight&&a.highlight.text?a.highlight.text:void 0,K=(0,s().K8)((()=>{if(L)return L;const e=(0,j().E)(c);return e?(0,A().r4)(e,c):""}),[c,L]),z=(0,B().PO)({words:(0,B().oQ)(null===(t=a.highlight)||void 0===t?void 0:t.title),highlightText:null===(n=a.highlight)||void 0===n?void 0:n.title,styleOverride:N.textHighlight}),V=(0,B().Ay)(K),W={tokenize:e=>(0,B().nB)(V),style:N.textHighlight},{metaHref:$,href:G}=(0,s().K8)((()=>({metaHref:(0,_().Ay)({store:c,fullyQualified:!1,pageVisitSource:m().y8.AIQna}),href:(0,E().OA)({result:a,environment:P})})),[c,a,P]),Q=(0,l().IS)((()=>({captionTooltip:{color:x().Tj.text.inversePrimary},captionTooltipDivider:{color:x().Tj.text.inversePrimary},pageInfoWrapper:{width:"100%",minWidth:0,fontWeight:w().Wy.regular}})),[]);return(0,F.jsx)("div",{style:N.wrap,ref:C,children:(0,F.jsx)(d().Q,{href:$,metaHref:G,external:!1,style:N.linkBox,hovered:S,hoveredStyle:N.linkBoxHoveredStyle,onMouseEnter:R,onMouseLeave:D,onClick:q,children:(0,F.jsxs)("div",{style:N.titleWrap,children:[(0,F.jsx)(O().R,{result:a,size:v?12:16,style:N.icon,notStandaloneIcon:v}),(0,F.jsx)("div",{style:Q.pageInfoWrapper,children:v?(0,F.jsxs)("div",{style:N.universalTitleWrapper,children:[(0,F.jsx)(H,{badges:v?[]:p??[],store:c,titleHighlighter:z,compact:v}),S&&!b?(0,F.jsx)(u().I,{icon:g().arrowDiagonalUpRightIcon,size:"xxs",style:{flexShrink:0}}):void 0]}):(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(H,{badges:v?[]:p??[],store:c,titleHighlighter:z,compact:v}),(0,F.jsx)(k().Ay,{store:c,extraLength:o().A.isMobile?0:2,showFullPathInTooltip:!0,enableHoverAncestor:!0,tooltipStyle:Q.captionTooltip,tooltipDividerStyle:Q.captionTooltipDivider}),(0,F.jsx)(M().A,{maxLines:1,style:N.text,children:(0,F.jsx)(I().A,{text:K,highlighter:W})})]})})]})})},a.id)}function K(e){const{result:t,hovered:n,compact:o}=e,i=U({hovered:n,isDeepFindUxActive:!0,isCompactView:o??!1}),a=(0,b().tz)(),s=(0,r.useMemo)((()=>{if("slack"===t.type){var e;const n=(null===(e=t.highlight)||void 0===e?void 0:e.title)??t.title;return n?n.startsWith("https://")?n:`#${n}`:a.formatMessage(D.unknownChannel)}return"github"===t.type&&"code"===t.fileType?t.githubRepoName:void 0}),[t,a]),l=(0,r.useMemo)((()=>{var e;return"slack"===t.type&&(null===(e=t.threadMessages)||void 0===e?void 0:e.length)&&t.threadMessages.length>1}),[t]),d=(0,r.useMemo)((()=>{var e;return(null===(e=t.highlight)||void 0===e?void 0:e.title)??t.title}),[t]),c={tokenize:e=>(0,B().nB)((0,B().Ay)(d)),style:i.textHighlight},p={tokenize:e=>(0,B().nB)((0,B().Ay)(s||"")),style:i.textHighlight},m={tokenize:e=>(0,B().nB)((0,B().Ay)("slack"===t.type?t.user??"":"")),style:i.textHighlight};return(0,F.jsxs)("div",{style:i.universalTitleWrapper,children:[(0,F.jsx)("span",{style:i.universalTitleText,children:"slack"===t.type?(0,F.jsx)(W,{result:t,highlighter:m}):(0,F.jsx)(I().A,{text:d,highlighter:c})}),(0,F.jsxs)("span",{style:i.universalTitleFollowup,children:[l&&!o?(0,F.jsx)(u().I,{size:"xs",icon:v().h,style:{display:"inline-flex"}}):null,(0,F.jsx)("span",{children:s?(0,F.jsx)(I().A,{text:s,highlighter:p}):null})]})]})}function z(e){const{result:t,onMouseEnter:n,onMouseLeave:o,onClick:a,compact:s,hideArrowOnHover:l}=e,[c,p]=(0,r.useState)(!1),m=(0,r.useRef)(null),f=U({hovered:c,isDeepFindUxActive:!0,isCompactView:s??!1}),y=(0,r.useCallback)((e=>{p(!0),null==n||n(e)}),[n]),v=(0,r.useCallback)((e=>{p(!1),null==o||o(e)}),[o]),b=(0,r.useCallback)((e=>{null==a||a(e)}),[a]),x=(0,i().v3)(),S=(0,r.useMemo)((()=>(0,E().OA)({result:t,environment:x})),[t,x]),{isCodeResult:w,codeText:k}=(0,r.useMemo)((()=>{const e="github"===t.type&&"code"===t.fileType;return{isCodeResult:e,codeText:e?(0,P().Sf)(t.text):""}}),[t]),T=(0,r.useMemo)((()=>{if(!w)return function(e){const t=[];if("slack"===e.type){var n;const r=null!==(n=e.threadMessages)&&void 0!==n&&n.length&&e.threadMessages.length>1?e.threadMessages.length-1+" replies":void 0;r&&t.push(r)}else if("github"===e.type){const n=(0,P().wb)(e.fileType);n&&t.push(n),e.statusTag&&"pull-request"===e.fileType&&t.push(e.statusTag),e.authorName&&t.push(e.authorName)}else"webpage"===e.type&&t.push(e.domain);return e.lastEdited!==h().Mb&&t.push(e.lastEdited),t}(t).join(" â€¢ ")}),[t,w]),C=(0,r.useMemo)((()=>{var e,n;return"slack"===t.type?(0,P().B5)((null===(n=t.highlight)||void 0===n?void 0:n.text)??t.text):(null===(e=t.highlight)||void 0===e?void 0:e.text)??t.text}),[t]),j={tokenize:e=>(0,B().nB)((0,B().Ay)(C)),style:f.textHighlight},A=(0,r.useMemo)((()=>{if(!w)return"slack"===t.type?3:1}),[t,w]);return(0,F.jsx)("div",{style:f.wrap,ref:m,children:(0,F.jsx)(d().Q,{href:S,metaHref:S,external:!0,style:f.linkBox,hovered:c,hoveredStyle:f.linkBoxHoveredStyle,onMouseEnter:y,onMouseLeave:v,onClick:b,children:(0,F.jsxs)("div",{style:f.universalResultWrapper,children:[(0,F.jsx)(O().R,{result:t,size:s?12:16,style:f.icon,notStandaloneIcon:s}),(0,F.jsx)("div",{style:f.universalBodyWrapper,children:s?(0,F.jsxs)("div",{style:f.universalTitleWrapper,children:[(0,F.jsx)(K,{result:t,hovered:c,compact:s}),c&&!l?(0,F.jsx)(u().I,{icon:g().arrowDiagonalUpRightIcon,size:"xxs",style:{flexShrink:0}}):void 0]}):(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(K,{result:t,hovered:c,compact:s}),(0,F.jsx)(M().A,{maxLines:A,style:f.text,children:w?(0,F.jsx)(V,{text:k}):(0,F.jsx)(I().A,{text:C,highlighter:j})}),T?(0,F.jsx)("div",{style:f.footerMetadata,children:T}):null]})})]})})},t.id)}function V(e){const{text:t}=e,n=(0,b().tz)(),o=(0,r.useRef)(null),[i,s]=(0,r.useState)(!1),[d,c]=(0,r.useState)(!1),u=(0,l().eP)(),m=(0,l().IS)((()=>({code:{backgroundColor:"transparent",color:x().Tj.text.secondary,overflow:i?"auto":"hidden",maxHeight:i?400:200,scrollbarWidth:"thin",tabSize:4,padding:10},codeWrapper:{position:"relative",border:`1px solid ${"light"===u?x().Tj.palette.gray[100]:x().Tj.palette.gray[300]}`,borderRadius:6},showMoreButton:{margin:10,color:x().Tj.text.tertiary,cursor:"pointer",fontSize:12,fontWeight:w().Wy.medium,background:"none",border:"none"}})),[i,u]);(0,a().w)((()=>{if(o.current&&!i){const e=o.current.scrollHeight,t=o.current.clientHeight;c(e>t)}}));const h=(0,r.useCallback)((e=>{s(!0),e.preventDefault(),e.stopPropagation()}),[]);return(0,F.jsxs)("div",{style:m.codeWrapper,children:[(0,F.jsx)(C().Cy,{style:m.code,scrollContentRef:o,children:t}),!i&&d?(0,F.jsx)(p().p,{style:m.showMoreButton,onClick:e=>h(e),children:n.formatMessage(D.showMore)}):void 0]})}function U(e){const{hovered:t,isCompactView:n}=e,{bodyStyleKey:r}=(0,R().yq)(),o=(0,R().Cd)(r).fontSize;return(0,l().IS)((()=>{const e={wrap:{display:"flex",position:"relative"},linkBox:{display:"flex",alignItems:"center",gap:4,padding:"0 4px",borderRadius:6,fontWeight:500,fontSize:13,transition:"background 150ms",marginInlineStart:-6,maxWidth:"calc(100% + 8px)"},linkBoxHoveredStyle:{background:x().Tj.buttonHoveredBackground},iconWrap:{position:"relative",marginInlineEnd:4,width:14,height:14,flexShrink:0},icon:{position:"absolute",insetInlineStart:0,top:0,transition:"opacity 150ms",opacity:1},number:{position:"absolute",insetInlineStart:0,top:0,opacity:t?1:0,transition:"opacity 150ms",zIndex:10},titleWrap:{display:"flex",minWidth:50,alignItems:"start",padding:void 0},text:{marginTop:2,color:x().Tj.text.secondary,fontWeight:400},textHighlight:{color:x().Tj.text.primary,fontWeight:w().Wy.medium}};return n?{...e,titleWrap:{...e.titleWrap,alignItems:"center",gap:8,color:x().Tj.text.secondary,fontWeight:400},wrap:{...e.wrap,width:"100%"},linkBox:{...e.linkBox,padding:"4px 6px",width:"100%",marginInlineStart:0},iconWrap:{...e.iconWrap,marginInlineEnd:6,marginTop:0,width:12,height:12},universalResultWrapper:{...e.titleWrap,flexGrow:1,alignItems:"center",gap:8},number:{...e.number,opacity:0},icon:{position:"relative",width:12,height:12,opacity:1,color:x().Tj.icon.secondary},footerMetadata:{whiteSpace:"nowrap",color:x().Tj.text.tertiary,fontSize:12,fontWeight:w().Wy.regular,marginTop:3},universalBodyWrapper:{width:"100%",display:"flex",alignItems:"center",color:x().Tj.text.secondary,flexWrap:"nowrap",minWidth:0},universalTitleWrapper:{display:"flex",alignItems:"center",overflow:"hidden",gap:4},universalTitleText:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontSize:o,fontWeight:400,color:x().Tj.text.secondary},universalTitleFollowup:{whiteSpace:"nowrap",color:x().Tj.text.tertiary,fontSize:12,fontWeight:w().Wy.regular,alignItems:"center",gap:3,display:"flex"},textHighlight:{}}:{...e,wrap:{...e.wrap,width:"calc(100% + 20px)"},linkBox:{...e.linkBox,padding:8,width:"100%",marginInlineStart:-8},iconWrap:{...e.iconWrap,marginInlineEnd:12,marginTop:1,width:20,height:20},universalResultWrapper:{...e.titleWrap,flexGrow:1},number:{...e.number,opacity:0},icon:{...e.icon,opacity:1},footerMetadata:{whiteSpace:"nowrap",color:x().Tj.text.tertiary,fontSize:12,fontWeight:w().Wy.regular,marginTop:3},universalBodyWrapper:{width:"100%",minWidth:0},universalTitleWrapper:{display:"flex",alignItems:"center",gap:"8px"},universalTitleText:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontSize:o,fontWeight:500},universalTitleFollowup:{whiteSpace:"nowrap",color:x().Tj.text.tertiary,fontSize:12,fontWeight:w().Wy.regular,alignItems:"center",gap:3,display:"flex"}}}),[t,n,o])}function H(e){const{badges:t,store:n,titleHighlighter:o,compact:i}=e,{bodyStyleKey:a}=(0,R().yq)(),d=(0,R().Cd)(a),p=(0,l().IS)((()=>({title:{...d,color:x().Tj.text.secondary,fontWeight:i?w().Wy.regular:w().Wy.medium}})),[i,d]),m=(0,s().K8)((()=>(0,F.jsx)(T().A,{store:n,style:p.title,highlighter:o})),[n,p.title,o]),h=(0,r.useMemo)((()=>new Set(t.map((e=>e.type)))),[t]);return(0,F.jsxs)(c().fI,{gap:4,alignItems:"center",children:[m,h.has("is_collection")?(0,F.jsx)(u().I,{icon:y().H,size:"sm",colorVariant:"secondary"}):void 0,h.has("verified")?(0,F.jsx)(u().I,{icon:f().badgeCheckFillSmallIcon,size:"sm",colorPalette:"blue",colorVariant:"accentPrimary"}):void 0,h.has("is_template")?(0,F.jsx)(N().rx,{}):void 0,h.has("popular_this_week")?(0,F.jsx)(N().oj,{}):void 0,h.has("most_viewed")?(0,F.jsx)(N().iY,{}):void 0,h.has("agent")?(0,F.jsx)(N().Kg,{}):void 0]})}function W(e){const{result:t,highlighter:n}=e,o=(0,r.useMemo)((()=>"slack"===t.type?(0,S().O9)(t.threadHref)?t.user:t.text.split(":")[0]:void 0),[t]);return(0,S().O9)(o)?(0,F.jsx)(I().A,{text:o,highlighter:n}):(0,F.jsx)(b().sA,{id:"SlackCitationTitle.authorUnknown",defaultMessage:"Unknown author"})}},913063:(e,t,n)=>{n.d(t,{o:()=>a});var r=()=>n(92697),o=()=>n(590526);const i=new(n(140934).ComputedStore)((()=>(0,n(646969).i)(r().A.state.tabs,r().A.state.currentTab.id)),{debugName:"Search2.electronTabs"});function a(){return(0,o().O$)(i)}},921738:(e,t,n)=>{n.d(t,{O:()=>J});var r=()=>n(564884),o=()=>n(907258),i=()=>n(755531),a=()=>n(242422),s=()=>n(484714),l=()=>n(590526),d=()=>n(929219),c=(n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(823215),n(354520),n(672577),n(581454),n(737550),()=>n(282834)),u=()=>n(620333);const p=new Set(["myself","of","the","until","couldn","below","won't","me","hers","what","i'll","it's","too","then","re","itself","further","ma","there","have","because","just","she'd","doing","hadn","mustn't","being","down","a","from","shouldn't","shouldn","it","mightn't","o","before","but","we'd","you've","and","ours","wasn't","did","each","is","should","which","were","here","not","at","ll","where","an","same","we're","haven't","haven","isn","with","hasn","she'll","between","has","that'll","been","they","this","for","more","over","i","that","having","he","needn","through","out","we","under","don't","wasn","both","you'll","do","so","t","hadn't","to","him","yourselves","nor","them","own","your","hasn't","they'll","he'll","couldn't","y","ain","he's","these","d","no","himself","after","how","mustn","mightn","off","other","ve","was","wouldn","in","it'll","shan","when","about","if","than","we've","who","above","didn't","only","they've","such","during","shan't","she's","why","can","theirs","won","our","its","had","as","up","will","m","their","doesn","those","you're","ourselves","isn't","yourself","into","you","needn't","any","am","very","my","they'd","again","themselves","didn","some","herself","her","whom","they're","while","now","weren't","i'd","his","by","we'll","yours","weren","or","most","it'd","i've","against","are","does","once","aren","aren't","few","s","all","wouldn't","you'd","he'd","doesn't","don","should've","on","be","i'm","she"]),m=3;const h=/(.{1,3})ä¸\1/,g=/ä»€ä¹ˆ|ä»€éº¼|è°|èª°|å“ª|æ€Žä¹ˆ|æ€Žéº¼|å¤šå°‘|å•¥|å¦‚ä½•|æ˜¯å¦/,f=/æˆ‘|ä½ |ä»–|å¥¹|å®ƒ|æ‚¨/,y=/ä»Šå¤©|æ˜¨å¤©|æ˜Žå¤©|å‰å¤©|è¿™å‡ å¤©|é€™å¹¾å¤©|è¿™ä¸¤å¤©|é€™å…©å¤©|å‘¨|é€±|æœˆ|æœ€è¿‘|æœ€æ–°|å½“å‰|ç•¶å‰|ç›®å‰|è¿‘æ¥|è¿‘ä¾†|å³å°†|å³å°‡|åˆšæ‰|å‰›æ‰|åˆšåˆš|å‰›å‰›|è¿›è¡Œä¸­|é€²è¡Œä¸­|æ­£åœ¨/;const v=/ëˆ„êµ¬|ë­|ì–´ë””|ì–¸ì œ|ì™œ|ì–´ë–»ê²Œ|ì–´ë–¤|ì–´ëŠ|í•  ìˆ˜ ìžˆ|í•  ìˆ˜ë„/,b=/ë‚˜ëŠ”|ë‚´ê°€|ì œê°€|ë„ˆê°€|ë„¤ê°€|ìš°ë¦¬|ì €í¬|ë„ˆëŠ”|ê·¸ê²ƒ|ê·¸ë“¤|ì´ê²ƒ|ê·¸ê±°|ì €ê±°/,x=["ë‚´","ì œ"],S=/ì§€ê¸ˆ|ì˜¤ëŠ˜|ë‚´ì¼|ì–´ì œ|ëª¨ë ˆ|ê·¸ì €ê»˜|ì´ë²ˆì£¼|ë‹¤ìŒì£¼|ì§€ë‚œì£¼|ì´ë²ˆë‹¬|ë‹¤ìŒë‹¬|ì§€ë‚œë‹¬|ì˜¬í•´|ë‚´ë…„|ìž‘ë…„|ìž¬ìž‘ë…„|ë‚´í›„ë…„|ì•„ì¹¨|ì •ì˜¤|ì ì‹¬|ì˜¤í›„|ì €ë…|ìƒˆë²½|ë‚˜ì¤‘ì—|ê³§|í•­ìƒ|ìžì£¼|ê°€ë”|ë“œë¬¼ê²Œ/,w=/ìŠ¬ëž™|ìŠ¤ëž™|ë§ˆì´í¬ë¡œì†Œí”„íŠ¸|êµ¬ê¸€|ê¹ƒí—ˆë¸Œ|ì‰ì–´í¬ì¸íŠ¸|ì§€ë©”ì¼|ì´ë©”ì¼|ì§€ë¼/;const I=/ãªã«|ä½•|ã ã‚Œ|èª°|ã©ã“|ã„ã¤|ãªãœ|ã©ã†ã—ã¦|ã©ã®|ã©ã‚Œ|ã©ã¡ã‚‰|ã©ã£ã¡|ã©ã‚“ãª|ã„ã‹ãŒ|ã„ã‹ãªã‚‹|ã©ã†ã™ã‚‹/,k=/ä½•ã‚‚|ã„ã¤ã‚‚|ä½•ã§ã‚‚|ãªã‚“ã§ã‚‚|èª°ã§ã‚‚|ã„ã¤ã§ã‚‚|ã©ã“ã§ã‚‚|ã©ã†ã§ã‚‚|ã©ã‚Œã§ã‚‚|ã©ã“ã‹|ã„ã¤ã‹|èª°ã‹/,T=/ç§|ã‚ãŸã—|åƒ•|ã¼ã|ä¿º|ãŠã‚Œ|ã‚ãªãŸ|å›|ãã¿|å½¼|ã‹ã‚Œ|å½¼å¥³|ã‹ã®ã˜ã‚‡/,M=/ã‚¹ãƒ©ãƒƒã‚¯|ãƒžã‚¤ã‚¯ãƒ­ã‚½ãƒ•ãƒˆ|ã‚°ãƒ¼ã‚°ãƒ«|ã‚®ãƒƒãƒˆãƒãƒ–|ã‚·ã‚§ã‚¢ãƒã‚¤ãƒ³ãƒˆ|ã‚¸ãƒ¼ãƒ¡ãƒ¼ãƒ«|ãƒ¡ãƒ¼ãƒ«|ã‚¸ãƒ©/,C=/ä»Šæ—¥|ä»Šæ™©|ä»Šæœ|æœã‹ã‚‰|æœã¾ã§|åˆå‰|æ˜¼å‰|æ­£åˆ|æ˜¼æ™‚|åˆå¾Œ|æ—¥ä¸­|å¤•æ–¹|æ˜¨æ—¥|æ˜Žæ—¥|æ˜Žå¾Œæ—¥|å…ˆé€±|ä»Šé€±|æ¥é€±|å…ˆæœˆ|ä»Šæœˆ|æ¥æœˆ|ä»Šå¹´|æ¥å¹´|æ˜¨å¹´|åŽ»å¹´|æœ€è¿‘|ç¾åœ¨|æœ€æ–°|é€²è¡Œä¸­|çœŸå¤œä¸­|æ˜Žã‘æ–¹|å¾Œã§|ã™ã|æ™‚ã€…|ã‚ã£ãŸã«/;function j(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()}const A=["qui","que","quoi","oÃ¹","quand","pourquoi","comment","quel","quelle","quels","quelles","combien"],B=["ou"],_=["je","tu","il","elle","nous","vous","ils","elles","moi","toi","lui","eux","mon","ton","son","notre","votre","leur","me","ma","te","ta","se","sa","mes","tes","ses","nos","vos","leurs"],N=[],P=["aujourd'hui","hier","demain","semaine","semaines","mois","recent","recemment","actuel","actuellement","dernierement","dernier","prochain","en cours"];const R=["quien","quienes","cual","cuales","porque","donde","cuanto","cuantos","cuantas"],E=["cuando","como"],O=["yo","tu","el","ella","nosotros","nosotras","vosotros","vosotras","ellos","ellas","mi","su","nuestro","nuestra","vuestro","vuestra","sus","me","te","se","nos","os","lo","la","los","las"],F=[],D=["hoy","ayer","manana","semana","semanas","mes","meses","reciente","recientemente","actual","actualmente","ultimo","proximo","en curso"],q=["el","la","los","las","de","del","al","en","un","una","unos","unas","y","o","pero","si","no","con","por","para","sin","sobre","entre","desde","hasta","durante","antes","despues","segun","hacia","contra","bajo","tras","ante","mediante","salvo","excepto","incluso","solo","tambien","aun","ya","todavia","apenas","mas","menos","muy","mucho","poco","bastante","demasiado","tan","tanto","cuanto","todo","cada","otro","mismo","ese","este","aquel","eso","esto","aquello","donde","cuando","como","que","quien","cual","cuyo","cuya","cuyos","cuyas","es","son","esta","estan","estoy","estas","estamos","estais","soy","eres","somos","sois","fue","fueron","era","eran","eras","eramos","erais","sea","sean","seas","seamos","seais","este","esten","estes","estemos","esteis","siendo","estado","ser","estar"];const L=["who","whos","what","whens","whats","wheres","why","how","hows","which","whose","whom","whatever","whenever","wherever","however","whichever","whether"],K=["is","can","could","couldn","couldnt","should","shouldn","shouldnt","would","wouldn","wouldnt","does","doesnt","did","didnt","do","does","dont","where","when"],z=["i","me","my","mine","myself","we","us","our","ours","ourselves","you","your","youre","yours","yourself","yourselves","it","its","itself","they","them","their","theirs","themselves","this","that","these","those"],V=["slack","microsoft","google","github","sharepoint","gmail","jira","onedrive","linear"],U=["today","yesterday","tomorrow","week","weeks","month","months","recent","recently","current","currently","lately","latest","upcoming","ongoing"];function H({query:e,detectedLanguage:t,detectionTypes:n,userLocale:r,treatUnsupportedLanguageAsNaturalLanguage:o,filterStopWords:i}){const a=(0,u().l0)(e).stringWithoutQuotedTerms,s=(a??"").toLowerCase().replace(/[^\w\s]|_/gu," ").split(/\s+/),l=new Set(s),d=(0,c().Bu)(e,r);if("zh"===d&&a){if(function(e){const{unquotedQuery:t,detectionTypes:n}=e;if(n.includes("question_words")){if(t.endsWith("å—")||t.endsWith("å—Ž")||t.endsWith("å‘¢"))return!0;if(g.test(t))return!0;if(t.includes("æœ‰æ²¡æœ‰")||t.includes("æœ‰æ²’æœ‰")||t.includes("æœ‰å†‡"))return!0;if(h.test(t))return!0}return!!(n.includes("pronouns")&&f.test(t)||(n.includes("connector_names"),n.includes("time_frame")&&y.test(t)))}({unquotedQuery:a,detectionTypes:n}))return!0}else if("ko"===d&&a){if(function(e){const{unquotedQuery:t,detectionTypes:n}=e,r=(t??"").replace(/[^\p{L}\p{N}\s]|_/gu," ").split(/\s+/);if(n.includes("question_words")){if(v.test(t))return!0;if((t.endsWith("ê°€ìš”")||t.endsWith("ë‚˜ìš”"))&&!t.endsWith("ì¸ê¸°ê°€ìš”"))return!0}if(n.includes("pronouns")){if(b.test(t))return!0;if(r.some((e=>e.startsWith("ì´ê±°"))))return!0;if(r.some((e=>x.includes(e))))return!0}return!(!n.includes("connector_names")||!w.test(t))||!(!n.includes("time_frame")||!S.test(t))}({unquotedQuery:a,detectionTypes:n}))return!0}else if("ja"===d&&a){if(function(e){const{unquotedQuery:t,detectionTypes:n}=e,r=t.replace(/[.,\/#!$%\^&\*;:{}=\-_`~()ã€‚ã€ï¼Ÿ]/g,"");if(n.includes("question_words")){if(r.length>6){if(r.endsWith("ã‹"))return!0;if(r.endsWith("ãªã®"))return!0;if(r.endsWith("ã©ã†"))return!0}if(I.test(t)&&!k.test(t))return!0}return!(!n.includes("pronouns")||!T.test(t))||!(!n.includes("connector_names")||!M.test(t))||!(!n.includes("time_frame")||!C.test(t))}({unquotedQuery:a,detectionTypes:n}))return!0}else if("fr"===t&&a){if(function(e){const{detectionTypes:t}=e,n=e.unquotedQuery.toLowerCase(),r=function(e){const t=[[/(\b)l[''](\w)/gi,"$1le $2"],[/(\b)d[''](\w)/gi,"$1de $2"],[/(\b)j[''](\w)/gi,"$1je $2"],[/(\b)m[''](\w)/gi,"$1me $2"],[/(\b)t[''](\w)/gi,"$1te $2"],[/(\b)s[''](\w)/gi,"$1se $2"],[/(\b)n[''](\w)/gi,"$1ne $2"],[/(\b)c[''](\w)/gi,"$1ce $2"],[/(\b)qu[''](\w)/gi,"$1que $2"],[/(\b)au(\b)/gi,"Ã  le"],[/(\b)aux(\b)/gi,"Ã  les"],[/(\b)du(\b)/gi,"de le"],[/(\b)des(\b)/gi,"de les"],[/(\b)l' (\w)/gi,"le $2"],[/(\b)d' (\w)/gi,"de $2"]];let n=e;for(const[r,o]of t)n=n.replace(r,o);return n}(n??"").replace(/[-.!,;:_?\s]/gu," ").toLowerCase().split(/\s+/),o=new Set(r),i=new Set(r.map((e=>j(e))));if(t.includes("question_words")&&r.length>=3){if(A.some((e=>o.has(e))))return!0;const e=null==n?void 0:n.split(/[.!,;:]\s+/).map((e=>j(e.trim().split(/\s+/)[0]??""))).filter(Boolean);if(null!=e&&e.find((e=>B.includes(e))))return!0;if(j(n).includes("est-ce que"))return!0;const t=["est","sont","a","ont","peut","peuvent","doit","doivent"],i=["je","tu","il","elle","nous","vous","ils","elles"];for(let n=0;n<r.length-1;n++)if(t.includes(r[n])&&i.includes(r[n+1]))return!0}return!(!t.includes("pronouns")||!_.some((e=>i.has(e))))||!(!t.includes("connector_names")||!N.some((e=>i.has(e))))||!(!t.includes("time_frame")||!P.some((e=>i.has(e))))}({unquotedQuery:a,detectionTypes:n}))return!0}else if("es"===t&&a){if(function(e){const{detectionTypes:t}=e,n=e.unquotedQuery.toLowerCase(),r=n.replace(/[-.!,;:_?\s]/gu," ").toLowerCase().split(/\s+/),o=new Set(r.map((e=>j(e))));if(0===r.filter((e=>{const t=j(e);return!q.includes(t)&&!R.includes(t)&&"que"!==t&&"como"!==t})).length)return!1;if(t.includes("question_words")&&r.length>=2){if(R.some((e=>o.has(e))))return!0;if(r.includes("quÃ©"))return!0;const e=null==n?void 0:n.split(/[.!,;:]\s+/).map((e=>{var t;return j((null===(t=e.trim().split(/\s+/)[0])||void 0===t?void 0:t.toLowerCase())??"")})).filter(Boolean);if(null!=e&&e.find((e=>E.includes(e)))&&r.length>2)return!0;const t=["es","son","esta","estan","puede","pueden","debe","deben","tiene","tienen"];for(let n=0;n<r.length-1;n++)if(t.includes(j(r[n]))&&O.includes(j(r[n+1])))return!0}return!(!t.includes("pronouns")||!O.some((e=>o.has(e))))||!(!t.includes("connector_names")||!F.some((e=>o.has(e))))||!(!t.includes("time_frame")||!D.some((e=>o.has(e))))}({unquotedQuery:a,detectionTypes:n}))return!0}else if(o&&"en"!==t)return!0;if((a??"").includes("?")||(a??"").includes("ï¼Ÿ")||(a??"").includes("Â¿"))return!0;if(i){const e=function(e){const{query:t,stopWords:n}=e,r=((null==t?void 0:t.trim())??"").toLowerCase().replace(/[^\w\s]|_/gu," "),o=r.split(/\s+/),i=o.filter((e=>e.length>=m)),a=new Set(i);return Array.from(a).every((e=>n.has(e.trim())))}({query:a,stopWords:p});if(e)return!1}const H=[n.includes("question_words")?L:[],n.includes("pronouns")?z:[],n.includes("connector_names")?V:[],n.includes("time_frame")?U:[]];for(const c of H){if(c.some((e=>l.has(e))))return!0}if(n.includes("question_words")){const e=null==a?void 0:a.split(/[.!,;:]\s+/).map((e=>{var t;return null===(t=e.trim().split(/\s+/)[0])||void 0===t?void 0:t.toLowerCase()})).filter(Boolean);if(null!=e&&e.find((e=>K.includes(e))))return!0}return!1}var W=()=>n(979340),$=()=>n(209199),G=()=>n(383070);const Q=3,Y=3,Z=6;function X(e){const{query:t,searchSessionId:n,environment:i}=e,{is_query_natural_language:s,character_length:l,word_length:d,cjk_language:u,is_extended_question:p}=function(e){var t;const{query:n}=e,r=(null===(t=o().default.state.currentUserSettingsStore)||void 0===t||null===(t=t.getSettings())||void 0===t?void 0:t.preferred_locale)??$().q,i=(0,c().Bu)(n,r);if("zh"===i){if(Array.from(n).length<Q)return{is_query_natural_language:!1,cjk_language:"zh",character_length:Array.from(n).length,word_length:void 0,is_extended_question:!1}}else if("ja"===i){if(Array.from(n).length<2*Q)return{is_query_natural_language:!1,cjk_language:"ja",character_length:Array.from(n).length,word_length:void 0,is_extended_question:!1}}else{if("ko"===i&&Array.from(n).length<2*Q)return{is_query_natural_language:!1,cjk_language:"ko",character_length:Array.from(n).length,word_length:void 0,is_extended_question:!1};const e=(n??"").toLowerCase().replace(/[^\w\s]|_/gu," ").split(/\s+/),t=a().default.getConfigKey("ai_auto_stream_config","minWordCount")??Y;if(e.length<t)return{is_query_natural_language:!1,cjk_language:i,character_length:Array.from(n).length,word_length:e.length,is_extended_question:!1}}const s=H({query:n,detectedLanguage:"none"===i?(0,$().o_)(r):i,detectionTypes:["question_words"],userLocale:r,treatUnsupportedLanguageAsNaturalLanguage:!1,filterStopWords:!0});if(!s){if("zh"===i||"ja"===i||"ko"===i)return{is_query_natural_language:!1,cjk_language:i,character_length:Array.from(n).length,word_length:void 0,is_extended_question:Array.from(n).length/1.5>=Z};const e=(n??"").toLowerCase().replace(/[^\w\s]|_/gu," ").split(/\s+/);return{is_query_natural_language:e.length>=Z,cjk_language:i,character_length:Array.from(n).length,word_length:void 0,is_extended_question:e.length>=Z}}return{is_query_natural_language:s,cjk_language:i,character_length:Array.from(n).length,word_length:void 0,is_extended_question:!1}}({query:t,searchSessionId:n});return(0,r().u)({environment:i,event:{eventName:"natural_language_query_check_fired",eventProperties:{is_query_natural_language:s,character_length:l,word_length:d,cjk_language:u,search_session_id:n,is_extended_question:p}}}),s||p}function J(e){const{query:t,searchSessionId:n}=e,r=(0,l().K8)((()=>{var e;return!!(0,i().S)()&&(0,W().HO)(null===(e=(0,i().S)())||void 0===e?void 0:e.getSubscriptionTier())}),[]),o=(0,s().v3)(),a=(0,l().K8)((()=>X({query:t,searchSessionId:n,environment:o})),[o,t,n]);return{variant:(0,l().K8)((()=>r&&d().A.state.online&&a&&G().zD.isAnswerStreamingInSearchModalEnabled()?"auto_streaming":G().zD.shouldShowSearchMenuItemAskAI()&&d().A.state.online?"navigate_to_full_page":"none"),[r,a]),isNaturalLanguageQuery:a}}},933593:(e,t,n)=>{n.d(t,{Sh:()=>le,wS:()=>ie,Kg:()=>X().Kg,rx:()=>X().rx,iY:()=>X().iY,oj:()=>X().oj,GC:()=>te,yD:()=>ne,Rp:()=>oe});n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(823215),n(354520),n(672577),n(430670),n(581454),n(737550);var r=n.n(n(32485)),o=n(296540),i=()=>n(907258),a=()=>n(755531),s=()=>n(92697),l=()=>n(242422),d=()=>n(726637),c=()=>n(484714),u=()=>n(590526),p=()=>n(401497),m=()=>n(75435),h=()=>n(107975),g=()=>n(295633),f=()=>n(74351),y=()=>n(388926),v=()=>n(807449),b=()=>n(493552),x=()=>n(26697),S=()=>n(81068);function w({explanation:e,simple:t=!1,filterZeros:n=!1}){var r;return function e(r,o){if(!r)return[];const{value:i,description:a,details:s}=r;if(0===i&&n)return[];const l=(0===i?"0":i.toFixed(4)).padStart(8);function d(e,t=0){return`${"  ".repeat(o+t)}${e}`}const c=`[${l}] ${a}`;if(a.startsWith("match on required clause")){return[d(`[${l}] match on required clause ${null==s?void 0:s[1].description}`)]}if(["max of:","sum of:","min of:"].includes(a)&&1===(null==s?void 0:s.length))return e(s[0],o);if(a.startsWith("tf")||a.startsWith("idf")){var u;const e=a.split(",")[0],t=null===(u=a.split(" computed as ")[1])||void 0===u?void 0:u.replace(" from:","");return[d(`[${l}] ${e}: [${(s??[]).map((e=>`${e.description.split(",")[0]}=${e.value}`)).join(" ")}] --\x3e ${t}`)]}if(a.startsWith("ConstantScore(_id:"))return[d(`[${l}] ids query`)];const p=t&&0!==o&&(a.startsWith("weight")||a.startsWith("Function"));return[d(c.replace(", result of:","").replace(" from:","").replace(" [PerFieldSimilarity]","").replace(/:$/,"").trim()),...(p?[]:s??[]).flatMap((t=>e(t,o+1)))]}(null==e||null===(r=e.details)||void 0===r?void 0:r[0],0)}var I=()=>n(483034),k=()=>n(968610),T=()=>n(417104),M=()=>n(207289),C=()=>n(179034),j=()=>n(245241);var A=()=>n(470020),B=()=>n(931075),_=()=>n(536504),N=()=>n(69708),P=()=>n(100622),R=()=>n(676510),E=()=>n(534177),O=()=>n(284371),F=()=>n(257667),D=()=>n(629604),q=()=>n(422164),L=()=>n(720128),K=()=>n(187820),z=()=>n(128295),V=()=>n(16006),U=()=>n(447587),H=()=>n(815585),W=()=>n(288782),$=()=>n(751380),G=()=>n(646969),Q=()=>n(115512),Y=()=>n(240865),Z=()=>n(461131),X=()=>n(993273),J=n(474848);function ee(e,t){var a;const[s,l]=(0,o.useState)(!1),{focused:c,isLastInSection:m,inline:h,className:g}=e;(0,n(852507).w)((()=>{const t=oe(e.result);"query_results"===e.type&&t&&e.onEndTimeToRenderServerResults&&e.onEndTimeToRenderServerResults()}));const f=(0,p().IS)((()=>({menuItem:{minHeight:36,paddingTop:d().A.isMobile?12:8,paddingBottom:d().A.isMobile?12:8,transition:"none"},menuItemBorder:{},textWrapper:{alignItems:"center",width:"100%"},inlineTextWrapper:{alignItems:"center"},caption:{marginTop:1,color:P().Tj.text.secondary},timestamp:{fontSize:O().J.UISmall.desktop,fontWeight:O().Wy.regular,color:P().Tj.text.tertiary}})),[]),y=(0,p().IS)((()=>({hovered:{background:P().Tj.background.tertiaryTranslucent}})),[]),v=(0,u().O$)(i().AppStoreSidebarSpaceStore),b=(0,n(359941).V)({spaceStore:v}),x=(0,u().K8)((()=>{var t;if(e.hidePath)return!1;if(!b)return!e.store.isPersonProfile();return!(void 0===(null===(t=e.result)||void 0===t?void 0:t.workflowData)&&!(0,z().a6)(e.store))}),[b,e.store,e.hidePath,null===(a=e.result)||void 0===a?void 0:a.workflowData]),w=(0,u().K8)((()=>{var t;const n=null===(t=e.result)||void 0===t?void 0:t.store.isNavigableBlock();return se(e.result,n)}),[e.result]),I=(0,u().K8)((()=>{var t,o;const{isSurrogateCollection:i,collectionId:a}=e.result??{},u=i&&a?n(732810).m.createChildStore(e.store,{table:n(519831).Vl,id:a}):void 0,p=void 0!==(null===(t=e.result)||void 0===t?void 0:t.workflowData),v=null===(o=e.result)||void 0===o?void 0:o.workflowData;let b=null==v?void 0:v.icon;if(!b){const e=(0,_().Oy)({baseUrl:d().A.domainBaseUrl||"",shape:_().WJ,color:_().i});b=(0,_().Hy)(e)}return{title:u?(0,J.jsx)(n(301879).G,{collectionStore:u,hideCollectionViewBlockIcon:!0}):(0,J.jsx)(me,{store:e.store,result:e.result,placeholder:e.placeholder,index:e.index,focused:e.focused,inline:e.inline,type:e.type}),icon:p?(0,J.jsx)(K().B6,{disabled:!0,icon:{pointer:e.store.pointer,icon:b},iconRecordCategory:"workflow",isEmptyPage:!0,size:20,largeIcon:!1}):(0,J.jsx)(ae,{store:e.store}),caption:x?(0,J.jsx)(ge,{store:u??e.store,inline:e.inline,result:e.result,debugLocal:e.debugLocal,debugHits:e.debugHits,debugAreaRef:e.debugAreaRef,debugModalState:{explanationModalOpen:s,setExplanationModalOpen:l}}):void 0,body:v?v.description??void 0:w?(0,J.jsx)(le,{result:e.result}):void 0,right:(0,J.jsx)(pe,{focused:e.focused,type:e.type,lastViewed:e.lastViewed,result:e.result}),rightStyle:c?void 0:f.timestamp,dontShrinkRight:!0,captionStyle:f.caption,style:{...f.menuItem,...!h&&!m&&!c&&!e.isBeforeFocused&&f.menuItemBorder},spacerStyle:x?void 0:{visibility:"hidden"},textWrapperStyle:{...f.textWrapper,...e.inline&&f.inlineTextWrapper},className:r()("notranslate",g),buttonStyle:{paddingInlineStart:2},hoveredStyle:y.hovered}}),[y.hovered,g,s,c,h,m,e.debugAreaRef,e.debugHits,e.debugLocal,e.focused,e.index,e.inline,e.isBeforeFocused,e.lastViewed,e.placeholder,e.result,e.store,e.type,f.caption,f.inlineTextWrapper,f.menuItem,f.menuItemBorder,f.textWrapper,f.timestamp,x,w]),k=(0,u().K8)((()=>ne({result:e.result,queryId:e.queryId})),[e.queryId,e.result]),T=(0,o.useCallback)((e=>{e.preventDefault(),e.stopPropagation()}),[]),M=(0,o.useMemo)((()=>(0,J.jsx)(S().A,{ref:t,...e,...I,ignoreLocalHoverState:!0})),[t,e,I]);return k?(0,J.jsx)(n(620896).A,{href:k,onClick:T,children:M},k):M}const te=o.memo((0,o.forwardRef)(ee),((e,t)=>{var n,r;const o=t.focused!==e.focused,i=(null===(n=t.result)||void 0===n?void 0:n.highlight)!==(null===(r=e.result)||void 0===r?void 0:r.highlight),a=t.isLastInSection!==e.isLastInSection,s=t.isBeforeFocused!==e.isBeforeFocused;return o||i||a||s}));function ne(e){const{result:t,queryId:n,pageVisitSource:r,scrollToBlockId:o}=e;if(!t)return;const i=F().$f({result:t});return i?F().xg({result:i,queryId:n,pageVisitSource:r,scrollToBlockId:o}):void 0}function re({data:e}){const t=e;if(!t)return null;if("localSource"in t){const{localSource:e}=t,n=e||["unknown"];return{element:(0,J.jsx)(J.Fragment,{children:`from ${[...n].join(",")}`}),expanded:!1}}return null}function oe(e){return e&&!e.sources.includes(j().Ni.Local)}function ie({result:e,index:t}){var n;if(!e)return null;const r=(null===(n=e.sources??[])||void 0===n?void 0:n.flatMap((e=>e===j().Ni.Local?["ðŸ’»"]:e===j().Ni.ElasticSearch?["ðŸŒ"]:e===j().Ni.Postgres?["ðŸ˜"]:e===j().Ni.VectorDBBlock||e===j().Ni.VectorDBCollection?["ðŸ”­"]:e===j().Ni.VectorDBBlockOpenAI||e===j().Ni.VectorDBCollectionOpenAI?["ðŸ¤–"]:e===j().Ni.VectorDBBlockBGE||e===j().Ni.VectorDBCollectionBGE?["ðŸŽ¯"]:e===j().Ni.VectorDBBlockBGE1024||e===j().Ni.VectorDBCollectionBGE1024?["ðŸŽª"]:e===j().Ni.VectorDBBlockBGE4096||e===j().Ni.VectorDBCollectionBGE4096?["ðŸŽ¯"]:e===j().Ni.VectorDBBlockE5||e===j().Ni.VectorDBCollectionE5?["âš¡"]:e===j().Ni.ElasticsearchRandom?["ðŸŽ²"]:e===j().Ni.ElasticsearchUniqueID?["ðŸ†”"]:e===j().Ni.ElasticsearchForcedRecentRecall?["â°"]:e===j().Ni.NotionUnknown?["ðŸ¤·"]:e===j().Ni.UniversalUnknown?["ðŸ‘½"]:void(0,E().HB)(e))).reverse()).join("").trim();return r?(0,J.jsx)("span",{children:r}):null}function ae({store:e}){const t=(0,u().K8)((()=>e.getIcon()),[e]),n=(0,u().K8)((()=>e.isEmptyPage()),[e]),r=(0,u().K8)((()=>(0,K().Te)(e)),[e]);return(0,J.jsx)(K().B6,{disabled:!0,icon:t,iconRecordCategory:r,isEmptyPage:n,size:20,largeIcon:!1})}function se(e,t){var n,r,o,i;return!!e&&(!!(null!==(n=e.highlight)&&void 0!==n&&null!==(n=n.text)&&void 0!==n&&n.length||null!==(r=e.highlights)&&void 0!==r&&r.textHighlights.length||null!==(o=e.highlight)&&void 0!==o&&null!==(o=o.collectionText)&&void 0!==o&&o.length||null!==(i=e.highlights)&&void 0!==i&&null!==(i=i.collectionTextHighlight)&&void 0!==i&&i.length)&&!(t&&!oe(e)))}function le(e){var t,n,r,i,a,s,d,c,m,h,g,f;const{result:v}=e,b=(0,N().tz)(),S=(null==v||null===(t=v.sources)||void 0===t?void 0:t.includes(j().Ni.VectorDBBlock))||(null==v||null===(n=v.sources)||void 0===n?void 0:n.includes(j().Ni.VectorDBCollection))||(null==v||null===(r=v.sources)||void 0===r?void 0:r.includes(j().Ni.VectorDBBlockOpenAI))||(null==v||null===(i=v.sources)||void 0===i?void 0:i.includes(j().Ni.VectorDBCollectionOpenAI))||(null==v||null===(a=v.sources)||void 0===a?void 0:a.includes(j().Ni.VectorDBBlockBGE))||(null==v||null===(s=v.sources)||void 0===s?void 0:s.includes(j().Ni.VectorDBCollectionBGE))||(null==v||null===(d=v.sources)||void 0===d?void 0:d.includes(j().Ni.VectorDBBlockBGE1024))||(null==v||null===(c=v.sources)||void 0===c?void 0:c.includes(j().Ni.VectorDBCollectionBGE1024))||(null==v||null===(m=v.sources)||void 0===m?void 0:m.includes(j().Ni.VectorDBBlockBGE4096))||(null==v||null===(h=v.sources)||void 0===h?void 0:h.includes(j().Ni.VectorDBCollectionBGE4096))||(null==v||null===(g=v.sources)||void 0===g?void 0:g.includes(j().Ni.VectorDBBlockE5))||(null==v||null===(f=v.sources)||void 0===f?void 0:f.includes(j().Ni.VectorDBCollectionE5)),w=(0,u().K8)((()=>l().default.getEligibleGroup({experimentId:"search_highlight_client_variant",defaultGroup:"control"})),[]),I=(0,p().IS)((()=>({highlight:{color:"two_pane_1_snippet"===w?P().Tj.blue.text.accentPrimary:P().Tj.text.primary,fontWeight:O().Wy.medium,...S?{whiteSpace:"pre-wrap"}:{}},collectionTextMatchingProperty:{lineHeight:2,fontSize:12},moreIndicator:{color:P().Tj.text.primary,fontWeight:O().Wy.medium,marginInlineStart:4,cursor:"default"},snippetContainer:{paddingTop:"inline_2_snippets"===w?5:0,paddingBottom:"inline_2_snippets"===w?5:0},dividerWrapper:{paddingTop:2,paddingBottom:2}})),[S,w]),k=(0,u().K8)((()=>null==v?void 0:v.store.isNavigableBlock()),[null==v?void 0:v.store]);if(!v||!se(v,k))return null;const T=null==w||"control"===w||"two_pane_1_snippet"===w;if(v.highlights&&!T){const{textHighlights:e}=v.highlights;if(e&&e.length>0){const t="inline_2_snippets"===w?2:1,n=e.slice(0,t),r=e.length-t,i=(e=>e<=0?"":e<=10?b.formatMessage({id:"searchResultMenuItem.moreMatches.count",defaultMessage:"{count} more"},{count:e}):b.formatMessage({id:"searchResultMenuItem.moreMatches.tenPlus",defaultMessage:"10+ more"}))(r),a=b.formatMessage({id:"searchResultMenuItem.moreMatches.tooltip",defaultMessage:"{remainingCount, plural, one {{moreText} body match} other {{moreText} body matches}}"},{remainingCount:r,moreText:i});return(0,J.jsx)("div",{style:I.snippetContainer,children:n.map(((e,t)=>{const s=(0,$().Ay)(e.highlightedText),l=t===n.length-1,d=(0,$().fc)(e.highlightedText),c=(0,$().n3)(e.highlightedText);return(0,J.jsxs)(o.Fragment,{children:[(0,J.jsxs)("div",{children:[d?(0,J.jsx)("span",{children:"..."}):void 0,(0,J.jsx)(L().A,{text:e.highlightedText,highlighter:{tokenize:e=>(0,$().nB)(s),style:I.highlight}}),c?(0,J.jsx)("span",{children:"..."}):void 0,l&&r>0&&!c?(0,J.jsx)("span",{children:" â€”"}):void 0,l&&r>0?(0,J.jsx)(x().m,{renderTooltip:()=>a,render:e=>(0,J.jsx)("span",{style:I.moreIndicator,...e,children:i})}):void 0]}),l?void 0:(0,J.jsx)("div",{style:I.dividerWrapper,children:(0,J.jsx)(y().A,{size:8,colorVariant:"primary"})})]},t)}))})}}let C,A;const B=v.highlight;if(null!=B&&B.text)C=B.text;else if(null!=B&&B.collectionText){var _;C=B.collectionText,A=null==v||null===(_=v.matchedCollectionProperties)||void 0===_?void 0:_.collectionText}if(C=(0,M().KM)(C),!C)return null;const R=(0,$().Ay)(C);let E=!1;if(oe(v)){const e=e=>e.filter($().dJ).map((e=>e[0].toLowerCase())),t=t=>void 0===t?[]:e((0,$().Ay)(t)),n=[...new Set([...t(null==B?void 0:B.title),...t(null==B?void 0:B.pathText)])],r=e=>n.some((t=>t.includes(e)));E=e(R).every((e=>r(e)))}const F=E?{}:I.highlight,D=(0,J.jsxs)(J.Fragment,{children:[void 0!==A?(0,J.jsx)(q().mA,{propertySchema:A,showIcon:!0,style:I.collectionTextMatchingProperty}):void 0,(0,J.jsx)(L().A,{text:C,highlighter:{tokenize:e=>(0,$().nB)(R),style:F}})]});return"two_pane_1_snippet"===w?(0,J.jsx)(U().A,{maxLines:2,children:D}):D}function de(){return(0,J.jsx)(v().I,{icon:T().badgeCheckFillSmallIcon,size:"sm",colorPalette:"blue",colorVariant:"accentPrimary"})}function ce(){return(0,J.jsx)(v().I,{icon:I().archiveBoxFillSmallIcon,size:"sm",colorPalette:"gray",colorVariant:"secondary"})}function ue({result:e,focused:t}){var n;const r=null==e||null===(n=e.highlight)||void 0===n?void 0:n.uniqueId,o=(0,p().eP)(),i=(0,p().IS)((()=>({uniqueIDBadgeWrapper:{display:"flex",gap:8,marginInlineEnd:8,alignItems:"center"},divider:{borderInlineEnd:`1.5px solid ${t?"dark"===o?R().$.dark.translucentGray[300]:P().Tj.searchModalUniqueIdDividerFocused:"dark"===o?R().$.dark.translucentGray[200]:P().Tj.searchModalUniqueIdDivider}`,height:14,borderRadius:1}})),[t,o]),a=(0,$().PO)({words:r?[r]:[]});return r?(0,J.jsxs)("div",{style:i.uniqueIDBadgeWrapper,children:[(0,J.jsx)("div",{children:(0,J.jsx)(L().A,{text:r,highlighter:a})}),(0,J.jsx)("div",{style:i.divider})]}):null}function pe({focused:e,type:t,lastViewed:n,result:r}){const o=(0,c().v3)(),i=(0,u().K8)((()=>(0,G().i)(s().A.getState().tabs,s().A.getState().currentTab.id)),[]),a=(0,u().K8)((()=>{var e;return Boolean(null===(e=m().A.state.preferences)||void 0===e?void 0:e.isNewTabSearchEnabled)&&o.device.isElectron}),[o.device.isElectron]),l=(0,u().K8)((()=>(0,W().s)()),[]),h=l&&l===(null==r?void 0:r.id),g=a&&("tabs"===t||"query_results"===t&&i.some((e=>e.pageId===(null==r?void 0:r.id)&&"page"===e.type))),f=(0,p().IS)((()=>({right:{display:"flex"},rightIcon:{opacity:e?1:0,marginInlineEnd:6,marginTop:2},rightContentWrapper:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"},switchToTab:{fontSize:O().J.UISmall.desktop,fontWeight:O().Wy.regular,color:P().Tj.text.secondary,marginInlineEnd:4}})),[e]);if(d().A.isMobile)return null;if(n&&!e)return(0,J.jsx)(J.Fragment,{children:(0,H().nl)(n,{useCompactFormat:!0})});const y=g&&!h&&e;return(0,J.jsx)("div",{style:f.right,children:(0,J.jsxs)("div",{style:f.rightContentWrapper,children:[y?(0,J.jsx)("div",{style:f.switchToTab,children:(0,J.jsx)(N().sA,{id:"search.result.switchTab.text",defaultMessage:"Switch tab"})}):void 0,(0,J.jsx)(v().I,{icon:k().arrowTurnDownLeftFillSmallIcon,size:"xs",colorVariant:"tertiary",style:f.rightIcon})]})})}function me({store:e,result:t,placeholder:n,index:r,focused:s,inline:l,type:d}){var c,m;const h="query_results"===d,y=(0,p().IS)((()=>({title:{fontWeight:O().Wy.medium,lineHeight:"20px",...h&&!s&&{color:P().Tj.text.secondary}},titlePersonalPronoun:{fontWeight:O().Wy.medium,lineHeight:"20px",color:P().Tj.text.secondary},titleContent:{display:"flex",gap:6,...l?{}:{width:0,flexGrow:1}}})),[s,l,h]),v=null==t?void 0:t.workflowData,b=(0,u().K8)((()=>{const n=[];if(t&&t.highlight)if(n.push(...(0,$().oQ)(t.highlight.pathText)),oe(t))n.push(...(0,$().oQ)(t.highlight.title));else if(v)n.push(...(0,$().oQ)(t.highlight.text));else{g().B.createChildStore(e,{table:C().ev,id:t.id,spaceId:t.spaceId}).isNavigableBlock()&&n.push(...(0,$().oQ)(t.highlight.text))}return n}),[t,e,v]),x=(0,$().PO)({words:s?[]:b,highlightText:null==t||null===(c=t.highlight)||void 0===c?void 0:c.title}),S=(0,u().K8)((()=>{var t;return null===(t=(0,f().U)(e))||void 0===t?void 0:t.isArchived()}),[e]),w=function(e){if(e)return e.sources.includes(j().Ni.ElasticsearchUniqueID)}(t),I=(0,u().K8)((()=>(0,W().s)()),[]),k=I&&I===(null==t?void 0:t.id),T=(0,u().K8)((()=>{var t;if(!(e instanceof g().B))return!1;const n=null===(t=(0,a().S)())||void 0===t?void 0:t.getModel();if(!n||!(0,A().X)(n))return!1;return(0,B().dx)(e.getModel()).type}),[e]),M=(0,o.useMemo)((()=>{var e;return(null==t||null===(e=t.badges)||void 0===e?void 0:e.some((e=>"verified"===e.type)))||"verified"===T}),[null==t?void 0:t.badges,T]),_=(0,o.useMemo)((()=>{var e;const n=null==t||null===(e=t.badges)||void 0===e?void 0:e.some((e=>"archived"===e.type));return!M&&(n||"archived"===T)}),[null==t?void 0:t.badges,T,M]);const R=function(){function e(e){var n;return null==t||null===(n=t.badges)||void 0===n?void 0:n.find((t=>t.type===e))}for(const t of["is_template","popular_this_week","most_viewed","agent"]){const n=e(t);if(void 0!==n)return{type:n.type,label:n.label}}}(),E=(0,Y().V)()??0,F=(0,u().K8)((()=>E>1&&!k&&!S||"is_template"===(null==R?void 0:R.type)),[k,S,R,E])?R:void 0,D={is_template:()=>(0,J.jsx)(X().rx,{}),popular_this_week:()=>(0,J.jsx)(X().oj,{}),most_viewed:()=>(0,J.jsx)(X().iY,{}),agent:()=>(0,J.jsx)(X().Kg,{})},q=(0,u().K8)((()=>Z().Ay.state.showDebugInfo),[]),L=(0,u().K8)((()=>{var t;const n=null===(t=i().default.state.currentUserStore)||void 0===t?void 0:t.id;return Boolean(n&&e instanceof g().B&&e.isPersonProfile()&&e.getPersonProfileUserId()===n)}),[e]),K={style:y.title,store:e,placeholder:n,highlighter:x},z=L?(0,J.jsx)("div",{children:(0,J.jsx)(N().sA,{id:"search.result.title.you",defaultMessage:"{fullName} <you>(You)</you>",values:{fullName:(0,J.jsx)(V().A,{...K,shouldWrap:!0}),you:e=>(0,J.jsx)("span",{style:y.titlePersonalPronoun,children:e})}})}):v?(0,J.jsx)("span",{style:null==x?void 0:x.style,children:null==t||null===(m=t.workflowData)||void 0===m?void 0:m.name}):(0,J.jsx)(V().A,{...K});return(0,J.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",...y.title},children:[(0,J.jsxs)("div",{style:y.titleContent,children:[q&&void 0!==r?`${r+1}. `:void 0,w?(0,J.jsx)(ue,{focused:s,result:t}):void 0,z,M?(0,J.jsx)(de,{}):void 0,_?(0,J.jsx)(ce,{}):void 0,S?(0,J.jsx)(X().cF,{}):void 0,k?(0,J.jsx)(X().FN,{}):void 0,F?D[F.type](F.label):void 0]}),q?(0,J.jsx)(ie,{result:t,index:r}):void 0]})}function he(e,t){const{data:n,keyPath:r}=e;if(2===r.length&&"spanText"===r[1]&&"object"==typeof n&&null!==n&&"spanText"in n)return{element:(0,J.jsx)("span",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:`spanText: "${n.spanText}"`}),expanded:!0};if(2===r.length&&"_explanation"===r[0])return{element:(0,J.jsx)("button",{onClick:e=>{t(!0),e.stopPropagation()},children:"show simplified explanation"}),expanded:!1};const o=n._ltrlog;if(o)return function(e){const t=Object.keys(e[0])[0],n=e[0][t],r={paddingInlineStart:5,paddingInlineEnd:20,paddingTop:2,paddingBottom:2,border:"1px solid black",color:R().$.dark.green[900]},o={...r,color:R().$.dark.gray[30]},i=n.map(((e,t)=>{const n=t%2==0?o:r;return(0,J.jsxs)("tr",{children:[(0,J.jsx)("td",{style:n,children:`${t}`}),(0,J.jsx)("td",{style:n,children:`${e.name}`}),(0,J.jsx)("td",{style:n,children:`${e.value}`})]},e.name)}));return{element:(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)("div",{children:(0,J.jsx)("b",{children:`Featureset: ${t}`})}),(0,J.jsx)("div",{style:{maxHeight:200,overflowY:"scroll"},children:(0,J.jsx)("table",{style:{border:"1px solid black"},children:i})})]}),expanded:!1}}(o);if(!["_score","matched_queries"].every((e=>n[e])))return null;const{_score:i,matched_queries:a}=n;return{element:(0,J.jsx)(J.Fragment,{children:`score ${i}, ${(a??[]).length} matched query clauses`}),expanded:!1}}function ge({store:e,inline:t,result:n,debugLocal:r,debugHits:i,debugAreaRef:a,debugModalState:s}){var l,c;const m=(0,u().K8)((()=>Z().Ay.state.autoExpandDebugInfo),[]),f=(0,p().IS)((()=>({captionTooltip:{color:P().Tj.text.inversePrimary},captionTooltipDivider:{color:P().Tj.text.inversePrimary},debugArea:{fontFamily:"monospace",whiteSpace:"pre-wrap",wordBreak:"break-word"},breadcrumb:{height:"100%",flexGrow:0,marginInlineEnd:8,fontSize:10,minWidth:0},workflowBreadcrumb:{height:"100%",flexGrow:0,marginInlineEnd:8,fontSize:Q().Kw,minWidth:0,lineHeight:1.2,color:P().Tj.text.tertiary}})),[]),y=(0,o.useCallback)((e=>he(e,s.setExplanationModalOpen)),[s.setExplanationModalOpen]),v=(0,$().PO)({words:(0,$().oQ)(n&&n.highlight&&n.highlight.pathText),highlightText:null==n||null===(l=n.highlight)||void 0===l?void 0:l.pathText,removeDuplicate:!0}),x=t||d().A.isMobile?0:2,S=(i??[]).find((e=>"elasticsearch"===e.type&&void 0!==e._explanation)),I="elasticsearch"===(null==S?void 0:S.type)?null==S?void 0:S._explanation:void 0,k=(0,u().K8)((()=>Boolean(Z().Ay.getDebugLevel())),[]),T=(g().B,null==n?void 0:n.workflowData);return(0,J.jsxs)(J.Fragment,{children:[T?(0,J.jsx)(b().D,{styleKey:"captionRegular",colorVariant:"tertiary",style:f.workflowBreadcrumb,children:null===(c=n.highlight)||void 0===c?void 0:c.pathText}):(0,J.jsx)(z().Ay,{store:e,extraLength:x,showFullPathInTooltip:!0,highlighter:v,enableHoverAncestor:!0,tooltipStyle:f.captionTooltip,tooltipDividerStyle:f.captionTooltipDivider,hideMultiSourceParentCVB:!0}),(0,J.jsxs)("div",{ref:a,children:[r?(0,J.jsx)("div",{style:f.debugArea,children:(0,J.jsx)(D().H,{data:{debugLocal:r},defaultCollapsed:!m,customCollapsedRenderers:[re],showCopyButton:!1,showModalButton:!1})}):void 0,i?(0,J.jsx)("div",{style:f.debugArea,children:(0,J.jsx)(D().H,{data:{debugHits:i},defaultCollapsed:!m,customCollapsedRenderers:[y],showCopyButton:!0,showModalButton:!0})}):void 0,i&&null!=n&&n.rankingSignals?(0,J.jsx)("div",{style:f.debugArea,children:(0,J.jsx)(D().H,{data:{rankingSignals:n.rankingSignals},defaultCollapsed:!m,showCopyButton:!0,showModalButton:!1})}):void 0,k&&null!=n&&n.featureGroups?(0,J.jsx)("div",{style:f.debugArea,children:(0,J.jsx)(D().H,{data:{featureGroups:n.featureGroups},defaultCollapsed:!m,showCopyButton:!0,showModalButton:!1})}):void 0,I?(0,J.jsx)(h().a,{open:s.explanationModalOpen,innerStyle:{maxHeight:"90vh",maxWidth:"90vw",height:"90vh",width:"90vw",overflow:"scroll",padding:10},onDismiss:()=>s.setExplanationModalOpen(!1),render:()=>(0,J.jsx)("pre",{children:w({explanation:I}).join("\n")})}):void 0]})]})}},942715:(e,t,n)=>{n.d(t,{A:()=>g});n(581454);var r=n(296540),o=()=>n(726637),i=()=>n(590526),a=()=>n(250910),s=()=>n(546926),l=()=>n(114912),d=()=>n(890492),c=()=>n(663639);class u extends(()=>n(757695))().Store{getInitialState(){return{}}}const p=u;var m=n(474848);function h({isMenuItem:e,style:t,labelStyle:o,alignmentToOrigin:a,renderMenuSections:s,label:l,selectedTitle:d,focused:c,disabled:u,innerButtonStyle:h,buttonPopupStore:g},v){const b=(0,i().uB)(void 0,p),x=(0,i().uB)(g,n(118307).A),S=(0,n(401497).IS)((()=>({wrapper:{alignItems:"center",display:"flex",height:32,...t},label:{color:n(100622).Tj.text.tertiary,fontSize:14,marginInlineEnd:"auto",...o}})),[o,t]);return(0,r.useImperativeHandle)(v,(()=>({closeMenu:()=>{x.setState({...x.state,open:!1})}})),[x]),e?(0,m.jsx)(y,{alignmentToOrigin:a,isMenuItem:e,renderMenuSections:s,buttonPopupStore:x,selectButtonStore:b,renderOrigin:n=>(0,m.jsx)(f,{events:n,style:t,isMenuItem:e,label:l,selectedTitle:d,focused:c,disabled:u})}):(0,m.jsxs)("div",{style:S.wrapper,children:[l?(0,m.jsx)("div",{style:S.label,children:l}):void 0,(0,m.jsx)(y,{alignmentToOrigin:a,isMenuItem:e,renderMenuSections:s,buttonPopupStore:x,selectButtonStore:b,renderOrigin:e=>(0,m.jsx)(n(631524).p,{disabled:u,disabledFeedback:!0,style:{marginInlineEnd:-6,...h},iconTrailing:{icon:n(324254).arrowChevronSingleDownSmallIcon,size:"xs",colorVariant:u?"disabled":"secondary"},...e,children:d})})]})}const g=r.forwardRef(h);function f({events:e,style:t,isMenuItem:n,label:r,selectedTitle:o,focused:i,disabled:a}){if(n){const n=r?{title:r,right:o}:{title:o};return(0,m.jsx)(l()._,{...e,focused:Boolean(i),disabled:a,style:t,...n})}return null}function y({renderOrigin:e,alignmentToOrigin:t,isMenuItem:n,renderMenuSections:r,buttonPopupStore:l,selectButtonStore:u}){const p=(0,i().K8)((()=>u.state.selectedKey),[u]);return(0,m.jsx)(a().A,{popupType:o().A.isMobile?a().z.SlideUp:a().z.Popup,buttonPopupStore:l,alignmentToOrigin:void 0!==t?t:"end",renderOrigin:e,placementToOrigin:n?"right":"bottom",originGap:n?void 0:4,render:e=>{const{focusedIndex:t,menuSections:n}=function(e){const{parent:t,renderMenuSections:n,selectButtonStore:r,selectedKey:o}=e;let i,a=0;const s=n(t).map((e=>({...e,items:e.items.map((e=>(o&&e.key===o&&(i=a),a++,{...e,action:t=>{e.action(t),function(e,t){t.setState({selectedKey:e})}(e.key,r)}})))})));return{menuSections:s,focusedIndex:i}}({parent:e,renderMenuSections:r,selectButtonStore:u,selectedKey:p});return(0,m.jsx)(d().A,{menuType:o().A.isMobile?s().gu.ActionSheet:s().gu.Popup,children:(0,m.jsx)(c().A,{type:c().O.Vertical,initialFocus:t,sections:n})})}})}},943290:(e,t,n)=>{n.d(t,{BL:()=>p,BP:()=>m,Wd:()=>u,Wu:()=>T,iL:()=>x,j_:()=>M,qT:()=>c,s2:()=>C,wF:()=>w});n(16280),n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(354520),n(672577),n(430670),n(803949),n(581454);var r=n.n(n(794148)),o=()=>n(99895),i=()=>n(496603),a=()=>n(534177),s=()=>n(795727),l=()=>n(252050),d=()=>n(691309);function c(e){return e.flatMap((e=>"removedPage"===e.type||e.didCreatePage?e.operationIds:e.groupedEdits.flatMap((e=>e.operationIds))))}function u(e){return!p(e)}function p(e){return!("updatedPage"!==e.type||!e.didCreatePage)}function m(e){return"updatedPage"===e.type}class h{constructor(){this.parentToChildIndexMap=new(o().G)((e=>{if("database-views"===e.tagName)return new Map;const t=new Map;return e.children.forEach(((e,n)=>t.set(e.attributes.id,n))),t})),this.blockIdMap=new Map}getIndexInParentForBlock(e){return this.blockIdMap.set(e.attributes.id,e),(e.parent&&this.parentToChildIndexMap.get(e.parent).get(e.attributes.id))??0}getIndexInParentForBlockId(e){const t=this.blockIdMap.get(e);return t?this.getIndexInParentForBlock(t):0}}const g=["insertedBlocks","updatedBlocks"];function f(e){const{groupedEditType:t,group:n,block:r,executableOperation:o,blockIndexFinder:i}=e,s=r.parent?[r.parent.attributes.id,i.getIndexInParentForBlock(r)]:[void 0,0],l=n.groupedEditsByType[t].blocksByParent.get(s);"insertedBlocks"===t?n.groupedEditsByType[t].blocksByParent.set(s,{editId:r.attributes.id,type:t,blockIds:new Set([r.attributes.id,...(null==l?void 0:l.blockIds)??[]]),operationIds:[...(null==l?void 0:l.operationIds)??[],o.id]}):"updatedBlocks"===t?n.groupedEditsByType[t].blocksByParent.set(s,{editId:r.attributes.id,type:t,blockIds:new Set([r.attributes.id]),operationIds:[...(null==l?void 0:l.operationIds)??[],o.id]}):(0,a().HB)(t)}function y(e){const{group:t,block:n,executableOperation:r}=e,o=t.groupedEditsByType.removedBlocks;t.groupedEditsByType.removedBlocks={type:"removedBlocks",blockIds:new Set([...(null==o?void 0:o.blockIds)??[],n.attributes.id]),editId:(null==o?void 0:o.editId)??n.attributes.id,operationIds:[...(null==o?void 0:o.operationIds)??[],r.id]}}function v(e){const{group:t,executableOperation:n}=e;t.groupedEditsByType.updatedTitle={editId:`${t.pageId}.title`,type:"updatedTitle",blockId:t.pageId,operationIds:[n.id]}}function b(e){const{group:t,names:n,executableOperation:r}=e;0!==n.length&&t.groupedEditsByType.updatedProperties.push({editId:`${t.pageId}.properties`,type:"updatedProperties",propertyNames:new Set(n),operationIds:[r.id]})}function x(e){const t=new h,n=new(o().G)((e=>({type:"updatedPage",pageId:e,didCreatePage:!1,updatedTitle:!1,updatedPropertyNames:new Set,insertedBlockIds:new Set,updatedBlockIds:new Set,removedBlockIds:new Set,groupedEditsByType:{insertedBlocks:{blocksByParent:new(s().A)},removedBlocks:void 0,updatedBlocks:{blocksByParent:new(s().A)},updatedProperties:[],updatedTitle:void 0},extraOperationIds:[]}))),c=new(o().G)((e=>({type:"removedPage",pageId:e,operationIds:[]}))),{rootOperations:u,descendantOperationsMap:m,movedBlocks:x}=function(e){const t=new Map,n=new Set,r=new Set;for(const o of e){const e=w(o);t.set(e.attributes.id,e),"createBlock"===o.command||"insertBlockAfter"===o.command||"insertBlockBefore"===o.command||"setBlockProperty"===o.command||"setBlockText"===o.command||"setBlockAttribute"===o.command||"setBlockParent"===o.command?n.add(e.attributes.id):"moveBlock"===o.command&&r.add(e.attributes.id)}const i=[],a=new(o().G)((e=>[]));for(const o of e){const e=w(o),r=I(e).slice().reverse().find((e=>t.get(e.attributes.id)));r?a.get(r.attributes.id).push({...o}):"removeBlock"===o.command&&n.has(e.attributes.id)?a.get(e.attributes.id).push(o):i.push(o)}return{rootOperations:i,descendantOperationsMap:a,movedBlocks:r}}(e);for(const r of u){const e=w(r);if("moveBlock"===r.command||x.has(e.attributes.id)){const o=S(n,e);o.updatedBlockIds.add(e.attributes.id),f({groupedEditType:"updatedBlocks",group:o,block:e,executableOperation:r,blockIndexFinder:t})}else if("createBlock"===r.command||"insertBlockAfter"===r.command||"insertBlockBefore"===r.command){const o=[];for(const t of e.children)o.push(t.attributes.id);const i=Object.values(e.properties).filter((e=>"property-title"!==e.tagName)).map((e=>e.attributes.name));if(k(e)){const a=n.get((0,d().So)(e.attributes.id));a.didCreatePage=!0,i.forEach((e=>a.updatedPropertyNames.add(e))),o.forEach((e=>a.insertedBlockIds.add(e))),e.children.forEach((e=>{(0,l().gc)(e)||f({groupedEditType:"insertedBlocks",group:a,block:e,executableOperation:r,blockIndexFinder:t})})),(0,l().gc)(e)||f({groupedEditType:"insertedBlocks",group:a,block:e,executableOperation:r,blockIndexFinder:t}),b({group:a,names:i,executableOperation:r})}else{const o=S(n,e);o.insertedBlockIds.add(e.attributes.id),f({groupedEditType:"insertedBlocks",group:o,block:e,executableOperation:r,blockIndexFinder:t})}}else if("setBlockParent"===r.command){f({groupedEditType:"insertedBlocks",group:n.get(r.blockNode.attributes.id),block:r.blockNode,executableOperation:r,blockIndexFinder:t})}else if("removeBlock"===r.command)if(k(r.removeBlockNode)){c.get((0,d().So)(r.removeBlockNode.attributes.id)).operationIds.push(r.id)}else{const t=S(n,e);t.removedBlockIds.add(e.attributes.id),y({group:t,block:e,executableOperation:r})}else if("setBlockAttribute"===r.command||"setBlockTagName"===r.command||"setBlockText"===r.command||"setBlockProperty"===r.command||"insertOrMoveTableColumns"===r.command||"addBlockToPage"===r.command||"removeTableColumn"===r.command)if(k(r.blockNode)){const e=n.get((0,d().So)(r.blockNode.attributes.id)),t="setBlockText"===r.command;t&&(e.updatedTitle=!0);const o="setBlockProperty"===r.command?r.property.attributes.name:void 0;o&&e.updatedPropertyNames.add(o),t||"Title"===o?v({group:e,executableOperation:r}):o&&b({group:e,names:[o],executableOperation:r}),"addBlockToPage"===r.command&&(e.extraOperationIds.push(r.id),e.didCreatePage=!0)}else{const o=S(n,e);o.updatedBlockIds.add(r.blockNode.attributes.id),f({groupedEditType:"updatedBlocks",group:o,block:r.blockNode,executableOperation:r,blockIndexFinder:t})}else(0,a().HB)(r)}const T=[...n.entries()].map((([e,n])=>{if(!c.has(e)){if(n.didCreatePage)return function(e){var t,n;const{updatedPageGroup:o,descendantOperationsMap:a}=e;r()(o.didCreatePage);const{extraOperationIds:s,didCreatePage:l,groupedEditsByType:d,...c}=o;return{didCreatePage:!0,...c,operationIds:i().sb([...d.insertedBlocks.blocksByParent.valuesArray().flatMap((e=>e.operationIds)),...d.updatedBlocks.blocksByParent.valuesArray().flatMap((e=>e.operationIds)),...(null===(t=d.removedBlocks)||void 0===t?void 0:t.operationIds)??[],...(null===(n=d.updatedTitle)||void 0===n?void 0:n.operationIds)??[],...d.updatedProperties.flatMap((e=>e.operationIds)),...s,...[...a.values()].flat().map((e=>e.id))])}}({updatedPageGroup:n,descendantOperationsMap:m});{const e=function(e){const{updatedPageGroup:t,blockIndexFinder:n}=e;if(r()(!t.didCreatePage),t.extraOperationIds.length>0)throw new Error("Non page create update group contained unaccounted-for operations");const{groupedEditsByType:o,didCreatePage:s,extraOperationIds:l,...d}=t,c=[],{updatedProperties:u,updatedTitle:p}=o;p&&c.push(p);u.length>0&&c.push({type:"updatedProperties",editId:u[0].editId,operationIds:u.flatMap((e=>e.operationIds)),propertyNames:new Set(u.flatMap((e=>[...e.propertyNames])))});for(const r of g){const e=o[r].blocksByParent,t=[];for(;e.size>0;){const n=[e.keys().next().value],r=e.get(n[0]);for(t.push(r);e.size>0&&n.length>0;){const t=n.shift(),o=e.get(t);o&&(e.delete(t),r.operationIds.push(...o.operationIds),o.blockIds.forEach((e=>r.blockIds.add(e))),n.push([t[0],t[1]-1],[t[0],t[1]+1]))}}c.push(...t)}o.removedBlocks&&c.push(o.removedBlocks);for(const r of c){if((0,a().Xk)(g,r.type))if("insertedBlocks"===r.type||"updatedBlocks"===r.type){const e=i().Ul([...r.blockIds],(e=>n.getIndexInParentForBlockId(e)));r.blockIds=new Set(e)}else(0,a().HB)(r.type);r.operationIds=i().sb(r.operationIds)}return{didCreatePage:!1,...d,groupedEdits:c}}({updatedPageGroup:n,blockIndexFinder:t});return function(e){const{rootUpdatedPageGroup:t,descendantOperationsMap:n}=e;for(const r of t.groupedEdits)if("insertedBlocks"===r.type||"updatedBlocks"===r.type||"removedBlocks"===r.type)for(const e of r.blockIds){const o=n.get(e);for(const e of o)r.operationIds.push(e.id),"removeBlock"===e.command&&t.removedBlockIds.add(e.removeBlockNode.attributes.id)}return t}({rootUpdatedPageGroup:e,descendantOperationsMap:m})}}})).filter(a().O9),M=function(e){const{allGroups:t,rootOperations:n}=e,r=e=>{const{pageId:t}=e,r=n.find((e=>w(e).attributes.id===t)),o=r&&w(r),i=null==o?void 0:o.parent;return o&&i?i.children.findIndex((e=>e.attributes.id===t)):-1},o=t.slice().sort(((e,t)=>p(e)&&p(t)?r(e)-r(t):0));return o}({allGroups:[...T,...c.values()],rootOperations:u});return M}function S(e,t){const n=function(e){let t=e;for(;t;){if(k(t))return t;t=t.parent}}(t);if(!n)throw new Error(`No ancestor page found for block: ${t.attributes.id}`);return e.get(n.attributes.id)}function w(e){return"removeBlock"===e.command?e.removeBlockNode:"insertBlockAfter"===e.command||"insertBlockBefore"===e.command?e.insertBlockNode:e.blockNode}function I(e){let t=null==e?void 0:e.parent;const n=[];for(;t;){if(k(t))return n;n.push(t),t=t.parent}return n}function k(e){return"page"===e.tagName||"database"===e.tagName||"child-page"===e.tagName||"child-database"===e.tagName}function T(e){let t=0;for(const n of e)if("updatedPage"===n.type)t+=n.didCreatePage?1:n.groupedEdits.length;else{if("removedPage"!==n.type)return(0,a().HB)(n);t+=1}return t}function M(e){const{insertedBlockIds:t,updatedBlockIds:n,removedBlockIds:r,updatedTitle:o,updatedPropertyNames:i}=e;return t.size+n.size+r.size+(o?1:0)+i.size}function C(e){const{updatedPageGroups:t,executableOperations:n}=e,r=new Map;for(const i of n)r.set(i.id,{block:w(i),operation:i});const o=new Map;for(const i of t)if(i.didCreatePage)o.set(i.pageId,[i,void 0]);else{o.set(i.pageId,[i,void 0]);for(const e of i.groupedEdits)if("insertedBlocks"===e.type||"updatedBlocks"===e.type||"removedBlocks"===e.type)for(const t of e.operationIds){const n=r.get(t);if(n){const{block:t}=n;o.set(t.attributes.id,[i,e])}}}return{blockIdToPageGroupAndEdit:o}}},947171:(e,t,n)=>{n.d(t,{A:()=>k});n(18107),n(967357);var r=n.n(n(32485)),o=n(296540),i=()=>n(813974),a=()=>n(588165),s=()=>n(484714),l=()=>n(590526),d=()=>n(401497),c=()=>n(807449),u=()=>n(631524),p=()=>n(26697),m=()=>n(4688),h=()=>n(40457),g=()=>n(995847),f=()=>n(69708),y=()=>n(100622),v=()=>n(414706),b=()=>n(115512),x=()=>n(563253),S=n(474848);function w(e,t){const{inline:o,title:i,focused:a,className:s,blueOutlineFocused:u,compact:p,shouldShowArrowUp:m,shouldShowDismissButton:h,onClickDismissButton:g,type:f}=e,v=(0,d().IS)((()=>({hoveredStyle:{background:y().Tj.buttonHoveredBackground}})),[]),b=(0,d().IS)((()=>({style:{minHeight:36,paddingTop:8,paddingBottom:8,width:p?"min-content":"100%",display:"flex",transition:"none",...u?{boxShadow:y().Tj.focusedShadow,borderRadius:6}:{}},textWrapper:{alignItems:void 0,flex:void 0,display:"block",textOverflow:"ellipsis",...o&&{alignItems:"baseline"}}})),[o,u,p]),x=(0,l().K8)((()=>n(383070).zD.isDeepFindEnabled()),[]),w={title:i,icon:"topic"===f?(0,S.jsx)(c().I,{icon:n(877788).w}):x?(0,S.jsx)(c().I,{icon:n(207207).magnifyingGlassIcon,colorVariant:"secondary"}):(0,S.jsx)(c().I,{icon:n(529099).aiFaceIcon}),style:b.style,textWrapperStyle:b.textWrapper,right:(0,S.jsx)(I,{shouldShowArrowUp:m,shouldShowDismissButton:h,focused:a,onClickDismissButton:g}),className:r()("notranslate",s),buttonStyle:{paddingInlineStart:2,width:p?"min-content":void 0},hoveredStyle:v.hoveredStyle};return(0,S.jsx)(n(81068).A,{...e,...w,ignoreLocalHoverState:!0,ref:t})}function I(e){const{focused:t,shouldShowArrowUp:n,shouldShowDismissButton:r,onClickDismissButton:o}=e,{isElectron:w,isMac:I}=(0,s().Y0)(),{shortcut:k,shortcutString:T}=(0,l().K8)((()=>{var e;const t=i().getKeyboardShortcuts(),n=null===(e=(0,a().c)(t,"notionAiCommandSearchDefault"))||void 0===e?void 0:e.at(0);if(!n)return{shortcut:void 0,shortcutString:void 0};const r=(0,x().z_)(n,I);return{shortcut:r,shortcutString:(0,x().Vd)(r,I)}}),[I]),M=(0,d().IS)((()=>({container:{fontSize:b().Kw,color:y().Tj.icon.secondary}})),[]);return n?(0,S.jsx)(c().I,{icon:m().arrowStraightUpSmallIcon,size:"xs",colorVariant:"secondary"}):r?(0,S.jsx)(p().m,{renderTooltip:()=>(0,S.jsx)("div",{children:(0,S.jsx)(f().sA,{defaultMessage:"Donâ€™t show this again",id:"search.SearchAssistantMenuItem.dismissAITooltip"})}),render:e=>(0,S.jsx)(u().p,{size:"sm",shape:"pill",iconLeading:{icon:g().xMarkSmallIcon,size:"xs",colorVariant:"tertiary"},onClick:o,...e})}):t?(0,S.jsx)(c().I,{icon:h().arrowTurnDownLeftSmallIcon,size:"xs",colorVariant:"secondary"}):w&&k&&T?I?(0,S.jsx)(v().z,{shortcut:k}):(0,S.jsx)("div",{style:M.container,children:T}):null}const k=o.forwardRef(w)},957046:(e,t,n)=>{n.d(t,{T:()=>d});var r=()=>n(300474),o=()=>n(484714),i=()=>n(590526),a=()=>n(706021),s=()=>n(528093),l=()=>n(921738);function d(e){const{query:t,searchSessionId:n}=e,d=(0,o().v3)(),c=(0,r().r)(),u=(0,s()._)({name:"ai_usage",amount:1,spaceId:c??void 0,userId:d.currentUser.id}),p=(0,i().K8)((()=>(0,a().e2)(u)),[u]),{variant:m,isNaturalLanguageQuery:h}=(0,l().O)({query:t,searchSessionId:n});return{isNaturalLanguageQueryWithCredits:h&&p,aiSearchResultItemVariant:m,aiUsageAvailability:u,hasCreditsForAiUsage:p}}},968579:(e,t,n)=>{n.d(t,{Dk:()=>C,F6:()=>g,GC:()=>m,Km:()=>T,Lh:()=>w,N3:()=>y,Nm:()=>x,Or:()=>M,Uj:()=>v,Ut:()=>k,Wg:()=>j,XO:()=>d,aD:()=>I,d5:()=>b,dR:()=>p,lM:()=>S,w2:()=>h,xw:()=>f,yX:()=>c,zD:()=>u});n(16280),n(581454);var r=()=>n(973647),o=()=>n(902006),i=()=>n(251582),a=()=>n(832443),s=()=>n(252050),l=()=>n(331119);function d(e){return i().p.map((0,l().RB)({tagName:"load-page",attributeDefinitions:{id:{required:!0,values:!0,mappingMode:"block_counter"}},mapCounterToKey:e.mapCounterToKey}),(({attributes:e})=>({type:"observation",tagName:"load-page",attributes:e})))}function c(e){return i().p.map((0,l().RB)({tagName:"load-slack",attributeDefinitions:{id:{required:!0,values:!0,mappingMode:"external_id_counter"}},mapCounterToKey:e.mapCounterToKey}),(({attributes:e})=>({type:"observation",tagName:"load-slack",attributes:e})))}function u(e){return i().p.map((0,l().RB)({tagName:"load-google-drive",attributeDefinitions:{id:{required:!0,values:!0,mappingMode:"external_id_counter"}},mapCounterToKey:e.mapCounterToKey}),(({attributes:e})=>({type:"observation",tagName:"load-google-drive",attributes:e})))}function p(e){return i().p.map((0,l().RB)({tagName:"load-github",attributeDefinitions:{id:{required:!0,values:!0,mappingMode:"external_id_counter"}},mapCounterToKey:e.mapCounterToKey}),(({attributes:e})=>({type:"observation",tagName:"load-github",attributes:e})))}function m(e){return i().p.map((0,l().RB)({tagName:"load-github-code",attributeDefinitions:{id:{required:!0,values:!0,mappingMode:"external_id_counter"}},mapCounterToKey:e.mapCounterToKey}),(({attributes:e})=>({type:"observation",tagName:"load-github-code",attributes:e})))}function h(e){return i().p.map((0,l().RB)({tagName:"load-jira",attributeDefinitions:{id:{required:!0,values:!0,mappingMode:"external_id_counter"}},mapCounterToKey:e.mapCounterToKey}),(({attributes:e})=>({type:"observation",tagName:"load-jira",attributes:e})))}function g(e){return i().p.map((0,l().RB)({tagName:"load-linear",attributeDefinitions:{id:{required:!0,values:!0,mappingMode:"external_id_counter"}},mapCounterToKey:e.mapCounterToKey}),(({attributes:e})=>({type:"observation",tagName:"load-linear",attributes:e})))}function f(e){return i().p.map((0,l().RB)({tagName:"load-box",attributeDefinitions:{id:{required:!0,values:!0,mappingMode:"external_id_counter"}},mapCounterToKey:e.mapCounterToKey}),(({attributes:e})=>({type:"observation",tagName:"load-box",attributes:e})))}function y(e){return i().p.map((0,l().RB)({tagName:"load-salesforce",attributeDefinitions:{id:{required:!0,values:!0,mappingMode:"external_id_counter"}},mapCounterToKey:e.mapCounterToKey}),(({attributes:e})=>({type:"observation",tagName:"load-salesforce",attributes:e})))}function v(e){return i().p.map((0,l().RB)({tagName:"load-microsoft-teams",attributeDefinitions:{id:{required:!0,values:!0,mappingMode:"external_id_counter"}},mapCounterToKey:e.mapCounterToKey}),(({attributes:e})=>({type:"observation",tagName:"load-microsoft-teams",attributes:e})))}function b(e){return i().p.map((0,l().RB)({tagName:"load-sharepoint",attributeDefinitions:{id:{required:!0,values:!0,mappingMode:"external_id_counter"}},mapCounterToKey:e.mapCounterToKey}),(({attributes:e})=>({type:"observation",tagName:"load-sharepoint",attributes:e})))}function x(e){return i().p.map((0,l().RB)({tagName:"load-web-page",attributeDefinitions:{id:{required:!0,values:!0,mappingMode:"external_id_counter"}},mapCounterToKey:e.mapCounterToKey}),(({attributes:e})=>({type:"observation",tagName:"load-web-page",attributes:e})))}function S(e){return i().p.map((0,l().RB)({tagName:"load-attachment",attributeDefinitions:{id:{required:!0,values:!0,mappingMode:"attachment_id_counter"},attachmentType:{required:!0,values:["pdf"]}},mapCounterToKey:e.mapCounterToKey}),(({attributes:e})=>({type:"observation",tagName:"load-attachment",attributes:e})))}function w(e){return i().p.map((0,l().RB)({tagName:"load-database",attributeDefinitions:{id:{required:!0,values:!0,mappingMode:"collection_counter"}},mapCounterToKey:e.mapCounterToKey}),(({attributes:e})=>({type:"observation",tagName:"load-database",attributes:e})))}function I(e){return i().p.mapResult((0,l().U5)("load"),(t=>{const n=(0,l().x3)(t);if(r().Q.isFail(n))return n;const{id:i,...s}=t.attributes;if(void 0===i)return{error:new Error("<load> must have an 'id' attribute")};if(Object.keys(s).length>0)return{error:new Error("<load> cannot have any attributes other than 'id'")};const{mapCounterToKey:d}=e;if(!d)return{error:new Error("mapCounterToKey is required")};const c=a().tD.mapCounterToKeyInMode({mapCounterToKey:d},i,"block_counter","load");if(!c.error)return{value:{type:"observation",tagName:"load-page",attributes:{id:c.value}}};const u=a().tD.mapCounterToKeyInMode({mapCounterToKey:d},i,"collection_counter","load");if(!u.error)return{value:{type:"observation",tagName:"load-database",attributes:{id:u.value}}};const p=a().tD.mapCounterToKeyInMode({mapCounterToKey:d},i,"external_id_counter","load");if(!p.error){const e=(0,o().Tq)(p.value);if("web"===e)return{value:{type:"observation",tagName:"load-web-page",attributes:{id:p.value}}};if("slack"===e)return{value:{type:"observation",tagName:"load-slack",attributes:{id:(0,o().V9)(p.value)}}};if("google-drive"===e)return{value:{type:"observation",tagName:"load-google-drive",attributes:{id:(0,o().V9)(p.value)}}};if("github"===e)return{value:{type:"observation",tagName:"load-github",attributes:{id:(0,o().V9)(p.value)}}};if("githubCode"===e)return{value:{type:"observation",tagName:"load-github-code",attributes:{id:(0,o().V9)(p.value)}}};if("jira"===e)return{value:{type:"observation",tagName:"load-jira",attributes:{id:(0,o().V9)(p.value)}}};if("linear"===e)return{value:{type:"observation",tagName:"load-linear",attributes:{id:(0,o().V9)(p.value)}}};if("box"===e)return{value:{type:"observation",tagName:"load-box",attributes:{id:(0,o().V9)(p.value)}}};if("microsoft-teams"===e)return{value:{type:"observation",tagName:"load-microsoft-teams",attributes:{id:p.value}}};if("sharepoint"===e)return{value:{type:"observation",tagName:"load-sharepoint",attributes:{id:p.value}}}}return{error:new Error(`<load> with id ${i} could must be either a block or database ID.`)}}))}const k=[...["notion","onedrive",...o().fl],"web"],T=["document","spreadsheets","presentation","pdf","message","chat","thread","pull-request","code","issue","task","ticket","email","project"],M=i().p.map((0,l().RB)({tagName:"search",attributeDefinitions:{question:{required:!0,values:!0},keywords:{required:!0,values:!0},lookback:{required:!1,values:!0},"question-intl":{required:!1,values:!0},channel:{required:!1,values:!0},source:{required:!1,values:!0},sort:{required:!1,values:["latest"]},database:{required:!1,values:!0},"file-type":{required:!1,values:T},repo:{required:!1,values:!0},[s().HV]:{required:!1,values:["true"]},contributor:{required:!1,values:!0}},mapCounterToKey:void 0}),(({attributes:e})=>({type:"observation",tagName:"search",attributes:e}))),C=(i().p.map((0,l().RB)({tagName:"search",attributeDefinitions:{question:{required:!1,values:!0},keywords:{required:!0,values:!0},lookback:{required:!1,values:!0},"question-intl":{required:!1,values:!0},channel:{required:!1,values:!0},source:{required:!1,values:!0},sort:{required:!1,values:["latest"]},database:{required:!1,values:!0},"file-type":{required:!1,values:T},repo:{required:!1,values:!0},[s().HV]:{required:!1,values:["true"]},contributor:{required:!1,values:!0}},mapCounterToKey:void 0}),(({attributes:e})=>({type:"observation",tagName:"search",attributes:e}))),i().p.map((0,l().RB)({tagName:"search-people",attributeDefinitions:{search:{required:!0,values:!0}},mapCounterToKey:void 0}),(({attributes:e})=>({type:"observation",tagName:"search-people",attributes:e})))),j=i().p.map((0,l().RB)({tagName:"search-databases",attributeDefinitions:{search:{required:!0,values:!0}},mapCounterToKey:void 0}),(({attributes:e})=>({type:"observation",tagName:"search-databases",attributes:e})))},968610:(e,t,n)=>{n.r(t),n.d(t,{arrowTurnDownLeftFillSmallIcon:()=>o,iconDefinition:()=>r});n(296540);const r={viewBox:"0 0 16 16",fittedViewBox:"1.45 3.05 12.3 10.24",directional:!0,svg:(0,n(474848).jsx)("path",{d:"M12.25 3.8a.75.75 0 0 1 1.5 0v4a1.95 1.95 0 0 1-1.95 1.95H4.01l2.24 2.24a.75.75 0 1 1-1.06 1.06L1.67 9.53a.75.75 0 0 1 0-1.06l3.52-3.52a.75.75 0 0 1 1.06 1.06L4.01 8.25h7.79a.45.45 0 0 0 .45-.45z"})},o=(0,n(340498).wt)("arrowTurnDownLeftFillSmall",r,"fillSmall")},977570:(e,t,n)=>{n.d(t,{a:()=>v,F:()=>b});n(581454);var r=n(296540),o=()=>n(484714),i=()=>n(590526),a=()=>n(295633),s=()=>n(736847),l=()=>n(179034),d=()=>n(245241),c=(n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),()=>n(496603)),u=()=>n(700500);function p(e,t,n){const r=[];return m(t({table:l().ev,id:e}),t,r,!0,new Set,n),c().sb(r)}function m(e,t,n,r,o,i){if(!e)return;if(o.has(e.id))return;if(o.add(e.id),n.length>=i)return n;e.isType(u().Gz)&&n.push(e.id);const a=e.getType()===u().xd.transclusionReference&&e.getTransclusionReferenceTargetPointer();a&&m(t(a),t,n,!1,o,i);if(r||e.hasContent())for(const s of e.getContentIds())m(t({table:l().ev,id:s}),t,n,!1,o,i)}var h=()=>n(69708),g=()=>n(288782),f=()=>n(798693);const y=10;function v(e){const{spaceStore:t,environment:n}=e;if(t)return{shouldShow:!1,pageId:void 0};const r=(0,g().s)();if(!r)return{shouldShow:!1,pageId:void 0};const{hasPublicAccessPermission:o}=(0,f().E)(n);return{shouldShow:o,pageId:r}}function b(e){const{buildMenuListItem:t}=e??{},n=(0,o().v3)(),c=(0,h().tz)(),{isPublicPageContext:u,pageId:m}=(0,i().K8)((()=>{const e=(0,g().s)();if(!e)return{isPublicPageContext:!1,pageId:void 0};const{hasPublicAccessPermission:t}=(0,f().E)(n);return{isPublicPageContext:t,pageId:t?e:void 0}}),[n]),v=(0,i().K8)((()=>{if(u&&m)return new(a().B)(n,{table:l().ev,id:m})}),[n,m,u]),b=(0,i().K8)((()=>{if(!u||!v||!m)return[];return p(m,v.getRecordModel,y).map(((e,t)=>{const r=new(a().B)(n,{table:l().ev,id:e});return{store:r,id:r.id,score:-1,spaceId:r.getSpaceId(),sources:[d().Ni.Local],featureGroups:[],originalPosition:t,serverEventProperties:void 0}}))}),[v,n,u,m]),S=(0,r.useMemo)((()=>{if(!u||!t||0===b.length)return;return[{key:"sites-pages",items:b.map((e=>t(e))),render:e=>r.createElement(s().A,{...e,title:c.formatMessage(x.pages)})}]}),[t,u,b,c]);if(u&&0!==b.length)return{results:b,sections:S}}const x=(0,h().YK)({pages:{id:"search.default_page_body.pages",defaultMessage:"Pages"}})},980382:(e,t,n)=>{n.d(t,{I:()=>C});n(898992),n(354520);var r=()=>n(943290),o=()=>n(691309),i=(n(16280),n(944114),n(823215),n(672577),n(581454),n(737550),()=>n(295633)),a=()=>n(438632);function s(e){return function(e){const{beforeString:t,afterString:n}=e,r=(0,a().PD)(t,n).filter((([e])=>e!==a().cb.same)).length;return[r>5,{numberOfDiffs:r}]}(e)[0]}var l=()=>n(700500),d=()=>n(898244),c=()=>n(795727),u=()=>n(179034),p=()=>n(201980),m=()=>n(496603),h=()=>n(534177),g=()=>n(384944),f=()=>n(696419),y=()=>n(295304),v=()=>n(547149);function b(e){const{blockStore:t,property:n}=e,r=t.getSchema(),o=Object.entries(r||{}).find((([e])=>e===n)),i=null==o?void 0:o[1];return i?(0,d().QP)(i):void 0}function x(e,t){const{environment:n,isIncompleteAfter:r,editId:o}=t;return(0,f().x)({environment:n,from:"assistantDiff",before:e??[],after:[],isIncompleteAfter:r,insertionAnnotation:o?[p().Ifu.Inserted,o]:[p().Ifu.Inserted],deletionAnnotation:o?[p().Ifu.Deleted,o]:[p().Ifu.Deleted]})}function S(e,t){const{environment:n,isIncompleteAfter:r,editId:o}=t;return(0,f().x)({environment:n,from:"assistantDiff",before:[],after:e??[],isIncompleteAfter:r,insertionAnnotation:o?[p().Ifu.Inserted,o]:[p().Ifu.Inserted],deletionAnnotation:o?[p().Ifu.Deleted,o]:[p().Ifu.Deleted]})}function w(e){const{environment:t,transaction:n,blockStore:r,property:o,beforePropertyValue:i,afterPropertyValue:a,editId:s,isIncompleteAfter:l,dontDisplayRemoves:d}=e,u=function(e,t){if(!e||!t)return t;const n=e=>{if(!(0,p().qXl)(e))return;const[,t]=e;return(0,p().$CJ)(t)},r=e=>[e[0],{...e[1],date_format:void 0,time_format:void 0}];if(t.every((e=>!(0,p().uPN)(e).some(p().qsB)))||e.every((e=>!(0,p().uPN)(e).some(p().qsB))))return t;const o=e.map(n).filter(h().O9),i=new(c().A);for(const a of o){const e=r(a);i.set(e,a)}return t.map((e=>{const t=(0,p().uPN)(e).map((e=>{if(!(0,p().qsB)(e))return e;const t=r(e);return i.get(t)??e}));return(0,p().Ey_)((0,p().N8A)(e),t)}))}(i,a);if((i||u)&&!(0,p().MTk)(i,u)){let e=(0,f().x)({environment:t,from:"assistantDiff",before:i||[],after:u||[],isIncompleteAfter:l,insertionAnnotation:s?[p().Ifu.Inserted,s]:[p().Ifu.Inserted],deletionAnnotation:s?[p().Ifu.Deleted,s]:[p().Ifu.Deleted]});d&&(e=function(e){const t=e=>{if(!(0,p().BEe)(e))return!1;const[,t]=e;return t.some(p().XKU)};return e.filter((e=>!t(e)))}(e)),y().R9({environment:t,transaction:n,store:r.getPropertyStore(o),value:e})}}function I(e){const{environment:t,transaction:n,blockStore:r,property:o,beforePropertyValue:i,afterPropertyValue:a}=e;if((i||a)&&!(0,p().MTk)(i,a)){const s=x(i,e),l=S(a,e),d=s.concat([["\n"]]).concat(l);y().R9({environment:t,transaction:n,store:r.getPropertyStore(o),value:d})}}function k(e){const{environment:t,transaction:n,property:r,blockStore:o,originalPropertyValue:i}=e;y().R9({environment:t,transaction:n,store:o.getPropertyStore(r),value:x(i,e)})}function T(e){const{environment:t,transaction:n,property:r,blockStore:o,newPropertyValue:i}=e;y().R9({environment:t,transaction:n,store:o.getPropertyStore(r),value:S(i,e)})}var M=()=>n(371621);function C(e){const{assistantSessionContext:t,environment:n,processingBlockId:a}=e,d=t.getAllPendingOperations(),c=t.getAllPendingExecutableOperations(),h=(0,r().iL)(t.getAllPendingExecutableOperations()).filter(r().BP),{operations:f}=(0,o().g$)(d,(0,M().BB)({shouldCreateUnknownBlock:!1}),!0);!function(e){const{environment:t,operations:n,processingBlockId:o,caches:a,updatedPageGroups:d,executableOperations:c,originalCache:h=t.defaultRecordCache.inMemoryRecordCache}=e,f=t.currentUser.id;if(!f)throw Error("User is not logged in.");const{blockIdToPageGroupAndEdit:y}=(0,r().s2)({updatedPageGroups:d,executableOperations:c}),x=m().hS(m().oE(n.map((e=>{if(e.pointer.table===u().ev)return e.pointer}))),(e=>e.id));a.commitDiffPreviewTransaction({environment:t,transactionActions:v(),perform(e,n){for(const M of x){var r,d;const x=y.get(M.id);if(!x)continue;const C=new(i().B)(t,M,{inMemoryRecordCache:n}),j=null===(r=h.getEntry({pointer:M,userId:f},{ignoreAllCaches:!0}))||void 0===r||null===(r=r.value)||void 0===r?void 0:r.value,[A,B]=x;if(A.didCreatePage){const t=a.updatesCache.getEntry({pointer:M,userId:f},{ignoreAllCaches:!0});var c;t&&g().KY({store:C.getContentStore(),transaction:e,value:(null===(c=t.value.value)||void 0===c?void 0:c.content)??[]});continue}const _=null===(d=n.getEntry({pointer:M,userId:f},{ignoreAllCaches:!0}))||void 0===d||null===(d=d.value)||void 0===d?void 0:d.value,N=m().sb([...Object.keys((null==j?void 0:j.properties)??{}),...Object.keys((null==_?void 0:_.properties)??{})]),P=A.removedBlockIds.has(M.id),R=P&&(null==j?void 0:j.type)===l().xd.text&&void 0===(null==j?void 0:j.properties);R&&N.push("title");for(const r of N){var v,S;const i=b({blockStore:C,property:r});if(i&&"text"!==i)continue;const a=null==j||null===(v=j.properties)||void 0===v?void 0:v[r],l=null==_||null===(S=_.properties)||void 0===S?void 0:S[r],d={environment:t,transaction:e,temporaryCache:n,blockStore:C,property:r,beforePropertyValue:a,afterPropertyValue:l,isIncompleteAfter:M.id===o&&M.table===u().ev,editId:null==B?void 0:B.editId},c=s({beforeString:(0,p().q4_)(a),afterString:(0,p().q4_)(l)}),m=A.updatedBlockIds.has(M.id)&&(0,p().MTk)(a,l),h=P&&!R&&void 0===a;(0,p().MTk)(C.getPropertyValue("language"),[["Mermaid"]])?w({...d,dontDisplayRemoves:!0}):c&&"title"===r?I({...d}):m?T({...d,newPropertyValue:l}):R?k({...d,originalPropertyValue:(0,p().x9d)("        ")}):h||P?k({...d,originalPropertyValue:l}):w(d)}}},userAction:"assistantActions.displayTransactionDiff",userId:f,canUndo:!1})}({environment:n,operations:f,processingBlockId:a,caches:t.caches,updatedPageGroups:h,executableOperations:c})}},993273:(e,t,n)=>{n.d(t,{FN:()=>d,se:()=>c,Kg:()=>p,cF:()=>m,rx:()=>h,iY:()=>g,oj:()=>f});n(296540);var r=()=>n(970236),o=()=>n(69708),i=()=>n(401497),a=()=>n(100622);function s(){const e=(0,i().eP)();return(0,i().IS)((()=>({badge:{background:"light"===e?a().Tj.palette.blue[30]:a().Tj.palette.blue[200],display:"inline-flex",alignItems:"center",whiteSpace:"nowrap"},badgeContent:{display:"flex",alignItems:"center",width:"100%"},badgeCaption:{marginInlineStart:2,color:a().Tj.blue.text.accentPrimary},verifiedBadgeIcon:{width:10,height:10,fill:a().Tj.blue.icon.accentPrimary},grayedOutBadgeCaption:{marginInlineStart:1}})),[e])}var l=n(474848);function d(){const e=s();return(0,l.jsx)(r().E,{content:(0,l.jsx)("div",{style:e.grayedOutBadgeCaption,children:(0,l.jsx)(o().sA,{id:"search.result.current.page.badge.text",defaultMessage:"Current Page"})})})}function c(){const e=s();return(0,l.jsx)(r().E,{content:(0,l.jsx)("div",{style:e.grayedOutBadgeCaption,children:(0,l.jsx)(o().sA,{id:"search.result.database.badge.text",defaultMessage:"Database"})})})}var u=()=>n(245241);function p(){const e=(0,o().tz)(),t=s();return(0,l.jsx)(r().E,{content:(0,l.jsx)("div",{style:t.grayedOutBadgeCaption,children:e.formatMessage(u().Nz.agent)})})}function m(){const e=s();return(0,l.jsx)(r().E,{content:(0,l.jsx)("div",{style:e.grayedOutBadgeCaption,children:(0,l.jsx)(o().sA,{id:"search.result.teamArchived.badge.text",defaultMessage:"Archived"})})})}function h(){const e=(0,o().tz)(),t=s();return(0,l.jsx)(r().E,{content:(0,l.jsx)("div",{style:t.grayedOutBadgeCaption,children:e.formatMessage(u().Nz.template)})})}function g(){const e=(0,o().tz)(),t=s();return(0,l.jsx)(r().E,{style:t.badge,content:(0,l.jsx)("div",{style:t.badgeCaption,children:e.formatMessage(u().Nz.mostViewed)})})}function f(){const e=(0,o().tz)(),t=s();return(0,l.jsx)(r().E,{style:t.badge,content:(0,l.jsx)("div",{style:t.badgeCaption,children:e.formatMessage(u().Nz.popularThisWeek)})})}}}]);