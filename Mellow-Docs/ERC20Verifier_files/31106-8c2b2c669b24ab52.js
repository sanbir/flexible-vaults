"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[14344,31106,79349,95576],{110886:(e,t,o)=>{o.d(t,{X:()=>c,r:()=>l});o(18107),o(967357),o(581454);var i=()=>o(604995),r=()=>o(161479),n=()=>o(769864);const a=20,s=20;async function c(e,t){const{store:o,activityIds:i,spaceId:c,filterActivityTypes:l,filterDateRange:p,navigableBlockId:u,collectionIds:g,authorId:m,source:h}=t,v=i[0],y="person_profile"===h&&m?await n().callApi({eventName:"getRecentActivityFeed",environment:e,data:{spaceId:c,authorId:m,limit:s}}):await n().callApi({eventName:"getActivityLog",environment:e,data:{spaceId:c,navigableBlock:u?{id:u,spaceId:(0,r().e)(void 0)}:void 0,collections:g?g.map((e=>({id:e,spaceId:(0,r().e)(void 0)}))):void 0,endingBeforeId:v,limit:a,activityTypes:l,...d(p),authorId:m}});if("failed"===y.type)throw y.error;const S=y.data.activityIds;o.update((e=>({...e,shouldLoadNewerActivities:!1,activityIds:S.concat(i)})))}async function l(e,t){const{store:o,activityIds:i,spaceId:c,filterActivityTypes:l,filterDateRange:p,navigableBlockId:u,collectionIds:g,authorId:m,source:h}=t,v=i.at(-1),y="person_profile"===h&&m?await n().callApi({eventName:"getRecentActivityFeed",environment:e,data:{spaceId:c,startingAfterId:v,authorId:m,limit:s}}):await n().callApi({eventName:"getActivityLog",environment:e,data:{spaceId:c,navigableBlock:u?{id:u,spaceId:(0,r().e)(void 0)}:void 0,collections:g?g.map((e=>({id:e,spaceId:(0,r().e)(void 0)}))):void 0,startingAfterId:v,limit:a,activityTypes:l,...d(p),authorId:m}});if("failed"===y.type)throw y.error;const S=y.data.activityIds;o.update((e=>({...e,shouldLoadOlderActivities:!1,activityIds:i.concat(S),hasOlderActivities:S.length>0})))}function d(e){var t,o;const r=null!==(t=e.ending)&&void 0!==t&&t.start_date?i().C6.isoToUnixMs(e.ending.start_date):void 0;return{startingAfterTimeMs:null!==(o=e.starting)&&void 0!==o&&o.start_date?i().C6.isoToUnixMs(e.starting.start_date):void 0,endingBeforeTimeMs:r?i().K1({date:r,daysToAdd:1}):void 0}}},132389:(e,t,o)=>{o.d(t,{A:()=>r});o(296540);var i=o(474848);function r(e){const t={display:"inline-block",minWidth:e.size,minHeight:e.size};return"x"===e.axis?t.minHeight=1:"y"===e.axis&&(t.minWidth=1),(0,i.jsx)("div",{style:t})}},132533:(e,t,o)=>{o.d(t,{X:()=>s,l:()=>a});var i=o(296540),r=o(474848);const n={hoveredIndex:null,setHoveredIndex:()=>{}},a=(0,i.createContext)(n);function s(e){const{children:t}=e,[o,n]=(0,i.useState)(null),s=(0,i.useMemo)((()=>({hoveredIndex:o,setHoveredIndex:n})),[o]);return(0,r.jsx)(a.Provider,{value:s,children:t})}a.displayName="InboxNotificationHoverContext"},377093:(e,t,o)=>{o.d(t,{XO:()=>H,h3:()=>E,nZ:()=>W,pG:()=>V});o(944114),o(898992),o(823215),o(354520),o(803949),o(581454);var i=()=>o(314529),r=()=>o(564884),n=()=>o(907258),a=()=>o(365917),s=()=>o(675133),c=()=>o(295633),l=()=>o(732810),d=()=>o(433337),p=()=>o(716016),u=()=>o(898244),g=()=>o(617871),m=()=>o(165358),h=()=>o(388693),v=()=>o(792071),y=()=>o(179034),S=()=>o(332393),f=()=>o(96689),I=()=>o(854150),w=()=>o(496603),b=()=>o(534177),C=()=>o(935664),P=()=>o(769864),x=()=>o(803074),A=()=>o(896628),k=()=>o(235059),R=()=>o(969956),T=()=>o(928213),_=()=>o(339798),M=()=>o(254497),j=()=>o(312296),B=()=>o(999140),D=()=>o(601734),F=()=>o(395963),N=()=>o(838038),U=()=>o(547149),L=()=>o(155269);const K=(0,o(69708).YK)({aiCustomPromptDefaultPropertyName:{id:"collectionSettingsCreatePropertyActions.createProperty",defaultMessage:"Text"}});function O(e){const{environment:t,collectionContextStore:o,collectionUri:r,feature:n,transaction:a,addFeatureFrom:s,createFeatureStartTime:c}=e;if("dependencies"in n)for(const i of n.dependencies)"property"===i.type&&i.collectionUri===r&&(0,C().Z)({environment:t,collectionContextStore:o,from:"view_settings",property:i.uri,property_type:i.propertySchema.type,is_suggested_property:!0,property_id:i.uri,feature:{id:i.uri,from:s,type:n.uri}});if("dependencies"in n&&n.dependencies.map((e=>e.type)).every((e=>"property"===e))){const e=o.collectionViewStore(),t=o.getPropertyFormatKey(),i=o.normalizedFormatStore.state;if(t&&e){const o=i[t]||[],r=[...o];n.dependencies.forEach((e=>{const t=o.findIndex((t=>t.property===e.uri));-1===t?r.push({visible:!0,property:e.uri}):r[t]={...o[t],visible:!0}})),A().zA({stores:[e],update:{[t]:r},transaction:a})}}if(void 0!==n.propertyIdCollectionSettingToNavigateTo){const e={type:"property",property:n.propertyIdCollectionSettingToNavigateTo,selectNameInitial:!1,formatKey:o.getPropertyFormatKey()};_().a2({collectionSettingsStore:o.settingsStore,item:e})}a.postSubmitCallbacks.push((e=>{(0,i().DO_NOT_USE_trackLegacy)(t,"collection_create_suggested_property_latency",{collection_uri:n.collectionUri,feature_uri:n.uri,time:Date.now()-c,status:Boolean(e)?"fail":"success"})}))}async function E(e){var t;const{appTemplatesSetupActions:o,appTemplatesSprintBoardActions:i,appConfigs:r}=await D().Aw.load(),{environment:s,collectionContextStore:l,feature:u,addFeatureFrom:v,customPropertyName:w}=e,{sidebarSpaceViewStore:b}=n().default.state,C=l.collectionStore(),_=null==C?void 0:C.getParentBlockStore(),M={},j=e=>{(0,m().log)({level:"error",from:"collectionSettingsCreatePropertyActions",type:"handleCreateNewSuggestedProperty",data:{collectionId:null==C?void 0:C.id,miscDataToConvertToString:{featureUri:u.uri,addFeatureFrom:v,...M,...e}}})};if(!C||!_)return void j({hasCollectionStore:Boolean(C),hasCollectionViewBlockStore:Boolean(_)});if((0,R().u)(u))return async function(e){const{environment:t,collectionContextStore:o,feature:i,addFeatureFrom:r}=e,{untypedFeaturesSetupActions:n}=await D().Aw.load(),a=o.collectionStore(),s=null==a?void 0:a.getParentBlockStore();if(!a||!s)return;const c=Date.now();U().createAndCommit({environment:t,userAction:"collectionSettingsCreatePropertyActions.handleCreateNewUntypedFeature",canUndo:!0,perform:e=>{n.applyUntypedFeature({environment:t,collectionStore:a,collectionViewBlockStore:s,feature:i,transaction:e}),O({environment:t,collectionContextStore:o,collectionUri:d().iH,feature:i,transaction:e,addFeatureFrom:r,createFeatureStartTime:c})}})}({environment:s,collectionContextStore:l,feature:u,addFeatureFrom:v});const B=l.collectionViewStore(),F=null==_?void 0:_.getParentStore(),N=null==C||null===(t=C.getFormat())||void 0===t?void 0:t.app_config_uri,L=N&&(0,k().l)(r(),N);if(M.appConfigUri=L&&L.uri,!F||F.table!==f().NX&&F.table!==y().ev&&F.table!==I().yK||!L)return void j({hasAppParentStore:Boolean(F),appParentStoreTable:null==F?void 0:F.table,appConfigUri:L?L.uri:void 0});const K=C.getSchema(),E=_.getFormat().app_id;M.appId=E;const V=E?await P().callApi({eventName:"getCollectionViewBlocksByAppId",environment:s,data:{spaceId:_.getSpaceId(),appId:E}}):void 0,W="success"===(null==V?void 0:V.type)&&V.data.result.length?V.data.result.map((e=>c().B.createChildStore(F,{table:y().ev,id:e.blockId,spaceId:_.getSpaceId()}))):[_],H=u.integrationId;if(H){const e=a().A.getIntegrationsAsRecordMap().getValue({table:S().Li,id:H});if(!e||!(0,h().v_)(e))return void j({hasIntegration:Boolean(e)});await x().C4(s,C,e,Boolean(u.canOnlyAdminAuth))}H===g().ob&&K&&0===(0,p().yP)(K).length&&await T().c({environment:s,collectionStore:C});const z=Date.now();U().createAndCommit({environment:s,userAction:"collectionSettingsCreatePropertyActions.handleCreateNewSuggestedProperty",canUndo:!0,perform:e=>{var t;if(!b)return void j({hasCurrentSpaceViewStore:!1});const r=null===(t=C.getFormat())||void 0===t?void 0:t.app_config_uri;if(!r)return void j({hasCollectionUri:!1});const n=o.applyTypedFeatures({environment:s,spaceViewStore:b,appParentStore:F,appUri:L.uri,features:[{type:"simple",featureUri:u.uri}],transaction:e,createOrModify:"modify",appCollectionViewBlockStores:W,customPropertyName:w});i.createSprintPage({environment:s,spaceViewStore:b,appParentStore:F,transaction:e,blockStores:n,creationEntryPoint:{type:"sprint_relation"}}),"notion://tasks/sub_task_feature"===u.uri&&A().zA({stores:[C],update:{subitem_property:d().yx.SubTaskRelation},transaction:e}),"notion://tasks/task_dependencies_feature"===u.uri&&(A().zA({stores:[C],update:{collection_default_arrows_by:d().yx.BlockingRelation},transaction:e}),B&&A().zA({stores:[B],update:{timeline_arrows_by:{property:d().yx.BlockingRelation}},transaction:e})),O({environment:s,collectionContextStore:l,collectionUri:r,feature:u,transaction:e,addFeatureFrom:v,createFeatureStartTime:z}),e.isEmpty()&&j({isEmptyTransaction:!0})}})}function V({propertyType:e,collectionContextStore:t,propertyId:o}){const i=t.normalizedSchemaStore.state[o];if(i)switch(e){case"ai_custom_prompt":case"ai_summary":case"ai_extract":case"ai_translate":return _().a2({collectionSettingsStore:t.settingsStore,item:{type:"propertyAiAutofill",propertySchema:i,property:o}});case"ai_keywords":return _().a2({collectionSettingsStore:t.settingsStore,item:{type:"property",property:o,formatKey:t.getPropertyFormatKey()}});default:(0,b().HB)(e)}}function W(e){const{environment:t,collectionContextStore:i,propertyType:r,isSuggestedProperty:n,propertyName:a,propertyIcon:c,selectOptions:l,from:d,shouldOpenEditMenu:p=!0,newPropertyFormat:g}=e,m=i.collectionStore(),h=i.collectionViewStore(),v=i.getPropertyFormatKey(),y=i.normalizedFormatStore.state;if(!m)return;if("relation"===r)return void _().a2({collectionSettingsStore:i.settingsStore,item:{type:"selectRelationSource",property:void 0,initialPropertyName:a,formatKey:v,newPropertyFormat:g}});let S=a;"ai_custom_prompt"===r&&(S=s().A.formatMessage(K.aiCustomPromptDefaultPropertyName));const f=g&&v?{...y,[v]:g}:y,{performResult:I}=U().createAndCommit({userAction:"collectionSettingsCreatePropertyActions.handleCreateNewStandardProperty",environment:t,canUndo:!0,perform:e=>(0,L().createProperty)({environment:t,collectionStore:m,collectionViewArgs:h&&v?{collectionViewStore:h,format:f,formatKey:v}:void 0,propertyName:S,propertyIcon:c,propertyType:r,selectOptions:l,transaction:e})});p&&((0,u().hN)(r)?V({propertyType:r,propertyId:I,collectionContextStore:i}):_().n1({collectionSettingsStore:i.settingsStore,property:I,formatKey:v,selectNameInitial:!0}));const w="view_settings"===d?{feature:{id:I,from:"new_property",type:r}}:{};(0,C().Z)({environment:t,collectionContextStore:i,from:d,property_type:(0,u().v2)(r),property:(0,u().hN)(r)?r:void 0,is_suggested_property:n,property_id:I,...w}),n||i.userAddedPropertyStore.update((()=>!0)),I&&!(0,u().hN)(r)&&o.e(52315).then(o.bind(o,830213)).then((e=>{e.maybeTriggerDatabaseViewNudgeOnCreateProperty({environment:t,collectionContextStore:i,propertyId:I,propertyType:(0,u().v2)(r)})}))}async function H(e){const{environment:t,collectionContextStore:o,intl:i,connectedRelationProperty:n,from:a,untypedFeatureArgs:s,propertyGroupId:c,propertyLimit:l,skipDatabaseActions:d,propertyName:h}=e,y=o.collectionStore(),S=o.collectionViewStore(),f=o.getPropertyFormatKey();if(!y||!f)return;const I=n.integration.id;(0,g().XO)(I)||await x().C4(t,y,n.integration,Boolean(n.canOnlyAdminAuth));const P=y.getSchema();let A;I===g().ob&&P&&0===(0,p().yP)(P).length&&(A=await T().c({environment:t,collectionStore:y}));const k=y.getDeletedSchema(),R=(0,b().WP)(k).map((([e,t])=>{if(t&&u().UU(t)&&t.connectedRelation.integration_id===g().ob)return{propertyId:e,propertySchema:t}})).filter(b().O9);let B;if(!w().Im(R)){const e=R[0];B={propertyId:e.propertyId,update:await z({collectionStore:y,property:e})}}U().createAndCommit({environment:t,userAction:"collectionSettingsCreatePropertyActions.handleCreateNewConnectedRelationProperty",canUndo:!0,perform:e=>{const{shouldCreateNewProperty:p,restoredPropertyId:u}=function(e){const{environment:t,generatedPrefix:o,integrationId:i,propertyGroupId:r,collectionStore:n,collectionContextStore:a,collectionViewStore:s,formatKey:c,transaction:l,maybeRestoreDeletedProperty:d}=e;o&&(0,L().createProperty)({environment:t,collectionStore:n,collectionViewArgs:s?{collectionViewStore:s,format:s.getFormat(),formatKey:c}:void 0,propertyType:"auto_increment_id",transaction:l,propertyGroupId:r});if(null!=d&&d.propertyId){if(d.update){r&&(0,F().En)({collectionStore:n,groupId:r,propertyId:d.propertyId,transaction:l}),(0,j().F)({environment:t,collectionStore:n,update:d.update.updateSchema,transaction:l}),(0,M().E)({collectionStore:n,update:d.update.updateDeletedSchema,transaction:l});const e={type:"property",property:d.propertyId,formatKey:c};return _().a2({collectionSettingsStore:a.settingsStore,item:e}),{shouldCreateNewProperty:!1,restoredPropertyId:d.propertyId}}return(0,m().log)({level:"error",from:"collectionSettingsCreatePropertyActions",type:"handleCreateNewConnectedRelationProperty",data:{message:"Invalid property found in deleted_schema",collectionId:null==n?void 0:n.id,miscDataToConvertToString:{integration:i,maybeRestoreDeletedProperty:d}}}),(0,M().E)({collectionStore:n,update:{[d.propertyId]:null},transaction:l}),{shouldCreateNewProperty:!0}}return{shouldCreateNewProperty:!0}}({environment:t,generatedPrefix:A,transaction:e,propertyGroupId:c,collectionStore:y,collectionViewStore:S,collectionContextStore:o,integrationId:I,formatKey:f,maybeRestoreDeletedProperty:B});if(!p&&u)return u;const g=function(e){const{environment:t,transaction:o,collectionStore:i,collectionViewStore:r,collectionContextStore:n,intl:a,connectedRelationProperty:s,untypedFeatureArgs:c,propertyLimit:l,propertyName:d,formatKey:p}=e,u=s.integration.id,g=v().Bj6.fromIntegration(s.integration),m=x().qM({environment:t,pattern:s.pattern,integration:g,parentCollectionStore:i,transaction:o}),h=(0,L().createProperty)({environment:t,collectionStore:i,collectionViewArgs:r&&p?{collectionViewStore:r,format:r.getFormat(),formatKey:p}:void 0,propertyType:"relation",transaction:o,propertyId:null==c?void 0:c.propertyId});return N().cT({environment:t,collectionContextStore:n,collectionStore:i,property:h,propertyName:d&&d.length>0?d:s.name,propertyIcon:s.integration.info.icon,propertyLimit:l??"no_limit",targetCollectionStore:m,hasInverseRelation:!0,autoRelate:void 0,intl:a,connectedRelation:{integration_id:u},transaction:o}),h}({environment:t,transaction:e,collectionStore:y,collectionViewStore:S,collectionContextStore:o,intl:i,connectedRelationProperty:n,untypedFeatureArgs:s,propertyLimit:l,propertyName:h,formatKey:f});if((0,C().Z)({environment:t,collectionContextStore:o,from:"view_settings",property_id:g,property_type:"relation",integration_id:I,feature:{id:g,from:a,type:`notion://feature/connection_${I}`}}),!s)if(d){const e=y.getSchema(),i=null==e?void 0:e[g];_().a2({collectionSettingsStore:o.settingsStore,item:{type:"connectedRelationDatabaseActions",source:"connectedRelationAddProperties",rootPropertyId:g,integrationId:I,rootPropertySchema:i,skipDatabaseActions:!0,eventSource:"first_time_setup"}}),(0,r().u)({environment:t,event:{eventName:"salesforce_actions",eventProperties:{actionType:"add_properties_clicked",details:{source:"first_time_setup"},integrationId:I,collectionId:null==y?void 0:y.id}}})}else{const e={type:"property",property:g,formatKey:f};_().a2({collectionSettingsStore:o.settingsStore,item:e})}return g}})}async function z(e){const{property:{propertyId:t,propertySchema:o},collectionStore:i}=e,r=(0,u().Nv)(o);if((null==r?void 0:r.spaceId)!==i.getSpaceId())return;const n=l().m.createChildStore(i,r);if(await n.load(),null==n||!n.isDefined())return;if(n.getParentId()!==i.id)return;return(0,B().KA)({deletedSchema:i.getDeletedSchema(),property:t})}},423817:(e,t,o)=>{o.d(t,{J:()=>s});o(581454),o(296540);var i=()=>o(401497),r=()=>o(874832),n=()=>o(100622),a=o(474848);function s(e){let t=Math.floor(e.areaHeight/124);0===t&&(t=1);const o=(0,i().IS)((()=>({skeletonRect:{height:8,borderRadius:4,margin:10,backgroundColor:n().Tj.background.tertiaryTranslucent},skeletonCircle:{display:"flex",width:28,height:28,marginInlineEnd:8,backgroundColor:n().Tj.background.tertiaryTranslucent,borderRadius:20},skeletonSection:{display:"flex",width:"100%",margin:20,flexDirection:"row"}})),[8,10,20]),s=[...Array(t)].map(((e,t)=>(0,a.jsxs)("div",{style:o.skeletonSection,children:[(0,a.jsx)(r().P,{style:o.skeletonCircle}),(0,a.jsxs)("div",{style:{width:"80%"},children:[(0,a.jsx)(r().P,{style:{width:"80%",...o.skeletonRect,marginTop:0}}),(0,a.jsx)(r().P,{style:{width:"50%",...o.skeletonRect}}),(0,a.jsx)(r().P,{style:{width:"60%",...o.skeletonRect}}),(0,a.jsx)(r().P,{style:{width:"50%",...o.skeletonRect}})]})]},t)));return(0,a.jsx)("div",{children:s})}},479349:(e,t,o)=>{o.d(t,{XA:()=>T,cT:()=>_,Jf:()=>M});o(898992),o(823215);var i=o(296540),r=()=>o(907258),n=()=>o(755531),a=()=>o(484714),s=()=>o(590526),c=()=>o(391400),l=()=>o(757695),d=()=>o(269183),p=(o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(581454),()=>o(295633)),u=()=>o(723085),g=()=>o(350013),m=()=>o(144948),h=()=>o(150128),v=()=>o(381195),y=()=>o(564884),S=()=>o(553737);const f="1.4.0";class I{constructor(e){this.storageKeyPrefix="notion-sidebar-",this.store=new(S().Ay)({namespace:S().Bq,important:!1,trackingType:"performance"}),this.loggingEnabled=Math.random()<o(242422).default.getConfigKey("sidebar_cache_logging_config","sample_rate"),this.environment=e}async get(e){try{await this.store.waitUntilReady();const t=this.storageKeyPrefix+e,{duration:o,result:i}=w((()=>this.store.get(t)));return i?i.version!==f?(this.logRead({duration:o,status:"stale",result:i}),void this.clear(e)):(this.logRead({duration:o,status:"success",result:i}),i):void this.logRead({duration:o,status:"missing"})}catch(t){return void this.logRead({status:"failure"})}}set(e,t){try{const o=this.storageKeyPrefix+e,{duration:i}=w((()=>this.store.set(o,t)));this.logWrite({duration:i,status:"success",result:t})}catch(o){this.logWrite({status:"failure",result:t})}}clear(e){try{const t=this.storageKeyPrefix+e;this.store.remove(t)}catch(t){}}logRead({duration:e,status:t,result:o}){this.loggingEnabled&&(0,y().u)({environment:this.environment,event:{eventName:"sidebar.cache_access_attempt",eventProperties:{time:e,type:"read",status:t,size_kb:o&&"object"==typeof o?this.calculateSizeKb(o):0,source:"local_storage"}}})}logWrite({duration:e,status:t,result:o}){this.loggingEnabled&&(0,y().u)({environment:this.environment,event:{eventName:"sidebar.cache_access_attempt",eventProperties:{time:e,type:"write",status:t,size_kb:this.calculateSizeKb(o),source:"local_storage"}}})}calculateSizeKb(e){try{const t=JSON.stringify(e),o=new Blob([t]).size;return Math.round(o/1024)}catch{return 0}}}function w(e){const t=performance.now(),o=e();return{duration:Math.round(performance.now()-t),result:o}}function b(e,t){return`sidebar-state-${e}-${t}`}function C(e,t){const o=new(p().B)(t,e.pointer);return void 0!==e.title||void 0!==e.icon?o.createFastRenderBlockStore(e.title??[],e.icon):o}function P(e){const t=e.isDefined()?e.getTitleValue():[],o=e.isDefined()?e.getIcon():void 0,i=null==o?void 0:o.icon;return{pointer:e.pointer,title:t,icon:i}}function x(e){const t=e.isDefined()?e.getName():"",o=e.isDefined()?e.getRawIcon():void 0,i=e.isDefined()?(0,v().O)({teamStore:e}):[];return{pointer:e.pointer,name:t,icon:o,pages:i.map(P)}}function A(e){const t=e.isDefined()?e.getData():void 0,o=null==t?void 0:t.name,i=null==t?void 0:t.icon;return{pointer:e.pointer,title:o,icon:i}}const k=new class{constructor(){this.cache=void 0,this.pendingResults=new Map,this.results=new Map,this.cachedThisSession=new Set,this.disabledCacheKeys=new Set}getCache(e){return this.cache||(this.cache=new I(e)),this.cache}getCachedSidebarStateResult(e,t){const o=`${e}:${t}`;if(!this.disabledCacheKeys.has(o))return this.results.get(o)}async getCachedSidebarState(e,t,o){const i=`${e}:${t}`;if(this.disabledCacheKeys.has(i))return;if(this.results.has(i))return this.results.get(i);if(this.pendingResults.has(i))return this.pendingResults.get(i);const r=this.readFromStorage(e,t,o).then((e=>{if(!this.disabledCacheKeys.has(i))return this.results.set(i,e),e})).catch((()=>{}));return this.pendingResults.set(i,r),r}async readFromStorage(e,t,o){const i=b(e,t),r=await this.getCache(o).get(i);if(r)try{return function(e,t){return{isCached:!0,spaceViewId:e.spaceViewId,spaceId:e.spaceId,spaceName:e.spaceName,userId:e.userId,isMember:e.isMember,isPersonalSpace:e.isPersonalSpace,showBookmarksSection:e.showBookmarksSection,showWorkspaceSection:e.showWorkspaceSection,showSharedSection:e.showSharedSection,showPrivateSection:e.showPrivateSection,showChatsSection:e.showChatsSection,showSharedOverflowButton:e.showSharedOverflowButton,showPrivateOverflowButton:e.showPrivateOverflowButton,showOnlyPrivateSection:e.showOnlyPrivateSection,shownSidebarSectionCount:e.shownSidebarSectionCount,showTeamsOverflowButton:e.showTeamsOverflowButton,stickTemplateItemsToBottom:e.stickTemplateItemsToBottom,showTeamSection:e.showTeamSection,showCrossWorkspaceGuestPagesPrototype:e.showCrossWorkspaceGuestPagesPrototype,showEmptySharedSection:e.showEmptySharedSection,showNotionAppsSection:e.showNotionAppsSection,showMeetingsTodaySection:e.showMeetingsTodaySection,showMeetingsSection:e.showMeetingsSection,showRecentsSection:e.showRecentsSection,allSharedPagesStores:[],allPrivatePagesStores:[],userJoinedTeamsStores:[],visibleNotionApps:e.visibleNotionApps,visibleSharedPagesStores:e.visibleSharedPagesStores.map((e=>C(e,t))),visiblePrivatePagesStores:e.visiblePrivatePagesStores.map((e=>C(e,t))),bookmarkedPagesStores:e.bookmarkedPagesStores.map((e=>C(e,t))),workspacePagesStores:e.workspacePagesStores.map((e=>C(e,t))),visibleTeamsStores:e.visibleTeamsStores.map((e=>function(e,t){const o=new(u().h)(t,e.pointer);if(void 0!==e.name||void 0!==e.icon||e.pages.length>0)return(0,m().x)({store:o,environment:t,name:e.name??"",icon:e.icon,cachedTeamPagesStores:e.pages.map((e=>C(e,t)))});return o}(e,t))),visibleWorkflowStores:e.visibleWorkflowStores.map((e=>function(e,t){const o=new(g().N)(t,e.pointer);if(void 0!==e.title||void 0!==e.icon)return(0,h().J)({store:o,environment:t,name:e.title??"",icon:e.icon});return o}(e,t))),isTeamContentReady:!0,userSharedPagesForSpaceHasLoaded:!0,sidebarOrder:e.sidebarOrder}}(r,o)}catch(n){return void this.getCache(o).clear(i)}}cacheSidebarState({spaceId:e,userId:t,sidebarState:o,environment:i}){const r=b(e,t),n=`${e}:${t}`;var a;if(!this.cachedThisSession.has(n))try{const e={spaceViewId:(a=o).spaceViewId,spaceId:a.spaceId,spaceName:a.spaceName,userId:a.userId,isMember:a.isMember,isPersonalSpace:a.isPersonalSpace,showBookmarksSection:a.showBookmarksSection,showWorkspaceSection:a.showWorkspaceSection,showSharedSection:a.showSharedSection,showPrivateSection:a.showPrivateSection,showChatsSection:a.showChatsSection,showSharedOverflowButton:a.showSharedOverflowButton,showPrivateOverflowButton:a.showPrivateOverflowButton,showOnlyPrivateSection:a.showOnlyPrivateSection,shownSidebarSectionCount:a.shownSidebarSectionCount,showTeamsOverflowButton:a.showTeamsOverflowButton,stickTemplateItemsToBottom:a.stickTemplateItemsToBottom,showTeamSection:a.showTeamSection,showCrossWorkspaceGuestPagesPrototype:a.showCrossWorkspaceGuestPagesPrototype,showEmptySharedSection:a.showEmptySharedSection,showNotionAppsSection:a.showNotionAppsSection,showMeetingsTodaySection:a.showMeetingsTodaySection,showMeetingsSection:a.showMeetingsSection,showRecentsSection:a.showRecentsSection,visibleNotionApps:a.visibleNotionApps,visibleSharedPagesStores:a.visibleSharedPagesStores.map(P),visiblePrivatePagesStores:a.visiblePrivatePagesStores.map(P),bookmarkedPagesStores:a.bookmarkedPagesStores.map(P),workspacePagesStores:a.workspacePagesStores.map(P),visibleTeamsStores:a.visibleTeamsStores.map(x),visibleWorkflowStores:a.visibleWorkflowStores.map(A),sidebarOrder:a.sidebarOrder,cachedAt:Date.now(),version:f};this.getCache(i).set(r,e),this.cachedThisSession.add(n)}catch(s){}}disableCache({spaceId:e,userId:t}){const o=`${e}:${t}`;this.disabledCacheKeys.has(o)||(this.disabledCacheKeys.add(o),this.pendingResults.delete(o),this.results.delete(o))}isCacheDisabled(e,t){const o=`${e}:${t}`;return this.disabledCacheKeys.has(o)}clearCachedSidebarState({spaceId:e,userId:t,environment:o}){const i=b(e,t),r=`${e}:${t}`;this.getCache(o).clear(i),this.pendingResults.delete(r),this.results.delete(r)}};const R=10;function T({sidebarState:e,userId:t,spaceId:o,isInitialPageRenderCompleted:i}){return!!(e&&t&&o&&!e.isCached&&e.visiblePrivatePagesStores.every((e=>{var t;return e.isReady()&&((null===(t=e.getTitleStore())||void 0===t?void 0:t.isReady())??!0)}))&&e.visibleSharedPagesStores.every((e=>{var t;return e.isReady()&&((null===(t=e.getTitleStore())||void 0===t?void 0:t.isReady())??!0)}))&&e.bookmarkedPagesStores.slice(0,R).every((e=>{var t;return e.isReady()&&((null===(t=e.getTitleStore())||void 0===t?void 0:t.isReady())??!0)}))&&e.visibleWorkflowStores.every((e=>e.isReady()))&&e.isTeamContentReady&&i)}function _({isFreshStateReady:e,userId:t,spaceId:o}){const{enableSidebarStateCache:r}=(0,d().b8)(t),[n]=(0,i.useState)((()=>l().Store.createValue(r&&t&&o?k.getCachedSidebarStateResult(o,t):void 0,{name:"cachedSidebarStateStore"})));(0,i.useEffect)((()=>{r&&e&&t&&o&&k.disableCache({spaceId:o,userId:t})}),[r,e,t,o]);const s=(0,a().v3)();return(0,i.useEffect)((()=>{r&&t&&o&&!k.isCacheDisabled(o,t)&&k.getCachedSidebarState(o,t,s).then((e=>n.setState(e)))}),[t,o,s,r,n]),n}function M({sidebarState:e}){const t=(0,a().v3)(),{userId:o,spaceId:l,isInitialPageRenderCompleted:p}=(0,s().K8)((()=>{var e,t;return{userId:null===(e=r().default.state.currentUserStore)||void 0===e?void 0:e.id,spaceId:null===(t=(0,n().S)())||void 0===t?void 0:t.id,isInitialPageRenderCompleted:c().A.state.initialRenderCompleted}}),[]),{enableSidebarStateCache:u}=(0,d().b8)(o);(0,i.useEffect)((()=>{T({sidebarState:e,userId:o,spaceId:l,isInitialPageRenderCompleted:p})&&o&&l&&e&&(u?k.cacheSidebarState({spaceId:l,userId:o,sidebarState:e,environment:t}):k.clearCachedSidebarState({spaceId:l,userId:o,environment:t}))}),[o,l,p,e,u,t])}},495576:(e,t,o)=>{o.d(t,{d:()=>k});var i=o(296540),r=()=>o(968578),n=()=>o(484714),a=()=>o(590526),s=()=>o(69708),c=()=>o(896628),l=()=>o(401497),d=()=>o(534177),p=()=>o(738471),u=o(474848);function g({src:e,placeholderSrc:t,placeholderBehavior:o,imageStyle:r,containerStyle:n,onLoadComplete:a,testId:s}){const[c,g]=(0,i.useState)(!0);let m;switch(o){case"force-show-placeholder":m=!0;break;case"force-show-src":m=!1;break;case"show-placeholder-if-loading-src":m=!!t&&(c||void 0===e);break;default:(0,d().HB)(o)}const h=(0,l().IS)((()=>{const e={gridColumn:1,gridRow:1};return{container:{display:"grid",...n},srcWrapper:{...m&&{display:"none"},...e},placeholderWrapper:{pointerEvents:"none",...e}}}),[n,m]);(0,i.useEffect)((()=>{void 0!==e&&g(!0)}),[e]);const v=(0,i.useCallback)((e=>{g(!1),null==a||a()}),[a]);return(0,u.jsxs)("div",{style:h.container,children:[(0,u.jsx)(p().A,{src:e,onLoad:v,style:r,placeholderStyle:h.srcWrapper,placeholderLoadedStyle:h.srcWrapper,testId:s}),t?(0,u.jsx)(p().A,{src:t,style:r,placeholderStyle:h.placeholderWrapper,placeholderLoadedStyle:h.placeholderWrapper}):void 0]})}var m=()=>o(19771),h=()=>o(360083),v=()=>o(801678),y=()=>o(504023),S=()=>o(821507),f=()=>o(568365),I=()=>o(77246),w=()=>o(867772),b=()=>o(547149),C=()=>o(79926);const P=new(C().O2)("AnimatedCoverImageActionBar",(async()=>Promise.all([o.e(75134),o.e(35530),o.e(36556),o.e(55373),o.e(36192),o.e(27992),o.e(63452),o.e(66249),o.e(87249),o.e(79022),o.e(34877),o.e(12039),o.e(40454)]).then(o.bind(o,166913)))),x=(0,C()._h)(P,(e=>e.AnimatedCoverImageActionBar)),A=280;function k(e){const{store:t,disabled:o,paddingRight:l,paddingLeft:d,height:p,proxyWidth:C}=e,P=(0,s().tz)(),k=(0,n().v3)(),T=(0,n().Y0)(),_=(0,a().uB)(void 0,r().A),M=(0,a().K8)((()=>o||"suggest"===I().Uv.getMode(t)||(0,S().aD)(T)),[o,t,T]),j=(0,a().K8)((()=>t.getCover()),[t]),B=(0,a().O$)(f().M),D=(0,y().x)(t.id),[F,N]=(0,i.useState)(void 0);if(!j)return null;const U=B.loadingMode!==w().pF&&B.loadingMode!==w().Wc;return(0,u.jsx)(v().A,{mouseStore:_,onFlushTemporaryPosition:e=>function(e,t,o){const{imagePosition:i,reset:r}=e;b().createAndCommit({userAction:"PageCover.handleFlushTemporaryPosition",environment:o,canUndo:!0,perform:e=>{c().yY({store:t,coverPosition:i,transaction:e}),r()}})}(e,t,k),renderControl:({handleRepositionClick:e,handleSavePositionClick:o,handleCancelClick:i,isVisible:r,isRepositioning:n})=>M?null:(0,u.jsx)(x,{store:t,mouseStore:_,imageUrl:F,handleRepositionClick:e,handleSavePositionClick:o,handleCancelClick:i,visible:r||D,isRepositioning:n,paddingLeft:d,paddingRight:l}),source:"page",store:t,style:{display:"flex",flexDirection:"column",alignItems:"center",height:p,maxHeight:A,cursor:"default"},preventClickPropagation:!0,render:e=>(0,u.jsxs)(i.Fragment,{children:[(0,u.jsx)(h().A,{url:j.cover,isAuthenticated:!0,permissionRecord:j.pointer,width:C,onFinishedLoadingProxyUrl:N,render:(t,o)=>{const i={width:"100%",height:p,maxHeight:A,objectFit:"cover",opacity:U?.5:1,objectPosition:`center ${100*(1-(e.imagePosition||0))}%`,borderRadius:0},r={width:"100%",height:p,maxHeight:A};return(0,u.jsx)(g,{src:o,placeholderSrc:U?B.dataURL:void 0,placeholderBehavior:U?"force-show-placeholder":"show-placeholder-if-loading-src",containerStyle:r,imageStyle:i,onLoadComplete:R,testId:"pageCover"})}},j.pointer.id),U?(0,u.jsx)(m().X,{variant:"spinner",percentage:B.uploadProgress,text:void 0!==B.uploadProgress?void 0:B.progressText}):D?(0,u.jsx)(m().X,{variant:"dots",text:P.formatMessage({id:"CoverImageActionBar.generatingCover",defaultMessage:"Generating..."})}):void 0]})})}function R(){f().M.reset()}},554413:(e,t,o)=>{o.d(t,{Cn:()=>r,oV:()=>s,tK:()=>a});o(581454);var i=()=>o(534177);let r=function(e){return e[e.Sidebar=0]="Sidebar",e[e.SidebarMobile=1]="SidebarMobile",e[e.TopbarMobile=2]="TopbarMobile",e[e.RenderAsPage=3]="RenderAsPage",e}({});const n=new Map;function a(e,t){n.set(c(e),t)}function s(e){return n.get(c(e))??[]}function c(e){return(0,i().uv)(e).sort().map((t=>{const o=e[t];return JSON.stringify(o)})).join("-")}},563692:(e,t,o)=>{o.r(t),o.d(t,{iconDefinition:()=>i,xMarkFillSmallIcon:()=>r});o(296540);const i={viewBox:"0 0 16 16",fittedViewBox:"3.03 3.03 9.94 9.94",svg:(0,o(474848).jsx)("path",{d:"M12.73 4.33a.75.75 0 1 0-1.06-1.06L8 6.94 4.33 3.27a.75.75 0 1 0-1.06 1.06L6.94 8l-3.67 3.67a.75.75 0 1 0 1.06 1.06L8 9.06l3.67 3.67a.75.75 0 0 0 1.06-1.06L9.06 8z"})},r=(0,o(340498).wt)("xMarkFillSmall",i,"fillSmall")},568365:(e,t,o)=>{o.d(t,{M:()=>i});const i=new(o(867772).Ay)},589407:(e,t,o)=>{o.r(t),o.d(t,{ellipsisIcon:()=>r,iconDefinition:()=>i});o(296540);const i={viewBox:"0 0 20 20",fittedViewBox:"2.62 8.62 14.76 2.76",svg:(0,o(474848).jsx)("path",{d:"M4 11.375a1.375 1.375 0 1 0 0-2.75 1.375 1.375 0 0 0 0 2.75m6 0a1.375 1.375 0 1 0 0-2.75 1.375 1.375 0 0 0 0 2.75m6 0a1.375 1.375 0 1 0 0-2.75 1.375 1.375 0 0 0 0 2.75"})},r=(0,o(340498).wt)("ellipsis",i,"default")},591197:(e,t,o)=>{o.d(t,{VY:()=>s,ZJ:()=>n,u3:()=>a});var i=()=>o(140934);class r extends(()=>o(757695))().Store{getInitialState(){return{popupRenderedInPage:!1,popupRenderedInPeekView:!1}}}const n=new r,a=new(i().ComputedStore)((()=>!1!==n.state.popupRenderedInPage),{debugName:"AssistantWriterRenderedInPageStore"}),s=new(i().ComputedStore)((()=>!1!==n.state.popupRenderedInPeekView),{debugName:"AssistantWriterRenderedInPeekViewStore"})},722267:(e,t,o)=>{o.d(t,{L:()=>i});class i extends(()=>o(757695))().Store{getInitialState(){return{activityIds:[],shouldLoadNewerActivities:!1,shouldLoadOlderActivities:!0,hasOlderActivities:!0,filterActivityTypes:[],filterDateRange:{starting:void 0,ending:void 0}}}}},753721:(e,t,o)=>{o.d(t,{X:()=>n});var i=()=>o(590526),r=()=>o(391400);function n(){return(0,i().K8)((()=>r().A.state.initialRenderCompleted),[])}},780863:(e,t,o)=>{o.d(t,{p:()=>c});var i=o(296540),r=()=>o(40845),n=()=>o(496603),a=()=>o(440024);const s={isRepositioning:!1};function c(e){const{currentPosition:t,imageUrl:o,onSavePosition:c,onPositionChange:l,rootRef:d,environment:p}=e,[u,g]=(0,i.useState)(s),{isRepositioning:m}=u,h=(0,i.useCallback)((()=>{g(s)}),[]),v=(0,i.useMemo)((()=>void 0!==u.temporaryPosition?u.temporaryPosition:t),[u.temporaryPosition,t]);(0,i.useEffect)((()=>{l&&l(v)}),[v,l]);const y=(0,i.useCallback)((e=>{(0,a().I)({environment:p});const t=new Image;t.onload=()=>{g((e=>({...e,isRepositioning:!0,image:t})))};const i=e||o;i&&(t.src=i)}),[p,o]),S=(0,i.useCallback)((()=>{c(v),h()}),[c,v,h]),f=(0,i.useCallback)((()=>{h()}),[h]);(0,i.useEffect)((()=>{const e=e=>{const t=d.current;t&&e.target instanceof Node&&!t.contains(e.target)&&m&&S()};return m&&window.addEventListener("mousedown",e),()=>{window.removeEventListener("mousedown",e)}}),[m,S,d]);const I=(0,i.useCallback)((e=>{const{image:t}=u;if(!t||!m)return;const o=d.current;if(o&&o instanceof Element){const e=o.getBoundingClientRect().width/t.width*t.height;g((t=>({...t,startDragImageScreenHeight:e,startDragRenderedPosition:v})))}}),[u,m,v,d]),w=(0,i.useCallback)((e=>{if(!m)return;const{startDragImageScreenHeight:t,startDragRenderedPosition:o}=u,i=e.diffY/(t||0)+(o||0);g((e=>({...e,temporaryPosition:(0,n().LI)((0,r().A)(i,0,1),4)})))}),[m,u]),b=(0,i.useCallback)((()=>{g((e=>({...e,startDragImageScreenHeight:void 0,startDragRenderedPosition:void 0})))}),[]),C=(0,i.useMemo)((()=>m?"ns-resize":"default"),[m]);return{isRepositioning:m,currentImagePosition:v,handleDragStart:I,handleDragMove:w,handleDragEnd:b,handleStartReposition:y,handleSavePosition:S,handleCancelReposition:f,repositioningCursor:C}}},792526:(e,t,o)=>{o.d(t,{A:()=>l});o(296540);var i=()=>o(401497),r=()=>o(807449),n=()=>o(302501),a=()=>o(829548),s=()=>o(284371),c=o(474848);function l(e){const{message:t,title:o,iconOptions:l}=e,d=(0,i().IS)((()=>({wrapper:{textAlign:"center",paddingInlineStart:20,paddingInlineEnd:20,height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",overflow:"hidden",minHeight:220},message:{marginTop:2,marginBottom:4,maxWidth:380,textWrap:"balance"},title:{fontWeight:s().Wy.medium,maxWidth:380,textWrap:"balance"}})),[]),p=l||{icon:a().y,colorPalette:"gray",colorVariant:"tertiary"};return(0,c.jsxs)("div",{style:d.wrapper,children:[(0,c.jsx)("div",{style:{paddingBottom:6},children:(0,c.jsx)(r().I,{...p,size:"xl"})}),(0,c.jsx)(n().A,{style:d.title,isSecondaryColor:!0,children:o}),(0,c.jsx)(n().A,{style:d.message,isSecondaryColor:!0,children:t})]})}},801678:(e,t,o)=>{o.d(t,{A:()=>h});var i=o(296540),r=()=>o(756117),n=()=>o(590526),a=()=>o(609679),s=()=>o(69708),c=()=>o(100622),l=()=>o(496603),d=()=>o(806080),p=()=>o(284371),u=()=>o(720665),g=()=>o(46986),m=o(474848);const h=function(e){const t=(0,i.useRef)(null),r=(0,o(484714).v3)(),{renderControl:a,onFlushTemporaryPosition:s,style:c,source:p,store:h}=e,y=(0,n().K8)((()=>0===o(206051).default.state.stores.length),[]),[S,f]=(0,i.useState)(!1),I=(0,n().uB)(e.mouseStore,o(968578).A),w=(0,n().K8)((()=>I.state.mouseEntered),[I]),b=(0,n().K8)((()=>function(e,t){if("gallery"===e||"board"===e){const e=t.getFormat().card_cover_position;if((0,d().Et)(e))return e}const o=.5;var i;if((0,g().V)())return(null===(i=t.getCover())||void 0===i?void 0:i.cover_position)??o;if(t.isCollectionView()){const e=t.getCollectionStoreIfSingleSource();if(e){const t=e.getFormat().collection_cover_position;return(0,u().pN)(t)?o:t}}const r=t.getFormat(),n=r.page_cover_position;if((0,d().Et)(n))return n;return o}(p,h)),[p,h]),{isRepositioning:C,currentImagePosition:P,handleDragStart:x,handleDragMove:A,handleDragEnd:k,handleStartReposition:R,handleSavePosition:T,handleCancelReposition:_,repositioningCursor:M}=(0,o(780863).p)({currentPosition:b,onSavePosition:e=>{s({imagePosition:e,reset:()=>{I.reset()}})},rootRef:t,environment:r}),j=(0,o(401497).IS)((()=>({dragContainer:{width:"100%",cursor:M},container:{position:"relative",width:"100%",zIndex:1}})),[M]);C&&!y&&_();const B=(0,i.useMemo)((()=>(0,l().nF)((e=>{I.setState({...I.state,mouseEntered:!0})}),100)),[I]),D=(0,i.useMemo)((()=>(0,l().sg)((e=>{I.setState({...I.state,mouseEntered:!1})}),100)),[I]),F=(0,i.useCallback)(((e,t)=>{R(t)}),[R]),N=(0,i.useCallback)((e=>{T()}),[T]),U=(0,i.useCallback)((e=>{const t=e.target;void 0!==t&&t instanceof HTMLElement&&(0,o(819121).p)(t)&&f(!0)}),[]),L=(0,i.useCallback)((()=>{f(!0)}),[]),K=(0,n().K8)((()=>a({handleRepositionClick:F,handleSavePositionClick:N,handleCancelClick:_,isVisible:w||S||C,isRepositioning:C})),[F,N,_,S,C,w,a]),O=(0,o(870956).A)(Boolean(e.preventClickPropagation));return(0,m.jsxs)("div",{ref:t,onFocus:U,onBlur:L,onMouseEnter:B,onMouseMove:B,onMouseLeave:D,...O,...(0,o(451306).ow)(j.container,c),children:[(0,m.jsx)(o(222321).A,{onDraggableDragStart:x,onDraggableDragMove:A,onDraggableDragEnd:k,onDraggableDragCancel:k,disabled:!C,render:t=>(0,m.jsx)("div",{style:j.dragContainer,...t,children:e.render({imagePosition:P,isRepositioning:C})})}),(0,m.jsx)(v,{small:e.small,isRepositioning:C}),K]})};function v({small:e,isRepositioning:t}){if(e)return null;const o={background:c().IF.blackWithAlpha(.4),borderRadius:4,color:c().oZ.white,fontSize:12,fontFamily:p().vc(a().locale).sans,width:180,insetInlineStart:"calc(50% - 90px)",padding:"0.3em 1.5em 0.3em",pointerEvents:"none",position:"absolute",top:"calc(50% - 10px)",textAlign:"center"};return(0,m.jsx)(r().A,{visible:t,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:o,children:(0,m.jsx)(s().sA,{defaultMessage:"Drag image to reposition",id:"withImageRepositioning.dragImage.text"})})}},867772:(e,t,o)=>{o.d(t,{Ay:()=>c,Gi:()=>n,Wc:()=>i,pF:()=>a,vS:()=>r});const i="loadingLocalImage",r="uploading",n="downloading",a="loaded";class s extends(()=>o(757695))().Store{getInitialState(){return{loadingMode:a}}}const c=s},914795:(e,t,o)=>{o.d(t,{A:()=>J});o(898992),o(354520),o(581454);var i=o(296540),r=()=>o(907258),n=()=>o(726637),a=()=>o(484714),s=()=>o(590526),c=()=>o(401497),l=()=>o(79926),d=()=>o(929219),p=()=>o(852273),u=()=>o(201794),g=()=>o(498521),m=()=>o(118307),h=()=>o(98126),v=()=>o(187174),y=()=>o(202017),S=()=>o(42583),f=()=>o(921997),I=()=>o(801634),w=()=>o(69708),b=()=>o(100622),C=()=>o(496603),P=()=>o(534177),x=()=>o(720665),A=()=>o(848259);const k=new(l().O2)("activityUpdate",(async()=>await Promise.all([o.e(42660),o.e(5181),o.e(83149),o.e(13319)]).then(o.bind(o,275056))));(0,l()._h)(k,(e=>e.ActivityUpdate));var R=()=>o(299545),T=()=>o(957606),_=()=>o(423817),M=()=>o(554413),j=()=>o(402267),B=()=>o(81068),D=()=>o(297401);class F extends(()=>o(757695))().Store{getInitialState(){return{selectedItems:[]}}}const N=F;var U=()=>o(322976),L=o(474848);const K=function({mode:e,title:t,onChange:o,disabled:r,focused:n,onMenuDismiss:a,items:c,addItemLabel:l,tokenInputPlaceholder:d,resultSectionTitle:p,componentDebugName:u,icon:g,getItemLabel:m,options:h,store:v}){const y=(0,s().uB)(v,N),S=(0,s().O$)(y);return(0,i.useEffect)((()=>{y.setState({selectedItems:c})}),[c,y]),(0,L.jsx)(U().A,{mode:e,hasItemsSelected:S.selectedItems.length>0,title:t,icon:g,items:c,onChange:e=>{o(e)},disabled:r,focused:n,renderFilter:(e,t)=>(0,L.jsx)(V,{getItemLabel:m,item:e,args:t}),renderToken:e=>(0,L.jsx)(E,{item:e}),renderItemForSummary:e=>(0,L.jsx)(O,{item:e}),addItemLabel:l,labelText:{title:t,tokenInputPlaceholder:d,resultSectionTitle:p,componentDebugName:u},performRequest:e=>function({query:e},t){return Promise.resolve(t.filter((t=>t.includes(e))))}(e,h),renderResultMenuItem:(t,o)=>(0,L.jsx)(W,{getItemLabel:m,mode:e,store:y,item:t,props:o}),onMenuDismiss:a})};function O({item:e}){return(0,L.jsx)(L.Fragment,{children:`hello${e}`})}function E({item:e}){return(0,L.jsx)(L.Fragment,{children:e})}function V({item:e,args:t,getItemLabel:o}){const{disabled:i,onRemove:r,onClick:a}=t,s={menuItem:{minHeight:void 0,paddingTop:n().A.isMobile?12:4,paddingBottom:n().A.isMobile?12:4},menuItemTitle:{width:"100%"},labeledMenuItemTitle:{display:"inline-flex",alignItems:"center"},menuItemLabel:{marginInlineEnd:12},recordIcon:{marginInlineEnd:4}},c=(0,L.jsx)(D().A,{disabled:i,onClick:r});return(0,L.jsx)(B().A,{title:(null==o?void 0:o(e))||e,disabled:i,focused:!1,right:c,style:s.menuItem,desktopTitleStyle:s.menuItemTitle,onClick:a})}function W({item:e,props:t,getItemLabel:o,mode:r,store:n}){const a=(0,s().uB)(n,N),c=(0,s().K8)((()=>a.state.selectedItems),[a]);return(0,i.createElement)(B().A,{...t,key:e,title:(null==o?void 0:o(e))||e,isChecked:r===U().C.Pill&&c.includes(e)})}var H=()=>o(110886),z=()=>o(132533),$=()=>o(988591),X=()=>o(722267),G=()=>o(279922);function J(e){var t;const{spaceId:o,navigableBlockStore:n,collectionIds:h,authorId:y,source:S}=e,I=null==n?void 0:n.id,b=(0,a().v3)(),A=(0,s().uB)(void 0,X().L),j=(0,s().uB)(void 0,m().A),B=(0,c().IS)((()=>({placeholderContent:Q()})),[]),D=(0,i.useMemo)((()=>C().nF((e=>function(e,t){t.update((e=>({...e,shouldLoadNewerActivities:!0})))}(0,A)),1e3)),[A]),F=(0,i.useMemo)((()=>x().Hg(D)),[D]);(0,i.useEffect)((()=>{let e,t,o;if(I){const t=(0,f().O$)(I);e=p().Ay.addListener(t,void 0,F,void 0,b)}if(h&&(t=h.map((e=>{const t=(0,f().zB)(e);return p().Ay.addListener(t,void 0,F,void 0,b)})).filter(P().O9)),y){const e=(0,f().Ii)(y);o=p().Ay.addListener(e,void 0,F,void 0,b)}return()=>{if(e&&p().Ay.removeListener(e,b),t)for(const e of t)p().Ay.removeListener(e,b);o&&p().Ay.removeListener(o,b)}}),[h,b,F,I,y]);const N=(0,s().O$)(d().e),U=(0,s().K8)((()=>{const e=A.state;return 0===e.filterActivityTypes.length&&void 0===e.filterDateRange.ending&&void 0===e.filterDateRange.starting}),[A]),K=(0,s().K8)(T().XL,[]),{currentUserStore:O,currentSpaceStore:E}=(0,s().K8)((()=>{const{currentUserStore:e,sidebarSpaceStore:t}=r().default.state;return{currentUserStore:e,currentSpaceStore:t}}),[]),{shouldLoadOlderActivities:V,shouldLoadNewerActivities:W,filterActivityTypes:J,filterDateRange:Y,activityIds:oe,hasOlderActivities:ie}=(0,s().O$)(A),re=(0,l().fJ)(k),[ne]=(0,v().Yb)((async()=>{if(!N||!O||!E)return;const e=G().Ay.startLoading();W?await H().X(b,{store:A,activityIds:oe,spaceId:o,filterActivityTypes:J,filterDateRange:Y,navigableBlockId:I,collectionIds:h,authorId:y,source:S}):V&&ie&&await H().r(b,{store:A,activityIds:oe,spaceId:o,filterActivityTypes:J,filterDateRange:Y,navigableBlockId:I,collectionIds:h,authorId:y,source:S}),G().Ay.endLoading(e)}),[oe,A,h,E,O,b,J,Y,ie,N,I,W,V,o,S,y]),ae=ne.error,se="resolved"===ne.status,ce=(0,s().K8)((()=>{if(!O)return[];const e=O.id,t=(0,u().T)("supportsNativeHome"),i={spaceId:o,userId:e,navigableBlockId:I,collectionIds:h,filterDateRange:Y,filterActivityTypes:J,authorId:y},n=t&&0===oe.length&&!se?M().oV(i):oe;return t&&se&&M().tK(i,oe),function(e){return C().oE(e.map((e=>function(e){const{currentUserStore:t,sidebarSpaceStore:o}=r().default.state;if(!t||!o)return;const i=(0,R().jA)(o,e,o.id),n=i.getModel();return n&&!n.invalid?n:null}(e))))}(n)}),[oe,h,O,J,Y,y,I,se,o]);if(!N)return(0,L.jsx)(ee,{});if(!O||!E)return null;const le=0===ce.length&&!ie&&se,de=E;if(ae||"rejected"===re.status)return(0,L.jsx)("div",{style:B.placeholderContent,children:(0,L.jsx)(w().sA,{defaultMessage:"Something went wrong.",id:"activityUpdate.unknownErrorLoadingActivities.message"})});const pe=Boolean(h&&h.length>0);if("resolved"!==re.status||0===ce.length&&!se)return(0,L.jsxs)("div",{children:[K?(0,L.jsx)(Z,{hasCollection:pe,source:S,activityUpdatesStore:A,filterPopupStore:j}):void 0,(0,L.jsx)(_().J,{areaHeight:window.innerHeight})]});const{ActivityUpdate:ue}=re.value;return(0,L.jsxs)("div",{children:[K?(0,L.jsx)(Z,{hasCollection:pe,source:S,activityUpdatesStore:A,filterPopupStore:j}):void 0,(0,L.jsxs)("div",{style:le?B.placeholderContent:q(),className:le?"":"notranslate",children:[le?null===(t=e.empty)||void 0===t?void 0:t.call(e,{hasFiltersOn:!U}):null,(0,L.jsx)(z().X,{children:(0,L.jsx)("section",{role:"feed",children:ce.map(((e,t,o)=>{const i=o.length-1===t,r="notifications_tab"===S?{tab:"all",source:S}:"updates_sidebar"===S?{tab:"pageUpdatesSidebar",source:S}:"person_profile"===S?{tab:"personProfile",source:S}:{tab:"homeTile",source:S};return(0,L.jsx)($().Z,{index:t,children:(0,L.jsx)(ue,{activity:e,rootStore:de,isLast:i,tabArgs:r})},e.id)}))})}),(0,L.jsx)(g().A,{onChange:e=>{e<200&&se&&!V&&ie&&(U||ce.length>0)&&A.update((e=>({...e,shouldLoadOlderActivities:!0})))},children:!se&&ie?(0,L.jsx)(te,{isPaginated:!0}):null})]})]})}function Z(e){const{hasCollection:t,source:o,activityUpdatesStore:i,filterPopupStore:n}=e,{currentUserStore:a,currentSpaceStore:c}=(0,s().K8)((()=>{const{currentUserStore:e,sidebarSpaceStore:t}=r().default.state;return{currentUserStore:e,currentSpaceStore:t}}),[]),l=(0,s().K8)((()=>i.state.filterActivityTypes.length>0||i.state.filterDateRange.ending||i.state.filterDateRange.starting),[i]);return a&&c?(0,L.jsxs)("div",{style:{display:"flex",flexDirection:"row",padding:"12px 10px",width:"100%",gap:6},children:[(0,L.jsx)(Y,{hasCollection:t,source:o,filterPopupStore:n,activityUpdatesStore:i}),(0,L.jsx)(ae,{source:e.source,activityUpdatesStore:i,filterPopupStore:n}),l?(0,L.jsx)(ne,{source:e.source,activityUpdatesStore:i}):void 0]}):null}function Y(e){const{hasCollection:t,source:o,activityUpdatesStore:r,filterPopupStore:n}=e,c=(0,w().tz)(),l=(0,a().v3)(),d=t?I().Fv:I().IP,p=(0,s().uB)(void 0,N),u=(0,s().K8)((()=>r.state.filterActivityTypes),[r]),g=(0,i.useCallback)((()=>{ie(n)}),[n]);return(0,L.jsx)(K,{store:p,focused:!1,icon:y().n,options:[...d].sort(),items:u,mode:U().C.Pill,title:(0,L.jsx)(w().sA,{id:"activityUpdates.filterMenu.byType.title",defaultMessage:"Activity type"}),tokenInputPlaceholder:c.formatMessage({id:"activityUpdates.filterMenu.byType.search",defaultMessage:"Search for a type"}),resultSectionTitle:c.formatMessage({id:"activityUpdates.filterMenu.byType.resultSectionTitle",defaultMessage:"Activity Types"}),addItemLabel:c.formatMessage({id:"activityUpdates.filterMenu.byType.addItemLabel",defaultMessage:"Add an activity type"}),componentDebugName:"ActivityUpdatesSearchEditTypesFilter",onChange:e=>re((()=>r.update((t=>({...t,filterActivityTypes:e,activityIds:[],hasOlderActivities:!0,shouldLoadOlderActivities:!0,shouldLoadNewerActivities:!1})))),l,o,r),onMenuDismiss:g,getItemLabel:e=>e.split("-").map((e=>e.replace(/(^.)/,(e=>e.toUpperCase())))).join(" ")})}function q(){return{minHeight:n().A.isMobile?void 0:"75vh"}}function Q(){return{...q(),paddingTop:n().A.isMobile?32:void 0,paddingBottom:n().A.isMobile?32:void 0,minHeight:n().A.isMobile?void 0:220,display:"flex",textAlign:"center",alignItems:"center",justifyContent:"center",fontSize:14,color:b().Tj.text.secondary,flexDirection:"column",flex:"1 1 0%"}}function ee(){const e=(0,c().IS)((()=>({offlineMessage:Q()})),[]);return(0,L.jsx)("div",{style:e.offlineMessage,children:(0,L.jsx)(w().sA,{defaultMessage:"Please go online to view updates.",id:"activityUpdates.offlineMessage"})})}function te({isPaginated:e}){const t=(0,c().IS)((()=>({spinner:{...Q(),minHeight:e?64:220}})),[e]);return(0,L.jsx)("div",{style:t.spinner,children:(0,L.jsx)(h().k,{})})}function oe(e){var t,o;const{filterActivityTypes:i,filterDateRange:r}=e.state;return{activityTypes:i,dateRange:{start:null===(t=r.starting)||void 0===t?void 0:t.start_date,end:null===(o=r.ending)||void 0===o?void 0:o.start_date}}}function ie(e){e.setState({...e.state,open:!1})}function re(e,t,o,i){const r=oe(i);e();const n=oe(i);A().Xl({environment:t,activityUpdatesSource:o,filters:n,prevFilters:r})}function ne({source:e,activityUpdatesStore:t}){const o=(0,a().v3)(),i=(0,c().IS)((()=>({clearButton:{flexGrow:1,textAlign:"end",cursor:"pointer",fontSize:14,color:b().Tj.text.secondary,marginInlineEnd:8}})),[]);return(0,L.jsx)("div",{style:i.clearButton,onClick:()=>re((()=>t.reset()),o,e,t),children:(0,L.jsx)(w().sA,{defaultMessage:"Clear",id:"activityUpdates.clearFilters"})})}function ae({source:e,activityUpdatesStore:t,filterPopupStore:o}){const r=(0,a().v3)(),n=(0,i.useCallback)((()=>ie(o)),[o]),c=(0,s().K8)((()=>t.state.filterDateRange),[t]);return(0,L.jsx)(j().A,{mode:U().C.Pill,focused:!1,showButtons:!0,title:(0,L.jsx)(w().sA,{id:"activityUpdates.filterMenu.byDate",defaultMessage:"Date Range"}),icon:S().D,value:c,onMenuDismiss:n,onChange:o=>re((()=>t.update((e=>({...e,filterDateRange:o,activityIds:[],hasOlderActivities:!0,shouldLoadOlderActivities:!0})))),r,e,t)})}},923455:(e,t,o)=>{o.d(t,{Lp:()=>I,Rx:()=>b,a$:()=>w});var i=o(296540),r=()=>o(907258),n=()=>o(755531),a=()=>o(59226),s=()=>o(484714),c=()=>o(590526),l=()=>o(391400),d=()=>o(269183),p=()=>o(753721),u=()=>o(877051),g=()=>o(644914),m=()=>o(82648),h=()=>o(840247),v=()=>o(479349),y=o(474848);const S=(0,i.createContext)(null);S.displayName="SidebarStateContext";const f=2e4;function I({children:e}){const t=(0,s().v3)(),o=(0,h().r)(t),I=(0,u().V)(),{deferSidebarLoadingWhenCollapsed:w}=(0,d().b8)(t.currentUser.id),b=!(0,c().K8)((()=>(0,g().KB)(t)),[t])&&w&&I,[C,P]=(0,i.useState)(!1);(0,i.useEffect)((()=>{const e=setTimeout((()=>{P(!0)}),f);return()=>{clearTimeout(e)}}),[]);const{currentUserId:x,spaceId:A,isFreshStateReady:k}=(0,c().K8)((()=>{var e,t,i,a;null!==(e=r().default.state.currentUserStore)&&void 0!==e&&e.id&&null!==(t=(0,n().S)())&&void 0!==t&&t.id&&(0,m().yd)("user_and_space_stores_loaded");const s=null===(i=r().default.state.currentUserStore)||void 0===i?void 0:i.id,c=null===(a=(0,n().S)())||void 0===a?void 0:a.id;if(b)return{currentUserId:s,spaceId:c,isFreshStateReady:!1};const d=o.state,p=l().A.state.initialRenderCompleted;return{currentUserId:s,spaceId:c,isFreshStateReady:(0,v().XA)({sidebarState:d,userId:s,spaceId:c,isInitialPageRenderCompleted:p})}}),[o,b]),R=(0,a().X)("enable_greedy_sidebar_initial_render"),T=(0,p().X)(),_=(0,v().cT)({isFreshStateReady:k,userId:x,spaceId:A}),M=(0,c().K8)((()=>{const e=null==_?void 0:_.state;return Boolean(x===(null==e?void 0:e.userId)&&A===(null==e?void 0:e.spaceId))}),[_,x,A]),j=Boolean(M&&(T||R)&&!k&&!C);return(0,y.jsx)(S.Provider,{value:j?_:o,children:e})}function w(){const e=(0,i.useContext)(S),t=(0,s().v3)(),o=(0,h().r)(t);return e??o}function b(){return(0,c().O$)(w())}},988591:(e,t,o)=>{o.d(t,{Z:()=>s,v:()=>a});var i=o(296540),r=o(474848);const n=(0,i.createContext)(void 0);function a(){return(0,i.useContext)(n)}function s(e){const{index:t,children:o}=e;return(0,r.jsx)(n.Provider,{value:t,children:o})}n.displayName="NotificationIndexContext"}}]);