"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[7595],{273321:(e,t,s)=>{s.d(t,{A:()=>w});var o=s(296540),n=()=>s(907258),i=()=>s(726637),r=()=>s(790748),a=()=>s(590526),l=()=>s(401497),d=()=>s(128933),c=()=>s(302501),u=()=>s(424400),m=()=>s(713998),p=()=>s(797809),g=()=>s(69708),y=()=>s(100622),h=()=>s(284371),b=()=>s(710648),f=()=>s(862292),S=()=>s(381678),v=()=>s(480289),x=()=>s(737230),A=()=>s(441467),j=()=>s(848565),k=()=>s(473975),M=()=>s(555776),C=()=>s(116008),T=()=>s(811879),D=()=>s(846583),I=()=>s(686350),F=()=>s(105157),B=s(474848);function w(e){const t=(0,g().tz)(),{environment:s,menuListItemProps:w,shouldShowTopDividerLine:_,shouldShowBottomDividerLine:R,shouldExpandDiscussionWidth:E,noBackgroundColors:P,onMouseEnter:O,onMouseLeave:K,onFocus:z,onBlur:L,onMobileClose:W}=e,U=(0,a().O$)(n().AppStoreMainEditorCurrentBlockStore),V=(0,a().K8)((()=>(0,S()._)(s)),[s]),H=j().eQ,Y=(0,a().K8)((()=>M().A.state.isActivelyComposing),[]),N=(0,a().K8)((()=>M().A.state.isHovered),[]),$=(0,o.useCallback)((()=>{null==O||O()}),[O]),G=(0,o.useCallback)((()=>{null==K||K()}),[K]),J=(0,o.useCallback)((()=>{null==z||z()}),[z]),q=(0,o.useCallback)((()=>{C().A.hasContent()?M().A.resetAllActiveSources():(C().A.reset(),M().A.reset()),null==L||L()}),[L]),Z=(0,o.useRef)(null);(0,r().b)(v().A,(()=>({getNode:()=>Z.current})),[]);const X=(0,l().IS)((()=>({menuDiscussionItem:{marginInlineStart:-14,marginInlineEnd:-14,width:"calc(100% + 28px)"},discussionContainer:{paddingTop:i().A.isMobile?4:6,borderTop:!i().A.isMobile&&_?`1px solid ${y().Tj.border.secondaryTranslucent}`:void 0,borderBottom:!i().A.isMobile&&R?`1px solid ${y().Tj.border.secondaryTranslucent}`:void 0,transition:"background 300ms ease",background:P?void 0:Y?y().Tj.focusDiscussionBackground:N?y().Tj.hoveredDiscussionBackground:void 0},comment:{position:"relative",fontSize:i().A.isMobile?16:14},commentElementsBelowUserRow:{paddingInlineStart:j().FB},avatar:{marginTop:0,marginInlineEnd:i().A.isMobile?4:8,userSelect:"none",WebkitUserSelect:"none"},userRow:{display:"flex",flexDirection:"row",alignItems:"center",userSelect:"none",WebkitUserSelect:"none"},placeholder:{height:8,width:81,borderRadius:6,background:y().Tj.background.tertiaryTranslucent},draftLabel:{margin:"0 6px",flexBasis:140,whiteSpace:"normal",flexGrow:void 0,display:"inline",color:y().Tj.text.tertiary},container:{paddingTop:j().e4,paddingInlineEnd:16,paddingBottom:j().Wv,paddingInlineStart:16},noOverflow:{overflow:"hidden"},commentContext:{display:"flex",width:"100%",marginTop:6,marginBottom:22,fontSize:13,color:y().Tj.text.secondary},displayName:{fontWeight:h().Wy.medium,whiteSpace:"normal"},fullWidthFlex:{display:"flex",width:"100%"},smallTopPadding:{marginTop:1}})),[N,Y,P,R,_]),Q=(0,o.useCallback)((async()=>{const e=await f().T.formulas.load();A().i5({environment:s,allowActionsWhileCommenting:!0,formulasModule:e});const o=x().Ay.state.hasActiveDraftComment;i().A.isMobile&&o&&(d().D6({label:t.formatMessage({id:"draftComment.submitted.snackbar",defaultMessage:"Comment added"}),position:"bottom",style:{justifyContent:"center",textAlign:"center"}}),null==W||W())}),[s,t,W]),ee=(0,a().K8)((()=>!C().A.state.open||"reaction"===C().A.state.content),[]),te=(0,a().K8)((()=>{var e;return C().A.getBlockStore()??(null===(e=C().A.getClosestBlockStore())||void 0===e?void 0:e.parentBlockStore)}),[]),se=(0,a().K8)((()=>C().A.getPropertyId()),[]),oe=(0,a().K8)((()=>{if(se){var e;const t=null===(e=C().A.getBlockStore())||void 0===e?void 0:e.getAssociatedCollectionStore();if(!t||"collection"!==t.table)return;const s=t.getSchema();return(0,m()._g)({schema:s,property:se})}}),[se]),ne=(0,a().K8)((()=>(0,p().RX)(t).title),[t]),ie=(0,a().O$)(C().f),re=(0,a().K8)((()=>null==V?void 0:V.getDisplayName(t)),[V,t]),ae=(0,a().K8)((()=>null==te?void 0:te.getSpaceId()),[te]),le=(0,a().K8)((()=>A().Ek({environment:s})),[s]),de=(0,a().K8)((()=>C().A.getType()),[]),ce=(0,a().K8)((()=>null==te?void 0:te.getValue()),[te]);if(ee||!ne||!V||!te||!U||!ie||!ae||!ce&&"block"===de||!le&&"inline"===de)return null;const ue="inline"===de||se,me="block"===de&&!se?(0,B.jsx)(b().Ay,{blockValue:ce,rootStore:te,blockPreviewLocation:"comments_sidebar"}):ue?(0,B.jsx)(b().vY,{value:{value:(null==le?void 0:le.context)??[],spaceId:ae},propertySchema:ne,labeled:!1,rootStore:te,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableDateStyleAnnotations:!0}):null;return(0,B.jsx)("div",{style:X.discussionContainer,ref:Z,onClick:null==w?void 0:w.onClick,onMouseEnter:$,onMouseLeave:G,children:(0,B.jsx)(u().Ay,{allowTextSelection:!0,style:X.menuDiscussionItem,title:(0,B.jsx)("div",{style:X.container,children:(0,B.jsxs)("div",{style:X.comment,children:[(0,B.jsxs)("div",{style:X.userRow,children:[(0,B.jsx)(T().E,{authorStore:V,avatarSize:H,avatarStyle:X.avatar}),(0,B.jsxs)("div",{style:X.noOverflow,children:[(0,B.jsx)("span",{style:X.displayName,children:re||(0,B.jsx)("span",{style:X.placeholder})}),(0,B.jsx)(c().A,{isSmall:!i().A.isMobile,isSecondaryColor:!0,isMultiline:!0,style:X.draftLabel,children:(0,B.jsx)(g().sA,{defaultMessage:"Draft",id:"DraftCommentInputWithContext.draftLabel"})})]})]}),(0,B.jsxs)("div",{style:X.commentElementsBelowUserRow,children:[(0,B.jsx)("div",{style:X.commentContext,children:(0,B.jsxs)("div",{style:X.fullWidthFlex,children:[(0,B.jsx)(D().T,{}),oe?(0,B.jsx)(F().A,{propertySchema:oe}):void 0,(0,B.jsx)("div",{style:X.smallTopPadding,children:me})]})}),(0,B.jsx)(I().V,{showAvatar:!1,parentStore:U,blockStore:te,onSubmit:Q,discussionInputStore:ie,isNewComment:!0,isEditingExistingComment:!1,isMobileSlideUpMenu:!0,shouldSaveUnsentComments:!1,discussionFormat:k().DiscussionFormat.Sidebar,canDrop:!0,disableFocusRing:!0,adjustWidthForDraftDiscussions:E,dontMoveCursorToInputEndOnFocus:!0,onBlur:q,onFocus:J},"draft-comment-sidebar")]})]})})})},"draft-comment-discussion-updates")}},281824:(e,t,s)=>{s.d(t,{P:()=>M});s(581454),s(296540);var o=()=>s(560198),n=()=>s(401497),i=()=>s(995847),r=()=>s(100622),a=()=>s(699143),l=()=>s(718827),d=()=>s(807449),c=()=>s(406094),u=()=>s(631524),m=()=>s(493552),p=s(474848);function g(e){const t=(0,n().IS)((()=>({background:{position:"absolute",top:8,insetInlineEnd:8,width:24,height:24,borderRadius:"100%",background:r().Tj.background.accentPrimary},button:{width:"100%",height:"100%",borderRadius:"100%",display:"flex",justifyContent:"center",alignItems:"center",background:"transparent"},hovered:{background:r().Tj.buttonHoveredBackground},pressed:{background:r().Tj.buttonPressedBackground}})),[]);return(0,p.jsx)("div",{style:t.background,children:(0,p.jsx)(l().Ay,{onClick:e.onClick,style:t.button,hoveredStyle:t.hovered,pressedStyle:t.pressed,children:(0,p.jsx)(d().I,{icon:i().xMarkSmallIcon,size:"sm",colorVariant:"primary"})})})}function y(e){const{text:t,onClick:s}=e,o=(0,n().IS)((()=>({button:{height:28,padding:"0 8px",borderRadius:6,borderWidth:1,borderColor:r().Tj.border.primary,borderStyle:"solid"}})),[]);return(0,p.jsx)(c().A,{size:"lg",onClick:s,style:o.button,children:(0,p.jsx)(m().D,{styleKey:"captionMedium",colorVariant:"primary",children:t})})}function h(e){const{text:t,onClick:s}=e;return(0,p.jsx)(u().p,{onClick:s,children:(0,p.jsx)(m().D,{styleKey:"captionMedium",colorVariant:"secondary",children:t})})}function b(e){const{text:t,onClick:s}=e,o=(0,n().IS)((()=>({button:{height:28,padding:"4px 8px"}})),[]);return(0,p.jsx)(c().A,{size:"lg",onClick:s,style:o.button,children:(0,p.jsx)(m().D,{styleKey:"captionMedium",colorVariant:"primary",children:t})})}function f(e){const{button:t}=e;return(0,p.jsx)(b,{...t})}function S(e){const{primary:t,secondary:s}=e;return(0,p.jsxs)(a().Y1,{direction:"horizontal",gap:8,align:"center-left",children:[(0,p.jsx)(y,{...t}),s?(0,p.jsx)(h,{...s}):void 0]})}function v(e){const{primary:t}=e;return(0,p.jsx)(a().Y1,{direction:"horizontal",gap:8,align:"center-right",children:(0,p.jsx)(y,{...t})})}function x(e){const{numDots:t,activeDot:s}=e,o=(0,n().IS)((()=>({dot:{width:6,height:6,borderRadius:"100%",background:r().Tj.gray.background.tertiaryTranslucent},active:{background:r().Tj.icon.primary}})),[]),i=new Array(t).fill(0).map(((e,t)=>{const n=t===s?{...o.dot,...o.active}:o.dot;return(0,p.jsx)("div",{style:n},t)}));return(0,p.jsx)(a().Y1,{direction:"horizontal",gap:8,children:i})}function A(e){const{button:t,numStages:s,stage:o}=e;return(0,p.jsxs)(a().Y1,{direction:"horizontal",gap:"auto",align:"center",children:[(0,p.jsx)(x,{numDots:s,activeDot:o}),(0,p.jsx)(y,{...t})]})}function j(e){const{alt:t,src:s,type:o}=e,i=(0,n().IS)((()=>({media:{width:"100%",height:"auto",borderRadius:2}})),[]);return"image"===o?(0,p.jsx)("img",{src:s,style:i.media,alt:t}):(0,p.jsx)("video",{title:t,src:s,style:i.media,autoPlay:!0,playsInline:!0,muted:!0,loop:!0,controls:!1})}function k(e){const{onDismiss:t,buttonsProps:s,icon:o,title:i,media:l,body:c,badge:u}=e,y=(0,n().IS)((()=>({card:{borderWidth:1,borderColor:r().Tj.border.secondary,borderStyle:"solid",background:r().Tj.background.accentPrimary,backdropFilter:"blur(15px)",WebkitBackdropFilter:"blur(15px)",padding:12,width:280},title:{paddingInlineEnd:24},icon:{paddingBottom:2}})),[]);let h,b,x,k,M;if(s)switch(s.type){case"carousel":h=(0,p.jsx)(A,{...s});break;case"full-width":h=(0,p.jsx)(f,{...s});break;case"left-aligned":h=(0,p.jsx)(S,{...s});break;case"right-aligned":h=(0,p.jsx)(v,{...s})}return o&&(b=(0,p.jsx)(d().I,{icon:o,size:"sm",colorVariant:"primary",style:y.icon})),i&&(x=(0,p.jsx)("div",{style:y.title,children:(0,p.jsxs)(m().D,{styleKey:"captionSemibold",colorVariant:"inversePrimary",children:[i,u]})})),c&&(k=(0,p.jsx)(m().D,{styleKey:"captionRegular",colorVariant:"primary",children:c})),l&&(M=(0,p.jsx)(j,{...l})),(0,p.jsxs)(a().Y1,{style:y.card,borderRadius:8,gap:8,children:[(0,p.jsxs)(a().Y1,{gap:2,children:[b,x,k]}),M,h,(0,p.jsx)(g,{onClick:t})]})}function M(e){return(0,p.jsx)(o().wX,{mode:"dark",children:(0,p.jsx)(k,{...e})})}},694956:(e,t,s)=>{s.r(t),s.d(t,{filterFillIcon:()=>n,iconDefinition:()=>o});s(296540);const o={viewBox:"0 0 20 20",fittedViewBox:"2.12 4.62 15.76 10.75",svg:(0,s(474848).jsx)("path",{d:"M3 4.625a.875.875 0 1 0 0 1.75h14a.875.875 0 0 0 0-1.75zm2.125 6.242h9.75a.875.875 0 0 0 0-1.75h-9.75a.875.875 0 1 0 0 1.75m1.25 3.633c0-.483.392-.875.875-.875h5.5a.875.875 0 0 1 0 1.75h-5.5a.875.875 0 0 1-.875-.875"})},n=(0,s(340498).wt)("filterFill",o,"fill")},907595:(e,t,s)=>{s.d(t,{R:()=>Ze});s(944114),s(517642),s(658004),s(733853),s(845876),s(432475),s(515024),s(731698),s(898992),s(354520),s(430670),s(581454),s(737550);var o=s(296540),n=()=>s(564884),i=()=>s(907258),r=()=>s(726637),a=()=>s(484714),l=()=>s(590526),d=()=>s(401497),c=()=>s(79926),u=()=>s(611648),m=()=>s(779315),p=()=>s(882722),g=()=>s(807449),y=()=>s(695115),h=()=>s(546926),b=()=>s(856337),f=()=>s(890492),S=()=>s(663639),v=()=>s(869190),x=()=>s(416504),A=()=>s(473541),j=()=>s(297813),k=()=>s(798880),M=()=>s(175947),C=()=>s(69708),T=()=>s(100622),D=()=>s(496603),I=()=>s(774733),F=()=>s(789557),B=()=>s(938045),w=()=>s(273321),_=()=>s(22426),R=()=>s(473975),E=()=>s(655236),P=()=>s(94953),O=()=>s(555776),K=()=>s(116008),z=()=>s(376254),L=()=>s(299545),W=()=>s(38554),U=()=>s(644914),V=()=>s(883497),H=()=>s(737230),Y=()=>s(372154),N=()=>s(546574),$=()=>s(118307),G=()=>s(284371),J=()=>s(131448),q=()=>s(123021),Z=(s(672577),()=>s(250910)),X=()=>s(420802),Q=()=>s(631524),ee=()=>s(26697),te=()=>s(302501),se=()=>s(81068),oe=()=>s(424400),ne=()=>s(736847),ie=()=>s(764880),re=()=>s(589407),ae=()=>s(694956),le=()=>s(835607),de=()=>s(534177),ce=()=>s(899963),ue=()=>s(457688),me=()=>s(869562),pe=s(474848);const ge=["comments","suggestions"],ye=["unresolved","unread","read","resolved"],he=(0,C().YK)({unresolved:{id:"updateSidebar.comments.mode.unresolvedOption",defaultMessage:"Open"},resolved:{id:"updateSidebar.comments.mode.resolvedOption",defaultMessage:"Resolved"},commentsAndSuggestions:{id:"updateSidebar.comments.typeMode.commentsAndSuggestions",defaultMessage:"Any"},comments:{id:"updateSidebar.comments.typeMode.comments",defaultMessage:"Comments only"},suggestions:{id:"updateSidebar.comments.typeMode.suggestions",defaultMessage:"Suggestions only"},read:{id:"updateSidebar.comments.readFilter.read",defaultMessage:"Read"},unread:{id:"updateSidebar.comments.readFilter.unread",defaultMessage:"Unread"},none:{id:"updateSidebar.comments.mode.none",defaultMessage:"Apply filters to see discussions"}}),be=(0,C().YK)({commentsAndSuggestions:{id:"updateSidebar.comments.typeMode.commentsAndSuggestionsCheckbox",defaultMessage:"Any"},comments:{id:"updateSidebar.comments.typeMode.commentsCheckbox",defaultMessage:"Comments"},suggestions:{id:"updateSidebar.comments.typeMode.suggestionsCheckbox",defaultMessage:"Suggestions"}}),fe=(0,C().YK)({filterLabel:{id:"updateSidebar.comments.filter.label",defaultMessage:"Filter"}});function Se(e,t,s,o,n){if(t)return e;const{items:i}=e;if(i.length<=6)return e;const r=[...i.slice(0,5),{key:"show more",render:e=>(0,pe.jsx)(se().A,{...e,icon:(0,pe.jsx)(g().I,{icon:re().ellipsisIcon,size:"sm",style:n.showMoreResultsButton}),title:(0,pe.jsx)("span",{style:n.showMoreResultsButtonTitle,children:(0,pe.jsx)(C().sA,{defaultMessage:"{numberMore} more results",id:"updateSidebar.comments.filter.byPerson.showMoreResultsButton.title",values:{numberMore:i.length-5}})})}),action:()=>{s(!0)}}];return{...e,items:r}}function ve(e){const{numCommenters:t,userActorsForDisplay:s,actorsForFilter:o,setActorsForFilter:n,onMobileClose:i,currentTypeMode:l,currentDiscussionStatusFilters:c,popupOpen:u,setPopupOpen:m,peopleFilterExpanded:p,setPeopleFilterExpanded:b}=e,v=(0,C().tz)(),x=(0,a().v3)(),A=(0,d().IS)((()=>({anyoneMenuItemMobileIconStyles:{width:oe().nd},showMoreResultsButton:{fill:T().Tj.text.secondary},showMoreResultsButtonTitle:{color:T().Tj.text.secondary},menuList:{minWidth:r().A.isMobile?void 0:272},left:{marginInlineEnd:r().A.isMobile?12:0},checkbox:{pointerEvents:"none"}})),[]),k=ge.map((e=>({key:e,render:t=>(0,pe.jsx)(se().A,{...t,left:(0,pe.jsx)(X().S,{checked:l===e||"commentsAndSuggestions"===l,size:14,style:A.checkbox}),leftStyle:A.left,title:(0,pe.jsx)(te().A,{children:(0,pe.jsx)(C().sA,{...be[e]})})}),action:()=>{"commentsAndSuggestions"===l?me().setUpdateSidebarCommentsTypeMode("comments"===e?"suggestions":"comments"):"none"===l?me().setUpdateSidebarCommentsTypeMode(e):l===e?me().setUpdateSidebarCommentsTypeMode("none"):me().setUpdateSidebarCommentsTypeMode("commentsAndSuggestions");const t=H().Ay.state.discussionStatusFilters,s=H().Ay.state.commentsTypeMode;ce().Fx(x,{new_status_filters_state:t,existing_status_filters_state:t,old_type_filter:l,new_type_filter:s})}}))),M={key:"typeMode",render:e=>(0,pe.jsx)(ne().A,{...e,title:(0,pe.jsx)(C().sA,{defaultMessage:"Type",id:"commentFilterMenu.typeSection.heading"})}),items:k},D=ye.map((e=>({key:e,render:t=>{const{read:s,unread:o}=c,n="unread"===e||"read"===e,i="unresolved"===e&&s!==o,r=c[e];return(0,pe.jsx)(se().A,{...t,title:(0,pe.jsx)(te().A,{children:v.formatMessage(he[e])}),left:(0,pe.jsx)(X().S,{checked:i?"partial":r,size:14,style:A.checkbox}),leftStyle:{...A.left,paddingInlineStart:n?8:0}})},action:()=>{const t=e,s=c;c[t]?H().Ay.removeDiscussionFilter(t):H().Ay.addDiscussionFilter(t);const o=H().Ay.state.discussionStatusFilters,n=H().Ay.state.commentsTypeMode;ce().Fx(x,{new_status_filters_state:o,existing_status_filters_state:s,old_type_filter:n,new_type_filter:n})}}))),I={key:"commentFilter",render:e=>(0,pe.jsx)(ne().A,{...e,topBorder:!0,title:(0,pe.jsx)(C().sA,{defaultMessage:"Status",id:"commentFilterMenu.statusSection.heading"})}),items:D},F={key:"anyone",render:e=>(0,pe.jsx)(se().A,{...e,title:(0,pe.jsx)(te().A,{children:(0,pe.jsx)(C().sA,{defaultMessage:"Anyone",id:"commentFilterMenu.anyoneItem.title"})}),left:(0,pe.jsx)(X().S,{checked:0===o.length,size:14,style:A.checkbox}),icon:(0,pe.jsx)("div",{style:A.anyoneMenuItemMobileIconStyles,children:(0,pe.jsx)(g().I,{icon:le().F,colorVariant:"secondary"})})}),action:()=>{n([])}},B=s.map((e=>{const t=e.getActorUserId(),s=o.some((e=>e.getActorUserId()===t));if(t){const i={key:t,render:t=>(0,pe.jsx)(ue().A,{...t,actor:e,useEmailAsTooltip:!0,left:(0,pe.jsx)(X().S,{checked:s,size:14,style:A.checkbox})}),action:()=>{n(s?o.filter((e=>e.getActorUserId()!==t)):[...o,e])}};return i}})).filter(de().O9),w={key:"personFilter",render:e=>(0,pe.jsx)(ne().A,{topBorder:!0,...e,title:(0,pe.jsx)(C().sA,{defaultMessage:"Person",id:"commentFilterMenu.personFilterSection.header"})}),items:r().A.isMobile?[F,...B]:1===t?B:[F,...B]},_=(0,pe.jsx)(S().A,{style:A.menuList,type:S().O.Vertical,initialFocus:void 0,sections:[M,I,r().A.isMobile?w:Se(w,p,b,0,A)]}),R=(0,d().IS)((()=>({closeButton:{position:"absolute",insetInlineEnd:12,borderRadius:"50%",background:T().Tj.background.tertiaryTranslucent}})),[]);return r().A.isMobile?(0,pe.jsx)(f().A,{menuType:h().gu.Modal,scrollerStyle:{paddingBottom:0},title:(0,pe.jsx)(C().sA,{defaultMessage:"Filter",id:"commentFilterMenu.title"}),right:(0,pe.jsx)(y().A,{icon:j().xMarkFillIcon,onClick:()=>{i(),m(!1)},style:R.closeButton,ariaLabel:v.formatMessage({id:"updateSidebar.header.closeLabel",defaultMessage:"Close"})}),onClickRight:()=>{i(),m(!1)},children:_}):_}function xe({userActors:e,actorsForFilter:t,setActorsForFilter:s}){const n=(0,a().Y0)(),i=(0,C().tz)(),c=(0,l().K8)((()=>H().Ay.state.expanded),[]),u=(0,l().K8)((()=>V().A.state.open),[]),m=(0,l().K8)((()=>{let o=[...e];return t.length>0&&!o.find((e=>t.some((t=>t.getActorUserId()===e.getActorUserId()))))&&(r().A.isMobile?s([]):o=[...t,...o]),o.sort(((e,t)=>{const s=(0,ie().lR)(i,e),o=(0,ie().lR)(i,t);return s&&o?s.localeCompare(o):0})),o}),[i,t,e,s]),[g,y]=(0,o.useState)(!1),[h,b]=(0,o.useState)(!1),{currentTypeMode:f,discussionStatusFilters:S}=(0,l().K8)((()=>({currentTypeMode:H().Ay.state.commentsTypeMode,discussionStatusFilters:H().Ay.state.discussionStatusFilters})),[]),v=(0,d().IS)((()=>({toggleButton:{justifyContent:"center",display:"flex",color:T().Tj.text.secondary,margin:0},toggleButtonContainer:{paddingInlineEnd:0,display:"flex"}})),[]),x=(0,pe.jsx)(C().sA,{...fe.filterLabel});return(0,o.useEffect)((()=>{r().A.isMobile||c?r().A.isMobile&&!u&&(me().setUpdateSidebarCommentsMode("unresolved"),s([])):(me().setUpdateSidebarCommentsMode("unresolved"),s([]),b(!1))}),[u,s,c]),(0,pe.jsx)(Z().A,{open:g,originGap:0,popupType:r().A.isMobile?Z().z.BottomSheet:Z().z.Popup,bottomSheetInitialState:n.isTablet?"half":"full",renderOrigin:e=>(0,pe.jsx)(ee().m,{...e,placement:"bottom",renderTooltip:()=>x,render:e=>(0,pe.jsx)("div",{style:v.toggleButtonContainer,className:p().kJD,children:(0,pe.jsx)(Q().p,{...e,style:v.toggleButton,onClick:()=>{y(!0)},size:"sm",iconLeading:{icon:ae().filterFillIcon,size:r().A.isMobile?18:"default",colorPalette:"blue",colorVariant:"accentPrimary"}})})}),placementToOrigin:"bottom",alignmentToOrigin:"center",render:o=>(0,pe.jsx)(ve,{userActorsForDisplay:m,actorsForFilter:t,setActorsForFilter:s,onMobileClose:()=>o.close(),currentTypeMode:f,currentDiscussionStatusFilters:S,popupOpen:g,setPopupOpen:y,peopleFilterExpanded:h,setPeopleFilterExpanded:b,numCommenters:e.length}),onClose:()=>{y(!1)}})}var Ae=()=>s(488814),je=()=>s(127833),ke=()=>s(281824),Me=()=>s(994480),Ce=()=>s(612900),Te=()=>s(300789),De=()=>s(51367);const Ie=(0,C().YK)({title:{defaultMessage:"Updated comments & suggestions",id:"GetNotifiedOnboardingTooltip.title"},body:{defaultMessage:"Better filters and notification settings to help you get through feedback",id:"GetNotifiedOnboardingTooltip.body"},button:{defaultMessage:"Got it",id:"GetNotifiedOnboardingTooltip.button"}});function Fe({children:e}){const t=(0,a().v3)(),s=(0,C().tz)(),n=(0,o.useRef)(null),i=(0,Ae().r)({getElement:()=>n.current}),r=(0,l().K8)((()=>J().default.isVisible("get_notified_onboarding_tooltip")),[]),c=(0,o.useCallback)((()=>{(0,De().Sq)(t,{callout_key:"get_notified_onboarding_tooltip",placement_key:"Tooltip",dismiss_type:"tooltip_dismiss"}),(0,Te().a)(t,"get_notified_onboarding_tooltip")}),[t]),u=(0,o.useCallback)((()=>{(0,De().Y5)(t,{callout_key:"get_notified_onboarding_tooltip",placement_key:"Tooltip",click_type:"primary_cta"}),c()}),[t,c]),m=(0,d().IS)((()=>({buttonWrapper:{position:"relative"},buttonHalo:{position:"absolute",top:-1,insetInlineStart:1},buttonHaloPlaceholder:i?{width:i.width,height:i.height+2}:{}})),[i]);(0,o.useEffect)((()=>{r&&Boolean(i)&&(0,De().DL)(t,{callout_key:"get_notified_onboarding_tooltip",placement_key:"Tooltip"})}),[r,i,t]);const p=Boolean(i)&&r;return(0,pe.jsxs)(pe.Fragment,{children:[(0,pe.jsxs)("div",{style:m.buttonWrapper,children:[(0,pe.jsx)("div",{style:m.buttonHalo,children:(0,pe.jsx)(Ce().u,{shape:"square",borderRadius:6,children:(0,pe.jsx)("div",{style:m.buttonHaloPlaceholder})})}),(0,pe.jsx)("div",{ref:n,children:e})]}),(0,pe.jsx)(je().zD,{popupType:je().nl.Popup,open:p,originRect:i,placementToOrigin:"bottom",alignmentToOrigin:"end",originGap:6,preventCaptureEsc:!0,preventPointerEvents:!1,enableOutsideClickDismiss:!1,trapFocus:!1,disableContentScroll:!1,disableMouseCapture:!0,render:()=>(0,pe.jsx)(ke().P,{title:s.formatMessage(Ie.title),body:s.formatMessage(Ie.body),icon:Me().l,buttonsProps:{type:"full-width",button:{text:s.formatMessage(Ie.button),onClick:u}},onDismiss:c})})]})}function Be({userActors:e,actorsForFilter:t,setActorsForFilter:s}){const o=(0,d().IS)((()=>({container:{display:"flex",flexDirection:"column",borderBottom:`1px solid ${T().Tj.border.secondaryTranslucent}`},commentsHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",pointerEvents:"auto"},label:{lineHeight:"inherit",fontSize:14,color:T().Tj.text.primary,fontWeight:G().Wy.medium,display:"flex",alignItems:"center",margin:0,paddingTop:12,paddingInlineEnd:12,paddingBottom:12,paddingInlineStart:16},actionButtonsContainer:{paddingInlineEnd:16}})),[]),n=(0,l().O$)(i().AppStoreMainEditorCurrentBlockStore),r=(0,l().uB)(void 0,$().A),a=(0,l().K8)((()=>J().default.isVisible("get_notified_onboarding_tooltip")),[]);return(0,pe.jsx)("div",{style:o.container,children:(0,pe.jsxs)("div",{style:o.commentsHeader,className:p().S4C,children:[(0,pe.jsx)("h2",{style:o.label,children:(0,pe.jsx)(C().sA,{id:"topbarCommentsDesktop.header.discussionsLabel",defaultMessage:"All discussions"})}),(0,pe.jsx)("div",{style:o.actionButtonsContainer,children:a&&n?(0,pe.jsx)(Fe,{children:(0,pe.jsx)(we,{buttonPopupStore:r,userActors:e,actorsForFilter:t,setActorsForFilter:s})}):(0,pe.jsx)(we,{buttonPopupStore:r,userActors:e,actorsForFilter:t,setActorsForFilter:s})})]})})}function we({buttonPopupStore:e,userActors:t,actorsForFilter:s,setActorsForFilter:o}){const n=(0,d().IS)((()=>({actionButtons:{display:"flex",alignItems:"center",gap:4}})),[]),r=(0,l().O$)(i().AppStoreMainEditorCurrentBlockStore);return(0,pe.jsxs)("div",{style:n.actionButtons,children:[(0,pe.jsx)(xe,{userActors:t,actorsForFilter:s,setActorsForFilter:o}),r?(0,pe.jsx)(q().O,{blockStore:r,from:"comments_sidebar",buttonPopupStore:e,renderType:"button"}):null]})}var _e=()=>s(200688),Re=()=>s(489295),Ee=()=>s(232615),Pe=()=>s(406094),Oe=()=>s(859002),Ke=()=>s(170350),ze=()=>s(449195);function Le(e){const{hasOpenDiscussions:t,hasResolvedDiscussions:s}=e,n=(0,d().IS)((()=>({addCommentButton:{borderRadius:6}})),[]),i=(0,o.useCallback)((()=>{me().setUpdateSidebarCommentsTypeMode("commentsAndSuggestions"),H().Ay.setToOpenDiscussionsFilters()}),[]),r=(0,o.useCallback)((()=>{me().setUpdateSidebarCommentsTypeMode("commentsAndSuggestions"),H().Ay.setToResolvedDiscussionsFilters()}),[]);return t?(0,pe.jsx)(Pe().A,{size:"lg",onClick:i,style:n.addCommentButton,children:(0,pe.jsx)(C().sA,{id:"updateSidebar.commentContainer.emptyCommentsShowOpenButton",defaultMessage:"Show all open"})}):s?(0,pe.jsx)(Pe().A,{size:"lg",onClick:r,style:n.addCommentButton,children:(0,pe.jsx)(C().sA,{id:"updateSidebar.commentContainer.emptyCommentsShowResolvedButton",defaultMessage:"Show all resolved"})}):null}function We(e){const{environment:t,device:s,navigableBlockStore:o,hasOpenDiscussions:n,hasResolvedDiscussions:i}=e,a=n||i,c=(0,l().K8)((()=>{if(r().A.isMobile)return!1;if(!t.currentUser.isLoggedIn())return!1;if(null==o||!o.canComment())return!1;const e=function(){const e=Ee().default.hasSelection()&&Ee().default.state.multiSelection&&(0,Re().Y2)(Ee().default.state.multiSelection.start.store);return e&&"block"===e.table?e:void 0}();return!!(e&&"page"!==e.getType()||"section_hide"!==(0,ze().Rn)())}),[t.currentUser,o]),u=(0,d().IS)((()=>({commentsEmptyStyle:{flex:1,display:"flex",gap:2,alignItems:"center",justifyContent:"center",flexDirection:"column",textAlign:"center",fontSize:14,position:"relative",background:T().Tj.background.primary,marginInlineEnd:0,pointerEvents:"auto",paddingTop:10,marginTop:s.isPhone?80:void 0},commentsContainerMessage:{fontWeight:G().Wy.semibold,color:T().Tj.text.secondary,marginTop:4},commentsContainerSecondaryMessage:{fontWeight:G().Wy.regular,color:T().Tj.text.secondary,marginBottom:14},commentsContentStyle:{position:"relative",minHeight:0,display:"flex",flexDirection:"column",background:T().Tj.background.primary,marginInlineEnd:0,pointerEvents:"auto",height:"100%"}})),[s.isPhone]);return(0,pe.jsx)("div",{style:u.commentsContentStyle,children:(0,pe.jsxs)("div",{style:u.commentsEmptyStyle,children:[a?(0,pe.jsx)(g().I,{icon:Ke().filterIcon,size:"xl",colorVariant:"secondary"}):(0,pe.jsx)(g().I,{icon:Oe().chatIcon,size:"xl",colorVariant:"secondary"}),(0,pe.jsx)("div",{style:u.commentsContainerMessage,children:(0,pe.jsx)(Ve,{hasOpenDiscussions:n,hasResolvedDiscussions:i})}),(0,pe.jsx)("div",{style:u.commentsContainerSecondaryMessage,children:(0,pe.jsx)(Ue,{hasOpenDiscussions:n??!1,hasResolvedDiscussions:i??!1})}),c?(0,pe.jsx)(Le,{hasOpenDiscussions:n,hasResolvedDiscussions:i}):null]})})}function Ue({hasOpenDiscussions:e,hasResolvedDiscussions:t}){return e?(0,pe.jsx)(C().sA,{id:"updateSidebar.commentContainer.emptyButHasOpenComments",defaultMessage:"There are open threads on this page"}):t?(0,pe.jsx)(C().sA,{id:"updateSidebar.commentContainer.emptyButHaResolvedComments",defaultMessage:"There are resolved threads on this page"}):null}function Ve({hasOpenDiscussions:e,hasResolvedDiscussions:t}){return e||t?(0,pe.jsx)(C().sA,{id:"updateSidebar.commentContainer.emptyDiscussionsFromFilters",defaultMessage:"Apply filters to see discussions"}):(0,pe.jsx)(C().sA,{id:"updateSidebar.commentContainer.emptyNoDiscussions",defaultMessage:"No discussions"})}const He=o.forwardRef((function(e,t){const{currentBlockStore:n,discussionStore:i,showAllRepliesAfterTimestamp:a,focused:u,isLast:m,location:g}=e,y=(0,l().K8)((()=>Y().A.state.open&&Y().A.state.discussionIds||[]),[]);(0,o.useEffect)((()=>{var e;if(u){P().A.setState({source:"update_sidebar",discussionIds:[i.id]});const e=setTimeout((()=>{var e;(null===(e=P().A.state)||void 0===e||null===(e=e.discussionIds)||void 0===e?void 0:e[0])===i.id&&N().A.markDiscussionsInteractedWith([i.id])}),1500);return()=>{clearTimeout(e)}}(null===(e=P().A.state)||void 0===e||null===(e=e.discussionIds)||void 0===e?void 0:e[0])===i.id&&P().A.setState({discussionIds:[]})}),[u,i]);const h=(0,l().K8)((()=>{var e;return(null===(e=P().A.state)||void 0===e?void 0:e.discussionIds)||[]}),[]),b=i.id,{parentId:f,currentSpaceId:S}=(0,l().K8)((()=>({parentId:i.getParentId(),currentSpaceId:i.getSpaceId()})),[i]),v=f?s(295633).B.createChildStore(i,{table:s(179034).ev,id:f}):void 0,x=y.includes(b),A=h.includes(b),j=(0,d().IS)((()=>({discussionContainer:{paddingTop:r().A.isMobile?4:6,borderBottom:m||r().A.isMobile?void 0:`1px solid ${T().Tj.border.secondaryTranslucent}`,transition:"background 300ms ease"},hoveredStyle:{background:"sidebar"===g?T().Tj.hoveredDiscussionBackground:void 0},pressedStyle:{background:"sidebar"===g?T().Tj.focusDiscussionBackground:void 0},menuStyle:{marginInlineStart:-12,marginInlineEnd:-12,width:"calc(100% + 28px)",lineHeight:void 0,cursor:"pointer"}})),[m,g]),{value:k}=(0,c().fJ)(I().commentsDependency);if(!k)return null;if(!v||!S)return null;const M=(0,pe.jsx)("div",{className:`sidebar-discussion-${b} ${p()._57}`,onClick:e.onClick,onMouseEnter:e.onMouseEnter,ref:t,style:{...j.discussionContainer,...A?j.hoveredStyle:{},...x?j.pressedStyle:{}},children:(0,pe.jsx)(I().PW,{store:i,blockStore:n,format:k.discussionHelpers.DiscussionFormat.Sidebar,isFirst:!1,isOnly:!1,showResolveButtonByDefaultIfPossible:!1,discussionLocation:"updates_sidebar",showAllRepliesAfterTimestamp:a})});return(0,pe.jsx)(oe().Ay,{allowTextSelection:!0,title:M,style:j.menuStyle})}));function Ye(e){const{firstItemId:t,ignoreFirstItemState:s}=e,o=(0,a().Y0)(),n=(0,l().K8)((()=>{var e;return!s&&(Boolean(t)&&(null===(e=P().A.state)||void 0===e?void 0:e.discussionIds.some((e=>e===t))))}),[t,s]),i=(0,l().K8)((()=>!s&&(Y().A.state.open&&Y().A.state.discussionIds&&Y().A.state.discussionIds.some((e=>e===t)))),[t,s]),r=(0,d().IS)((()=>({hoveredStyle:{background:"sidebar"===e.location?T().Tj.hoveredDiscussionBackground:void 0},pressedStyle:{background:"sidebar"===e.location?T().Tj.focusDiscussionBackground:void 0},basicDesktopTitleStyle:{paddingInlineStart:16,paddingTop:16,marginBottom:0,marginTop:0,fontSize:12,transition:"background 300ms ease"},mobileTitleStyle:{fontSize:13,fontWeight:G().Wy.medium,paddingBottom:0,textTransform:"unset",marginTop:o.isPhone?0:-12}})),[e.location,o.isPhone]);return(0,pe.jsx)(ne().A,{desktopTitleStyle:{...r.basicDesktopTitleStyle,...n?r.hoveredStyle:{},...i?r.pressedStyle:{}},mobileTitleStyle:r.mobileTitleStyle,disableDesktopPadding:!0,disableMobileBorders:!0,...e})}function Ne(e){const t=(0,l().K8)((()=>O().A.state.isHovered),[]),s=(0,l().K8)((()=>O().A.state.isActivelyComposing),[]),o=(0,d().IS)((()=>({hoveredStyle:{background:T().Tj.hoveredDiscussionBackground},pressedStyle:{background:T().Tj.focusDiscussionBackground},basicDesktopTitleStyle:{paddingInlineStart:16,paddingTop:16,marginBottom:0,marginTop:0,fontSize:12,transition:"background 300ms ease"},mobileTitleStyle:{fontSize:13,fontWeight:G().Wy.medium,paddingBottom:0,textTransform:"unset",marginTop:-12}})),[]);return(0,pe.jsx)(ne().A,{desktopTitleStyle:{...o.basicDesktopTitleStyle,...t?o.hoveredStyle:{},...s?o.pressedStyle:{}},mobileTitleStyle:o.mobileTitleStyle,disableDesktopPadding:!0,disableMobileBorders:!0,...e})}var $e=()=>s(423817);const Ge=new(s(452004).$),Je=50;function qe(e){m().A.UpdateSidebarCommentScroller=e}function Ze(e){const{timeViewed:t,location:s}=e,m=(0,a().v3)(),$=(0,a().Y0)(),G=(0,C().tz)(),J=(0,W().U)(),[q,Z]=(0,o.useState)(!1),[X,Q]=(0,o.useState)([]),ee=(0,l().O$)(i().AppStoreMainEditorCurrentBlockStore),te=m.currentUser.id,{value:se}=(0,c().fJ)(I().commentsDependency),oe=(0,_e().S)(ee,t),{currentCommentsMode:ne,currentCommentsType:ie,activeDiscussionStore:re,hasActiveDraftComment:ae}=(0,l().K8)((()=>({currentCommentsMode:H().Ay.state.commentsMode,currentCommentsType:H().Ay.state.commentsTypeMode,activeDiscussionStore:H().Ay.state.activeDiscussionStore,hasActiveDraftComment:H().Ay.state.hasActiveDraftComment})),[]),le=(0,l().K8)((()=>(0,U().me)(m)),[m]),de=(0,l().K8)((()=>{const e=!("comments"!==ie&&"commentsAndSuggestions"!==ie||"unresolved"!==ne&&"anyResolution"!==ne),t=(K().A.hasContent()||O().A.state.isActivelyComposing)&&K().A.isDraftCommentOnValidSelection();return(le||r().A.isMobile)&&t&&e&&K().A.ifPropertyCommentShouldDisplay()}),[ne,ie,le]),ce=(0,l().K8)((()=>Y().A.getOpenDiscussionIds()),[]),{discussionStoresFilteredByTypeAndModeAndReadStatus:ue,hasOpenDiscussions:me,hasResolvedDiscussions:ge}=(0,l().K8)((()=>{const e="commentsAndSuggestions"===ie?oe:"none"===ie?[]:oe.filter((e=>e.getType()===H().zX[ie])),t=H().Ay.state.discussionStatusFilters;return{hasOpenDiscussions:oe.some((e=>!e.getResolved())),hasResolvedDiscussions:oe.some((e=>e.getResolved())),discussionStoresFilteredByTypeAndModeAndReadStatus:e.filter((e=>{const{read:s,unread:o,resolved:n}=t,i=(0,E().s)({discussionStore:e,navigableBlockStore:ee});return s&&!i&&!e.getResolved()||o&&i||n&&e.getResolved()}))}}),[oe,ie,ee]),ye=ue.map((e=>e.id)),he=(0,l().K8)((()=>{if(X.length>0){const e=new Set(X.map((e=>e.getActorUserId())));return ue.filter((t=>(0,L().wc)(t).flatMap((e=>{const t=e.getCreatedByPointer();return(null==t?void 0:t.table)===k().oo?[t.id]:[]})).some((t=>e.has(t)))))}return ue}),[ue,X]),be=(0,l().K8)((()=>(0,R().getSetOfUsersInDiscussions)(ue)),[ue]);(0,o.useEffect)((()=>{if("popup"===s&&q)return()=>{N().A.markDiscussionsInteractedWith(ye)}}),[s,ye,q]);const fe=(0,d().IS)((()=>({commentsContentStyle:{position:"relative",minHeight:0,display:"flex",flexDirection:"column",background:T().Tj.background.primary,marginInlineEnd:0,pointerEvents:"auto",height:"100%"},scrollerStyle:{flexGrow:1,minHeight:0,transform:"translateZ(0px)",zIndex:1,overflow:"hidden auto",marginBottom:0,paddingBottom:J?64:0},closeButton:{position:"absolute",insetInlineEnd:12,borderRadius:"50%",background:T().Tj.background.tertiaryTranslucent},menuList:{display:"flex",flexDirection:"column",gap:10},topbar:{marginBottom:$.isPhone&&re?4:-3}})),[re,$.isPhone,J]),Se=(0,o.useRef)(null),ve=(0,l().K8)((()=>{if(!se)return{};const e=D().$z(he,(e=>{const s=se.discussionHelpers.getLatestRelevantComment({recordStore:e,currentUserId:te,timestamp:t});return s?(0,v().aD)(s.getCreatedTime()):""}));return delete e[""],e}),[se,he,t,te]),Ae=(0,l().K8)((()=>!se||se.discussionHelpers.anyDiscussionCommentsLoading(he)),[se,he]);(0,o.useEffect)((()=>{q||Ae||Z(!0)}),[q,Ae]);const je=(0,o.useCallback)((()=>{O().A.setHoverWithSource("comments_pane"),P().A.reset()}),[]),ke=(0,o.useCallback)((()=>{O().A.resetHoverSource("comments_pane")}),[]),Me=(0,l().K8)((()=>O().A.state.isActivelyComposing),[]),Ce=(0,l().K8)((()=>V().A.state.source),[]),[Te,De]=(0,l().K8)((()=>D().jB(he,(e=>(0,E().s)({discussionStore:e,navigableBlockStore:ee})))),[he,ee]);if(!ee||!ve||!q)return(0,pe.jsx)($e().J,{areaHeight:window.innerHeight});const Ie=(0,v().aD)(Date.now()),Fe=Object.keys(ve).sort().reverse();!de||0!==Fe.length&&Fe.includes(Ie)||Fe.unshift(Ie);const we=Fe.map(((e,o)=>{const n=(0,v().ZF)({value:{type:"date",start_date:e},date_format:"relative",userTimeZone:(0,x().P)(),intl:G,allowRelativeDates:!0}),i=ve[e],r=de&&e===Ie,a=[];r&&a.push({key:"draft-discussion-in-comments-pane",render:e=>(0,pe.jsx)(w().A,{environment:m,shouldShowBottomDividerLine:!(1===Fe.length&&0===(null==i?void 0:i.length)),menuListItemProps:e,shouldExpandDiscussionWidth:!0,onMouseEnter:je,onMouseLeave:ke}),action:()=>{const e=K().A.getDiscussionInputStore();e&&(O().A.setActiveWithSource("comments_pane"),Y().A.reset(),(0,B().x)({currentBlockStore:ee,discussionInputStore:e,environment:m,dontAffectCursor:Me,animateScroll:!0}))}});const l=i?i.map(((e,n)=>{const a=e.getRecordStoreUIParent()??ee,l={key:e.id,render:l=>(0,pe.jsx)(He,{...l,currentBlockStore:a,discussionStore:e,isFirstInSection:0===n&&!r,location:s,isLast:n===i.length-1&&o===Fe.length-1,showAllRepliesAfterTimestamp:t}),action:()=>{var t;Me&&O().A.resetAllActiveSources(),F().DZ({discussionStore:e,currentBlockStore:ee,environment:m,analyticsFrom:"updates_sidebar",currentEl:Se.current,animateScroll:!0,discussionReadStatus:(0,E().g)({discussionStore:e,navigableBlockStore:null===(t=e.getParentStore())||void 0===t?void 0:t.getNavigableBlockStore()})})}};return l})):[];return a.push(...l),{key:e,render:e=>r?(0,pe.jsx)(Ne,{title:n,...e}):(0,pe.jsx)(Ye,{title:n,firstItemId:i[0].id,location:s,ignoreFirstItemState:r,...e}),items:a}})),Re=we.flatMap((e=>e.items)).findIndex((e=>ce.includes(e.key.toString()))),Ee=0!==he.length||de?(0,pe.jsx)(z().H,{type:u().A.Y,style:fe.scrollerStyle,className:p().bzV,ref:qe,children:(0,pe.jsx)(S().A,{disableKeyboard:!0,store:Ge,type:S().O.Vertical,initialFocus:Re>=0?Re:void 0,scrollElementIntoView:e=>{const t=e.getBoundingClientRect(),s=M().ek(m.device.isElectronMac),o=window.innerHeight,n=s+Je,i=o-n;if(t.height>=i)return;const r=t.top>=n&&t.top<=o,a=r&&t.bottom>=o,l=t.bottom>=n&&t.bottom<=o,d=l&&t.top-n<0,c=r||l,u=.4*t.height;a&&Math.abs(t.top-o)<u?(0,b().v)(e,{edgeDist:o-t.height-n,animate:!0}):d&&Math.abs(t.bottom-n)<u?(0,b().v)(e,{edgeDist:0,animate:!0}):c||(0,b().v)(e,{edgeDist:0,animate:!0})},sections:we})}):(0,pe.jsx)(We,{environment:m,device:$,navigableBlockStore:ee,actorsForFilter:X,hasOpenDiscussions:me,hasResolvedDiscussions:ge});if(r().A.isMobile){const t=async e=>{await F().JO({environment:m,discussionStore:e,currentBlockStore:ee,topOffset:160,animate:!0}),H().Ay.update((t=>({...t,activeDiscussionStore:e})))},s=(0,_().s)({unreadDiscussions:Te,readDiscussions:De,handleDiscussionClick:t,handleDraftDiscussionClick:()=>{const e=K().A.getDiscussionInputStore();(0,B().x)({currentBlockStore:ee,discussionInputStore:e,environment:m,animateScroll:!0,onlyScroll:!0}),H().Ay.update((e=>({...e,hasActiveDraftComment:!0})))},isMobile:!0,hasDraftComment:Boolean(de)});return(0,pe.jsx)(f().A,{menuType:h().gu.Modal,title:re?(0,pe.jsx)(C().sA,{defaultMessage:"Discussion",id:"discussionSheet.activeDiscussion.title"}):ae?(0,pe.jsx)(C().sA,{defaultMessage:"Draft comment",id:"draftCommentSheet.title"}):(0,pe.jsx)(C().sA,{defaultMessage:"All discussions",id:"discussionsSheet.header.title"}),whiteBackground:!0,onClickLeft:()=>{H().Ay.update((e=>({...e,activeDiscussionStore:void 0,hasActiveDraftComment:!1}))),(0,n().u)({environment:m,event:{eventName:"tap_back_to_new_discussions_sheet",eventProperties:{landed_on_sheet_from:Ce}}})},left:re||ae?(0,pe.jsx)(g().I,{icon:A().w,colorVariant:"secondary"}):(0,pe.jsx)(xe,{userActors:be,actorsForFilter:X,setActorsForFilter:Q}),right:(0,pe.jsx)(y().A,{icon:j().xMarkFillIcon,onClick:e.onMobileClose,style:fe.closeButton,ariaLabel:G.formatMessage({id:"updateSidebar.header.closeLabel",defaultMessage:"Close"})}),topbarStyle:fe.topbar,scrollerStyle:$.isPhone?{height:"var(--full-viewport-height)"}:void 0,children:re&&se?(0,pe.jsx)(I().PW,{store:re,blockStore:ee,format:se.discussionHelpers.DiscussionFormat.Sidebar,isFirst:!0,isOnly:!0,discussionLocation:"updates_sidebar",showResolveButtonByDefaultIfPossible:!0,onDismiss:()=>{H().Ay.update((e=>({...e,activeDiscussionStore:void 0,hasActiveDraftComment:!1})))}}):ae?(0,pe.jsx)(w().A,{environment:m,shouldShowBottomDividerLine:!1,shouldExpandDiscussionWidth:!0,onMouseEnter:je,onMouseLeave:ke,onMobileClose:e.onMobileClose}):0===s.length?(0,pe.jsx)(We,{environment:m,device:$,navigableBlockStore:ee,actorsForFilter:X,hasOpenDiscussions:me,hasResolvedDiscussions:ge}):(0,pe.jsx)(S().A,{type:S().O.Vertical,sections:s,initialFocus:void 0,style:fe.menuList})})}return(0,pe.jsxs)("div",{style:fe.commentsContentStyle,ref:Se,children:[(0,pe.jsx)(Be,{userActors:be,actorsForFilter:X,setActorsForFilter:Q}),Ee]})}},994480:(e,t,s)=>{s.d(t,{l:()=>n});s(296540);const o={viewBox:"0 0 16 16",fittedViewBox:"1.49 1.94 12.79 12.12",svg:(0,s(474848).jsx)("path",{d:"M12.324 1.944c-.361 0-.715.1-1.023.289l-2.167 1.33c-.96.589-2.063.9-3.189.9H3.381A1.885 1.885 0 0 0 1.496 6.35v1.706c0 1.033.83 1.872 1.86 1.885l.926 3.074a1.465 1.465 0 0 0 1.403 1.042h.799c.809 0 1.465-.656 1.465-1.465V10.28c.412.143.81.331 1.185.562l2.167 1.33a1.955 1.955 0 0 0 2.978-1.667V3.9c0-1.08-.875-1.955-1.955-1.955M6.699 9.987v2.604a.215.215 0 0 1-.215.215h-.799a.215.215 0 0 1-.206-.153L4.662 9.94h1.283q.38 0 .754.047m5.57-6.791.055-.002c.39 0 .705.315.705.705v6.605a.706.706 0 0 1-.76.704zm-1 .523v6.965l-1.481-.909a7.4 7.4 0 0 0-1.933-.832V5.46a7.4 7.4 0 0 0 1.933-.833zM5.944 8.69H3.381a.635.635 0 0 1-.635-.634V6.349c0-.351.284-.635.635-.635h2.564q.459 0 .91-.057v3.09a7 7 0 0 0-.91-.057"})},n=(0,s(340498).wt)("megaphoneSmall",o,"small")}}]);