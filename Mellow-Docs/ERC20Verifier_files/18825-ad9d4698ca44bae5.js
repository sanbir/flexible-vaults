"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[18825],{51473:(e,r,t)=>{t.d(r,{q:()=>n});t(898992),t(672577);class o extends(()=>t(757695))().Store{getInitialState(){return{open:!1}}close(){this.state.open&&this.setState({open:!1})}open({oldTier:e,newTier:r,oldAddOns:o,newAddOns:n}){if(function(e){if(!e)return!1;return["plus","enterprise","business","student"].includes(e)}(r)){if(function(e,r){if(!e||!r)return!1;return"upgrade"===(0,t(979340).qR)({oldTier:e,newTier:r})}(e,r))return this.setState({productUpgrade:r,open:!0}),!0}if(n.length>o.length){const e=n.find((e=>!o.includes(e)));if(function(e){if(!e)return!1;return["ai"].includes(e)}(e))return this.setState({productUpgrade:e,open:!0}),!0}return!1}}const n=new o},124958:(e,r,t)=>{t.d(r,{x:()=>b});t(16280);var o=()=>t(755531),n=()=>t(314529);var i=()=>t(983610),a=()=>t(165358),s=()=>t(763884),c=()=>t(165241),d=()=>t(662453),l=()=>t(977870),u=()=>t(271084),p=()=>t(129286),m=()=>t(134217);const g="SubscriptionData";async function b(e,r){var t;const b=r??(null===(t=(0,o().S)())||void 0===t?void 0:t.id),f=e.currentUser.id;if(!f)throw new Error("No userId.");if(!b)throw new Error("No spaceId.");const y=`${g}:${b}:v2`,h=s().K.get({userId:f,key:y});h&&(i().subscriptionDataStoreInstance.setState(h),i().subscriptionDataStoreInstance.spaceId=b,i().subscriptionDataStoreInstance.userId=f,u().k.setState(h.userSimilarity)),l().c.setState({wasGetVisibleUsersCalled:{...l().c.state.wasGetVisibleUsersCalled,[b]:!0}}),await p().transactionQueue.drain();const[v,x,I]=await Promise.all([e.api.callCellCompatibleApi({eventName:"getSubscriptionData",environment:e,data:{spaceId:b},cellNavigation:{cellId:void 0,spaceId:b}}),e.api.callCellCompatibleApi({eventName:"getVisibleUsers",environment:e,data:{spaceId:b,supportsEdgeCache:!0,earlyReturnForEdgeCache:!0},cellNavigation:{spaceId:b}}),e.api.callCellCompatibleApi({eventName:"getSimilarUsers",environment:e,data:{userId:f,spaceId:b,limit:100},cellNavigation:{spaceId:b}})]);if("success"===v.type&&"success"===x.type){var S;const r={...v.data,...x.data},t="success"===I.type?I.data.userSimilarity:void 0;t&&(r.userSimilarity=t);try{s().K.set({userId:f,key:y,value:r})}catch{a().log({level:"error",from:"subscriptionActions",type:"subscriptionDataTooLarge",data:{miscDataToConvertToString:{subscriptionDataJsonSize:JSON.stringify(r).length}}})}(null===(S=(0,o().S)())||void 0===S?void 0:S.id)===b&&(c().O({userId:f,spaceId:b,shouldUseEdgeCache:x.data.shouldUseEdgeCache}),i().subscriptionDataStoreInstance.setState(r),i().subscriptionDataStoreInstance.spaceId=b,i().subscriptionDataStoreInstance.userId=f,u().k.setState(r.userSimilarity),m().Fq(r)&&function(e){(0,n().DO_NOT_USE_trackLegacy)(e,"currently_subscribed")}(e))}else a().log({level:"error",from:"subscriptionActions",type:"fetchSubscriptionDataFailed",data:{miscDataToConvertToString:{getSubscriptionDataResponseType:v.type,getSubscriptionDataResponseStatus:v.status,getVisibleUserResponseType:x.type,getVisibleUserResponseStatus:x.status}}});await Promise.all([d().aiDependency.load().then((({completionActions:r})=>r.maybeUpdateAiEligibility(e,b,!0)))])}},311638:(e,r,t)=>{t.d(r,{i:()=>v});var o=()=>t(314529);var n=()=>t(564884);var i=()=>t(702538),a=()=>t(795523),s=()=>t(47273),c=()=>t(906745),d=()=>t(836095),l=()=>t(726637),u=()=>t(651784),p=()=>t(807487),m=()=>t(498212),g=()=>t(268405),b=()=>t(680074),f=()=>t(237118),y=()=>t(807778),h=()=>t(337240);function v({environment:e,context:r,oldData:t,newData:v,desiredState:x}){var I;const S=(0,a().V9)(t),w=(0,a().AI)(t),k=(0,a().ji)(t),_=(0,a().q8)(t),T=(0,a().Ry)(t),C=t.email,B=(0,s().j1)(x),D=(0,s().Gf)(x),P=(0,s().V_)(x),A=(0,s().yw)(x),M=(0,s().j8)(x),E=Boolean(null==x?void 0:x.trialEnd),U=v.email,L=!(0,a().Fq)(t)&&(0,s().DS)(x),$=(0,a().Fq)(t)&&(0,s().DS)(x),H=(0,a().Fq)(t)&&!(0,s().DS)(x);L&&B?function(e,r){(0,n().u)({environment:e,event:{eventName:"create_subscription",eventProperties:r}})}(e,{plan:B,credit_amount:0}):$?(0,i().p)(e,{billing_email_changed:C!==U,plan_changed:B!==S,plan_current:B,plan_old:S,currency_code:M,billing_address_changed:!1}):H&&S&&function(e,r){(0,o().DO_NOT_USE_trackLegacy)(e,"cancel_subscription",r)}(e,{plan:S}),async function(e,r){var t,n,i,a;const s=b().FX(),v=await(0,f().P)({environment:e,spaceId:r.spaceId})??1,x=!!r.trialEndDate&&r.trialEndDate>=c().DateTime.now();(0,o().DO_NOT_USE_trackLegacy)(e,"update_subscription_tier",{from:r.from,action:r.action,old_subscription_tier:r.oldSubscriptionTier,new_subscription_tier:r.newSubscriptionTier,old_price_id:r.oldPriceId,new_price_id:r.newPriceId,old_currency:r.oldCurrency,new_currency:r.newCurrency,old_add_ons:r.oldAddOns,new_add_ons:r.newAddOns,old_billing_interval:r.oldBillingInterval,new_billing_interval:r.newBillingInterval,is_cancel_subscription:r.isCancelSubscription,is_professional_team:r.isProfessionalTeamUser,domain_type:s,space_visible_members:v,is_trial:r.isTrial,is_mid_trial:x,is_mm_or_ent_trial:r.isMmOrEnt,trial_end_date:null==r?void 0:r.trialEndDate,trial_id:null===(t=r.trialData)||void 0===t?void 0:t.id,trial_from:null===(n=r.trialData)||void 0===n?void 0:n.from,modal_id:r.modalId,offer:r.offer});const I=null===(i=r.oldAddOns)||void 0===i?void 0:i.includes("ai"),S=null===(a=r.newAddOns)||void 0===a?void 0:a.includes("ai");if(!I&&S&&((0,o().DO_NOT_USE_trackLegacy)(e,"ai_addon_purchased",r),h().FI(e)),!r.oldSubscriptionTier||!r.newSubscriptionTier)return;const{device:w}=e;if(!(0,p()._6)(r.oldSubscriptionTier)&&(0,p()._6)(r.newSubscriptionTier)&&"personal"!==r.newSubscriptionTier){const t={country:r.addressCountry,productName:r.newPriceId,price:r.creditAmount||0,spaceId:(0,m().Xw)(r.spaceId),deviceType:w.isTablet?"tablet":l().A.isMobile?"mobile":"desktop",subscriptionTier:r.newSubscriptionTier};if("professional"===s&&(0,o().DO_NOT_USE_trackLegacy)(e,"professional_workspace_upgraded",r),(0,o().DO_NOT_USE_trackLegacy)(e,"workspace_upgraded",r),h().lg(e,{...t,domainType:s}),"professional"===s&&h().G0(e),"team"===r.planType&&((0,o().DO_NOT_USE_trackLegacy)(e,"team_workspace_upgraded",r),h().KP(e)),e.device.isElectron&&!(0,y().Pe)()){const o=(0,u().YO)(l().A.domainBaseUrl,{deviceId:await(0,g().T)(e),oldSubscriptionTier:r.oldSubscriptionTier,newSubscriptionTier:r.newSubscriptionTier,isProfessionalTeamUser:r.isProfessionalTeamUser,deviceType:e.device.deviceType,domainType:s,eventData:t});(0,d().P)(o)}}}(e,{from:r.from,action:H?"cancel":"update",spaceId:r.spaceId,isMmOrEnt:r.isMmOrEnt,planType:r.planType,addressCountry:null===(I=v.address)||void 0===I?void 0:I.country,oldSubscriptionTier:w,newSubscriptionTier:D,oldCurrency:T,newCurrency:M,oldPriceId:S,newPriceId:B,oldAddOns:k,newAddOns:P,oldBillingInterval:_,newBillingInterval:A,creditAmount:0,isProfessionalTeamUser:(0,b().YD)(),isTrial:E,trialEndDate:(0,a().i5)(t),trialData:r.trialData,modalId:r.modalId,offer:r.offer})}},323063:(e,r,t)=>{t.d(r,{V5:()=>c,Vr:()=>d,ef:()=>p,gL:()=>l,ng:()=>b,vH:()=>u,vk:()=>g,z2:()=>m});t(16280),t(898992),t(354520),t(672577),t(581454),t(737550);var o=()=>t(720665),n=()=>t(795523),i=()=>t(47273),a=()=>t(622963),s=()=>t(979340);function c(e,r){return(t=e.items,i=r.items,(0,o().qq)(t,(e=>n().IE(e)),i,(e=>n().IE(e)))).some((([e,r])=>function(e,r){if(!e)return!1;if(!r)return!0;const t=n().xp(e),o=n().xp(r);if(!t||!o)return!1;return s().o3[t]>s().o3[o]}(e,r)));var t,i}function d(e,{trialEnd:r,items:t},o){return{trialEnd:r,items:t.map((r=>{const t=r.price.product,n=r.price.unitAmount.currencyCode,i=g(e,{interval:o,product:t,currency:n});return{...r,price:i}}))}}function l(e,r){const t=e.items.filter((e=>n().IE(e)!==r));return{...e,items:t}}function u(e,r){const t=n().IE(r),o=r.price.product,i=e.items.filter((e=>{const r=e.price.product,i=n().IE(e),a=t===i,s="ai"===r&&!n().$0(e.price.externalId);return!a&&!(s&&("business"===o||"enterprise"===o))}));return{...e,items:i.concat([r])}}function p(e){const{state:r,prices:t,quantities:o,params:{interval:i,currency:a},products:s}=e,c=s.map((e=>function(e){if("personal_free"===e||"team_free"===e)return"free";return e}(e))),d=c.map((e=>n().Mr(e))),l=r.items.filter((e=>{const r=e.price.product,t=n().IE(e),o=d.includes(t),i="ai"===r&&(c.includes("business")||c.includes("enterprise"));return!o&&!i})),u=c.map((e=>b(g(t,{interval:i,currency:a,product:e}),o)));return{...r,items:l.concat(u)}}function m(e){const{prices:r,billingData:t,product:o}=e,a=n().Ry(t),s=n().lQ(t),c=i().yw(s),d=n().q8(t),l=c??d;return r.find((e=>e.product===o&&e.billingInterval===l&&e.unitAmount.currencyCode===a))}function g(e,{interval:r,product:t,currency:o}){return function(e,r){if(null==e)throw new Error(r);return e}(e.find((e=>e.product===t&&e.billingInterval===r&&e.unitAmount.currencyCode===o)),`Unable to find price with interval: ${r}, product: ${t}, currency: ${o}`)}function b(e,r){const{numSeats:t,numCustomHostnames:o,numAiCreditPacks:n}=r;switch((0,a().vK)(e.product)){case"public_domain_custom_hostnames":return{price:e,quantity:o};case"ai_credit_pack_units":return{price:e,quantity:n};default:return{price:e,quantity:t}}}},329862:(e,r,t)=>{t.d(r,{A:()=>n});const o=new(t(62175).U)(((e,{spaceId:r})=>`${e.currentUser.id}:${r}`),(async(e,{spaceId:r})=>{const t=await e.api.callApi({eventName:"getInvoiceData",environment:e,data:{spaceId:r,type:"upcoming"}});return"success"===t.type?t.data.invoiceData:void 0}));t(852832).exposeDebugValue("UpcomingInvoiceStore",o);const n=o},335014:(e,r,t)=>{t.d(r,{o:()=>p});var o=()=>t(613848),n=()=>t(878126),i=()=>t(973992),a=()=>t(807456),s=()=>t(805061),c=()=>t(981046),d=()=>t(329862),l=()=>t(779795),u=()=>t(124958);async function p({environment:e,spaceStore:r}){const t=r.id;c().H.setState({...c().H.state,status:"init"}),await Promise.all([l().$W({environment:e,spaceId:t}),(0,u().x)(e,t),s().c.resetData(e,{spaceId:t}),i().L.resetData(e,{spaceId:t}),d().A.resetData(e,{spaceId:t}),o().A.resetData(e,{spaceId:t,userId:e.currentUser.id}),n().T.resetData(e,{spaceId:t}),a().A.resetData(e,{spaceId:t})])}},370441:(e,r,t)=>{t.r(r),t.d(r,{getLegacyStripeAppearance:()=>v,getStripe:()=>b,optionalPaymentMethodIdGivenPaymentData:()=>I,stripeElementLocaleGivenNotionLocale:()=>f,translateStripeError:()=>h,useElementsOptions:()=>y});var o=()=>t(37458),n=t(296540),i=()=>t(907258),a=()=>t(726637),s=()=>t(590526),c=()=>t(401497),d=()=>t(402390),l=()=>t(807487),u=()=>t(100622),p=()=>t(534177),m=()=>t(284371);let g=null;async function b(){return g||(o().loadStripe.setLoadParameters({advancedFraudSignals:!1}),g=(0,o().loadStripe)(a().A.stripe.key)),g}function f(e){switch(e){case"en-US":return"en";case"ko-KR":return"ko";case"ja-JP":return"ja";case"fr-FR":return"fr-FR";case"de-DE":return"de";case"es-ES":return"es-ES";case"es-LA":return"es-419";case"pt-BR":return"pt-BR";case"zh-CN":return"zh";case"zh-TW":return"zh-TW";case"da-DK":return"da";case"nl-NL":return"nl";case"fi-FI":return"fi";case"nb-NO":return"nb";case"sv-SE":return"sv";default:return"auto"}}function y(e){const r=(0,c().eP)(),t=(0,u().O4)({theme:r,useCssVars:!1}),{type:o}=e,a="setup"===o||"subscription"===o?e.currency:void 0,g="subscription"===o?e.amount:void 0,b=(0,s().K8)((()=>{var e;return(null===(e=i().default.state)||void 0===e||null===(e=e.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.preferred_locale)||d().q}),[]);return(0,n.useMemo)((()=>{const e=function(e){const r=x(e.text.primary),t=x(e.text.secondary),o=x(e.text.tertiary),n=x(e.red.text.accentPrimary),i=x(e.blue.text.accentPrimary),a=x(e.icon.inversePrimary),s=x(e.whiteButtonBackground);return{labels:"above",theme:"dark"===e.mode?"night":"stripe",variables:{spacingGridRow:"12px",spacingGridColumn:"12px",spacingUnit:"4px",spacingTab:"6px",colorPrimary:r,colorPrimaryText:r,colorText:r,colorTextSecondary:t,colorTextPlaceholder:o,colorIcon:r,colorIconCheckmark:a,colorDanger:n,colorBackground:s,colorIconTabHover:r,colorIconTabSelected:i,colorIconChevronDown:r,fontFamily:m().Tf.sans,fontWeightLight:`${m().Wy.light}`,fontWeightNormal:`${m().Wy.regular}`,fontWeightMedium:`${m().Wy.medium}`,fontWeightBold:`${m().Wy.medium}`,fontSizeBase:"14px",fontSizeSm:"12px",colorLogo:e.mode,colorLogoBlock:e.mode,colorLogoTab:e.mode,colorLogoTabSelected:e.mode,borderRadius:"6px"},rules:{".Tab":{padding:"10px 16px 10px 10px",fontSize:"13px",fontWeight:"500",lineHeight:"16px",color:r,border:`1px solid ${e.border.primary}`,boxShadow:"none",backgroundColor:e.whiteButtonBackground},".Tab:hover":{backgroundColor:e.whiteButtonHoveredBackground},".Tab:focus":{boxShadow:e.buttonBlueFocusRing},".Tab--selected, .Tab--selected:active":{backgroundColor:e.whiteButtonBackground,border:`1px solid ${e.blue.border.accentPrimary}`,color:r,boxShadow:"none",outline:"none"},".Tab--selected:hover":{backgroundColor:e.whiteButtonBackground,color:r},".Tab--selected:focus":{border:`1px solid ${e.blue.border.accentPrimary}`,boxShadow:e.buttonBlueFocusRing},".Input":{fontSize:"14px",lineHeight:"18px",padding:"7px 8px",backgroundColor:e.background.secondary,boxShadow:`0 0 0 1px ${e.border.primary}`,border:"none",color:r},".Input--invalid":{color:r,boxShadow:e.inputRedFocusRing},".Input:focus":{color:r,boxShadow:e.inputBlueFocusRing},".Label":{fontSize:"12px",lineHeight:"15px",fontWeight:"500",color:t,marginBottom:"8px"},".Error":{fontSize:"12px",fontWeight:"400",lineHeight:"15px",color:n},".CodeInput":{backgroundColor:e.background.secondary,border:`1px solid ${e.border.primary}`,boxShadow:"none"},".PickerItem, .PickerItem--selected":{backgroundColor:e.whiteButtonBackground,border:`1px solid ${e.border.primary}`,boxShadow:"none",color:r},".PickerItem:hover":{backgroundColor:e.whiteButtonHoveredBackground,color:r,border:`1px solid ${e.border.primary}`,boxShadow:"none"},".PickerItem--selected:hover":{boxShadow:"none"},".PickerItem--new":{fontSize:"14px",fontWeight:"500",lineHeight:"18px",color:r},".PickerItem--highlight, .PickerItem--highlight:hover":{backgroundColor:e.whiteButtonBackground,border:`1px solid ${e.blue.border.accentPrimary}`,boxShadow:"none"},".PickerItem--highlight:hover":{backgroundColor:e.whiteButtonHoveredBackground},".TermsText":{color:t,fontSize:"10px",fontWeight:"400",lineHeight:"13px",letterSpacing:"0.12px"},".CheckboxLabel":{color:r,fontSize:"12px",fontWeight:"500",lineHeight:"15px"},".Action, .MenuAction":{color:r,fontWeight:"400",padding:"4px 8px"},".Action:hover, .MenuAction:hover":{backgroundColor:e.buttonHoveredBackground},".BlockAction:focus, .CodeInput:focus, .Input:focus,.CheckboxInput:focus, .PickerItem:focus, .PickerAction:focus,.MenuAction:focus, .Action:focus, .SecondaryLink:focus":{boxShadow:e.buttonBlueFocusRing},".MenuIcon, .MenuIcon:hover":{fill:r},".Block":{backgroundColor:e.whiteButtonBackground,border:`1px solid ${e.border.primary}`,boxShadow:"none",padding:"16px"},".Icon":{fill:r}}}}(t),r={appearance:e,locale:f(b)},n={paymentMethodTypes:(0,l().VV)({currency:a})};switch(o){case"address":return r;case"setup":return{...r,...n,currency:null==a?void 0:a.toLowerCase(),mode:"setup",paymentMethodCreation:"manual"};case"subscription":return{...r,...n,amount:g,currency:null==a?void 0:a.toLowerCase(),mode:"subscription",paymentMethodCreation:"manual",setupFutureUsage:"off_session",loader:"never"};default:(0,p().HB)(o)}}),[t,b,a,o,g])}function h(e,r){if(!r.code)return r.message||"";switch(r.code){case"invalid_expiry_year_past":return e.formatMessage({id:"stripeHelpers.invalidExpiryYear.error.message",defaultMessage:"Your card's expiration year is in the past."});case"invalid_cvc":return e.formatMessage({id:"stripeHelpers.invalidCVC.error.message",defaultMessage:"Your card's security code is invalid."});case"invalid_number":return e.formatMessage({id:"stripeHelpers.invalidNumber.error.message",defaultMessage:"Your card number is not a valid credit card number."});case"card_declined":return function(e,r){switch(r){case"expired_card":return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message.expiredCard",defaultMessage:"Your card was declined because it is an expired card."});case"incorrect_number":return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message.incorrectNumber",defaultMessage:"Your card was declined because you input an incorrect number."});case"insufficient_funds":return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message.declinedFunds",defaultMessage:"Your card was declined because of insufficient funds."});case"invalid_cvc":return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message.invalidCvc",defaultMessage:"Your card was declined because you input an invalid CVC number"});case"invalid_amount":return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message.invalidAmount",defaultMessage:"Your card was declined because payment amount exceeds the amount that's allowed."});default:return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message",defaultMessage:"Your card was declined."})}}(e,r.decline_code);default:return r.message||""}}function v(e){return{labels:"floating",theme:"dark"===e.mode?"night":"stripe",variables:{spacingGridRow:"8px",spacingGridColumn:"8px",spacingUnit:"4px",spacingTab:"4px",colorPrimary:e.text.primary,colorPrimaryText:e.text.primary,colorText:e.text.primary,colorTextSecondary:e.text.secondary,colorTextPlaceholder:e.text.tertiary,colorIcon:e.text.primary,colorIconCheckmark:e.icon.inversePrimary,colorDanger:e.red.text.accentPrimary,colorBackground:e.whiteButtonBackground,colorIconTabHover:e.text.primary,colorIconTabSelected:e.blue.text.accentPrimary,colorIconChevronDown:e.text.primary,fontFamily:m().Tf.sans,fontWeightLight:`${m().Wy.light}`,fontWeightNormal:`${m().Wy.regular}`,fontWeightMedium:`${m().Wy.medium}`,fontWeightBold:`${m().Wy.semibold}`,fontSizeBase:"14px",fontSizeSm:"12px",colorLogo:e.mode,colorLogoBlock:e.mode,colorLogoTab:e.mode,colorLogoTabSelected:e.mode,borderRadius:"6px"},rules:{".Tab":{padding:"10px 16px 10px 10px",fontSize:"13px",fontWeight:"510",lineHeight:"16px",color:e.text.primary,border:`1px solid ${e.border.primary}`,boxShadow:"none",backgroundColor:e.whiteButtonBackground},".Tab:hover":{backgroundColor:e.whiteButtonHoveredBackground,color:e.text.primary},".Tab:focus":{backgroundColor:e.whiteButtonBackground,border:`1px solid ${e.border.primary}`,boxShadow:e.buttonBlueFocusRing},".Tab--selected, .Tab--selected:hover, .Tab--selected:active":{backgroundColor:e.whiteButtonBackground,border:`1px solid ${e.blue.border.accentPrimary}`,color:e.text.primary,boxShadow:"none",outline:"none"},".Tab--selected:focus":{border:`1px solid ${e.blue.border.accentPrimary}`,boxShadow:e.buttonBlueFocusRing},".Input":{fontSize:"14px",lineHeight:"18px",padding:"4px 8px",boxShadow:"none",backgroundColor:e.background.secondary,border:`1px solid ${e.border.primary}`,color:e.text.primary},".Input--invalid":{border:"none",color:e.text.primary,boxShadow:e.inputRedFocusRing},".Label":{fontSize:"14px",lineHeight:"18px",color:e.text.tertiary},".Label--floating":{fontSize:"10px",fontWeight:"510",lineHeight:"13px",letterSpacing:"0.12px",marginTop:"4px",transition:"all 200ms ease",color:e.text.secondary},".Error":{fontSize:"12px",fontWeight:"400",lineHeight:"15px",color:e.red.text.accentPrimary},".CodeInput":{backgroundColor:e.background.secondary,border:`1px solid ${e.border.primary}`,boxShadow:"none"},".PickerItem, .PickerItem--selected":{backgroundColor:e.whiteButtonBackground,border:`1px solid ${e.border.primary}`,boxShadow:"none",color:e.text.primary},".PickerItem:hover, .PickerItem--selected:hover":{backgroundColor:e.whiteButtonHoveredBackground,color:e.text.primary,border:`1px solid ${e.border.primary}`,boxShadow:"none"},".PickerItem--new":{fontSize:"14px",fontWeight:"500",lineHeight:"18px",color:e.text.primary},".PickerItem--highlight, .PickerItem--highlight:hover":{backgroundColor:e.whiteButtonBackground,border:`1px solid ${e.blue.border.accentPrimary}`,boxShadow:"none"},".PickerItem--highlight:hover":{backgroundColor:e.whiteButtonHoveredBackground},".TermsText":{color:e.text.secondary,fontSize:"12px",fontWeight:"400",lineHeight:"15px"},".CheckboxLabel":{color:e.text.primary,fontSize:"12px",fontWeight:"500",lineHeight:"15px"},".Action, .MenuAction":{color:e.text.primary,fontWeight:"400"},".Action:hover, .MenuAction:hover":{backgroundColor:e.buttonHoveredBackground},".BlockAction:focus, .CodeInput:focus, .Input:focus,.CheckboxInput:focus, .PickerItem:focus, .PickerAction:focus,.MenuAction:focus, .Action:focus, .SecondaryLink:focus":{boxShadow:e.buttonBlueFocusRing},".MenuIcon, .MenuIcon:hover":{fill:e.text.primary},".Block":{backgroundColor:e.whiteButtonBackground,border:`1px solid ${e.border.primary}`,boxShadow:"none",color:e.text.primary}}}}function x(e){const[r,t,o,n]=e.match(/[\d.]+/g)??[];return r&&t&&o&&n&&1===parseInt(n)?`rgb(${r}, ${t}, ${o})`:e}function I(e){return"paymentMethodId"===(null==e?void 0:e.type)?e.value:void 0}},435777:(e,r,t)=>{t.d(r,{D:()=>o});const o=(0,t(69708).YK)({updatingSubscription:{id:"subscriptionSettings.updatingSubscriptionMessage",defaultMessage:"Getting your workspace ready…"},paymentMethodUpdateAuthFailed:{id:"subscriptionSettings.paymentMethodUpdateAuthFailedMessage",defaultMessage:"We could not update your payment method. Please try again or contact support."},verifyingEligibility:{id:"subscriptionSettings.verifyingEligibilityMessage",defaultMessage:"Verifying eligibility…"},educationPlusFree:{id:"subscriptionSettings.educationPlusFreeMessage",defaultMessage:"You are now subscribed to Notion’s Education plan for free"},finishingUp:{id:"subscription.upgrade.finishing",defaultMessage:"Finishing up..."},useAnotherPaymentMethod:{id:"subscriptionSettings.useAnotherPaymentMethodMessage",defaultMessage:"We could not process this payment method. Please use a different payment method."}})},589531:(e,r,t)=>{t.d(r,{n:()=>x});t(16280);var o=()=>t(792057),n=()=>t(741615),i=()=>t(342641),a=()=>t(495106),s=()=>t(795523),c=()=>t(979340),d=()=>t(934839),l=()=>t(496414),u=()=>t(209660),p=()=>t(150193),m=()=>t(404141),g=()=>t(946473),b=()=>t(370441),f=()=>t(435777),y=()=>t(800168),h=()=>t(335014),v=()=>t(311638);async function x(e){const{from:r,environment:t,spaceStore:x,billingEmail:I,paymentData:S,vatId:w,coupon:k,customerName:_,businessName:T,addressLine1:C,addressLine2:B,addressZip:D,addressCity:P,addressState:A,addressCountry:M,promoCodeId:E,offerInfo:U,deviceId:L,useTestClock:$,sessionId:H,desiredState:O,trialData:N,partnerRedemptionInfo:W,postUpgradeCallback:R,performImmediately:F,loadingMessage:z}=e;d().Re({bannerStore:p().A}),l().m({message:z??f().D.updatingSubscription});const V=x.id,q=await(0,n().Vv)({environment:t,spaceId:V});if(!q)throw new Error("Billing data not loaded");let Y;if(O&&0===O.items.length)Y=await t.api.callApi({eventName:"cancelSubscription",environment:t,data:{spaceId:x.id,cancelImmediately:e.performImmediately}});else{const e=F?{prorationBehavior:"always_invoice",billingCycleAnchor:"now"}:void 0;Y=await t.api.callApi({eventName:"updateSubscription",environment:t,data:{spaceId:V,desiredState:O?(0,s().Lm)(O):void 0,billingEmail:I,paymentMethodId:(0,b().optionalPaymentMethodIdGivenPaymentData)(S),vatId:w,coupon:k,customerName:_,businessName:T,addressLine1:C,addressLine2:B,addressZip:D,addressCity:P,addressState:A,addressCountry:M,promoCodeId:E,useTestClock:$,countryCode:undefined,modalSessionId:H,offerInfo:U,clientVersion:t.device.version,trialData:N,deviceId:L,partnerRedemptionInfo:W,from:r,billingPolicyOverwrites:e}})}if("failed"===Y.type)throw l().V(),o().Qg(Y),new Error("An error occurred while updating subscription");(0,h().o)({environment:t,spaceStore:x});const G=await(0,n().Vv)({environment:t,spaceId:V}),j=await a().T.awaitData(t,{userId:t.currentUser.id||""}),K=(0,g().H)(j,x,G);if(!G)throw l().V(),new Error("Billing data not loaded");const J=x.getPlanType();if((0,v().i)({environment:t,context:{spaceId:V,planType:J,from:r,isMmOrEnt:K,trialData:N,modalId:H,offer:null==U?void 0:U.campaign},oldData:q,newData:G,desiredState:O}),i().default.resetData(t,{spaceId:V}),l().V(),R)R();else if(Boolean(N)){if((0,s().TB)(q)&&!(0,s().TB)(G)){const e=(0,s().AW)(q);"upgrade"===(0,c().qR)({oldTier:e,newTier:(0,s().AI)(G)})&&(0,y().u)({oldTier:(0,s().AW)(q),newTier:(0,s().AI)(G),oldAddOns:(0,s().ji)(q),newAddOns:(0,s().ji)(G)})}}else(0,y().u)({oldTier:(0,s().AI)(q),newTier:(0,s().AI)(G),oldAddOns:(0,s().ji)(q),newAddOns:(0,s().ji)(G)});return m().Ay.state.open&&"requests"===m().Ay.state.currentTab&&u().Ow({currentTab:"billing"}),Y.data}},702538:(e,r,t)=>{t.d(r,{p:()=>n});var o=()=>t(314529);function n(e,r){(0,o().DO_NOT_USE_trackLegacy)(e,"subscription_update_billing",r)}},800168:(e,r,t)=>{t.d(r,{u:()=>i});var o=()=>t(807778),n=()=>t(51473);function i(e){return!!(0,o().Pe)()&&n().q.open(e)}},805061:(e,r,t)=>{t.d(r,{c:()=>o});const o=new(t(62175).U)(((e,{spaceId:r})=>`${e.currentUser.id}:${r}`),(async(e,{spaceId:r})=>{const t=await e.api.callCellCompatibleApi({eventName:"getLegacyPriceInfo",environment:e,data:{spaceId:r},cellNavigation:{cellId:void 0,spaceId:r}});if("success"===t.type)return t.data}))},807487:(e,r,t)=>{t.d(r,{VV:()=>s,_6:()=>i,_q:()=>a,ex:()=>n});t(16280),t(944114),t(898992),t(672577);var o=()=>t(326215);function n(e,r){return r?r.percent_off?{amount:e*r.percent_off/100,monthsRemaining:r.duration_in_months}:r.amount_off?{amount:r.amount_off}:{amount:0}:{amount:0}}function i(e){return"personal"!==e&&o().tX.find((r=>r===e))}const a=["kr_card","kakao_pay"];function s(e){const{currency:r}=e,t=["card","link"];return"EUR"===r&&t.push("sepa_debit"),"KRW"===r&&t.push(...a),t}},973992:(e,r,t)=>{t.d(r,{L:()=>o});const o=new(t(62175).U)(((e,{spaceId:r})=>`${e.currentUser.id}:${r}`),(async(e,{spaceId:r})=>{var t;const o=await e.api.callApi({eventName:"getBillingHistory",environment:e,data:{spaceId:r,limit:20}});return"success"===o.type?null===(t=o.data)||void 0===t?void 0:t.events:void 0}));t(852832).exposeDebugValue("BillingHistoryStore",o)}}]);