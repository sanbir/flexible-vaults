"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[52871],{523195:(e,t,n)=>{n.d(t,{o:()=>i});var o=()=>n(486674);function i(){const e=(0,o().a)();return!e||!e.isLocked()}},552871:(e,t,n)=>{n.d(t,{L:()=>d});var o=()=>n(907258),i=()=>n(484714),a=()=>n(792485),r=()=>n(590526),s=()=>n(988083),l=()=>n(469874),c=()=>n(658012);function d(){const e=(0,i().v3)(),t=(0,i().Y0)(),n=(0,a().S)(),d=(0,r().K8)((()=>{if(!t.isMobileNative||!t.isAndroid)return 0;const{mainEditorCurrentBlockStore:i}=o().default.state;if(!i)return 0;return(0,c().mobileActionBarRenderAvailability)(e,i,null==n?void 0:n.publicEditModeStore.state,n).shouldShow?48:0}),[e,t,n]);return(0,r().K8)((()=>{const n=t.isMobileNative?12:24;if(!t.isMobileNative)return n;const o=(0,l().y)(e,s().A.keyboardHeight(),s().A.state.nativeBottomBarHeight);return n+d+o}),[e,t.isMobileNative,d])}},560595:(e,t,n)=>{n.d(t,{f:()=>r});var o=()=>n(232615),i=()=>n(496603),a=()=>n(486674);function r(){const e=(0,a().a)(),t=o().default.state;if("editing"!==t.mode)return!1;const n=t.multiSelection.start.store;return Boolean(e&&e.id===n.id&&(e.getBlockTitleStore()===n||i().n4(e.getBlockTitleStore().path,n.path)))}},654774:(e,t,n)=>{n.d(t,{x:()=>d});var o=()=>n(115438),i=()=>n(906536),a=()=>n(232615),r=()=>n(355110),s=()=>n(184033),l=()=>n(238121),c=()=>n(718957);function d(e){var t;(0,o().l)();const{environment:n,store:d,canSelectAllBlocks:u}=e,m=(0,s().s)(d),p={startIndex:0,endIndex:m?m.endIndex:0};u&&"empty"!==a().default.state.mode&&(0,l().G)(null===(t=(0,c().cR)("textSelectionActions",a().default.state.multiSelection))||void 0===t?void 0:t.selection,p)?(0,r().U)(n):(0,i().t)({store:d,selection:p})}},658012:(e,t,n)=>{n.r(t),n.d(t,{canMoveDown:()=>ze,canMoveUp:()=>Ge,canShowMobileActionBar:()=>Ce,canTriggerBlockActions:()=>De,canTriggerTextActions:()=>Re,getOpenPropertyValueOverlaySchema:()=>mt,handleAi:()=>We,handleComment:()=>Xe,handleDatabaseDiscoveryModal:()=>nt,handleDelete:()=>Ke,handleDismissKeyboard:()=>ct,handleEmojiPicker:()=>at,handleEquation:()=>tt,handleFilePicker:()=>rt,handleIndent:()=>Ve,handleLink:()=>Ye,handleMention:()=>je,handleMoreClick:()=>st,handleMoveDown:()=>Le,handleMoveUp:()=>Fe,handleReaction:()=>et,handleRedo:()=>Je,handleSetMenu:()=>Ze,handleSetSubMenu:()=>qe,handleTeamspaceSelector:()=>lt,handleTemplate:()=>it,handleTemplates:()=>ot,handleTextAnnotation:()=>$e,handleUndo:()=>Qe,handleUnindent:()=>He,isEditingCollectionTextProperty:()=>Ne,mobileActionBarRenderAvailability:()=>Oe,shouldPreserveExistingSelection:()=>Ue,shouldShowTemplatesButton:()=>Ie,shouldShowTextActions:()=>Ee,trackItemTap:()=>dt,updateDebugShouldShow:()=>_e});n(18107),n(944114),n(967357),n(898992),n(581454),n(737550);var o=()=>n(907258),i=()=>n(242422),a=()=>n(726637),r=()=>n(908006),s=()=>n(110750),l=()=>n(675133),c=()=>n(201794),d=()=>n(489295),u=()=>n(598790),m=()=>n(587031),p=()=>n(172489),f=()=>n(77311),v=()=>n(232615),S=()=>n(960955),h=()=>n(713998),b=()=>n(165358),g=()=>n(416504),A=()=>n(179034),M=()=>n(797573),w=()=>n(201980),y=()=>n(328523),B=()=>n(160568),k=()=>n(901265),T=()=>n(448619),x=()=>n(501666),P=()=>n(829300),_=()=>n(44729),C=()=>n(495262),O=()=>n(391214),N=()=>n(261156),I=()=>n(662453),E=()=>n(286088),U=()=>n(483730),D=()=>n(37450),R=()=>n(543886),V=()=>n(441467),H=()=>n(517288),F=()=>n(730307),L=()=>n(158658),G=()=>n(523195),z=()=>n(560595),K=()=>n(401040),j=()=>n(499764),W=()=>n(460957),$=()=>n(993130),Z=()=>n(673477),q=()=>n(952412),J=()=>n(905487),Q=()=>n(440024),Y=()=>n(518489),X=()=>n(582783),ee=()=>n(747674),te=()=>n(206051),ne=()=>n(644914),oe=()=>n(749687),ie=()=>n(875827),ae=()=>n(857048),re=()=>n(525569),se=()=>n(777932);const le={pageTemplateModalActions:new(n(79926).O2)("pageTemplateModalActions",(async()=>Promise.all([n.e(35530),n.e(9773),n.e(36556),n.e(40537),n.e(27992),n.e(63452),n.e(66249),n.e(92845),n.e(44854),n.e(87017),n.e(47668),n.e(48486),n.e(34208)]).then(n.bind(n,69660))))};var ce=()=>n(127581),de=()=>n(295304),ue=()=>n(654774),me=()=>n(184033),pe=()=>n(341880),fe=()=>n(318880),ve=()=>n(718957),Se=()=>n(547149),he=()=>n(839754),be=()=>n(922952),ge=()=>n(373444),Ae=()=>n(98244),Me=()=>n(892632),we=()=>n(144440),ye=()=>n(120672),Be=()=>n(18387),ke=()=>n(299545);var Te=()=>n(645266),xe=()=>n(900442);let Pe=!1;function _e(e){Pe=e}function Ce(e,t,n,o){var r;const{device:l,TabbedRouterStore:c}=e,d=Pe||Boolean(xe().A.state.enableShouldShowDebugging);if(!a().A.isMobile)return ut(d,"canShowMobileActionBar = false (reason: !config.isMobile)"),!1;if((0,$().A)(e)&&i().default.checkGate({gateName:"mab_consider_navigation_top_page"})){const e=(0,s().Xz)(c.state);if("web"!==e.type||"page"!==(0,s().AE)(e).route.name)return ut(d,"canShowMobileActionBar = false (reason: top page is not a web page)"),!1}if(J().default.state.open)return ut(d,"canShowMobileActionBar = false (reason: quickFindOpen)"),!1;if(!l.isMobileNative&&Z().Ay.state.open)return ut(d,"canShowMobileActionBar = false (reason: !device.isMobileNative && MentionMenuStore.state.open)"),!1;if(v().default.isEditingComment())return ut(d,"canShowMobileActionBar = false (reason: TextSelectionStore.isEditingComment())"),!1;const u=(0,E().SB)(re().default.state),m=null===(r=U().default.getActiveSession())||void 0===r?void 0:r.hasPendingOperations();if(u||m)return ut(d,"canShowMobileActionBar = false (reason: isCompletionsPopupActive || hasPendingEdits)"),!1;if(!R().A.state.isOpen&&e.device.isMobileNative&&S().A.hasOpenPopups())return ut(d,"canShowMobileActionBar = false (reason: !PageTemplateModalStore.state.open && environment.device.isMobileNative && GlobalPopupStore.hasOpenPopups() > 0)"),!1;if(R().A.state.isOpen){const t=mt(R().A.state);if(!t)return ut(d,"canShowMobileActionBar = false (reason: PageBlockPropertyValueOverlayStore.state.isOpen && propertySchema === undefined)"),!1;switch(t.type){case"text":if(t.ai_inference)return ut(d,"canShowMobileActionBar = false (reason: PageBlockPropertyValueOverlayStore.state.isOpen && propertySchema.ai_inference !== undefined)"),!1;break;case"number":if(!function(e){const{device:t}=e,{isIOS:n,isIpad:o}=t;return n&&!o&&i().default.checkGate({gateName:"ios_number_property_mab"})}({device:e.device}))return ut(d,'canShowMobileActionBar = false (reason: PageBlockPropertyValueOverlayStore.state.isOpen && propertySchema.type == "number")'),!1;break;default:return ut(d,`canShowMobileActionBar = false (reason: PageBlockPropertyValueOverlayStore.state.isOpen && propertySchema.type == "${t.type}`),!1}}if(t.isFormBlock())return!1;const p="editing"===v().default.state.mode;if(ne().KB(e)&&oe().sidebarOpenStore.state&&!p)return ut(d,"canShowMobileActionBar = false (reason: sidebarHelpers.sidebarIsExpanded(environment) && sidebarOpenStore.get() && !isCurrentlyEditing"),!1;if(!(0,G().o)())return ut(d,"canShowMobileActionBar = false (reason: !currentPageIsNotLocked())"),!1;return!!(0,L().p)({environment:e,blocks:[t],publicEditMode:n,pageContext:o})||(ut(d,"canShowMobileActionBar = false (reason: !_canEdit)"),!1)}function Oe(e,t,n,o){var i,a;const r=Pe||Boolean(xe().A.state.enableShouldShowDebugging);if(!Ce(e,t,n,o))return ut(r,"shouldShowMobileActionBar = false (reason: !canShowMobileActionBar)"),{canShow:!1,canShowNativeBar:!1,shouldShow:!1};const s=e.device.isMobileNative;if(null!==(i=xe().A.state.menu)&&void 0!==i&&i.type&&!(0,z().f)())return ut(r,"shouldShowMobileActionBar = true (reason: NativeMobileActionBarStore && NativeMobileActionBarStore.state.menu?.type"),{canShow:!0,canShowNativeBar:s,shouldShow:!0};const l=v().default.state;if("editing"!==l.mode)return ut(r,"shouldShowMobileActionBar = false (reason: TextSelectionStore.state.mode !== editing"),{canShow:!0,canShowNativeBar:s,shouldShow:!1};const c=l.multiSelection,d=(0,ve().$W)(c),u=d.some((e=>e.editable.props.disableStyleAnnotations)),m=d.some((e=>e.editable.props.disableMobileActionBar)),p=d.some((e=>e.editable.props.disableComment));return d&&m?(ut(r,"shouldShowMobileActionBar = false (reason: !renderedBlocks || !disableMobileActionBar)"),{canShow:!0,canShowNativeBar:s,shouldShow:!1}):(ut(r,"shouldShowMobileActionBar = true"),{shouldShow:!0,canShowNativeBar:s,disableStyleAnnotations:u,disableComment:p,isEmpty:(0,f().k)(c)&&0===c.end.index&&0===(null===(a=(0,me().s)(c.end.store))||void 0===a?void 0:a.endIndex)})}function Ne(){var e;const t=R().A.state;if(!t.isOpen)return!1;const n=null===(e=t.collectionContextStore)||void 0===e?void 0:e.normalizedSchemaStore.state;if(!n)return!1;const o=(0,h()._g)({schema:n,property:t.property});return"text"===(null==o?void 0:o.type)}function Ie(e){const{environment:t,store:n}=e,{isPhone:i}=t.device,a=t.currentUser.isLoggedIn(),r=n.isCollectionView(),s=n.getAssociatedCollectionStore(),l=ce().A.state.open,c=o().default.state.currentLoadingContainerStore,d=n.getContentStores()[0],u=d&&!d.isEmptyTextBlock();return Boolean(i&&n.isDefined()&&n.canEdit()&&a&&!s&&!r&&!l&&!u&&c&&c.state.ready)}function Ee(e,t){const n=v().default.state;if("editing"===n.mode)return!t.state.isComposing&&!(0,f().k)(n.multiSelection)||void 0!==ae().wg();const o=e.state.savedTextSelectionStoreState;return!(!o||"editing"!==o.mode)&&!(0,f().k)(o.multiSelection)}function Ue(e){var t;const{device:n}=e;return Boolean((null===(t=xe().A.state.menu)||void 0===t?void 0:t.type)&&!n.isTablet&&!n.isAndroid&&!(0,c().T)("supportsMobileActionBarNativeActionMenuWithoutIgnoreSelectionArea"))}function De(e){if((0,j().QT)(e))return!1;const{stores:t}=te().default.state;return t.length>0&&t[0].canEdit()&&!t[0].isNavigableBlock()&&!Boolean(ae().wg())}function Re(e,t){return!(0,j().QT)(e)&&t.canEdit()}function Ve(e){"editing"===v().default.state.mode&&(Se().createAndCommit({userAction:"mobileActionBarHelpers.handleIndent",environment:e,canUndo:!0,perform:t=>{de().Mf({environment:e,transaction:t,shiftKey:!1})}}),dt(e,"indent"))}function He(e){"editing"===v().default.state.mode&&(Se().createAndCommit({userAction:"mobileActionBarHelpers.handleUnindent",environment:e,canUndo:!0,perform:t=>{de().Mf({environment:e,transaction:t,shiftKey:!0})}}),dt(e,"unindent"))}function Fe(e){Se().createAndCommit({userAction:"mobileActionBarHelpers.handleMoveUp",environment:e,canUndo:!0,perform:t=>{de().$P({environment:e,transaction:t,direction:"up",maintainParent:!0})}}),dt(e,"move-up")}function Le(e){Se().createAndCommit({userAction:"mobileActionBarHelpers.handleMoveDown",environment:e,canUndo:!0,perform:t=>{de().$P({environment:e,transaction:t,direction:"down",maintainParent:!0})}}),dt(e,"move-down")}function Ge(e){if(!e)return!1;const t=e.getRecordStoreUIParent();if(null==t||!t.isTable(A().ev))return!1;const n=(0,d().zH)(t);if(null==n||!n.isDefined())return!1;return n.getContentIds().indexOf(e.id)>0}function ze(e){if(!e)return!1;const t=e.getRecordStoreUIParent();if(null==t||!t.isTable(A().ev))return!1;const n=(0,d().zH)(t);if(null==n||!n.isDefined())return!1;const o=n.getContentIds(),i=o.indexOf(e.id);return i>=0&&i<o.length-1}function Ke(e){const t=te().default.state.stores[0],n=v().default.state;if(t&&"editing"===n.mode){const{multiSelection:o}=n,i=(0,pe().J)(o.end.store)||(0,fe().H)(o.start.store),a=t.getParentBlockStore(),r=a&&a.isCalloutV2()&&1===a.getContentLength();Se().createAndCommit({userAction:"mobileActionBarHelpers.handleDelete",environment:e,canUndo:!0,perform:e=>{if(r){const t=a.getParentBlockStore();t&&_().zz({childStore:a,parentStore:t,transaction:e})}else O().TF({store:t,transaction:e})}});if(ae().wg())Se().createAndCommit({userAction:"mobileActionBarHelpers.handleDelete",environment:e,canUndo:!0,perform:t=>{(0,ie().x)({environment:e,transaction:t})}});else if(i){const t=(0,u().T)(i);(0,Y().h)({environment:e,store:t}),(0,X().Z)(e)}else(0,Q().I)({environment:e});dt(e,"remove")}}function je(e,t){P().Gf({spaceStore:t,environment:e,mentionTypes:{page:!0,collection:!0,heading:!0,createPage:!0,user:!0,inviteUserToWorkspace:!1,inviteUserToPage:!0,bot:!0,date:!0,reminder:!0,templateVariable:!0,group:!0,team:!0,formulaContextVariable:!0,slackSpecialMention:!1,property:!1}}),dt(e,"mention")}function We(e){const t=v().default.state;if("editing"===t.mode&&(0,f().k)(t.multiSelection)){const t=te().default.state.stores.at(0),n=null==t?void 0:t.getTitleStore();t&&n&&!t.isEmptyTextBlock()&&(0,ue().x)({environment:e,store:n,canSelectAllBlocks:!0})}if(i().default.checkGate({gateName:"agent_writer"})&&e.device.isMobileNative){const t=(0,K().G)();if(t&&(0,c().T)("supportsNativeAgent")){var n;const o=[];if("textSelection"===t.type){const e=(0,W().E)({mode:"editing",multiSelection:t.textSelection,forceExtendAnnotations:{}}),n=t.textSelection.start.store.pointer,i=t.textSelection.end.store.pointer;n.table===A().ev&&i.table===A().ev&&o.push({textSelection:{type:"text",value:{start:{pointer:n,index:t.textSelection.start.index},end:{pointer:i,index:t.textSelection.end.index}},text:e.slice(0,1200)}})}if("blockSelection"===t.type){const e=(0,ve().BO)(t.stores),n=e?(0,W().E)({mode:"editing",multiSelection:e,forceExtendAnnotations:{}}):"";o.push({blockSelection:{type:"blocks",value:t.stores.map((e=>e.pointer)),text:n.slice(0,1200)}})}null===(n=e.mobileNative)||void 0===n||n.openNewAgentChat({mode:"writer",userSpecifiedContextValues:o.length>0?o:void 0}),dt(e,"ai")}}else!async function(e){const{completionInitialPromptActions:t}=await I().aiDependency.load();await t.toggleInitialPrompt(e)}({from:"mobile_action_bar",environment:e}),dt(e,"ai")}function $e(e,t){N().po({environment:e,annotation:t}),dt(e,t[0])}function Ze(e,t,n){xe().A.update((e=>({...e,menu:t,shouldRestoreSelectionForMenu:n})))}function qe(e,t,n){xe().A.update((e=>({...e,isSubMenuOverridden:n,subMenu:t}))),void 0===t?(0,m().V)({environment:e,dismissed:!0,trackCreateBlock:D().vH}):dt(e,t.type)}function Je(e){C().ZS({environment:e}),dt(e,"redo")}function Qe(e){C().tN({environment:e,preventSelectText:!1}),dt(e,"undo")}function Ye(e){x().fi({type:"focusOnly",focus:!0}),dt(e,w().Ifu.Link)}function Xe(e,t,n){const o=te().default.state.stores[0];if(!o)return;const i=v().default.state,a="empty"!==i.mode&&i.multiSelection;a&&!(0,f().k)(a)?(V().hN({environment:e,blockStore:o,multiSelection:a,formulasModule:n}),dt(e,"comment",t)):((0,F().l)({environment:e,blockStore:o}),dt(e,"discuss",t))}function et(e,t,n,o){(0,H().O)({environment:e,blockStore:n,from:"right_margin",formulasModule:o}),dt(e,"react",t)}function tt(e){T().Wx({environment:e,analyticsFrom:"rich_text_menu"}),dt(e,"equation")}async function nt(e,t){i().default.checkGate({gateName:"mobile_discovery_modal_restore_selection_killswitch"})&&((0,Q().I)({environment:e}),(0,p().k)());const n=t.getParentStore();if(n&&(0,be().u)(n)){const{openTemplateOnboardingModal:o,getTemplateOnboardingVersion:i}=await ge().O.load();o({parentStore:n,template:void 0,version:i({template:void 0}),origin:"mobile_new_page_pills",navigateToOnFinish:"created_collection",onClose:n=>{(0,he()._M)({environment:e,newPageStore:t,result:n})}})}else dt(e,"databaseDiscoveryModal")}function ot(e){i().default.checkGate({gateName:"mobile_template_gallery_restore_selection_killswitch"})&&((0,Q().I)({environment:e}),(0,p().k)()),Te().A.setState({open:!0}),dt(e,"templates")}async function it(e,t){var n;const{sidebarSpaceViewStore:i,sidebarSpaceStore:a,mainEditorCurrentBlockStore:r}=o().default.state;if(!i||!a||!r)return;const s=l().A.getIntl(),c=(0,g().P)(),d=(0,M().B)(t,s),u=((null===(n=r.getModel())||void 0===n||null===(n=n.getRenderTitle({getRecordModel:r.getRecordModel,userTimeZone:c,intl:s}))||void 0===n?void 0:n.length)??0)>0;let m=!1;const p=Date.now();try{se().A.setState({isDuplicating:!0});const t=await le.pageTemplateModalActions.load();await t.loadAndDuplicatePageTemplate({environment:e,isPrivate:!1,item:d,spaceStore:a,spaceViewStore:i,useMinimalTemplates:!1,initializeStore:r}),m=!0}finally{se().A.setState({isDuplicating:!1});const t=Date.now()-p;B().hB(e,{from:"mobileApp",success:m,context:"template_pill",template_block_id:d.rootId,target_space_id:a.id,template_duplication_duration_ms:t,public_template_name:d.name,has_existing_title:u})}}function at(e){!async function(e){var t;if(!e.mobileNative)return;const n=v().default.state;if("editing"!==n.mode)return;const o=null===(t=await e.mobileNative.openEmojiPicker())||void 0===t?void 0:t.emoji;o&&Se().createAndCommit({userAction:"mobileActions.pickEmoji",environment:e,canUndo:!0,perform:t=>{Ae().Yf({environment:e,multiSelection:n.multiSelection,isFromInsertion:!1}),Ae().Ju({environment:e,emoji:o,transaction:t}),Ae().VN()}})}(e),dt(e,"pick_emoji")}function rt(e){!async function(e){const t=te().default.state.stores,n=e.device.isIOS,o=await Me().dA({environment:e,supportsMobileNativeFileUpload:!0,multiple:!0,accept:n?"*/*":"image/*, video/*"}),i=te().default.getCurrentRecordCache(),a=(0,ye().y)(e);o&&0!==o.length&&i&&Se().createAndCommit({userAction:"mobileActions.takePicture",environment:e,canUndo:!0,perform:n=>{var r;const s=we().$C({environment:e,files:o,inMemoryRecordCache:i,pageWidth:a,transaction:n,spaceId:0!==t.length?t[0].pointer.spaceId:null===(r=(0,Be().Z)())||void 0===r?void 0:r.pointer.spaceId});1===t.length&&t[0]&&(0,ke().wm)(t[0])?O().t1({environment:e,blocks:s,selection:t,transaction:n,preventSetSelection:!0}):(O().LE({environment:e,blocksToInsert:s,target:t,transaction:n,replaceEmptyTextBlock:!0}),(0,Q().I)({environment:e}))}})}(e),dt(e,"take_picture")}function st(e){const{device:t}=e,n=t.isMobileNative&&t.isIOS&&t.isPhone;n||(0,ee().t)({environment:e,stores:te().default.state.stores}),k().WU({environment:e,stores:te().default.state.stores,actionSectionGroupKey:"default",showInput:!1,analyticsFrom:"mobile_more_menu"}),dt(e,"more"),r().default.afterNextFlush((()=>{n&&(0,p().k)()}))}function lt(e){const{device:t}=e,n=t.isMobileNative&&t.isIOS&&t.isPhone;n||(0,ee().t)({environment:e,stores:te().default.state.stores}),q().u.openTeamTargetMobilePopup(),dt(e,"teamspaceSelector"),r().default.afterNextFlush((()=>{n&&(0,p().k)()}))}function ct(e,t){(0,Q().I)({environment:t}),e.store.setState({...e.store.state,isInsertOpen:!1}),dt(t,"hide_keyboard"),(0,p().k)()}function dt(e,t,n){y().np(e,{itemName:t,from:n})}function ut(e,t){e&&(console.log(t),b().log({level:"info",from:"mobileActionBarHelpers.ts",type:"logShouldShowReason",data:{message:t}}))}function mt(e){var t;if(!e.isOpen)return;const n=null===(t=e.collectionContextStore)||void 0===t?void 0:t.normalizedSchemaStore.state;return n?(0,h()._g)({schema:n,property:e.property}):void 0}},952412:(e,t,n)=>{n.d(t,{u:()=>i});class o extends(()=>n(757695))().Store{getInitialState(){return{selectedTeamStore:void 0,subscribedUserTeamStores:void 0,collectionContextStore:void 0,isPostsCollectionLoaded:!1,setComposerStyle:void 0,teamTargetMobilePopupOpen:!1}}openTeamTargetMobilePopup(){this.setState({...this.state,teamTargetMobilePopupOpen:!0})}closeTeamTargetMobilePopup(){this.setState({...this.state,teamTargetMobilePopupOpen:!1})}reset(){this.setState({selectedTeamStore:void 0,subscribedUserTeamStores:void 0,collectionContextStore:void 0,isPostsCollectionLoaded:!1,setComposerStyle:void 0,teamTargetMobilePopupOpen:!1})}}const i=new o}}]);