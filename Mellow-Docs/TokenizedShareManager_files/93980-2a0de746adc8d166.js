"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[93980],{100594:(e,t,o)=>{o.d(t,{CN:()=>D,D0:()=>B,D5:()=>M,GL:()=>C,HI:()=>f,I9:()=>v,JQ:()=>h,JW:()=>T,PC:()=>S,Rb:()=>P,SK:()=>k,UK:()=>G,VY:()=>d,YU:()=>F,Yp:()=>b,_x:()=>x,bg:()=>m,fn:()=>q,hw:()=>s,i8:()=>R,io:()=>g,kq:()=>y,q_:()=>I,tG:()=>_,xS:()=>V,zn:()=>L});var r=()=>o(534177),n=()=>o(341136),a=()=>o(381283),i=()=>o(708685),l=()=>o(62371),u=()=>o(713998),c=()=>o(499755),p=()=>o(901610);const s=["Solid","Dash"],g=10,d=["gray","blue","yellow","green","purple","teal","orange","pink","red"],y=["auto","colorful"],f=[...d,...y];let m=function(e){return e.small="small",e.medium="medium",e.large="large",e.extra_large="extra_large",e}({});function v(e){switch(e){case m.small:return 150;case m.medium:return 250;case m.large:return 300;case m.extra_large:return 400;default:(0,r().HB)(e)}}let C=function(e){return e.avatar="avatar",e.avatar_name="avatar_name",e.name="name",e}({}),_=function(e){return e.none="none",e.x_axis="x_axis",e.y_axis="y_axis",e.both="both",e}({}),h=function(e){return e.none="none",e.horizontal="horizontal",e.vertical="vertical",e.both="both",e}({}),S=function(e){return e.normal="normal",e.percent="percent",e.side_by_side="side_by_side",e}({}),B=function(e){return e.none="none",e.value="value",e.name="name",e.name_and_value="name_and_value",e}({});function w(e){if(!e)return!1;return l().BI.includes(e)}function b(e){const t=(0,i().getFormulaPropertySchemaBaseResultType)(e);return"text"===t||"number"===t||"checkbox"===t||"person"===t||"date"===t}function F(e,t){var o,n;let a,i=e.chartFormat;if("groups_reducer"===e.dataConfig.type){var p;const{chartFormat:o,chartGroupByFormat:r}=function(e,t,o,r){const n=(0,u()._g)({schema:r,property:e.property});if(n&&"donut"===o&&(0,c().e0)(n)){const o=(0,l().MP)(e);return{chartFormat:{...t,mainSort:c().S0.yDescending},chartGroupByFormat:o}}return{chartFormat:t,chartGroupByFormat:e}}(null==e||null===(p=e.dataConfig)||void 0===p?void 0:p.groupBy,null==e?void 0:e.chartFormat,"donut",t);i=o,a={...e.dataConfig,groupBy:r,aggregationConfig:{aggregation:e.dataConfig.aggregationConfig.aggregation}}}else"results_reducer"===e.dataConfig.type?(a=e.dataConfig,i={...i,mainSort:c().S0.yDescending}):(0,r().HB)(e.dataConfig);I(e)&&i&&(void 0===(null===(o=i)||void 0===o?void 0:o.donutDataLabels)||(null===(n=i)||void 0===n?void 0:n.donutDataLabels)===B.none)?i.donutDataLabels=B.value:!I(e)&&i&&(i.donutDataLabels=B.none);const s={...e,type:"donut",dataConfig:a};return i&&(s.chartFormat=i),s}function x(e,t){let o;"groups_reducer"===e.dataConfig.type?o={...e.dataConfig,aggregationConfig:{...e.dataConfig.aggregationConfig,seriesFormat:{displayType:t},stackOptions:void 0}}:"results_reducer"===e.dataConfig.type?o={...e.dataConfig,valueSeriesFormat:{displayType:t}}:(0,r().HB)(e.dataConfig);const n=e.chartFormat;return n&&n.donutDataLabels&&n.donutDataLabels!==B.none?n.axisShowDataLabels=!0:!n||n.donutDataLabels!==B.none&&void 0!==n.donutDataLabels||(n.axisShowDataLabels=!1),{...e,type:t,dataConfig:o}}function k(e,t){let o;if("groups_reducer"===e.dataConfig.type){var n;const r=null==e||null===(n=e.dataConfig)||void 0===n?void 0:n.groupBy;o={...e.dataConfig,groupBy:r,aggregationConfig:{...e.dataConfig.aggregationConfig,seriesFormat:{displayType:t}}}}else"results_reducer"===e.dataConfig.type?o={...e.dataConfig,valueSeriesFormat:{displayType:t}}:(0,r().HB)(e.dataConfig);return{...e,type:t,dataConfig:o}}const P={main:c().S0.xAscending,stacked:c().S0.manual};function D({chartConfig:e,xAxisPropertyId:t,newDataConfigType:o,groupBy:n,aggregation:a,valueProperty:i}){const l="groups_reducer"===e.dataConfig.type?e.dataConfig.aggregationConfig.seriesFormat:e.dataConfig.valueSeriesFormat;"groups_reducer"===o?e.dataConfig={type:"groups_reducer",groupBy:n,aggregationConfig:{aggregation:a,seriesFormat:l,stackOptions:"groups_reducer"===e.dataConfig.type?e.dataConfig.aggregationConfig.stackOptions:void 0}}:"results_reducer"===o?e.dataConfig={type:"results_reducer",nameProperty:t,valueProperty:i,valueSeriesFormat:l}:(0,r().HB)(o);const u="formula"===n.type?n.groupBy.sort:n.sort;return e.chartFormat={...e.chartFormat,mainSort:(0,c().gN)(u)},e}function V({property:e,propertySchema:t,groupByOption:o,hideEmptyGroups:r}){const n=t.type;if((0,l().Eg)(t)){if((0,l()._o)(n)){if(o&&w(o))return{type:n,property:e,groupBy:o,sort:{type:"ascending"}}}else{if((0,l().KI)(n)||"select"===n||"multi_select"===n)return{type:n,property:e,sort:{type:"ascending"}};if((0,l().iF)(n)){if(o&&((a=o)&&l().PC.includes(a)))return{type:n,property:e,groupBy:o,sort:{type:"ascending"}}}else{if("number"===n)return{type:n,property:e,groupBy:{type:"unique"},start:-1,end:-1,size:-1,sort:{type:"ascending"}};if("formula"===n){const r=(0,i().getFormulaPropertySchemaResultType)(t);if("number"===r)return{type:"formula",property:e,groupBy:{type:"number",groupBy:{type:"unique"},start:-1,end:-1,size:-1,sort:{type:"ascending"}}};if("date"===r&&w(o))return{type:"formula",property:e,groupBy:{type:"date",groupBy:o,sort:{type:"ascending"}}}}else if("person"===n)return{type:n,property:e,sort:{type:"manual"}}}}var a;return(0,l().V0)({property:e,propertySchema:t,hideEmptyGroups:r})}}function T(e){const t="formula"===e.type?(0,i().getFormulaPropertySchemaResultType)(e):void 0;return(0,n().A)(e)||"number"===t}function L(e){const t="formula"===e.type?(0,i().getFormulaPropertySchemaResultType)(e):void 0;return(0,l()._o)(e.type)||"date"===t}function q(e){const t="formula"===e.type?(0,i().getFormulaPropertySchemaResultType)(e):void 0;return(0,a().J)(e)||"person"===t}function R(e){if("formula"===e.type){const t=(0,i().getFormulaPropertySchemaResultType)(e);return(0,l()._o)(t)}return(0,l()._o)(e.type)}function G(e){return"text"===e||"number"===e||"person"===e||"date"===e}function M(e){var t;return!(!e||!(0,p().m)(e))&&("groups_reducer"!==e.dataConfig.type||!e.dataConfig.aggregationConfig.stackOptions||"percent"!==(null===(t=e.chartFormat)||void 0===t?void 0:t.axisGroupStyle))}function I(e){return!!M(e)&&(!(!e||!(0,p().m)(e))&&(void 0===(null===(t=e.chartFormat)||void 0===t?void 0:t.axisShowDataLabels)||(null===(o=e.chartFormat)||void 0===o?void 0:o.axisShowDataLabels)));var t,o}},806663:(e,t,o)=>{o.d(t,{Sp:()=>w,sw:()=>b,Iz:()=>F});var r=()=>o(564884),n=()=>o(402014),a=()=>o(295633),i=()=>o(584262),l=()=>o(713998),u=()=>o(384944),c=()=>o(467676),p=()=>o(390650),s=()=>o(681445),g=()=>o(492414),d=()=>o(376049),y=()=>o(246766),f=(o(898992),o(354520),()=>o(901610)),m=()=>o(636081),v=()=>o(214388),C=()=>o(165358),_=()=>o(416504),h=()=>o(498212),S=()=>o(274375);var B=()=>o(154378);function w(e){const{chartConfig:t,collectionViewBlockStore:o,format:a,dataPoint:i,clickEvent:u,schema:c,environment:g,collectionContextStore:d,intl:y,query2:w,temporaryViewState:b}=e;if(!o||"groups_reducer"!==(null==t?void 0:t.dataConfig.type))return;(0,n().SQ)(u,n().y$.Click);const F=function(e){const{dataPoint:t,propertySchema:o,groupByFormat:r,aggregation:n,intl:a}=e,i=t.name??t.x.toString();if(!o)return i;return(0,B().w$)({propertySchema:o,groupByFormat:r,aggregation:n,highChartsLabel:i,intl:a})}({dataPoint:i,propertySchema:(0,l()._g)({schema:c,property:t.dataConfig.groupBy.property}),groupByFormat:null==t?void 0:t.dataConfig.groupBy,aggregation:null==t?void 0:t.dataConfig.aggregationConfig.aggregation,intl:y}),x=function(e){var t,o;const{chartConfig:r,dataPoint:n,format:a,schema:i,collectionViewBlockStore:l,query2:u,temporaryViewState:c}=e;if(!(r&&"placeholder"!==r.type&&"results_reducer"!==r.dataConfig.type&&r.dataConfig.groupBy&&n&&l&&l.pointer.spaceId))return void C().log({level:"error",from:"chartDrilldownHelpers",type:"chartDrilldownMissingRequiredData",error:{name:"chartDrilldownHelpers",message:"Unexpected error"},data:{miscDataToConvertToString:{chartConfig:r,dataPoint:n,collectionViewBlockStore:l}}});const p=r.dataConfig.groupBy.property,s=(0,S().Q)(l,p),g={type:"table",parent_id:l.pointer.id,parent_table:l.pointer.table,alive:!0,space_id:l.pointer.spaceId,format:{is_unlisted:!0,collection_pointer:null==a?void 0:a.collection_pointer,property_filters:(null==c||null===(t=c.propertyFilters)||void 0===t?void 0:t.value)??(null==a?void 0:a.property_filters),table_properties:s},query2:{...u,filter:(null==c||null===(o=c.combinatorFilter)||void 0===o?void 0:o.value)??(null==u?void 0:u.filter)}};let d;var y;return n.groupFormat&&(d=(0,m().K8)({schema:i,propertyMapping:void 0,groupBy:r.dataConfig.groupBy,group:n.groupFormat,timeZone:(0,_().P)()})),d&&((0,v().dU)(d)?null!==(y=g.query2)&&void 0!==y&&y.filter?g.query2.filter=(0,v().GV)([g.query2.filter,d]):g.query2.filter=d:(0,v().yX)(d)&&(g.format.property_filters=[...g.format.property_filters??[],{filter:d,id:(0,h().Ay)()}])),"groups_reducer"===r.dataConfig.type&&(0,f().m)(r)&&r.dataConfig.aggregationConfig.stackOptions&&(g.format.collection_group_by=function(e){var t;if(null===(t=e.aggregationConfig)||void 0===t||!t.stackOptions)return;const o=e.aggregationConfig.stackOptions.groupBy;return o.hideEmptyGroups=!0,o}(r.dataConfig)),g}({chartConfig:t,format:a,dataPoint:i,schema:c,collectionViewBlockStore:o,query2:w,temporaryViewState:b});if(!x)return;const k=(0,p().sl)(d);(0,r().u)({environment:g,event:{eventName:"collection_chart_drilldown_click",eventProperties:{...k,drilldown_type:"grouped",from:"chart_data_point"}}}),s().Q.openCollectionDrilldownView({collectionViewValue:x,collectionViewBlockStore:o,viewsModuleContext:d.viewsModuleContextStore.state,title:F})}function b(e){var t;const{collectionStore:o,dataPoint:l,clickEvent:u,environment:c,collectionContextStore:s}=e;if(null==l||null===(t=l.pagePointer)||void 0===t||!t.id||!o)return;(0,n().SQ)(u,n().y$.Click);const d=a().B.createChildStore(o,l.pagePointer),f=(0,g().Ay)({store:d,fullyQualified:!1,pageVisitSource:i().y8.Expand,showMoveTo:!1,openInCenterPeek:!0});if(!f)return;const m=(0,p().sl)(s);(0,r().u)({environment:c,event:{eventName:"collection_chart_drilldown_click",eventProperties:{...m,drilldown_type:"results",from:"chart_data_point"}}}),(0,y().navigate)({environment:c,url:f})}async function F(e){const{environment:t,collectionViewStore:o,collectionViewBlockStore:n,collectionContextStore:a,acceptMoveToArgs:i,transaction:l,intl:s}=e;if(!o)return;const g=u().Wv({environment:t,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,type:"collection_view",transaction:l}),y=(0,c().t)({environment:t,transaction:l,collectionViewStore:o,collectionViewBlockStore:g,intl:s,copyNameExactly:!0});if(!y)return;if(!y.getFormatStore().getKeyValue("collection_pointer")){var f;const e=null===(f=n.getCollectionPointers())||void 0===f?void 0:f[0];u().zv({store:y.getFormatStore().getKeyStore("collection_pointer"),data:e,transaction:l})}u().zv({store:y.getFormatStore(),data:{is_unlisted:null},transaction:l}),await d().Ai({...i,blocksToMove:[g],transaction:l});const m=(0,p().sl)(a);return(0,r().u)({environment:t,event:{eventName:"collection_chart_drilldown_save",eventProperties:{...m,new_collection_view_block_id:g.pointer.id}}}),g}}}]);