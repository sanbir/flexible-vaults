"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[62516],{235022:(e,t,i)=>{i.d(t,{GW:()=>b,x:()=>f,zf:()=>v});i(898992),i(354520),i(581454);var r=()=>i(907258),o=()=>i(221844),a=()=>i(590526),n=()=>i(295633),d=()=>i(187174),l=()=>i(179034),s=()=>i(445120),c=()=>i(534177),u=()=>i(638681);const v=10;const p=new class{constructor(){this.localStorageStore=new(i(553737).Ay)({namespace:"recentsCache",important:!1,trackingType:"preference"})}waitUntilReady(){return this.localStorageStore.waitUntilReady()}get(e){const t=this.localStorageStore.get(e),i=u().object({required:{id:u().uuid(),version:u().number(),parentId:u().uuid(),parentTable:u().string(),spaceId:u().uuid()},optional:{}});return null==t?void 0:t.filter((e=>!i.validator(e)))}set(e,t){this.localStorageStore.set(e,t)}remove(e){this.localStorageStore.remove(e)}};function g(e){var t,i;const r=e.getVersion(),o=e.getType(),a=e.getParentId(),n=e.getParentTable(),d=e.getLastEditedByPointer(),l=e.getLastEditedTime(),s=e.getSpaceId();if(void 0!==r&&void 0!==o&&void 0!==a&&void 0!==n&&void 0!==s)return{id:e.id,version:r,title:e.getTitleValue(),icon:null===(t=e.getIcon())||void 0===t?void 0:t.icon,cover:null===(i=e.getCover())||void 0===i?void 0:i.cover,coverPosition:e.getFormatStore().getKeyValue("page_cover_position"),parentId:a,parentTable:n,lastEditedByPointer:d,lastEditedTime:l,spaceId:s}}function S(e){var t,i;return{type:"page",id:e.id,last_edited_by_id:null===(t=e.lastEditedByPointer)||void 0===t?void 0:t.id,last_edited_by_table:null===(i=e.lastEditedByPointer)||void 0===i?void 0:i.table,last_edited_time:e.lastEditedTime,properties:{title:e.title},format:{page_icon:e.icon,page_cover:e.cover,page_cover_position:e.coverPosition},version:e.version,alive:!0,parent_id:e.parentId,parent_table:e.parentTable,space_id:e.spaceId}}function f(e){var t;const i=null===(t=r().default.state.sidebarSpaceViewStore)||void 0===t?void 0:t.id;if(!i)return!1;const o=e.filter((e=>e.canRead())).slice(0,v).map(g).filter(c().O9);return p.set(i,o),!0}function b(){const{sidebarSpaceViewStore:e,currentUserStore:t}=(0,a().K8)((()=>({sidebarSpaceViewStore:r().default.state.sidebarSpaceViewStore,currentUserStore:r().default.state.currentUserStore})),[]),[i]=(0,d().Yb)((async()=>{var i;if(await p.waitUntilReady(),!e||r().default.state.sidebarSpaceViewStore!==e)return;const a=null==t?void 0:t.id,d=e.id,c=e.getSpaceId(),u=null===(i=p.get(d))||void 0===i?void 0:i.filter((e=>e.spaceId===c));if(!u)return;const v=new(s().UserRecordMap);for(const e of u){const t=S(e);void 0!==t&&v.setValueAndRole({pointer:{id:e.id,table:l().ev,spaceId:e.spaceId},userId:a},t,"reader")}v.setModelAndRole({pointer:e.pointer,userId:a},e.getModel(),e.getRole()??"none");const g=new(o().A)({name:"recentPagesCache",isTemporaryData:!0,data:v});g.freeze();const f=e.clone(g);return u.map((t=>{const i={id:t.id,table:l().ev,spaceId:t.spaceId};return{cacheStore:n().B.createChildStore(f,i),liveStore:n().B.createChildStore(e,i)}}))}),[e,null==t?void 0:t.id]),c=(u=i.value,(0,a().K8)((()=>null==u?void 0:u.map((({cacheStore:e,liveStore:t})=>t.isDefined()?t:e))),[u]));var u;return"resolved"===i.status?{...i,value:c}:{...i,value:void 0}}},437879:(e,t,i)=>{i.r(t),i.d(t,{RecentsCachingListener:()=>d});i(898992),i(354520),i(581454);var r=i(296540),o=()=>i(968172),a=()=>i(235022);function n(){const e=(0,i(590526).K8)((()=>{var e;const{sidebarSpaceStore:t}=i(907258).default.state;if(o().A.getIsInitialized()&&null!=t&&t.id)return null===(e=o().A.get(t.id))||void 0===e||null===(e=e.slice(0,a().zf))||void 0===e||null===(e=e.map((e=>e.store)))||void 0===e?void 0:e.filter(i(534177).O9)}),[]);return(0,r.useEffect)((()=>{e&&(0,a().x)(e)}),[e]),null}const d=r.memo(n)}}]);