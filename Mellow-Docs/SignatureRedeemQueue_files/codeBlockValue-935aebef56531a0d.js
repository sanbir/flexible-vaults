"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[69734],{97326:(e,t,n)=>{n.r(t),n.d(t,{CodeBlockValueWithDeps:()=>I});n(18107),n(967357),n(581454);var o=n(296540),i=()=>n(135168),a=()=>n(338381),l=()=>n(484714),r=()=>n(590526),s=()=>n(79926),d=()=>n(465628),c=()=>n(15440),u=()=>n(379632),m=()=>n(201980),p=()=>n(924703),g=()=>n(496603),v=()=>n(884107),f=()=>n(109335),b=()=>n(659602),S=()=>n(354584),k=()=>n(335722),h=()=>n(279115),C=()=>n(29554),x=()=>n(141768),y=()=>n(807990),M=()=>n(77246),A=()=>n(295304),T=()=>n(547149),w=n(474848);const D=1e4,E=o.memo((function(e){const{disabled:t,store:a,blockStore:s,markdownLinkifyIt:b,codeWrap:S,wrapStyle:k,tinyMceMicrosoftWordPasteFilter:E,language:I,Prism:P,parentSpaceId:R,isQuickFind:H,style:_,disableSuggestEdit:O,disableFormattingAnnotations:U,disableRichTextActions:j}=e,$=(0,n(69708).tz)(),q=(0,l().v3)(),W=(0,l().Y0)(),L=(0,n(401497).DP)(),K=(0,n(792485).S)(),Y=(0,o.useRef)(null),z=(0,n(493720).R)(),J=W.isSafari||W.isIOS,Q=(0,r().O$)(n(232615).default),Z=(0,r().O$)(n(116008).A),G=(0,r().O$)(n(555776).A),X=(0,r().O$)(h().qu),ee=(0,r().O$)(h().wb),te=(0,r().K8)((()=>null==K?void 0:K.publicEditModeStore.state),[null==K?void 0:K.publicEditModeStore]),ne=(0,r().K8)((()=>K&&K.pageStore?M().Uv.getMode(K.pageStore):"default"),[K]),oe=(0,r().K8)((()=>a.canEdit()),[a]),ie=(0,r().K8)((()=>a.canComment()),[a]),ae=(0,r().K8)((()=>{const e=null==s?void 0:s.getPropertyValue("language");if(void 0!==e)return m().q4_(e)}),[s]),le=(0,o.useMemo)((()=>{var e;return"editing"===Q.mode&&(null===(e=(0,d().H)(Q.multiSelection))||void 0===e?void 0:e.store)===a}),[a,Q]),re=(0,o.useCallback)((()=>{var e;null===(e=Y.current)||void 0===e||null===(e=e.getNode())||void 0===e||e.blur()}),[Y]),se=(0,o.useMemo)((()=>{var e;return Z.open&&"inline"===Z.type&&(null===(e=(0,d().H)(Z.multiSelection))||void 0===e?void 0:e.store)===a}),[Z,a]),de=(0,o.useCallback)((()=>{if((0,n(499764).QT)(te))return!1;const e=null!=K&&K.pageStore?ne:"default";return!(t||"suggest"!==e||!ie)||Boolean(!t&&oe)}),[t,null==K?void 0:K.pageStore,te,ne,oe,ie]),ce=(0,o.useMemo)((()=>!de()),[de]),ue=(0,r().K8)((()=>{if(!G.isHovered||"right_margin_button"!==G.hoverEntryPoint)return!1;const e=y().default.state.isOpen?y().default.state.currentStore:void 0;return a&&(null==e?void 0:e.id)===a.id}),[a,G]),me=(0,o.useMemo)((()=>{const e=(0,n(366437).wc)(ee)&&ee.id===a.id;return{query:X,focusedResult:e?ee:void 0}}),[ee,X,a.id]),pe=(0,o.useCallback)(((e,t)=>{(0,n(267856).D)({type:e,environment:q,blockStore:s,store:a,isInCollectionView:!1,eventTimeStamp:t})}),[q,s,a]),ge=(0,o.useCallback)((t=>{void 0!==s&&void 0!==ae&&e.language!==ae&&n(914577).IA({blocks:[s],language:e.language,transaction:t})}),[s,e.language,ae]),ve=(0,o.useCallback)((e=>{var t,n;if(!de)return;if(pe("typing_enter",e.timeStamp),null===(t=e.preventDefault)||void 0===t||t.call(e),null!==(n=Y.current)&&void 0!==n&&n.isComposing())return;const o="editing"===Q.mode&&(0,d().H)(Q.multiSelection);if(o){const e=null!=K&&K.pageStore?ne:"default";!function(e){const{environment:t,editorMode:n,store:o,selection:i}=e;let a="";const l=m().Ffo(o.getValue(),0,i.startIndex),r=m().q4_(l).split("\n").at(-1),s=null==r?void 0:r.match(/^[ \t]+/);s&&(a=s[0]);T().createAndCommit({userAction:"CodeBlockValue.handleEnter",environment:t,canUndo:!0,perform:e=>{A().$D({environment:t,editorMode:n,store:o,string:`\n${a}`,selection:i,disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:e})}})}({environment:q,store:a,editorMode:e,selection:o.selection})}}),[a,q,pe,K,Y,de,Q,ne]),fe=(0,o.useCallback)((e=>{var t;C().HP({environment:q,event:e,textValue:N({store:a,blockStore:s,inPageFindDetails:me,isNewDiscussionMenuTarget:se,isRightMarginCommentActionHovered:ue}),editorNode:(null===(t=Y.current)||void 0===t?void 0:t.getNode())||void 0,store:a,canEdit:de()})}),[a,q,s,de,me,Y,se,ue]),be=(0,o.useCallback)((e=>{if(de()&&(pe("typing_delete",e.timeStamp),"editing"===Q.mode&&Q.multiSelection.start.store===a)){const t=null!=K&&K.pageStore?ne:"default";T().createAndCommit({userAction:"CodeBlockValue.handleDelete",environment:q,canUndo:!0,perform:n=>{ge(n),f().wT({environment:q,multiSelection:Q.multiSelection,deleteForwards:!0,transaction:n,event:e,editorMode:t})}})}}),[q,a,pe,de,K,Q,ne,ge]),Se=(0,o.useCallback)((e=>{if(de()&&(pe("typing_backspace",e.timeStamp),"editing"===Q.mode&&Q.multiSelection.start.store===a)){if(f().CZ({device:q.device,event:e,multiSelection:Q.multiSelection}))return;const t=null!=K&&K.pageStore?ne:"default";T().createAndCommit({userAction:"CodeBlockValue.handleBackspace",environment:q,canUndo:!0,perform:n=>{ge(n),f().wT({environment:q,multiSelection:Q.multiSelection,deleteForwards:!1,transaction:n,event:e,editorMode:t})}})}}),[q,a,pe,de,K,Q,ne,ge]),ke=(0,o.useCallback)((e=>{var t;if(de()&&(pe("typing_enter",e.timeStamp),null===(t=e.preventDefault)||void 0===t||t.call(e),"editing"===Q.mode)){const e=null!=K&&K.pageStore?ne:"default";T().createAndCommit({userAction:"CodeBlockValue.handleShiftEnter",environment:q,canUndo:!0,perform:t=>{ge(t),n(261374).Ve({environment:q,spaceStore:(0,i().f)(s),editorMode:e,multiSelection:Q.multiSelection,transaction:t})}}),B()}}),[q,s,pe,de,null==K?void 0:K.pageStore,Q,ne,ge]),he=(0,o.useCallback)((e=>{if(!de())return;pe("typing_tab",e.timeStamp),e.preventDefault();const t="editing"===Q.mode&&(0,d().H)(Q.multiSelection);if(t){const e=null!=K&&K.pageStore?ne:"default";T().createAndCommit({userAction:"CodeBlockValue.handleTab",environment:q,canUndo:!0,perform:n=>{ge(n),A().RJ({environment:q,editorMode:e,store:a,selection:t.selection,transaction:n,shouldStripTokens:!0})}})}}),[q,a,pe,de,null==K?void 0:K.pageStore,Q,ne,ge]),Ce=(0,o.useCallback)((e=>{if(!de())return;pe("typing_untab",e.timeStamp),e.preventDefault();const t="editing"===Q.mode&&(0,d().H)(Q.multiSelection);if(t){const e=null!=K&&K.pageStore?ne:"default";T().createAndCommit({userAction:"CodeBlockValue.handleUntab",environment:q,canUndo:!0,perform:n=>{ge(n),A().Ye({environment:q,editorMode:e,store:a,selection:t.selection,transaction:n,shouldStripTokens:!0})}})}}),[q,a,pe,de,K,Q,ne,ge]),xe=(0,o.useCallback)((async e=>{if(!de())return void e.preventDefault();(await v().R.clipboardActions.load()).cutWithMaybeConfirmation({environment:q,event:e,markdownLinkifyIt:b})}),[q,b,de]),ye=(0,o.useCallback)((async e=>{if(!de())return void e.preventDefault();const t=await v().R.clipboardActions.load();T().createAndCommit({userAction:"CodeBlockValue.handlePaste",environment:q,canUndo:!0,perform:o=>{ge(o),(0,n(675925).o)(q,{action:"paste",block_type:null==s?void 0:s.getType(),from:"keyboard_shortcut"},(n=>{t.paste({environment:q,spaceStore:(0,i().f)(s),event:e,disableEmbedMenu:!0,transaction:o,onPasteFiles:t.pasteFilesForBlocks,formulasModule:void 0,markdownLinkifyIt:b,tinyMceMicrosoftWordPasteFilter:E}),n()}))}})}),[q,b,E,de,s,ge]),Me=(0,o.useCallback)((e=>{var t;C().sp({environment:q,event:e,textValue:N({store:a,blockStore:s,inPageFindDetails:me,isNewDiscussionMenuTarget:se,isRightMarginCommentActionHovered:ue}),editorNode:(null===(t=Y.current)||void 0===t?void 0:t.getNode())||void 0,store:a,canEdit:de()})}),[de,q,me,Y,a,s,se,ue]),Ae=(0,o.useCallback)((e=>{var t;C().W5({environment:q,event:e,textValue:N({store:a,blockStore:s,inPageFindDetails:me,isNewDiscussionMenuTarget:se,isRightMarginCommentActionHovered:ue}),editorNode:(null===(t=Y.current)||void 0===t?void 0:t.getNode())||void 0,store:a,canEdit:de()})}),[me,a,s,se,ue,Y,de,q]),Te=(0,o.useCallback)((()=>{if(le)return(0,n(66372).D)(a)}),[le,a]),we=(0,o.useCallback)((()=>{const e=n(634201).PE(m().q4_(N({store:a,blockStore:s,inPageFindDetails:me,isNewDiscussionMenuTarget:se,isRightMarginCommentActionHovered:ue})));return{startIndex:e.length,endIndex:e.length}}),[a,s,me,se,ue]),De=(0,o.useRef)(),Ee=(0,o.useCallback)((()=>{const e=N({store:a,blockStore:s,inPageFindDetails:me,isNewDiscussionMenuTarget:se,isRightMarginCommentActionHovered:ue}),t=m().q4_(e),i=(0,c().Ys)(I).prismAlias;i!==c().Yj.HTML.prismAlias&&i!==c().Yj.Markup.prismAlias||(P.languages.markup.tag.addInlined("style","css"),P.languages.markup.tag.addInlined("script","javascript"));const l=t.length>=D,r=De.current;if(De.current=t.length,t&&i!==c().Sc&&!l){const n=P.languages[i],l=document.createElement("div"),r=P.highlight(t,n,i);l.innerHTML=x().bi(r);const s=Array.from(l.childNodes).map(V),d=function({syntaxTokens:e,textValue:t,parentSpaceId:n,store:o,theme:i,isSafariOrIOS:a}){const l=(0,p().E7)(t&&{value:t,spaceId:n},o.getRecordModel),r=x().YH(l,e),s=l.map(m().uPN).map((e=>(0,p().sT)({annotations:e,theme:i,spaceId:n,getRecordModel:o.getRecordModel,isSafariOrIOS:a})));return r.map(((e,t)=>(0,w.jsx)("span",{className:[e.classNames||"",...s[e.textTokenIndex].classNames].join(" "),style:s[e.textTokenIndex].style,"data-token-index":e.textTokenIndex,children:e.value},t)))}({parentSpaceId:R,store:a,syntaxTokens:g().oE(s),textValue:e,theme:L,isSafariOrIOS:J}),c=(0,w.jsxs)(o.Fragment,{children:[d,(0,w.jsx)("span",{children:"\n"})]});return u().A.renderToStaticMarkup(c)}l&&"number"==typeof r&&r<D&&function(e){const{intl:t}=e,o=new Intl.NumberFormat(t.locale),i=o.format(D);n(812182).HK({presentationType:"transient",title:t.formatMessage({id:"codeBlock.maxChars.toast.title",defaultMessage:"Code highlighting disabled"}),message:t.formatMessage({id:"codeBlock.maxChars.toast.message",defaultMessage:"Syntax highlighting is not supported for more than {numBlocks} characters"},{numBlocks:i})})}({intl:$});const d=C().S5({environment:q,textValue:e&&{value:e,spaceId:R},parentStore:a,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!0,disableSuggestionAnnotations:!1,disabled:!de(),theme:L,emojiType:"raw",katex:void 0,formulaValueTypes:[]});return u().A.renderToStaticMarkup((0,w.jsx)(w.Fragment,{children:d}))}),[me,a,s,se,ue,q,de,R,P,I,L,$,J]),Ie=(0,o.useCallback)((()=>{T().createAndCommit({userAction:"CodeBlockValue.handleMoveUp",environment:q,canUndo:!0,perform:e=>{A().$P({environment:q,transaction:e,direction:"up"})}})}),[q]),Be=(0,o.useCallback)((()=>{T().createAndCommit({userAction:"CodeBlockValue.handleMoveDown",environment:q,canUndo:!0,perform:e=>{A().$P({environment:q,transaction:e,direction:"down"})}})}),[q]),Ve=(0,o.useCallback)(((e,t)=>{de()&&(t.preventDefault(),n(261156).po({environment:q,annotation:e}),B())}),[de,q]),Fe=(0,o.useCallback)((e=>{const{newValue:t}=e;pe("typing_lag",e.timeStamp);const n=null!=K&&K.pageStore?M().Uv.getMode(null==K?void 0:K.pageStore):"default";T().createAndCommit({userAction:"CodeBlockValue.handleMutation",environment:q,canUndo:!0,perform:e=>{ge(e),A().dw({environment:q,editorMode:n,store:a,newValue:t,disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableFilters:!0,transaction:e})}})}),[pe,q,a,null==K?void 0:K.pageStore,ge]),Ne=(0,o.useCallback)((async e=>{(await v().R.clipboardActions.load()).copy({environment:q,event:e,markdownLinkifyIt:b})}),[q,b]),Pe=(0,o.useCallback)((({leafRef:e,wrapperRef:t,...o},i,l)=>(0,w.jsx)("div",{ref:t,style:{display:"flex",padding:"12px 0px",...!S&&{overflowX:"auto",WebkitOverflowScrolling:"touch"},...k},className:"line-numbers notion-code-block",...o,children:(0,w.jsx)(n(477450).A,{leafRef:z(Y,e),style:{...F(L,_),...H&&{paddingTop:12},...S?{whiteSpace:"break-spaces",wordBreak:"break-all",minWidth:0}:{whiteSpace:"pre"}},debugName:"CodeBlockValue",store:a,isDisabled:ce,getHtml:Ee,getSelection:Te,onMutation:e=>Fe(e),spellCheck:!1,autoCorrect:"off",autoCapitalize:"off",onSelect:i,onMouseOver:Me,onMouseOut:Ae,suppressNewlineEvents:!1,placeholder:" ",disableContentEditableWhenNotEditingTextOnMobile:!0,expandSelectionOnTripleClick:!1})})),[H,S,k,L,_,ce,Ee,Te,Fe,Me,Ae,z,Y,a]);return(0,w.jsx)(n(548161).F,{store:a,disabled:t,clearBrowserSelection:re,onBlur:re,getEndSelection:we,onClick:fe,onDelete:be,onBackspace:Se,onEnter:ve,onShiftEnter:ke,onCommandEnter:g().D_,onCommandShiftEnter:g().D_,onTab:he,onUntab:Ce,onToggleHighlight:e=>Ve(["h",n(77272).A.getMostRecentlyUsedColor()],e),onToggleBold:e=>Ve(["b"],e),onToggleItalics:e=>Ve(["i"],e),onToggleUnderline:e=>Ve(["_"],e),onToggleStrike:e=>Ve(["s"],e),onToggleCode:g().D_,onCopy:e=>Ne(e),onCut:xe,onPaste:ye,onMoveUp:Ie,onMoveDown:Be,render:Pe,disableMentions:!0,disableSlashCommands:!0,canSelectAllBlocks:!0,canInsertText:!0,canSelectionDrag:!0,topBottomPadding:22,pasteBehavior:"inline",disableSuggestEdit:O,disableFormattingAnnotations:U,disableRichTextActions:j})}));function I(e){const{value:t}=(0,s().fJ)(S().y),{value:n}=(0,s().fJ)(b().g),{value:o}=(0,s().fJ)(k().S);return t?(0,w.jsx)(E,{...e,Prism:t,markdownLinkifyIt:n,tinyMceMicrosoftWordPasteFilter:o}):null}function B(){n(908006).default.flush()}function V(e){return a().KH(e)?[e.data]:a().vq(e)?[e.textContent||"",e.className]:void 0}function F(e,t){return{flexGrow:1,flexShrink:1,textAlign:"start",fontFamily:n(284371).vc(n(609679).locale).githubMono,fontSize:"85%",tabSize:2,minHeight:"1em",color:e.text.primary,...t}}function N(e){const{store:t,blockStore:n,inPageFindDetails:o,isNewDiscussionMenuTarget:i,isRightMarginCommentActionHovered:a}=e;let l=t.getValue();if(o.query&&(l=C().nu({textValue:l,blockId:null==n?void 0:n.id,find:o.query,textProps:{type:"block_match"},currentFocusedResult:o.focusedResult,store:n})),a){const e=m().qAZ(l);return C().PB({store:t,temporaryAnnotation:m().Ifu.TemporarySelection,multiSelection:{start:{store:t,index:0},end:{store:t,index:e.length}}})}return i?C().Fm({store:t}):l}},141768:(e,t,n)=>{n.d(t,{YH:()=>s,bi:()=>l});n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(803949),n(581454),n(908872);var o=()=>n(338381),i=()=>n(201980),a=()=>n(496603);function l(e){let t="";const n=document.createElement("div");n.innerHTML=e;const i=o().zn(n);for(const o of i){const e=a().ih(o.data);if(null!==o.parentElement&&o.parentElement!==n){t+=`<span class="${r({parent:o.parentElement,root:n}).join(" ")}">${e}</span>`}else t+=e}return t}function r(e){const{parent:t,root:n}=e,o=new Set;let i=t;for(;i&&i!==n;)i.classList.forEach((e=>{o.add(e)})),i=i.parentElement??void 0;return Array.from(o)}function s(e,t){const n={text:d(e),syntax:d(t)},o=function(e){let t=0;return e.reduce(((e,n)=>(e.push([t,n]),t+=n,e)),[])}(function(e,t){const n=e.slice(),o=t.slice(),i=[];let a=0,l=0;for(;a<n.length&&l<o.length;){const e=n[a],t=o[l];e===t?(i.push(e),a+=1,l+=1):e<t?(i.push(e),a+=1,o[l]-=e):(i.push(t),n[a]-=t,l+=1)}return i}(n.text,n.syntax)),a={text:0,syntax:0},l={text:0,syntax:0},r=[],s=e.map(i().N8A).join("");for(const[i,d]of o){const e=i+d,o=t[a.syntax],u={value:s.substring(i,e),textTokenIndex:a.text,classNames:(c=o,c&&c[1])};r.push(u);const m=n.text[a.text],p=n.syntax[a.syntax];e>=l.text+m&&(a.text+=1,l.text+=m),e>=l.syntax+p&&(a.syntax+=1,l.syntax+=p)}var c;return r}function d(e){return e.map((e=>e[0].length))}}}]);