"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[87249],{24153:(e,r,t)=>{t.d(r,{A2:()=>v,NL:()=>k,UT:()=>C,YK:()=>b,ZI:()=>h,ph:()=>p,y1:()=>l});t(16280),t(814603),t(147566),t(198721);var n=()=>t(534177),s=()=>t(761865),o=()=>t(499919);const i="slackChannel",a="slackMessage",c="slackUser",l=[a,i,c];function d(e){return(0,o().$q)({id:e,prefix:c})}function u(e){return e.handle?`${e.workspaceHost}/${e.userId}/${e.handle}`:`${e.workspaceHost}/${e.userId}`}function p(e){return(0,n().zR)(e,c)}function I(e){return(0,o().$q)({id:e,prefix:a})}function f(e){return`${e.workspaceHost}/${e.channelId}/${E(e.messageTs)}/${E(e.threadTs)}`}function h(e){return(0,n().zR)(e,a)}function g(e){return(0,o().$q)({id:e,prefix:i})}function w(e){return`${e.workspaceHost}/${e.channelId}`}function U(e){return(0,n().zR)(e,i)}const v={slackUser:{type:"slackUser",getUri:e=>{const r=S(e.workspaceHost),t=R({userId:e.userId,workspaceHost:r});if(t)return t;return d(u({userId:e.userId,workspaceHost:r,handle:e.handle}))},getUrl:e=>function(e){const{userId:r,workspaceHost:t}=e,n=R({userId:r,workspaceHost:t});return n||new URL(`/team/${r}`,`https://${t}`).toString()}(e),parseUri:e=>{if(L(e)){var r,t;const n=null===(r=(t=v.slackUser).parseUrlToUri)||void 0===r?void 0:r.call(t,e,{baseUrl:"",publicDomainName:""});return"string"==typeof n?v.slackUser.parseUri(n):new(s().Yv)("Invalid Slack user URI (URL): {uri}",{variables:{uri:e},cause:n})}if(!p(e))return new(s().Yv)("Invalid Slack user URI: {uri}",{variables:{uri:e}});var n;const i=function(e){const r=e.split("/");if(2===r.length||3===r.length){const[e,t,n]=r;return R({userId:t,workspaceHost:e})||{userId:t,workspaceHost:e,handle:n}}return new Error(`Invalid user ID: ${e}`)}((n=e,(0,o().AF)({prefix:c,id:n,originModule:"slack"})));return i instanceof Error?new(s().Yv)("Invalid Slack user URI: {uri}",{variables:{uri:e},cause:i}):{type:"slackUser",userId:i.userId,workspaceHost:i.workspaceHost,handle:i.handle}},parseUrlToUri:e=>{if(p(e.toString()))return e.toString();const r=function(e,r){let t;try{t=new URL(e)}catch(c){return new Error(`Error in parseSlackUserUrlToUri: Invalid Slack user URL: ${e}. Expected format: https://workspace.slack.com/team/U0123456789`,{cause:c})}const{host:n,pathname:s}=t,o=s.match(/^\/team\/(?<userId>U[\w-]+)$/);if(null===o)return new Error(`Error in parseSlackUserUrlToUri: Invalid Slack user URL: ${e}. Expected format: https://workspace.slack.com/team/U0123456789`);const{userId:i}=o.groups??{},a=u({userId:i,workspaceHost:n});return r?d(a):a}(e.toString(),!0);return r instanceof Error?new(s().Yv)("Invalid Slack user URL: {url}",{variables:{url:e},cause:r}):r}},slackMessage:{type:"slackMessage",getUri:e=>{const r=S(e.workspaceHost),t=R({channelId:e.channelId,messageTs:e.messageTs,threadTs:e.threadTs,workspaceHost:r});if(t)return t;return I(f({channelId:e.channelId,messageTs:e.messageTs,threadTs:e.threadTs,workspaceHost:r}))},getUrl:e=>function(e){const{workspaceHost:r,channelId:t,messageTs:n,threadTs:s}=e,o=R({channelId:t,messageTs:n,threadTs:s,workspaceHost:r});if(o)return o;const i=T(r),a=new URL(`/archives/${t}/p${c=n,c.replace(".","")}`,i);var c;return s&&s!==n&&(a.searchParams.set("cid",t),a.searchParams.set("thread_ts",E(s))),a.toString()}(e),parseUri:e=>{if(L(e)){var r,t;const n=null===(r=(t=v.slackMessage).parseUrlToUri)||void 0===r?void 0:r.call(t,e,{baseUrl:"",publicDomainName:""});return"string"==typeof n?v.slackMessage.parseUri(n):new(s().Yv)("Invalid Slack message URI (URL): {uri}",{variables:{uri:e},cause:n})}if(!h(e))return new(s().Yv)("Invalid Slack message URI: {uri}",{variables:{uri:e}});var n;const i=function(e){const r=e.split("/");if(4===r.length){const[e,t]=r;let[,,n,s]=r;n=E(n),s=E(s);return R({channelId:t,messageTs:n,threadTs:s,workspaceHost:e})||{channelId:t,messageTs:n,threadTs:s,workspaceHost:e}}return new Error(`Invalid message ID: ${e}`)}((n=e,(0,o().AF)({id:n,originModule:"slack",prefix:a})));return i instanceof Error?new(s().Yv)("Invalid Slack message URI: {uri}",{variables:{uri:e},cause:i}):{type:"slackMessage",channelId:i.channelId,messageTs:i.messageTs,threadTs:i.threadTs,workspaceHost:i.workspaceHost}},parseUrlToUri:e=>{if(h(e.toString()))return e.toString();const r=function(e,r){let t;try{t=new URL(e)}catch(u){return new Error(`Error in parseSlackMessageUrlToId: Invalid Slack message URL: ${e}. Expected format: https://workspace.slack.com/archives/C0123ABCDEF/p9876543210987654 or https://workspace.slack.com/archives/C0123ABCDEF/p9876543210987654?thread_ts=12345`,{cause:u})}const{host:n,pathname:s,searchParams:o}=t,i=s.match(/^\/archives\/(?<channelId>[\w-]+)\/p(?<messageTimestamp>[\d]+)$/);if(null===i)return new Error(`Error in parseSlackMessageUrlToId: Invalid Slack message URL: ${e}. Expected format: https://workspace.slack.com/archives/C0123ABCDEF/p9876543210987654 or https://workspace.slack.com/archives/C0123ABCDEF/p9876543210987654?thread_ts=12345`);const{channelId:a,messageTimestamp:c}=i.groups??{},l=o.get("thread_ts")??void 0,d=f({channelId:a,threadTs:l||c,messageTs:c,workspaceHost:n});return r?I(d):d}(e.toString(),!0);return r instanceof Error?new(s().Yv)("Invalid Slack message URL: {url}",{variables:{url:e},cause:r}):r}},slackChannel:{type:"slackChannel",getUri:e=>{const r=S(e.workspaceHost),t=R({channelId:e.channelId,workspaceHost:r});if(t)return t;return g(w({channelId:e.channelId,workspaceHost:r}))},getUrl:e=>function(e){const{channelId:r,workspaceHost:t}=e,n=R({channelId:r,workspaceHost:t});if(n)return n;const s=T(t);return new URL(`/archives/${r}`,s).toString()}({channelId:e.channelId,workspaceHost:e.workspaceHost}),parseUri:e=>{if(L(e)){var r,t;const n=null===(r=(t=v.slackChannel).parseUrlToUri)||void 0===r?void 0:r.call(t,e,{baseUrl:"",publicDomainName:""});return"string"==typeof n?v.slackChannel.parseUri(n):new(s().Yv)("Invalid Slack channel URI (URL): {uri}",{variables:{uri:e},cause:n})}if(!U(e))return new(s().Yv)("Invalid Slack channel URI: {uri}",{variables:{uri:e}});const n=(a=e,(0,o().AF)({prefix:i,id:a,originModule:"slack"}));var a;if(!n.includes("/"))return new(s().Yv)("Invalid Slack channel URI: {uri}. Legacy format without workspaceHost is not supported. Expected format: slackChannel://workspaceHost/channelId",{variables:{uri:e}});const c=function(e){const r=e.split("/");if(2===r.length){const[e,t]=r;return R({channelId:t,workspaceHost:e})||{channelId:t,workspaceHost:e}}return new Error(`Invalid channel URI: ${e}`)}(n);return c instanceof Error?new(s().Yv)("Invalid Slack channel URI: {uri}",{variables:{uri:e},cause:c}):{type:"slackChannel",channelId:c.channelId,workspaceHost:c.workspaceHost}},parseUrlToUri:e=>{if(U(e.toString()))return e.toString();const r=function(e,r){let t;try{t=new URL(e)}catch(c){return new Error(`Error in parseSlackChannelUrlToUri: Invalid Slack channel URL: ${e}. Expected format: https://workspace.slack.com/archives/C0123456789`,{cause:c})}const{host:n,pathname:s}=t,o=s.match(/^(\/)?\/archives\/(?<channelId>[\w-]+)(\/|(?:\/p[\d]+))?$/);if(null===o)return new Error(`Error in parseSlackChannelUrlToUri: Invalid Slack channel URL: ${e}. Expected format: https://workspace.slack.com/archives/C0123456789`);const{channelId:i}=o.groups??{},a=w({channelId:i,workspaceHost:n});return r?g(a):a}(e.toString(),!0);return r instanceof Error?new(s().Yv)("Invalid Slack channel URL: {url}",{variables:{url:e},cause:r}):r}}};function k(e){return/^C[A-Z0-9]+$/.test(e)}function m(e){return/^D[A-Z0-9]+$/.test(e)}function $(e){return/^G[A-Z0-9]+$/.test(e)}function y(e){return/^[0-9]{10}\.[0-9]+$/.test(e)}function b(e){return"*"===e||"public:*"===e||"users:*"===e}function R(e){const{channelId:r,messageTs:t,threadTs:s,userId:o,workspaceHost:i}=e;if(i){if(!L((0,n().zR)(i,"https://")?i:`https://${i}`))return new Error(`Invalid workspace URL: ${i}`)}return!r||k(r)||m(r)||$(r)?t&&!y(t)?new Error(`Invalid message timestamp: ${t}`):s&&!y(s)?new Error(`Invalid thread timestamp: ${s}`):o&&!function(e){return/^U[\w]+$/.test(e)}(o)?new Error(`Invalid user ID: ${o}`):void 0:new Error(`Invalid channel ID: ${r}`)}function L(e){try{const r=new URL(e);return"https:"===r.protocol&&r.hostname.toLowerCase().endsWith("slack.com")}catch{return!1}}function E(e){return e.includes(".")||e.length<16?e:`${e.slice(0,10)}.${e.slice(10)}`}function T(e){let r=e;return(0,n().zR)(e,"https://")||(r=`https://${e}`),r}function S(e){const r=T(e);return new URL(r).host}function C(e,r){if(U(e))return e;if(L(e)){var t,n;const r=null===(t=(n=v.slackChannel).parseUrlToUri)||void 0===t?void 0:t.call(n,e,{baseUrl:"",publicDomainName:""});if("string"==typeof r)return r}if(r&&(k(e)||m(e)||$(e))){const t=v.slackChannel.getUri({channelId:e,workspaceHost:r});if("string"==typeof t)return t}return e}},349470:(e,r,t)=>{t.d(r,{QB:()=>a,Wh:()=>c,od:()=>i});t(581454);var n=()=>t(24153);const s=["snapshot","notification","pageOrCollectionViewBlock","view","collection","discussion","collectionProperty","formulaResult","formulaCode","collectionPropertyOption","pageDiscussions","discussion","integration","trigger","script","user","agent","worker","thread","citation"],o="file",i=[...s,o,...n().y1];function a(){return[...s.map((e=>`${e}://[\\w\\-\\_\\/]+`)),...n().y1.map((e=>`${e}://[\\w\\/\\-\\.]+[\\w]`)),`${o}:\\/\\/%7B[^}]+%7D`]}function c(e){for(const r of i)if(e===r)return!0;return!1}},499919:(e,r,t)=>{t.d(r,{$q:()=>i,AF:()=>a});var n=()=>t(761865);const s="://",o="-";function i(e){if(e.prefix.includes(s))throw new(n().xL)('Prefix {prefix} cannot include a "{separator}"',{variables:{prefix:e.prefix,separator:s}});const r=`${e.prefix}${s}`;return e.id.startsWith(r)?e.id:`${r}${e.id}`}function a(e){const{prefix:r,id:t,originModule:i}=e,a=`${r}${o}`;if(t.startsWith(a))return t.slice(a.length);const c=`${r}${s}`;if(!t.startsWith(c)){const e=t.split(s)[0],o=t.includes(s)?` Instead it appears to be a ${e} id.`:` It appears to be malformed and without the ${r} prefix.`,a=i?` Ensure that the id comes from the ${i} module.`:"";throw new(n().Yv)("Id {id} is not a {prefix} id.{appearsToBeMessage}{moduleMessage}",{variables:{id:t,prefix:r,appearsToBeMessage:o,moduleMessage:a}})}return t.slice(c.length)}},687249:(e,r,t)=>{t.d(r,{nm:()=>b,Xh:()=>N,GP:()=>q,F:()=>H,Ts:()=>D,$e:()=>W,ne:()=>E,CM:()=>L,w8:()=>Y,Q2:()=>R,dw:()=>V,dE:()=>x,TE:()=>j,Mg:()=>A,OR:()=>B,cy:()=>M,X1:()=>P});t(16280),t(898992),t(354520),t(581454),t(964979),t(814603),t(147566),t(198721);var n=()=>t(498212),s=()=>t(534177),o=()=>t(939768),i=()=>t(997769),a=()=>t(651784),c=()=>t(179034),l=()=>t(519831),d=()=>t(197959),u=()=>t(234459),p=()=>t(798880),I=()=>t(743246),f=()=>t(978234),h=()=>t(201980),g=()=>t(563452),w=()=>t(761865),U=()=>t(499919);function v(e){const r=e.startsWith("user://")?e.slice(7):e,t=r.lastIndexOf("/");if(-1!==t){const e=r.slice(t+1);if(e.includes("@"))return{userIdPart:r.slice(0,t),email:e}}return{userIdPart:r,email:void 0}}var k=()=>t(349470);function m(e){if(e)return(0,n().uj)(e)?e:(0,n().c_)(e)?(0,n().np)(e):void 0}function $(e){const r=m(e);if(!r)throw new(w().Yv)("Invalid UUID: {id}",{variables:{id:e}});return r}function y(e,r){let t=e.toString();if("notion.so"===e.hostname){const e=new URL(t);e.hostname="www.notion.so",t=e.toString()}const[n]=(0,a().Jq)({url:t,isMobile:!1,baseUrl:r.baseUrl,publicDomainName:r.publicDomainName,protocol:void 0,currentUrl:void 0});return n}const b={pageOrCollectionViewBlock:{type:"pageOrCollectionViewBlock",parseUri:e=>{if(!e.startsWith("page"))return Error(`Invalid page or collection view block URL, must start with "page": ${e}`);const r=e.split("://")[1].split("/"),t=m(r[0]),n=r[1];return t?{type:"pageOrCollectionViewBlock",id:t,blockId:n}:Error(`Invalid page or collection view block URL: ${e}`)},getUri:({id:e,blockId:r,baseUrl:t})=>R({baseUrl:t,pageId:e,blockId:r}),parseUrlToUri:(e,r)=>{try{const{pageOrBlockId:t,blockId:n}=B(e.toString(),r);if(t)return`pageOrCollectionViewBlock://${t}${n?`/${n}`:""}`}catch(t){return new(w().Yv)("Invalid page or collection view block URL: {url}",{variables:{url:e},cause:t})}return new(w().Yv)("Invalid page or collection view block URL: {url}",{variables:{url:e}})}},collection:{type:"collection",parseUri:e=>{const r=m(e.split("collection://")[1]);return r?{type:"collection",collectionId:r}:Error(`Invalid collection URL: {{${e}}}`)},getUri:({collectionId:e})=>L(e),parseUrlToUri:(e,r)=>{const t=y("string"==typeof e?new URL(e):e,r);return"collection"!==t.name?new(w().Yv)("Invalid collection URL: {url}",{variables:{url:e}}):L(t.collectionId)}},collectionProperty:{type:"collectionProperty",parseUri:e=>{const r=e.split("collectionProperty://")[1].split("/"),t=m(r[0]),n=S(r[1]);return t&&n?{type:"collectionProperty",collectionId:t,propertyId:n}:Error(`Invalid collection property URL: ${e}`)},getUri:({collectionId:e,propertyId:r})=>E(e,r)},formulaResult:{type:"formulaResult",parseUri:e=>{const r=e.split("formulaResult://")[1].split("/"),t=m(r[0]),n=m(r[1]),s=S(r[2]);return t&&n&&s?{type:"formulaResult",collectionId:t,pageId:n,propertyId:s}:Error(`Invalid formula result URL: ${e}`)},getUri:({collectionId:e,pageId:r,propertyId:t})=>function(e){const{collectionId:r,pageId:t,propertyId:n}=e,s=T(n);return`formulaResult://${r}/${t}/${s}`}({collectionId:e,pageId:r,propertyId:t})},formulaCode:{type:"formulaCode",parseUri:e=>{const r=e.split("formulaCode://")[1].split("/"),t=m(r[0]),n=S(r[1]);return t&&n?{type:"formulaCode",collectionId:t,propertyId:n}:Error(`Invalid formula code URL: ${e}`)},getUri:({collectionId:e,propertyId:r})=>function(e){const{collectionId:r,propertyId:t}=e,n=T(t);return`formulaCode://${r}/${n}`}({collectionId:e,propertyId:r})},collectionPropertyOption:{type:"collectionPropertyOption",parseUri:e=>{const r=e.split("collectionPropertyOption://")[1].split("/"),t=m(r[0]),n=S(r[1]),s=S(r[2]);return t&&n&&s?{type:"collectionPropertyOption",collectionId:t,propertyId:n,optionId:s}:Error(`Invalid collection property option URL: ${e}`)},getUri:({collectionId:e,propertyId:r,optionId:t})=>function(e,r,t){const n=T(r),s=T(t);return`collectionPropertyOption://${e}/${n}/${s}`}(e,r,t)},discussion:{type:"discussion",parseUri:e=>{const r=e.split("discussion://")[1].split("/");if(1===r.length){const t=m(r[0]);return t?{type:"discussion",discussionId:t}:Error(`Invalid discussion URL: ${e}`)}if(2===r.length){const[t,n]=r.map(m);return t&&n?{type:"discussion",pageId:t,discussionId:n}:Error(`Invalid discussion URL: ${e}`)}if(3===r.length){const[t,n,s]=r.map(m);return t&&n&&s?{type:"discussion",pageId:$(t),blockId:$(n),discussionId:$(s)}:Error(`Invalid discussion URL: ${e}`)}return Error(`Invalid discussion URL: ${e}`)},getUri:({discussionId:e,pageId:r,blockId:t})=>function(e){const{discussionId:r,pageId:t,blockId:n}=e;if(t&&n)return`discussion://${t}/${n}/${r}`;if(t)return`discussion://${t}/${r}`;return`discussion://${r}`}({discussionId:e,pageId:r,blockId:t}),getUrl:({discussionId:e,pageId:r,blockId:n,baseUrl:s})=>(0,t(921940).A)({discussionId:e,pageId:r,scrollToBlockId:n!==r?n:void 0,baseUrl:s,pageVisitSource:t(584262).y8.AIChat})},pageDiscussions:{type:"pageDiscussions",parseUri:e=>{const r=e.split("pageDiscussions://")[1];return r?{type:"pageDiscussions",pageId:$(r)}:Error(`Invalid page discussions URL: ${e}`)},getUri:({pageId:e})=>function(e){return`pageDiscussions://${e}`}(e)},integration:{type:"integration",parseUri:e=>{const r=e.split("integration://")[1].split("/");if(3===r.length){const[t,n,s]=r;if(!(t&&n&&(0,g().Hf)(n)&&s))throw new(w().Yv)("Invalid integration URL: {{{uri}}}",{variables:{uri:e}});return{type:"integration",moduleType:n,spaceId:$(t),moduleRecordId:$(s)}}if(4===r.length){const[t,n,s,o]=r;if(!(t&&n&&s&&(0,g().Hf)(s)&&o))throw new(w().Yv)("Invalid integration URL: {{{uri}}}",{variables:{uri:e}});return{type:"integration",workflowId:$(n),moduleId:o&&"undefined"!==o?$(o):void 0,moduleType:s,spaceId:$(t)}}throw new(w().Yv)("Invalid integration URL: {{{uri}}}",{variables:{uri:e}})},getUri:function(e){if("workflowId"in e){const{workflowId:r,moduleId:t,moduleType:n,spaceId:s}=e;return`integration://${s}/${r}/${n}/${t}`}{const{moduleType:r,spaceId:t,moduleRecordId:n}=e;return`integration://${t}/${r}/${n}`}}},view:{type:"view",parseUri:e=>{const r=e.split("view://")[1].split("/")[0];return r?{type:"view",collectionViewId:r}:Error(`Invalid view URL: ${e}`)},getUri:({collectionViewId:e})=>C(e),parseUrlToUri:(e,r)=>{const t=y("string"==typeof e?new URL(e):e,r);return"page"===t.name&&t.collectionViewId?C(t.collectionViewId):new(w().Yv)("Invalid view URL: {url}",{variables:{url:e}})}},trigger:{type:"trigger",parseUri:e=>{const r=e.split("trigger://")[1].split("/"),t=r[0],n=r[1],s=r[2];return t&&n&&s?{type:"trigger",workflowId:$(n),spaceId:$(t),triggerId:s}:Error(`Invalid trigger URL: ${e}`)},getUri:function(e){const{workflowId:r,spaceId:t,triggerId:n}=e;return`trigger://${t}/${r}/${n}`}},script:{type:"script",parseUri:e=>{const r=e.split("script://")[1].split("/"),t=r[0],n=r[1],s=r[2];return t&&n&&s?{type:"script",workflowId:$(n),spaceId:$(t),scriptId:s}:Error(`Invalid script URL: ${e}`)},getUri:function(e){const{workflowId:r,spaceId:t,scriptId:n}=e;return`script://${t}/${r}/${n}`}},agent:{type:"agent",parseUri:e=>{const r=e.split("agent://")[1].split("/"),t=r[0],n=r[1];return t&&n?{type:"agent",spaceId:$(t),workflowId:$(n)}:Error(`Invalid agent URL: ${e}`)},getUri:({workflowId:e,spaceId:r})=>H({workflowId:e,spaceId:r})},worker:{type:"worker",parseUri:e=>{const r=e.split("worker://")[1].split("/"),t=r[0],n=r[1];return t&&n?{type:"worker",spaceId:$(t),workerId:n}:Error(`Invalid worker URL: ${e}`)},getUri:({spaceId:e,workerId:r})=>function(e){const{spaceId:r,workerId:t}=e;return`worker://${r}/${t}`}({spaceId:e,workerId:r})},thread:{type:"thread",parseUri:e=>{const r=e.split("thread://")[1];if(!r)return Error(`Invalid thread URL: ${e}`);const t=r.split("/"),n=t[0],s=t[1];return n&&s?{type:"thread",spaceId:$(n),threadId:$(s)}:Error(`Invalid thread URL: ${e}`)},getUri:({threadId:e,spaceId:r})=>function(e){const{threadId:r,spaceId:t}=e;return`thread://${t}/${r}`}({threadId:e,spaceId:r})},user:{type:"user",parseUri:e=>{try{const{email:r}=v(e);return{type:"user",userId:function(e,{isMocked:r=!1}={}){const{userIdPart:t}=v(e),s=t;if((0,n().uj)(s)&&!r)return s;try{const e=(0,U().AF)({prefix:"notion_user",id:t});if((0,n().uj)(e))return e}catch(i){}const o=(0,U().AF)({prefix:"user",id:t});if((0,n().uj)(o))return o;if(r)return t;throw new(w().Yv)('{userIdString} is not a valid user ID. While the ID is correctly prefixed with "user://", the rest of the ID is NOT a valid UUID.',{variables:{userIdString:e}})}(e),email:r}}catch(r){if(r instanceof Error)return r;throw r}},getUri:x},file:{type:"file",parseUri:e=>{const r=e.split("file://")[1];if(!r)return Error(`Invalid file URL: ${e}`);const{source:t,permissionRecord:n}=JSON.parse(decodeURIComponent(r));return{type:"file",source:t,permissionRecord:n}},getUri:Y},citation:{type:"citation",parseUri:e=>{const r=e.split("citation://")[1];if(!r)return Error(`Invalid citation URL: ${e}`);const{recordType:t,url:n,spaceId:s,id:o}=JSON.parse(decodeURIComponent(r));return{type:"citation",recordType:t,url:n,spaceId:s,id:o}},getUri:D},snapshot:{type:"snapshot",parseUri:e=>{var r;const t=null===(r=e.split("snapshot://")[1])||void 0===r?void 0:r.split("/");if(!t||2!==t.length)return Error(`Invalid snapshot URL: ${e}`);const[n,s]=t;return n&&s?{type:"snapshot",pageOrDatabaseId:$(n),timestamp:s}:Error(`Invalid snapshot URL: ${e}`)},parseUrlToUri:(e,r)=>{const t=y("string"==typeof e?new URL(e):e,r);return"page"===t.name&&t.blockId&&t.snapshotTimestamp?`snapshot://${t.blockId}/${t.snapshotTimestamp}`:new(w().Yv)("Invalid snapshot URL: {url}",{variables:{url:e}})},getUri:({pageOrDatabaseId:e,timestamp:r,baseUrl:n})=>function(e){const{pageOrDatabaseId:r,timestamp:n,baseUrl:s}=e;return`${R({baseUrl:s,pageId:r,blockId:void 0})}?${t(530199).lr}=${n}`}({pageOrDatabaseId:e,timestamp:r,baseUrl:n})},notification:{type:"notification",parseUri:e=>{const r=e.split("notification://")[1];return r?{type:"notification",notificationId:r}:Error(`Invalid notification URL: ${e}`)},getUri:({notificationId:e})=>`notification://${e}`},...t(24153).A2};function R(e){const{baseUrl:r,pageId:t,blockId:s}=e;return`${r}/${(0,n().Xw)(t)}${s?`#${(0,n().Xw)(s)}`:""}`}function L(e){return`collection://${e}`}function E(e,r){return`collectionProperty://${e}/${T(r)}`}function T(e){return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function S(e){return atob(e.replace(/-/g,"+").replace(/_/g,"/"))}function C(e){return`view://${e}`}function H(e){const{workflowId:r,spaceId:t}=e;return`agent://${t}/${r}`}function x(e){const{userId:r,email:t}=e;return t?`user://${r}/${t}`:`user://${r}`}function Y(e){const{source:r,permissionRecord:t}=e;return`file://${encodeURIComponent(JSON.stringify({source:r,permissionRecord:t}))}`}function D(e){return`citation://${encodeURIComponent(JSON.stringify(e))}`}function O(e){const r=function(e){return e.startsWith("{{")&&e.endsWith("}}")?e.slice(2,-2):e}(e),t=r.split("://")[0];if(!(0,k().Wh)(t))throw r.startsWith("CREATE-")?new(w().Yv)("CREATE-* placeholder URLs must be resolved to actual IDs before parsing. Found: {{{processedUri}}}",{variables:{processedUri:r}}):new(w().Yv)("Invalid agent URL: {{{processedUri}}}",{variables:{processedUri:r}});const n=b[t].parseUri(r);if(n instanceof Error)throw n;return n}function A(e,r){const t=e.split("://")[0];if((0,k().Wh)(t))return O(e);let n,s;if(e.startsWith("//"))n=`https:${e}`;else if(e.startsWith("/"))n=`${r.baseUrl}${e}`;else if(e.includes("://"))n=e;else if(/^[a-zA-Z][a-zA-Z0-9+.-]*:/.test(e))n=e;else{if(!(0,h().ctx)(e))throw new(w().Yv)("Unable to load the URL: {url} is not a valid URL and cannot be viewed.",{variables:{url:e}});n=`https://${e}`}try{s=new URL(n)}catch(a){throw new(w().Yv)("Invalid agent URL - Failed to parse as URL: {{{urlWithProtocol}}}",{variables:{urlWithProtocol:n}})}for(const o of k().od){var i;const e=b[o],t=null===(i=e.parseUrlToUri)||void 0===i?void 0:i.call(e,s,r);if("string"==typeof t){if(t.startsWith("https://")){const r=e.parseUri(t);if(r instanceof Error)throw r;return r}return O(t)}}if(!(0,o().AY)(n))throw new(w().Yv)("Cannot view non-web URL: {url}",{variables:{url:e}});return{type:"webpage",url:n}}function P(e,r){try{return A(e,r)}catch(t){return}}function M(e){try{return O(e)}catch(r){return}}function B(e,r){let t;try{t=y(new URL(e),r)}catch(n){throw new(w().Yv)("Invalid agent URL - Failed to parse as URL: {urlStr}",{variables:{urlStr:e}})}if("page"!==t.name||!t.blockId)throw new(w().Yv)("Invalid Notion page or app URL: {urlStr}",{variables:{urlStr:e}});return{pageOrBlockId:t.blockId,blockId:t.scrollToBlockId}}function W(e){const r=O(e);if("collection"!==r.type)throw new(w().Yv)("Invalid data source URL: {{{url}}}",{variables:{url:e}});return r.collectionId}function F(){return`(${[...(0,k().QB)(),'https?://[^\\s)\\]"}\\\\|]+'].join("|")})`}function N(){return new RegExp(F(),"g")}function V(e){var r;const{type:t}=e;switch(t){case"database":case"page":case"pageOrCollectionViewBlock":return{table:c().ev,id:e.id};case"agent":case"trigger":case"script":return{table:I().C0,id:e.workflowId,spaceId:e.spaceId};case"collection":case"collectionProperty":case"formulaCode":case"collectionPropertyOption":return{table:l().Vl,id:e.collectionId};case"formulaResult":return{table:c().ev,id:e.pageId};case"integration":if("workflowId"in e)return{table:I().C0,id:e.workflowId,spaceId:e.spaceId};if("moduleRecordId"in e)return{table:f().yM,id:e.moduleRecordId,spaceId:e.spaceId};(0,s().HB)(e);break;case"view":return{table:c().ev,id:e.collectionViewId};case"user":return{table:p().oo,id:e.userId};case"thread":return{table:u().To,id:e.threadId,spaceId:e.spaceId};case"slackUser":case"slackChannel":case"slackMessage":case"webpage":case"universal-object":case"agent-system-documentation":case"worker":case"notification":return;case"file":return"attachmentStep"in e&&"block"===(null===(r=e.attachmentStep.permissionRecord)||void 0===r?void 0:r.table)?e.attachmentStep.permissionRecord:void 0;case"discussion":return{id:e.discussionId,table:d().$Y};case"pageDiscussions":return{id:e.pageId,table:c().ev};case"citation":return{id:e.id,table:"block",spaceId:e.spaceId};case"snapshot":return{id:e.pageOrDatabaseId,table:c().ev};default:(0,s().HB)(t)}}function _(e,r){if("slackChannel"===e.type||"slackMessage"===e.type||"slackUser"===e.type)return b[e.type].getUri(e)}function j(e,r){const t=i().I6(e,"url");let n,s=t.length;for(;s--;){n=t[s];const o=P(n.href,r),i=o?_(o):void 0;"string"==typeof i&&(e=e.slice(0,n.start)+i+e.slice(n.end))}return e}const z=k().od.join("|"),Z=new RegExp(`((?:${z})://[\\w\\/\\-\\.]+[\\w])`,"gi");function q(e){if(!e.includes("://"))return[];return Array.from(e.matchAll(Z)).map((e=>({href:e[0],value:e[0],start:e.index,end:e.index+e[0].length})))}}}]);