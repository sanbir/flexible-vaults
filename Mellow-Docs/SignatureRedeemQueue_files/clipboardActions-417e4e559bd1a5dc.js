"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[22542,69184,90871,99171],{24126:(e,t,o)=>{o.d(t,{c:()=>r});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"3.9 2.75 12.18 14.49",svg:(0,o(474848).jsx)("path",{d:"M12.626 2.768a.625.625 0 0 1 0 1.224l-.126.013h-.125v4.794l3.366 5.159c.893 1.369-.03 3.17-1.623 3.281l-.156.006H6.039c-1.688 0-2.703-1.873-1.78-3.287l3.366-5.157V4.005H7.5a.625.625 0 0 1 0-1.25h5zM8.875 9.173l-.102.156-1.567 2.401h5.589l-1.569-2.403-.101-.156V4.005h-2.25z"})},r=(0,o(340498).wt)("beaker",n,"default")},192180:(e,t,o)=>{o.d(t,{O8:()=>V,Yf:()=>R,fS:()=>B});var n=()=>o(726637),r=()=>o(221844),i=()=>o(140934),a=()=>o(770063),l=()=>o(295633),s=()=>o(683021),c=()=>o(730219),d=()=>o(906536),u=()=>o(86159),p=()=>o(700500),m=()=>o(792071),f=()=>o(651784),g=()=>o(179034),b=()=>o(197959),v=()=>o(161479),y=()=>o(201980),k=()=>o(534177),h=()=>o(292167),S=()=>o(437219),x=()=>o(722101),I=()=>o(384944),T=()=>o(666144),C=()=>o(689355),M=()=>o(97270),w=()=>o(299545),_=()=>o(673477),A=()=>o(518489),P=()=>o(295304),D=()=>o(547149),F=()=>o(51317);function R(e){const{environment:t,textStore:o,blockStore:l,url:d,oldTextValue:p,urlSelection:m}=e;if(s().Ay.state.open||M().A.state.open||_().Ay.state.open||C().A.state.open)return!1;const y=u().get();if(!y)return!1;const k=u().getRect(y);if(!k)return!1;const h=(0,f().parseRoute)({url:d,baseUrl:n().A.domainBaseUrl,publicDomainName:n().A.publicDomainName,isMobile:n().A.isMobile,protocol:n().A.protocol,currentUrl:window.location.href});if("page"===h.name&&Boolean(h.discussionId)&&h.discussionId){const e=h.discussionId,n=h.blockId;if(!n)return!1;const s=l.getParentBlockStore();if(!s)return!1;const u=(0,a().v3)(s,{table:g().ev,id:n,spaceId:(0,v().e)(s.pointer.spaceId)}),f=(0,a().v3)(u,{table:b().$Y,id:e,spaceId:(0,v().e)(l.pointer.spaceId)});if("none"===f.getRole())return!1;const y=new(i().ComputedStore)((()=>w().wc(f)[0]),{debugName:"firstCommentStore"}),x=new(r().A)({name:"internalUnfurlingMenuActions.activate",isTemporaryData:!0});t.defaultRecordCache.inMemoryRecordCache.addCacheOverride(x);const I=l.clone(x),T=o.clone(x),C=s.clone(x);return F().A.setState({args:{commentStore:y},stores:{blockStore:l,textStore:o,parentStore:s},temporaryStores:{blockStore:I,textStore:T,parentStore:C},temporaryRecordCache:x,focusedIndex:c().A.Preview,selectionRect:k,oldTextValue:p,open:!0,url:d,urlSelection:m}),S().wQ(t,{url:d}),!0}return!1}function B(e){const{actionType:t,environment:o,commentStore:n,useTempStores:r}=e,i=F().A.state;if(!i.open)return;const{oldTextValue:a}=i,s=r?i.temporaryStores:i.stores,{textStore:u,blockStore:p,parentStore:f}=s,g=o.currentUser.id;if(g){if(r){i.temporaryRecordCache.clearCache();for(const e in i.temporaryStores){const t=i.temporaryStores[e],n={userId:g,pointer:t.pointer},r=o.defaultRecordCache.inMemoryRecordCache.getRecord(n);r?T().PC({environment:o,inMemoryRecordCache:i.temporaryRecordCache,pointer:t.pointer,model:m().Bj6.fromValue(t.pointer.table,r.value),role:r.role,updatePaths:[[]],userId:g,force:!0,debugSource:"setUnfurlType"}):T().oX({environment:o,inMemoryRecordCache:i.temporaryRecordCache,persistedRecordCache:void 0,pointer:t.pointer,userId:g})}}else o.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(i.temporaryRecordCache);switch(t){case c().A.Link:(0,A().h)({environment:o,store:i.stores.blockStore}),(0,d().t)({store:i.stores.textStore,selection:{startIndex:i.urlSelection.endIndex,endIndex:i.urlSelection.endIndex}}),F().A.setState({...i,focusedIndex:c().A.Link});break;case c().A.Mention:if(!n)return;const e=(0,v().e)(u.pointer.spaceId);if(!e)return;const r=n.id;D().createAndCommit({environment:o,userAction:"internalUnfurlingMenuActions.mention",canUndo:!0,perform:t=>{P().R9({environment:o,store:u,value:a,transaction:t}),P().Gf({environment:o,editorMode:"default",store:u,selection:{startIndex:i.urlSelection.startIndex,endIndex:i.urlSelection.startIndex},annotation:y().hiQ(r,e),transaction:t,analyticsFrom:"block"})}}),F().A.setState({...i,focusedIndex:c().A.Mention});break;case c().A.Preview:if(!n)return;D().createAndCommit({environment:o,userAction:"internalUnfurlingMenuActions.preview",canUndo:!0,perform:e=>{P().R9({environment:o,store:u,value:a,transaction:e});const t=w().eK(n);if(!t)return;if(!w().No(t)||!f||!t.getParentId())return;const r=h().s({environment:o,parentBlockStore:f,targetStore:n,transaction:e});if(x().WH({parentStore:f.getContentStore(),insertStore:r,afterStore:p,transaction:e}),0===y().q4_(i.oldTextValue).trim().length){const t=l().B.createChildStore(f.getContentStore(),i.stores.blockStore.pointer);x().TF({parentStore:f.getContentStore(),childToRemoveStore:t,transaction:e})}}}),F().A.setState({...i,focusedIndex:c().A.Preview});break;default:throw(0,k().HB)(t)}r||F().A.setState({open:!1})}}function V(e){var t,o;const{blockStore:n,transaction:r,environment:i}=e,a=n.getType(),l=n.getFormat(),s=n.getSpaceId();if(!n.isDefined()||a!==p().xd.alias||null==l||null===(t=l.alias_pointer)||void 0===t||!t.id)return;const c=[y().wmz(y().hiQ(null==l||null===(o=l.alias_pointer)||void 0===o?void 0:o.id,s))];I().zv({store:n,data:{type:p().xd.text},transaction:r}),I().zv({store:n.getFormatStore(),data:{alias_pointer:null},transaction:r}),P().R9({environment:i,store:n.getBlockTitleStore(),value:c,transaction:r})}},340593:(e,t,o)=>{o.d(t,{d:()=>i});var n=()=>o(907258),r=()=>o(712505);function i(){const{mainEditorCurrentBlockStore:e}=n().default.state;return r().default.state.open&&r().default.state.targetStore||e}},387202:(e,t,o)=>{o.d(t,{B:()=>a});var n=()=>o(232615),r=()=>o(201980),i=()=>o(112484);function a(e){if("editing"===n().default.state.mode)return function(e,t,o){const n=r().kJl(e),a=(0,i().x)(n,t,o);for(const r of n){const e=a[r];if(e)return e}}(e,n().default.state.multiSelection,n().default.state.forceExtendAnnotations)}},448801:(e,t,o)=>{o.d(t,{i:()=>r});o(944114),o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698);var n=()=>o(371562);n();function r(e,t){const o=n().create({arrays:{detectMove:!1,includeValueOnMove:!0}}).diff(e,t);if(!o)return{beforeOps:{},removeOps:new Set};let r=[],i=[];for(const n in o)"_t"!==n&&("_"===n[0]?r.push(parseInt(n.slice(1),10)):1===o[n].length&&i.push({index:parseInt(n,10),value:o[n][0]}));const a={},l=new Set,s=[...e];r=r.sort(((e,t)=>e-t));for(let n=r.length-1;n>=0;n--){const e=r[n],t=s.splice(e,1)[0];l.add(t)}i=i.sort(((e,t)=>e.index-t.index));for(let n=0;n<i.length;n++){const e=i[n];a[e.value]=s[e.index],s.splice(e.index,0,e.value)}return{beforeOps:a,removeOps:l}}},462853:(e,t,o)=>{o.d(t,{l:()=>i});var n=()=>o(617871);const r={[n().e1]:"collection_connected_property_figma",[n().Hd]:"collection_connected_property_google_drive",[n().ob]:"collection_connected_property_github",[n().k0]:"collection_connected_property_zendesk",[n().bh]:"collection_synced_database_github",[n().MN]:"collection_synced_database_asana",[n().Fo]:"collection_synced_database_gitlab",[n().me]:"collection_synced_database_jira",[n().F6]:"collection_synced_database_jira_workspace",[n().Fv]:"collection_synced_database_jira_datacenter",[n().mn]:"collection_synced_database_salesforce_workspace"};function i(e){if(e)return r[e]}},473639:(e,t,o)=>{o.r(t),o.d(t,{convertSimpleBulletsTextSelectionToMarkdown:()=>jo,copy:()=>Lo,copyDirectLinkToContent:()=>yn,copyFormattedLinkToBlock:()=>bn,copyLinkToBlock:()=>fn,copyLinkToCollection:()=>gn,copyLinksToBlocks:()=>vn,copyPageContents:()=>hn,copySelectionToClipboard:()=>kn,copyWithToast:()=>xn,createSelectedMultiColumnBlockSubtree:()=>Po,cutWithMaybeConfirmation:()=>No,getFormulaEditorInformation:()=>nn,getInlineTextValueFromClipboardData:()=>Cn,getInlineTitleValueFromClipboardTextHtml:()=>Jo,getLinkToBlock:()=>mn,getNotionSelectionClipboardData:()=>Co,htmlToMultiTextSelectionClipboardData:()=>Zo,insertOrTransformToCodeBlock:()=>un,markdownToBlocks:()=>Tn,multiTextSelectionToMarkdown:()=>In,paste:()=>dn,pasteFilesForBlocks:()=>Wo,pasteMarkdown:()=>$o,serializeMultiTextSelectionToClipboardData:()=>Ro,serializePagePropertiesAsText:()=>Do,triggerBrowserCopy:()=>Sn});var n={};o.r(n),o.d(n,{convertSimpleBulletsTextSelectionToMarkdown:()=>jo,copy:()=>Lo,copyDirectLinkToContent:()=>yn,copyFormattedLinkToBlock:()=>bn,copyLinkToBlock:()=>fn,copyLinkToCollection:()=>gn,copyLinksToBlocks:()=>vn,copyPageContents:()=>hn,copySelectionToClipboard:()=>kn,copyWithToast:()=>xn,createSelectedMultiColumnBlockSubtree:()=>Po,cutWithMaybeConfirmation:()=>No,getFormulaEditorInformation:()=>nn,getInlineTextValueFromClipboardData:()=>Cn,getInlineTitleValueFromClipboardTextHtml:()=>Jo,getLinkToBlock:()=>mn,getNotionSelectionClipboardData:()=>Co,htmlToMultiTextSelectionClipboardData:()=>Zo,insertOrTransformToCodeBlock:()=>un,markdownToBlocks:()=>Tn,multiTextSelectionToMarkdown:()=>In,paste:()=>dn,pasteFilesForBlocks:()=>Wo,pasteMarkdown:()=>$o,serializeMultiTextSelectionToClipboardData:()=>Ro,serializePagePropertiesAsText:()=>Do,triggerBrowserCopy:()=>Sn});o(944114),o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(823215),o(354520),o(430670),o(803949),o(581454),o(908872),o(737550);var r=o.n(o(842838)),i=()=>o(208360),a=()=>o(907258),l=()=>o(60481),s=()=>o(129318),c=()=>o(486547),d=()=>o(790785),u=()=>o(242422),p=()=>o(726637),m=()=>o(221844),f=()=>o(908006),g=()=>o(929219),b=()=>o(380745),v=()=>o(365917),y=()=>o(675133),k=()=>o(792057),h=()=>o(489295),S=()=>o(770063),x=()=>o(295633),I=()=>o(598790),T=()=>o(755125),C=()=>o(906536),M=()=>o(301809),w=()=>o(465628),_=()=>o(77311),A=()=>o(843427),P=()=>o(86159),D=()=>o(232615),F=()=>o(238643),R=()=>o(764880),B=()=>o(584262),V=()=>o(700500),E=()=>o(898244),N=()=>o(921940),L=()=>o(634201),W=()=>o(856197),O=()=>o(683259),U=()=>o(107041),j=()=>o(522419),z=()=>o(80979),H=()=>o(239381),X=()=>o(165358),$=()=>o(236162),G=()=>o(938379),Z=()=>o(416504),J=()=>o(911676),q=()=>o(206267),Q=()=>o(777447),K=()=>o(945778),Y=()=>o(997769),ee=()=>o(553737),te=()=>o(128713),oe=()=>o(792071),ne=()=>o(134025),re=()=>o(328876),ie=()=>o(754199),ae=()=>o(388821),le=()=>o(696706),se=()=>o(450648),ce=()=>o(651784),de=()=>o(179034),ue=()=>o(343666),pe=()=>o(161479),me=()=>o(495585);var fe=()=>o(201980),ge=()=>o(439180),be=()=>o(924703),ve=()=>o(173979),ye=()=>o(708830),ke=()=>o(445120),he=()=>o(69708),Se=()=>o(100622),xe=()=>o(496603),Ie=()=>o(498212),Te=()=>o(183558),Ce=()=>o(534177),Me=()=>o(939768),we=()=>o(720665),_e=()=>o(230554),Ae=()=>o(37450),Pe=()=>o(532893),De=()=>o(144440),Fe=()=>o(807700);function Re(e){return e.trimEnd().includes("\n")}var Be=()=>o(89053),Ve=()=>o(450510),Ee=()=>o(388723),Ne=()=>o(404779),Le=()=>o(516430),We=()=>o(518736),Oe=()=>o(79976),Ue=()=>o(59110),je=()=>o(949653),ze=()=>o(375078),He=()=>o(267419),Xe=()=>o(120672),$e=()=>o(18387),Ge=()=>o(560595),Ze=()=>o(951177),Je=()=>o(492414),qe=()=>o(594794),Qe=()=>o(299545),Ke=()=>o(301421),Ye=()=>o(440024),et=()=>o(355110),tt=()=>o(747674),ot=()=>o(250452),nt=()=>o(206051),rt=()=>o(857048),it=()=>o(404715),at=()=>o(980914),lt=()=>o(562800),st=()=>o(24973),ct=()=>o(77246),dt=()=>o(957763),ut=()=>o(295304),pt=()=>o(547033),mt=()=>o(718957);function ft(){var e;const t=P().get(),o=null===(e=(0,mt().GI)({range:t,contentEditableLeafRegistry:void 0,allowInvisibleEndSelection:!0}))||void 0===e?void 0:e.multiSelection;if(o){const e=(0,mt().$W)(o).some((({editable:e})=>e.props.disabled));(0,pt().setMultiSelection)({readOnly:e,multiSelection:o})}}var gt=()=>o(387202);function bt(){if("editing"!==D().default.state.mode)return!1;const e=(0,w().H)(D().default.state.multiSelection);if(!e)return!1;if(!e.store.isTable(de().ev))return!1;if(0===nt().default.state.stores.length)return!1;return(0,h().zH)(e.store).getType()===V().xd.code&&(D().default.isEditingCaption()?"caption":"body")}var vt=()=>o(547149),yt=()=>o(62246),kt=()=>o(192180),ht=()=>o(964556),St=()=>o(559926),xt=()=>o(209660),It=()=>o(812182),Tt=()=>o(134837),Ct=()=>o(680074),Mt=()=>o(191227),wt=()=>o(160475);function _t(e){var t;const{originalHtmlContentSize:o,environment:n}=e;if(o<500)return;const r=(0,Ct().R$)(n),i=null==r||null===(t=r.getSettings())||void 0===t?void 0:t.adoption_entry_points,a=i?i.import_nudge_on_large_paste:void 0;if(a){const e=u().default.getConfigKey("adoption_entry_point_time_delta","import_nudge_on_large_paste"),t=a[a.length-1];if(!(Date.now()-t>e.view_delta))return}"nudge_on_large_paste"===u().default.getEligibleGroup({experimentId:"adoption_import_entry_point",defaultGroup:"control"})&&((0,wt().t)({environment:n,action:"view",from:"import_nudge_on_paste"}),It().Iz({message:y().A.formatMessage(At.triggerNudgeOnPasteDescription),presentationType:"persistent",id:"nudge-on-paste",title:y().A.formatMessage(At.triggerNudgeOnPasteTitle),onUserDismiss:()=>{(0,wt().t)({environment:n,action:"dismiss",from:"import_nudge_on_paste"})},onDismiss:()=>{(0,Tt().p)(n,{entryPoint:"import_nudge_on_large_paste"})},actions:{primary:{title:y().A.formatMessage(At.triggerNudgeOnPastePrimaryAction),onAction:()=>{const e=Mt().A.getOrCreateFlowId();(0,wt().t)({environment:n,action:"click",from:"import_nudge_on_paste"}),St().kY(n,{from:"import_nudge_on_paste",flowId:e}),It().UW("nudge-on-paste"),xt().Ow({currentTab:"imports",openedFrom:"import_nudge_on_paste"})}}}}))}const At=(0,he().YK)({triggerNudgeOnPasteTitle:{id:"adoption.nudgeOnPaste.title",defaultMessage:"Import content directly"},triggerNudgeOnPasteDescription:{id:"adoption.nudgeOnPaste.description",defaultMessage:"Get all your content into Notion with a click"},triggerNudgeOnPastePrimaryAction:{id:"adoption.nudgeOnPaste.primaryAction",defaultMessage:"Import now"}});var Pt=()=>o(314529),Dt=()=>o(136833);var Ft=()=>o(541372),Rt=(o(16280),o(672577),()=>o(330361)),Bt=()=>o(741237),Vt=()=>o(842989),Et=()=>o(220719),Nt=()=>o(44729),Lt=()=>o(534402),Wt=()=>o(20313),Ot=()=>o(836724),Ut=()=>o(257216);function jt(e){const{environment:t,clipboardData:o,transaction:n,allowPasteIntoHeaderWithoutChildren:r,selectAll:i,preventLegacyTransclusions:a,spaceStore:l}=e;if(D().default.isEditingComment()||bt())return!1;if(function(e,t){return e.blockSelection.blocks.some((e=>{var o;if(!e.blockSubtree)return!0;const n=null===(o=e.blockSubtree.getModel({id:e.blockId,table:de().ev}))||void 0===o?void 0:o.spaceId;return!!(n&&t&&_e().Lw({sourceSpaceId:n,targetSpaceId:t,sourceBlockSubtree:e.blockSubtree}))||void 0}))}(o,null==l?void 0:l.id))return!1;const s=D().default.state;if("editing"!==s.mode)return!1;const c=s.multiSelection.start.store;if(!c.isTable(de().ev))return!1;const d=(0,I().T)(c);if(!d)return!1;if(c!==d.getBlockTitleStore())return!1;const u=d.getType(),p=d.getFormat();if(!u)return!1;if(!((0,V().IU)(u,p)||r&&(0,V().CN)(u)))return!1;if(r&&(0,V().CN)(u)){const e=o.blockSelection.blocks[0],t=null==e?void 0:e.blockId,n=null==e?void 0:e.blockSubtree,r=t&&n?n.getModel({id:t,table:"block"}):void 0;if(Boolean(null==r?void 0:r.getContentLength()))return!1}const m=(0,Wt().Ag)({includeNonSelectableListContainer:!0});if(!m)return!1;const g=(0,Wt().Xs)(d,[m]);if(!g)return!1;let b=0;for(let f=g.length-1;f>=0;f--){const e=g[f].value.store,t=Ot().T.findSelectableFromStore(e),o=e.getModel();if(null!=o&&o.isType(V().U6)||t&&!t.props.canSelect){b=f;break}}const v=g.slice(b);if(0===v.length)return!1;const y=v[0].value.store,k=y.pointer.spaceId,h=(0,Fe().l)(y);n.logDebugMessage("pasteMultiTextSelection: pasting",v,{spaceId:k,pastingIntoTemplate:h,insertionPathRootStore:y});const S=o.blockSelection.blocks.map((({blockId:e,blockSubtree:o})=>{var r;if(!o)throw new Error("Missing data for local duplicate block during paste");const i=(null===(r=o.getModel({table:de().ev,id:e}))||void 0===r?void 0:r.getType())===V().xd.factory,l=!(h||i),s=(0,je().localDuplicate)({environment:t,sourceBlockId:e,targetBlockPointer:(0,qe().zP)({environment:t,table:de().ev,spaceId:k}),sourceBlockSubtree:o,targetInMemoryRecordCache:y.inMemoryRecordCache,transaction:n,from:"paste",options:{addCopyName:!0,allowRedundancy:!1,deepCopyTransclusionContainers:!1,preventLegacyTransclusions:a,resolveTemplateVariables:l}}),c=s.targetBlockStore.getType();if(c){const e=d.getParentCollectionIdUpToTwoLevels(),o={from:"paste",type:c,new_page_id:"page"===c?s.targetBlockStore.id:void 0,creating_block_id:s.targetBlockStore.id,parent_collection_id:e};Ae().tP(c)?Ae().vH(t,{...o,type:c,collection_id:e||""}):Ae().vH(t,{...o,type:c})}return s})),T=o.multiTextSelection.start.pointerPath,C=o.multiTextSelection.end.pointerPath,M=[],w=[],_=Math.max(T.length,C.length),A=(v[v.length-_]||v[0]).value.store,P=(0,ye().v)({node:o.tree,recordStoreParent:A},(({node:e,recordStoreParent:t})=>{const o=((e,t)=>{let o;for(const{originalToDuplicate:n}of S)if(o=n.get(t),o)break;if(o)return x().B.createChildStore(e,o)})(t,e.value),n=M.length<T.length?T[M.length]:void 0,r=w.length<C.length?C[w.length]:void 0;let i=!1;if((null==n?void 0:n.id)===e.value.id&&(i=!0,M.push(o)),(null==r?void 0:r.id)===e.value.id&&(i=!0,w.push(o)),!i)return{value:{store:o}};const a=(null==o?void 0:o.getContentStore())||y;return{value:{store:o},children:e.children.map((e=>({node:e,recordStoreParent:a})))}}));if(M.length!==T.length||0===M.length)throw new Error(`Failed to hydrate start path during paste (found ${M.length} of ${T.length})`);if(w.length!==C.length||0===w.length)throw new Error(`Failed to hydrate end path during paste (found ${w.length} of ${C.length})`);const F=M[M.length-1],R=w[w.length-1];if(!F||!R)throw new Error(`Failed to hydrate position during paste (${F?"":"missing start"} ${R?"":"missing end"})`);const B=(0,ye().Qe)([P],(e=>e.value.store===F)),E=(0,ye().Qe)([P],(e=>e.value.store===R)),N=B&&E&&Vt().W.fromNearestCommonAncestor(B,E);if(!N)throw new Error(`Failed to build range for paths: ${B?"":"missing start"} ${E?"":"missing end"}`);ut().f0({environment:t,multiSelection:s.multiSelection,transaction:n});const L=D().default.state,W="editing"===L.mode?L.multiSelection:s.multiSelection;if((0,Qe().P4)(d)&&0===o.multiTextSelection.start.textIndex){const e=F.getType();e&&(0,V().aO)(e)&&ze().transformBlocks({environment:t,blocks:[d],blockType:e,transaction:n})}let O;return y.isCrdtEnabled()?(Ht({transaction:n,clipboardData:o,startBlockStore:d,duplicateStartStore:F,range:N,insertionPath:v,duplicates:S,insertionPathRootStore:y}),O=zt({environment:t,transaction:n,clipboardData:o,insertionPoint:W,textSelectionState:s,duplicateEndStore:R,pastingIntoTemplate:h}).newSelectionIndex):(O=zt({environment:t,transaction:n,clipboardData:o,insertionPoint:W,textSelectionState:s,duplicateEndStore:R,pastingIntoTemplate:h}).newSelectionIndex,Ht({transaction:n,clipboardData:o,startBlockStore:d,duplicateStartStore:F,range:N,insertionPath:v,duplicates:S,insertionPathRootStore:y})),f().default.afterNextFlush((()=>{const e=(0,Wt().PY)({rootStore:y,root:m,target:N.end}),t=e&&(0,ot().aI)(e[e.length-1]);if(!t)return;const o={start:{index:i?W.start.index:O,store:i?W.start.store:t},end:{index:O,store:t}};(0,pt().setMultiSelection)({multiSelection:o})})),!0}function zt(e){const{insertionPoint:t,duplicateEndStore:o,pastingIntoTemplate:n,environment:r,transaction:i,clipboardData:a}=e;let l=0;const s=t.end.store,c=t.end.index,d=(0,ot().aI)(o);if(d){l=fe().qAZ(d.getValue()).length;const e=(0,Et().o9)((0,I().T)(s)),t=(0,Et().o9)((0,I().T)(d));We().L({store:s,blockStore:e})&&We().L({store:d,blockStore:t})?(Lt().X0({sourceBlockStore:e,targetBlockStore:t,splitAtGraphemeIndex:c,transaction:i,moveIntoNewBlock:!1}),i.logDebugMessage("(CRDT) pasted suffix into end",d)):(ut().jN({environment:r,sourceStore:s,sourceIndex:c,targetStore:d,targetIndex:l,transaction:i}),i.logDebugMessage("pasted suffix into end",d))}else ut().jQ({environment:r,transaction:i,store:s,selection:{startIndex:c,endIndex:1/0}}),i.logDebugMessage("no end title store to paste text into");let u=fe().Uee(a.multiTextSelection.start.copiedText,{removeSuggestionAnnotationsAndText:!1,removeSuggestionAnnotations:!0,removeDiscussions:!0});return n||(u=(0,ve().f$)(u,{currentUserId:r.currentUser.id,currentTimeZone:(0,Z().P)()})),ut().yr({environment:r,index:t.start.index,store:t.start.store,tokens:u,transaction:i}),{newSelectionIndex:l}}function Ht(e){const{transaction:t,clipboardData:o,startBlockStore:n,duplicateStartStore:r,insertionPath:i,insertionPathRootStore:a,duplicates:l,range:s}=e;for(const u of s.iterateInsertionAt(i))(0,Wt().eM)({transaction:t,treeOperation:u,deleteFrom:"tree-parent",preferHighLevelOperations:!0}),Bt().O.applyMutable(u);if(o.blockSelection.wasContiguousSelection&&o.blockSelection.blocks.length>0&&!n.hasContent())for(const u of r.getContentStores())Nt().NI({parentStore:n.getContentStore(),childStore:u,transaction:t});const c=new Set;for(const{originalToDuplicate:u}of l){const e=u.getByTable(de().ev);for(const{value:o}of e){var d;if(!o||c.has(o.id))continue;c.add(o.id);const e=x().B.createChildStore(r,o),n=(0,Rt().g)(e),i="transclusion_reference"===a.getType()?null===(d=a.getTransclusionReferenceTargetStore())||void 0===d?void 0:d.id:a.id;n.find((e=>e.id===i))||(t.logDebugMessage("disposing of unwanted duplicated block",e,e.id===r.id),Ut().bn({childStore:e,parentStore:a,alive:!1,transaction:t}))}}}var Xt=()=>o(914577),$t=()=>o(722101),Gt=()=>o(384944),Zt=()=>o(391214),Jt=()=>o(538527),qt=()=>o(789200),Qt=()=>o(340593);const Kt=!1;function Yt(...e){Kt&&console.log("clipboardActions:",...e)}const eo=(0,he().YK)({offlineError:{id:"clipboardActions.offlineError.message",defaultMessage:"Please go online to copy this block."},untitled:{defaultMessage:"Untitled",id:"clipboardActions.untitledMessage"}}),to={...o(979004).fileExtensionToCodeLanguageMap,dockerfile:"Docker",javascriptreact:"JavaScript",jsonc:"JSON","objective-c":"Objective-C",proto:"Protobuf",shellscript:"Shell",typescriptreact:"TypeScript",vb:"Visual Basic"},oo="text/_notion-blocks-v3-production",no="text/_notion-text-production",ro="text/_notion-multi-text-production",io="text/_notion-page-source-production",ao="vscode-editor-data",lo=[oo,no,ro,io],so=new Set(lo);const co={fromJson:e=>e,toJson:e=>e},uo=co,po=co,mo=co,fo={fromJson(e){const t=(0,ye().v)(e.tree,(e=>e)),o=go.fromJson(e.blockSelection);return{...e,tree:t,blockSelection:o}},toJson(e){const t=go.toJson(e.blockSelection);return{...e,blockSelection:t}}},go={fromJson:e=>({...e,blocks:e.blocks.map((e=>({...e,blockSubtree:e.blockSubtree?ae().RecordMap.create(e.blockSubtree):void 0})))}),toJson:e=>({...e,blocks:e.blocks.map((e=>({...e,blockSubtree:e.blockSubtree?e.blockSubtree.toJson():void 0})))})},bo="VirtualClipboard:production",vo=new(ee().Ay)({namespace:ee().Bq,important:!0,trackingType:"necessary"});let yo,ko;function ho(e){yo={id:e.id,mimeTypes:e.mimeTypes},ko=!0;try{vo.set(bo,yo)}catch(t){X().log({level:"error",from:"clipboardActions",type:e.source,error:{message:"Unable to persistently store virtual clipboard data."}})}}function So(e){return e.isAndroid}function xo(e,t){const o=So(t),n=u().default.checkGate({gateName:"use_virtual_clipboard_for_programmatic_copies"});if(Yt("getClipboardReader: virtualClipboardEnabled",o,"isVirtualClipboardForProgrammaticCopiesEnabled",n),!o&&!n)return Yt("virtual clipboard and programmatic copies are not enabled: returning rawClipboardData",e),e;o||function(){if(!0===ko)return;const e=vo.get(bo);e?(yo=e,ko=!0):ko=!1}();if(!(o||ko))return Yt("virtual clipboard is not enabled or has no data: returning rawClipboardData",e),e;const r=e.getData("text/html"),i=(0,Ze().n8)(r);if(!i)return Yt("no virtual clipboard id found: returning rawClipboardData",e),e;if(!yo||yo.id!==i){if(yo=vo.get(bo),!(yo&&yo.id===i||(function(){ko=!1,yo=void 0;try{vo.remove(bo)}catch{}}(),yo=vo.get(bo),yo&&yo.id===i)))return e;ko=!0}const a=yo;if(i===(null==a?void 0:a.id)){const t=e.types.concat(Object.keys(a.mimeTypes));return{getData(t){const o=e.getData(t);return!o&&function(e){return so.has(e)}(t)?a.mimeTypes[t]||"":o},types:[...new Set(t)].filter((t=>{const o=a.mimeTypes[t];return""!==e.getData(t)||o&&""!==o})),items:e.items}}return e}function Io(e,t,o,n){if(!e.clipboardData)return;const r=o.toJson(n),i=JSON.stringify(r);e.clipboardData.setData(t,i)}function To(e,t,o){try{const n=e.getData(t),r=JSON.parse(n);return o.fromJson(r)}catch(n){}}function Co(e){const{clipboardData:t}=e,{text:o,html:n,isFromMicrosoftOffice:r,isHtmlTable:a}=function(e){const{clipboardData:t,tinyMceMicrosoftWordPasteFilter:o}=e,n=t.getData("text/uri-list"),r=t.getData("text/plain").replace(sn,"\n")||n;let a=t.getData("text/html");for(const d of cn){const e=t.getData(d);if(e){const{ops:t}=JSON.parse(e);t&&(a=new(i().Ss)(t,{}).convert())}}const l=en(a),{isHtmlTable:s,htmlContainsRichFormatting:c}=function(e){var t;const o=document.createElement("div");o.innerHTML=tn(e);const n=Boolean("table"===(null===(t=o.firstElementChild)||void 0===t?void 0:t.nodeName.toLowerCase()));return{htmlContainsRichFormatting:J().HZ({node:o,window,emojiData:He().A.state}),isHtmlTable:n}}({html:a,tinyMceMicrosoftWordPasteFilter:o});if(!c&&!function(e,t){return ln.test(e)&&ln.test(t)}(a,r))return{text:r,isFromMicrosoftOffice:l,isHtmlTable:s};return{text:r,html:a,isFromMicrosoftOffice:l,isHtmlTable:s}}(e);return{text:o,html:n,multiTextSelectionData:To(t,ro,fo),textSelectionData:To(t,no,uo),blockSelectionData:To(t,oo,go),isFromMicrosoftOffice:r,isHtmlTable:a}}function Mo(e){const{blocks:t,action:o,environment:n}=e;if(0===t.length)return{action:o,blocks:[],wasContiguousSelection:!1};const r=t[0],i=r.inMemoryRecordCache,a=xe().sb(xe().oE(t.map((e=>e.id)))),l=r.getParentBlockStore(),s=l?l.getRenderableContentIds():[],c=s.indexOf(r.id),d=Boolean(l&&t.every(((e,t)=>s.indexOf(e.id)===c+t)));if(i.isTemplatePreview){return{blocks:a.map((e=>({blockId:e,blockSubtree:(0,Ue().loadLocalSubtree)({environment:n,blockId:e,inMemoryRecordCache:i,options:{allowCopyCollections:!0,requireFullSubtree:!1,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0,excludeCrdtData:!0,includeLegacyTransclusionBlockValues:!0}}).recordMap}))),action:o,wasContiguousSelection:d}}if(i.snapshotData){!function(e,t){(0,Pt().DO_NOT_USE_trackLegacy)(e,"history_copy",{ageMs:(0,Dt().S)(t)})}(n,i.snapshotData);return{blocks:a.map((e=>({blockId:e,blockSubtree:(0,Ue().loadLocalSubtree)({environment:n,blockId:e,inMemoryRecordCache:i,options:{allowCopyCollections:!0,requireFullSubtree:!0,skipNavigableChildren:!0,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0,excludeCrdtData:!0,includeLegacyTransclusionBlockValues:!0}}).recordMap}))),action:o,wasContiguousSelection:d,wasSelectionFromSnapshot:!0}}{const e=(0,Ze().x4)(t),r=e&&Po({environment:n,inMemoryRecordCache:i,multiColumnPasteInfo:e});if(e&&r){let t=!1;const l=[];for(const o of a)e.blockIds.has(o)?t||(l.push({blockId:e.columnListId,blockSubtree:r}),t=!0):l.push({blockId:o,blockSubtree:(0,Ue().loadLocalSubtree)({environment:n,blockId:o,inMemoryRecordCache:i,options:{allowCopyCollections:!1,requireFullSubtree:!0,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0,excludeCrdtData:!0,includeLegacyTransclusionBlockValues:!0}}).recordMap});return{blocks:l,action:o,wasContiguousSelection:d}}return{blocks:a.map((e=>({blockId:e,blockSubtree:(0,Ue().loadLocalSubtree)({environment:n,blockId:e,inMemoryRecordCache:i,options:{allowCopyCollections:!1,requireFullSubtree:!0,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0,excludeCrdtData:!0,includeLegacyTransclusionBlockValues:!0}}).recordMap}))),action:o,wasContiguousSelection:d}}}function wo({textToken:e,hrefToNumberMetadata:t}){if(!fe().B8H(e))return e;const o=fe().uPN(e),n=fe().g2K(o);if(!n)return e;const r=fe().NpB(n);if("block"===r.type&&void 0!==r.citationNumber)return[""];const i=r.href;let a=t.map.get(i);return a||(a=t.currentNumber++,t.map.set(i,a)),fe().Ey_(`[${a}]`,[fe().Sez(i)])}function _o({recordMap:e,hrefToNumberMetadata:t}){const o=e.getModelsByTable(de().ev);for(const n of o){const o=n.getProperty("title");if(!o)continue;const r=fe().RQ(o).map((e=>wo({textToken:e,hrefToNumberMetadata:t}))),i=e.getValue(n.pointer);if(i){const t={...i,properties:{...i.properties,title:r}};e.setValue(n.pointer,t)}}}function Ao(e){const{markdown:t,markdownOptions:o,markdownLinkifyIt:n}=e;if(n)return te().uY({...n,markdown:t,plugin:null==o?void 0:o.plugin})}function Po(e){var t;const{environment:o,multiColumnPasteInfo:n,inMemoryRecordCache:r}=e,{columnListId:i,columnIds:a,spaceId:l}=n,s=ae().RecordMap.create(),c=null===(t=r.getEntry({pointer:{table:de().ev,id:i,spaceId:l},userId:o.currentUser.id}))||void 0===t?void 0:t.value.value;if("column_list"!==(null==c?void 0:c.type))return;const d={...c,content:(c.content||[]).filter((e=>a.has(e)))};s.setValue({table:de().ev,id:i,spaceId:l},d);for(const m of a){var u;const e=null===(u=r.getEntry({pointer:{table:de().ev,id:m,spaceId:l},userId:o.currentUser.id}))||void 0===u?void 0:u.value.value;if("column"!==(null==e?void 0:e.type))return;const t={...e,content:(e.content||[]).filter((e=>n.blockIds.has(e)))};s.setValue({table:de().ev,id:m,spaceId:l},t)}const p=[s];for(const m of n.blockIds){const e=(0,Ue().loadLocalSubtree)({environment:o,blockId:m,inMemoryRecordCache:r,options:{allowCopyCollections:!1,requireFullSubtree:!0,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0,excludeCrdtData:!0,includeLegacyTransclusionBlockValues:!0}}).recordMap;if(!e)return;p.push(e)}return ae().RecordMap.merge(p)}function Do(e){const{rootBlock:t,getRecordValue:o,spaceIdCreator:n}=e,r=o(t);if(!r)return;const i=(0,$().zN)({block:r,getRecordValue:o});if(!i)return;const a=(0,Ze().M9)({rootBlock:t,getRecordValue:o,formulasModule:z(),spaceIdCreator:n}),l=(0,E().Dp)(i),s=Object.keys(l),c=xe().Ul(s,(e=>{const t=l[e];return t&&t.name||""}));let d="";for(const u of c){const e=l[u];if(e&&"title"!==u){const t=(0,O().sL)({property:u,schema:l,block:r,exportArgs:a,renderers:W().z});t&&(d+=`${e.name}: ${t}\n`)}}return d||void 0}function Fo(e){const{treePath:t,textPosition:o,endpoint:n}=e,{store:r,index:i}=o,a=t.map((e=>e.value.store.pointer)),l=We().S(o.store)?["properties","title"]:o.store.path,s=fe().AI5(r.getValue(),i,i);return{copiedText:"end"===n?s.tokensBeforeRange:s.tokensAfterRange,textIndex:i,attributePath:l,pointerPath:a}}function Ro(e){var t;const{multiSelection:o,action:n,environment:r}=e;(0,A().K)(o)&&console.warn("Warning, serializeMultiTextSelectionToClipboardData() was called with a single-store text selection! This function should only be  called with a multi-selection that spans multiple blocks.");const i=null===(t=(0,mt().ZS)({filterCommonAncestors:!0,multiSelection:o,focus:void 0}))||void 0===t?void 0:t.stores;if(!i)return;const a=o.start.store.inMemoryRecordCache,l=Mo({action:n,blocks:i,environment:r});if(0===l.blocks.length)return;const s=(0,mt().Tp)({multiSelection:o,includeNonSelectable:!1});if(!s)return;const{treeRange:c}=s,d=[],u=new Map,p=(e,t)=>{t.forEach((e=>p(e,[])));const o=u.get(e),n=o&&o.length>t.length?o:t;u.set(e,n)};for(const{start:k,end:h}of c.iterateAnalogousNodes()){if(k){const e=k.childrenBeforeRange.slice(-1).concat(k.childrenInsideRange);p(k.parent,e)}if(h){p(h.parent,h.childrenInsideRange);for(const e of h.childrenAfterRange)d.push({command:"removeChild",path:["content"],pointer:h.parent.value.store.pointer,args:{id:e.value.store.id}})}}const m=Fo({textPosition:o.start,endpoint:"start",treePath:c.startPath}),f=Fo({textPosition:o.end,endpoint:"end",treePath:c.endPath});d.push(...(0,Ze().Qr)(m),...(0,Ze().Qr)(f));for(const k of[null===(g=l.blocks[0])||void 0===g?void 0:g.blockSubtree,null===(b=l.blocks[l.blocks.length-1])||void 0===b?void 0:b.blockSubtree]){var g,b;k&&((0,re().applyOperationsToRecordMap)({recordMap:k,operations:d,updateOnly:!0}),Bo(r,a,k))}const v=(0,ye().v)(c.commonAncestor,(e=>{const t=u.get(e);if(t)return{value:e.value.store.pointer,children:t}}));if(!v)return void Yt("unexpected: trimming tree produced undefined");const y={currentNumber:1,map:new Map};for(const{blockSubtree:k}of l.blocks)k&&_o({recordMap:k,hrefToNumberMetadata:y});return m.copiedText=fe().RQ(m.copiedText).map((e=>wo({textToken:e,hrefToNumberMetadata:y}))),f.copiedText=fe().RQ(f.copiedText).map((e=>wo({textToken:e,hrefToNumberMetadata:y}))),{blockSelection:l,tree:v,multiTextSelection:{start:m,end:f},action:n}}function Bo(e,t,o){const n=[];for(const{model:r}of o)if(r instanceof oe().zgg&&!r.alive){n.push(r.pointer);const o=(0,Ue().loadLocalSubtree)({environment:e,blockId:r.pointer.id,inMemoryRecordCache:t,options:{allowCopyCollections:!0,requireFullSubtree:!1,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0,excludeCrdtData:!0,includeLegacyTransclusionBlockValues:!0}}).recordMap;if(o)for(const{pointer:e}of o)n.push(e)}for(const r of n)o.delete(r)}function Vo(e){const{environment:t,action:o,markdownLinkifyIt:n}=e,r=nt().default.state.stores,i=D().default.isEditingComment(),a=st().A.state.open,l=rt().wg(),s="empty"!==D().default.state.mode&&D().default.state.multiSelection,c=t.currentUser.id,d={notionData:[]},u=(0,$e().Z)();u&&(0,le().Yt)(u.pointer,de().ev)&&(d.pageSource=u.pointer,d.notionData.push({key:io,data:u.pointer,codec:po}));const m=s&&(0,w().H)(s);if(m&&m.selection.startIndex!==m.selection.endIndex){const e=y().A.getIntl(),{store:n,selection:r}=m,i=n.inMemoryRecordCache,a=n.getValue();Yt("copy: copying single-store text selection");const l=nn(),s={currentNumber:1,map:new Map};if(a&&!l){const e=n.table===de().ev?(0,I().T)(n):void 0,t=e&&xe().n4(n.path,e.getBlockTitleStore().path)?e.getType():void 0,i=t&&(0,V().aO)(t)?t:void 0,l=a.map((e=>wo({textToken:e,hrefToNumberMetadata:s}))).filter((e=>!fe().jR$(e)));d.notionData.push({key:no,data:{blockType:i,editing:l,selection:r,action:o},codec:uo})}const u=fe().Ffo(a,r.startIndex,r.endIndex).map((e=>wo({textToken:e,hrefToNumberMetadata:s}))),f=oe().b4_.fromGetRecordValueFn(i.makeGetRecordValueFn(c)),g=i.makeGetRecordRoleFn(c),b=null==l?void 0:l.valueTypes,k=new Set,h=u.map((t=>{const o=fe().uPN(t),n=fe().VtW(o);if(n){const e=fe().cQR(n);return`[${fe().N8A(t)}](${e})`}return(0,se().t2)({token:t,getRecordModel:f,intl:e,prefix:"@",seenBlocks:k,userTimeZone:(0,Z().P)(),renderDateAnnotationsAsISO:!1,deterministic:!1,externalIntegrations:v().A.integrations.state,disableInsertedAnnotations:!1,valueTypes:b})??""})).join("");d.text=(0,Ze().Df)(t.device.isWindows,h);const S=e=>e.table===de().ev?(0,Je().QN)(e):lt().tN(t)(e),x=(0,be().$e)({textValue:u&&{value:u,spaceId:(0,pe().e)(n.pointer.spaceId)},getRecordModel:f,getRecordRole:g,userTimeZone:(0,Z().P)(),isAndroid:!1,isSafariOrIOS:!1,isFirefox:!1,isWindows:!1,disableLinks:!1,disabled:!0,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,baseUrl:p().A.domainBaseUrl,publicDomainName:p().A.publicDomainName,emojiType:"raw",theme:(0,Se().x0)(),intl:e,katex:void 0,isClient:void 0,currentUserId:void 0,getPublicBaseUrlForPageOrCollection:S,externalIntegrations:v().A.integrations.state,formulaValueTypes:[],emojiData:He().A.state,isMobileNative:!1,ignoreNumberedBlockCitationAnnotations:!0});return d.html=(0,Ze().Df)(t.device.isWindows,x),d}if(s&&!(0,_().k)(s)&&!i&&s.start.store.table===de().ev&&s.end.store.table===de().ev){const e=Ro({environment:t,multiSelection:s,action:o});if(e){Yt("copy: copying multi-store text selection"),d.notionData.push({key:ro,data:e,codec:fo});const{markdown:o,html:r}=(0,Ze().Ij)({clipboardData:e,multiSelection:s,currentUserId:c,isWindows:t.device.isWindows,markdownLinkifyIt:n,formulasModule:z(),spaceIdCreator:t.idCreator.getSpaceIdCreatorSync(s.start.store.pointer.spaceId||"")});return o&&(d.text=o),r&&(d.html=r),d}}if(s&&!(0,_().k)(s)&&!i&&s.start.store.table===ue().SN&&s.end.store.table===ue().SN){Yt("copy: copying comment multi-text selection");const e=(0,mt().$W)(s),o=y().A.getIntl(),n=e.map((({store:e,selection:n})=>{if(n.startIndex===n.endIndex)return;const r=e.inMemoryRecordCache,i=oe().b4_.fromGetRecordValueFn(r.makeGetRecordValueFn(c)),a=r.makeGetRecordRoleFn(c),l=fe().Ffo(e.getValue(),n.startIndex,n.endIndex);return{plainText:(0,se().r4)({intl:o,textValue:l,getRecordModel:i,userTimeZone:(0,Z().P)(),externalIntegrations:v().A.integrations.state}),htmlContent:(0,be().$e)({textValue:l&&{value:l,spaceId:(0,pe().e)(e.pointer.spaceId)},getRecordModel:i,getRecordRole:a,userTimeZone:(0,Z().P)(),isAndroid:!1,isSafariOrIOS:!1,isFirefox:!1,isWindows:!1,disableLinks:!1,disabled:!0,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,baseUrl:p().A.domainBaseUrl,publicDomainName:p().A.publicDomainName,emojiType:"raw",theme:(0,Se().x0)(),intl:o,katex:void 0,isClient:void 0,currentUserId:void 0,getPublicBaseUrlForPageOrCollection:lt().tN(t),externalIntegrations:v().A.integrations.state,formulaValueTypes:[],emojiData:He().A.state,isMobileNative:!1}),textValue:l}})).filter(Ce().O9),r=n.map((e=>e.plainText)).join("\n\n"),i=`<div>${n.map((e=>e.htmlContent)).join("</div><div>")}</div>`;return d.text=(0,Ze().Df)(t.device.isWindows,r),d.html=(0,Ze().Df)(t.device.isWindows,i),d}if(r.length>0&&!i&&!l&&!a){Yt("copy: copying block selection");const e=r[0],i=e.inMemoryRecordCache,a=Mo({blocks:r,environment:t,action:o});if(d.notionData.push({key:oo,data:a,codec:go}),!e.isDefined())return d;const l=xe().oE(r.map((e=>e.computeWithRecordValues((({getRecordValueAndSubscribe:t})=>t(e)))))),s=i.makeGetRecordValueFn(c),{markdown:u,html:p}=(0,Ze().ZI)({rootBlock:{id:e.id,table:de().ev,spaceId:e.getSpaceId()},blockValues:l,getRecordValue:s,isWindows:t.device.isWindows,markdownLinkifyIt:n,formulasModule:z(),spaceIdCreator:t.idCreator.getSpaceIdCreatorSync(e.getSpaceId())});return u&&(d.text=u),p&&(d.html=p),d}return d}function Eo(e){const{environment:t,event:o}=e,n=q().JW();!function(e){var t;const{environment:o,event:n,markdownLinkifyIt:r}=e;if(!n.clipboardData)return;const i="copy"===n.type?"copy":"cut",a=Vo({environment:o,action:i,markdownLinkifyIt:r});if(Yt("copy: serializedData",a),!(a&&(a.text||a.html||null!==(t=a.notionData)&&void 0!==t&&t.length)))return void Yt("copy: doing nothing");if(n.preventDefault(),a.notionData)for(const{key:l,data:s,codec:c}of a.notionData)Io(n,l,c,s);a.text&&n.clipboardData.setData("text/plain",a.text);a.html&&n.clipboardData.setData("text/html",a.html)}(e),(0,Ze().dk)(o,n),function({event:e,device:t,customEventId:o}){if(!e.clipboardData||!So(t))return;const n={};for(const i of lo)n[i]=e.clipboardData.getData(i);const r=e.clipboardData.getData("text/html");e.clipboardData.setData("text/html",`${r}${(0,Ze().uE)(o)}`),ho({id:o,mimeTypes:n,source:"setVirtualClipboardData"})}({event:o,device:t.device,customEventId:n})}async function No(e){const{event:t,environment:o,markdownLinkifyIt:n}=e;ft();const r=nt().default.state.stores,i=D().default.isEditingComment(),a=(0,Ge().f)(),s="editing"===D().default.state.mode&&D().default.state.multiSelection,{phase:c}=nt().default.state;if(Lo({environment:o,event:t,disableSyncTextSelection:!0,markdownLinkifyIt:n}),s&&!(0,_().k)(s)){const e=(0,h().aP)(s.start.store),t=e?ct().Uv.getMode(e):"default";vt().createAndCommit({userAction:"clipboardActions.cutWithMaybeConfirmation",environment:o,canUndo:!0,perform:n=>{if("suggest"===t){const t=Le().RR(o,n,e);Le().rY({environment:o,multiSelection:s,transaction:n,discussionStore:t})}else ut().f0({environment:o,multiSelection:s,transaction:n})}})}else(c===l().o.Selected||s)&&r.length>0&&!i&&!a&&await Zt().Af({environment:o,blocks:r,shouldCheckSuggestEdit:!0});b().A.setKeyboardMode(!0)}function Lo(e){const{environment:t,event:o,disableSyncTextSelection:n,markdownLinkifyIt:r}=e;n||ft(),Eo({environment:t,event:o,markdownLinkifyIt:r}),b().A.setKeyboardMode(!0)}function Wo(e){var t;const{environment:o,files:n,transaction:r,insertBelowBlockStore:i}=e,a=nt().default.getCurrentRecordCache(),l=(0,Xe().y)(o);if(!a)return;const s=nt().default.state.stores,c=De().$C({environment:o,files:n,inMemoryRecordCache:a,transaction:r,pageWidth:l,spaceId:0!==s.length?s[0].pointer.spaceId:null===(t=(0,$e().Z)())||void 0===t?void 0:t.pointer.spaceId});c.forEach((e=>{const t=e.getType();t&&Ae().vH(o,{from:"paste",type:t,creating_block_id:e.id})})),Ho({environment:o,blocks:c,transaction:r,replaceEmptyTextBlock:!0,insertBelowBlockStore:i})}function Oo(e){const{environment:t,store:o,tokens:n,index:r,transaction:i,multiTextSelection:a,disableEmbedMenu:l,selectAll:s}=e,c=(0,w().H)(a),d=c?{value:c.store.getValue()}:void 0,u=(0,h().aP)(o),m=u?ct().Uv.getMode(u):"default",g=D().default.isEditingComment()||D().default.isEditingCaption(),b=u&&"page"===u.getType()&&u.getBlockTitleStore()===o;let v=n;(g||b)&&(v=function(e){const{tokens:t}=e,o=Uo(t);if(o&&o.url===o.text){const e=(0,ce().parseRoute)({url:o.url,baseUrl:p().A.domainBaseUrl,publicDomainName:p().A.publicDomainName,isMobile:p().A.isMobile,protocol:p().A.protocol,currentUrl:window.location.href});if("page"===e.name&&e.blockId){const t=fe().ld4(e.scrollToBlockId??e.blockId,void 0);return[fe().wmz(t),fe().Ey_(" ")]}if("collection"===e.name){const t=fe().ETy({collectionId:e.collectionId,spaceId:e.space&&"id"in e.space?e.space.id:void 0,parentCvbId:e.parentBlockId});return[fe().wmz(t),fe().Ey_(" ")]}}return t}({environment:t,tokens:n})),ut().yr({environment:t,store:o,tokens:v,index:r,transaction:i,selectAll:s,editorMode:m});const y=Uo(v);!l&&d&&y&&"suggest"!==m&&function(e){const{environment:t,hyperlink:o,oldTextValue:n}=e,r="editing"===D().default.state.mode&&(0,w().H)(D().default.state.multiSelection),i=nt().default.state;if(r&&i.stores.length>0){const e=r.store.getValue(),i=fe().q4_(e),a=L().PE(i.substring(0,i.indexOf(o.text))).length,l=a+L().PE(o.text).length;if(r.store.isTable(de().ev)||r.store.isTable(ue().SN)){if(ht().activateFromLinkCreation({environment:t,blockStore:nt().default.state.stores[0],textStore:r.store,textValueBeforePaste:n,url:o.url,urlSelection:{startIndex:a,endIndex:l}}))return;if(kt().Yf({environment:t,textStore:r.store,blockStore:nt().default.state.stores[0],oldTextValue:n,url:o.url,urlSelection:{startIndex:a,endIndex:l}}))return}f().default.afterNextFlush((()=>{const e=o.url;yt().p6({environment:t,textStore:r.store,oldTextValue:n,url:e,urlSelection:{startIndex:a,endIndex:l}})}))}}({environment:t,hyperlink:y,oldTextValue:d.value,transaction:i})}function Uo(e){if(1!==e.length)return;const t=e[0];if(!fe().BEe(t))return;const[o,n]=t;if(1!==n.length)return;const r=n[0];if(!fe().sh$(r))return;return{text:o,url:fe().cQR(r)}}function jo(e){const t=fe().q4_(e).split("\n"),o=[];let n=!1;for(const i of t){const e=me().WK.exec(i);e?(o.push(`- ${e[1]}`),n=!0):(n&&i.trim().length>0&&o.push(""),o.push(i),n=!1)}const r=o.join("\n");return o.length>1?r:`${r}\n`}function zo(e){return e.map((e=>{if(!fe().qXl(e))return e;const t=fe().uPN(e),o=fe().uoE(t);if(!o)return e;const n=fe().$sA(o),r=t.filter((e=>!fe().fts(e)));return fe().Ey_(n.text,r.length>0?r:void 0)}))}function Ho(e){const{environment:t,blocks:o,transaction:n,replaceEmptyTextBlock:r,insertBelowBlockStore:i}=e,a=nt().default.state.stores;if(1===a.length){const e=a[0];if(e.getType()&&e.isType(V().KK)&&function(e){if("editing"!==D().default.state.mode||!D().default.state.multiSelection)return!1;const t=(0,w().H)(D().default.state.multiSelection);if(!t)return!1;return t.store===e.getTitleStore()}(e)){const r=e.getContentStore(),i=xe().o8(o).reverse().map((e=>$t().Hs({parentStore:r,prependStore:e,transaction:n}).childStore));return(0,tt().t)({environment:t,stores:i}),i}}return Zt().LE({environment:t,blocksToInsert:o,target:i?[i]:a,transaction:n,replaceEmptyTextBlock:r})}function Xo(e,t,o,n){const r=(0,$e().Z)();if(!r)return;const i=nt().default.state.stores,a=0!==i.length?i[0].pointer.spaceId:r.pointer.spaceId,l="suggest"===ct().Uv.getMode(r,!0);let s=function(e,t){if("cut"!==t.action)return;const o="suggest"===ct().Uv.getMode(e,!0),n=[];for(const r of t.blocks){const t=x().B.createChildStore(e,{table:de().ev,id:r.blockId});if(!t.isReady())return;const i=t.getModel();if(!i)return;if(i.getSpaceId()!==e.getSpaceId())return;if(!1!==i.alive)return;o&&!V().ei[i.getType()]||n.push(t)}return n}(r,t);if(!s){let i=JSON.stringify(t).length>F().vs;if(u().default.checkGate({gateName:"increased_transaction_size_limit"})){const e=16*JSON.stringify(t).length;i=e>.8*F().He()}s=t.blocks.reduce(((s,{blockId:c,blockSubtree:d})=>{var u,p,m,f;const b=x().B.createChildStore(r,{table:de().ev,id:c,spaceId:null==o?void 0:o.spaceId});let v;if(b.isDefined())v=b.getModel();else{const e=null==d?void 0:d.getModel({table:de().ev,id:c});v=e&&oe().Bj6.fromBlock(e)}if(l&&v&&!V().ei[v.getType()])return s;if(null!==(u=v)&&void 0!==u&&u.isCollectionView()&&d&&v.hasLinkedCollections(oe().b4_.fromRecordMap(d))&&(null===(p=v)||void 0===p?void 0:p.getSpaceId())!==a){const t=Gt().Wv({environment:e,type:V().xd.text,inMemoryRecordCache:b.inMemoryRecordCache,transaction:n,spaceId:a});return ut().yr({environment:e,store:t.getBlockTitleStore(),tokens:[fe().wmz(fe().ld4(c,v.getSpaceId()))],index:0,transaction:n}),s.push(t),s}const h=!((0,Fe().l)(r)||rn()||null!==(m=v)&&void 0!==m&&m.isTemplateVariableContainerBlock()),S=d&&a&&(null===(f=v)||void 0===f?void 0:f.getSpaceId())&&_e().Lw({sourceSpaceId:v.getSpaceId(),targetSpaceId:a,sourceBlockSubtree:d});if(d&&!i&&!S){const t=(0,je().localDuplicate)({environment:e,sourceBlockId:c,targetBlockPointer:(0,qe().zP)({environment:e,table:de().ev,spaceId:a}),sourceBlockSubtree:d,targetInMemoryRecordCache:b.inMemoryRecordCache,options:{addCopyName:!0,allowRedundancy:!1,deepCopyTransclusionContainers:!1,resolveTemplateVariables:h,preventLegacyTransclusions:!0},from:"paste",transaction:n}).targetBlockStore,o=t.getType();if(o){const n=b.getParentCollectionIdUpToTwoLevels(),r={from:"paste",new_page_id:"page"===o?t.id:void 0,creating_block_id:t.id,parent_collection_id:n};Ae().tP(o)?Ae().vH(e,{...r,type:o,collection_id:n||""}):Ae().vH(e,{...r,type:o})}return s.push(t),s}if(t.wasSelectionFromSnapshot)return X().log({level:"warning",from:"clipboardActions",type:"pasteBlockSelection",data:{message:"Unable to locally duplicate pasted block selection from snapshot",miscDataToConvertToString:{blockId:c,blockType:b.getType(),blockSelectionTooBig:i,missingBlockSubtree:!d}}}),s;g().A.state.online||k().f1(y().A.formatMessage(eo.offlineError));const{blockStores:I,onComplete:T}=Oe().duplicateBlock({environment:e,stores:[b],transaction:n,from:"paste",options:{addCopyName:!0,allowRedundancy:!1,deepCopyTransclusionContainers:!1,resolveTemplateVariables:h,convertExternalObjectInstancesToPlaceholders:!1},targetSpaceId:(0,pe().e)(a),executionTarget:"server",skipUserFacingMessages:!1}),C=I[0],M=C.getType();return T.then((t=>{if("success"===t.status&&M){const t=b.getParentCollectionIdUpToTwoLevels(),o={from:"paste",new_page_id:"page"===M?C.id:void 0,creating_block_id:C.id,parent_collection_id:t};Ae().tP(M)?Ae().vH(e,{...o,type:M,collection_id:t||""}):Ae().vH(e,{...o,type:M})}})),s.push(C),s}),[])}if(l){const t=Le().RR(e,n,s[0]),o=[];s.forEach((e=>{const r={type:"insert",id:q().JW(),discussionId:t.id};Le().tM(n,e,r),o.push(e.id)})),n.preEnqueueActions.push((()=>{Le().c3({environment:e,transaction:n,discussionStore:t,addModifiedBlockIdsAfter:o})})),Jt().Ug({environment:e,blocks:s,annotation:[fe().Ifu.SuggestionInsertText,t.id],transaction:n})}Ho({environment:e,blocks:s,transaction:n,replaceEmptyTextBlock:!0});const c=nt().default.state.stores,d=c.length>0?c:[r],p=t.blocks.map((e=>{const t=d[0];return x().B.createChildStore(t,{table:de().ev,id:e.blockId})}));f().default.afterNextFlush((async()=>{await Promise.all(d.map((e=>e.waitUntil((()=>{const t=e.getType();return Boolean(t&&t!==V().xd.copyIndicator)}))))),await Promise.all(p.map((e=>e.load()))),o&&Ft().ei({environment:e,blocks:d,pageSource:o,copiedStores:p,action:t.action,wasContiguousSelection:t.wasContiguousSelection,rootStore:r})&&Ft().gi({environment:e,copiedStores:p,blocks:d,pageSource:o})}))}function $o(e){const{environment:t,disableEmbedMenu:o,transaction:n,overwrite:r,selectAll:i,markdownOptions:a,markdownLinkifyIt:l,text:s,tinyMceMicrosoftWordPasteFilter:c,spaceStore:d}=e,u=D().default.state,p=on(u);"editing"!==u.mode||"inline"!==p&&Re(s)?r?(n.logDebugMessage("paste: pasting as markdown overwrite"),function(e){const{environment:t,text:o,transaction:n,selectAll:r,markdownOptions:i,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:l,spaceStore:s}=e,c=Ao({markdown:o,markdownOptions:i,markdownLinkifyIt:a});if(!c)return;let d=Zo({environment:t,html:c,wrapInEmptyBlocks:!1,tinyMceMicrosoftWordPasteFilter:l});d||(d=Zo({environment:t,html:c,wrapInEmptyBlocks:!0,tinyMceMicrosoftWordPasteFilter:l}));if(!d)return;jt({environment:t,clipboardData:d,transaction:n,allowPasteIntoHeaderWithoutChildren:!0,selectAll:r,preventLegacyTransclusions:!0,spaceStore:s})}({environment:t,text:s,transaction:n,selectAll:i,markdownOptions:a,markdownLinkifyIt:l,tinyMceMicrosoftWordPasteFilter:c,spaceStore:d})):s&&(n.logDebugMessage("paste: pasting as markdown append"),function(e){const{environment:t,text:o,transaction:n,markdownOptions:r,markdownLinkifyIt:i,tinyMceMicrosoftWordPasteFilter:a}=e,l=Ao({markdown:o,markdownOptions:r,markdownLinkifyIt:i});if(l)Qo({environment:t,html:l,transaction:n,tinyMceMicrosoftWordPasteFilter:a})}({environment:t,text:s,transaction:n,markdownOptions:a,markdownLinkifyIt:l,tinyMceMicrosoftWordPasteFilter:c})):(n.logDebugMessage("paste: pasting as inline markdown"),function(e){const{environment:t,text:o,disableEmbedMenu:n,transaction:r,selectAll:i,markdownOptions:a,markdownLinkifyIt:l,tinyMceMicrosoftWordPasteFilter:s}=e,c="editing"===D().default.state.mode&&D().default.state.multiSelection;if(c){const e=(0,w().H)(c);if(e&&function(e){const t=D().default.state;return"editing"===t.mode&&!(0,_().k)(t.multiSelection)&&(0,A().K)(t.multiSelection)&&Y().t6(e,"url")}(o))an({environment:t,text:o,transaction:r,editingSelection:e,selectAll:i});else if((0,gt().B)("c")){const e=(0,I().T)(c.start.store);ut().$D({environment:t,editorMode:e?ct().Uv.getMode(e):"default",multiSelection:c,string:o,disableMentions:!0,disableEmojiCommands:!0,disableSlashCommands:!0,transaction:r,selectAll:i})}else{const e=l&&te().Z4({...l,markdown:o,plugin:null==a?void 0:a.plugin});if(!e)return;qo({environment:t,html:e,transaction:r,stripText:!1,stripSurroundingWhitespace:!1,disableEmbedMenu:n,selectAll:i,markdownLinkifyIt:l,tinyMceMicrosoftWordPasteFilter:s})}}}({environment:t,text:s,disableEmbedMenu:o,transaction:n,selectAll:i,markdownOptions:a,markdownLinkifyIt:l,tinyMceMicrosoftWordPasteFilter:c}))}function Go(e,t){const o=e.getValue({table:de().ev,id:t});if(!o)return;const n={table:de().ev,id:t,spaceId:o.space_id},r=(o.content??[]).map((t=>Go(e,t))).filter(Ce().O9);return new(ye().PH)(n,r)}function Zo(e){var t,o,n,r;const i=(0,$e().Z)(),{html:l,wrapInEmptyBlocks:s,tinyMceMicrosoftWordPasteFilter:c,environment:d}=e,u=Yo({environment:d,html:l,tinyMceMicrosoftWordPasteFilter:c,legacyNonCrdt:!0});if(!u)return;const{currentUserStore:p}=a().default.state;if(!p)return;let{allOperations:f,rootContentIds:g}=u;if(s){const e=Ko(d),t=Ko(d);if(!e||!t)return;f=[e.operation,...f,t.operation],g=[e.id,...g,t.id]}const b=ae().RecordMap.create();(0,re().applyOperationsToRecordMap)({recordMap:b,operations:f,updateOnly:!1});const v=[],y=function(e){const{name:t,userId:o,recordMap:n}=e,r=ae().RecordMapWithRole.create();for(const{pointer:i,model:a}of n)r.setModelAndRole(i,a,"reader");return new(m().A)({name:t,data:new(ke().UserRecordMap)({[o]:r})})}({name:"htmlToMultiTextSelectionClipboardData",userId:p.id,recordMap:b});for(const a of g){const e=(0,Ue().loadLocalSubtree)({environment:d,blockId:a,inMemoryRecordCache:y,options:{allowCopyCollections:!0,requireFullSubtree:!0,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0,excludeCrdtData:!0,includeLegacyTransclusionBlockValues:!0}}).recordMap;v.push({blockId:a,blockSubtree:e})}const k=new(ye().PH)({...(0,qe().zP)({environment:d,table:de().ev,spaceId:null==i?void 0:i.pointer.spaceId})},g.map((e=>Go(b,e))).filter(Ce().O9));if(0===k.children.length)return;const h=k.children[0],S=null===(t=(0,ye().Qe)([k],(e=>e===h)))||void 0===t?void 0:t.map((e=>e.value)),x=null===(o=b.getValue(h.value))||void 0===o||null===(o=o.properties)||void 0===o?void 0:o.title,I=(0,ye().wI)(k),T=null===(n=(0,ye().Qe)([k],(e=>e===I)))||void 0===n?void 0:n.map((e=>e.value)),C=null===(r=b.getValue(I.value))||void 0===r||null===(r=r.properties)||void 0===r?void 0:r.title,M=C?fe().q4_(C).length:0;return x&&S&&C&&T?{blockSelection:{blocks:v,wasContiguousSelection:!0,action:"copy"},tree:k,multiTextSelection:{start:{textIndex:0,copiedText:x,attributePath:["properties","title"],pointerPath:S},end:{textIndex:M,copiedText:C,attributePath:["properties","title"],pointerPath:T}},action:"copy"}:void 0}function Jo(e){const{text:t,html:o,stripText:n,stripSurroundingWhitespace:r,markdownLinkifyIt:i,tinyMceMicrosoftWordPasteFilter:a}=e,l=o||(t?Ao({markdown:t,markdownLinkifyIt:i}):void 0);if(!l)return;const s=(0,Ze().Lj)(l);if(s)return[fe().wmz(fe().ld4(s.id,s.spaceId),[])];const c=document.createElement("div");return c.innerHTML=tn({html:l,tinyMceMicrosoftWordPasteFilter:a}),J().Hw({node:c,window,stripText:n,stripSurroundingWhitespace:r,emojiData:He().A.state})}function qo(e){const{environment:t,html:o,transaction:n,stripText:r,stripSurroundingWhitespace:i,disableEmbedMenu:a,selectAll:l,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:c}=e,d="editing"===D().default.state.mode&&D().default.state.multiSelection;if(d){const e=Jo({html:o,stripText:r,stripSurroundingWhitespace:i,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:c});if(!e)return;const u=(0,I().T)(d.start.store),p=1===e.length;if(p){if(p&&(!e[0][1]||0===e[0][1].length)){n.logDebugMessage("pasteInlineHtml: insertString");const o=e[0][0];return void ut().$D({environment:t,editorMode:u?ct().Uv.getMode(u):"default",multiSelection:d,string:o,disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:n,selectAll:l})}const o=(0,w().H)(d);if(o&&!(0,_().k)(d)){const[,r]=e[0],i=r&&fe().VtW(r);if(i){n.logDebugMessage("pasteInlineHtml: pasteLinkOverText");return void an({environment:t,text:fe().cQR(i),transaction:n,editingSelection:o,selectAll:l})}}}n.logDebugMessage("pasteInlineHtml: delete selection and insert"),ut().f0({environment:t,multiSelection:d,transaction:n}),Oo({environment:t,store:d.start.store,tokens:e,index:d.start.index,transaction:n,disableEmbedMenu:a,multiTextSelection:d,selectAll:l})}}function Qo(e){const{environment:t,html:o,transaction:n,tinyMceMicrosoftWordPasteFilter:r}=e,i=(0,$e().Z)();if(!i)return;const a=Yo({environment:t,html:o,tinyMceMicrosoftWordPasteFilter:r});if(!a)return;const{allOperations:l,rootContentIds:s}=a;for(const u of l)if((0,ge().ph)(u)){const e=x().B.createChildStore(i,u.pointer);vt().applyCrdtTextOperation({store:e,operation:u,invertedOperation:void 0,transaction:n})}else if((0,ne().$Y)(u)){const e=(0,S().v3)(i,u.pointer);vt().applyOperation({store:e,operation:u,transaction:n})}else(0,Ce().HB)(u);const c=s.map((e=>x().B.createChildStore(i,{table:de().ev,id:e})));c.forEach((e=>{const o=e.getType();if(o){const n=e.getParentCollectionIdUpToTwoLevels(),r={from:"paste",creating_block_id:e.id,parent_collection_id:n};Ae().tP(o)?Ae().vH(t,{...r,type:o,collection_id:n||""}):Ae().vH(t,{...r,type:o})}}));const d=Ho({environment:t,blocks:c,transaction:n,replaceEmptyTextBlock:!0}).slice().reverse();return f().default.afterNextFlush((()=>{const e=d.map((e=>{if(e.getType()!==V().xd.text)return;const t=Uo(e.getTitleValue());if(!t)return;const o=(0,ce().parseRoute)({url:t.url,baseUrl:p().A.domainBaseUrl,publicDomainName:p().A.publicDomainName,isMobile:p().A.isMobile,protocol:p().A.protocol,currentUrl:window.location.href});return"page"===o.name?o:void 0})).filter(Ce().O9);Ft().T_({environment:t,rootStore:i,blocks:d,copiedLinks:e})||Ft().Tw({environment:t,blocks:d})})),c}function Ko(e){const{currentUserStore:t}=a().default.state,o=(0,$e().Z)();if(!t||!o)return;const n=t.id;if(!n)return;const r=o.id,i=o.pointer.spaceId,l=(0,qe().Z1)({environment:e,table:de().ev,spaceId:i});return{operation:{pointer:{table:"block",id:l,spaceId:i},command:"set",path:[],args:{id:l,version:1,type:"text",properties:{title:[[""]]},parent_id:r,parent_table:"block",space_id:i,created_by_table:"notion_user",created_by_id:n,created_time:Date.now(),last_edited_by_table:"notion_user",last_edited_by_id:n,last_edited_time:Date.now(),alive:!0}},id:l}}function Yo(e){const{environment:t,legacyNonCrdt:o,...n}=e,r=document.createElement("div");r.innerHTML=tn(n);const{currentUserStore:i}=a().default.state,l=(0,$e().Z)();if(!i||!l)return;const s=i.getValue();if(!s)return;const c=l.getSpaceId(),d=(0,qe().Gx)({environment:t,spaceId:c}),u=t.idCreator.getSpaceShortIdCreator(c,d);return J().aH({actor:(0,R().A7)(s),parent:{id:l.id,table:de().ev,spaceId:c},rootNode:r,deps:{importFileMap:{},window,intl:y().A.getIntl(),randomID:Ie().Ay,spaceIdCreator:u,randomShortID:Te().Ay,isPhoneNumber:ie().W,emojiData:He().A.state},options:{legacyNonCrdt:o,ignoreBlockCount:!1}})}function en(e){return/schemas-microsoft-com:office/.test(e)||/xmlns:m="http:\/\/schemas.microsoft.com\/office\/2004\/12\/omml"/.test(e)}function tn(e){const{html:t,tinyMceMicrosoftWordPasteFilter:o}=e;return r().sanitize(o&&en(t)?o(t):t)}function on(e){const t="editing"===e.mode&&e.multiSelection;if(!t)return;const o=Ke().n.findEditableWithStore(t.start.store),n=null==o?void 0:o.props;return n&&!n.disabled?n.pasteBehavior:void 0}function nn(){if("editing"!==D().default.state.mode)return;const e=D().default.state.multiSelection.start,t=e.store.path;if("formula"!==t[t.length-1])return;const o=(0,h().zH)(e.store);if(o.table!==de().ev)return;const n=o.getPropertiesStore().getValue();if(!n)return;const r=o.getSpaceId(),i=fe().q4_(n.value_types);if(!i)return;const a=(0,we().$l)(i);return{start:e,spaceId:r,getRecordModel:o.getRecordModel,valueTypes:a}}function rn(){const e=nt().default.state.stores;if("editing"!==D().default.state.mode)return e.length>0&&e[0].isInsideFactoryOrDuplicateBlocksAction();if(0===e.length)return!1;const{multiSelection:t}=D().default.state,o=t.start.store;if(!o.isTable(de().ev))return!1;const n=Pe().E(o);return Boolean(n)}function an(e){const{text:t,transaction:o,environment:n,editingSelection:r,selectAll:i}=e,a=(0,ce().parseRoute)({url:t,baseUrl:p().A.domainBaseUrl,publicDomainName:p().A.publicDomainName,isMobile:p().A.isMobile,protocol:p().A.protocol,currentUrl:window.location.href}),l="page"===a.name&&a.blockId?(0,Q().wv)({pageId:a.blockId,peekViewBlockId:a.peekViewBlockId,peekMode:a.peekMode,discussionId:a.discussionId,scrollToBlockId:a.scrollToBlockId,collectionViewId:a.collectionViewId}):"collection"===a.name?(0,G().C)({collectionId:a.collectionId,spaceId:a.space&&"id"in a.space?a.space.id:void 0,spaceDomain:a.space&&"domain"in a.space?a.space.domain:void 0,parentCvbId:a.parentBlockId}):t,s=ut().di({environment:n,store:r.store,selection:r.selection,transaction:o});qt().g({environment:n,store:r.store,selection:s,annotationKey:"a",transaction:o,updateSelection:!1}),Jt().Mw({environment:n,store:r.store,selection:s,annotation:["a",l],transaction:o}),(0,C().t)({store:r.store,selection:{startIndex:i?s.startIndex:s.endIndex,endIndex:s.endIndex}})}const ln=/\<\!-- wp:/;const sn=/\u2028/g,cn=["slack/texty"];function dn({environment:e,spaceStore:t,event:o,disableEmbedMenu:r,transaction:i,onPasteFiles:a,formulasModule:l,markdownLinkifyIt:c,tinyMceMicrosoftWordPasteFilter:d,ignoreKeyboardMode:p}){var m;const f=u().default.checkGate({gateName:"allow_cut_copy_comment"});if(o.preventDefault(),ft(),!o.clipboardData)return;const g=xo(o.clipboardData,e.device),v=Array.from(Array((null===(m=g.items)||void 0===m?void 0:m.length)??0).keys()).flatMap((e=>{var t;const o=g.items[e];if("file"!==o.kind)return[];const n=null===(t=o.getAsFile())||void 0===t||null===(t=t.name.match(/\.[^.]+$/))||void 0===t?void 0:t[0];return n?[n]:[]})),k=g.getData("text/html"),h=null==k?void 0:k.length;!function(e,{source:t,types:o,fileExtensions:n,htmlContent:r}){const i=[...o];i.sort();const a=n.map((e=>e.toLowerCase()));(0,Pt().DO_NOT_USE_trackLegacy)(e,"paste",{source:t,types:i,file_extensions:a,original_html_content_size:r.length})}(e,{source:"editor",types:g.types||[],fileExtensions:v,htmlContent:k});const{text:S,html:x,multiTextSelectionData:T,textSelectionData:C,blockSelectionData:M,isFromMicrosoftOffice:A,isHtmlTable:P}=Co({clipboardData:g,tinyMceMicrosoftWordPasteFilter:d}),F=To(g,io,po),R=function(e){return e.clipboardData?e.clipboardData.items?xe().oE(Array.from(e.clipboardData.items).map((e=>{const t=e.getAsFile();if(t&&t.size>0)return new File([t],t.name??y().A.formatMessage(eo.untitled),{type:e.type})}))):L().PE(e.clipboardData.files):[]}(o),B=(null==M?void 0:M.action)||(null==T?void 0:T.action)||(null==C?void 0:C.action);i.annotateWithUserAction("cut"===B?"paste.from_cut":s().V);const E=Re(S),N=bt(),W="body"===N&&!C;if((R.length>0||M||E&&!W)&&!(0,dt().E)(e,t))return;const O=D().default.state,U=on(O),j=function(e){const t=To(e,ao,mo),o=null==t?void 0:t.mode;if(!o)return;return to[o]||"Plain Text"}(g),z=E&&j&&"inline"!==U&&!N?un({codeLanguage:j,environment:e,transaction:i}):void 0;St().oF(e,{pastedText:S,source:"editor_paste"});const X=rt().wg(),$=rt().KR(),G=o.clipboardData.getData(Ve().sE),J=nn();if(R.length>0&&!A&&!P)i.logDebugMessage("paste: file/image detected -> onPasteFiles"),a({environment:e,files:R,transaction:i});else if(W)i.logDebugMessage("paste: editing code block contents with no Notion text selection -> pasteRawText"),pn(e,S,i);else if(z)i.logDebugMessage("paste: pasting code in existing empty text block with no selection or new code block after selection  -> pasteRawText"),pn(e,S,i);else if(J){if(i.logDebugMessage("paste: formulaInformation detected, attempting to paste as formula"),!l)return void pn(e,S,i);"multiSelection"in O&&ut().f0({environment:e,multiSelection:O.multiSelection,transaction:i});const{start:t,getRecordModel:o,valueTypes:n,spaceId:r}=J,a=(0,H().K5)({formulasModule:l,getRecordModel:o,textValue:[[S]],featureGates:(0,Be().i)(),valueTypes:n,spaceId:r});ut().yr({environment:e,tokens:a,store:t.store,index:t.index,transaction:i})}else if("plaintext"===U)i.logDebugMessage("paste: plaintext paste behavior detected, pasting as inline html"),qo({environment:e,html:S,transaction:i,stripText:!0,stripSurroundingWhitespace:!0,disableEmbedMenu:r,markdownLinkifyIt:c,tinyMceMicrosoftWordPasteFilter:d}),_t({environment:e,type:"plaintext",originalHtmlContentSize:h});else if(T){i.logDebugMessage("paste: multiTextSelectionData detected, attempting to paste as textselection");const o=function(e){const{environment:t,transaction:o,multiTextSelectionData:n,disableEmbedMenu:r,markdownLinkifyIt:i,tinyMceMicrosoftWordPasteFilter:a,spaceStore:l}=e,s=e.pasteBehavior||"inline",c=e.html||Ao({markdown:e.text,markdownLinkifyIt:i});if("editing"===D().default.state.mode)switch(s){case"inline":return!!c&&(qo({environment:t,html:c,transaction:o,stripText:!1,stripSurroundingWhitespace:!0,disableEmbedMenu:r,markdownLinkifyIt:i,tinyMceMicrosoftWordPasteFilter:a}),!0);case"block":return jt({environment:t,clipboardData:n,transaction:o,preventLegacyTransclusions:!0,spaceStore:l});default:(0,Ce().HB)(s)}}({multiTextSelectionData:T,environment:e,html:x,text:S,transaction:i,disableEmbedMenu:r,pasteBehavior:U,markdownLinkifyIt:c,tinyMceMicrosoftWordPasteFilter:d,spaceStore:t});o||(i.logDebugMessage("paste: could not paste as textSelection -> paste as blockSelection"),Xo(e,T.blockSelection,F,i))}else if(null!=C&&C.editing){if(u().default.checkGate({gateName:"bullets_in_simple_tables_yuh"})){const o=fe().Ffo(C.editing,C.selection.startIndex,C.selection.endIndex);if(!X&&function(e){return me().Rg.test(e)}(fe().q4_(o))){const n=jo(o);if(n)return i.logDebugMessage("paste: converting simple table bullets to markdown list"),void $o({environment:e,text:n,disableEmbedMenu:r,transaction:i,markdownLinkifyIt:c,tinyMceMicrosoftWordPasteFilter:d,spaceStore:t})}}i.logDebugMessage("paste: textSelectionData detected, pasting text selection");const o=(0,Qt().d)(),n=(null==F?void 0:F.id)!==(null==o?void 0:o.id);!function(e){const{environment:t,textSelectionData:o,transaction:n,disableEmbedMenu:r,removeDiscussions:i}=e,a=nt().default.getCurrentRecordCache(),{editing:l,selection:s}=o;let{tokensInsideRange:c}=fe().AI5(l,s.startIndex,s.endIndex);c=fe().Uee(c,{removeSuggestionAnnotationsAndText:!1,removeSuggestionAnnotations:!0,removeDiscussions:i??!0});const d=(0,$e().Z)();if(d&&!(d.isInsideTemplate()||rn()||d.isInsideFactoryOrDuplicateBlocksAction())&&(c=(0,ve().f$)(c,{currentUserId:t.currentUser.id,currentTimeZone:(0,Z().P)()})),"body"===bt()){const e=fe().Cc8(c);e&&(c=e)}const u="editing"===D().default.state.mode&&D().default.state.multiSelection;if(u){if(!(0,_().k)(u)){const t=(0,w().H)(u);if(t){const n=fe().Ffo(o.editing,o.selection.startIndex,o.selection.endIndex);if(1===n.length){const[o,r]=n[0],i=r&&fe().VtW(r);if(i){const n=fe().cQR(i);if([o,`http://${o}`,`https://${o}`].includes(n))return void an({environment:e.environment,text:n,transaction:e.transaction,editingSelection:t})}}}}const i=(0,I().T)(u.start.store),a=i?ct().Uv.getMode(i):"default";if("suggest"===a){const e=Le().RR(t,n,u);Le().rY({environment:t,multiSelection:u,transaction:n,discussionStore:e}),c=fe().Mwp({textValue:c,selection:{startIndex:0,endIndex:1/0},annotation:[fe().Ifu.SuggestionInsertText,e.id]})}else"default"===a&&ut().f0({environment:t,multiSelection:u,transaction:n});const l=D().default.state;if("editing"===l.mode){const e=l.multiSelection,i=Ke().n.findEditableWithStore(e.end.store);if(null!=i&&i.props.enableChatSelectionContextTokens||(c=zo(c)),o.blockType&&0===s.startIndex){const r=(0,I().T)(e.start.store);r&&"page"!==o.blockType&&(0,Qe().P4)(r)&&ze().transformBlocks({environment:t,blocks:[r],blockType:o.blockType,transaction:n})}Oo({environment:t,store:e.end.store,tokens:c,index:e.end.index,transaction:n,disableEmbedMenu:"suggest"===a||r,multiTextSelection:u})}}else if(a){var p;const e=nt().default.state.stores,o=Gt().Wv({environment:t,type:V().xd.text,inMemoryRecordCache:a,transaction:n,spaceId:0!==e.length?e[e.length-1].pointer.spaceId:null===(p=(0,$e().Z)())||void 0===p?void 0:p.pointer.spaceId}),r=o.getTitleStore();r&&ut().yr({environment:t,store:r,tokens:c,index:0,transaction:n}),Ho({environment:t,blocks:[o],transaction:n,replaceEmptyTextBlock:!1}),Ae().vH(t,{from:"paste",type:V().xd.text,creating_block_id:o.id,parent_collection_id:o.getParentCollectionIdUpToTwoLevels()})}}({environment:e,textSelectionData:C,transaction:i,disableEmbedMenu:r,removeDiscussions:!f||("copy"===B||n)})}else if(M&&M.blocks.length>0&&"inline"!==U)i.logDebugMessage("paste: blockSelectionData detected, pasting block selection"),Xo(e,M,F,i);else if(X&&G){const{simpleTableStore:t,rowIndex:r,columnIndex:a}=X.getProps();let l=null==$?void 0:$.selection;l||(l=at().nj({row:r,col:a}));const s=it().$O(t);l&&s&&(0,Ee().G)({clipboardActions:n,environment:e,simpleTableStore:t,selection:l,currentRows:t.getContentStores(),columnOrder:s,event:o,transaction:i,markdownLinkifyIt:c,tinyMceMicrosoftWordPasteFilter:d})}else if(x)if(X&&$&&G){const{simpleTableStore:t,rowIndex:r,columnIndex:a}=X.getProps();let{selection:l}=$;l||(l=at().nj({row:r,col:a}));const s=it().$O(t);l&&s&&(i.logDebugMessage("paste: pasting selection into simple table"),(0,Ee().G)({clipboardActions:n,environment:e,simpleTableStore:t,selection:l,currentRows:t.getContentStores(),columnOrder:s,event:o,transaction:i,markdownLinkifyIt:c,tinyMceMicrosoftWordPasteFilter:d}))}else if((E||P)&&"inline"!==U)i.logDebugMessage("paste: pasting as html"),Qo({environment:e,html:x,transaction:i,tinyMceMicrosoftWordPasteFilter:d}),_t({environment:e,type:"html",originalHtmlContentSize:h});else{i.logDebugMessage("paste: pasting as inline html");const t=Boolean(X);qo({environment:e,html:x,transaction:i,stripText:t,stripSurroundingWhitespace:t,disableEmbedMenu:r,markdownLinkifyIt:c,tinyMceMicrosoftWordPasteFilter:d}),_t({environment:e,type:"inline_html",originalHtmlContentSize:h})}else i.logDebugMessage("paste: pasting as markdown"),$o({environment:e,text:S,disableEmbedMenu:r,transaction:i,markdownLinkifyIt:c,tinyMceMicrosoftWordPasteFilter:d,spaceStore:t}),_t({environment:e,type:"markdown",originalHtmlContentSize:h});p||b().A.setKeyboardMode(!0)}function un(e){const{codeLanguage:t,environment:o,transaction:n}=e,r=D().default.state,i="editing"===r.mode&&r.multiSelection,a=nt().default.state.stores;if(!i&&0===a.length)return;let l,s,c;if(i?(l=i.start.store,s=i.end.store,c=(0,I().T)(s)):(l=a[0],s=a[a.length-1],c=s),!c)return;let d=c;if((0,Qe().P4)(c))!function(e){const{blockStore:t,environment:o,transaction:n,codeLanguage:r}=e;ze().transformBlocks({environment:o,blocks:[t],blockType:"code",transaction:n}),Xt().IA({blocks:[t],language:r,transaction:n})}({blockStore:c,environment:o,transaction:n,codeLanguage:t});else{const e=(0,I().T)(c);if(!e)return;const t=l.inMemoryRecordCache;if(!t)return;d=Gt().Wv({environment:o,type:V().xd.code,inMemoryRecordCache:t,transaction:n,spaceId:e.pointer.spaceId}),$t().WH({parentStore:e.getContentStore(),afterStore:s,insertStore:d,transaction:n})}P().clear(o);const u=(0,ot().aI)(d);return u&&(0,M().e)({store:u}),d}function pn(e,t,o){const n="editing"===D().default.state.mode&&D().default.state.multiSelection;if(n){const r=(0,I().T)(n.start.store);ut().$D({environment:e,editorMode:r?ct().Uv.getMode(r):"default",multiSelection:n,string:t,disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:o})}}function mn(e,t){const o=e.getNavigableBlockStore();if(o){const n=t.RouterStore.state.route,r="page"===n.name&&n.collectionViewId?n.collectionViewId:void 0;return(0,Je().J8)({store:o,scrollToBlockId:o.id===e.id?void 0:e.id,fullyQualified:!0,pageVisitSource:B().y8.CopyLink,embedded:!1,collectionViewId:r})}}function fn(e){const{environment:t,blockStore:o,callback:n}=e;(0,Ne().y)(),rt().wr();const r=mn(o,t);if(r){const e=o.isPageBlock()||o.isFormBlock()?c().clipboardMessages.copiedLinkToClipboard:c().clipboardMessages.copiedBlockLinkToClipboard;(0,d().copyString)({environment:t,stringValue:r,copiedMessage:e}).then(n)}}function gn(e){var t,o;const{environment:n,collectionStore:r,callback:i}=e;(0,Ne().y)(),rt().wr();const a=(0,G().C)({collectionId:r.id,spaceId:r.getSpaceId(),spaceDomain:null===(t=r.getSpaceStore())||void 0===t?void 0:t.getEditDomain(),parentCvbId:null===(o=r.getParentPointer())||void 0===o?void 0:o.id,domainBaseUrl:p().A.domainBaseUrl,pageVisitSource:B().y8.CopyLink});if(a){const e=c().clipboardMessages.copiedLinkToClipboard;(0,d().copyString)({environment:n,stringValue:a,copiedMessage:e}).then(i)}}function bn(e){const{environment:t,blockStore:o,callback:n}=e;(0,Ne().y)(),rt().wr();const r=mn(o,t),i=function(e,t){var o;const n=mn(t,e);if(!n)return;const r=e.currentUser.id,i=(0,O()._z)({blockId:t.id,intl:y().A.getIntl(),getRecordValue:t.inMemoryRecordCache.makeGetRecordValueFn(r),userTimeZone:(0,Z().P)()}),a=null===(o=t.getBlockIconStore())||void 0===o?void 0:o.getValue(),l=[(0,K().A)(a)?a:void 0,i].filter(Ce().O9).join(" ");return l?`<a href="${n}"><span>${l}</span></a>`+(0,Ze().a0)({id:t.id,spaceId:t.getSpaceId()}):n}(t,o);if(r&&i){const e=o.isPageBlock()?c().clipboardMessages.copiedPageLinkToClipboard:o.isFormBlock()?c().clipboardMessages.copiedFormLinkToClipboard:c().clipboardMessages.copiedBlockLinkToClipboard;(0,d().copyHtml)({environment:t,stringValue:r,htmlValue:i,copiedMessage:e}).then(n)}}function vn(e){const{environment:t,blocks:o,callback:n}=e;(0,Ne().y)(),rt().wr();const r=o.map((e=>mn(e,t))).filter(Ce().O9);if(r.some(Boolean)){const e=r.length>1?c().clipboardMessages.copiedLinksToClipboard:c().clipboardMessages.copiedLinkToClipboard;(0,d().copyString)({environment:t,stringValue:r.join("\n\n"),copiedMessage:e}).then(n)}}function yn(e){const{environment:t,blocks:o,callback:n}=e,r=o[0];if(!r.isDefined())return;const i=r.getModel(),a=r.getProperties(),l=r.getFormat();let s;if(r.isType(V().xd.bookmark))s=fe().q4_(a.link);else if((0,V().ie)(i.type))s=fe().q4_(a.source);else if(r.isType(V().xd.externalObjectInstance)||r.isType(V().xd.externalObjectInstancePage))s=(null==l?void 0:l.original_url)||(null==l?void 0:l.uri);else if(r.isType(V().xd.collectionView)){var u;const e=null===(u=r.getCollectionStoreIfSingleSource())||void 0===u?void 0:u.getValue();var p;if(e&&(0,U().ek)(e))s=null===(p=e.format)||void 0===p?void 0:p.original_url}else{if(!r.isType(V().xd.alias))return;s=null==l?void 0:l.comment_alias_url}if(!s)return;if(j()._J(s))return void X().log({level:"error",from:"clipboardActions",type:"copyDirectLinkToContent",error:{message:"Attempted to copy a direct signed url for S3-housed content."}});if(s=Me().q7(s),!s)return;(0,Ne().y)(),rt().wr();const m=c().clipboardMessages.copiedLinkToClipboard;(0,d().copyString)({environment:t,stringValue:s,copiedMessage:m}).then(n)}async function kn(e){var t,o;const{environment:n,markdownLinkifyIt:r}=e,i=Vo({environment:n,action:"copy",markdownLinkifyIt:r});if(Yt("copySelectionToClipboard: serializedData",i),!(i&&(i.text||i.html||null!==(t=i.notionData)&&void 0!==t&&t.length)))return!1;const a=null===(o=i.notionData)||void 0===o?void 0:o.map((({key:e,data:t,codec:o})=>({key:e,json:JSON.stringify(o.toJson(t))})));let l=i.html;if(l&&null!=a&&a.length){const e={};for(const o of a)e[o.key]=o.json;const t=q().JW();ho({id:t,mimeTypes:e,source:"copySelectionToClipboard"}),l=function(e){const{html:t,virtualClipboardId:o}=e;return t?`${t}${(0,Ze().uE)(o)}`:t}({html:l,virtualClipboardId:t})}return await(0,d().copyString)({environment:n,stringValue:i.text||"",htmlValue:l}),!0}function hn(e){const{environment:t,markdownLinkifyIt:o}=e;(0,et().U)(t);const n=e=>{var n;null===(n=e.stopImmediatePropagation)||void 0===n||n.call(e),Lo({environment:t,event:e,disableSyncTextSelection:!0,markdownLinkifyIt:o})};try{window.addEventListener("copy",n,{capture:!0,once:!0}),Sn()}finally{window.removeEventListener("copy",n,{capture:!0}),(0,Ye().I)({environment:t}),(0,T().clear)({environment:t})}}function Sn(){document.queryCommandSupported("copy")&&document.execCommand("copy")}async function xn(e,t){let o;o="string"==typeof t?t:JSON.stringify(t),o&&await(0,d().copyString)({environment:e,stringValue:o,copiedMessage:c().clipboardMessages.copiedToClipboard})}function In(e){const{environment:t,textSelection:o,markdownSerializationOptions:n,markdownLinkifyIt:r}=e,i=(0,w().H)(o);if(i&&i.selection.startIndex!==i.selection.endIndex)return function(e){const{environment:t,singleStoreTextSelection:o,markdownSerializationOptions:n}=e,{store:r,selection:i}=o,a=t.currentUser.id,l=r.inMemoryRecordCache,s=y().A.getIntl(),c=r.getValue(),d=fe().Ffo(c,i.startIndex,i.endIndex),m=r.getRecordStoreUIRoot().getValue();if(!m)return;const f={id:m.id,table:de().ev,spaceId:m.space_id},g=l.makeGetRecordValueFn(a),b=t.idCreator.getSpaceIdCreatorSync(m.space_id);return te().ZR({textValue:d,exportArgs:{root:f,navigableBlockId:f.id,renderParentBlockId:void 0,blockId:f.id,userTimeZone:(0,Z().P)(),intl:s,getRecordValue:g,getRecordModel:oe().b4_.fromGetRecordValueFn(g),numberedListCache:{},bulletedListCache:{},getRecordsWithParent:()=>[],getExportedPathToFile:({toFileURI:e})=>e,getExportedRenderAsset:({toFileURI:e})=>e,getExportedPathToPage:({toPageId:e})=>(0,N().A)({pageId:e,pageValue:g({table:de().ev,id:e}),baseUrl:p().A.domainBaseUrl,pageVisitSource:B().y8.Export}),baseUrl:p().A.domainBaseUrl,publicDomainName:p().A.publicDomainName,transformAnnotation:null==n?void 0:n.transformAnnotation,transformBlockMapping:null==n?void 0:n.transformBlockMapping,resultCache:new Map,regExpCache:new Map,formatDateCache:new Map,experimentService:u().default,collectionFeatureGates:(0,Be().i)(),formulasModule:z(),spaceIdCreator:b}})}({environment:t,singleStoreTextSelection:i,markdownSerializationOptions:n});const a=Ro({environment:t,multiSelection:o,action:"copy"});if(!a)return;const{markdown:l}=(0,Ze().Ij)({clipboardData:a,multiSelection:o,currentUserId:t.currentUser.id,isWindows:t.device.isWindows,markdownSerializationOptions:n,markdownLinkifyIt:r,formulasModule:z(),spaceIdCreator:t.idCreator.getSpaceIdCreatorSync(o.start.store.pointer.spaceId||"")});return l}function Tn(e){const{environment:t,inMemoryRecordCache:o,text:n,transaction:r,markdownOptions:i,markdownLinkifyIt:l,tinyMceMicrosoftWordPasteFilter:s,parentPointer:c,ignoreImages:d}=e,u=Ao({markdown:n,markdownOptions:i,markdownLinkifyIt:l});if(!u)return;const p=document.createElement("div");p.innerHTML=tn({html:u,tinyMceMicrosoftWordPasteFilter:s});const{currentUserStore:m,sidebarSpaceStore:f}=a().default.state;if(!m||!f)return;const g=m.getValue();if(!g)return;const b=((0,$e().Z)()??f).id,v=f.id,k=(0,qe().Gx)({environment:t,spaceId:v}),h=t.idCreator.getSpaceShortIdCreator(v,k),{allOperations:I,rootContentIds:T}=J().aH({actor:(0,R().A7)(g),parent:c??{id:b,table:de().ev,spaceId:f.id},rootNode:p,deps:{importFileMap:{},window,intl:y().A.getIntl(),randomID:Ie().Ay,spaceIdCreator:h,randomShortID:Te().Ay,isPhoneNumber:ie().W,emojiData:He().A.state},options:{ignoreBlockCount:!1,codePreviewFormat:o.isSyntheticAssistantData?"code":void 0,ignoreImages:d}});for(const a of I)if((0,ge().ph)(a)){const e=new(x().B)(t,a.pointer,{inMemoryRecordCache:o,userId:g.id});vt().applyCrdtTextOperation({store:e,operation:a,invertedOperation:void 0,transaction:r})}else if((0,ne().$Y)(a)){const e=new(S().pm)({environment:t,pointer:a.pointer,recordStoreOptions:{inMemoryRecordCache:o,userId:g.id}});vt().applyOperation({store:e,operation:a,transaction:r})}else(0,Ce().HB)(a);return T.map((e=>new(x().B)(t,{table:de().ev,id:e},{inMemoryRecordCache:o})))}function Cn(e){const{event:t,markdownLinkifyIt:o,tinyMceMicrosoftWordPasteFilter:n,supportsChatSelectionContextTokens:r}=e;if(!t.clipboardData)return;const{text:i,html:a,multiTextSelectionData:l,textSelectionData:s,blockSelectionData:c}=Co({clipboardData:t.clipboardData,tinyMceMicrosoftWordPasteFilter:n});if(l)return Jo({text:i,html:a,stripText:!1,stripSurroundingWhitespace:!0,markdownLinkifyIt:o,tinyMceMicrosoftWordPasteFilter:n});if(s){const{editing:e,selection:t}=s,o=fe().Uee(fe().AI5(e,t.startIndex,t.endIndex).tokensInsideRange,{removeSuggestionAnnotationsAndText:!1,removeSuggestionAnnotations:!0,removeDiscussions:!0});return r?o:zo(o)}return a||i?function(e){const{text:t,html:o,blockSelectionData:n,markdownLinkifyIt:r,tinyMceMicrosoftWordPasteFilter:i}=e;if(n&&n.blocks.length>0||Re(t))return fe().x9d(t);return Jo({text:t,html:o,stripText:!1,stripSurroundingWhitespace:!0,markdownLinkifyIt:r,tinyMceMicrosoftWordPasteFilter:i})}({text:i,html:a,blockSelectionData:c,markdownLinkifyIt:o,tinyMceMicrosoftWordPasteFilter:n}):void 0}},482871:(e,t,o)=>{o.d(t,{z:()=>d});o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(430670),o(581454);var n=()=>o(770063),r=()=>o(898244),i=()=>o(448801),a=()=>o(179034),l=()=>o(722101),s=(o(354520),()=>o(496603));function c(e){const{collectionContextStore:t,collectionViewStore:o,transaction:i}=e,c=o.getPageSortStore(),d=c.getValue(),u=t.groupsStore.getAllGroupStates(),p=function(e){const{pageSort:t,currentResults:o}=e;if(!t||t.length<=r().WF)return[];const n=t.filter((e=>!o.has(e)));return s().sb([...n.reverse(),...s().o8(t).reverse()]).slice(0,t.length-r().WF)}({pageSort:d,currentResults:new Set(u.flatMap((e=>e.resultsStore.state.map((e=>e.id)))))});for(const r of p)l().TF({parentStore:c,childToRemoveStore:(0,n().v3)(c,{table:a().ev,id:r}),transaction:i})}function d(e){const{resultIds:t,collectionViewStore:o,collectionContextStore:s,transaction:d}=e,u=o.getPageSortStore(),p=u.getValue()||[],{beforeOps:m}=(0,i().i)(p,t.slice(0,r().WF));for(const[r,i]of Object.entries(m))if(i){const e=(0,n().v3)(o,{table:a().ev,id:i});l().nc({parentStore:u,insertStore:(0,n().v3)(o,{table:a().ev,id:r}),beforeStore:e,transaction:d})}else{const e=t.findIndex((e=>e===r)),i=t[e-1],s=i?(0,n().v3)(o,{table:a().ev,id:i}):void 0;l().WH({parentStore:u,insertStore:(0,n().v3)(o,{table:a().ev,id:r}),afterStore:s,transaction:d})}c({collectionContextStore:s,collectionViewStore:o,transaction:d})}},491848:(e,t,o)=>{o.d(t,{w:()=>r});o(898992),o(672577);var n=()=>o(541199);function r({collectionContextStore:e,transaction:t}){const o="collectionTypedView"===e.contextTypeFromStoreState,r=e.databaseTypeFromStoreState,i=e.collectionStoresStore.state,a=i.find((e=>e.canEdit()||e.canEditCollection()||e.canEditContentOnly()))||i[0];!o&&a&&(0,n().e)({transaction:t,databaseType:r,collectionId:a.id,spaceId:a.getSpaceId()})}},560595:(e,t,o)=>{o.d(t,{f:()=>a});var n=()=>o(232615),r=()=>o(496603),i=()=>o(486674);function a(){const e=(0,i().a)(),t=n().default.state;if("editing"!==t.mode)return!1;const o=t.multiSelection.start.store;return Boolean(e&&e.id===o.id&&(e.getBlockTitleStore()===o||r().n4(e.getBlockTitleStore().path,o.path)))}},563015:(e,t,o)=>{o.d(t,{SA:()=>c,eJ:()=>b,ew:()=>g,ml:()=>u,rA:()=>m,yI:()=>f,zf:()=>p});o(581454);var n=()=>o(496603),r=()=>o(534177),i=()=>o(708685),a=()=>o(145076),l=()=>o(349835),s=()=>o(239381);function c(e){if("type"in e){if(e.type===l().IA.CalledFunctionOnEmptyValue)return"warning";if(e.type===l().IA.CallingFunctionWithUnknownTarget)return"warning";if(e.type===l().IA.CallingFunctionWithUnknownArgument)return"warning"}return"error"}function d(e){switch(e){case"checkbox":return"boolean";case"number":return"number";case"text":return"text";case"date":return"date";case"array":return"array";case"block":return"block";case"person":return"person";case"select":return"select";case"function":return"function";case"unknown":return"unknown";case"undefined":return"undefined";default:(0,r().HB)(e)}}function u(e){switch(e.type){case l().M9.InvalidCharacter:return{...a().x0.InvalidCharacter,values:{errorCharacter:e.character}};case l().M9.UnclosedStringLiteral:return a().x0.UnclosedStringLiteral;case l().M9.UnclosedComment:return a().x0.UnclosedComment;case l().M9.TokenExpected:return{...a().x0.TokenExpected,values:{expectedToken:e.token}};case l().M9.StringLiteralContainsToken:return a().x0.StringLiteralContainsToken;case l().M9.ExpressionExpected:return a().x0.ExpressionExpected;case l().M9.PropertyTokenOrFunctionExpected:return a().x0.PropertyTokenOrFunctionExpected;case l().M9.EndOfInputExpected:return a().x0.EndOfInputExpected;case l().M9.UnexpectedError:return a().x0.UnexpectedError;case l().M9.TooDeeplyNested:return a().x0.TooDeeplyNested;default:(0,r().HB)(e)}}function p(e){switch(e.type){case l().IA.FunctionCallArgumentWrongType:case l().IA.FunctionCallUnexpectedArgument:return e.argument;default:return e.node}}function m(e,t){let o;switch(t.type){case l().IA.ThisRowTypeNotFound:o=a().Xz.ThisRowTypeNotFound;break;case l().IA.ThisRowNotBlockWithCollection:o=a().Xz.ThisRowNotBlockWithCollection;break;case l().IA.MissingPropertyOnThisRow:o={...a().Xz.MissingPropertyOnThisRow,values:{propertyName:t.property}};break;case l().IA.MissingContextVariable:{const e=(0,s().ix)(t.token)?t.token.contextValueId:t.token.valueId;o={...a().Xz.MissingContextVariable,values:{valueId:e}}}break;case l().IA.MissingBlock:o={...a().Xz.MissingBlock,values:{blockId:t.token.blockId}};break;case l().IA.CallingNotFunction:o={...a().Xz.CallingNotFunction,values:{expressionType:d(t.callee.type.type)}};break;case l().IA.FunctionCallTooFewArguments:o={...a().Xz.FunctionCallTooFewArguments,values:{minNumParameters:t.minNumParameters,functionName:t.libraryFunction.name,numArguments:t.numArguments}};break;case l().IA.FunctionCallUnexpectedArgument:o={...a().Xz.FunctionCallUnexpectedArgument,values:{functionName:t.libraryFunction.name}};break;case l().IA.FunctionCallArgumentWrongType:o={...a().Xz.FunctionCallArgumentWrongType,values:{argumentType:d(t.argument.type.type),functionName:t.libraryFunction.name}};break;case l().IA.CallingFunctionWithUnknownArgument:{const e=Array.isArray(t.expectedParameter.type)?t.expectedParameter.type[0]:t.expectedParameter.type,n="expression"===e.type?"expression":d(e.type);o={...a().Xz.CallingFunctionWithUnknownArgument,values:{functionName:t.libraryFunction.name,expectedType:n}};break}case l().IA.MemberPropertyMismatchCollection:o={...a().Xz.MemberPropertyMismatchCollection,values:{propertyName:t.token.property}};break;case l().IA.MemberPropertyMissing:o={...a().Xz.MemberPropertyMissing,values:{propertyName:t.property}};break;case l().IA.MemberPropertyTargetNotBlock:o=a().Xz.MemberPropertyTargetNotBlock;break;case l().IA.MemberPropertyTypeInvalid:o={...a().Xz.MemberPropertyTypeInvalid,values:{propertyName:t.propertyName,propertyType:t.propertyType}};break;case l().IA.UndefinedIdentifier:o={...a().Xz.UndefinedIdentifier,values:{identifier:t.node.text}};break;case l().IA.InvalidPropCall:o={...a().Xz.InvalidPropCall,values:{propertyName:t.name}};break;case l().IA.InvalidContextCall:o={...a().Xz.InvalidContextCall,values:{variableName:t.name}};break;case l().IA.InvalidVariableCall:o={...a().Xz.InvalidVariableCall,values:{variableName:t.name}};break;case l().IA.UnifiedFunctionCannotFindFunction:o={...a().Xz.UnifiedFunctionCannotFindFunction,values:{functionName:t.name}};break;case l().IA.UnifiedFunctionNoArguments:o={...a().Xz.UnifiedFunctionNoArguments,values:{functionName:t.libraryFunction.name}};break;case l().IA.UnifiedFunctionTargetWrongType:o={...a().Xz.UnifiedFunctionTargetWrongType,values:{functionName:t.libraryFunction.name,targetType:d(t.expression.type.type)}};break;case l().IA.CallingFunctionWithUnknownTarget:{const e=Array.isArray(t.expectedParameter.type)?t.expectedParameter.type[0]:t.expectedParameter.type,n="expression"===e.type?"expression":d(e.type);o={...a().Xz.CallingFunctionWithUnknownTarget,values:{functionName:t.libraryFunction.name,expectedType:n}};break}case l().IA.CannotRelativelyCompareTypes:o={...a().Xz.CannotRelativelyCompareTypes,values:{lhsType:d(t.lhsType.type),rhsType:d(t.rhsType.type)}};break;case l().IA.CannotDoMathOnType:o={...a().Xz.CannotDoMathOnType,values:{lhsType:d(t.lhsType.type),rhsType:d(t.rhsType.type)}};break;case l().IA.UnaryMinusOnNonNumber:o={...a().Xz.UnaryMinusOnNonNumber,values:{type:d(t.expression.type.type)}};break;case l().IA.IdentifierExpected:o=a().Xz.IdentifierExpected;break;case l().IA.FunctionCallExpected:o={...a().Xz.FunctionCallExpected,values:{functionName:t.functionName}};break;case l().IA.RenamedIdentifier:o={...a().Xz.RenamedIdentifier,values:{identifier:t.identifier,renamedTo:t.renamedTo}};break;case l().IA.RemovedFunction:o={...a().Xz.RemovedFunction,values:{functionName:t.functionName,alternative:t.alternative}};break;case l().IA.ContextVariableNotBlockWithCollection:o={...a().Xz.ContextVariableNotBlockWithCollection,values:{valueId:t.token.contextValueId}};break;case l().IA.MissingPropertyOnContextVariable:o={...a().Xz.MissingPropertyOnContextVariable,values:{propertyName:t.property,valueId:t.token.contextValueId}};break;case l().IA.BlockPropertyTypeInvalid:o={...a().Xz.BlockPropertyTypeInvalid,values:{propertyName:t.propertyName}};break;case l().IA.DisallowedReturnType:{const n=t.allowedReturnTypes.map((t=>e.formatMessage((0,i().getHumanReadableType)(t)).toLocaleLowerCase()));o={...a().Xz.DisallowedReturnType,values:{allowedReturnType:e.formatList(n,{style:"long",type:"conjunction"}),allowedReturnTypeCount:t.allowedReturnTypes.length,returnType:e.formatMessage((0,i().getHumanReadableType)(t.returnType)).toLocaleLowerCase()}};break}case l().IA.CrossSpacePropertyNotSupported:o={...a().Xz.CrossSpacePropertyNotSupported};break;case l().IA.CalledFunctionOnEmptyValue:o={...a().Xz.CalledFunctionOnEmptyValue};break;default:(0,r().HB)(t)}return{...o,values:{...o.values,startOffset:t.node.startOffset,endOffset:t.node.endOffset+1}}}function f(e,t){let o;switch(t.type){case l().uW.MissingThisRow:o=a().X8.MissingThisRow;break;case l().uW.MissingSchemaPropertyOnThisRow:o={...a().X8.MissingSchemaPropertyOnThisRow,values:{propertyName:t.property}};break;case l().uW.ThisRowBlockPropertyMismatchCollection:o=a().X8.ThisRowBlockPropertyMismatchCollection;break;case l().uW.MissingContextVariable:o={...a().X8.MissingContextVariable,values:{valueId:t.valueId}};break;case l().uW.IdentifierNotFound:o={...a().X8.IdentifierNotFound,values:{identifier:t.node.text}};break;case l().uW.CannotRelativelyCompareTypes:o={...a().X8.CannotRelativelyCompareTypes,values:{lhsType:d(t.lhsType),rhsType:d(t.rhsType)}};break;case l().uW.CannotDoMathOnType:o={...a().X8.CannotDoMathOnType,values:{valueType:d(t.valueType)}};break;case l().uW.CannotCallNonFunction:o={...a().X8.CannotCallNonFunction,values:{calleeType:d(t.calleeType)}};break;case l().uW.UnifiedFunctionPropertyNotFound:o={...a().X8.UnifiedFunctionPropertyNotFound,values:{functionName:t.node.name}};break;case l().uW.LibraryFunctionExecutionError:const n=t.error instanceof l().x4?t.error:void 0;o=(null==n?void 0:n.info.type)===l().v3.DateInvalidDurationUnit?{...a().gW.DateInvalidDurationUnit,values:{functionName:t.libraryFunction.name,invalidUnit:n.info.invalidUnit}}:(null==n?void 0:n.info.type)===l().v3.CannotUseToNumberOnList?{...a().gW.CannotUseToNumberOnList}:(null==n?void 0:n.info.type)===l().v3.CannotRoundToNonInteger?{...a().gW.CannotRoundToNonInteger,values:{precision:n.info.precision}}:(null==n?void 0:n.info.type)===l().v3.CannotRoundToTooManyDecimalPlaces?{...a().gW.CannotRoundToTooManyDecimalPlaces,values:{precision:n.info.precision}}:(null==n?void 0:n.info.type)===l().v3.NumberFormatInvalid?{...a().gW.NumberFormatInvalid,values:{invalidFormat:n.info.invalidFormat}}:{...a().X8.LibraryFunctionExecutionError,values:{functionName:t.libraryFunction.name}};break;case l().uW.FunctionCallTooFewArguments:o={...a().X8.FunctionCallTooFewArguments,values:{functionName:t.libraryFunction.name}};break;case l().uW.FunctionCallUnexpectedArgument:o={...a().X8.FunctionCallUnexpectedArgument,values:{functionName:t.libraryFunction.name}};break;case l().uW.FunctionCallArgumentWrongType:o={...a().X8.FunctionCallArgumentWrongType,values:{functionName:t.libraryFunction.name,argumentType:d(t.argumentType)}};break;case l().uW.AccessingPropertyOnNonBlock:o=a().X8.AccessingPropertyOnNonBlock;break;case l().uW.MissingDataDependencyBlock:o={...a().X8.MissingDataDependencyBlock,values:{blockId:t.blockPointer.id}};break;case l().uW.MissingDataDependencyPerson:o={...a().X8.MissingDataDependencyPerson,values:{personId:t.personPointer.id}};break;case l().uW.MemberPropertyMismatchCollection:o=a().X8.MemberPropertyMismatchCollection;break;case l().uW.MissingPropertyOnSchemaForMemberProperty:o=a().X8.MissingPropertyOnSchemaForMemberProperty;break;case l().uW.UnaryMinusOnNonNumber:o={...a().X8.UnaryMinusOnNonNumber,values:{expressionType:d(t.expressionType)}};break;case l().uW.UnexpectedRecoveryNode:o=a().X8.UnexpectedRecoveryNode;break;case l().uW.UnexpectedError:o=a().X8.UnexpectedError;break;case l().uW.DepthExceeded:o=a().X8.DepthExceeded;break;case l().uW.CycleDetected:o=a().X8.CycleDetected;break;case l().uW.DownstreamParseFailure:o=a().X8.DownstreamParseFailure;break;case l().uW.MaxEvaluationTimeExceeded:o=a().X8.MaxEvaluationTimeExceeded;break;case l().uW.MissingSchemaPropertyOnCollection:o={...a().X8.MissingSchemaPropertyOnCollection,values:{collectionId:t.collectionId,propertyName:t.property}};break;case l().uW.ContextVariableWrongType:o={...a().X8.ContextVariableWrongType,values:{expectedType:t.expectedType,propertyType:t.resultType,valueId:t.valueId}};break;case l().uW.DisallowedValueType:{const n=t.allowedValueTypes.map((t=>e.formatMessage((0,i().getHumanReadableType)(t)).toLocaleLowerCase()));o={...a().Xz.DisallowedReturnType,values:{allowedValueType:e.formatList(n,{style:"long",type:"conjunction"}),allowedValueTypeCount:t.allowedValueTypes.length,valueType:e.formatMessage((0,i().getHumanReadableValueType)(t.expressionValue)).toLocaleLowerCase()}};break}case l().uW.TotalDependencyLimitExceeded:o={...a().X8.TotalDependencyLimitExceeded,values:{totalLoaded:t.totalLoaded,limit:t.limit}};break;case l().uW.PerFormulaDependencyLimitExceeded:o={...a().X8.PerFormulaDependencyLimitExceeded,values:{perFormulaLoaded:t.perFormulaLoaded,limit:t.limit}};break;default:(0,r().HB)(t)}return(0,s().li)(t)?{...o,values:{...o.values,startOffset:t.node.startOffset,endOffset:t.node.endOffset+1}}:o}function g(e){const t=null==e?void 0:e.values;return[n().cJ(e,"values"),t]}function b(e){return e.type===l().uW.DepthExceeded||e.type===l().uW.CycleDetected||e.type===l().uW.MaxEvaluationTimeExceeded||e.type===l().uW.LibraryFunctionExecutionError}},613016:(e,t,o)=>{o.d(t,{a:()=>r});var n=()=>o(907258);function r(){const{sidebarSpaceStore:e}=n().default.getState();return e?e.id:void 0}},621594:(e,t,o)=>{o.r(t),o.d(t,{exclamationMarkCircleSmallIcon:()=>i,iconDefinition:()=>r});o(296540);var n=o(474848);const r={viewBox:"0 0 16 16",fittedViewBox:"1.87 1.87 12.25 12.25",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M7.9 4.875a.625.625 0 0 0-.625.625V8a.625.625 0 1 0 1.25 0V5.5a.625.625 0 0 0-.625-.625m0 4.7a.725.725 0 1 0 0 1.45.725.725 0 0 0 0-1.45"}),(0,n.jsx)("path",{d:"M8 1.875a6.125 6.125 0 1 0 0 12.25 6.125 6.125 0 0 0 0-12.25M3.125 8a4.875 4.875 0 1 1 9.75 0 4.875 4.875 0 0 1-9.75 0"})]})},i=(0,o(340498).wt)("exclamationMarkCircleSmall",r,"small")},663199:(e,t,o)=>{o.d(t,{W:()=>i});var n=()=>o(341136),r=()=>o(72135);function i({intl:e,propertySchema:t,value:o}){const i=t&&((0,n().A)(t)||"formula"===t.type)?t.number_format??r().C4:r().C4;return r().ZV(o,i,e)}},730219:(e,t,o)=>{o.d(t,{A:()=>r});var n=function(e){return e[e.Preview=0]="Preview",e[e.Mention=1]="Mention",e[e.Link=2]="Link",e}(n||{});const r=n},738508:(e,t,o)=>{o.r(t),o.d(t,{cursorIcon:()=>i,iconDefinition:()=>r});o(296540);var n=o(474848);const r={viewBox:"0 0 20 20",fittedViewBox:"1.25 0 17.5 20",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("g",{className:"logo-light-mode",children:[(0,n.jsxs)("g",{clipPath:"url(#clip0_16020_205)",children:[(0,n.jsx)("path",{fill:"#757575",d:"m9.995 9.987 8.658 4.999a.6.6 0 0 1-.226.226l-8.092 4.672a.68.68 0 0 1-.68 0l-8.092-4.672a.6.6 0 0 1-.226-.226z"}),(0,n.jsx)("path",{fill:"#525252",d:"M9.995 0v9.987l-8.658 4.999a.6.6 0 0 1-.082-.309v-9.38c0-.22.117-.424.308-.534L9.655.09a.7.7 0 0 1 .34-.09"}),(0,n.jsx)("path",{fill:"#404040",d:"M18.652 4.989a.6.6 0 0 0-.225-.226L10.334.09A.7.7 0 0 0 9.995 0v9.987l8.658 4.999a.6.6 0 0 0 .083-.309v-9.38c0-.11-.03-.216-.083-.308"}),(0,n.jsx)("path",{fill:"#D9D9D9",d:"M18.047 5.339a.29.29 0 0 1 0 .29l-7.859 13.61c-.053.093-.193.055-.193-.05v-8.97a.4.4 0 0 0-.054-.201z"}),(0,n.jsx)("path",{fill:"#fff",d:"m18.047 5.339-8.106 4.68a.4.4 0 0 0-.147-.147L2.027 5.387c-.092-.053-.054-.193.052-.193h15.717c.111 0 .202.06.25.145"})]}),(0,n.jsx)("defs",{children:(0,n.jsx)("clipPath",{id:"clip0_16020_205",children:(0,n.jsx)("path",{fill:"#fff",d:"M1.255 0h17.49v20H1.256z"})})})]}),(0,n.jsxs)("g",{className:"logo-dark-mode",children:[(0,n.jsxs)("g",{clipPath:"url(#clip0_16020_213)",children:[(0,n.jsx)("path",{fill:"#6E6E6E",d:"m9.995 9.987 8.658 4.999a.6.6 0 0 1-.226.226l-8.092 4.672a.68.68 0 0 1-.68 0l-8.092-4.672a.6.6 0 0 1-.226-.226z"}),(0,n.jsx)("path",{fill:"#4A4A4A",d:"M9.995 0v9.987l-8.658 4.999a.6.6 0 0 1-.082-.309v-9.38c0-.22.117-.424.308-.534L9.655.09a.7.7 0 0 1 .34-.09"}),(0,n.jsx)("path",{fill:"#383838",d:"M18.652 4.989a.6.6 0 0 0-.225-.226L10.334.09A.7.7 0 0 0 9.995 0v9.987l8.658 4.999a.6.6 0 0 0 .083-.309v-9.38c0-.11-.03-.216-.083-.308"}),(0,n.jsx)("path",{fill:"#C9C9C9",d:"M18.047 5.339a.29.29 0 0 1 0 .29l-7.859 13.61c-.053.093-.193.055-.193-.05v-8.97a.4.4 0 0 0-.054-.201z"}),(0,n.jsx)("path",{fill:"#fff",d:"m18.047 5.339-8.106 4.68a.4.4 0 0 0-.147-.147L2.027 5.387c-.092-.053-.054-.193.052-.193h15.717c.111 0 .202.06.25.145"})]}),(0,n.jsx)("defs",{children:(0,n.jsx)("clipPath",{id:"clip0_16020_213",children:(0,n.jsx)("path",{fill:"#fff",d:"M1.255 0h17.49v20H1.256z"})})})]})]})},i=(0,o(340498).wt)("cursor",r,"default")},754199:(e,t,o)=>{function n(e){return/^(\+\d{1,2}[\s.-])?\(?\d{3}\)?[\s.-]\d{3}[\s.-]\d{4}$/.test(e)}function r(e){return/^[0-9 .()\-\+]{7,}$/.test(e)}o.d(t,{W:()=>n,e:()=>r})},766854:(e,t,o)=>{o.d(t,{H:()=>x,Q:()=>S});o(898992),o(672577);var n=()=>o(230711),r=()=>o(907258),i=()=>o(135168),a=()=>o(242422),l=()=>o(929219),s=()=>o(711339),c=()=>o(295633),d=()=>o(700500),u=()=>o(179034),p=()=>o(201980),m=()=>o(384944),f=()=>o(649813),g=()=>o(390650),b=()=>o(381678),v=()=>o(622811),y=()=>o(491848),k=()=>o(482871);function h(e,t,o){const r=(0,b()._)(e),i=null==r?void 0:r.id;if(!i||!o)return;if(!a().default.checkGate({gateName:"full_access_for_created_collection_pages"}))return;if(t.canAdmin())return;const l=t.getSpaceStore();return l&&(0,n().dp)(l,i).isMember()?[{role:"editor",type:"user_permission",user_id:i}]:void 0}function S(e){const{collectionContextStore:t,transaction:o}=e;return(0,y().w)({collectionContextStore:t,transaction:o}),x(e)}function x(e){var t,o,n;const{environment:b,collectionContextStore:y,groupsPointer:S,insertAtIndex:x,shouldCoerce:I,templateStore:T,transaction:C,from:M,tracker:w,inMemoryRecordCache:_,isKeyboard:A,title:P}=e,D=s().default.DO_NOT_USE_markLegacy("collections.add_item_lag");s().default.DO_NOT_USE_measureAfterNextFlushLegacy(D,{environment:b,getData:()=>({...g().kz(y),from:M.createBlock})});const F="collectionTypedView"===y.contextTypeFromStoreState,R=y.databaseTypeFromStoreState,B=y.collectionStoresStore.state,V=B.find((e=>e.canEdit()||e.canEditCollection()||e.canEditContentOnly()))||B[0],E=null===(t=(0,i().f)(V))||void 0===t?void 0:t.id,N=r().default.state.currentUserSettingsStore,L=F&&R&&E&&N&&[...N.getAllPreferredCollections(E),...N.getPreferredCollectionsOfType(E,R)]||[];let W;const O=S[0];if("group_header"===M.createBlock&&"location"===O.value.type){const e=O.value.value;if(e){W=B.find((t=>t.id===e.id&&(t.canEdit()||t.canEditCollection()||t.canEditContentOnly())))}}else W=function(e,t){for(const o of e){const e=t.find((e=>e.id===o&&(e.canEdit()||e.canEditCollection()||e.canEditContentOnly())));if(e)return e}}(L,B);const U=W??V,j=null==U?void 0:U.getSpaceId(),z=y.collectionViewStore(),H=y.getViewType(),X=m().Wv({environment:b,type:d().xd.page,inMemoryRecordCache:_,transaction:C,spaceId:j,tracker:w,permissions:h(b,U,j),properties:{title:(0,p().x9d)(P)}});if(!U||!z||!H)return{coercionSucceeded:!0,newStore:X};const $=null===(o=y.groupsStore.getGroupState(S))||void 0===o?void 0:o.groupUiParentStore;if(!$)return{coercionSucceeded:!0,newStore:X};const G=c().B.createChildStore($,{table:u().ev,id:X.id});T&&l().A.state.online&&f().TB({title:"template",environment:b,store:X,templateStore:T,isKeyboard:A??!1,isCreateIn:!1,transaction:C,from:M.initCollection??"collection_group_actions"});const Z=(0,v().j)({environment:b,store:X,collectionStore:U,collectionContextStore:y,groupsPointer:S,shouldCoerce:I,transaction:C}),J=(null===(n=y.groupsStore.getGroupState(S))||void 0===n||null===(n=n.reducerResultStore.state)||void 0===n?void 0:n.blockIds)||[],q=void 0!==x?x:J.length,Q=y.permissionScopesStore.state;if((a().default.checkGate({gateName:"can_create_pages_in_collection_permission"})?Q.canCreatePagesInCollection:Q.canEditContent)||F){const e=[...J.slice(0,q),G.id,...J.slice(q)];(0,k().z)({resultIds:e,collectionViewStore:z,collectionContextStore:y,transaction:C})}return{coercionSucceeded:Z,newStore:G}}},790785:(e,t,o)=>{o.r(t),o.d(t,{copyHtml:()=>c,copyString:()=>d});var n=()=>o(44551),r=()=>o(675133),i=()=>o(128933),a=()=>o(121946);const l=!1;function s(...e){l&&console.log("copyString:",...e)}function c(e){return u(e)}function d(e){return u(e)}async function u(e){const{environment:t,htmlValue:o,stringValue:l,copiedMessage:c,manualCopyMessage:d,manualCopyMessageValues:u,showCopyModal:p,copiedMessageValues:m}=e;function f(){a().A.setState({...a().A.state,active:!0,stringValue:l,manualCopyMessage:d,manualCopyMessageValues:u})}if(p)f();else try{var g;if(t.device.isElectron&&null!==n().electronApi&&void 0!==n().electronApi&&null!==(g=n().electronApi.clipboard)&&void 0!==g&&g.write){const e={text:l};o&&(e.html=o),s("electron:writing text to clipboard",e),await n().electronApi.clipboard.write(e)}else if("undefined"==typeof ClipboardItem)s("ClipboardItem is not supported, using navigator.clipboard.writeText",l),await navigator.clipboard.writeText(l);else{const e={"text/plain":new Blob([l],{type:"text/plain"})};o&&(e["text/html"]=new Blob([o],{type:"text/html"}));const t=new ClipboardItem(e);s("ClipboardItem is supported, using navigator.clipboard.write",t),await navigator.clipboard.write([t])}c&&i().D6({label:r().A.formatMessage(c,m)})}catch{f()}}},856197:(e,t,o)=>{o.d(t,{z:()=>I});o(944114),o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(581454);var n=()=>o(764880),r=()=>o(584262),i=()=>o(713998),a=()=>o(869190),l=()=>o(604995),s=()=>o(663199),c=()=>o(683259),d=()=>o(128713),u=()=>o(792071),p=()=>o(142748),m=()=>o(96330),f=()=>o(179034),g=()=>o(201980),b=()=>o(931075);const v=a().ZF;function y(e){return(0,c().vy)({...e,fromString:e=>e}).join("")}function k(e){const{textValue:t}=e;if(t){const o=[];for(const n of t)g().bHQ(n)||o.push(y({...e,textValue:[n]}));return o.join(", ")}return""}const h={[g().Ifu.Page]:({annotation:e,exportArgs:t})=>{const{getExportedPathToPage:o}=t,n=g().v55(e),r=(0,c()._z)({intl:t.intl,blockId:n,getRecordValue:t.getRecordValue,userTimeZone:t.userTimeZone}),i=o({toPageId:n});if(r&&i)return`${r} (${i})`},[g().Ifu.Collection]:({annotation:e,exportArgs:t})=>{var n;const i=g().TSJ(e);if(!i)return;const a=(0,c().R7)({intl:t.intl,collectionId:i.id,getRecordValue:t.getRecordValue,userTimeZone:t.userTimeZone}),l=(0,c().oD)({collectionPointer:i,getRecordValue:t.getRecordValue});return`${a} (${(0,o(938379).C)({collectionId:i.id,spaceId:t.root.spaceId,spaceDomain:void 0,parentCvbId:null==l||null===(n=l.getParentPointer())||void 0===n?void 0:n.id,domainBaseUrl:t.baseUrl,pageVisitSource:r().y8.Export})})`},[g().Ifu.SlackSpecialMention]:({annotation:e})=>`@${g().p5C(e)}`,[g().Ifu.ChatSelectionContext]:({annotation:e})=>g().$sA(e).text,[g().Ifu.CustomEmoji]:({annotation:e,exportArgs:t})=>{const{getRecordValue:o}=t,n=g().qS0(e);if(!n)return;const r=u().b4_.fromGetRecordValueFn(o)(n);return r?r.getRenderTitle():void 0},[g().Ifu.Comment]:({annotation:e,exportArgs:t})=>{const{getRecordValue:n,baseUrl:i}=t,a=u().b4_.fromGetRecordValueFn(n),l=g().MdE(e);if(!l)return;const s=a(l);if(!s)return;const c=s.getParentId(),d=s.getParentPointer(),m=(0,p().NJ)((0,p().Yn)(d,n));if(!m)return;const f=a(d);let b;if(f){const e=a(f.getParentPointer());b=e&&"table_row"===e.getType()?e.getParentId():f.getParentId()}return(0,o(921940).A)({pageId:m.id,scrollToBlockId:b,pageValue:m,baseUrl:i,discussionId:c,pageVisitSource:r().y8.Export})},[g().Ifu.Link]:({annotation:e,exportArgs:t})=>{const{getExportedPathToFile:n,getExportedPathToPage:r,navigableBlockId:i,baseUrl:a,publicDomainName:l}=t,s=g().cQR(e),c=(0,o(777447).lX)({url:s,baseUrl:a,publicDomainName:l});return c?r({toPageId:c}):n({fromBlockId:i,toFileURI:s})},[g().Ifu.User]:({annotation:e,exportArgs:t})=>{const{intl:n}=t,r=g().NcG(e),i=t.getRecordValue({table:o(798880).oo,id:r});if(i)return`@${(0,o(695608).c6)(n,i)}`},[g().Ifu.Bot]:({annotation:e,exportArgs:t})=>{const n=g().vjW(e),r=t.getRecordValue({table:o(824862).GP,id:n});if(r)return`@${(0,o(799288).Hg)(r)}`},[g().Ifu.Group]:({annotation:e,exportArgs:t})=>{const o=(0,c().Pf)({annotation:e,exportArgs:t});if(o)return o},[g().Ifu.Team]:({annotation:e,exportArgs:t})=>{const o=(0,c().nZ)({annotation:e,exportArgs:t});if(o)return o},[g().Ifu.ExternalObjectInstance]:({annotation:e,exportArgs:t})=>{var o;const n=g().T$c(e);return null===(o=t.getRecordValue({table:f().ev,id:n,spaceId:t.root.spaceId}))||void 0===o||null===(o=o.format)||void 0===o?void 0:o.original_url},[g().Ifu.LinkMention]:({annotation:e,exportArgs:t})=>{const{href:o}=g().q1R(e);return o},[g().Ifu.Date]:({annotation:e,exportArgs:t})=>{const{date_format:o,time_format:n,...r}=g().K7D(e);return`@${(0,a().ZF)({value:r,date_format:o,time_format:n,userTimeZone:t.userTimeZone,allowRelativeDates:!1,intl:t.intl})}`},[g().Ifu.Equation]:({annotation:e,exportArgs:t})=>{const o=(0,d().TG)(e),n=(0,d().oV)(e,t.getExportedPathToPage,t);return`${o}${g().U35(e)}${n}`},[g().Ifu.Place]:({annotation:e})=>(0,m().X1)(g().nG4(e)),[g().Ifu.Bold]:c().if,[g().Ifu.Italic]:c().if,[g().Ifu.Strike]:c().if,[g().Ifu.Code]:c().if,[g().Ifu.Highlight]:c().if,[g().Ifu.Discussion]:c().if,[g().Ifu.Underline]:c().if,[g().Ifu.Inserted]:c().if,[g().Ifu.Deleted]:c().if,[g().Ifu.TemporaryComment]:c().if,[g().Ifu.TemporaryCursor]:c().if,[g().Ifu.DeletionMarker]:c().if,[g().Ifu.TemporaryEquation]:c().if,[g().Ifu.TemporaryPage]:c().if,[g().Ifu.TemporaryCollection]:c().if,[g().Ifu.TemporaryInput]:c().if,[g().Ifu.TemporarySelection]:c().if,[g().Ifu.TemporaryFindHighlight]:c().if,[g().Ifu.TemporarySelectedFindHighlight]:c().if,[g().Ifu.TemplateVariable]:c().if,[g().Ifu.FormulaPageProperty]:c().if,[g().Ifu.FormulaContextValue]:c().if,[g().Ifu.FormulaError]:c().if,[g().Ifu.Citation]:c().if,[g().Ifu.TemporaryCitation]:c().if,[g().Ifu.SuggestionInsertText]:c().if,[g().Ifu.SuggestionRemoveText]:c().if,[g().Ifu.SuggestionAnnotate]:c().if,[g().Ifu.SuggestionUnannotate]:c().if,[g().Ifu.TemporaryNativeMABFilter]:c().if,[g().Ifu.TemporaryDictation]:c().if,[g().Ifu.TemporaryHighlight]:c().if,[g().Ifu.AssistantInstructionsCollection]:c().if,[g().Ifu.TemporaryCommentHighlight]:c().if,[g().Ifu.TemporarySuggestionUnderline]:c().if,[g().Ifu.SearchFilterCreatedTime]:c().if,[g().Ifu.SearchFilterLastEditedTime]:c().if,[g().Ifu.TemporarySearchFilter]:c().if,[g().Ifu.TitleOnly]:c().if,[g().Ifu.Sort]:c().if};function S(){}function x(){return Promise.resolve(void 0)}const I={blockRenderers:{text:S,header:S,sub_header:S,sub_sub_header:S,header_4:S,quote:S,bulleted_list:S,toggle:S,to_do:S,numbered_list:S,code:S,page:S,image:S,video:S,embed:S,bookmark:S,file:S,temporary_ui:S,edit_reference:S,tweet:S,maps:S,gist:S,framer:S,invision:S,mixpanel:S,drive:S,figma:S,loom:S,pdf:S,typeform:S,codepen:S,audio:S,divider:S,equation:S,collection_view:S,collection_view_page:S,column_list:S,column:S,factory:S,copy_indicator:S,breadcrumb:S,link_to_collection:S,link_to_page:S,table_of_contents:S,callout:S,whimsical:S,miro:S,abstract:S,sketch:S,excalidraw:S,replit:S,alias:S,transclusion_container:S,transclusion_reference:S,external_object_instance:S,table:S,table_row:S,tab:S,hex:S,deepnote:S,external_object_instance_page:S,button:S,ai_block:S,drawing:S,slide:S,personal_home_page:S,home_shortcuts:S,form:S,post:S,workflow:S,transcription:S,mail:S},asyncBlockRenderers:{text:x,header:x,sub_header:x,sub_sub_header:x,header_4:x,quote:x,bulleted_list:x,toggle:x,to_do:x,numbered_list:x,code:x,page:x,image:x,video:x,embed:x,bookmark:x,temporary_ui:x,edit_reference:x,file:x,tweet:x,maps:x,gist:x,framer:x,invision:x,mixpanel:x,drive:x,figma:x,loom:x,pdf:x,typeform:x,codepen:x,audio:x,divider:x,equation:x,collection_view:x,collection_view_page:x,column_list:x,column:x,factory:x,copy_indicator:x,breadcrumb:x,link_to_collection:x,link_to_page:x,table_of_contents:x,callout:x,whimsical:x,miro:x,abstract:x,sketch:x,excalidraw:x,replit:x,alias:x,transclusion_container:x,transclusion_reference:x,external_object_instance:x,table:x,table_row:x,tab:x,hex:x,deepnote:x,external_object_instance_page:x,button:x,ai_block:x,drawing:x,slide:x,personal_home_page:x,home_shortcuts:x,form:x,post:x,workflow:x,transcription:x,mail:x},annotationRenderers:h,propertyRenderers:{title:e=>y(e),text:y,select:e=>{const{textValue:t,propertySchema:o}=e,n=o.options||[];return i().L3(t,n)},multi_select:e=>{const{textValue:t,propertySchema:o}=e,n=o.options||[],r=i().o2(t,n);return r.sort(),r.join(", ")},status:e=>{const{textValue:t,propertySchema:o}=e;return i().RZ(t,o)},relation:e=>{const{textValue:t,propertySchema:o,exportArgs:n}=e;if("relation"!==o.type)return;const r=i().bG({relationValue:i().n(t),getRecordModel:u().b4_.fromGetRecordValueFn(n.getRecordValue),propertySchema:o,includeNoAccess:!0}),a=i().Ap(r);return k({...e,textValue:a})},rollup:e=>{const t=e.exportArgs.getRecordValue,n=e.exportArgs.formulasModule,r=u().Bj6.fromValue(f().ev,e.block),i=u().b4_.fromGetRecordValueFn(t);return o(568063).I({...e,block:r,getRecordModel:i,collectionRequestContext:{userId:void 0,userTimeZone:e.exportArgs.userTimeZone,depth:0,intl:e.exportArgs.intl,visitedProperties:new Set,resultCache:e.exportArgs.resultCache,regExpCache:e.exportArgs.regExpCache,formatDateCache:e.exportArgs.formatDateCache,experimentService:e.exportArgs.experimentService,collectionFeatureGates:e.exportArgs.collectionFeatureGates,getRelationEdgeList:void 0},formulasModule:n,spaceIdCreator:e.exportArgs.spaceIdCreator})},url:({textValue:e})=>g().k4p(e),email:({textValue:e})=>g().k4p(e),phone_number:({textValue:e})=>g().k4p(e),checkbox:({textValue:e})=>(0,o(657970).w)(e)?"Yes":"No",person:({textValue:e,exportArgs:t,propertySchema:n,block:r})=>{const{intl:i,getRecordValue:a}=t,l=u().Bj6.fromBlock(r),s=u().b4_.fromGetRecordValueFn(a),c=(0,o(363170).e)({textValue:e,propertySchema:n,blockCreatorPointer:l.getCreatedByPointer(),convertGroupPointersToBeComposite:!0});return o(496603).oE(c.map((e=>{if("space_permission_group"===e.table){const t=s(e);return(0,o(914462).n)({intl:i,permissionGroupModel:t})}const t=a(e),n=t&&u().Bj6.fromValue(e.table,t);return null==n?void 0:n.getDisplayName(i)}))).join(", ")},number:({exportArgs:e,property:t,schema:n,textValue:r})=>{const i=n[t],a=o(302322).M(r);if(!(0,o(534177).O9)(a))return;let l=!0;var c;i&&(0,o(341136).A)(i)&&(l=(null===(c=i.show_as)||void 0===c?void 0:c.showValue)??!0);return l?(0,s().W)({intl:e.intl,propertySchema:i,value:a}):void 0},date:({textValue:e,propertySchema:t,...n})=>{const r=n.exportArgs.userTimeZone,i=(0,o(187696).b)(e),{date_format:l,time_format:s}=t;if(i)return(0,a().ZF)({allowRelativeDates:!1,value:i,date_format:l,time_format:s,userTimeZone:r,intl:n.exportArgs.intl,displayInUserTimezone:n.exportArgs.displayInUserTimezone??!1,alwaysIncludeTimezone:!0})},file:k,formula:e=>{const{property:t,schema:n,block:r,exportArgs:i}=e,{userTimeZone:a,getRecordValue:l,intl:c,resultCache:d,regExpCache:p,formatDateCache:m,formulasModule:f,spaceIdCreator:g}=i;if(!f)return;const b=n[t],y=f.primitiveFormulaValueFromPropertySchema({schema:n,property:t,blockModel:u().Bj6.fromBlock(r),getRecordModel:u().b4_.fromGetRecordValueFn(l),intl:c,userTimeZone:a,depth:0,resultCache:d,regExpCache:p,formatDateCache:m,experimentService:i.experimentService,collectionFeatureGates:i.collectionFeatureGates,spaceIdCreator:g,getRelationEdgeList:void 0});return"boolean"==typeof y?y?"Yes":"No":(0,o(720665).Et)(y)?(0,s().W)({intl:i.intl,propertySchema:b,value:y}):(0,o(597777).kC)(y)?v({value:y,userTimeZone:a,allowRelativeDates:!1,intl:i.intl}):y},created_time:e=>{const{block:t,exportArgs:o}=e,{userTimeZone:n}=o;if(t.created_time)return v({allowRelativeDates:!1,value:(0,l().KQ)(t.created_time,n),userTimeZone:n,intl:o.intl})},last_edited_time:e=>{const{block:t,exportArgs:o}=e,{userTimeZone:n}=o;if(t.last_edited_time)return v({allowRelativeDates:!1,value:(0,l().KQ)(t.last_edited_time,n),userTimeZone:n,intl:o.intl})},created_by:e=>{const{block:t,exportArgs:o}=e,{getRecordValue:r,intl:i}=o;if(t.created_by_table&&t.created_by_id){const e=(0,n().xC)({getRecordValue:r,pointer:{table:t.created_by_table,id:t.created_by_id,spaceId:t.space_id}});if(e.asActor)return(0,n().lR)(i,e)}},last_edited_by:e=>{const{block:t,exportArgs:o}=e,{getRecordValue:r,intl:i}=o;if(t.last_edited_by_table&&t.last_edited_by_id){const e=(0,n().xC)({getRecordValue:r,pointer:{table:t.last_edited_by_table,id:t.last_edited_by_id,spaceId:t.space_id}});if(e.asActor)return(0,n().lR)(i,e)}},button:e=>"",auto_increment_id:({textValue:e,block:t,exportArgs:n})=>{const r=i().On(e),{getRecordValue:a}=n;if(void 0!==r){const e=u().Bj6.fromBlock(t),n=e.getParentTable();if(n!==o(519831).Vl)return;const i=a((0,o(715913).a)({spaceId:e.getSpaceId(),parentTable:n,parentId:e.getParentId()}));return(0,o(716016).H4)(null==i?void 0:i.record_key,r)}},last_visited_time:e=>"",location:e=>"",verification:({textValue:e,exportArgs:t})=>{const o=b().U1(e);if(!o)return"";const n=b().B2(o);return t.intl.formatMessage(b().D6(n.type))},place:({textValue:e})=>{const t=(0,m().eC)(e);return t?(0,m().X1)(t):""}}}},989616:(e,t,o)=>{o.d(t,{R:()=>i});o(581454);var n=()=>o(712453),r=()=>o(718957);function i(e,t=!1){if(t){const t=(0,r().BO)(e);if(t){const e={multiSelection:t,mode:"editing",forceExtendAnnotations:{}};return(0,n().O)(e)}}return e.map((e=>e.getTitleValue())).join("\n")}}}]);