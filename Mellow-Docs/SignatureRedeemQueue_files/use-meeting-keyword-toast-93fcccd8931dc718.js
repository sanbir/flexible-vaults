"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[28156],{25842:(e,t,n)=>{n.r(t),n.d(t,{useMeetingKeywordToast:()=>U,useMeetingKeywordToastEligibility:()=>z});n(898992),n(354520);var i=n(296540),o=()=>n(664594),s=()=>n(300474),a=()=>n(59226),r=()=>n(242422),g=()=>n(726637),d=()=>n(908006),l=()=>n(484714),m=()=>n(590526),u=()=>n(165358),c=()=>n(798880),f=()=>n(706021),_=()=>n(69708),p=()=>n(778078),M=()=>n(229833),y=()=>n(720665),v=()=>n(23420),w=()=>n(812182),h=()=>n(680977),b=()=>n(680074),K=()=>n(547149);var k=()=>n(854513),x=()=>n(192359),T=()=>n(541229),A=()=>n(486674),E=()=>n(29554),S=()=>n(528093),I=()=>n(564884);function B(e){const{environment:t,...n}=e;(0,I().u)({environment:t,event:{eventName:"ai_meeting_notes_entrypoint_cta",eventProperties:n}})}const C=3,N=1,R=(0,_().YK)({meeting:{id:"meetingKeyword.meeting",defaultMessage:"meeting"},oneOnOne:{id:"meetingKeyword.oneOnOne",defaultMessage:"1:1"},sync:{id:"meetingKeyword.sync",defaultMessage:"sync"},standup:{id:"meetingKeyword.standup",defaultMessage:"standup"},retro:{id:"meetingKeyword.retro",defaultMessage:"retro"},checkIn:{id:"meetingKeyword.checkIn",defaultMessage:"check-in"},huddle:{id:"meetingKeyword.huddle",defaultMessage:"huddle"},brainstorm:{id:"meetingKeyword.brainstorm",defaultMessage:"brainstorm"},workshop:{id:"meetingKeyword.workshop",defaultMessage:"workshop"},discussion:{id:"meetingKeyword.discussion",defaultMessage:"discussion"},call:{id:"meetingKeyword.call",defaultMessage:"call"},videoCall:{id:"meetingKeyword.videoCall",defaultMessage:"video call"},zoom:{id:"meetingKeyword.zoom",defaultMessage:"zoom"},kickoff:{id:"meetingKeyword.kickoff",defaultMessage:"kickoff"},debrief:{id:"meetingKeyword.debrief",defaultMessage:"debrief"},postmortem:{id:"meetingKeyword.postmortem",defaultMessage:"postmortem"},townHall:{id:"meetingKeyword.townHall",defaultMessage:"town hall"},touchBase:{id:"meetingKeyword.touchBase",defaultMessage:"touch base"},catchUp:{id:"meetingKeyword.catchUp",defaultMessage:"catch up"},interview:{id:"meetingKeyword.interview",defaultMessage:"interview"}});function U(){const e=(0,_().tz)(),t=(0,l().v3)(),n=(0,a().X)("adoption_ai_meeting_note_page_title_logging"),o=(0,a().X)("adoption_ai_meeting_note_page_title_landing_page"),{isEligible:s,isEligibleForLogging:g,matchedKeyword:c,titleValue:f}=z({isLoggingEnabled:n}),p=(0,m().K8)((()=>r().default.getEligibleGroup({experimentId:"adoption_ai_meeting_note_page_title",defaultGroup:"control",disableExposureLogging:!s})),[s]),y=!!s&&"toast"===p,T=g&&n,E=(0,i.useRef)(!1),S=(0,i.useRef)(!1),I=(0,i.useRef)(""),[C,N]=(0,i.useState)(!1),R=(0,m().K8)(A().a,[]);(0,i.useEffect)((()=>{const e=f||"";I.current!==e&&(""!==I.current&&(N(!0),E.current=!1,S.current=!1),I.current=e)}),[f]);const U=(0,i.useMemo)((()=>!!y&&(!!o||C)),[y,o,C]);(0,i.useEffect)((()=>{if(U&&!E.current){B({environment:t,action:"view",from:"ai_meeting_notes_page_title_toast",meeting_keyword:c,trigger_type:C?"user_typing":"landing_on_page"}),E.current=!0}}),[U,t,c,C]),(0,i.useEffect)((()=>{if(T&&!S.current){B({environment:t,action:"log",from:"ai_meeting_notes_page_title_toast",meeting_keyword:c,trigger_type:C?"user_typing":"landing_on_page"}),S.current=!0}}),[T,t,c,C]),(0,i.useEffect)((()=>{S.current=!1,E.current=!1,N(!1),I.current=""}),[R]),(0,i.useEffect)((()=>{U&&(w().Iz({id:"ai-meeting-notes-suggestion-toast",title:e.formatMessage({id:"aiMeetingNotes.toast.titleMeeting",defaultMessage:"Is this for a {keyword}?"},{keyword:c}),onUserDismiss:()=>{w().UW("ai-meeting-notes-suggestion-toast"),B({environment:t,action:"dismiss",from:"ai_meeting_notes_page_title_toast"})},message:e.formatMessage({id:"aiMeetingNotes.toast.message",defaultMessage:"Let Notion AI handle the notes. You can always type /meet anywhere on the page to get started."}),presentationType:"persistent",actions:{primary:{title:e.formatMessage({id:"aiMeetingNotes.toast.action.addNotes",defaultMessage:"Add AI Meeting Notes"}),onAction:async()=>{try{(await k().$.load()).appendTranscriptionBlockToPage({environment:t,from:"ai_meeting_notes_page_title_toast"}),d().default.afterNextFlush((()=>{let e=0;const n=()=>{if(!R||e>=30)return;e++;const i=(0,x().Ql)(R);if(i.length>0){const e=i[i.length-1];(0,v().B)([e.id],!0,t)}else setTimeout(n,100)};n()})),B({environment:t,action:"click",from:"ai_meeting_notes_page_title_toast"}),w().UW("ai-meeting-notes-suggestion-toast")}catch(e){u().log({level:"error",from:"useMeetingKeywordToast",type:"failed_to_create_transcription_block",error:(0,M().convertErrorToLog)(e)}),w().UW("ai-meeting-notes-suggestion-toast")}}},secondary:{title:e.formatMessage({id:"aiMeetingNotes.toast.action.dismiss",defaultMessage:"Dismiss"}),onAction:()=>{!function({environment:e,experimentId:t}){var n;const i=(0,b().R$)(e);if(!i)return;const o=null===(n=i.getSettings())||void 0===n?void 0:n.dismissed_adoption_feature_experiment;K().createAndCommit({environment:e,userAction:"userSettingsActions.setAdoptionFeatureExperimentDismissed",canUndo:!0,cellTarget:"main",perform:e=>{(0,h().m)({userSettingsStore:i,transaction:e,data:{dismissed_adoption_feature_experiment:{...o,[t]:!0}}})}})}({environment:t,experimentId:"adoption_ai_meeting_note_page_title"}),B({environment:t,action:"dismiss_permanently",from:"ai_meeting_notes_page_title_toast"}),w().UW("ai-meeting-notes-suggestion-toast")}}}}),function({environment:e,experimentId:t}){var n;const i=(0,b().R$)(e);if(!i)return;const o=null===(n=i.getSettings())||void 0===n?void 0:n.exposed_to_adoption_feature_experiment;K().createAndCommit({environment:e,userAction:"userSettingsActions.setAdoptionFeatureExperimentExposure",canUndo:!0,cellTarget:"main",perform:e=>{(0,h().m)({userSettingsStore:i,transaction:e,data:{exposed_to_adoption_feature_experiment:{...o,[t]:[...(null==o?void 0:o[t])??[],Date.now().toString()]}}})}})}({environment:t,experimentId:"adoption_ai_meeting_note_page_title"}))}),[U,e,t,c,R])}function z({isLoggingEnabled:e}){const t=(0,_().tz)(),n=(0,l().Y0)(),i=(0,l().v3)(),a=(0,m().K8)(A().a,[]),r=(0,m().K8)((()=>null==a?void 0:a.getTitleStore()),[a]),d=(0,s().r)(),u=(0,o().T)(),M=(0,S()._)({name:"ai_meeting_notes",spaceId:d??"",userId:u??"",amount:1}),v=(0,f().e2)(M),w=(0,m().K8)((()=>!(!a||!u)&&(a.getCreatedById()===u&&a.getCreatedByTable()===c().oo)),[a,u]),h=(0,m().K8)((()=>{if(r&&a)return(0,E().r4)(r.getValue(),a)}),[r,a]),K=(null==h?void 0:h.toLowerCase())||"",k=(0,m().K8)((()=>{if(!a)return!1;const e=a.getCreatedTime();return Math.floor((Date.now()-e)/y().nD)<=1}),[a]),I=[t.formatMessage(R.meeting),t.formatMessage(R.oneOnOne),t.formatMessage(R.sync),t.formatMessage(R.retro),t.formatMessage(R.checkIn),t.formatMessage(R.huddle),t.formatMessage(R.brainstorm),t.formatMessage(R.workshop),t.formatMessage(R.discussion),t.formatMessage(R.call),t.formatMessage(R.videoCall),t.formatMessage(R.zoom),t.formatMessage(R.standup),t.formatMessage(R.kickoff),t.formatMessage(R.debrief),t.formatMessage(R.postmortem),t.formatMessage(R.townHall),t.formatMessage(R.touchBase),t.formatMessage(R.catchUp),t.formatMessage(R.interview)],B=(e=>{if(!e)return[];const t=I.filter((t=>e.toLowerCase().includes(t.toLowerCase())));return t.length>0?t:(0,p().Ay)(e,I,(e=>e),{minScore:p().tb,normalizeFuzzyScore:!0})||[]})(K),U=B.length>0,z=B[0],L=(0,m().K8)((()=>{var e;const t=(0,b().R$)(i);if(!t||!t.isReady())return!0;const n=null===(e=t.getSettings())||void 0===e?void 0:e.exposed_to_adoption_feature_experiment,o=(null==n?void 0:n.adoption_ai_meeting_note_page_title)??[];if(o.length>=C)return!0;if(o.length>0){const e=parseInt(o[o.length-1],10);if(isNaN(e))return!1;const t=Date.now()-e;if(Math.floor(t/y().nD)<N)return!0}return!1}),[i]),D=(0,m().K8)((()=>{var e;const t=(0,b().R$)(i);if(!t||!t.isReady())return!1;const n=null===(e=t.getSettings())||void 0===e?void 0:e.dismissed_adoption_feature_experiment;return Boolean(null==n?void 0:n.adoption_ai_meeting_note_page_title)}),[i]),O=!h||!U||!v||!k||!e&&L||D||g().A.isMobile||n.isTablet,F=(0,m().K8)((()=>!(O||!a)&&(0,x().Ql)(a).length>0),[O,a]),V=(0,T().R)({includeVisible:!1}),$=Boolean(V);return{isEligible:Boolean(h&&U&&v&&k&&w&&!L&&!D&&!g().A.isMobile&&!n.isTablet&&!F&&!$),isEligibleForLogging:Boolean(h&&U&&v&&k&&w&&!D&&!g().A.isMobile&&!n.isTablet&&!F&&!$),matchedKeyword:z,titleValue:h}}},541229:(e,t,n)=>{n.d(t,{R:()=>g});n(944114),n(581454);var i=()=>n(907258),o=()=>n(590526),s=()=>n(192359),a=()=>n(964345),r=()=>n(748197);function g({includeVisible:e}){return(0,o().K8)((()=>{var t;const n=Object.values(a().Ay.state.passiveBlockMap).map((({rootBlockStore:e})=>e)),o=a().ei.state,g=[];o&&o.isTranscriptionBlock()&&g.push(o);for(const e of n)e.isTranscriptionBlock()&&g.push(e);const d=null===(t=i().default.state.currentUserStore)||void 0===t?void 0:t.id;if(d)for(const i of g){const t=(0,s().by)(i);if(i.pathIsDead()||"transcribing"!==t.state||t.transcriber_id!==d)continue;const n=r().c.getVisibilityStatus(i.id);if(e||!n)return i}}),[e])}}}]);