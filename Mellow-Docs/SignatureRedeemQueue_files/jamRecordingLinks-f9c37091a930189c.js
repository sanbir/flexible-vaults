"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[98213],{129961:(e,t,r)=>{function n(){const e=new EventTarget;return{addEventListener(t,r,n){e.addEventListener(t,r,n)},removeEventListener(t,r,n){e.removeEventListener(t,r,n)},dispatch:(t,r)=>e.dispatchEvent(new CustomEvent(t,{detail:r}))}}r.r(t),r.d(t,{Recorder:()=>p,addEventListener:()=>s,initialize:()=>u,isInitialized:()=>l,loadRecorder:()=>m,removeEventListener:()=>c});const i=e=>{const t=`jam:${e}`,r=n();let i=Number.parseInt(localStorage.getItem(t)??"0",10)||0;return window.addEventListener("storage",(e=>{if(e.storageArea===localStorage&&e.key===t){const t=Number.parseInt(e.newValue??"",10);Number.isNaN(t)||t===i||(i=t,r.dispatch("update",i))}})),{count:i,addEventListener:r.addEventListener.bind(r),removeEventListener:r.removeEventListener.bind(r),update(e){const n=i;switch(e){case"increment":i+=1;break;case"decrement":i-=1;break;default:i=e}return i<0&&(i=0),i!==n&&(localStorage.setItem(t,`${i}`),r.dispatch("update",i)),i}}},a=e=>{try{const t=new URL(e);return{recordingId:t.searchParams.get("jam-recording"),jamTitle:t.searchParams.get("jam-title")}}catch(e){}return null},o={isInitialized:!1},d=n(),s=d.addEventListener.bind(d),c=d.removeEventListener.bind(d),l=()=>o.isInitialized;let p=null;function u({recorderRefCounter:e=i("numRecorders"),...t}={}){if(o.isInitialized)throw new Error("SDK already initialized.");Object.assign(o,{isInitialized:!0,recorderRefCounter:e,config:t}),e.count>0?f("capture"):e.addEventListener("update",(()=>f("capture")),{once:!0}),window.addEventListener("popstate",n);const r={apply(e,t,r){const i=Reflect.apply(e,t,r);return n(),i}};function n(){if(p)return;const e=o.config?.parseJamData??a,t="string"==typeof o.config?.openImmediately?o.config.openImmediately:e(window.location.href)?.recordingId;t&&m({openImmediately:!1!==o.config?.openImmediately&&t})}history.pushState=new Proxy(history.pushState,r),history.replaceState=new Proxy(history.replaceState,r),n()}async function m({...e}={}){if(p)return p;if(!o.isInitialized)throw new Error("SDK not initialized. Call initialize() first.");if(({Recorder:p}=await f("recorder")),!p)throw new Error("Failed to load recorder script.");const{openImmediately:t,...r}={...o.config,...e},n="string"==typeof t?t:null;return p.initialize({...r,openImmediately:!n&&(t??!0)}),o.recorderRefCounter.update("increment"),window.addEventListener("pagehide",(()=>{o.recorderRefCounter.update("decrement")})),n&&p.open(n,r),p}async function f(e){const t=`https://js.jam.dev/${e}.js`,r=await import(t);if("recorder"===e){if(!r.Recorder)throw new Error("Loaded recorder script, but Recorder not found.");d.dispatch("loaded",{type:"script",name:e,Recorder:r.Recorder})}else d.dispatch("loaded",{type:"script",name:e});return r}}}]);