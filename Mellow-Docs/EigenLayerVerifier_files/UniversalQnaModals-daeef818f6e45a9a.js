"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[14358,97651],{27356:(e,t,n)=>{n.r(t),n.d(t,{UISpacePermissionGroupToken:()=>y});var s=n(296540),o=()=>n(726637),i=()=>n(484714),a=()=>n(590526),r=()=>n(401497),c=()=>n(942194),l=()=>n(784892),d=()=>n(437607),u=()=>n(914462),p=()=>n(69708),g=()=>n(100622),m=()=>n(284371),h=()=>n(848401),v=()=>n(580648),f=n(474848);function y(e){const{parentStore:t,style:n,format:y}=e,x=e.groupPointer.id,S=e.groupPointer.spaceId,_=(0,d().S4)({spacePermissionGroupId:x,spaceId:S}),j=(0,a().K8)((()=>{if(e.groupModel)return e.groupModel;if(!t)return;return c().C.createChildStore(t,_).getModel()}),[t,_,e.groupModel]),b=(0,i().Y0)(),{outerStyle:k,avatarWrapStyle:I}=(0,r().IS)((()=>({outerStyle:{display:"flex",alignItems:"center",minWidth:0},avatarWrapStyle:{width:"none",minHeight:"none",marginInlineEnd:6},badgeStyle:{borderRadius:4,background:g().Tj.legacyDefaultSelectColor,fontSize:o().A.isMobile?11:9,lineHeight:b.isAndroid?1.5:1,textTransform:"uppercase",letterSpacing:"0.04em"}})),[b]),A=(0,p().tz)(),C=(0,a().K8)((()=>(0,u().n)({intl:A,permissionGroupModel:j})),[A,j]),w=(0,s.useCallback)((e=>y===l().NY.Inline?(0,f.jsx)(v().o,{group:j,size:e}):(0,f.jsxs)("div",{style:k,children:[(0,f.jsx)("div",{style:I,children:(0,f.jsx)(v().o,{group:j,size:e})}),(0,f.jsx)("div",{style:{...m().RC},children:C})]})),[y,k,I,j,C]);return(0,f.jsx)(h().Ay,{...e,style:{margin:0,...n},renderAvatar:w})}},53528:(e,t,n)=>{n.d(t,{OH:()=>r,T2:()=>c,do:()=>l});var s=()=>n(597777),o=()=>n(869190),i=()=>n(604995),a=()=>n(416504);function r(e){const{dateTime:t,intl:n,shortenDateAndRange:s}=e,a=i().C6.toPersistedDate(t.valueOf());return o().ZF({value:a,allowRelativeDates:!0,intl:n,shortenDateAndRange:s,displayInUserTimezone:!0})}function c(e){const{dateTime:t,intl:n,userTimeZone:s,displayInUserTimezone:a,alwaysIncludeTimezone:r}=e,c=i().C6.toPersistedDateTime(t.valueOf(),t.zoneName);return o().ZF({value:c,allowRelativeDates:!0,intl:n,userTimeZone:s,displayInUserTimezone:a,alwaysIncludeTimezone:r})}function l(e){const{luxonRange:t,intl:n}=e,r=i().C6.toPersistedDateRange(t),c=o().ZF({value:r,allowRelativeDates:!1,shortenDateAndRange:!0,intl:n,displayInUserTimezone:!0}),l=t.end.setZone((0,a().P)()),d=o().fU({start_time:l.toFormat(s().GE),humanReadable:!1,intl:n});return n.formatMessage({id:"verification.timeRange",defaultMessage:"{formattedDateRange} at {formattedEndTime}"},{formattedDateRange:c,formattedEndTime:d})}},77279:(e,t,n)=>{n.r(t),n.d(t,{default:()=>o});class s extends(()=>n(757695))().Store{getInitialState(){return{discussionIdToExpansionStartPointMap:{}}}}const o=new s},79877:(e,t,n)=>{n.d(t,{A:()=>d});var s=n(296540),o=()=>n(597777),i=()=>n(869190),a=()=>n(604995),r=()=>n(416504),c=()=>n(100622),l=n(474848);const d=function(e){const t=(0,n(69708).tz)(),d=(0,n(396182).I)(),g=(0,s.useRef)(),m=(0,s.useCallback)((()=>{const t=e.value;if(!t)return;const s=a().q8(t,(0,r().P)());if(!s)return;const o=s.valueOf(),i=o-Date.now();i<0||i>n(720665).nD||g.current&&g.current.timestamp===o||(g.current&&clearTimeout(g.current.timer),g.current={timestamp:o,timer:setTimeout((()=>d("DateBox","DateBox/createReminderTimer")),i)})}),[d,e.value]),h=(0,s.useCallback)((()=>{g.current&&(clearTimeout(g.current.timer),g.current=void 0)}),[]);(0,s.useEffect)((()=>{m()}),[m]),(0,s.useEffect)((()=>()=>{h()}),[h]);const{value:v,withComma:f}=e,y=(0,n(590526).K8)((()=>v?(0,i().ZF)({value:v,date_format:e.dateFormat,time_format:e.timeFormat,userTimeZone:(0,r().P)(),allowRelativeDates:!0,intl:t,shortenDateAndRange:e.shortenDateAndRange,displayInUserTimezone:e.displayInUserTimezone,getToday:n(847109).x1}):void 0),[t,e.dateFormat,e.displayInUserTimezone,e.shortenDateAndRange,e.timeFormat,v]);if(!v)return null;const x=a().AA(v,(0,r().P)(),n(609679).locale);let S;if((0,o().Lh)(v)){const e=a().Zs(v,(0,r().P)());S=e?{color:c().Tj.red.text.accentPrimary}:{color:c().oZ.blue}}const _=(0,l.jsxs)(l.Fragment,{children:[y,(0,o().Lh)(v)?(0,l.jsx)(n(807449).I,{icon:n(472219).alarmSmallIcon,style:{display:"inline-block",width:"1.2em",marginInlineStart:5,marginInlineEnd:2,paddingBottom:3,verticalAlign:"middle"}}):void 0,f?", ":null]});return e.disableTooltip?(0,l.jsx)("div",{className:e.className,style:{...e.style,...S},children:_}):(0,l.jsx)(n(26697).m,{renderTooltip:()=>(0,l.jsxs)(l.Fragment,{children:[e.tooltipHeader,(0,l.jsxs)("div",{style:p(e.tooltipHeader),children:[u(x.start),x.end?` → ${u(x.end)}`:""]})]}),render:t=>(0,l.jsx)("div",{className:e.className,style:{...e.style,...S},...t,children:_}),placement:e.tooltipPlacement})};function u(e){return(0,i().eV)({value:e,preset:"medium"})}function p(e){return e?{color:c().Tj.text.inverseSecondary}:{}}},89956:(e,t,n)=>{n.d(t,{p:()=>o});n(296540);const s={viewBox:"0 0 16 16",fittedViewBox:"2.46 2.46 11.08 11.08",svg:(0,n(474848).jsx)("path",{d:"M3.088 2.463a.625.625 0 0 0-.625.625v4a.625.625 0 1 0 1.25 0V4.597l3.045 3.045a.625.625 0 0 0 .884-.884L4.597 3.713h2.49a.625.625 0 1 0 0-1.25zM9.244 8.36a.625.625 0 0 0-.883.884l3.042 3.043H8.912a.625.625 0 1 0 0 1.25h4c.345 0 .625-.28.625-.625v-4a.625.625 0 0 0-1.25 0v2.491z"})},o=(0,n(340498).wt)("arrowExpandDiagonalSmall",s,"small")},97059:(e,t,n)=>{n.d(t,{s:()=>o});n(296540);const s={viewBox:"0 0 16 16",fittedViewBox:"1.82 1.82 12.68 12.68",svg:(0,n(474848).jsx)("path",{d:"M8 1.825a.575.575 0 0 0-.575.575V4a.575.575 0 0 0 1.15 0V2.4A.575.575 0 0 0 8 1.825m4.367 1.809a.575.575 0 0 0-.814 0l-1.131 1.131a.575.575 0 1 0 .813.813l1.132-1.131a.575.575 0 0 0 0-.813m-7.92 0a.575.575 0 0 0-.813.813l1.13 1.131a.575.575 0 1 0 .814-.813zm3.248 3.071a.7.7 0 1 0-.99.99l.77.77.99-.99zm4.305.72a.575.575 0 0 0 0 1.15h1.6a.575.575 0 1 0 0-1.15zm-9.6 0a.575.575 0 1 0 0 1.15H4a.575.575 0 0 0 0-1.15zm11.895 5.88-5.37-5.37-.99.99 5.37 5.37a.7.7 0 0 0 .99-.99m-8.717-2.883a.575.575 0 0 0-.813 0l-1.131 1.131a.575.575 0 1 0 .813.813l1.131-1.131a.575.575 0 0 0 0-.813M8 11.425a.575.575 0 0 0-.575.575v1.6a.575.575 0 1 0 1.15 0V12A.575.575 0 0 0 8 11.425"})},o=(0,n(340498).wt)("magicWandSmall",s,"small")},108184:(e,t,n)=>{n.r(t),n.d(t,{COMPLETION_THROTTLE:()=>b,PREVIEW_STEP_DELAY:()=>k,maybeUpdateAIUsageEligibilityStoreV2:()=>w,maybeUpdateAiEligibility:()=>C,postProcessAICreatedStores:()=>A,showCompletionErrorWithCode:()=>I,wrapTemporaryBlocksInList:()=>T});n(18107),n(967357);var s=()=>n(242422),o=()=>n(675133),i=()=>n(128933),a=()=>n(770063),r=()=>n(878126),c=()=>n(165358),l=()=>n(179034),d=()=>n(427419),u=()=>n(720665),p=()=>n(769864),g=()=>n(722101),m=()=>n(384944),h=()=>n(274873),v=()=>n(412669),f=()=>n(556122),y=()=>n(594794),x=()=>n(668721),S=()=>n(685377),_=()=>n(661077),j=()=>n(96563);const b=300,k=250;function I(e){const t=o().A.getIntl();return 451===e?i().D6({label:t.formatMessage({id:"completionActions.moderationError",defaultMessage:"AI does not allow content that is harmful or illegal. Please revise your input and try again. (451)"})}):413===e?i().D6({label:t.formatMessage({id:"completionActions.promptOrAttachmentTooLarge",defaultMessage:"Query or attachment is too large. Please revise your input and try again. (413)"})}):502===e||503===e||504===e?i().D6({label:t.formatMessage({id:"completionActions.providerError",defaultMessage:"We’re experiencing issues with our AI provider. Try again in a few minutes. ({errorCode})"},{errorCode:e})}):void i().D6({label:t.formatMessage({id:"completionActions.genericError",defaultMessage:"AI is temporarily unavailable. Try again in a few minutes. ({errorCode})"},{errorCode:e})})}function A(e,t){for(const n of t)h().In({environment:e,blockStore:n})}async function C(e,t,n){let o;if(s().default.checkGate({gateName:"usage_based_pricing_pfa_checks_purchased_credits_enabled"}))return void(await w(e,t,n));s().default.checkGate({gateName:"usage_based_pricing_alpha_enabled"})&&w(e,t,n).catch((e=>{c().log({level:"error",from:"ai.completionActions",type:"maybeUpdateAIUsageEligibilityStoreV2Error",spaceId:t,error:e})}));const i=f().TI();if(i.debug)o=402!==i.showErrorCode;else{const s=x().o.getState();if(s&&s.isEligible&&"unlimited"===s.type&&!n){const e=s.lastUpdatedAt;if(Date.now()-e<10*u().Xb)return}const i=await p().callCellCompatibleApi({eventName:"getAIUsageEligibility",environment:e,data:{spaceId:t},cellNavigation:{cellId:void 0,spaceId:t}});if("success"===i.type){o=i.data.isEligible,o&&v().K.state&&v().K.setState(!1);const e=!1===(null==s?void 0:s.isEligible)&&(null==s?void 0:s.requestedAccess),t=i.data.researchModeUsage??0;x().o.setState({...i.data,lastUpdatedAt:Date.now(),researchModeUsage:t,...!1===i.data.isEligible&&{requestedAccess:e}})}}void 0!==o&&_().P.setState(o)}async function w(e,t,n){const s=await r().T.awaitData(e,{spaceId:t}),o=S().y.getData(e,{spaceId:t});if(s){if(o&&(0,d().Hg)(s)&&!n){const e=o.lastUpdatedAt;if(Date.now()-e<10*u().Xb)return}await(0,j().y3)(e,t)}}function T(e){var t;const{environment:n,stores:s,listId:o,inMemoryRecordCache:i,transaction:r}=e,c=(null===(t=s.at(0))||void 0===t?void 0:t.getSpaceId())??r.spaceId,d=new(a().pm)({environment:n,pointer:{table:l().ev,id:o||(0,y().Z1)({environment:n,table:l().ev,spaceId:c}),spaceId:c},recordStoreOptions:{inMemoryRecordCache:i,userId:n.currentUser.id},path:["content"]});for(const a of s)g().BC({parentStore:d,appendStore:a,transaction:r}),m().zv({store:a,data:{parent_id:d.id,parent_table:d.table,alive:!0},transaction:r});return d}},147294:(e,t,n)=>{n.d(t,{Ee:()=>h,J1:()=>u,oG:()=>p});n(296540);var s=()=>n(907258),o=()=>n(59226),i=()=>n(590526),a=()=>n(401497),r=()=>n(970236),c=()=>n(69708),l=n(474848);const d={define_variables_automation_action:{launchDateMs:17277408e5,expiryDateMs:1738368e6},passkey_setting:{launchDateMs:1729101727e3,expiryDateMs:1738432882e3},publish_site_settings_embed_page:{launchDateMs:1736208e6,expiryDateMs:1743984e6},generalized_recurrence_automations:{launchDateMs:17365536e5,expiryDateMs:17460576e5},ai_page_translation_topbar_more_action:{launchDateMs:1740451280830,expiryDateMs:17434656e5},verification:{launchDateMs:1740096e6,expiryDateMs:174375e7},notion_ai_workspace_settings:{launchDateMs:17424288e5,expiryDateMs:17550432e5},notion_mail_launch_modal:{launchDateMs:17446752e5,expiryDateMs:17525376e5},notion_mail_launch_modal_2:{launchDateMs:17446752e5,expiryDateMs:17578944e5},ui_doc_example:{launchDateMs:19249056e5,expiryDateMs:19249056e5},collection_property_permissions:{launchDateMs:17433792e5,expiryDateMs:17671392e5},salesforce_sync_unfurling_option:{launchDateMs:17443296e5,expiryDateMs:17538336e5},personal_home_sidebar_item:{launchDateMs:17470944e5,expiryDateMs:175392e7},collection_property_reminder:{launchDateMs:1751958e6,expiryDateMs:17552628e5},get_notified_onboarding_tooltip:{launchDateMs:17520228e5,expiryDateMs:17591904e5},conditional_color_feature:{launchDateMs:17537472e5,expiryDateMs:17563392e5},web_clipper_new_tab_settings:{launchDateMs:17471808e5,expiryDateMs:18149184e5},my_meetings:{launchDateMs:17578944e5,expiryDateMs:17657568e5},workspace_connections_tab:{launchDateMs:17578944e5,expiryDateMs:18149184e5},external_agents_tab:{launchDateMs:17578944e5,expiryDateMs:18149184e5},permissions_tab:{launchDateMs:17578944e5,expiryDateMs:18149184e5}};function u({style:e}){const t=(0,a().IS)((()=>({badge:{letterSpacing:0,whiteSpace:"nowrap",width:"fit-content",...e}})),[e]);return(0,l.jsx)(r().E,{color:"blue",style:t.badge,content:(0,l.jsx)(c().sA,{id:"newBadgeComponent.label",defaultMessage:"New"})})}function p(e){return(0,i().K8)((()=>{const{launchDateMs:t,expiryDateMs:n}=d[e],{currentUserSettingsStore:o}=s().default.state;if(o&&o.isReady()){var i;const e=null===(i=o.getSettings())||void 0===i?void 0:i.signup_time;if(e&&e>t)return!1}return Date.now()<=n}),[e])}function g({style:e,newBadgeKey:t}){return p(t)?(0,l.jsx)(u,{style:e}):null}function m({style:e,newBadgeKey:t}){return(0,o().X)(t)?(0,l.jsx)(u,{style:e}):null}function h(e){return e.didUserEngage?null:"feature_gate"===e.keyType?(0,l.jsx)(m,{...e}):(0,l.jsx)(g,{...e})}},158115:(e,t,n)=>{n.r(t),n.d(t,{arrowChevronSingleRightFillSmallIcon:()=>o,iconDefinition:()=>s});n(296540);const s={viewBox:"0 0 16 16",fittedViewBox:"5.54 2.94 5.81 10.11",directional:!0,svg:(0,n(474848).jsx)("path",{d:"M11.13 8.53a.75.75 0 0 0 0-1.06L6.81 3.15a.75.75 0 0 0-1.06 1.06L9.54 8l-3.79 3.79a.75.75 0 0 0 1.06 1.06z"})},o=(0,n(340498).wt)("arrowChevronSingleRightFillSmall",s,"fillSmall")},170350:(e,t,n)=>{n.r(t),n.d(t,{filterIcon:()=>o,iconDefinition:()=>s});n(296540);const s={viewBox:"0 0 20 20",fittedViewBox:"2.37 4.87 15.25 10.25",svg:(0,n(474848).jsx)("path",{d:"M3 4.875a.625.625 0 1 0 0 1.25h14a.625.625 0 1 0 0-1.25zm2.125 5.742h9.75a.625.625 0 1 0 0-1.25h-9.75a.625.625 0 1 0 0 1.25m1.5 3.883c0-.345.28-.625.625-.625h5.5a.625.625 0 1 1 0 1.25h-5.5a.625.625 0 0 1-.625-.625"})},o=(0,n(340498).wt)("filter",s,"default")},173783:(e,t,n)=>{n.d(t,{A:()=>r});n(296540);var s=()=>n(807449),o=()=>n(888867),i=()=>n(497577),a=n(474848);function r(e){const t=(0,i().E)(e);return(0,a.jsx)("div",{style:t.iconContainer,children:(0,a.jsx)(s().I,{icon:o().s,size:t.icon.width,colorVariant:"secondary"})})}},175882:(e,t,n)=>{n.r(t),n.d(t,{exclamationMarkTriangleSmallIcon:()=>i,iconDefinition:()=>o});n(296540);var s=n(474848);const o={viewBox:"0 0 16 16",fittedViewBox:"1.49 1.87 13.01 11.75",svg:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("path",{d:"M7.9 5.281a.625.625 0 0 0-.625.625v2.5a.625.625 0 0 0 1.25 0v-2.5a.625.625 0 0 0-.625-.625m0 4.7a.725.725 0 1 0 0 1.45.725.725 0 0 0 0-1.45"}),(0,s.jsx)("path",{d:"M9.58 2.788c-.702-1.217-2.458-1.217-3.16 0l-4.677 8.1c-.702 1.216.176 2.737 1.58 2.737h9.354c1.405 0 2.283-1.52 1.58-2.738zm-2.078.625a.575.575 0 0 1 .996 0l4.677 8.1a.575.575 0 0 1-.498.862H3.324a.575.575 0 0 1-.498-.863z"})]})},i=(0,n(340498).wt)("exclamationMarkTriangleSmall",o,"small")},224682:(e,t,n)=>{n.d(t,{m:()=>o});class s extends(()=>n(757695))().Store{getInitialState(){return{type:"uninitialized"}}isWriting(){return"filling"===this.state.type&&!this.state.haveAllBlocksCompletedAutofill&&!this.state.didInterruptStreaming}setIsWriting(e){const{propertySchema:t,stores:s,sessionIdForAnalytics:o,collectionId:i}=e,a=o||n(206267).JW();return this.setState({type:"filling",propertySchema:t,collectionId:i,numBlocksToAutofill:s.length,numBlocksAutofilled:0,sessionId:a,didInterruptStreaming:!1,haveAllBlocksCompletedAutofill:!1}),a}}const o=new s},253447:(e,t,n)=>{n.d(t,{F:()=>o});var s=()=>n(963575);function o(e,t){if(e)return e;switch(t){case"large":return s().A.card.desktop.large.height;case"small":return s().A.card.desktop.small.height;default:return s().A.card.desktop.medium.height}}},271232:(e,t,n)=>{n.d(t,{t:()=>i});var s=n(296540),o=n(474848);const i=s.memo((function(e){const{coverHeight:t,coverSizeFormat:s,emptyGalleryCoverStyle:i}=e,a=(0,n(401497).IS)((()=>({container:{height:(0,n(253447).F)(t,s),...i}})),[t,s,i]);return(0,o.jsx)("div",{style:a.container})}))},343733:(e,t,n)=>{n.d(t,{Q:()=>o});var s=()=>n(314529);function o(e,t){(0,s().DO_NOT_USE_trackLegacy)(e,"click_upgrade_button",t)}},358006:(e,t,n)=>{n.d(t,{z:()=>a});n(296540);var s=()=>n(79926),o=n(474848);const i=new(s().O2)("CollectionItemCover",(async()=>{const{CollectionItemCover:e}=await n.e(79883).then(n.bind(n,873718));return{CollectionItemCover:e}})),a=(0,s()._h)(i,(e=>e.CollectionItemCover),{renderLoading:(e,t)=>{const{coverHeight:s,coverSizeFormat:i,emptyGalleryCoverStyle:a,showEmptyGalleryCover:r}=t;return r?(0,o.jsx)(n(271232).t,{coverHeight:s,coverSizeFormat:i,emptyGalleryCoverStyle:a}):null}})},381553:(e,t,n)=>{n.d(t,{Y:()=>i});n(296540);var s=n(474848);const o={viewBox:"0 0 16 16",fittedViewBox:"2.37 2.37 11.25 11.25",svg:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("path",{d:"M7.053 6.407a.643.643 0 1 0 0 1.286.643.643 0 0 0 0-1.286m1.894 0a.643.643 0 1 0 0 1.286.643.643 0 0 0 0-1.286m1.893 0a.643.643 0 1 0 0 1.286.643.643 0 0 0 0-1.286M5.159 8.3a.643.643 0 1 0 0 1.287.643.643 0 0 0 0-1.286M7.053 8.3a.643.643 0 1 0 0 1.287.643.643 0 0 0 0-1.286M8.947 8.3a.643.643 0 1 0 0 1.287.643.643 0 0 0 0-1.286M10.84 8.3a.643.643 0 1 0 0 1.287.643.643 0 0 0 0-1.286m-5.681 1.894a.643.643 0 1 0 0 1.286.643.643 0 0 0 0-1.286m1.894 0a.643.643 0 1 0 0 1.286.643.643 0 0 0 0-1.286m1.894 0a.643.643 0 1 0 0 1.286.643.643 0 0 0 0-1.286"}),(0,s.jsx)("path",{d:"M4.25 2.375c-1.036 0-1.875.84-1.875 1.875v7.5c0 1.036.84 1.875 1.875 1.875h7.5c1.036 0 1.875-.84 1.875-1.875v-7.5c0-1.036-.84-1.875-1.875-1.875zm-.625 9.375V5.632h8.75v6.118c0 .345-.28.625-.625.625h-7.5a.625.625 0 0 1-.625-.625"})]})},i=(0,n(340498).wt)("viewCalendarSmall",o,"small")},383567:(e,t,n)=>{n.d(t,{F:()=>i});n(296540);var s=n(474848);const o={viewBox:"0 0 20 20",fittedViewBox:"3.26 1.98 16.32 17.52",svg:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("path",{d:"M15.825 12a3.75 3.75 0 1 1-.001 7.501 3.75 3.75 0 0 1 0-7.501m0 1.325a.55.55 0 0 0-.55.55V15.2H13.95a.55.55 0 0 0-.001 1.1h1.326v1.325a.55.55 0 0 0 1.1 0V16.3h1.324a.55.55 0 0 0 0-1.1h-1.325v-1.325a.55.55 0 0 0-.55-.55M9.702 5.022a3.918 3.918 0 0 1 6.742.036.626.626 0 0 1-1.08.63 2.667 2.667 0 0 0-4.59-.023L5.376 14.68l4.19.678a.626.626 0 0 1-.2 1.235l-5.1-.827a.625.625 0 0 1-.437-.938z"}),(0,s.jsx)("path",{d:"M10.912 8.094a1.178 1.178 0 1 1 2.326.377 1.178 1.178 0 0 1-2.326-.377M4.7 7.087a1.178 1.178 0 1 1 2.327.377A1.178 1.178 0 0 1 4.7 7.087M3.488 2.985a3.92 3.92 0 0 1 5.572.357.625.625 0 0 1-.944.818 2.67 2.67 0 0 0-3.796-.243.625.625 0 1 1-.832-.932"})]})},i=(0,n(340498).wt)("aiFacePlus",o,"default")},398544:(e,t,n)=>{n.r(t),n.d(t,{arrowLeftRightSmallIcon:()=>o,iconDefinition:()=>s});n(296540);const s={viewBox:"0 0 16 16",fittedViewBox:"2.48 1.67 11.03 12.66",svg:(0,n(474848).jsx)("path",{d:"M2.672 4.651a.625.625 0 0 0 0 .884l2.799 2.799a.625.625 0 1 0 .883-.884l-1.73-1.732h8.262a.625.625 0 1 0 0-1.25H4.623l1.731-1.73a.625.625 0 0 0-.883-.885zm-.182 6.256c0 .345.28.625.624.625h8.263l-1.731 1.73a.625.625 0 0 0 .883.885l2.799-2.798a.625.625 0 0 0 0-.884L10.53 7.667a.625.625 0 0 0-.884.883l1.73 1.732H3.115a.625.625 0 0 0-.625.625"})},o=(0,n(340498).wt)("arrowLeftRightSmall",s,"small")},427636:(e,t,n)=>{n.d(t,{A:()=>i});n(296540);var s=()=>n(100622),o=n(474848);const i=function(e){const{botStore:t,avatarSize:i,shouldShowBadge:a,style:r,inline:c}=e,l=(0,n(69708).tz)(),d=(0,n(484714).Y0)(),u=(0,n(590526).K8)((()=>null==t?void 0:t.getDisplayName(l)),[t,l]),{outerStyle:p,avatarWrapStyle:g,badgeStyle:m}=(0,n(401497).IS)((()=>({outerStyle:{display:"flex",alignItems:"center",minWidth:0,...r},avatarWrapStyle:c?{width:"none",minHeight:"none",marginInlineEnd:6}:{marginInlineEnd:6},badgeStyle:{padding:"2px 6px",borderRadius:4,color:s().Tj.text.secondary,background:s().Tj.legacyDefaultSelectColor,fontSize:n(726637).A.isMobile?11:9,lineHeight:d.isAndroid?1.5:1,textTransform:"uppercase",letterSpacing:"0.04em",marginInlineStart:8,marginTop:1}})),[r,c,d]);return(0,o.jsxs)("div",{style:p,children:[(0,o.jsx)("div",{style:g,children:(0,o.jsx)(n(256863).A,{botStore:t,size:i})}),(0,o.jsx)("div",{style:{...n(284371).RC},children:u}),a?(0,o.jsx)("div",{style:m,children:"Bot"}):void 0]})}},438177:(e,t,n)=>{function s(e){const t=e.getSubscriptionTier();return"plus"===t||"business"===t||"enterprise"===t}n.d(t,{o:()=>s})},448693:(e,t,n)=>{n.d(t,{Ay:()=>S,t_:()=>_,v7:()=>j});n(296540);var s=()=>n(484714),o=()=>n(590526),i=()=>n(34977),a=()=>n(457205),r=()=>n(849255),c=()=>n(764880),l=()=>n(784892),d=()=>n(534177),u=()=>n(883701),p=()=>n(427636),g=()=>n(256863),m=()=>n(848401),h=()=>n(994006),v=()=>n(453697),f=n(474848);function y(e){const t=(0,s().v3)(),{actor:n,format:c,hasTooltip:y,tooltipHeader:S,hasPersonHoverCard:_,spaceStore:j}=e,b=(0,o().K8)((()=>{const e=n.asActor;if(e)return(0,u().J)(t,e)}),[n,t]);return(0,f.jsx)(m().Ay,{...e,renderAvatar:e=>{if(b)return b instanceof a().v?c===l().NY.Inline?(0,f.jsx)(g().A,{botStore:b,size:e,style:x}):(0,f.jsx)(p().A,{botStore:b,avatarSize:e,inline:!0,style:x}):b instanceof r().L?c===l().NY.Inline?(0,f.jsx)(v().A,{userStore:b,size:e,avatarShouldShowShadow:!1,hasTooltip:y??!0,style:x,tooltipHeader:S,hasPersonHoverCard:_}):(0,f.jsx)(h().A,{userStore:b,avatarSize:e,inline:!0,hasTooltip:y,hasPersonHoverCard:_,style:x,tooltipHeader:S,spaceStore:j}):void(b instanceof i().p||(0,d().HB)(b))}})}const x={minWidth:0};y.Format=l().NY;const S=y;function _(e){const{userValue:t,...n}=e,s=(0,c().MR)(t);return(0,f.jsx)(y,{actor:s,...n})}function j(e){const{botValue:t,...n}=e;return(0,f.jsx)(y,{actor:(0,c().oC)(t),hasPersonHoverCard:!1,...n})}_.Format=m().mI,j.Format=m().mI},497577:(e,t,n)=>{n.d(t,{E:()=>i});var s=()=>n(401497),o=()=>n(100622);function i(e){const{size:t,style:n}=e;return(0,s().IS)((()=>({icon:{width:.6*t,height:.6*t,fill:o().Tj.text.secondary},iconContainer:{width:t,height:t,borderRadius:"100%",background:o().Tj.border.secondaryTranslucent,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,...n}})),[t,n])}},541235:(e,t,n)=>{n.d(t,{Ud:()=>a,YD:()=>i,c$:()=>s,q_:()=>o});const s={"sprints-onboarding":{steps:[{id:"current-sprint-view-tooltip"},{id:"sprint-task-tooltip"},{id:"complete-sprint-button-tooltip"}]},"enhanced-qna-onboarding":{steps:[{id:"find-in-tooltip"},{id:"mention-tooltip"}]},"jira-sync-onboarding":{steps:[{id:"all-projects-tooltip"},{id:"all-issues-tooltip"},{id:"database-views-and-filters-tooltip"},{id:"settings-to-setup-projects-and-issues"}]},"project-management-import-onboarding":{steps:[{id:"your-teamspace-tooltip"},{id:"all-projects-tooltip"},{id:"navigate-to-project-tasks-tooltip"},{id:"project-customization-tooltip"},{id:"related-tasks-database-views-tooltip"}]},"ai-comment-onboarding":{steps:[{id:"ai-comment-onboarding-tooltip"}]},database_onboarding:{steps:[{id:"database_onboarding_status_property_tooltip"},{id:"database_onboarding_add_property_tooltip"},{id:"database_onboarding_database_page_tooltip"},{id:"database_onboarding_board_view_tooltip"}]},"new-user-home-workspace-tour":{steps:[{id:"teamspaces"}]}},o="completed",i="dismissed";function a(e,t){return null==t?void 0:t[e]}},556122:(e,t,n)=>{n.d(t,{QJ:()=>g,TI:()=>l});n(944114),n(581454);var s=()=>n(726637),o=()=>n(763824);let i=0;const a="clipboard",r={debug:Boolean(s().A.isDevelopingInAirplaneMode),responseText:a,showErrorCode:!1,delayBetweenChunks:20,chunkSize:5,numLoremIpsums:3},c="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec porta auctor sem vel efficitur. Vivamus efficitur eros sed erat efficitur efficitur. Vivamus et augue vel est efficitur efficitur.";function l(){return r}function d(e){return{async*[Symbol.asyncIterator](){for(const t of e)await(0,o().wR)(r.delayBetweenChunks),yield t}}}function u(e,t){const n=Math.ceil(e.length/t),s=new Array(n);for(let o=0,i=0;o<n;++o,i+=t)s[o]=e.substr(i,t);return s}function p(e){return e.map((e=>({type:"success",p:"padding",completion:e,inferenceId:"mock"})))}async function g({environment:e,data:t}){console.log("Retrieving fake completion for data",t);const{context:n}=t,o=n.selectedText,l=[];let{responseText:g}=r;if(g===a&&(g=await async function(){try{return await navigator.clipboard.readText()}catch(e){return}}()??"Unable to retrieve clipboard text."),void 0===g&&(l.push({type:"success",p:"padding",completion:"\n",inferenceId:"mock"},{type:"success",p:"padding",completion:"this is ",inferenceId:"mock"},{type:"success",p:"padding",completion:"fake ",inferenceId:"mock"},{type:"success",p:"padding",completion:`streaming response ${i++}.`,inferenceId:"mock"}),s().A.isDevelopingInAirplaneMode&&l.push({type:"success",p:"padding",completion:"\n\nTo see a real AI response, run the server with `--airplaneMode=false`.",inferenceId:"mock"}),"string"==typeof o)){l.push({type:"success",p:"padding",completion:"\n\nHere is the text you selected:\n\n",inferenceId:"mock"});for(const e of u(o,r.chunkSize))l.push({type:"success",completion:e,p:"padding",inferenceId:"mock"})}if(r.showErrorCode)l.push({type:"error",message:"alas",errorCode:r.showErrorCode,isRetryable:!1});else if(void 0===g)for(let s=0;s<r.numLoremIpsums;s++)l.push(...p([`\n\n${s+1}. `,...u(c,0===r.delayBetweenChunks?c.length:r.chunkSize)]));else if(g.length>0){const e=u(g,r.chunkSize);l.push(...p(e))}return Promise.resolve({type:"success",data:d(l),status:200,headers:{}})}(0,n(852832).exposeDebugValue)("completionDebugSettings",r)},580648:(e,t,n)=>{n.d(t,{o:()=>l});n(296540);var s=()=>n(590526),o=()=>n(914462),i=()=>n(69708),a=()=>n(173783),r=()=>n(187820),c=n(474848);function l(e){const{group:t}=e,n=e.size??20,l=(0,i().tz)(),d=(0,s().K8)((()=>{if(t&&t.icon)return{pointer:t.pointer,icon:t.icon}}),[t]),u=(0,s().K8)((()=>(0,o().n)({intl:l,permissionGroupModel:t})),[l,t]);return(0,c.jsx)("div",{children:d?(0,c.jsx)(r().B6,{disabled:!0,size:n,icon:d,isEmptyPage:!1,title:u}):(0,c.jsx)(a().A,{size:n})})}},591829:(e,t,n)=>{n.r(t),n.d(t,{UniversalQnaModals:()=>Ki});var s=n(296540),o=()=>n(664594),i=()=>n(300474),a=()=>n(907258),r=()=>n(59226),c=()=>n(242422),l=()=>n(484714),d=()=>n(590526),u=()=>n(187174),p=()=>n(576590),g=()=>n(634877),m=()=>n(604018),h=()=>n(383070),v=()=>n(217714),f=()=>n(789586),y=()=>n(990544),x=()=>n(484487),S=n(474848);function _(){const e=(0,l().v3)(),t=(0,i().r)(),{learnMoreUrl:n,troubleShootingUrl:s}=(0,g().hP)("asana");return t?(0,S.jsx)(y().R,{connector:"asana",screenName:"auth",nextScreens:{notAdminOfConnectorAccount:"error",connectionConflict:"error",connectionSuccess:"pending_selection",error:"error"},learnMoreUrl:n,troubleShootingUrl:s,setConnectionStateAsConnected:()=>{x().P0.setState({...x().P0.state,connectionStatus:"pending_selection",syncProgressPercentage:0,isConnected:!1,isLoaded:!0})},callConnectionApi:async()=>(await(0,p().updateAsanaAIConnectorStatus)({environment:e,spaceId:t}),{type:"success",data:{connectionSuccess:!0}})}):null}var j=()=>n(128933),b=()=>n(718827),k=()=>n(69708),I=()=>n(769864),A=()=>n(38357);function C(){const e=(0,l().v3)(),t=(0,i().r)(),n=s.useCallback((async()=>{if(!t)return;const n=await I().callApi({eventName:"startIngestion",environment:e,data:{connector:"asana",spaceId:t,setupSessionId:x().P0.state.sessionId}});if("failed"!==n.type&&("success"!==n.type||n.data.success))return j().D6({label:(0,S.jsx)(k().sA,{id:"asanaAiConnector.connectionStarted.acknowledge",defaultMessage:"Started syncing from Asana. This can take up to 36 hours."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,S.jsx)(b().Ay,{onClick:j().N2,children:(0,S.jsx)(k().sA,{id:"asanaAiConnector.connectionStarted.startedMessageDismiss",defaultMessage:"Close"})})}),x().P0.setState({...x().P0.state,connectionStatus:"in_progress"}),{status:"success"};j().D6({label:(0,S.jsx)(k().sA,{id:"asanaAiConnector.connectionFailed.acknowledge",defaultMessage:"Failed to start syncing from Asana. Please try again later."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,S.jsx)(b().Ay,{onClick:j().N2,children:(0,S.jsx)(k().sA,{id:"asanaAiConnector.connectionFailed.failedMessageDismiss",defaultMessage:"Close"})})})}),[e,t]);return(0,S.jsx)(A().a,{connector:"asana",screenName:"connection_complete",nextScreens:{notStarted:"auth",inProgress:"none",alreadyConnected:"intro",error:"error"},forceIngestion:!0,ingestionNotNeeded:!1,onStartIngestion:n})}var w=()=>n(197532);function T(){return(0,S.jsx)(w().X,{connector:"asana",postDisconnectScreenName:"post_disconnect_screen",disconnectScreenName:"disconnect",settingsScreenName:"settings",errorScreenName:"error",setStatusAsDisconnected:()=>{x().P0.setState({...x().P0.state,connectionStatus:"disconnecting",isConnected:!1,isLoaded:!0,syncProgressPercentage:0,currentScreen:"post_disconnect_screen"})},showGoogleWorkspaceNote:!1})}var M=()=>n(564884),D=()=>n(401497),P=()=>n(249046),W=()=>n(807449),B=()=>n(31511),F=()=>n(765974),N=()=>n(100622),z=()=>n(284371),E=()=>n(354807);const U=(0,k().YK)({tokenPlaceholder:{id:"asana.enterpriseAuth.tokenPlaceholder",defaultMessage:"Enter API Token"},appsServiceAccounts:{id:"asana.enterpriseAuth.appsServiceAccounts",defaultMessage:"Apps → Service Accounts"},createNewServiceAccount:{id:"asana.enterpriseAuth.createNewServiceAccount",defaultMessage:"Create new service account"},fullAccess:{id:"asana.enterpriseAuth.fullAccess",defaultMessage:"Full access"}});function L(){const[e,t]=(0,s.useState)(""),[n,o]=(0,s.useState)(!1),a=(0,i().r)(),r=(0,l().v3)(),c=(0,k().tz)(),{learnMoreUrl:u}=(0,g().hP)("asana"),m=(0,d().K8)((()=>g().NT.asana.state.sessionId),[]),h=(0,d().K8)((()=>g().NT.asana.state.analyticsFrom),[]),v=(0,d().K8)((()=>g().NT.asana.state.currentScreen),[]),f=(0,D().IS)((()=>({noteHeading:{fontWeight:z().Wy.medium},noteBody:{marginTop:8,fontWeight:z().Wy.regular,color:N().Tj.text.secondary,letterSpacing:"0.2px"},link:{color:N().Tj.blue.text.secondary,cursor:"pointer",textDecoration:"underline",marginInlineStart:3,fontWeight:z().Wy.medium},bulletPoint:{display:"flex",alignItems:"flex-start",marginTop:6,marginInlineStart:8},bulletDot:{width:4,height:4,borderRadius:"50%",backgroundColor:N().Tj.text.secondary,marginTop:7,flexShrink:0},bulletPointText:{marginInlineStart:8},inputContainer:{marginTop:8},input:{width:"100%"},warningText:{color:N().Tj.orange.text.accentPrimary,paddingInlineStart:14,fontWeight:z().Wy.regular},warningContainer:{marginInlineStart:5,marginInlineEnd:5,marginBottom:15},warningIcon:{width:18,height:17,marginTop:2}})),[]),y=(0,s.useCallback)((async()=>{try{if((0,M().u)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"asana_enterprise_token_submit",integration_type:"asana",setup_session_id:m,from:h}}}),!a||!e)return void o(!0);if("failed"===(await p().createAsanaConnection({environment:r,spaceId:a,token:e,sessionId:m??""})).status)return void o(!0);o(!1),g().NT.asana.setState({...g().NT.asana.state,currentScreen:"pending_selection"})}catch(t){o(!0)}}),[h,r,m,a,e]),x=n?(0,S.jsxs)(P().Ye,{style:f.warningContainer,children:[(0,S.jsx)(W().I,{icon:F().exclamationMarkTriangleFillIcon,colorPalette:"orange",colorVariant:"accentPrimary",style:f.warningIcon}),(0,S.jsx)("div",{style:f.warningText,children:(0,S.jsx)(k().sA,{id:"asana.enterpriseAuth.warning",defaultMessage:"We couldn’t authenticate with the provided token. Please check your API Token and try again."})})]}):void 0;return a?(0,S.jsx)(E().Q,{title:(0,S.jsx)(k().sA,{id:"asana.enterpriseAuth.title",defaultMessage:"Connect Asana to Notion AI"}),subText:(0,S.jsx)(k().sA,{id:"asana.enterpriseAuth.subtitle",defaultMessage:"To start, install the Notion AI app in Asana"}),open:"enterprise_token_input"===v,onDismiss:()=>{o(!1),(0,M().u)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"enterprise_token_screen_dismiss",integration_type:"asana",setup_session_id:m,from:h}}}),g().NT.asana.setState({...g().NT.asana.state,currentScreen:"none"})},warningMessage:x,connectorType:"asana",primaryButtonText:(0,S.jsx)(k().sA,{id:"asana.enterpriseAuth.continueButton",defaultMessage:"Continue"}),onClickPrimaryButton:y,openLearnMoreUrl:()=>{window.open(u,"_blank")},notes:[(0,S.jsxs)(P().wt,{children:[(0,S.jsx)("div",{style:f.noteHeading,children:(0,S.jsx)(k().sA,{id:"asana.enterpriseAuth.step1Title",defaultMessage:"Create a service account token"})}),(0,S.jsxs)("div",{style:f.noteBody,children:[(0,S.jsx)(k().sA,{id:"asana.enterpriseAuth.step1Description",defaultMessage:"Follow these steps in your Asana admin console:"}),(0,S.jsxs)("div",{style:f.bulletPoint,children:[(0,S.jsx)("div",{style:f.bulletDot}),(0,S.jsx)("div",{style:f.bulletPointText,children:(0,S.jsx)(k().sA,{id:"asana.enterpriseAuth.step1.1",defaultMessage:"Log in to {adminConsoleLink}",values:{adminConsoleLink:(0,S.jsx)("a",{href:"https://app.asana.com/admin/",target:"_blank",rel:"noopener noreferrer",style:f.link,onClick:()=>{(0,M().u)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"asana_admin_console_link_click",integration_type:"asana",setup_session_id:m,from:h}}})},children:"Admin Console"})}})})]}),(0,S.jsxs)("div",{style:f.bulletPoint,children:[(0,S.jsx)("div",{style:f.bulletDot}),(0,S.jsx)("div",{style:f.bulletPointText,children:(0,S.jsx)(k().sA,{id:"asana.enterpriseAuth.step1.2",defaultMessage:"Go to {appsServiceAccounts}",values:{appsServiceAccounts:(0,S.jsx)("span",{style:{fontWeight:z().Wy.medium},children:c.formatMessage(U.appsServiceAccounts)})}})})]}),(0,S.jsxs)("div",{style:f.bulletPoint,children:[(0,S.jsx)("div",{style:f.bulletDot}),(0,S.jsx)("div",{style:f.bulletPointText,children:(0,S.jsx)(k().sA,{id:"asana.enterpriseAuth.step1.3",defaultMessage:"Click {createNewServiceAccount}",values:{createNewServiceAccount:(0,S.jsx)("span",{style:{fontWeight:z().Wy.medium},children:`"${c.formatMessage(U.createNewServiceAccount)}"`})}})})]}),(0,S.jsxs)("div",{style:f.bulletPoint,children:[(0,S.jsx)("div",{style:f.bulletDot}),(0,S.jsx)("div",{style:f.bulletPointText,children:(0,S.jsx)(k().sA,{id:"asana.enterpriseAuth.step1.5",defaultMessage:"Set permissions to {fullAccess}",values:{fullAccess:(0,S.jsx)("span",{style:{fontWeight:z().Wy.medium},children:c.formatMessage(U.fullAccess)})}})})]})]})]},"note-1"),(0,S.jsxs)(P().wt,{children:[(0,S.jsx)("div",{style:f.noteHeading,children:(0,S.jsx)(k().sA,{id:"asana.enterpriseAuth.step2Title",defaultMessage:"Enter your API token below"})}),(0,S.jsx)("div",{style:f.noteBody,children:(0,S.jsx)(k().sA,{id:"asana.enterpriseAuth.step2Description",defaultMessage:"Paste the token to complete the connection"})}),(0,S.jsx)("div",{style:f.inputContainer,children:(0,S.jsx)(B().A,{value:e,onChange:e=>t(e.target.value),placeholder:c.formatMessage(U.tokenPlaceholder),style:f.input,type:"password",showClearButton:!0})})]},"note-2")]}):null}var R=()=>n(657148);function K(){return(0,S.jsx)(R().b,{connector:"asana",screenName:"error"})}n(581454);var H=()=>n(406094),O=()=>n(302501),G=()=>n(61958),Y=()=>n(484595),q=()=>n(459400),J=()=>n(722228);const V=(0,k().YK)({popupTitle:{id:"asana.auth.popup.title",defaultMessage:"Asana login"}}),$=[{key:"enterprise",title:(0,S.jsx)(k().sA,{id:"asana.setupMethod.enterprise",defaultMessage:"Enterprise account"}),subtitle:(0,S.jsx)(k().sA,{id:"asana.setupMethod.enterprise.description",defaultMessage:"Dedicated account to keep access secure for your team"}),recommended:!0},{key:"personal",title:(0,S.jsx)(k().sA,{id:"asana.setupMethod.personal",defaultMessage:"All other account"}),subtitle:(0,S.jsx)(k().sA,{id:"asana.setupMethod.personal.description",defaultMessage:"Use your own Asana account for a quick, personal connection"})}];function Q(e){const{selectedMethod:t,onMethodChange:n}=e,s=(0,D().IS)((()=>({wrapper:{display:"flex",flexDirection:"column",gap:12,padding:"0px 20px",width:"100%"},radioModalWrapper:{display:"flex",flexDirection:"column",gap:12,padding:"0px",width:"100%"},title:{fontSize:12,fontWeight:500,color:N().Tj.text.secondary},optionButtonBase:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:12,height:"auto",minHeight:70,borderRadius:8,paddingTop:12,paddingBottom:12,paddingInlineStart:14,paddingInlineEnd:14-Y().p,border:void 0},optionButtonUnselected:{boxShadow:`inset 0 0 0 1px ${N().Tj.border.primary}`},optionButtonSelected:{boxShadow:`inset 0 0 0 1px ${N().Tj.blue.icon.accentPrimary}`},optionContent:{display:"flex",flexDirection:"column",gap:2,flex:1,minWidth:0,...z().RC},optionTitle:{display:"flex",alignItems:"center",gap:8,fontWeight:z().Wy.medium},optionSubtitle:{whiteSpace:"break-spaces"},recommendedBadge:{fontSize:12,color:N().Tj.blue.text.accentPrimary,backgroundColor:N().Tj.blue.background.secondary,padding:"2px 8px",borderRadius:4,fontWeight:500}})),[]);return(0,S.jsxs)("div",{style:s.wrapper,children:[(0,S.jsx)(O().A,{style:s.title,children:(0,S.jsx)(k().sA,{id:"asana.setupMethod.title",defaultMessage:"Setup method"})}),(0,S.jsx)("div",{style:s.radioModalWrapper,children:$.map((e=>{const o=t===e.key;return(0,S.jsxs)(H().A,{size:"lg",onClick:()=>n(e.key),style:{...s.optionButtonBase,...o?s.optionButtonSelected:s.optionButtonUnselected},children:[(0,S.jsxs)("div",{style:s.optionContent,children:[(0,S.jsxs)("div",{style:s.optionTitle,children:[(0,S.jsx)(O().A,{children:e.title}),e.recommended?(0,S.jsx)("span",{style:s.recommendedBadge,children:(0,S.jsx)(k().sA,{id:"asana.setupMethod.recommended",defaultMessage:"Recommended"})}):void 0]}),e.subtitle?(0,S.jsx)(O().A,{isSecondaryColor:!0,isMultiline:!0,style:s.optionSubtitle,children:e.subtitle}):void 0]}),(0,S.jsx)(Y().A,{isSelected:o})]},e.key)}))})]})}function X(){const{learnMoreUrl:e}=(0,g().hP)("asana"),t=(0,l().v3)(),[n,o]=(0,s.useState)("enterprise"),i=(0,s.useCallback)((e=>{o(e)}),[]),a=(0,g().nB)({connector:"asana",authorizationType:"user"}),r=(0,s.useCallback)((()=>{const e=g().NT.asana.state;"enterprise"===n&&g().NT.asana.setState({...e,currentScreen:"enterprise_token_input"})}),[n]),c=(0,s.useCallback)((()=>{"personal"===n&&a&&(t.device.isElectron?q().P(a):G().P(t,{width:800,height:600,url:a,titleMessage:V.popupTitle}))}),[n,a,t]);return(0,S.jsx)(J().Z,{connector:"asana",screenName:"introduction",nextScreens:{notStarted:"auth",inProgress:"pending_selection",alreadyConnected:"introduction",error:"error"},usesPopup:!0,learnMoreUrl:e,staticAuthUrl:"personal"===n?a:void 0,openAuthUrl:c,customContentBeforeFooter:(0,S.jsx)(Q,{selectedMethod:n,onMethodChange:i}),onConnectNotStarted:r})}var Z=()=>n(81883);function ee(){return(0,S.jsx)(Z().e,{connector:"asana",screenName:"settings",nextScreens:{disconnect:"disconnect",error:"error"},settings:void 0})}n(16280),n(898992),n(354520);var te=()=>n(107975),ne=()=>n(420802),se=()=>n(388926),oe=()=>n(98126),ie=()=>n(160432),ae=()=>n(266685),re=()=>n(424416);function ce(e){const{connector:t,screenName:n,title:o,subtext:i,fetchList:a,userSelection:r,onConfirm:c,onDismiss:u,analyticsButtonName:p,useMultiSelection:m=!1,futureSelectionLabel:h,nextScreens:v,isLoading:f=!0}=e,y=(0,l().v3)(),x=(0,k().tz)(),[_,j]=s.useState([]),[b,I]=s.useState([]),[A,C]=s.useState([]),[w,T]=s.useState(!1),[W,F]=s.useState(!1),[E,U]=s.useState(""),[L,R]=s.useState(!0),[K,H]=s.useState(!1),O=(0,d().O$)(g().NT[t]),{sessionId:G,currentScreen:Y,analyticsFrom:q}=O;s.useEffect((()=>{Y===n&&(async()=>{try{R(!0);const[e,t]=await Promise.all([a(),r()]);j(e);const n=e.map((e=>e.id)),s=t.selectedIds,o=t.deselectedIds,i=n.filter((e=>!s.includes(e)&&!o.includes(e)));I([...s,...i]),C(o),T(t.futureSelection),F(t.allSelected)}catch(e){}finally{R(!1)}})()}),[a,r,Y,n]);const J=s.useMemo((()=>E?_.filter((e=>e.name.toLowerCase().includes(E.toLowerCase()))):_),[_,E]),V=s.useCallback((e=>b.includes(e)),[b]),$=s.useCallback((()=>b.length===_.length||0!==b.length&&"partial"),[b.length,_.length]),Q=s.useMemo((()=>!!w||b.length>0),[b.length,w]),X=(0,D().IS)((()=>({wrapper:{width:400,display:"flex",flexDirection:"column",minHeight:L?void 0:530},searchBarWrapper:{justifyContent:"center"},searchBar:{width:360,padding:4},selectionContainer:{marginTop:18,marginBottom:L?24:0,width:"100%",height:"100%",justifyContent:"center",padding:"0px 20px 0px"},selection:{width:"100%"},selectionWrapper:{overflowY:"scroll",maxHeight:170},itemWrapper:{gap:12,alignItems:"center",marginTop:12},itemText:{fontSize:12,lineHeight:"16px"},divider:{marginTop:5,marginBottom:5},loadingWrapper:{alignItems:"center",gap:4,justifyContent:"center"},loadingText:{color:N().Tj.text.secondary},footer:{position:"absolute",width:"100%",justifySelf:"flex-end",boxShadow:"0px 9px 24px 0px #0F0F0F33",paddingTop:16,paddingInlineEnd:20,paddingBottom:16,paddingInlineStart:20,gap:12,bottom:0},futureSelectionCheckboxWrapper:{gap:4,visibility:L?"hidden":"visible"},primaryButton:{fontSize:14,fontWeight:z().Wy.semibold,width:360}})),[L]),Z=s.useCallback((e=>{if((0,M().u)({environment:y,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:V(e)?"specific_item_deselected":"specific_item_selected",integration_type:t,setup_session_id:G,from:q}}}),m)b.includes(e)?(I((t=>t.filter((t=>t!==e)))),C((t=>[...t,e]))):(C((t=>t.filter((t=>t!==e)))),I((t=>[...t,e]))),b.length===_.length?F(!0):F(!1);else{const t=_.map((e=>e.id)).filter((t=>t!==e));I([e]),C(t),F(!1)}}),[b,V,y,t,G,q,m,_]),ee=s.useCallback((()=>{const e=_.map((e=>e.id)),n=b.length!==_.length;(0,M().u)({environment:y,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:n?"all_items_selected":"all_items_deselected",integration_type:t,setup_session_id:G,from:q}}}),n?(I(e),C([]),F(!0)):(I([]),C(e),F(!1))}),[_,b.length,y,t,G,q]),ce=s.useCallback((()=>{(0,M().u)({environment:y,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"selection_modal_close",integration_type:t,setup_session_id:G,from:q}}}),u?u():g().NT[t].setState({...O,currentScreen:"none"})}),[y,t,G,q,u,O]),le=s.useCallback((async()=>{(0,M().u)({environment:y,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:p,integration_type:t,setup_session_id:G,from:q}}}),H(!0);try{const{success:e}=await c({selectedIds:b,deselectedIds:A,futureSelection:w,allSelected:W});e?g().NT[t].setState({...O,currentScreen:v.selectionComplete}):g().NT[t].setState({...O,currentScreen:v.error})}finally{H(!1)}}),[y,p,t,G,q,c,b,A,w,W,O,v]),de=s.useCallback((()=>L||f?(0,S.jsxs)(P().Ye,{style:X.loadingWrapper,children:[(0,S.jsx)(oe().k,{}),(0,S.jsx)("div",{style:X.loadingText,children:(0,S.jsx)(k().sA,{id:"aiConnectors.selectionModal.loadingItems",defaultMessage:"Loading items..."})})]}):(0,S.jsxs)(P().wt,{children:[(0,S.jsx)(P().Ye,{style:X.searchBarWrapper,children:(0,S.jsx)(B().A,{style:X.searchBar,placeholder:x.formatMessage({id:"aiConnectors.selectionModal.searchPlaceholder",defaultMessage:"Search items"}),value:E,onChange:e=>U(e.target.value)})}),m?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(P().Ye,{style:X.itemWrapper,children:[(0,S.jsx)(ne().S,{checked:$(),size:14,onClick:ee}),(0,S.jsx)("div",{style:X.itemText,children:(0,S.jsx)(k().sA,{id:"aiConnectors.selectionModal.selectAll",defaultMessage:"All items"})})]}),(0,S.jsx)(se().A,{style:X.divider,size:4})]}):void 0,(0,S.jsx)(P().wt,{style:X.selectionWrapper,children:J.map((e=>(0,S.jsx)(P().Ye,{style:X.itemWrapper,children:m?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(ne().S,{checked:V(e.id),onClick:()=>Z(e.id),size:14}),(0,S.jsx)("div",{style:X.itemText,children:e.name})]}):(0,S.jsx)("label",{children:(0,S.jsxs)(P().Ye,{style:{gap:8},children:[(0,S.jsx)(ae().a,{checked:V(e.id),onClick:()=>Z(e.id),onChange:()=>Z(e.id),selectorSize:"small",name:`${t}-selection`,value:e.id}),(0,S.jsx)("div",{style:X.itemText,children:e.name})]})})},e.id)))})]})),[L,m,J,E,$,V,ee,Z,X,x,f,t]);return(0,S.jsx)(te().a,{ariaLabel:x.formatMessage({id:"aiConnectors.selectionModal.ariaLabel",defaultMessage:"Select resources"}),showCloseIcon:!0,open:Y===n,onDismiss:ce,render:()=>(0,S.jsxs)("div",{style:X.wrapper,children:[(0,S.jsx)(re().b,{connectorType:t,title:o,subtext:i}),(0,S.jsx)(P().Ye,{style:X.selectionContainer,children:(0,S.jsx)(P().wt,{style:X.selection,children:de()})}),L?void 0:(0,S.jsxs)(P().wt,{style:X.footer,children:[m?(0,S.jsxs)(P().Ye,{style:X.futureSelectionCheckboxWrapper,children:[(0,S.jsx)(ne().S,{checked:w,size:14,onClick:()=>{(0,M().u)({environment:y,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:w?"dont_join_future_items":"join_future_items",integration_type:t,setup_session_id:G,from:q}}}),T(!w)}}),(0,S.jsx)("div",{style:X.itemText,children:h??(0,S.jsx)(k().sA,{id:"aiConnectors.selectionModal.futureSelection",defaultMessage:"Add items created in future"})})]}):void 0,(0,S.jsx)(ie().A,{colorPalette:"blue",style:X.primaryButton,onClick:le,disabled:!Q||K,isLoading:K,children:x.formatMessage({id:"aiConnectors.selectionModal.primaryButtonText",defaultMessage:"Continue"})})]})]})})}function le(){const e=(0,l().v3)(),t=(0,i().r)(),n=(0,d().K8)((()=>x().P0.state.currentScreen),[]),o=(0,r().X)("asana_workspace_selection_multi_selection"),[a,c]=s.useState(void 0),g=s.useCallback((async()=>a?Promise.resolve(a.workspaces):Promise.resolve([])),[a]),m=s.useCallback((async()=>{if(!a)return Promise.resolve({selectedIds:[],deselectedIds:[],futureSelection:!1,allSelected:!1});const e=a.workspaces.map((e=>e.id)),t=a.userSelection.selectedWorkspaceIds,n=a.userSelection.excludedWorkspaceIds,s=e.filter((e=>!t.includes(e)&&!n.includes(e)));if(a.userSelection.syncFutureWorkspaces&&o){const e=[...t,...s];return Promise.resolve({selectedIds:e,deselectedIds:n,futureSelection:!0,allSelected:a.userSelection.allWorkspaces})}return Promise.resolve({selectedIds:t,deselectedIds:[...n,...s],futureSelection:!1,allSelected:a.userSelection.allWorkspaces})}),[a,o]);(0,u().Yb)((async()=>{if(t&&"pending_selection"===n)try{var s,o,i,a;const n=await(0,p().fetchAsanaWorkspaces)({environment:e,spaceId:t});if(!n)return void c({workspaces:[],userSelection:{selectedWorkspaceIds:[],excludedWorkspaceIds:[],syncFutureWorkspaces:!1,allWorkspaces:!1}});c({workspaces:n.workspaces||[],userSelection:{selectedWorkspaceIds:(null===(s=n.userSelection)||void 0===s?void 0:s.selectedWorkspaceIds)||[],excludedWorkspaceIds:(null===(o=n.userSelection)||void 0===o?void 0:o.excludedWorkspaceIds)||[],syncFutureWorkspaces:(null===(i=n.userSelection)||void 0===i?void 0:i.syncFutureWorkspaces)||!1,allWorkspaces:(null===(a=n.userSelection)||void 0===a?void 0:a.allWorkspaces)||!1}})}catch(r){c({workspaces:[],userSelection:{selectedWorkspaceIds:[],excludedWorkspaceIds:[],syncFutureWorkspaces:!1,allWorkspaces:!1}})}}),[e,t,n]);const h=s.useCallback((async({selectedIds:n,deselectedIds:s,futureSelection:o,allSelected:i})=>{if(!t)throw new Error("No spaceId available for workspace confirmation");try{const a=await I().callApi({eventName:"updateAsanaWorkspaceSelection",environment:e,data:{spaceId:t,selectedWorkspaceIds:n,excludedWorkspaceIds:s,syncFutureWorkspaces:o,allWorkspaces:i}});return c(void 0),"success"===a.type?{success:!0}:{success:!1}}catch(a){throw x().P0.setState({...x().P0.state,connectionStatus:"error",error:a instanceof Error?a.message:"Unknown error occurred"}),a}}),[e,t]);return(0,S.jsx)(ce,{connector:"asana",screenName:"pending_selection",nextScreens:{selectionComplete:"connection_complete",error:"error"},isLoading:!a,title:(0,S.jsx)(k().sA,{id:"asanaAiConnector.workspaceSelection.title",defaultMessage:"Select Asana workspace"}),subtext:(0,S.jsx)(k().sA,{id:"asanaAiConnector.workspaceSelection.subtitle",defaultMessage:"Choose which Asana workspace you’d like to connect to Notion AI"}),fetchList:g,userSelection:m,onConfirm:h,analyticsButtonName:"select_asana_workspace",useMultiSelection:o,futureSelectionLabel:(0,S.jsx)(k().sA,{id:"asanaAiConnector.workspaceSelection.futureProjects",defaultMessage:"Include future projects in this workspace"})})}var de=()=>n(976725),ue=()=>n(302591),pe=()=>n(61433);function ge(){const e=(0,d().K8)((()=>c().default.getConfigKey("box_ingestion","learnMoreUrl")),[]);return(0,S.jsx)(J().Z,{connector:"box",screenName:"introduction",nextScreens:{notStarted:"connecting",inProgress:"none",alreadyConnected:"already_connected",error:"none"},usesPopup:!0,learnMoreUrl:e})}function me(){const e=(0,l().v3)(),t=(0,i().r)(),n=(0,d().K8)((()=>c().default.getConfigKey("box_ingestion","learnMoreUrl")),[]);if(!t)return null;const s=(0,k().YK)({"boxAiConnector.authModal.captionForFollowBoxInstructions":{id:"boxAiConnector.authModal.captionForFollowBoxInstructions",defaultMessage:"Follow Box’s instructions to connect. Return to this window, and click “Confirm connection” below."}});return(0,S.jsx)(y().R,{connector:"box",screenName:"connecting",nextScreens:{notAdminOfConnectorAccount:"not_admin_screen",connectionConflict:"none",connectionSuccess:"connection_complete_screen",error:"error"},learnMoreUrl:n,troubleShootingUrl:n,setConnectionStateAsConnected:()=>{pe().MX.setState({...pe().MX.state,status:"in_progress",ingestionProgress:1,isConnected:!1})},callConnectionApi:async()=>(await e.api.callCellCompatibleApi({eventName:"startIngestion",environment:e,cellNavigation:{spaceId:t},data:{connector:"box",spaceId:t,setupSessionId:pe().MX.state.sessionId}}),await(0,p().updateBoxAIConnectorStatus)({environment:e,spaceId:t}),pe().MX.state.ingestionProgress?(pe().MX.setState({...pe().MX.state,currentScreen:"connection_complete_screen"}),{type:"success",data:{connectionSuccess:!0}}):{type:"success",data:{connectionSuccess:!1,errorResponse:{status:401}}}),connectorSpecificSetupNote:s["boxAiConnector.authModal.captionForFollowBoxInstructions"]})}function he(){const e=(0,d().K8)((()=>pe().MX.state.currentScreen),[]);return(0,S.jsx)(de().m,{connector:"box",open:"already_connected"===e,onDismiss:()=>{pe().MX.reset()}})}function ve(){const e=(0,d().K8)((()=>c().default.getConfigKey("box_ingestion","learnMoreUrl")),[]);return(0,S.jsx)(ue().A,{connector:"box",screenName:"not_admin_screen",learnMoreUrl:e})}function fe(){return(0,S.jsx)(A().a,{connector:"box",screenName:"connection_complete_screen",nextScreens:{notStarted:"none",inProgress:"none",alreadyConnected:"already_connected",error:"none"},ingestionNotNeeded:!1,onStartIngestion:async()=>(j().D6({label:(0,S.jsx)(k().sA,{id:"boxAiConnector.connectionStarted.acknowledge",defaultMessage:"Started syncing from Box. This can take up to 36 hours."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,S.jsx)(b().Ay,{onClick:j().N2,children:(0,S.jsx)(k().sA,{id:"boxAiConnector.connectionStarted.startedMessageDismiss",defaultMessage:"Close"})})}),Promise.resolve({status:"success"})),noSelectionAllowed:!0})}function ye(){return(0,S.jsx)(Z().e,{connector:"box",screenName:"settings",nextScreens:{disconnect:"disconnect",error:"error"},settings:void 0})}function xe(){return(0,S.jsx)(w().X,{connector:"box",postDisconnectScreenName:"post_disconnect_screen",disconnectScreenName:"disconnect",settingsScreenName:"settings",errorScreenName:"error",setStatusAsDisconnected:()=>{pe().MX.setState({...pe().MX.getInitialState(),status:"disconnecting",currentScreen:"post_disconnect_screen",isConnected:!1,isLoaded:!0})},showGoogleWorkspaceNote:!1})}n(737550);var Se=()=>n(920198),_e=()=>n(176983),je=()=>n(351595),be=()=>n(577733),ke=()=>n(382690),Ie=()=>n(430405),Ae=()=>n(313535);const Ce=(0,k().YK)({popupTitle:{id:"discord.auth.popup.title",defaultMessage:"Discord Authorization"}});function we(){const e=(0,s.useMemo)((()=>(0,je().J)("discord")),[]),t=(0,s.useMemo)((()=>(0,je().a)("discord")),[]),n=(0,l().v3)(),[o,i]=(0,s.useState)("CLOSED"),a=(0,Se().L)(),r=null==a?void 0:a.id,c=(0,d().O$)(Ae().lk),m=(0,d().K8)((()=>Ae().lk.state.sessionId),[]),h=(0,d().K8)((()=>Ae().lk.state.analyticsFrom),[]),v=(0,_e().J)(a),y=(0,f().P)({name:"ai_connectors",spaceId:r,userId:n.currentUser.id}),{learnMoreUrl:x}=(0,g().hP)("discord"),_=(0,s.useCallback)((()=>{n.device.isElectron?q().P(x):window.open(x,"_blank")}),[n,x]),j=(0,s.useCallback)((async()=>{if(!r||"introduction"!==c.currentScreen)return null;if(!v)return null;if(!y)return null;const e=await I().callApi({eventName:"getAIConnectorAuthorizationUrl",environment:n,data:{connector:"discord",authorizationType:"workspace",spaceId:r,client:n.device.isElectron?"desktop":"web",sessionId:Ae().lk.state.sessionId}});if("success"!==e.type)return null;const t=e.data.authorizationUrl;n.device.isElectron?q().P(t):G().P(n,{width:800,height:600,url:t,titleMessage:Ce.popupTitle})}),[r,n,c.currentScreen,v,y]),[b]=(0,u().Yb)((async()=>{if(!r||"introduction"!==c.currentScreen)return;const e=await I().callApi({eventName:"listAIConnectors",environment:n,data:{spaceId:r}});return"success"===e.type?{isDiscordConnected:e.data.connectedConnectors.map((e=>e.id)).some((e=>"discord"===e))}:void 0}),[n,c.currentScreen,r]);(0,s.useEffect)((()=>{"introduction"===c.currentScreen?"resolved"===b.status?i("OPEN"):i("LOADING"):i("CLOSED")}),[b.status,c.currentScreen]);const k=(0,s.useCallback)((()=>{(0,p().resetAiConnectorStatus)("discord")}),[]),A=(0,s.useCallback)((async()=>{r&&((0,p().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:n,connector:"discord",moment:"started"}),await j(),(0,p().navigateToDiscordUniversalScreen)("check_connection_screen"))}),[n,r,j]);return r&&y?c.isConnected?null:v?(0,S.jsx)(Ie().A,{onConnect:A,onDismiss:k,onLearnMore:_,title:e,connectorType:"discord",notes:t,open:"OPEN"===o}):(0,S.jsx)(ke().BN,{connector:"discord",analyticsFrom:h,setupSessionId:m,handleClose:()=>(0,p().resetAiConnectorStatus)("discord"),open:"OPEN"===o,messages:be().FH}):null}function Te(){return(0,S.jsx)(we,{})}function Me(){const e=(0,l().v3)(),t=(0,i().r)(),{learnMoreUrl:n,troubleShootingUrl:s}=(0,g().hP)("discord");return t?(0,S.jsx)(y().R,{connector:"discord",screenName:"check_connection_screen",nextScreens:{notAdminOfConnectorAccount:"error_screen",connectionConflict:"error_screen",connectionSuccess:"settings",error:"error_screen"},learnMoreUrl:n,troubleShootingUrl:s,setConnectionStateAsConnected:()=>{Ae().lk.setState({...Ae().lk.state,connectionStatus:"completed",syncProgressPercentage:100,isConnected:!0,isLoaded:!0})},callConnectionApi:async()=>(await(0,p().updateDiscordAIConnectorStatus)({environment:e,spaceId:t}),{type:"success",data:{connectionSuccess:!0}})}):null}function De(){return(0,S.jsx)(A().a,{connector:"discord",screenName:"connection_complete_screen",nextScreens:{notStarted:"check_connection_screen",inProgress:"settings",alreadyConnected:"already_connected_screen",error:"error_screen"},ingestionNotNeeded:!0,onStartIngestion:void 0})}function Pe(){return(0,S.jsx)(Z().e,{connector:"discord",screenName:"settings",nextScreens:{disconnect:"disconnect_screen",error:"error_screen"},settings:void 0})}function We(){return(0,S.jsx)(w().X,{connector:"discord",postDisconnectScreenName:"post_disconnect_screen",disconnectScreenName:"disconnect_screen",settingsScreenName:"settings",errorScreenName:"error_screen",setStatusAsDisconnected:()=>{Ae().lk.setState({...Ae().lk.state,connectionStatus:"not_started",isConnected:!1,isLoaded:!0,syncProgressPercentage:0})},showGoogleWorkspaceNote:!1})}function Be(){return(0,S.jsx)(R().b,{connector:"discord",screenName:"error_screen"})}var Fe=()=>n(836095),Ne=()=>n(852273),ze=()=>n(218275),Ee=()=>n(921997),Ue=()=>n(890494),Le=()=>n(232930),Re=()=>n(913839);function Ke(){const e=(0,l().v3)(),t=(0,D().IS)((()=>({wrapper:{width:400,gap:16,alignContent:"center"},waitingForConnectionWrapper:{gap:4},note:{fontWeight:z().Wy.regular,fontSize:14,lineHeight:"18px",width:330,marginInlineStart:8},noteHeading:{fontWeight:z().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:z().Wy.regular,color:N().Tj.text.secondary,fontSize:14,lineHeight:"18px"},learnMoreButton:{gap:4,alignItems:"center",fontSize:14,color:N().Tj.text.secondary,justifyContent:"center",padding:4},buttonContainer:{justifyContent:"center"},link:{color:N().Tj.text.secondary,textDecoration:"underline",cursor:"pointer"}})),[]),n=(0,d().K8)((()=>"connecting"===Re().o.state.currentScreen),[]),a=(0,i().r)(),r=(0,o().T)(),c=(0,d().K8)((()=>Re().o.state.sessionId),[]),u=(0,s.useCallback)((async()=>{if(!a)return;if("connecting"!==Re().o.state.currentScreen)return;"success"===(await(0,p().updateGithubAIConnectorStatus)({environment:e,spaceId:a})).status&&Re().o.setState({...Re().o.state,currentScreen:"confirmation"})}),[a,e]),g=(0,s.useCallback)((({key:e,value:t})=>{"connected"===t&&u()}),[u]);(0,s.useEffect)((()=>{if(!a||!r||!c)return;const t=Ne().Ay.addListener((0,Ee().Vz)({spaceId:a,connectorType:"github",userId:r,sessionId:c}),void 0,g,void 0,e);return()=>{t&&Ne().Ay.removeListener(t,e)}}),[e,g,a,r,c]),(0,s.useEffect)((()=>{"connecting"===Re().o.state.currentScreen&&u()}),[u]);const m=(0,s.useCallback)((()=>[(0,S.jsxs)(P().wt,{style:{gap:4},children:[(0,S.jsx)("div",{style:t.noteHeading,children:(0,S.jsx)(k().sA,{id:"universalQna.github.waitingForConnectionNoteHeading1",defaultMessage:"GitHub should open automatically on a new tab."},"note1-1")}),(0,S.jsx)("div",{style:t.noteBody,children:(0,S.jsx)(k().sA,{id:"universalSearch.github.waitingForConnectionNoteBody1",defaultMessage:"If it doesn’t, {ClickHereToRetry}",values:{ClickHereToRetry:(0,S.jsx)("a",{style:t.link,href:Re().o.state.authUrl,target:"_blank",children:(0,S.jsx)(k().sA,{id:"universalQna.github.confirmModalNote1Retry",defaultMessage:"click here to retry"})})}},"note1-2")})]},"note-1"),(0,S.jsxs)(P().wt,{style:{gap:4},children:[(0,S.jsx)("div",{style:t.noteHeading,children:(0,S.jsx)(k().sA,{id:"universalSearch.github.workspaceAdminHeading",defaultMessage:"If you are a GitHub organization administrator:"},"note2-2")}),(0,S.jsx)("div",{style:t.noteBody,children:(0,S.jsx)(k().sA,{id:"universalSearch.github.workspaceAdminBody",defaultMessage:"Follow GitHub’s instructions to connect. Return to this window, and the process will continue automatically."},"note2-3")}),(0,S.jsxs)(P().wt,{style:{marginTop:16,gap:4},children:[(0,S.jsx)("div",{style:t.noteHeading,children:(0,S.jsx)(k().sA,{id:"universalSearch.github.notWorkspaceAdminHeading",defaultMessage:"If you are not authorized to install external apps:"},"note2-4")}),(0,S.jsx)("div",{style:t.noteBody,children:(0,S.jsx)(k().sA,{id:"universalSearch.github.notWorkspaceAdminBody",defaultMessage:"Follow the instructions to request access to install the app. Then, revisit the connect menu to continue setup."},"note2-5")})]})]},"note-2")]),[t]),h=(0,s.useCallback)((()=>{const t=(0,Le().x)("guides.aiConnectorGithub");(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"learn_more_click_connecting_modal",integration_type:"github",setup_session_id:Re().o.state.sessionId,from:Re().o.state.analyticsFrom}}}),e.device.isElectron?(0,Fe().P)(t):window.open(t,"_blank")}),[e]),v=(0,s.useCallback)((()=>{Re().o.reset(),(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drop_off_github_connecting_modal",integration_type:"github",setup_session_id:Re().o.state.sessionId,from:Re().o.state.analyticsFrom}}})}),[e]);return(0,S.jsx)(te().a,{open:n,showCloseIcon:!0,onDismiss:v,render:()=>(0,S.jsxs)(P().wt,{style:t.wrapper,children:[(0,S.jsx)(re().b,{connectorType:"github",title:(0,S.jsx)(k().sA,{id:"universalQnA.github.followInstructionsFromGithub",defaultMessage:"Follow instructions from GitHub in your browser"})}),(0,S.jsxs)(P().wt,{style:t.waitingForConnectionWrapper,children:[m().map(((e,n)=>(0,S.jsxs)(P().Ye,{gap:8,style:{marginTop:4,marginBottom:6,justifyContent:"center"},children:[(0,S.jsx)(Ue().A,{number:n+1}),(0,S.jsx)("div",{style:t.note,children:e})]},n))),(0,S.jsx)(P().Ye,{style:t.buttonContainer,children:(0,S.jsx)(b().Ay,{style:{marginTop:16,marginBottom:16,width:120,borderRadius:4},onClick:h,children:(0,S.jsxs)(P().Ye,{style:t.learnMoreButton,children:[(0,S.jsx)(k().sA,{id:"universalSearch.github.waitingForConnection.learnMore",defaultMessage:"Learn More"}),(0,S.jsx)(W().I,{icon:ze().arrowUpRightSquareSmallIcon,size:"sm"})]})})})]})]})})}var He=()=>n(726637),Oe=()=>n(18541);function Ge(e){const{open:t}=e;return(0,S.jsx)(de().m,{open:t,onDismiss:()=>{Re().o.reset()},connector:"github"})}const Ye=(0,k().YK)({githubAIConnectorOauthPopupTitle:{defaultMessage:"Connect GitHub AI Connector",id:"githubAIConnector.oauthPopupTitle"}});function qe(){const e=(0,s.useMemo)((()=>(0,je().J)("github")),[]),t=(0,s.useMemo)((()=>(0,je().a)("github")),[]),n=(0,l().v3)(),[o,i]=(0,s.useState)("CLOSED"),a=(0,Se().L)(),r=null==a?void 0:a.id,g=(0,d().O$)(Re().o),m=(0,d().K8)((()=>Re().o.state.sessionId),[]),h=(0,d().K8)((()=>Re().o.state.analyticsFrom),[]),v=(0,D().IS)((()=>({loadingWrapper:{padding:20,fontSize:12,fontWeight:z().Wy.regular,justifyContent:"center",gap:8,alignItems:"center"}})),[]),y=(0,_e().J)(a),x=(0,f().P)({name:"ai_connectors",spaceId:r,userId:n.currentUser.id}),_=(0,s.useCallback)((()=>{const e=(0,Le().x)("guides.aiConnectorGithub");(0,M().u)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"learn_more_click_intro_modal",integration_type:"github",setup_session_id:Re().o.state.sessionId,from:Re().o.state.analyticsFrom}}}),n.device.isElectron?(0,Fe().P)(e):window.open(e,"_blank")}),[n]),j=(0,s.useCallback)((async()=>{if(!r)return;const e=await I().callApi({eventName:"getGithubOrgAuthUrl",environment:n,data:{spaceId:r,isDesktop:n.device.isElectron,sessionId:Re().o.state.sessionId}});if("success"!==e.type)return;(0,p().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:n,connector:"github",moment:"started"});const t=e.data.url;n.device.isElectron?(0,Fe().P)(t):G().P(n,{width:800,height:600,url:t,titleMessage:Ye.githubAIConnectorOauthPopupTitle}),Re().o.setState({...Re().o.state,authUrl:t,currentScreen:"connecting"})}),[r,n]),[b]=(0,u().Yb)((async()=>{if(r&&"introduction"===g.currentScreen){if(g.githubOrg)return{isGithubConnected:!0};if(c().default.checkGate({gateName:"ai_connector_unification_github"})){if("success"===(await(0,p().updateGithubAIConnectorStatus)({environment:n,spaceId:r})).status)return{isGithubConnected:Re().o.state.isConnected}}else{const e=await I().callApi({eventName:"getGithubAIConnectorStatus",environment:n,data:{spaceId:r}});if("success"===e.type)return{isGithubConnected:e.data.isConnected}}}}),[n,g.currentScreen,g.githubOrg,r]);(0,s.useEffect)((()=>{"introduction"===g.currentScreen?"resolved"===b.status?i("OPEN"):i("LOADING"):i("CLOSED")}),[b.status,g.currentScreen]);const A=(0,s.useRef)(!1),C=(0,s.useCallback)((()=>{Re().o.reset(),(0,M().u)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drop_off_github_intro_modal",integration_type:"github",setup_session_id:Re().o.state.sessionId,from:Re().o.state.analyticsFrom}}}),A.current=!1}),[n]),w=(0,s.useCallback)((async()=>{await j(),(0,M().u)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"github_ai_connector_auth_url_open",integration_type:"github",setup_session_id:Re().o.state.sessionId,from:Re().o.state.analyticsFrom}}}),Re().o.setState({...Re().o.state,currentScreen:"connecting"})}),[n,j]);return(0,s.useEffect)((()=>{r&&y&&"resolved"===b.status&&"introduction"===g.currentScreen&&(A.current||((0,M().u)({environment:n,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:"github",setup_session_id:g.sessionId,from:g.analyticsFrom,is_space_admin:y,is_ai_eligible:x??!1}}}),A.current=!0))}),[r,n,b.status,g.sessionId,g.analyticsFrom,y,x,g.currentScreen]),r&&"CLOSED"!==o?He().A.isMobile?(0,S.jsx)(Oe().S,{connectorType:"github",open:"introduction"===g.currentScreen,onClosed:()=>{Re().o.reset()},learnMoreUrl:(0,Le().x)("guides.aiConnectorGithub")}):"LOADING"===o?(0,S.jsx)(te().a,{open:"LOADING"===o,render:()=>(0,S.jsxs)(P().Ye,{style:v.loadingWrapper,children:[(0,S.jsx)(k().sA,{id:"universalQna.github.isFetchingConnection",defaultMessage:"Getting connection status"}),(0,S.jsx)(oe().k,{})]})}):g.isConnected?(0,S.jsx)(Ge,{open:!0}):y?(0,S.jsx)(Ie().A,{onConnect:w,onDismiss:C,onLearnMore:_,title:e,connectorType:"github",notes:t,open:"OPEN"===o}):(0,S.jsx)(ke().BN,{connector:"github",analyticsFrom:h,setupSessionId:m,handleClose:()=>(0,p().resetAiConnectorStatus)("github"),open:"OPEN"===o,messages:be().Sn}):(0,S.jsx)(S.Fragment,{})}var Je=()=>n(373009);const Ve=function(){const e=(0,k().tz)(),t=(0,d().K8)((()=>Re().o.state.currentScreen),[]),[n,o]=(0,s.useState)(!1),a=(0,l().v3)(),r=(0,i().r)(),c=(0,s.useCallback)((()=>{(0,M().u)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"close_settings",integration_type:"github",setup_session_id:Re().o.state.sessionId,from:Re().o.state.analyticsFrom}}}),Re().o.setState({...Re().o.state,currentScreen:"none"})}),[a]),u=(0,s.useCallback)((()=>{o(!1)}),[]),p=(0,s.useCallback)((async()=>{if((0,M().u)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"open_github_for_edit_selection",integration_type:"github",setup_session_id:Re().o.state.sessionId,from:Re().o.state.analyticsFrom}}}),!r)return;const e=await I().callApi({eventName:"getGitHubSettingsUrl",environment:a,data:{spaceId:r}});if("success"!==e.type)return;const t=e.data.url;window.open(t,"_blank")}),[a,r]),g=(0,D().IS)((()=>({wrapper:{width:400},channelDetailsContainer:{width:352,fontSize:14,fontWeight:z().Wy.regular,color:N().Tj.text.secondary},channelDetailsSubtitle:{textAlign:"center",marginBottom:"16px"},channelDetailsWrapper:{justifyContent:"center",paddingTop:"12px",paddingBottom:"12px"},channelNamesContainer:{gap:2,color:N().Tj.text.primary},footer:{justifyContent:"center",alignItems:"center",width:"100%",paddingTop:20,paddingInlineEnd:20,paddingBottom:20,paddingInlineStart:20,gap:8},disconnectButton:{fontSize:14,fontWeight:z().Wy.medium,width:"100%"},moreChannelsContainer:{paddingTop:8},learnMoreButton:{fontSize:14,fontWeight:z().Wy.semibold,borderRadius:"4px",width:"100%"},learnMoreText:{fontWeight:z().Wy.medium,fontSize:12,gap:5,justifyContent:"center",alignItems:"center",paddingTop:4,paddingInlineEnd:8,paddingBottom:4,paddingInlineStart:8,color:`${N().Tj.text.secondary}`},confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:z().Wy.semibold,color:N().Tj.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:14,fontWeight:z().Wy.regular,color:N().Tj.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:14,fontWeight:z().Wy.regular,color:N().Tj.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:14,fontWeight:z().Wy.regular,width:"100%",textAlign:"center",paddingTop:4,paddingInlineEnd:0,paddingBottom:4,paddingInlineStart:0},confirmDisconnectButton:{fontSize:14,fontWeight:z().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},spinner:{paddingTop:20,paddingBottom:40,justifyContent:"center",alignItems:"center"},editChannelsButton:{width:"100%"}})),[]);return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(te().a,{showCloseIcon:!0,onDismiss:u,open:n,render:()=>(0,S.jsx)("div",{style:g.confirmWrapper,children:(0,S.jsxs)("div",{style:g.confirmContainer,children:[(0,S.jsx)("div",{style:g.confirmModalTitle,children:(0,S.jsx)(k().sA,{id:"githubAIConnector.settings.confirmation.title",defaultMessage:"Are you sure?"})}),(0,S.jsx)("div",{style:g.confirmModalSubTitle,children:(0,S.jsx)(k().sA,{id:"githubAIConnector.settings.confirmation.subTitle",defaultMessage:"Your GitHub data will be permanently deleted from Notion."})}),(0,S.jsx)("div",{style:g.confirmModalDescription,children:(0,S.jsx)(k().sA,{id:"githubAIConnector.settings.confirmation.description",defaultMessage:"This process can take up to 3 hours, and you’ll only be able to reconnect after disconnecting is complete."})}),(0,S.jsxs)(P().wt,{style:g.confirmModalActionButtons,children:[(0,S.jsx)(ie().A,{colorPalette:"red",style:g.confirmDisconnectButton,onClick:async()=>{r&&((0,M().u)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"account_disconnect_confirmation",integration_type:"github",setup_session_id:Re().o.state.sessionId,from:Re().o.state.analyticsFrom}}}),await I().callApi({eventName:"disconnectGithub",environment:a,data:{spaceId:r}}),Re().o.reset(),o(!1),j().D6({label:e.formatMessage({defaultMessage:"GitHub disconnected. This can take up to 3 hours.",id:"githubAIConnector.settings.confirmation.disconnected"}),position:"bottom"}))},children:(0,S.jsx)(k().sA,{id:"githubAIConnector.settings.confirmDisconnectModal.confirmDisconnect",defaultMessage:"Disconnect for everyone"})}),(0,S.jsx)(b().Ay,{style:g.goBackButton,onClick:u,children:(0,S.jsx)(k().sA,{id:"githubAIConnector.settings.confirmDisconnectModal.goBack",defaultMessage:"Go back"})})]})]})})}),(0,S.jsx)(te().a,{showCloseIcon:!0,onDismiss:c,open:"settings"===t,render:()=>(0,S.jsxs)("div",{style:g.wrapper,children:[(0,S.jsx)(re().b,{connectorType:"github",title:(0,S.jsx)(k().sA,{id:"githubAIConnector.settings.settingsModalTitle",defaultMessage:"GitHub is connected to Notion AI"}),subtext:(0,S.jsx)(k().sA,{id:"githubAIConnector.settings.canAnswerFrom",defaultMessage:"Notion AI can answer questions about your GitHub repositories."})}),(0,S.jsxs)(P().wt,{style:g.footer,children:[(0,S.jsx)(H().A,{size:"lg",style:g.editChannelsButton,onClick:p,children:(0,S.jsx)(k().sA,{id:"githubAIConnector.settings.editRepos",defaultMessage:"Edit Selected Repositories"})}),(0,S.jsx)(Je().E,{style:g.disconnectButton,onClick:()=>{(0,M().u)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"account_disconnect",integration_type:"github",setup_session_id:Re().o.state.sessionId,from:"connection_settings"}}}),o(!0)},children:(0,S.jsx)(k().sA,{id:"githubAIConnector.settings.disconnectGithub",defaultMessage:"Disconnect"})}),(0,S.jsx)(b().Ay,{style:g.learnMoreButton,onClick:()=>{(0,M().u)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"learn_more_click_settings_modal",integration_type:"github",setup_session_id:Re().o.state.sessionId,from:"connection_settings"}}});const e=(0,Le().x)("guides.aiConnectorGithub");window.open(e,"_blank")},children:(0,S.jsxs)(P().Ye,{style:g.learnMoreText,children:[(0,S.jsx)(k().sA,{id:"githubAIConnector.settings.learnMore",defaultMessage:"Learn more"}),(0,S.jsx)(W().I,{icon:ze().arrowUpRightSquareSmallIcon,size:"sm"})]})})]})]})})]})};var $e=()=>n(753264),Qe=()=>n(155736);const Xe=(0,k().YK)({durationForIngestion:{id:"githubAiConnector.connectionComplete.durationForIngestion",defaultMessage:"This may take up to 72 hours"},githubAIConnectorConnectionCompleteListpoint2:{id:"githubAIConnector.connectionComplete.listpoint2",defaultMessage:"Each member of your workspace will be prompted to authenticate to GitHub."}});const Ze=function(){const e=(0,l().v3)(),t=(0,d().K8)((()=>Re().o.state.currentScreen),[]),n=(0,s.useCallback)((t=>{Re().o.setState({...Re().o.getInitialState(),isPersonalAuthComplete:!1,status:"in_progress",isConnected:!0}),(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:`github_ai_connector_got_it_${t}_click`,integration_type:"github",setup_session_id:Re().o.state.sessionId,from:Re().o.state.analyticsFrom}}}),j().D6({label:(0,S.jsx)(k().sA,{id:"aiConnectors.github.acknowledge",defaultMessage:"Started syncing from GitHub. This can take up to 72 hours."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,S.jsx)(b().Ay,{onClick:j().N2,children:(0,S.jsx)(k().sA,{id:"aiConnectors.github.startedMessageDismiss",defaultMessage:"Close"})})})}),[e]);return(0,s.useEffect)((()=>{"confirmation"===t&&(0,p().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:e,connector:"github",moment:"finished"})}),[e,t]),(0,S.jsx)(Qe().v,{open:"confirmation"===t,connectorType:"github",notes:[(0,S.jsx)($e().L,{number:1,title:Xe.durationForIngestion},"item1"),(0,S.jsx)($e().L,{number:2,title:Xe.githubAIConnectorConnectionCompleteListpoint2,description:{...{...Qe().D.defaultPermissionsWillBeRespected,values:{appName:"GitHub"}}}},"item2")],onDismiss:()=>n("dismiss"),onPrimaryButtonClick:()=>n("dismiss")})};var et=()=>n(534177),tt=()=>n(971732),nt=()=>n(243331),st=()=>n(335779);function ot(){const{learnMoreUrl:e,googleAuthUrl:t}=(0,g().hP)("gmail");return(0,S.jsx)(J().Z,{connector:"gmail",screenName:"introduction",nextScreens:{notStarted:"authentication",inProgress:"none",alreadyConnected:"already_connected",error:"error"},usesPopup:!1,learnMoreUrl:e,staticAuthUrl:t})}function it(){const e=(0,d().K8)((()=>st().XS.state.currentScreen),[]);return(0,S.jsx)(de().m,{connector:"gmail",open:"already_connected"===e,onDismiss:()=>{st().XS.reset()}})}function at(){const{learnMoreUrl:e}=(0,g().hP)("gmail");return(0,S.jsx)(ue().A,{connector:"gmail",screenName:"not_admin_screen",learnMoreUrl:e})}function rt(){return(0,S.jsx)(A().a,{connector:"gmail",screenName:"connection_complete_screen",nextScreens:{notStarted:"authentication",inProgress:"none",alreadyConnected:"already_connected",error:"error"},ingestionNotNeeded:!0,onStartIngestion:void 0})}function ct(){const e=(0,d().K8)((()=>st().XS.state.connectionConflictSpaceId),[]);return(0,S.jsx)(tt().$,{connector:"gmail",screenName:"connection_exist_screen",nextScreens:{settings:"none"},connectedSpaceId:e??""})}function lt(){const e=(0,l().v3)(),t=(0,i().r)(),{learnMoreUrl:n,googleAuthUrl:s,troubleShootingUrl:o}=(0,g().hP)("gmail");return t?(0,S.jsx)(y().R,{connector:"gmail",screenName:"authentication",nextScreens:{notAdminOfConnectorAccount:"not_admin_screen",connectionConflict:"connection_exist_screen",connectionSuccess:"connection_complete_screen",error:"error"},learnMoreUrl:n,troubleShootingUrl:o,staticConnectorAuthUrl:s,setConnectionStateAsConnected:()=>{st().XS.setState({...st().XS.state,status:"authenticated",isConnected:!0,isPersonalAuthComplete:!0}),nt().Lf.setState({...nt().Lf.state,status:"not_started",isConnected:!1,isPersonalAuthComplete:!1})},setConnectionConflictSpaceId:e=>{st().XS.setState({...st().XS.state,connectionConflictSpaceId:e})},callConnectionApi:async()=>{const n=await I().callApi({eventName:"connectAiConnector",environment:e,data:{spaceId:t,connector:"gmail"}});if("success"!==n.type)return Promise.resolve({type:"success",data:{connectionSuccess:!1,errorResponse:{status:400}}});const s=n.data;return s.success?(st().XS.setState({...st().XS.state,externalSourceName:s.externalSourceName}),Promise.resolve({type:"success",data:{connectionSuccess:!0}})):"3p_connected_to_another_workspace"===s.failureReason?Promise.resolve({type:"success",data:{connectionSuccess:!1,errorResponse:{status:400,errorCode:"GOOGLE_MAPPING_EXIST",data:{spaceId:s.alreadyConnectedSpaceId}}}}):"not_3p_admin"===s.failureReason?Promise.resolve({type:"success",data:{connectionSuccess:!1,errorResponse:{status:403}}}):"not_connected"===s.failureReason?Promise.resolve({type:"success",data:{connectionSuccess:!1,errorResponse:{status:401}}}):void(0,et().HB)(s.failureReason)}}):null}function dt(){return(0,S.jsx)(Z().e,{connector:"gmail",screenName:"settings",nextScreens:{disconnect:"disconnect_screen",error:"error"},settings:void 0})}function ut(){const{marketplaceAppConfigureUrl:e,marketplaceAppName:t}=(0,g().hP)("gmail");return(0,S.jsx)(w().X,{connector:"gmail",postDisconnectScreenName:"post_disconnect_screen",disconnectScreenName:"disconnect_screen",settingsScreenName:"settings",errorScreenName:"error",setStatusAsDisconnected:()=>{st().XS.setState({...st().XS.state,status:"not_started",isConnected:!1,isLoaded:!0})},showGoogleWorkspaceNote:!0,marketplaceAppConfigureUrl:e,marketplaceAppName:t})}function pt(){return(0,S.jsx)(R().b,{connector:"gmail",screenName:"error"})}var gt=()=>n(246679),mt=()=>n(356584);function ht(){const{learnMoreUrl:e,googleAuthUrl:t}=(0,g().hP)("google-calendar");return(0,S.jsx)(J().Z,{connector:"google-calendar",screenName:"introduction",nextScreens:{notStarted:"authentication",inProgress:"none",alreadyConnected:"already_connected",error:"error"},usesPopup:!1,learnMoreUrl:e,staticAuthUrl:t})}function vt(){const e=(0,d().K8)((()=>mt().Wz.state.currentScreen),[]);return(0,S.jsx)(de().m,{connector:"google-calendar",open:"already_connected"===e,onDismiss:()=>{mt().Wz.reset()}})}function ft(){const{learnMoreUrl:e}=(0,g().hP)("google-calendar");return(0,S.jsx)(ue().A,{connector:"google-calendar",screenName:"not_admin_screen",learnMoreUrl:e})}function yt(){return(0,S.jsx)(A().a,{connector:"google-calendar",screenName:"connection_complete_screen",nextScreens:{notStarted:"authentication",inProgress:"none",alreadyConnected:"already_connected",error:"error"},ingestionNotNeeded:!0,onStartIngestion:void 0})}function xt(){const e=(0,d().K8)((()=>mt().Wz.state.connectionConflictSpaceId),[]);return(0,S.jsx)(tt().$,{connector:"google-calendar",screenName:"connection_exist_screen",nextScreens:{settings:"none"},connectedSpaceId:e??""})}function St(){const e=(0,l().v3)(),t=(0,i().r)(),{learnMoreUrl:n,googleAuthUrl:s,troubleShootingUrl:o}=(0,g().hP)("google-calendar");return t?(0,S.jsx)(y().R,{connector:"google-calendar",screenName:"authentication",nextScreens:{notAdminOfConnectorAccount:"not_admin_screen",connectionConflict:"connection_exist_screen",connectionSuccess:"connection_complete_screen",error:"error"},learnMoreUrl:n,troubleShootingUrl:o,staticConnectorAuthUrl:s,setConnectionStateAsConnected:()=>{mt().Wz.setState({...mt().Wz.state,status:"authenticated",isConnected:!0,isPersonalAuthComplete:!0}),gt().gv.setState({...gt().gv.state,status:"not_started",isConnected:!1,isPersonalAuthComplete:!1})},setConnectionConflictSpaceId:e=>{mt().Wz.setState({...mt().Wz.state,connectionConflictSpaceId:e})},callConnectionApi:async()=>{const n=await I().callApi({eventName:"connectAiConnector",environment:e,data:{spaceId:t,connector:"google-calendar"}});if("success"!==n.type)return Promise.resolve({type:"success",data:{connectionSuccess:!1,errorResponse:{status:400}}});const s=n.data;return s.success?(mt().Wz.setState({...mt().Wz.state,externalSourceName:s.externalSourceName}),Promise.resolve({type:"success",data:{connectionSuccess:!0}})):"3p_connected_to_another_workspace"===s.failureReason?Promise.resolve({type:"success",data:{connectionSuccess:!1,errorResponse:{status:400,errorCode:"GOOGLE_MAPPING_EXIST",data:{spaceId:s.alreadyConnectedSpaceId}}}}):"not_3p_admin"===s.failureReason?Promise.resolve({type:"success",data:{connectionSuccess:!1,errorResponse:{status:403}}}):"not_connected"===s.failureReason?Promise.resolve({type:"success",data:{connectionSuccess:!1,errorResponse:{status:401}}}):void(0,et().HB)(s.failureReason)}}):null}function _t(){return(0,S.jsx)(Z().e,{connector:"google-calendar",screenName:"settings",nextScreens:{disconnect:"disconnect_screen",error:"error"},settings:void 0})}function jt(){const{marketplaceAppConfigureUrl:e,marketplaceAppName:t}=(0,g().hP)("google-calendar");return(0,S.jsx)(w().X,{connector:"google-calendar",postDisconnectScreenName:"post_disconnect_screen",disconnectScreenName:"disconnect_screen",settingsScreenName:"settings",errorScreenName:"error",setStatusAsDisconnected:()=>{mt().Wz.setState({...mt().Wz.state,status:"not_started",isConnected:!1,isLoaded:!0})},showGoogleWorkspaceNote:!0,marketplaceAppConfigureUrl:e,marketplaceAppName:t})}function bt(){return(0,S.jsx)(R().b,{connector:"google-calendar",screenName:"error"})}function kt(){const e=(0,d().K8)((()=>v().d.state.currentScreen),[]);return(0,S.jsx)(de().m,{open:"already_connected"===e,onDismiss:()=>{v().d.reset()},connector:"google-drive"})}function It(){const[e,t]=s.useState(!1),n=(0,D().IS)((()=>({noteHeading:{fontWeight:z().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:z().Wy.regular,color:N().Tj.text.secondary,fontSize:14,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:N().Tj.text.secondary,textDecoration:"underline",cursor:"pointer"},warningText:{fontSize:14,lineHeight:"18px",color:"#D7813A",paddingInlineStart:14},warningContainer:{marginInlineStart:5,marginInlineEnd:5,marginBottom:15}})),[]),o=(0,l().v3)(),a=(0,i().r)(),r=(0,d().K8)((()=>v().d.state.sessionId),[]),u=(0,d().K8)((()=>v().d.state.currentScreen),[]),g=(0,d().K8)((()=>v().d.state.analyticsFrom),[]),m=(0,d().K8)((()=>c().default.getConfigKey("ingestion","googleDrive").googleAuthUrl),[]),h=(0,d().K8)((()=>c().default.getConfigKey("ingestion","googleDrive").troubleShootingUrl),[]),f=(0,d().K8)((()=>c().default.getConfigKey("ingestion","googleDrive").learnMoreUrl),[]),y=(0,s.useCallback)((async()=>{if(!a)return;var e;await(e=5e3,new Promise((t=>setTimeout(t,e))));const n=await I().callApi({eventName:"connectGoogleDriveForAIIngestion",environment:o,data:{spaceId:a}}),s=e=>{(0,M().u)({environment:o,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:e,integration_type:"google-drive",setup_session_id:r,from:g}}})};var i,c,l;"success"===n.type?n.data.connectionSuccess?(s("auth_screen_connected"),v().d.setState({...v().d.state,currentScreen:"connection_complete_screen",availableSyncControlOptions:n.data.syncControlOptions})):((e,n,o)=>{switch(e){case 401:s("auth_screen_not_connected_warning"),t(!0);break;case 403:s("info_screen_connect_not_admin_screen"),(0,p().navigateToGoogleDriveUniversalScreen)({screenToShow:"not_admin_screen",analyticsFrom:g,sessionId:r});break;case 400:"GOOGLE_MAPPING_EXIST"===n&&o?(s("workspace_already_connected"),v().d.setState({...v().d.state,connectedSpaceId:o}),(0,p().navigateToGoogleDriveUniversalScreen)({screenToShow:"connection_exist_screen",analyticsFrom:g,sessionId:r})):(0,p().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:g,sessionId:r});break;default:(0,p().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:g,sessionId:r})}})(null==n||null===(i=n.data)||void 0===i||null===(i=i.errorResponse)||void 0===i?void 0:i.status,null==n||null===(c=n.data)||void 0===c||null===(c=c.errorResponse)||void 0===c?void 0:c.errorCode,null==n||null===(l=n.data)||void 0===l||null===(l=l.errorResponse)||void 0===l||null===(l=l.data)||void 0===l?void 0:l.spaceId):(0,p().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:g,sessionId:r})}),[g,o,r,a]),x=(0,s.useCallback)((()=>[(0,S.jsxs)(P().wt,{style:{gap:4},children:[(0,S.jsx)("div",{style:n.noteHeading,children:(0,S.jsx)(k().sA,{id:"universalSearch.googleDrive.waitingForConnectionNoteHeading1",defaultMessage:"Google should open automatically on a new browser tab."},"note1-1")}),(0,S.jsx)("div",{style:n.noteBody,children:(0,S.jsx)(k().sA,{id:"universalSearch.googleDrive.authWaiting",defaultMessage:"If it doesn’t, {ClickHereToRetry}",values:{ClickHereToRetry:(0,S.jsx)("a",{style:n.link,href:m,target:"_blank",onClick:()=>{(0,M().u)({environment:o,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen_open_auth_url",integration_type:"google-drive",setup_session_id:r,from:g}}})},children:(0,S.jsx)(k().sA,{id:"universalSearch.googleDrive.confirmModalNote1Retry",defaultMessage:"click here to retry"})})}},"note1-2")})]},"note-1"),(0,S.jsxs)(P().wt,{style:{gap:4},children:[(0,S.jsx)("div",{style:n.noteHeading,children:(0,S.jsx)(k().sA,{id:"universalSearch.googleDrive.workspaceAdminHeading",defaultMessage:"Follow Google’s setup instructions"},"note2-1")}),(0,S.jsx)("div",{style:n.noteBody,children:(0,S.jsx)(k().sA,{id:"universalSearch.googleDrive.workspaceAdminBody",defaultMessage:"For better AI answers, we recommend selecting the option “All users in my organization”. In the next steps, you’ll be able to exclude specific Drives and can always update your selection."},"note2-2")})]},"note-2"),(0,S.jsx)(P().wt,{style:{gap:4},children:(0,S.jsx)("div",{style:n.noteHeading,children:(0,S.jsx)(k().sA,{id:"universalSearch.googleDrive.done",defaultMessage:"When you’re done, click the button below"},"note3-1")})},"note-3")]),[n,m,o,r,g]),_=e?(0,S.jsxs)(P().Ye,{style:n.warningContainer,children:[(0,S.jsx)(W().I,{icon:F().exclamationMarkTriangleFillIcon,colorPalette:"orange",colorVariant:"accentPrimary"}),(0,S.jsx)("div",{style:n.warningText,children:(0,S.jsx)(k().sA,{id:"universalQnA.googleDrive.AuthScreen.warning",defaultMessage:"We couldn’t connect to Google. Please review the instructions and try again, or check our {TroubleshootingGuide}",values:{TroubleshootingGuide:(0,S.jsx)("a",{style:{...n.link,color:"#D7813A"},href:h,target:"_blank",onClick:()=>{(0,M().u)({environment:o,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"troubleshooting_guide_opened",integration_type:"google-drive",setup_session_id:r,from:g}}})},children:(0,S.jsx)(k().sA,{id:"universalSearch.googleDrive.troubleShootingLink",defaultMessage:"troubleshooting guide."})})}})})]}):void 0;return(0,S.jsx)(E().Q,{title:(0,S.jsx)(k().sA,{id:"universalQnA.googleDrive.AuthScreen",defaultMessage:"Follow instructions from Google in your browser"}),open:"auth_screen"===u,onDismiss:()=>{t(!1),(0,M().u)({environment:o,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen_dismiss",integration_type:"google-drive",setup_session_id:r,from:g}}}),(0,p().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:g,sessionId:r})},warningMessage:_,notes:x(),openLearnMoreUrl:()=>{window.open(f)},connectorType:"google-drive",primaryButtonText:(0,S.jsx)(k().sA,{id:"universalSearch.googleDrive.Button.finishedSetup",defaultMessage:"Confirm connection"},"note3-1"),onClickPrimaryButton:y})}var At=()=>n(987267),Ct=(n(944114),n(672577),n(803949),()=>n(933922)),wt=()=>n(349679);function Tt(e){const{onPrimaryButtonClick:t,setShowConfirmModal:n}=e,o=(0,l().v3)(),i=(0,d().O$)(v().d),a=(0,d().K8)((()=>v().d.state.currentScreen),[]),[r,c]=(0,s.useState)(!1),u=(0,D().IS)((()=>({confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:z().Wy.semibold,color:N().Tj.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:14,fontWeight:z().Wy.regular,color:N().Tj.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:14,fontWeight:z().Wy.regular,width:"100%",textAlign:"center",paddingTop:4,paddingInlineEnd:0,paddingBottom:4,paddingInlineStart:0},confirmDisconnectButton:{fontSize:14,fontWeight:z().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20}})),[]),p=e=>{v().d.setState({...i,currentScreen:e})};return(0,S.jsx)(te().a,{showCloseIcon:!0,open:"select_shared_drives_screen"===a,onDismiss:()=>{(0,M().u)({environment:o,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"edit_confirm_modal_close",integration_type:"google-drive",setup_session_id:i.sessionId,from:i.analyticsFrom}}}),p("none"),n(!1)},render:()=>(0,S.jsx)("div",{style:u.confirmWrapper,children:(0,S.jsxs)("div",{style:u.confirmContainer,children:[(0,S.jsx)("div",{style:u.confirmModalTitle,children:(0,S.jsx)(k().sA,{id:"universalSearch.googleDriveIngestion.confirmModal.title",defaultMessage:"Are you sure?"})}),(0,S.jsx)("div",{style:u.confirmModalSubTitle,children:(0,S.jsx)(k().sA,{id:"universalSearch.googleDriveIngestion.confirmModal.subTitle",defaultMessage:"Google Drive content will be disconnected and re-connected. This can take up to 36h and AI answers will be unavailable until it’s complete."})}),(0,S.jsxs)(P().wt,{style:u.confirmModalActionButtons,children:[(0,S.jsx)(ie().A,{colorPalette:"blue",isLoading:r,style:u.confirmDisconnectButton,disabled:i.isDisconnecting,onClick:async()=>{(0,M().u)({environment:o,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"edit_modal_confirm_button",integration_type:"google-drive",setup_session_id:i.sessionId,from:i.analyticsFrom}}}),c(!0),await t(),c(!1),n(!1),p("none")},children:(0,S.jsx)(k().sA,{id:"universalSearch.googleDriveIngestion.editModal.confirmDisconnect",defaultMessage:"Confirm"})}),(0,S.jsx)(b().Ay,{style:u.goBackButton,onClick:()=>{(0,M().u)({environment:o,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"edit_modal_cancel_button",integration_type:"google-drive",setup_session_id:i.sessionId,from:i.analyticsFrom}}}),n(!1)},children:(0,S.jsx)(k().sA,{id:"universalSearch.googleDriveIngestion.editModal.cancel",defaultMessage:"Cancel"})})]})]})})})}function Mt(e){const{drive:t,styles:n,onToggle:s}=e;return(0,S.jsxs)(P().Ye,{gap:8,style:{alignItems:"center",paddingTop:10,paddingInlineEnd:18,paddingBottom:6,paddingInlineStart:0},children:[(0,S.jsx)(ne().S,{checked:t.checked,size:14,onClick:()=>s(t.id)}),(0,S.jsx)("div",{style:n.drivesRow,children:`${t.name}`},`${t.id}#3`)]})}function Dt(e){const{styles:t,onPrimaryButtonClick:n,setShowConfirmModal:o,isFutureItemsChecked:a,setDriveCheckboxItems:r,sharedDriveCheckboxItems:c,setFutureItemsChecked:p}=e,g=(0,d().O$)(v().d),m=(0,d().K8)((()=>v().d.state.sessionId),[]),h=(0,d().K8)((()=>v().d.state.initialSyncState),[]),f=(0,d().K8)((()=>v().d.state.analyticsFrom),[]),y=(0,d().K8)((()=>v().d.state.currentScreen),[]),x=(0,i().r)(),[_,j]=(0,s.useState)(!1),b=(0,l().v3)(),A=(0,s.useRef)(!1);if((0,u().Yb)((async()=>{if(!x)return;if("pending_selection"===g.initialSyncState&&!A.current)return j(!0),await(async()=>{if(!x)return;const e=await I().callApi({eventName:"getSyncControlsForGoogleDriveAIIngestion",environment:b,data:{spaceId:x}});if("success"===(null==e?void 0:e.type)){const t=e.data;v().d.setState({...v().d.state,availableSyncControlOptions:t.options,syncControlSelection:t.selection})}A.current=!0})(),void j(!1);const e=g.availableSyncControlOptions.filter((e=>"shared_drive"===e.type));0===e.length&&"select_shared_drives_screen"===y&&(0,M().u)({environment:b,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"no_shared_drives",integration_type:"google-drive",setup_session_id:m,from:f}}});const t=g.syncControlSelection;if(!t)return r(e.map((e=>({...e,checked:!0})))),void p(!0);r(e.map((e=>({...e,checked:!t.driveIds||t.driveIds.includes(e.id)})))),p(t.enableSyncingFutureUsersAndDrives)}),[f,b,g,y,r,p,m,x]),!x)return null;const C=c.find((e=>e.checked))||a,w=e=>{(0,M().u)({environment:b,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"individual_drive_checkbox",integration_type:"google-drive",setup_session_id:g.sessionId,from:g.analyticsFrom}}}),r(c.map((t=>t.id===e?{...t,checked:!t.checked}:t)))},T=c.map((e=>(0,S.jsx)(Mt,{drive:e,styles:t,onToggle:w},e.id))).filter(et().O9);return(0,S.jsxs)(P().wt,{children:[(0,S.jsx)(P().Ye,{style:t.selectionWrapper,children:(0,S.jsxs)(P().wt,{style:t.scrollContainer,children:[(0,S.jsx)(se().A,{style:{paddingBottom:4},size:4}),(0,S.jsx)(P().Ye,{style:t.rowTitle,children:(0,S.jsxs)(P().Ye,{children:[(0,S.jsx)(P().wt,{children:(0,S.jsx)(k().sA,{id:"universalSearch.googleDriveIngestion.allItemsTitle",defaultMessage:"Content owned by users"})}),(0,S.jsx)(P().wt,{style:{paddingInlineStart:200},children:(0,S.jsx)(W().I,{icon:wt().checkmarkSmallIcon,size:"sm",colorVariant:"secondary"})})]})}),(0,S.jsx)(P().Ye,{style:t.rowAdditionalText,children:(0,S.jsx)(k().sA,{id:"universalSearch.googleDriveIngestion.allItemsSubtext",defaultMessage:"Includes all files owned by users selected in Google Workspace Settings"})}),(0,S.jsx)(se().A,{style:{paddingTop:10,paddingBottom:10},size:4}),(0,S.jsx)(P().Ye,{style:t.rowTitle,children:(0,S.jsx)(k().sA,{id:"universalSearch.googleDriveIngestion.allSharedDrivesTitle",defaultMessage:"Content in Shared Drives"})}),(0,S.jsx)(P().Ye,{style:t.rowAdditionalText,children:(0,S.jsx)(k().sA,{id:"universalSearch.googleDriveIngestion.allSharedDrivesSubtext",defaultMessage:"Includes files in Shared Drives as long as they are owned by users selected in the setting above."})}),(0,S.jsx)(P().Ye,{children:(0,S.jsx)(P().wt,{children:0===T.length?(0,S.jsx)(P().Ye,{style:{...t.rowAdditionalText,fontSize:14,paddingTop:10},children:(0,S.jsx)(k().sA,{id:"universalSearch.googleDriveIngestion.noSharedDrivesSubtext",defaultMessage:"No Shared Drives found"})}):T})})]})}),(0,S.jsxs)(P().wt,{style:t.footer,children:[(0,S.jsxs)(P().Ye,{style:{gap:4,alignItems:"center",width:"inherit"},children:[(0,S.jsx)(ne().S,{checked:a,size:14,onClick:()=>{(0,M().u)({environment:b,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:`future_items_checkbox_${(!a).toString()}`,integration_type:"google-drive",setup_session_id:g.sessionId,from:g.analyticsFrom}}}),p(!a)}}),(0,S.jsx)("div",{style:{fontSize:12,lineHeight:"16px",paddingBottom:2},children:(0,S.jsx)(k().sA,{id:"universalSearch.googleDriveIngestion.allSharedDrives",defaultMessage:"Include Drives created in the future"})})]}),(0,S.jsx)(ie().A,{colorPalette:"blue",style:t.continueButton,isLoading:_,disabled:!C,onClick:async()=>{j(!0),"completed"!==h?(await n(),j(!1)):o(!0)},children:(0,S.jsx)(k().sA,{id:"universalSearch.googleDriveIngestion.confirm",defaultMessage:"Confirm selection"})})]})]})}async function Pt(e){const{environment:t,spaceId:n}=e,{analyticsFrom:s,sessionId:o}=v().d.state;return"success"===(await I().callApi({eventName:"startGoogleDriveSyncForAIIngestion",environment:t,data:{spaceId:n,setupSessionId:o}})).type?(v().d.setState({...v().d.state,initialSyncState:"in_progress",ingestionProgress:1}),(0,p().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:s,sessionId:o}),!0):((0,p().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:s,sessionId:o}),!1)}const Wt=function(){const[e,t]=(0,s.useState)(!1),n=(0,d().K8)((()=>v().d.state.currentScreen),[]),o=(0,l().v3)(),a=(0,i().r)(),r=(0,d().O$)(v().d),c=(0,D().IS)((()=>({wrapper:{width:400},scrollContainer:{overflow:"scroll",paddingInlineEnd:20,height:350},rowTitle:{fontSize:12,lineHeight:"16px",fontWeight:510,paddingBottom:4},rowAdditionalText:{fontSize:12,lineHeight:"16px",color:N().Tj.text.secondary},drivesRow:{fontSize:14,lineHeight:"18px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},footer:{justifyContent:"center",alignItems:"center",bottom:0,width:"100%",height:75,boxShadow:N().Tj.shadowMD,paddingTop:16,paddingInlineEnd:20,paddingBottom:16,paddingInlineStart:20,gap:6},continueButton:{fontSize:14,fontWeight:z().Wy.semibold,width:360},selectionWrapper:{marginTop:24,paddingInlineStart:20,justifyContent:"center",overflow:"auto"},selection:{width:360,height:263},checkMark:{width:14,color:N().Tj.text.secondary}})),[]),u=(0,d().K8)((()=>v().d.state.sessionId),[]),g=(0,d().K8)((()=>v().d.state.analyticsFrom),[]),[m,h]=(0,s.useState)(!0),[f,y]=(0,s.useState)([]),x=()=>{v().d.setState({...v().d.state,syncControlSelection:{driveIds:[],enableSyncingFutureUsersAndDrives:!1},availableSyncControlOptions:[]})},_=(0,s.useCallback)((async()=>{let e=!0;m&&(e=!1);const t=[];if(f.forEach((n=>{if(n.checked===e){const{checked:e,...s}=n;t.push({...s})}})),(0,M().u)({environment:o,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drive_and_user_selector_primary_button",integration_type:"google-drive",setup_session_id:r.sessionId,from:r.analyticsFrom}}}),!a)return;const n=t,s=await I().callApi({eventName:"patchSyncControlsForGoogleDriveAIIngestion",environment:o,data:{spaceId:a,exclusionList:m?n:[],inclusionList:m?[]:n}}),i="in_progress"===v().d.state.initialSyncState||"completed"===v().d.state.initialSyncState;if("failed"===s.type)return void j().D6({label:(0,S.jsx)(k().sA,{id:"googleIngestionConfirmation.ingestion.failed",defaultMessage:"Cannot edit Google shared drives now. Please try again later."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,S.jsx)(b().Ay,{onClick:j().N2,children:(0,S.jsx)(k().sA,{id:"googleIngestionConfirmation.ingestion.failedMessageDismiss",defaultMessage:"Close"})})});const c="success"===s.type&&s.data.syncControlsUpdated||!i&&"success"===s.type&&!s.data.syncControlsUpdated,l=i&&"success"===s.type&&!s.data.syncControlsUpdated;if(c){const e=await Pt({environment:o,spaceId:a});x(),e&&j().D6({label:(0,S.jsx)(k().sA,{id:"googleIngestionConfirmation.ingestion.acknowledge",defaultMessage:"Started syncing from Google drive. This can take up to 36 hours."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,S.jsx)(b().Ay,{onClick:j().N2,children:(0,S.jsx)(k().sA,{id:"googleIngestionConfirmation.ingestion.startedMessageDismiss",defaultMessage:"Close"})})})}else l?(j().D6({label:(0,S.jsx)(k().sA,{id:"googleIngestionConfirmation.ingestion.skip",defaultMessage:"No change made to Google Drive Connection."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,S.jsx)(b().Ay,{onClick:j().N2,children:(0,S.jsx)(k().sA,{id:"googleIngestionConfirmation.ingestion.noConfigChangeDismiss",defaultMessage:"Close"})})}),x(),v().d.setState({...v().d.state,initialSyncState:"completed"}),(0,p().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:g,sessionId:u})):(x(),(0,p().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:g,sessionId:u}))}),[g,o,r,m,u,f,a]);return e?(0,S.jsx)(Tt,{onPrimaryButtonClick:_,setShowConfirmModal:t}):(0,S.jsx)(te().a,{showCloseIcon:!0,onDismiss:()=>{(0,p().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",sessionId:u,analyticsFrom:g})},open:"select_shared_drives_screen"===n,render:()=>(0,S.jsxs)("div",{style:c.wrapper,children:[(0,S.jsx)(re().b,{connectorType:"google-drive",title:(0,S.jsx)(k().sA,{defaultMessage:"Select Drives to Connect",id:"googleAiConnector.universalQnaSharedDriveSelectorPopup.selectDrivesToConnect"})}),(0,S.jsx)(Ct().A,{capture:!0,allowEsc:!0,render:()=>(0,S.jsx)(Dt,{styles:c,onPrimaryButtonClick:_,setShowConfirmModal:t,isFutureItemsChecked:m,setFutureItemsChecked:h,sharedDriveCheckboxItems:f,setDriveCheckboxItems:y})})]})})},Bt=At().w0["google-drive"];function Ft(){const e=(0,l().v3)(),t=(0,d().K8)((()=>v().d.state.sessionId),[]),n=(0,i().r)(),o=(0,d().K8)((()=>v().d.state.initialSyncState),[]),a=(0,d().K8)((()=>v().d.state.currentScreen),[]),r=(0,d().K8)((()=>v().d.state.analyticsFrom),[]),u=(0,s.useCallback)((()=>{(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"completion_screen_dismiss",integration_type:"google-drive",setup_session_id:t,from:r}}}),(0,p().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:r,sessionId:t})}),[r,e,t]);if((0,s.useEffect)((()=>{"connection_complete_screen"===a&&(0,p().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:e,connector:"google-drive",moment:"finished"})}),[e,a]),"completed"===o||!n)return(0,S.jsx)(S.Fragment,{});const g="in_progress"===o;return(0,S.jsx)(Qe().v,{open:"connection_complete_screen"===a,connectorType:"google-drive",notes:[(0,S.jsx)($e().L,{number:1,title:{...{...Qe().D.connectionInProgressTitle,values:{appName:Bt}}},description:Qe().D.defaultConnectionTime},"item1"),(0,S.jsx)($e().L,{number:2,title:{...{...Qe().D.defaultNotionAiWillBeAbleToAnswerQuestions,values:{appName:Bt}}}},"item2")],onEditSettingsClick:g?void 0:async()=>{if((0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"shared_drive_settings",integration_type:"google-drive",setup_session_id:t,from:r}}}),c().default.checkGate({gateName:"ai_connector_unification_google_drive"})){if("success"===(await(0,p().updateGoogleDriveConnectionStatus)({environment:e,spaceId:n})).status){const e=v().d.getState().initialSyncState;"in_progress"===e?(0,p().navigateToGoogleDriveUniversalScreen)({analyticsFrom:r,sessionId:t,screenToShow:"settings"}):"not_started"===e||"pending_selection"===e?(0,p().navigateToGoogleDriveUniversalScreen)({analyticsFrom:r,sessionId:t,screenToShow:"select_shared_drives_screen"}):(0,p().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:r,sessionId:t})}else(0,p().navigateToGoogleDriveUniversalScreen)({analyticsFrom:r,sessionId:t,screenToShow:"error"})}else{const o=await I().callCellCompatibleApi({eventName:"getGoogleDriveSyncProgress",environment:e,data:{spaceId:n},cellNavigation:{spaceId:n}});if("success"===o.type){var s;const e=(0,m().HB)((null===(s=o.data)||void 0===s?void 0:s.status)||"not_started");v().d.setState({...v().d.state,initialSyncState:e}),"in_progress"===e?(0,p().navigateToGoogleDriveUniversalScreen)({analyticsFrom:r,sessionId:t,screenToShow:"settings"}):"not_started"===e||"pending_selection"===e?(0,p().navigateToGoogleDriveUniversalScreen)({analyticsFrom:r,sessionId:t,screenToShow:"select_shared_drives_screen"}):(0,p().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:r,sessionId:t})}else(0,p().navigateToGoogleDriveUniversalScreen)({analyticsFrom:r,sessionId:t,screenToShow:"error"})}},onPrimaryButtonClick:async()=>{if((0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"completion_screen_done",integration_type:"google-drive",setup_session_id:t,from:r}}}),!n)return;if(g)return void(0,p().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:r,sessionId:t});await Pt({environment:e,spaceId:n})&&j().D6({label:(0,S.jsx)(k().sA,{id:"googleIngestionConfirmation.ingestion.acknowledge",defaultMessage:"Started syncing from Google drive. This can take up to 36 hours."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,S.jsx)(b().Ay,{onClick:j().N2,children:(0,S.jsx)(k().sA,{id:"googleIngestionConfirmation.ingestion.startedMessageDismiss",defaultMessage:"Close"})})})},onDismiss:u})}var Nt=()=>n(584262),zt=()=>n(254600);function Et(){const e=(0,d().K8)((()=>v().d.state.currentScreen),[]),t=(0,d().K8)((()=>v().d.state.sessionId),[]),n=(0,d().K8)((()=>v().d.state.analyticsFrom),[]),o=(0,d().K8)((()=>v().d.state.connectedSpaceId),[]),i=(0,l().v3)(),r=(0,D().IS)((()=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:N().Tj.shadowMD,paddingTop:20,paddingInlineEnd:20,paddingBottom:20,paddingInlineStart:20,gap:6},connectButton:{fontSize:14,fontWeight:z().Wy.semibold,width:"100%"}})),[]),c="connection_exist_screen"===e,u=(0,s.useCallback)((async()=>{const e=a().default.state.currentUserRootStore;if(!e)return;(0,M().u)({environment:i,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"visit_other_workspace",integration_type:"google-drive",setup_session_id:t,from:n}}});const s=e.getSpaceViewStores().filter((e=>e.getSpaceId()===o))[0];await(0,zt().t)({environment:i,navigationType:"switchingToOrLoadingSpace",pageVisitSource:Nt().y8.AIGoogleDriveQna,spaceViewStore:s,userRootStore:a().default.state.currentUserRootStore,userSettingsStore:a().default.state.currentUserSettingsStore}),v().d.reset(),v().d.setState({...v().d.state,currentScreen:"settings",analyticsFrom:"google_other_workspace",sessionId:t})}),[n,o,i,t]);return(0,S.jsx)(te().a,{showCloseIcon:!0,onDismiss:()=>(0,p().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:n,sessionId:t}),open:c,render:()=>(0,S.jsxs)("div",{style:r.wrapper,children:[(0,S.jsx)(re().b,{connectorType:"google-drive",title:(0,S.jsx)(k().sA,{id:"universalSearch.googleDrive.connectionExist.title",defaultMessage:"You’ve already connected Google Drive to another Notion workspace."}),subtext:(0,S.jsx)(k().sA,{id:"universalSearch.googleDrive.connectionExist.description",defaultMessage:"Currently, only one workspace can be connected to Google Drive. To connect this workspace, please disconnect the existing connection."})}),(0,S.jsx)(P().wt,{style:r.footer,children:(0,S.jsx)(ie().A,{colorPalette:"blue",style:r.connectButton,onClick:u,children:(0,S.jsx)(k().sA,{id:"universalSearch.googleDrive.connectionExist.navigateButton",defaultMessage:"Visit the other workspace"})})})]})})}var Ut=()=>n(4688),Lt=()=>n(157210);function Rt(){const e=(0,d().O$)(v().d),t=(0,d().K8)((()=>v().d.state.currentScreen),[]),n=(0,i().r)(),o=(0,d().K8)((()=>c().default.getConfigKey("ingestion","googleDrive").marketplaceAppConfigureUrl),[]),a=(0,d().K8)((()=>v().d.state.sessionId),[]),r=(0,d().K8)((()=>v().d.state.analyticsFrom),[]),u=(0,l().v3)(),p=async()=>{if(!n)return;const e=await async function(e){const{environment:t,spaceId:n}=e,s=await I().callApi({eventName:"disconnectGoogleDriveAIIngestion",environment:t,data:{spaceId:n,disconnectReason:"admin_disconnect"}});if("success"===s.type&&s.data.deletionInitiated)return v().d.setState({...v().d.state,currentScreen:"none",isDisconnecting:!0}),!0;return v().d.setState({...v().d.state,currentScreen:"error",isDisconnecting:!1}),!1}({environment:u,spaceId:n});e?j().D6({label:(0,S.jsx)(k().sA,{id:"universalSearch.googleDriveIngestion.disconnectModal.acknowledgeDisconnect",defaultMessage:"Started disconnecting Google Drive. This can take up to 3 hours."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,S.jsx)(b().Ay,{onClick:j().N2,children:(0,S.jsx)(k().sA,{id:"universalSearch.googleDriveIngestion.disconnectModal.dismissAcknowledgeDisconnect",defaultMessage:"Close"})})}):j().D6({label:(0,S.jsx)(k().sA,{id:"universalSearch.googleDriveIngestion.disconnectModal.disconnectError",defaultMessage:"Failed to disconnect Google Drive. Please try again later."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,S.jsx)(b().Ay,{onClick:j().N2,children:(0,S.jsx)(k().sA,{id:"universalSearch.googleDriveIngestion.disconnectModal.closeSnackbarError",defaultMessage:"Close"})})})},g=t=>{v().d.setState({...e,currentScreen:t})},m=(0,D().IS)((()=>({confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:z().Wy.semibold,color:N().Tj.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:14,fontWeight:z().Wy.regular,color:N().Tj.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:14,fontWeight:z().Wy.regular,color:N().Tj.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:14,fontWeight:z().Wy.regular,width:"100%",textAlign:"center",paddingTop:4,paddingInlineEnd:0,paddingBottom:4,paddingInlineStart:0},confirmDisconnectButton:{fontSize:14,fontWeight:z().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},notesSectionWrapper:{paddingTop:12,paddingInlineEnd:12,paddingBottom:12,paddingInlineStart:12,gap:13},noteBlockWrapper:{marginBottom:12,gap:8},note:{fontWeight:z().Wy.regular,fontSize:14,lineHeight:"18px"},noteHeading:{fontWeight:z().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:z().Wy.regular,color:N().Tj.text.secondary,fontSize:14,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:N().Tj.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{rotate:"45deg",cursor:"pointer",display:"inline",padding:0,margin:0}})),[]),h=(0,s.useCallback)((()=>{const{noteBlockWrapper:e,noteHeading:t,noteBody:n,link:s}=m;return[(0,S.jsxs)(P().wt,{style:e,children:[(0,S.jsx)("div",{style:t,children:(0,S.jsx)(k().sA,{id:"universalSearch.googleDrive.post_disconnect_screen.note_1.heading",defaultMessage:"Google Drive data will be permanently deleted from Notion"},"note1-1")}),(0,S.jsx)("div",{style:n,children:(0,S.jsx)(k().sA,{id:"universalSearch.googleDrive.post_disconnect_screen.note_1.body",defaultMessage:"This process can take up to 3 hours. You’ll only be able to reconnect after disconnecting is complete."},"note1-2")})]},"note-1"),(0,S.jsxs)(P().wt,{style:e,children:[(0,S.jsx)("div",{style:t,children:(0,S.jsx)(k().sA,{id:"universalSearch.googleDrive.post_disconnect_screen.note_2.heading",defaultMessage:"Uninstall the Notion AI app from your Google Workspace (optional)"},"note2-1")}),(0,S.jsx)("div",{style:n,children:(0,S.jsx)(k().sA,{id:"universalSearch.googleDrive.post_disconnect_screen.note_2.body",defaultMessage:"Go to your {NavigateToGoogleWorkspaceAppsSettings} and uninstall the Notion AI app.",values:{NavigateToGoogleWorkspaceAppsSettings:(0,S.jsx)("a",{style:s,href:o,target:"_blank",onClick:()=>{(0,M().u)({environment:u,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_screen_marketplace_app_disconnect_btn",integration_type:"google-drive",setup_session_id:a,from:r}}})},children:(0,S.jsx)(k().sA,{id:"universalSearch.googleDrive.post_disconnect_screen.disconnect_google_marketplace_app",defaultMessage:"Google Workspace {ArrowIcon}",values:{ArrowIcon:(0,S.jsx)(W().I,{icon:Ut().arrowStraightUpSmallIcon,size:"xxs",style:m.icon})}})})}},"note2-2")})]},"note-2")]}),[m,o,u,a,r]);return"post_disconnect_screen"===t?(0,S.jsx)(Lt().A,{onClickGotItBtn:()=>{g("none")},onDismiss:()=>{g("none")},open:"post_disconnect_screen"===t,connectorType:"google-drive",title:(0,S.jsx)(k().sA,{id:"universalSearch.googleDriveIngestion.post_disconnect_modal.title",defaultMessage:"Google Drive is Disconnecting from Notion"}),descriptionMessage:(0,S.jsx)(k().sA,{id:"universalSearch.googleDriveIngestion.post_disconnect_modal.description",defaultMessage:"Here’s what’s next:"}),message:(0,S.jsx)("div",{style:m.notesSectionWrapper,children:h().map(((e,t)=>(0,S.jsxs)(P().Ye,{gap:8,style:{marginTop:4,marginBottom:6},children:[(0,S.jsx)(Ue().A,{number:t+1}),(0,S.jsx)("div",{style:m.note,children:e})]},t)))})}):(0,S.jsx)(te().a,{showCloseIcon:!0,open:"disconnect_screen"===t,onDismiss:()=>{(0,M().u)({environment:u,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_modal_close",integration_type:"google-drive",setup_session_id:e.sessionId,from:e.analyticsFrom}}}),g("none")},render:()=>(0,S.jsx)("div",{style:m.confirmWrapper,children:(0,S.jsxs)("div",{style:m.confirmContainer,children:[(0,S.jsx)("div",{style:m.confirmModalTitle,children:(0,S.jsx)(k().sA,{id:"universalSearch.googleDriveIngestion.disconnectModal.title",defaultMessage:"Are you sure?"})}),(0,S.jsx)("div",{style:m.confirmModalSubTitle,children:(0,S.jsx)(k().sA,{id:"universalSearch.googleDriveIngestion.disconnectModal.subTitle",defaultMessage:"Google Drive data will be permanently deleted from Notion."})}),(0,S.jsx)("div",{style:m.confirmModalDescription,children:(0,S.jsx)(k().sA,{id:"universalSearch.googleDriveIngestion.disconnectModal.description",defaultMessage:"This process can take up to 3 hours, and you’ll only be able to reconnect after disconnecting is complete."})}),(0,S.jsxs)(P().wt,{style:m.confirmModalActionButtons,children:[(0,S.jsx)(ie().A,{colorPalette:"red",style:m.confirmDisconnectButton,disabled:e.isDisconnecting,onClick:async()=>{(0,M().u)({environment:u,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_modal_confirm_disconnect_button",integration_type:"google-drive",setup_session_id:e.sessionId,from:e.analyticsFrom}}}),await p(),g("post_disconnect_screen")},children:(0,S.jsx)(k().sA,{id:"universalSearch.googleDriveIngestion.disconnectModal.confirmDisconnect",defaultMessage:"Disconnect for everyone"})}),(0,S.jsx)(b().Ay,{style:m.goBackButton,onClick:()=>{(0,M().u)({environment:u,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_modal_back_button",integration_type:"google-drive",setup_session_id:e.sessionId,from:e.analyticsFrom}}}),g("settings")},children:(0,S.jsx)(k().sA,{id:"universalSearch.googleDriveIngestion.disconnectModal.goBack",defaultMessage:"Go back"})})]})]})})})}function Kt(){const e=(0,d().K8)((()=>v().d.state.currentScreen),[]),t=(0,d().K8)((()=>v().d.state.sessionId),[]),n=(0,d().K8)((()=>v().d.state.analyticsFrom),[]),o=(0,l().v3)(),i=(0,D().IS)((()=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:N().Tj.shadowMD,paddingTop:20,paddingInlineEnd:20,paddingBottom:20,paddingInlineStart:20,gap:6},connectButton:{fontSize:14,fontWeight:z().Wy.semibold,width:"100%"}})),[]),a="error"===e;return(0,s.useEffect)((()=>{a&&(0,M().u)({environment:o,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_connect_error",integration_type:"google-drive",setup_session_id:t,from:n}}})}),[a,n,t,o]),(0,S.jsx)(te().a,{showCloseIcon:!0,onDismiss:()=>(0,p().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:n,sessionId:t}),open:a,render:()=>(0,S.jsxs)("div",{style:i.wrapper,children:[(0,S.jsx)(re().b,{connectorType:"google-drive",title:(0,S.jsx)(k().sA,{id:"universalSearch.googleDrive.error.title",defaultMessage:"Oops! Something went wrong"}),subtext:(0,S.jsx)(k().sA,{id:"universalSearch.googleDrive.error.description",defaultMessage:"Something went wrong, please try again later."})}),(0,S.jsx)(P().wt,{style:i.footer,children:(0,S.jsx)(ie().A,{colorPalette:"blue",style:i.connectButton,onClick:()=>{(0,p().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:n,sessionId:t})},children:(0,S.jsx)(k().sA,{id:"universalSearch.googleDrive.error.Dismiss",defaultMessage:"Close"})})})]})})}var Ht=()=>n(706021),Ot=()=>n(96563),Gt=()=>n(390366);function Yt(){const[e,t]=s.useState(!1),n=(0,l().v3)(),o=(0,s.useMemo)((()=>(0,je().a)("google-drive")),[]),a=(0,s.useMemo)((()=>(0,je().J)("google-drive")),[]),r=(0,i().r)(),u=(0,d().K8)((()=>v().d.state.sessionId),[]),g=(0,d().K8)((()=>v().d.state.currentScreen),[]),y=(0,d().K8)((()=>v().d.state.analyticsFrom),[]),x=(0,d().K8)((()=>h().zD.canUseAiConnectorSearchScope("google-drive")),[]),_=(0,d().K8)((()=>c().default.getConfigKey("ingestion","googleDrive").learnMoreUrl),[]),j=(0,Se().L)(),b=(0,_e().J)(j),k=n.currentUser.id,A=(0,f().P)({name:"ai_connectors",spaceId:r,userId:k}),C="introduction"===g;return(0,s.useEffect)((()=>{C&&x&&(0,M().u)({environment:n,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:"google-drive",setup_session_id:u,from:y,is_space_admin:b,is_ai_eligible:A??!1}}})}),[y,n,A,C,b,u,x]),x?He().A.isMobile?(0,S.jsx)(Oe().S,{connectorType:"google-drive",open:C,onClosed:()=>{v().d.reset()},learnMoreUrl:_}):b?(0,S.jsx)(Ie().A,{connectorType:"google-drive",notes:o,onLearnMore:()=>{const e=c().default.getConfigKey("ingestion","googleDrive"),t=null==e?void 0:e.learnMoreUrl;window.open(t,"_blank")},onConnect:async()=>{r&&(t(!0),await async function(e,t,n,s){(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_connect",integration_type:"google-drive",setup_session_id:n,from:s}}}),(0,p().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:e,connector:"google-drive",moment:"started"});const o=await(0,Gt().B)(e,{name:"ai_connectors",spaceId:t,userId:e.currentUser.id});if(!(0,Ht().e2)(o))return void(0,Ot().pp)({connector:"google-drive",environment:e,analyticsFrom:"google_drive_connect_button",connectorsFeatureAvailability:o});if(c().default.checkGate({gateName:"ai_connector_unification_google_drive"})){if("failed"===(await(0,p().updateGoogleDriveConnectionStatus)({environment:e,spaceId:t})).status)return void(0,p().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:s,sessionId:n});const o=v().d.getState().initialSyncState;if("in_progress"===o)return(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"connection_complete_screen",integration_type:"google-drive",setup_session_id:n,from:s}}}),void(0,p().navigateToGoogleDriveUniversalScreen)({screenToShow:"settings",analyticsFrom:s,sessionId:n});if("completed"===o)return(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"already_connected_screen",integration_type:"google-drive",setup_session_id:n,from:s}}}),void(0,p().navigateToGoogleDriveUniversalScreen)({screenToShow:"already_connected",analyticsFrom:s,sessionId:n});"pending_selection"===o&&(0,p().navigateToGoogleDriveUniversalScreen)({screenToShow:"connection_complete_screen",analyticsFrom:s,sessionId:n})}else{var i,a;const o=await I().callCellCompatibleApi({eventName:"getGoogleDriveSyncProgress",environment:e,data:{spaceId:t},cellNavigation:{spaceId:t}});if("failed"===o.type)return void(0,p().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:s,sessionId:n});const r=(null==o||null===(i=o.data)||void 0===i?void 0:i.status)||"not_started",c=(0,m().HB)(r);if(v().d.setState({...v().d.state,initialSyncState:c,ingestionProgress:null==o||null===(a=o.data)||void 0===a?void 0:a.ingestionProgress}),"success"===o.type&&"in_progress"===c)return(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"connection_complete_screen",integration_type:"google-drive",setup_session_id:n,from:s}}}),void(0,p().navigateToGoogleDriveUniversalScreen)({screenToShow:"settings",analyticsFrom:s,sessionId:n});if("success"===o.type&&"completed"===c)return(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"already_connected_screen",integration_type:"google-drive",setup_session_id:n,from:s}}}),void(0,p().navigateToGoogleDriveUniversalScreen)({screenToShow:"already_connected",analyticsFrom:s,sessionId:n})}(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen",integration_type:"google-drive",setup_session_id:n,from:s}}}),(0,p().navigateToGoogleDriveUniversalScreen)({screenToShow:"auth_screen",analyticsFrom:s,sessionId:n});const r=c().default.getConfigKey("ingestion","googleDrive");window.open(r.googleAuthUrl,"_blank"),I().callApi({eventName:"initiateGoogleDriveDelayedIngestion",environment:e,data:{spaceId:t,setupSessionId:n}})}(n,r,u,y),t(!1))},onDismiss:()=>{(0,M().u)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_dismiss",integration_type:"google-drive",setup_session_id:u,from:y}}}),(0,p().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:y,sessionId:u})},title:a,isLoading:e,open:C}):(0,S.jsx)(ke().BN,{connector:"google-drive",handleClose:()=>(0,p().resetAiConnectorStatus)("google-drive"),open:C,analyticsFrom:y,setupSessionId:u,messages:be().Fn}):(0,S.jsx)(S.Fragment,{})}var qt=()=>n(212473);function Jt(){const e=(0,d().K8)((()=>v().d.state.currentScreen),[]),t=(0,d().K8)((()=>v().d.state.sessionId),[]),n=(0,d().K8)((()=>v().d.state.analyticsFrom),[]),s=(0,D().IS)((()=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:N().Tj.shadowMD,paddingTop:20,paddingInlineEnd:20,paddingBottom:20,paddingInlineStart:20,gap:6},connectButton:{fontSize:14,fontWeight:z().Wy.semibold,width:"100%"},iconWrapper:{width:16,height:16}})),[]);return(0,S.jsx)(te().a,{showCloseIcon:!0,onDismiss:()=>(0,p().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:n,sessionId:t}),open:"not_admin_screen"===e,render:()=>(0,S.jsxs)("div",{style:s.wrapper,children:[(0,S.jsx)(re().b,{connectorType:"google-drive",title:(0,S.jsx)(k().sA,{id:"universalSearch.googleDrive.notAdmin.title",defaultMessage:"Only Google Workspace Administrators can connect"}),subtext:(0,S.jsx)(k().sA,{id:"universalSearch.googleDrive.notAdmin.description",defaultMessage:"We can’t verify that this account is a Google Workspace Administrator. Please contact your admin to link Notion using their account."})}),(0,S.jsx)(P().wt,{style:s.footer,children:(0,S.jsxs)(ie().A,{colorPalette:"blue",style:s.connectButton,onClick:()=>{const e=c().default.getConfigKey("ingestion","googleDrive"),t=null==e?void 0:e.learnMoreUrl;window.open(t,"_blank")},children:[(0,S.jsx)(k().sA,{id:"universalSearch.googleDrive.notAdmin.learnMore",defaultMessage:"Learn more"}),(0,S.jsx)("div",{style:s.iconWrapper,children:(0,S.jsx)(W().I,{icon:qt().arrowUpRightSquareIcon})})]})})]})})}var Vt=()=>n(26697),$t=()=>n(921030);function Qt(e){const{styles:t,events:n,isEditButtonEnabled:s,navigateToScreen:o}=e,i=(0,l().v3)(),a=(0,d().O$)(v().d);return(0,S.jsx)(H().A,{...n,size:"lg",style:t,disabled:!s,onClick:()=>{(0,M().u)({environment:i,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_edit_drives_button",integration_type:"google-drive",setup_session_id:a.sessionId,from:a.analyticsFrom}}}),o("select_shared_drives_screen")},children:(0,S.jsx)(k().sA,{id:"universalSearch.googleDriveIngestion.settingsModal.editSyncControls",defaultMessage:"Edit Drives"})})}function Xt(e){const{styles:t,events:n,isDisconnectButtonEnabled:s,navigateToScreen:o}=e,a=(0,l().v3)(),r=(0,d().O$)(v().d),c=(0,i().r)(),u=(0,d().K8)((()=>v().d.state.initialSyncState),[]);return(0,S.jsx)(Je().E,{...n,style:t,disabled:!s,onClick:async()=>{if(c)if((0,M().u)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_disconnect_button",integration_type:"google-drive",setup_session_id:r.sessionId,from:r.analyticsFrom}}}),"completed"!==u){if("not_started"===u){if("success"===(await I().callApi({eventName:"disconnectGoogleDriveAIIngestion",environment:a,data:{spaceId:c,disconnectReason:"admin_disconnect"}})).type)return void o("none")}o("error")}else o("disconnect_screen")},children:(0,S.jsx)(k().sA,{id:"universalSearch.googleDriveIngestion.settingsModal.disconnectGoogleDrive",defaultMessage:"Disconnect"})})}const Zt=function(){const e=(0,d().O$)(v().d),t=(0,i().r)(),n=(0,d().K8)((()=>v().d.state.analyticsFrom),[]),o=(0,d().K8)((()=>v().d.state.currentScreen),[]),a=(0,d().K8)((()=>v().d.state.initialSyncState),[]),r=(0,d().K8)((()=>v().d.state.sessionId),[]),[g,h]=(0,s.useState)(!0),[f,y]=(0,s.useState)(!1),[x,_]=(0,s.useState)(!1),[A,C]=(0,s.useState)([]),w=(0,l().v3)();(0,u().Yb)((async()=>{if(!t||!w||"settings"!==o)return;h(!0);let e=a;if("none"===a)if(c().default.checkGate({gateName:"ai_connector_unification_google_drive"})){if("failed"===(await(0,p().updateGoogleDriveConnectionStatus)({environment:w,spaceId:t})).status)return void(0,p().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:n,sessionId:r});e=v().d.getState().initialSyncState}else{var s;const o=await I().callCellCompatibleApi({eventName:"getGoogleDriveSyncProgress",environment:w,data:{spaceId:t},cellNavigation:{spaceId:t}});if("failed"===o.type)return void(0,p().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:n,sessionId:r});const i=(null==o||null===(s=o.data)||void 0===s?void 0:s.status)||"not_started";e=(0,m().HB)(i),v().d.setState({...v().d.state,initialSyncState:e})}}),[n,w,a,o,r,t]),(0,u().Yb)((async()=>{if(t&&w&&"settings"===o&&"none"!==a)if("in_progress"===a)h(!1),y(!1),_(!1);else if("completed"===a||"not_started"===a||"pending_selection"===a){const e=await I().callApi({eventName:"getSyncControlsForGoogleDriveAIIngestion",environment:w,data:{spaceId:t}});if("success"===(null==e?void 0:e.type)){const t=e.data;h(!1),y(!0),"not_started"===a||"pending_selection"===a?v().d.setState({...v().d.state,availableSyncControlOptions:t.options}):(v().d.setState({...v().d.state,availableSyncControlOptions:t.options,syncControlSelection:t.selection}),C(t.options.filter((e=>t.selection.driveIds.includes(e.id))))),v().d.state.isEditing||"in_progress"===v().d.state.initialSyncState||_(!0)}else y(!1),_(!1),j().D6({label:(0,S.jsx)(k().sA,{id:"universalSearch.googleDriveIngestion.settingsModal.userError",defaultMessage:"Cannot disconnect Google Drive. Please contact Notion workspace admin."}),position:"bottom",style:{width:"600px",display:"flex",justifyContent:"space-between"},right:(0,S.jsx)(b().Ay,{onClick:j().N2,children:(0,S.jsx)(k().sA,{id:"universalSearch.googleDriveIngestion.settingsModal.closeSnackbarError",defaultMessage:"Close"})})})}}),[t,w,o,a]);const T=t=>{(0,p().navigateToGoogleDriveUniversalScreen)({screenToShow:t,analyticsFrom:e.analyticsFrom,sessionId:e.sessionId})},B=function(e){return(0,D().IS)((()=>({wrapper:{width:400,padding:"0 24px",minHeight:e?478:void 0},settingsWrapper:{justifyContent:"center",gap:12},googleDriveDetailsContainer:{fontSize:14,fontWeight:z().Wy.regular,color:N().Tj.text.secondary,gap:12},driveNamesContainer:{gap:2,color:N().Tj.text.primary},footer:{justifyContent:"center",alignItems:"center",width:"100%",gap:8},disconnectButton:{fontSize:14,fontWeight:z().Wy.medium,width:"100%"},moreDrivesContainer:{paddingTop:4,paddingInlineEnd:0,paddingBottom:4,paddingInlineStart:0},learnMoreSection:{padding:"24px 0"},learnMoreButton:{fontSize:14,fontWeight:z().Wy.semibold,borderRadius:"4px",width:"100%"},learnMoreText:{fontWeight:z().Wy.medium,fontSize:12,gap:5,justifyContent:"center",alignItems:"center",paddingTop:4,paddingInlineEnd:8,paddingBottom:4,paddingInlineStart:8,color:`${N().Tj.text.secondary}`},confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:z().Wy.semibold,color:N().Tj.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:14,fontWeight:z().Wy.regular,color:N().Tj.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:14,fontWeight:z().Wy.regular,color:N().Tj.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:14,fontWeight:z().Wy.regular,width:"100%",textAlign:"center",paddingTop:4,paddingInlineEnd:0,paddingBottom:4,paddingInlineStart:0},confirmDisconnectButton:{fontSize:14,fontWeight:z().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},spinner:{paddingTop:20,justifyContent:"center",alignItems:"center"},driveItemWrapper:{width:"100%",paddingTop:4,paddingInlineEnd:0,paddingBottom:4,paddingInlineStart:0,alignItems:"center"},driveName:{fontSize:14},driveIcon:{width:20,color:N().Tj.text.secondary}})),[e])}(g);return(0,S.jsx)(te().a,{showCloseIcon:!0,open:"settings"===o,onDismiss:()=>{(0,M().u)({environment:w,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_close",integration_type:"google-drive",setup_session_id:e.sessionId,from:e.analyticsFrom}}}),C([]),T("none")},render:()=>{var t,n,s;return(0,S.jsxs)("div",{style:B.wrapper,children:[(0,S.jsx)(re().b,{connectorType:"google-drive",title:"completed"===a?(0,S.jsx)(k().sA,{id:"universalSearch.googleDriveIngestion.settingsModalTitle",defaultMessage:"Google Drive is connected to Notion AI"}):(0,S.jsx)(k().sA,{id:"universalSearch.googleDriveIngestion.settingsModalTitle2",defaultMessage:"Google Drive is connecting to Notion AI"})}),g?(0,S.jsx)(P().Ye,{style:B.spinner,children:(0,S.jsx)(oe().k,{})}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(P().Ye,{style:B.settingsWrapper,children:(0,S.jsxs)(P().wt,{style:B.googleDriveDetailsContainer,children:[(0,S.jsx)(P().wt,{children:"completed"===a?(0,S.jsx)(k().sA,{id:"universalSearch.googleDriveIngestion.settingsModal.canAnswerFrom",defaultMessage:"Notion AI is connected and can answer questions with content from {driveCountMessage}{futureDrivesMessage}",values:{driveCountMessage:A.length?`${A.length} Google Drives`:"Google Drive",futureDrivesMessage:null!==(t=e.syncControlSelection)&&void 0!==t&&t.enableSyncingFutureUsersAndDrives?", including future drives and users.":"."}}):(0,S.jsx)(k().sA,{id:"universalSearch.googleDriveIngestion.settingsModal.canAnswerFrom2",defaultMessage:"This can take up to 36h. You can cancel or modify your settings when the connection is complete. "})}),(0,S.jsxs)(P().wt,{children:[(0,S.jsxs)(P().wt,{style:B.driveNamesContainer,children:[null!==(n=e.syncControlSelection)&&void 0!==n&&n.enableSyncingFutureUsersAndDrives?(0,S.jsxs)(P().Ye,{style:B.driveItemWrapper,children:[(0,S.jsx)(P().wt,{style:B.driveIcon,children:(0,S.jsx)(W().I,{icon:$t().F,size:"xs"})}),(0,S.jsx)(P().wt,{style:B.driveName,children:(0,S.jsx)("div",{children:(0,S.jsx)(k().sA,{id:"universalSearch.googleDriveIngestion.settingsModal.includeCurrentAndFutureDrives",defaultMessage:"Includes current and future drives"})})})]}):void 0,null===(s=A.slice(0,4))||void 0===s?void 0:s.map((e=>(0,S.jsx)("div",{children:(0,S.jsxs)(P().Ye,{style:B.driveItemWrapper,children:[(0,S.jsx)(P().wt,{style:B.driveIcon,children:(0,S.jsx)(W().I,{icon:$t().F,size:"xs"})}),(0,S.jsx)(P().wt,{style:B.driveName,children:`${e.name}`})]})},e.id)))]}),(0,S.jsx)(P().Ye,{style:B.moreDrivesContainer,children:A.length-4>0?(0,S.jsx)(k().sA,{id:"universalSearch.googleDriveIngestion.settingsModal.moreDrives",defaultMessage:"... and {moreDriveCount} more",values:{moreDriveCount:A.length-4}}):(0,S.jsx)(S.Fragment,{})})]})]})}),(0,S.jsxs)(P().wt,{style:B.footer,children:[x?(0,S.jsx)(Qt,{styles:B.disconnectButton,isEditButtonEnabled:x,navigateToScreen:T}):(0,S.jsx)(Vt().m,{allowHover:!0,textWrap:!0,renderTooltip:()=>(0,S.jsx)("div",{style:{width:240},children:(0,S.jsx)(k().sA,{id:"universalSearch.googleDriveIngestion.editDrive.tooltip",defaultMessage:"You can cancel or modify your settings when the connection is complete. "})}),render:e=>(0,S.jsx)(Qt,{events:e,styles:B.disconnectButton,isEditButtonEnabled:x,navigateToScreen:T})}),f?(0,S.jsx)(Xt,{styles:B.disconnectButton,isDisconnectButtonEnabled:f,navigateToScreen:T}):(0,S.jsx)(Vt().m,{allowHover:!0,textWrap:!0,renderTooltip:()=>(0,S.jsx)("div",{style:{width:240},children:(0,S.jsx)(k().sA,{id:"universalSearch.googleDriveIngestion.editDrive.tooltip",defaultMessage:"You can cancel or modify your settings when the connection is complete. "})}),render:e=>(0,S.jsx)(Xt,{events:e,styles:B.disconnectButton,isDisconnectButtonEnabled:f,navigateToScreen:T})})]}),(0,S.jsx)(P().Ye,{style:B.learnMoreSection,children:(0,S.jsx)(b().Ay,{style:B.learnMoreButton,onClick:()=>{(0,M().u)({environment:w,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_learn_more_url_click",integration_type:"google-drive",setup_session_id:e.sessionId,from:e.analyticsFrom}}}),(()=>{const e=c().default.getConfigKey("ingestion","googleDrive"),t=null==e?void 0:e.learnMoreUrl;t&&window.open(t,"_blank")})()},children:(0,S.jsxs)(P().Ye,{style:B.learnMoreText,children:[(0,S.jsx)(k().sA,{id:"universalSearch.integration.learnMore",defaultMessage:"Learn more"}),(0,S.jsx)(W().I,{icon:ze().arrowUpRightSquareSmallIcon,size:"sm"})]})})})]})]})}})};function en(){const e=(0,d().K8)((()=>v().d.state.currentScreen),[]),t=(0,d().K8)((()=>v().d.state.sessionId),[]),n=(0,d().K8)((()=>v().d.state.analyticsFrom),[]),s=(0,D().IS)((()=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:N().Tj.shadowMD,paddingTop:20,paddingInlineEnd:20,paddingBottom:20,paddingInlineStart:20,gap:6},connectButton:{fontSize:14,fontWeight:z().Wy.semibold,width:"100%"},iconWrapper:{width:16,height:16}})),[]);return(0,S.jsx)(te().a,{showCloseIcon:!0,onDismiss:()=>(0,p().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",sessionId:t,analyticsFrom:n}),open:"service_account_not_added"===e,render:()=>(0,S.jsxs)("div",{style:s.wrapper,children:[(0,S.jsx)(re().b,{connectorType:"google-drive",title:(0,S.jsx)(k().sA,{id:"universalSearch.googleDrive.accountNotAdded.title",defaultMessage:"First, get your Google Workspace ready"}),subtext:(0,S.jsx)(k().sA,{id:"universalSearch.googleDrive.accountNotAdded.description",defaultMessage:"Before linking Google Drive with Notion, you’ll need to modify a few settings in your Google Workspace."})}),(0,S.jsx)(P().wt,{style:s.footer,children:(0,S.jsxs)(ie().A,{colorPalette:"blue",style:s.connectButton,onClick:()=>{const e=c().default.getConfigKey("ingestion","googleDrive"),t=null==e?void 0:e.learnMoreUrl;window.open(t,"_blank")},children:[(0,S.jsx)(k().sA,{id:"universalSearch.integration.seeInstruction",defaultMessage:"See instructions"}),(0,S.jsx)("div",{style:s.iconWrapper,children:(0,S.jsx)(W().I,{icon:qt().arrowUpRightSquareIcon})})]})})]})})}var tn=()=>n(311546),nn=()=>n(937854);const sn=(0,k().YK)({tokenPlaceholder:{id:"universalQnA.jira.authScreen.tokenPlaceholder",defaultMessage:"Paste your API Token here"},siteUrlPlaceholder:{id:"universalQnA.jira.authScreen.siteUrlPlaceholder",defaultMessage:"https://your-company.atlassian.net"},createTokenLink:{id:"universalQnA.jira.authScreen.createTokenLink",defaultMessage:"Create API Token"}});function on(){const[e,t]=(0,s.useState)(""),[n,o]=(0,s.useState)(""),[a,r]=(0,s.useState)(!1),u=(0,i().r)(),p=(0,l().v3)(),g=(0,k().tz)(),m=(0,d().K8)((()=>nn().EF.state.sessionId),[]),h=(0,d().K8)((()=>nn().EF.state.analyticsFrom),[]),v=(0,d().K8)((()=>nn().EF.state.currentScreen),[]),f=(0,d().K8)((()=>c().default.getConfigKey("jira_ingestion_config_v2","learnMoreUrl")),[]),y=(0,D().IS)((()=>({noteHeading:{fontWeight:z().Wy.medium,fontSize:z().J.UIRegular.desktop,lineHeight:"18px"},noteBody:{marginTop:8,fontWeight:z().Wy.regular,color:N().Tj.text.secondary,fontSize:z().J.UIRegular.desktop,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:N().Tj.text.secondary,cursor:"pointer",textDecoration:"underline",fontSize:z().J.UISmall.desktop,marginInlineStart:3},inputContainer:{marginTop:8},input:{width:"100%"},bulletPoint:{marginTop:4,marginBottom:4,position:"relative",paddingInlineStart:8},bulletPointText:{fontSize:z().J.UISmall.desktop,lineHeight:"16px",lineBreak:"anywhere"},bulletDot:{position:"absolute",insetInlineStart:-4,top:6,width:4,height:4,borderRadius:"50%",backgroundColor:"#9B9A97"},warningText:{fontSize:z().J.UIRegular.desktop,lineHeight:"18px",color:"#D7813A",paddingInlineStart:14,fontWeight:z().Wy.regular},warningContainer:{marginInlineStart:5,marginInlineEnd:5,marginBottom:15},warningIcon:{width:18,height:17,color:"#D7813A",marginTop:2}})),[]),x=(0,s.useCallback)((async()=>{try{if((0,M().u)({environment:p,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"jira_auth_submit",integration_type:"jira",setup_session_id:m,from:h}}}),!u)throw new Error("Space ID is required");if("failed"===(await tn().R({environment:p,spaceId:u,jiraApiToken:n,jiraSiteUrl:e})).status)return void r(!0);r(!1),nn().EF.setState({...nn().EF.state,currentScreen:"connection_complete_screen",jiraSyncState:"pending_selection"})}catch(t){r(!0)}}),[h,p,m,u,n,e]),_=(0,d().K8)((()=>c().default.getConfigKey("jira_ingestion_config_v2","createTokenHelpUrl")),[]),j=a?(0,S.jsxs)(P().Ye,{style:y.warningContainer,children:[(0,S.jsx)(W().I,{icon:F().exclamationMarkTriangleFillIcon,style:y.warningIcon}),(0,S.jsx)("div",{style:y.warningText,children:(0,S.jsx)(k().sA,{id:"universalQnA.jira.authScreen.warning",defaultMessage:"We couldn’t authenticate with the provided credentials. Please check your Jira Site URL and API Token and try again."})})]}):void 0;return u?(0,S.jsx)(E().Q,{title:(0,S.jsx)(k().sA,{id:"universalQnA.jira.authScreen.title",defaultMessage:"Step 2: Create a Forge App"}),subText:(0,S.jsx)(k().sA,{id:"universalQnA.jira.authScreen.description",defaultMessage:"We’ll help you create an Atlassian Forge App with the credentials below"}),open:"auth_input_screen"===v,onDismiss:()=>{r(!1),(0,M().u)({environment:p,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen_dismiss",integration_type:"jira",setup_session_id:m,from:h}}}),nn().EF.setState({...nn().EF.state,currentScreen:"none"})},warningMessage:j,connectorType:"jira",primaryButtonText:(0,S.jsx)(k().sA,{id:"universalQnA.jira.authScreen.createAppButton",defaultMessage:"Create app"}),onClickPrimaryButton:x,openLearnMoreUrl:()=>{window.open(f,"_blank")},notes:[(0,S.jsxs)(P().wt,{children:[(0,S.jsx)("div",{style:y.noteHeading,children:(0,S.jsx)(k().sA,{id:"universalQnA.jira.authScreen.siteUrlTitle",defaultMessage:"Paste your Jira Site URL"})}),(0,S.jsx)("div",{style:y.inputContainer,children:(0,S.jsx)(B().A,{value:e,onChange:e=>t(e.target.value),placeholder:g.formatMessage(sn.siteUrlPlaceholder),style:y.input,showClearButton:!0})})]},"note-1"),(0,S.jsxs)(P().wt,{children:[(0,S.jsx)("div",{style:y.noteHeading,children:(0,S.jsx)(k().sA,{id:"universalQnA.jira.authScreen.createTokenTitle",defaultMessage:"Create an API Token in Atlassian"})}),(0,S.jsxs)("div",{style:y.noteBody,children:[(0,S.jsxs)("div",{style:y.bulletPoint,children:[(0,S.jsx)("div",{style:y.bulletDot}),(0,S.jsx)("div",{style:y.bulletPointText,children:(0,S.jsx)(k().sA,{id:"universalQnA.jira.authScreen.createTokenStep1",defaultMessage:"Log in to:{tokenLink}",values:{tokenLink:(0,S.jsx)("a",{href:_,target:"_blank",rel:"noopener noreferrer",style:y.link,onClick:()=>{(0,M().u)({environment:p,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"input_subtext_link_click",integration_type:"jira",setup_session_id:m,from:h}}})},children:_})}})})]}),(0,S.jsxs)("div",{style:y.bulletPoint,children:[(0,S.jsx)("div",{style:y.bulletDot}),(0,S.jsx)("div",{style:y.bulletPointText,children:(0,S.jsx)(k().sA,{id:"universalQnA.jira.authScreen.createTokenStep2",defaultMessage:"Select {createTokenLink}",values:{createTokenLink:(0,S.jsx)("span",{style:{fontWeight:z().Wy.medium},children:g.formatMessage(sn.createTokenLink)})}})})]}),(0,S.jsxs)("div",{style:y.bulletPoint,children:[(0,S.jsx)("div",{style:y.bulletDot}),(0,S.jsx)("div",{style:y.bulletPointText,children:(0,S.jsx)(k().sA,{id:"universalQnA.jira.authScreen.createTokenStep3",defaultMessage:"Give your token a name and expiration date of 1 year"})})]})]})]},"note-2"),(0,S.jsxs)(P().wt,{children:[(0,S.jsx)("div",{style:y.noteHeading,children:(0,S.jsx)(k().sA,{id:"universalQnA.jira.authScreen.pasteTokenTitle",defaultMessage:"Paste your API Token here"})}),(0,S.jsx)("div",{style:y.inputContainer,children:(0,S.jsx)(B().A,{value:n,onChange:e=>o(e.target.value),placeholder:g.formatMessage(sn.tokenPlaceholder),style:y.input,type:"password",showClearButton:!0})})]},"note-3")]}):null}const an=At().w0.jira;function rn(){const e=(0,d().K8)((()=>nn().EF.state.currentScreen),[]),t=(0,i().r)(),n=(0,l().v3)(),o=(0,d().K8)((()=>nn().EF.state.analyticsFrom),[]),a=(0,d().K8)((()=>nn().EF.state.sessionId),[]),r=(0,s.useCallback)((()=>{nn().EF.setState({...nn().EF.state,currentScreen:"settings"})}),[]),c=(0,s.useCallback)((async()=>{if(!t)return;await tn().vq({environment:n,spaceId:t,projectSelection:{allProjects:!0,includedProjects:[],excludedProjects:[],includeFutureProjects:!0}})&&(await tn().Zh({environment:n,spaceId:t,analyticsProperties:{analyticsFrom:o,buttonName:"start_ingestion",sessionId:a}}),nn().EF.setState({...nn().EF.state,currentScreen:"none"}))}),[t,n,o,a]);return(0,S.jsx)(Qe().v,{open:"connection_complete_screen"===e,onDismiss:()=>{},connectorType:"jira",notes:[(0,S.jsx)($e().L,{number:1,title:{...{...Qe().D.connectionInProgressTitle,values:{appName:an}}},description:Qe().D.defaultConnectionTime},"item1"),(0,S.jsx)($e().L,{number:2,title:{...{...Qe().D.defaultNotionAiWillBeAbleToAnswerQuestions,values:{appName:an}}}},"item2")],onEditSettingsClick:r,onPrimaryButtonClick:c})}function cn(){const e=(0,k().tz)(),t=(0,D().IS)((()=>({confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:z().Wy.semibold,color:N().Tj.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:z().J.UIRegular.desktop,fontWeight:z().Wy.medium,color:N().Tj.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:z().J.UIRegular.desktop,fontWeight:z().Wy.regular,color:N().Tj.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:z().J.UIRegular.desktop,fontWeight:z().Wy.regular,width:"100%",textAlign:"center",paddingTop:4,paddingInlineEnd:0,paddingBottom:4,paddingInlineStart:0},confirmDisconnectButton:{fontSize:z().J.UIRegular.desktop,fontWeight:z().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},notesSectionWrapper:{paddingTop:12,paddingInlineEnd:12,paddingBottom:12,paddingInlineStart:12,gap:13},noteBlockWrapper:{marginBottom:12,gap:8},note:{fontWeight:z().Wy.regular,fontSize:z().J.UIRegular.desktop,lineHeight:"18px"},noteHeading:{fontWeight:z().Wy.medium,fontSize:z().J.UIRegular.desktop,lineHeight:"18px"},noteBody:{fontWeight:z().Wy.regular,color:N().Tj.text.secondary,fontSize:z().J.UIRegular.desktop,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:N().Tj.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{rotate:"45deg",width:12,height:12,cursor:"pointer",display:"inline",padding:0,margin:0}})),[]),[n,o]=(0,s.useState)(!1),a=(0,d().K8)((()=>nn().EF.state.currentScreen),[]),r=(0,d().K8)((()=>nn().EF.state.analyticsFrom),[]),c=(0,d().K8)((()=>nn().EF.state.sessionId),[]),u=(0,i().r)(),p=(0,l().v3)(),g=(0,s.useCallback)((()=>{tn().G({analyticsFrom:r,screenToShow:"none",sessionId:c})}),[r,c]),m=(0,s.useCallback)((()=>{}),[]),h=(0,s.useCallback)((async()=>{o(!0),u&&(await tn().Rr({environment:p,spaceId:u}),tn().G({analyticsFrom:r,screenToShow:"none",sessionId:c}),o(!1))}),[r,p,c,u]),v=(0,s.useCallback)((()=>{tn().G({analyticsFrom:r,screenToShow:"settings",sessionId:c})}),[r,c]),f=(0,s.useCallback)((()=>{const{noteBlockWrapper:e,noteHeading:n,noteBody:s}=t;return[(0,S.jsxs)(P().wt,{style:e,children:[(0,S.jsx)("div",{style:n,children:(0,S.jsx)(k().sA,{...ln.note1Heading})}),(0,S.jsx)("div",{style:s,children:(0,S.jsx)(k().sA,{...ln.note1Body})})]},"note-1")]}),[t]);return"post_disconnect"===a?(0,S.jsx)(Lt().A,{onClickGotItBtn:m,onDismiss:g,open:"post_disconnect"===a,connectorType:"jira",title:(0,S.jsx)(k().sA,{...ln.postDisconnectTitle}),descriptionMessage:(0,S.jsx)(k().sA,{...ln.postDisconnectDescription}),message:(0,S.jsx)("div",{style:t.notesSectionWrapper,children:f().map(((e,n)=>(0,S.jsx)(P().Ye,{gap:8,style:{marginTop:4,marginBottom:6},children:(0,S.jsx)("div",{style:t.note,children:e})},n)))})}):(0,S.jsx)(te().a,{showCloseIcon:!0,open:"disconnect_screen"===a,onDismiss:g,render:()=>(0,S.jsx)("div",{style:t.confirmWrapper,children:(0,S.jsxs)("div",{style:t.confirmContainer,children:[(0,S.jsx)("div",{style:t.confirmModalTitle,children:(0,S.jsx)(k().sA,{...ln.disconnectTitle})}),(0,S.jsx)("div",{style:t.confirmModalSubTitle,children:(0,S.jsx)(k().sA,{...ln.disconnectSubTitle})}),(0,S.jsx)("div",{style:t.confirmModalDescription,children:(0,S.jsx)(k().sA,{...ln.disconnectDescription})}),(0,S.jsxs)(P().wt,{style:t.confirmModalActionButtons,children:[(0,S.jsx)(ie().A,{colorPalette:"red",style:t.confirmDisconnectButton,isLoading:n,onClick:h,children:(0,S.jsx)(k().sA,{...ln.primaryButtonLabel})}),(0,S.jsx)(b().Ay,{style:t.goBackButton,onClick:v,children:(0,S.jsx)(k().sA,{...ln.goBackButtonLabel})})]})]})}),ariaLabel:e.formatMessage(ln.disconnectModalAriaLabel)})}const ln=(0,k().YK)({note1Heading:{id:"universalSearch.jira.postDisconnect.note_1.heading",defaultMessage:"Jira data will be permanently deleted from Notion"},note1Body:{id:"universalSearch.jira.postDisconnect.note_1.body",defaultMessage:"This process can take up to 3 hours. You’ll only be able to reconnect after disconnecting is complete."},postDisconnectTitle:{id:"universalSearch.jira.postDisconnect.title",defaultMessage:"Jira is disconnecting from Notion AI"},postDisconnectDescription:{id:"universalSearch.jira.postDisconnect.description",defaultMessage:"Here’s what you should know:"},disconnectTitle:{id:"universalSearch.jira.disconnectModal.title",defaultMessage:"Are you sure?"},disconnectSubTitle:{id:"universalSearch.jira.disconnectModal.subTitle",defaultMessage:"Jira data will be permanently deleted from Notion."},disconnectDescription:{id:"universalSearch.jira.disconnectModal.description",defaultMessage:"This process can take up to 3 hours, and you’ll only be able to reconnect after disconnecting is complete."},primaryButtonLabel:{id:"universalSearch.jira.disconnectModal.confirmDisconnect",defaultMessage:"Disconnect for everyone"},goBackButtonLabel:{id:"universalSearch.jira.disconnectModal.goBack",defaultMessage:"Go back"},disconnectModalAriaLabel:{id:"universalSearch.jira.disconnectModal.label",defaultMessage:"Disconnect Jira Modal"}});function dn(){return(0,S.jsx)(R().b,{connector:"jira",screenName:"error"})}var un=()=>n(106702);async function pn(e){const{environment:t,spaceId:n}=e,s=await I().callApi({eventName:"checkMarketplaceInstallation",environment:t,data:{spaceId:n}});return"failed"!==s.type&&s.data.isInstalled}function gn(){const[e,t]=s.useState(!1),n=(0,l().v3)(),o=(0,D().IS)((()=>({noteHeading:{fontWeight:z().Wy.medium,fontSize:z().J.UIRegular.desktop,lineHeight:"18px"},noteBody:{fontWeight:z().Wy.regular,color:N().Tj.text.secondary,fontSize:z().J.UIRegular.desktop,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:N().Tj.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{width:18,height:17,color:"#D7813A",marginTop:2},warningText:{fontSize:z().J.UIRegular.desktop,lineHeight:"18px",color:"#D7813A",paddingInlineStart:14,fontWeight:z().Wy.regular},warningContainer:{marginInlineStart:5,marginInlineEnd:5,marginBottom:15}})),[]),a=(0,d().K8)((()=>nn().EF.state.currentScreen),[]),r=(0,d().K8)((()=>nn().EF.state.analyticsFrom),[]),u=(0,d().K8)((()=>nn().EF.state.sessionId),[]),p=(0,un().$)(),g=(0,i().r)(),m=(0,s.useCallback)((async()=>{if(!g)return;(0,M().u)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"check_installation_button_clicked",integration_type:"jira",setup_session_id:u,from:r}}});await pn({environment:n,spaceId:g})?tn().G({screenToShow:"auth_input_screen",analyticsFrom:r,sessionId:u}):t(!0)}),[r,n,u,g]),h=(0,d().K8)((()=>c().default.getConfigKey("jira_ingestion_config_v2","jiraMarketPlaceAppUrl")),[]),v=(0,d().K8)((()=>c().default.getConfigKey("jira_ingestion_config_v2","learnMoreUrl")),[]);if(!p||!g)return null;const f=e?(0,S.jsxs)(P().Ye,{style:o.warningContainer,children:[(0,S.jsx)(W().I,{icon:F().exclamationMarkTriangleFillIcon,style:o.icon}),(0,S.jsx)("div",{style:o.warningText,children:(0,S.jsx)(k().sA,{id:"universalQnA.jira.MarketplaceScreen.warning",defaultMessage:"We couldn’t confirm that the Notion app was installed correctly. Please read the instructions and try again."})})]}):void 0;return(0,S.jsx)(E().Q,{title:(0,S.jsx)(k().sA,{id:"universalQnA.jira.MarketplaceScreen",defaultMessage:"Step 1: Install the Notion app in Jira Marketplace"}),open:"install_marketplace_screen"===a,onDismiss:()=>{t(!1),(0,M().u)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"marketplace_screen_dismiss",integration_type:"jira",setup_session_id:u,from:r}}}),tn().G({screenToShow:"none",analyticsFrom:r,sessionId:u})},warningMessage:f,notes:[(0,S.jsxs)(P().wt,{style:{gap:4},children:[(0,S.jsx)("div",{style:o.noteHeading,children:(0,S.jsx)(k().sA,{id:"universalSearch.jira.marketplaceShouldOpenHeading",defaultMessage:"Atlassian Marketplace should open automatically on a new browser tab."},"note1-1")}),(0,S.jsx)("div",{style:o.noteBody,children:(0,S.jsx)(k().sA,{id:"universalSearch.jira.marketplaceShouldOpenBody",defaultMessage:"If it doesn’t, {ClickHereToRetry}",values:{ClickHereToRetry:(0,S.jsx)("a",{style:o.link,href:h,target:"_blank",onClick:()=>{(0,M().u)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"marketplace_screen_open_url",integration_type:"jira",setup_session_id:u,from:r}}})},children:(0,S.jsx)(k().sA,{id:"universalSearch.jira.marketplaceRetryLink",defaultMessage:"click here to retry"})})}},"note1-2")})]},"note-1"),(0,S.jsxs)(P().wt,{style:{gap:4},children:[(0,S.jsx)("div",{style:o.noteHeading,children:(0,S.jsx)(k().sA,{id:"universalSearch.jira.installNotionAppHeading",defaultMessage:"Install the Notion app in your Jira site"},"note2")}),(0,S.jsx)("div",{style:o.noteBody,children:(0,S.jsx)(k().sA,{id:"universalSearch.jira.installNotionAppBody",defaultMessage:"Click ”Get it now”, then grant access to the Jira site of your choice."},"note2-2")})]},"note-2"),(0,S.jsx)(P().wt,{style:{gap:4},children:(0,S.jsx)("div",{style:o.noteHeading,children:(0,S.jsx)(k().sA,{id:"universalSearch.jira.whenDoneHeading",defaultMessage:"When you’re done, click the button below"},"note3")})},"note-3")],openLearnMoreUrl:()=>{window.open(v,"_blank")},connectorType:"jira",primaryButtonText:(0,S.jsx)(k().sA,{id:"universalSearch.jira.Button.checkInstallation",defaultMessage:"Check installation"},"note3-1"),onClickPrimaryButton:m})}function mn(){const e=(0,k().tz)(),t=(0,s.useMemo)((()=>(0,je().J)("jira")),[]),n=(0,s.useMemo)((()=>(0,je().a)("jira")),[]),o=(0,l().v3)(),[i,a]=(0,s.useState)("CLOSED"),r=(0,Se().L)(),g=null==r?void 0:r.id,m=(0,d().O$)(nn().EF),[v,y]=s.useState(!1),x=(0,D().IS)((()=>({loadingWrapper:{padding:20,fontSize:12,fontWeight:z().Wy.regular,justifyContent:"center",gap:8,alignItems:"center"}})),[]),_=(0,d().K8)((()=>nn().EF.state.analyticsFrom),[]),j=(0,d().K8)((()=>nn().EF.state.sessionId),[]),b=(0,d().K8)((()=>h().zD.isJiraForgeEnabled()),[]),A=o.currentUser.id,C=(0,f().P)({name:"ai_connectors",spaceId:g,userId:A}),w=(0,_e().J)(r),T=(0,d().K8)((()=>c().default.getConfigKey("jira_ingestion_config_v2","learnMoreUrl")),[]),[W]=(0,u().Yb)((async()=>{if(!g||"introduction"!==m.currentScreen)return;const e=await I().callApi({eventName:"listAIConnectors",environment:o,data:{spaceId:g}});return"success"===e.type?{isJiraConnected:e.data.connectedConnectors.map((e=>e.id)).some((e=>"jira"===e))}:void 0}),[o,m.currentScreen,g]);(0,s.useEffect)((()=>{"introduction"===m.currentScreen?"resolved"===W.status?a("OPEN"):a("LOADING"):a("CLOSED")}),[W.status,m.currentScreen]);const B=(0,s.useRef)(!1);(0,s.useEffect)((()=>{g&&w&&"resolved"===W.status&&"introduction"===m.currentScreen&&(B.current||((0,M().u)({environment:o,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:"jira",setup_session_id:j,from:_,is_space_admin:w,is_ai_eligible:C??!1}}}),B.current=!0))}),[g,o,j,m.currentScreen,_,w,C,W.status]);const F=(0,s.useCallback)((()=>{nn().EF.reset(),(0,M().u)({environment:o,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drop_off_jira_intro_modal",integration_type:"jira",setup_session_id:nn().EF.state.sessionId,from:nn().EF.state.analyticsFrom}}}),B.current=!1}),[o]),N=(0,s.useCallback)((async()=>{if(!g)return;(0,M().u)({environment:o,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_connect",integration_type:"jira",setup_session_id:nn().EF.state.sessionId,from:nn().EF.state.analyticsFrom}}}),y(!0);"failed"!==(await(0,p().updateJiraAIV2ConnectionStatus)({environment:o,spaceId:g})).status?"pending_selection"!==m.jiraSyncState?("not_started"===m.jiraSyncState&&await async function(e){const{environment:t,spaceId:n,setupSessionId:s,analyticsFrom:o}=e,i=await pn({environment:t,spaceId:n});if(i)return void tn().G({screenToShow:"auth_input_screen",analyticsFrom:o,sessionId:s});const a=await(0,p().addNotionInfoForJiraAIConnection)({environment:t,spaceId:n});if("success"===a.status){tn().G({analyticsFrom:o,sessionId:s,screenToShow:"install_marketplace_screen"});const e=c().default.getConfigKey("jira_ingestion_config_v2","jiraMarketPlaceAppUrl");return void(e&&window.open(e,"_blank"))}tn().G({analyticsFrom:o,sessionId:s,screenToShow:"error"})}({environment:o,spaceId:g,setupSessionId:j,analyticsFrom:_}),y(!1)):tn().G({analyticsFrom:_,sessionId:j,screenToShow:"connection_complete_screen"}):tn().G({analyticsFrom:_,sessionId:j,screenToShow:"error"})}),[o,g,j,_,m.jiraSyncState]);return b&&g&&"CLOSED"!==i?He().A.isMobile?(0,S.jsx)(Oe().S,{connectorType:"jira",open:"introduction"===m.currentScreen,onClosed:()=>{nn().EF.reset()},learnMoreUrl:T}):"LOADING"===i?(0,S.jsx)(te().a,{ariaLabel:e.formatMessage({id:"jira.oauthPopupTitle.ariaLabel",defaultMessage:"Loading Jira AI connector status"}),open:"LOADING"===i,render:()=>(0,S.jsxs)(P().Ye,{style:x.loadingWrapper,children:[(0,S.jsx)(k().sA,{id:"universalQna.jira.isFetchingConnection",defaultMessage:"Getting connection status"}),(0,S.jsx)(oe().k,{})]})}):w?(0,S.jsx)(Ie().A,{connectorType:"jira",notes:n,onLearnMore:()=>{window.open(T,"_blank")},onConnect:N,onDismiss:F,title:t,isLoading:v,open:"OPEN"===i}):(0,S.jsx)(ke().BN,{connector:"jira",handleClose:()=>(0,p().resetAiConnectorStatus)("jira"),open:"OPEN"===i,analyticsFrom:_,setupSessionId:j,messages:be().z$}):null}var hn=()=>n(280746),vn=()=>n(496603);const fn=(0,k().YK)({searchForAProject:{id:"universalQnA.jira.searchForAProject",defaultMessage:"Search for a Project"},disabledTooltip:{id:"universalSearch.jira.disabledTooltip",defaultMessage:"You can only interact after all projects are loaded"}});function yn(){const[e,t]=s.useState(""),[n,o]=s.useState(!1),[a,r]=s.useState(!1),[c,p]=s.useState({allProjects:!0,includedProjects:[],excludedProjects:[],includeFutureProjects:!0}),[g,m]=s.useState([]),[h,v]=s.useState(!0),[f,y]=s.useState(!0),[x,_]=s.useState(0),[j,b]=s.useState(!1),A=function(e){return(0,D().IS)((()=>({wrapper:{width:400,display:"flex",flexDirection:"column",minHeight:530},logoSection:{paddingTop:20,paddingInlineEnd:20,paddingBottom:9,paddingInlineStart:20,gap:8,justifyContent:"center",alignItems:"center",height:84},logos:{width:40,height:40},arrowLogo:{width:20,height:20,color:N().Tj.icon.secondary},titleWrapper:{width:"100%",justifyContent:"center",alignItems:"center",textAlign:"center"},title:{fontSize:17,fontWeight:z().Wy.medium,lineHeight:"22px",marginBottom:"9px"},subtext:{fontSize:12,lineHeight:"14.52px",color:N().Tj.text.secondary},footer:{width:"100%",justifySelf:"flex-end",boxShadow:"0px 9px 24px 0px #0F0F0F33",paddingTop:16,paddingInlineEnd:20,paddingBottom:16,paddingInlineStart:20,gap:12},connectButton:{fontSize:14,fontWeight:z().Wy.semibold,width:360},searchBarWrapper:{justifyContent:"center"},searchBar:{width:360,padding:4},selectionContainer:{marginTop:18,marginBottom:0,width:"100%",height:"100%",justifyContent:"center",padding:"0px 20px 0px",flexGrow:1},selection:{width:"100%"},waitingForConnection:{fontSize:12,lineHeight:"16px",color:N().Tj.text.secondary},waitingForConnectionWrapper:{gap:4},tryAgainWrapper:{marginTop:16,gap:4},tryAgainSection:{gap:4,alignItems:"center",marginBottom:16,color:N().Tj.text.secondary},tryAgainText:{fontSize:14},channelItem:{gap:4,alignItems:"center"},channelsText:{fontSize:12,lineHeight:"16px",display:"flex",flexDirection:"row",gap:4},divider:{marginTop:5,marginBottom:5},alertIcon:{width:16,height:16},tryAgainButton:{fontSize:12,width:80},futureChannelsCheckboxWrapper:{gap:4,visibility:"visible"},loadingChannelsWrapper:{alignItems:"center",gap:8,fontSize:12,color:N().Tj.text.secondary,marginTop:8},selectionWrapper:{overflowY:"scroll",maxHeight:e?170:124},loadMoreButtonWrapper:{fontSize:12,paddingTop:8,paddingBottom:4},loadMoreButtonhoveredStyle:{background:"none"},channelItemWrapper:{marginTop:12},workspaceAdministratorHeading:{fontSize:14,fontWeight:z().Wy.regular,color:N().Tj.text.primary},orderedList:{paddingInlineStart:18,fontSize:14,fontWeight:z().Wy.regular,color:N().Tj.text.secondary},waitingForConnectionNote:{paddingBottom:4},note:{fontWeight:z().Wy.regular,fontSize:14,lineHeight:"18px",width:330,marginInlineStart:8},noteHeading:{fontWeight:z().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:z().Wy.regular,color:N().Tj.text.secondary,fontSize:14,lineHeight:"18px"},learnMoreButton:{gap:4,alignItems:"center",fontSize:14,color:N().Tj.text.secondary,justifyContent:"center"},buttonContainer:{justifyContent:"center"},link:{color:N().Tj.text.secondary,textDecoration:"underline",cursor:"pointer"},loadingChannels:{color:N().Tj.text.secondary},loadingWrapper:{alignItems:"center",gap:4}})),[e])}(a),C=(0,d().K8)((()=>nn().EF.state.analyticsFrom),[]),w=(0,d().K8)((()=>nn().EF.state.sessionId),[]),T=(0,d().K8)((()=>nn().EF.state.currentScreen),[]),F=(0,l().v3)(),E=(0,i().r)(),U=(0,k().tz)(),L=(0,d().O$)(nn().EF),R="completed"===(0,d().K8)((()=>nn().EF.state.jiraSyncState),[]),[K,O]=s.useState(!1),G=(0,s.useCallback)((async()=>{if(!E)return;(0,M().u)({environment:F,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"project_selection_connect_button_clicked",integration_type:"jira",setup_session_id:w,from:C}}});let e=[],t=[];f?t=g.filter((e=>!e.checked)).map((e=>e.id)):e=g.filter((e=>e.checked)).map((e=>e.id)),o(!0);await tn().vq({environment:F,spaceId:E,projectSelection:{allProjects:!0===h,includedProjects:e,excludedProjects:t,includeFutureProjects:f}})?(R?await tn().zn({environment:F,spaceId:E}):await tn().Zh({environment:F,spaceId:E,analyticsProperties:{analyticsFrom:C,buttonName:"project_selection_connect_button_clicked",sessionId:w}}),tn().G({analyticsFrom:C,screenToShow:"none",sessionId:w}),o(!1)):o(!1)}),[E,f,F,g,h,C,w,R]),Y=(0,s.useCallback)((()=>{E?((0,M().u)({environment:F,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_jira_button_clicked",integration_type:"jira",setup_session_id:w,from:C}}}),tn().G({analyticsFrom:C,screenToShow:"disconnect_screen",sessionId:w})):tn().G({analyticsFrom:C,screenToShow:"none",sessionId:w})}),[E,F,C,w]),q=(0,s.useCallback)((()=>g.find((e=>e.checked))),[g]),J=(0,s.useCallback)((e=>{const t=g.map((t=>t.id===e?{...t,checked:!t.checked}:t));m(t);const n=t.find((e=>e.checked)),s=t.find((e=>!e.checked));let o=!1;n&&s?o="partial":n&&(o=!0),v(o)}),[g]);(0,s.useEffect)((()=>{"settings"===T&&(c.allProjects?v(!0):v("partial"),y(c.includeFutureProjects))}),[T,c]);const V=(0,s.useCallback)((()=>{v(!h),m((e=>e.map((e=>({...e,checked:!h})))))}),[h]),$=(0,s.useCallback)((e=>{const t=g.find((t=>t.id===e));return Boolean(null==t?void 0:t.checked)}),[g]),Q=(0,s.useCallback)((async(e,t)=>{if(!E)return;b(!0);const n=await I().callApi({eventName:"getJiraProjectsV2",environment:F,data:{spaceId:E,startAt:e}});if("success"===n.type){m((e=>{const s=n.data.projects.map((e=>{var n,s;let o=!1;return 0===(null===(n=t.includedProjects)||void 0===n?void 0:n.length)&&0===(null===(s=t.excludedProjects)||void 0===s?void 0:s.length)?o=!0:t.includedProjects.length>0?o=Boolean(t.includedProjects.find((t=>t===e.id))):t.excludedProjects.length>0&&(o=!t.excludedProjects.find((t=>t===e.id))),{...e,checked:o}}));return(0,vn().hS)([...e,...s],(e=>e.id))})),_(n.data.total);const s=e+n.data.projects.length;s<n.data.total?Q(s,t):r(!0)}}),[F,E]),X=(0,s.useCallback)((()=>(0,S.jsxs)(P().wt,{children:[(0,S.jsxs)(P().Ye,{style:A.channelItem,children:[(0,S.jsx)(Vt().m,{render:e=>(0,S.jsx)("div",{...e,children:(0,S.jsx)(ne().S,{checked:h,size:14,disabled:!a,onClick:()=>{(0,M().u)({environment:F,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:h?"all_projects_deselected":"all_projects_selected",integration_type:"jira",setup_session_id:L.sessionId,from:L.analyticsFrom}}}),V()}})}),renderTooltip:()=>(0,S.jsx)("div",{style:{width:280},children:(0,S.jsx)(k().sA,{...fn.disabledTooltip})}),disableTooltip:a}),(0,S.jsxs)("div",{style:A.channelsText,children:[(0,S.jsx)(W().I,{icon:hn().jiraIcon,size:"sm"}),(0,S.jsx)(k().sA,{id:"universalSearch.integration.jiraIngestion.allProjects",defaultMessage:"All projects"})]})]}),(0,S.jsx)(se().A,{style:A.divider,size:4}),(0,S.jsxs)(S.Fragment,{children:[a?null:(0,S.jsxs)(P().Ye,{style:A.loadingChannelsWrapper,children:[(0,S.jsx)(oe().k,{}),(0,S.jsxs)(P().wt,{children:[(0,S.jsx)("div",{children:(0,S.jsx)(k().sA,{id:"universalSearch.integration.jiraIngestion.loadedXProjects",defaultMessage:"{projectsCount} of {totalProjects} projects loaded",values:{projectsCount:g.length,totalProjects:x}})}),(0,S.jsx)("div",{children:(0,S.jsx)(k().sA,{id:"universalSearch.integration.jiraIngestion.loading1000PerMinute",defaultMessage:"This can take up to one minute for every 1,000 projects."})})]})]}),(0,S.jsx)(P().wt,{style:A.selectionWrapper,children:(e?g.filter((t=>t.name.toLowerCase().includes(e.toLowerCase()))):g).map((e=>(0,S.jsxs)(P().Ye,{gap:8,style:A.channelItemWrapper,children:[(0,S.jsx)(Vt().m,{render:t=>(0,S.jsx)("div",{...t,children:(0,S.jsx)(ne().S,{checked:$(e.id),disabled:!a,onClick:()=>{(0,M().u)({environment:F,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:$(e.id)?"specific_project_deselected":"specific_project_selected",integration_type:"jira",setup_session_id:L.sessionId,from:L.analyticsFrom}}}),J(e.id)},size:14},`${e.id}-checkbox`)}),renderTooltip:()=>(0,S.jsx)("div",{style:{width:280},children:(0,S.jsx)(k().sA,{...fn.disabledTooltip})}),disableTooltip:a}),(0,S.jsx)(W().I,{icon:hn().jiraIcon,size:"sm"}),(0,S.jsx)("div",{style:A.channelsText,children:` ${e.name}`},`${e.id}-label`)]},e.id)))})]})]})),[A,a,g,x,e,h,F,L.sessionId,L.analyticsFrom,V,$,J]);return(0,u().Yb)((async()=>{if(!R||!E||"settings"!==T)return;const e=await tn().Df({environment:F,spaceId:E});e&&p(e),O(!0)}),[R,F,E,T]),(0,u().Yb)((async()=>{!E||"settings"!==T||a||j||R&&!K||await Q(0,c)}),[E,Q,T,a,j,R,K,c]),(0,S.jsx)(te().a,{showCloseIcon:!0,open:"settings"===T,ariaLabel:U.formatMessage({id:"universalQnA.jira.projectSelectionScreenTitle",defaultMessage:"Select projects to connect"}),onDismiss:()=>{(0,M().u)({environment:F,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_close",integration_type:"jira",setup_session_id:w,from:C}}}),tn().G({analyticsFrom:C,screenToShow:"none",sessionId:w})},render:()=>(0,S.jsxs)("div",{style:A.wrapper,children:[(0,S.jsx)(re().b,{connectorType:"jira",title:(0,S.jsx)(k().sA,{id:"universalQnA.jira.projectSelectionScreenTitle",defaultMessage:"Select projects to connect"}),subtext:(0,S.jsx)(k().sA,{id:"universalQnA.jira.projectSelectionScreenSubtext",defaultMessage:"Connecting more Jira projects will give you more relevant and useful Notion AI responses"})}),(0,S.jsx)(Ct().A,{capture:!0,allowEsc:!0,render:()=>(0,S.jsx)(Vt().m,{textWrap:!0,placement:"top",render:n=>(0,S.jsx)("div",{...n,children:(0,S.jsx)(P().Ye,{...n,style:A.searchBarWrapper,children:(0,S.jsx)(B().A,{id:"jiraUniversalQnASearchBar",style:A.searchBar,disabled:!a,placeholder:U.formatMessage(fn.searchForAProject),value:e,onChange:e=>{t(e.target.value),(0,M().u)({environment:F,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"filter_jira_projects",integration_type:"jira",setup_session_id:w,from:C}}})}},"jiraUniversalQnASearchBar")})}),renderTooltip:()=>(0,S.jsx)("div",{style:{width:280},children:(0,S.jsx)(k().sA,{...fn.disabledTooltip})}),disableTooltip:a})}),(0,S.jsx)(P().Ye,{style:A.selectionContainer,children:(0,S.jsx)(P().wt,{style:A.selection,children:X()})}),(0,S.jsxs)(P().wt,{style:A.footer,children:[(0,S.jsxs)(P().Ye,{style:A.futureChannelsCheckboxWrapper,children:[(0,S.jsx)(Vt().m,{render:e=>(0,S.jsx)("div",{...e,children:(0,S.jsx)(ne().S,{checked:f,disabled:!a,size:14,onClick:()=>{(0,M().u)({environment:F,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:f?"dont_join_future_projects":"join_future_projects",integration_type:"jira",setup_session_id:L.sessionId,from:L.analyticsFrom}}}),y(!f)}})}),renderTooltip:()=>(0,S.jsx)("div",{style:{width:280},children:(0,S.jsx)(k().sA,{...fn.disabledTooltip})}),disableTooltip:a}),(0,S.jsx)("div",{style:A.channelsText,children:(0,S.jsx)(k().sA,{id:"universalSearch.integration.jiraIngestion.allFutureProjects",defaultMessage:"Add projects created in future"})})]}),(0,S.jsx)(Vt().m,{render:e=>(0,S.jsx)("div",{...e,children:(0,S.jsx)(ie().A,{colorPalette:"blue",isLoading:n,style:A.connectButton,onClick:G,disabled:!q()||!a,children:(0,S.jsx)(k().sA,{id:"universalSearch.integration.connect",defaultMessage:"Connect"})})}),renderTooltip:()=>(0,S.jsx)("div",{style:{width:280},children:(0,S.jsx)(k().sA,{...fn.disabledTooltip})}),disableTooltip:a}),(0,S.jsx)(H().A,{colorPalette:"red",style:A.connectButton,disabled:!a,onClick:Y,children:(0,S.jsx)(k().sA,{id:"universalSearch.integration.disconnect",defaultMessage:"Disconnect"})})]})]})})}var xn=()=>n(272286);function Sn(){const e=(0,d().K8)((()=>xn().yg.state.currentScreen),[]);return(0,S.jsx)(de().m,{open:"already_connected"===e,onDismiss:()=>{xn().yg.reset()},connector:"jira"})}function _n(){const[e,t]=s.useState(!1),n=(0,l().v3)(),o=(0,D().IS)((()=>({noteHeading:{fontWeight:z().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:z().Wy.regular,color:N().Tj.text.secondary,fontSize:14,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:N().Tj.text.secondary,textDecoration:"underline",cursor:"pointer"},warningText:{fontSize:14,lineHeight:"18px",color:"#D7813A",paddingInlineStart:14},warningContainer:{marginInlineStart:5,marginInlineEnd:5,marginBottom:15}})),[]),a=(0,d().K8)((()=>xn().yg.state.currentScreen),[]),r=(0,d().K8)((()=>xn().yg.state.analyticsFrom),[]),u=(0,d().K8)((()=>xn().yg.state.sessionId),[]),g=(0,un().$)(),m=(0,i().r)(),h=(0,s.useCallback)((async()=>{if(!m)return;var e;(0,M().u)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"check_connection_button_clicked",integration_type:"jira",setup_session_id:u,from:r}}}),await(e=5e3,new Promise((t=>setTimeout(t,e))));const s=await I().callApi({eventName:"checkNotionToJiraConnection",environment:n,data:{spaceId:m}});"success"===s.type&&s.data.isConnected?(xn().yg.setState({...xn().yg.state,currentScreen:"connection_complete_screen",jiraSiteId:s.data.jiraSiteId}),(0,p().navigateToJiraUniversalScreen)({screenToShow:"connection_complete_screen",analyticsFrom:r,sessionId:u})):t(!0)}),[r,n,u,m]),v=(0,d().K8)((()=>c().default.getConfigKey("jira_ai_ingestion_config","jiraMarketPlaceAppUrl")),[]),f=(0,d().K8)((()=>c().default.getConfigKey("jira_ai_ingestion_config","learnMoreUrl")),[]);if(!g||!m)return null;const y=e?(0,S.jsxs)(P().Ye,{style:o.warningContainer,children:[(0,S.jsx)(W().I,{icon:F().exclamationMarkTriangleFillIcon,colorPalette:"orange",colorVariant:"accentPrimary"}),(0,S.jsx)("div",{style:o.warningText,children:(0,S.jsx)(k().sA,{id:"universalQnA.jira.AuthScreen.warning",defaultMessage:"We couldn’t connect to Jira. Please review the instructions and try again, or check our {TroubleshootingGuide}",values:{TroubleshootingGuide:(0,S.jsx)("a",{style:{...o.link,color:"#D7813A"},href:f,target:"_blank",onClick:()=>{(0,M().u)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"trouble_shooting_guide_clicked",integration_type:"jira",setup_session_id:u,from:r}}})},children:(0,S.jsx)(k().sA,{id:"universalSearch.jira.troubleShootingLink",defaultMessage:"troubleshooting guide."})})}})})]}):void 0;return(0,S.jsx)(E().Q,{title:(0,S.jsx)(k().sA,{id:"universalQnA.jira.AuthScreen",defaultMessage:"Follow instructions from Jira in your browser"}),open:"check_connection"===a,onDismiss:()=>{t(!1),(0,M().u)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen_dismiss",integration_type:"jira",setup_session_id:u,from:r}}}),(0,p().navigateToJiraUniversalScreen)({screenToShow:"none",analyticsFrom:r,sessionId:u})},warningMessage:y,notes:[(0,S.jsxs)(P().wt,{style:{gap:4},children:[(0,S.jsx)("div",{style:o.noteHeading,children:(0,S.jsx)(k().sA,{id:"universalSearch.jira.waitingForConnectionNoteHeading1",defaultMessage:"Jira should open automatically on a new browser tab."},"note1-1")}),(0,S.jsx)("div",{style:o.noteBody,children:(0,S.jsx)(k().sA,{id:"universalSearch.jira.authWaiting2",defaultMessage:"If it doesn’t, {ClickHereToRetry}",values:{ClickHereToRetry:(0,S.jsx)("a",{style:o.link,href:v,target:"_blank",onClick:()=>{(0,M().u)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen_open_auth_url",integration_type:"jira",setup_session_id:u,from:r}}})},children:(0,S.jsx)(k().sA,{id:"universalSearch.jira.confirmModalNote1Retry",defaultMessage:"click here to retry"})})}},"note1-2")})]},"note-1"),(0,S.jsxs)(P().wt,{style:{gap:4},children:[(0,S.jsx)("div",{style:o.noteHeading,children:(0,S.jsx)(k().sA,{id:"universalSearch.jira.workspaceAdminHeading",defaultMessage:"Follow Jira’s instructions to connect"},"note2")}),(0,S.jsx)("div",{style:o.noteBody,children:(0,S.jsx)(k().sA,{id:"universalSearch.jira.authWaiting",defaultMessage:"Install the Notion connector in a Jira site of your choice and return to this window"},"note1-2")})]},"note-2"),(0,S.jsx)(P().wt,{style:{gap:4},children:(0,S.jsx)("div",{style:o.noteHeading,children:(0,S.jsx)(k().sA,{id:"universalSearch.jira.workspaceAdminHeading2",defaultMessage:"When you’re done, click the button below"},"note3")})},"note-3")],openLearnMoreUrl:()=>{window.open(f,"_blank")},connectorType:"jira",primaryButtonText:(0,S.jsx)(k().sA,{id:"universalSearch.jira.Button.finishedSetup",defaultMessage:"Check connection"},"note3-1"),onClickPrimaryButton:h})}var jn=()=>n(821062),bn=()=>n(834281),kn=()=>n(547149),In=()=>n(525884),An=()=>n(187820);function Cn(e){const{connector:t,learnMoreUrl:n,from:o,to:i,subtext:a,onDismiss:r,close:c,onConfirm:l,open:u,title:p}=e,[m,v]=s.useState(!1),f=(0,d().K8)((()=>h().zD.canUseAiConnectorSearchScope(t)),[t]),y=(0,D().IS)((()=>({wrapper:{width:400},selectionContainer:{padding:20,width:400,paddingTop:12,justifyContent:"center"},waitingForConnectionWrapper:{display:"flex",flexDirection:"column",alignItems:"center"},note:{fontWeight:z().Wy.regular,fontSize:z().J.UIRegular.desktop,lineHeight:"18px",marginInlineStart:8},dismissButton:{gap:4,width:"100%",alignItems:"center",fontSize:z().J.UISmall.desktop,color:N().Tj.text.primary,justifyContent:"center"},noteHeading:{fontWeight:z().Wy.medium,fontSize:z().J.UIRegular.desktop,lineHeight:"18px"},noteBody:{fontWeight:z().Wy.regular,color:N().Tj.text.secondary,fontSize:z().J.UIRegular.desktop,lineHeight:"18px",letterSpacing:"0.2px"},noteContainer:{backgroundColor:N().Tj.blue.background.secondary,color:N().Tj.blue.text.accentPrimary,padding:"10px",margin:"10px 20px",borderRadius:8,width:"auto"},connectorInfoContainer:{alignItems:"center",border:"1px solid",borderColor:N().Tj.pill.hover.border.white,borderRadius:6,paddingTop:4,paddingInlineEnd:12,paddingBottom:4,paddingInlineStart:12,justifyContent:"space-between"},connectorIconContainer:{justifyContent:"center"},connectorIcon:{width:24,height:24},verticalHr:{width:12,marginTop:2,marginInlineEnd:0,marginBottom:2,marginInlineStart:0,transform:"rotate(90deg)"},footer:{justifyContent:"center",alignItems:"center",width:"100%",paddingTop:12,paddingInlineEnd:20,paddingBottom:20,paddingInlineStart:20,gap:6},connectButton:{width:"100%"}})),[]),x=(0,k().tz)(),_=(0,s.useCallback)((async()=>{v(!0);try{await l()}finally{v(!1)}}),[l,v]);return f?He().A.isMobile?(0,S.jsx)(Oe().S,{connectorType:t,open:u,onClosed:()=>g().NT[t].reset(),learnMoreUrl:n}):(0,S.jsx)(te().a,{ariaLabel:x.formatMessage({id:"universalSearch.pendingConnection.ariaLabel",defaultMessage:"Pending connection modal"}),showCloseIcon:null==c?void 0:c.showCloseButton,open:u,onDismiss:null==c?void 0:c.onClose,render:()=>(0,S.jsxs)("div",{style:y.wrapper,children:[(0,S.jsx)(re().b,{connectorType:t,title:p,subtext:a}),(0,S.jsx)(P().Ye,{style:y.selectionContainer,children:(0,S.jsxs)(P().wt,{style:y.waitingForConnectionWrapper,children:[(0,S.jsxs)(P().Ye,{style:y.connectorInfoContainer,children:[(0,S.jsx)(P().Ye,{style:y.connectorIconContainer,children:o.icon(y.connectorIcon)}),(0,S.jsx)(P().Ye,{children:(0,S.jsxs)(P().wt,{style:y.note,children:[(0,S.jsx)("div",{style:y.noteHeading,children:o.title||""}),(0,S.jsx)("div",{style:y.noteBody,children:o.label})]})})]}),(0,S.jsx)("div",{style:y.verticalHr,children:(0,S.jsx)("hr",{})}),(0,S.jsx)("div",{style:y.noteBody,children:(0,S.jsx)(k().sA,{id:"universalSearch.confirmConnection.willConnectToLabel",defaultMessage:"will connect to:"})}),(0,S.jsx)("div",{style:y.verticalHr,children:(0,S.jsx)("hr",{})}),(0,S.jsx)("div",{style:y.connectorInfoContainer,children:(0,S.jsxs)(P().Ye,{children:[(0,S.jsx)(P().wt,{style:y.connectorIconContainer,children:(0,S.jsx)(An().B6,{disabled:!0,icon:i.icon,iconRecordCategory:"workspace",isEmptyPage:!1,title:i.title,size:y.connectorIcon.width,isLarge:!0})}),(0,S.jsxs)(P().wt,{style:y.note,children:[(0,S.jsx)("div",{style:y.noteHeading,children:i.title}),(0,S.jsx)("div",{style:y.noteBody,children:i.label})]})]})})]})}),(0,S.jsxs)(P().Ye,{style:{...y.selectionContainer,...y.noteContainer},children:[(0,S.jsx)(P().wt,{style:y.connectorIconContainer,children:(0,S.jsx)(W().I,{icon:In().infoCircleIcon})}),(0,S.jsx)(P().Ye,{style:y.note,children:(0,S.jsx)(k().sA,{id:"universalSearch.integration.confirmConnectionNoteLabel",defaultMessage:"To connect a different Notion workspace, switch to that workspace and try again."})})]}),(0,S.jsxs)(P().wt,{style:y.footer,children:[(0,S.jsx)(ie().A,{colorPalette:"blue",size:"xl",isLoading:m,disabled:m,style:y.connectButton,onClick:_,children:(0,S.jsx)(k().sA,{id:"universalSearch.integration.confirmConnection",defaultMessage:"Confirm connection"})}),(0,S.jsx)(H().A,{size:"lg",style:y.dismissButton,onClick:r,children:(0,S.jsx)(k().sA,{id:"universalSearch.integrations.dismissConnectionButton",defaultMessage:"Dismiss"})})]})]})}):null}function wn(){const[e,t]=s.useState(!1),n=(0,l().v3)(),{screenToShow:o,analyticsFrom:i,setupSessionId:r}=(0,d().K8)((()=>({screenToShow:xn().yg.state.currentScreen,analyticsFrom:xn().yg.state.analyticsFrom,setupSessionId:xn().yg.state.sessionId})),[]),u=(0,d().O$)(a().AppStoreSidebarSpaceStore),g=(0,un().$)(),m=(0,d().K8)((()=>{const e=xn().yg.state.jiraSiteUrl.match(/^https:\/\/([a-zA-Z0-9-]+)\.atlassian\.net/);return e?e[1]:xn().yg.state.jiraSiteUrl}),[]),h=(0,d().O$)(a().AppStoreSidebarSpaceViewStore),v=(0,d().O$)(a().AppStoreCurrentUserSettingsStore),{spaceId:f,notionIcon:y,notionSpaceName:x}=(0,d().K8)((()=>({spaceId:null==u?void 0:u.getSpaceId(),notionIcon:null==u?void 0:u.getIcon(),notionSpaceName:(null==u?void 0:u.getName())||""})),[u],{equalityFn:jn().k}),_=(0,d().K8)((()=>c().default.getConfigKey("jira_ai_ingestion_config","learnMoreUrl")),[]),j=(0,s.useCallback)((async()=>{if(!f)return;var e;(0,M().u)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"resume_pending_connection_button_clicked",integration_type:"jira",setup_session_id:r,from:i}}}),await(e=5e3,new Promise((t=>setTimeout(t,e))));await bn().aiQnaActions.connectSpaceToJiraSite({environment:n,spaceId:f})?(0,p().navigateToJiraUniversalScreen)({screenToShow:"connection_complete_screen",analyticsFrom:i,sessionId:r}):t(!0)}),[i,n,r,f]),b=(0,s.useCallback)((()=>{v&&h&&(kn().createAndCommit({userAction:"jiraAIConnector.onboarding.dismissPersonalAuthPrompt",environment:n,canUndo:!0,perform:e=>{kn().applyOperation({store:h,operation:{pointer:h.pointer,path:["settings"],command:"update",args:{...h.getSettings(),dismissed_jira_installation_pending_prompt:!0}},transaction:e})}}),(0,M().u)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"pending_connection_dismiss",integration_type:"jira",setup_session_id:r,from:i}}}),(0,p().navigateToJiraUniversalScreen)({screenToShow:"connection_dismiss_screen",analyticsFrom:i,sessionId:r}))}),[v,h,n,i,r]);if(!g||!u)return null;const I=(0,S.jsx)(k().sA,{id:"universalSearch.jira.confirmConnection.jiraWorkspaceLabel",defaultMessage:"Jira workspace"}),A=(0,S.jsx)(k().sA,{id:"universalSearch.jira.confirmConnection.notionWorkspaceLabel",defaultMessage:"Notion workspace"});return(0,S.jsx)(Cn,{connector:"jira",close:{showCloseButton:!0,onClose:()=>{t(!1),(0,M().u)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"pending_connection_close",integration_type:"jira",setup_session_id:r,from:i}}}),(0,p().navigateToJiraUniversalScreen)({screenToShow:"none",analyticsFrom:i,sessionId:r})}},open:"connection_pending_screen"===o,title:(0,S.jsx)(k().sA,{id:"universalQnA.jira.ConfirmConnectionScreen",defaultMessage:"Confirm Jira connection"}),subtext:(0,S.jsx)(k().sA,{id:"universalSearch.jira.subtext.confirmConnectionScreen",defaultMessage:"A connection was started from the Jira App Marketplace. Review details below:"}),onDismiss:b,onConfirm:j,from:{icon:hn().jiraIcon,title:m,label:I},to:{icon:y,title:x,label:A},learnMoreUrl:_})}const Tn=At().w0.jira;function Mn(){const e=(0,k().tz)(),t=(0,l().v3)(),n=(0,d().K8)((()=>xn().yg.state.currentScreen),[]),o=(0,d().K8)((()=>xn().yg.state.sessionId),[]),a=(0,d().K8)((()=>xn().yg.state.analyticsFrom),[]),r=(0,d().K8)((()=>xn().yg.state.sessionId),[]),c=(0,i().r)();let u=(0,d().K8)((()=>xn().yg.state.jiraSiteId),[]);const g=(0,d().K8)((()=>xn().yg.state.jiraSyncState),[]);(0,s.useEffect)((()=>{"connection_complete_screen"===n&&(0,p().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:t,connector:"jira",moment:"finished"})}),[t,n]);const m="in_progress"===g;return(0,S.jsx)(Qe().v,{open:"connection_complete_screen"===n,onDismiss:()=>{(0,M().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"completion_screen_dismiss",integration_type:"jira",setup_session_id:o,from:a}}})},connectorType:"jira",notes:[(0,S.jsx)($e().L,{number:1,title:{...{...Qe().D.connectionInProgressTitle,values:{appName:Tn}}},description:Qe().D.defaultConnectionTime},"item1"),(0,S.jsx)($e().L,{number:2,title:{...{...Qe().D.defaultNotionAiWillBeAbleToAnswerQuestions,values:{appName:Tn}}}},"item2")],onEditSettingsClick:m?void 0:async()=>{if(!c)return;(0,M().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"jira_settings",integration_type:"jira",setup_session_id:o,from:a}}});const e=await(0,p().getJiraAIConnectionStatusAction)({environment:t,spaceId:c});if(e){var n;const t=null===(n=e.connectionState)||void 0===n?void 0:n.status;"in_progress"===t?(0,p().navigateToJiraUniversalScreen)({analyticsFrom:a,sessionId:o,screenToShow:"settings"}):"not_started"===t||"pending_selection"===t?(0,p().navigateToJiraUniversalScreen)({analyticsFrom:a,sessionId:o,screenToShow:"select_projects"}):(0,p().navigateToJiraUniversalScreen)({analyticsFrom:a,sessionId:o,screenToShow:"error"})}else(0,p().navigateToJiraUniversalScreen)({analyticsFrom:a,sessionId:o,screenToShow:"error"})},onPrimaryButtonClick:async()=>{var n,s;if(!c)return;if((0,M().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"completion_screen_done",integration_type:"jira",setup_session_id:o,from:a}}}),m||"completed"===g)return void(0,p().navigateToJiraUniversalScreen)({analyticsFrom:a,sessionId:r,screenToShow:"none"});const i=await(0,p().getJiraAIConnectionStatusAction)({environment:t,spaceId:c});if(u=(null==i?void 0:i.jiraSiteId)??"",u){if("in_progress"===(null==i||null===(n=i.connectionState)||void 0===n?void 0:n.status)||"completed"===(null==i||null===(s=i.connectionState)||void 0===s?void 0:s.status))return j().D6({label:e.formatMessage({defaultMessage:"Jira sync started. This can take up to 36 hours.",id:"jira.sync.started.background.3"}),position:"bottom"}),void(0,p().navigateToJiraUniversalScreen)({analyticsFrom:a,sessionId:r,screenToShow:"none"});await(0,p().startJiraBulkIngestionAction)({environment:t,spaceId:c,jiraSiteId:u,sessionId:r}),(0,p().navigateToJiraUniversalScreen)({analyticsFrom:a,sessionId:r,screenToShow:"none"})}else(0,p().navigateToJiraUniversalScreen)({analyticsFrom:a,sessionId:r,screenToShow:"error"})}})}var Dn=()=>n(675133);const Pn=(0,k().YK)({note1Heading:{id:"universalSearch.jiraIngestion.post_disconnect_screen.note_1.heading",defaultMessage:"Jira data will be permanently deleted from Notion"},note1Body:{id:"universalSearch.jiraIngestion.post_disconnect_screen.note_1.body",defaultMessage:"This process can take up to 3 hours. You’ll only be able to reconnect after disconnecting is complete."},note2Heading:{id:"universalSearch.jiraIngestion.post_disconnect_screen.note_2.heading",defaultMessage:"Uninstall the Notion AI app from your Jira Site (optional)"},postDisconnectTitle:{id:"universalSearch.jiraIngestion.post_disconnect_modal.title",defaultMessage:"Jira is disconnecting from Notion AI"},postDisconnectDescription:{id:"universalSearch.jiraIngestion.post_disconnect_modal.description",defaultMessage:"Here’s what’s next:"},disconnectTitle:{id:"universalSearch.jiraIngestion.disconnectModal.title",defaultMessage:"Are you sure?"},disconnectSubTitle:{id:"universalSearch.jiraIngestion.disconnectModal.subTitle",defaultMessage:"Jira data will be permanently deleted from Notion."},disconnectDescription:{id:"universalSearch.jiraIngestion.disconnectModal.description",defaultMessage:"This process can take up to 3 hours, and you’ll only be able to reconnect after disconnecting is complete."},primaryButtonLabel:{id:"universalSearch.jiraIngestion.disconnectModal.confirmDisconnect",defaultMessage:"Disconnect for everyone"},goBackButtonLabel:{id:"universalSearch.jiraIngestion.disconnectModal.goBack",defaultMessage:"Go back"}});function Wn(){const e=(0,D().IS)((()=>({confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:z().Wy.semibold,color:N().Tj.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:z().J.UIRegular.desktop,fontWeight:z().Wy.medium,color:N().Tj.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:z().J.UIRegular.desktop,fontWeight:z().Wy.regular,color:N().Tj.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:z().J.UIRegular.desktop,fontWeight:z().Wy.regular,width:"100%",textAlign:"center",paddingTop:4,paddingInlineEnd:0,paddingBottom:4,paddingInlineStart:0},confirmDisconnectButton:{fontSize:z().J.UIRegular.desktop,fontWeight:z().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},notesSectionWrapper:{paddingTop:12,paddingInlineEnd:12,paddingBottom:12,paddingInlineStart:12,gap:13},noteBlockWrapper:{marginBottom:12,gap:8},note:{fontWeight:z().Wy.regular,fontSize:z().J.UIRegular.desktop,lineHeight:"18px"},noteHeading:{fontWeight:z().Wy.medium,fontSize:z().J.UIRegular.desktop,lineHeight:"18px"},noteBody:{fontWeight:z().Wy.regular,color:N().Tj.text.secondary,fontSize:z().J.UIRegular.desktop,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:N().Tj.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{rotate:"45deg",cursor:"pointer",display:"inline",padding:0,margin:0}})),[]),[t,n]=(0,s.useState)(!1),o=(0,d().O$)(xn().yg),a=(0,d().K8)((()=>o.jiraSiteId),[o]),r=(0,d().K8)((()=>o.jiraSiteUrl),[o]),c=(0,d().K8)((()=>xn().yg.state.currentScreen),[]),u=(0,i().r)(),g=(0,d().K8)((()=>xn().yg.state.analyticsFrom),[]),m=(0,d().K8)((()=>xn().yg.state.sessionId),[]),h=(0,l().v3)(),v=async()=>{if(!u)return;const e=await async function(e){const{environment:t,spaceId:n,jiraSiteId:s}=e,o=await I().callApi({eventName:"disconnectJiraConnector",environment:t,data:{spaceId:n,jiraSiteId:s}});if("success"===o.type)return j().D6({label:Dn().A.getIntl().formatMessage({defaultMessage:"Started disconnecting Jira. This can take up to 3 hours.",id:"jira.disconnect.started"}),position:"bottom",style:{width:"400px",display:"flex",justifyContent:"space-between"}}),!0;return!1}({environment:h,spaceId:u,jiraSiteId:a});e&&xn().yg.setState({...o,jiraSyncState:"disconnecting",isDisconnecting:!0,currentScreen:"post_disconnect_screen"})},f=(0,s.useCallback)((()=>{const{noteBlockWrapper:t,noteHeading:n,noteBody:s,link:o}=e;return[(0,S.jsxs)(P().wt,{style:t,children:[(0,S.jsx)("div",{style:n,children:(0,S.jsx)(k().sA,{...Pn.note1Heading})}),(0,S.jsx)("div",{style:s,children:(0,S.jsx)(k().sA,{...Pn.note1Body})})]},"note-1"),(0,S.jsxs)(P().wt,{style:t,children:[(0,S.jsx)("div",{style:n,children:(0,S.jsx)(k().sA,{...Pn.note2Heading})}),(0,S.jsx)("div",{style:s,children:(0,S.jsx)(k().sA,{id:"universalSearch.jiraIngestion.post_disconnect_screen.note_2.body",defaultMessage:"Go to your {NavigateToJiraSiteSettings} and uninstall the Notion AI app.",values:{NavigateToJiraSiteSettings:(0,S.jsx)("a",{style:o,href:`${r}/plugins/servlet/upm`,target:"_blank",onClick:()=>{(0,M().u)({environment:h,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_screen_marketplace_app_disconnect_btn",integration_type:"jira",setup_session_id:m,from:g}}})},children:(0,S.jsx)(k().sA,{id:"universalSearch.jiraIngestion.post_disconnect_screen.disconnect_jira_marketplace_app",defaultMessage:"Jira Site {ArrowIcon}",values:{ArrowIcon:(0,S.jsx)(W().I,{icon:Ut().arrowStraightUpSmallIcon,size:"xxs",style:e.icon})}})})}},"note2-2")})]},"note-2")]}),[e,r,h,m,g]);return"post_disconnect_screen"===c?(0,S.jsx)(Lt().A,{onClickGotItBtn:()=>{xn().yg.setState({...o,currentScreen:"none"})},onDismiss:()=>{xn().yg.setState({...o,currentScreen:"none"})},open:"post_disconnect_screen"===c,connectorType:"jira",title:(0,S.jsx)(k().sA,{...Pn.postDisconnectTitle}),descriptionMessage:(0,S.jsx)(k().sA,{...Pn.postDisconnectDescription}),message:(0,S.jsx)("div",{style:e.notesSectionWrapper,children:f().map(((t,n)=>(0,S.jsxs)(P().Ye,{gap:8,style:{marginTop:4,marginBottom:6},children:[(0,S.jsx)(Ue().A,{number:n+1}),(0,S.jsx)("div",{style:e.note,children:t})]},n)))})}):(0,S.jsx)(te().a,{showCloseIcon:!0,open:"disconnect_screen"===c,onDismiss:()=>{xn().yg.setState({...o,currentScreen:"none"})},render:()=>(0,S.jsx)("div",{style:e.confirmWrapper,children:(0,S.jsxs)("div",{style:e.confirmContainer,children:[(0,S.jsx)("div",{style:e.confirmModalTitle,children:(0,S.jsx)(k().sA,{...Pn.disconnectTitle})}),(0,S.jsx)("div",{style:e.confirmModalSubTitle,children:(0,S.jsx)(k().sA,{...Pn.disconnectSubTitle})}),(0,S.jsx)("div",{style:e.confirmModalDescription,children:(0,S.jsx)(k().sA,{...Pn.disconnectDescription})}),(0,S.jsxs)(P().wt,{style:e.confirmModalActionButtons,children:[(0,S.jsx)(ie().A,{colorPalette:"red",style:e.confirmDisconnectButton,isLoading:t,onClick:async()=>{(0,M().u)({environment:h,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_modal_confirm_disconnect_button",integration_type:"jira",setup_session_id:m,from:g}}}),n(!0),await v(),n(!1)},children:(0,S.jsx)(k().sA,{...Pn.primaryButtonLabel})}),(0,S.jsx)(b().Ay,{style:e.goBackButton,onClick:()=>{(0,p().navigateToJiraUniversalScreen)({screenToShow:"settings",analyticsFrom:o.analyticsFrom,sessionId:o.sessionId})},children:(0,S.jsx)(k().sA,{...Pn.goBackButtonLabel})})]})]})})})}var Bn=()=>n(209660);function Fn(e){const{notes:t,connectorType:n,open:o,onDismiss:i,title:a,subText:r,onClickPrimaryButton:c,primaryButtonText:l,warningMessage:d}=e,[u,p]=(0,s.useState)(!1),g=(0,D().IS)((()=>({wrapper:{width:400},selectionContainer:{padding:20,width:400,paddingTop:12},dismissConnectionWrapper:{display:"flex",flexDirection:"column",alignItems:"center"},buttonContainer:{display:"flex",flexDirection:"column",alignItems:"center",width:"100%",marginTop:"16px"},primaryButton:{fontSize:14,fontWeight:z().Wy.regular,width:"100%"}})),[]),m=(0,k().tz)();return(0,S.jsx)(te().a,{ariaLabel:m.formatMessage({id:"universalSearch.dismissConnection.ariaLabel",defaultMessage:"Dismiss Connection modal"}),showCloseIcon:!0,open:o,onDismiss:i,render:()=>(0,S.jsxs)("div",{style:g.wrapper,children:[(0,S.jsx)(re().b,{connectorType:n,title:a,subtext:r,disconnectFlow:!0}),(0,S.jsx)(P().Ye,{style:g.selectionContainer,children:(0,S.jsx)(P().wt,{children:(0,S.jsxs)(P().wt,{style:g.dismissConnectionWrapper,children:[t.map(((e,t)=>(0,S.jsx)($e().L,{number:t+1,title:e.title,description:e.description},`note${t}`))),(0,S.jsxs)(P().Ye,{style:g.buttonContainer,children:[d,c?(0,S.jsx)(ie().A,{colorPalette:"blue",isLoading:u,disabled:u,style:g.primaryButton,onClick:()=>{p(!0),c(),p(!1)},children:l}):void 0]})]})})})]})})}const Nn=(0,k().YK)({connectToJiratitle:{id:"universalSearch.jira.connectToJiraLaterNoteHeading1",defaultMessage:"To connect Jira later:"},connectToJiraDescription:{id:"universalSearch.jira.connectToJiraLaterNote1",defaultMessage:"Go to your {aiConnectorSettingElem} and click on the Jira AI connector."},fullyDisconnectJiraTitle:{id:"universalSearch.jira.toDisconnectJiraCompleteHeading",defaultMessage:"To fully disconnect Jira:"},fullyDisconnectJiraDescription:{id:"universalSearch.jira.toDisconnectJiraCompleteNote",defaultMessage:"Go to your {atlassianDashboardElem} and uninstall the Notion AI app."}});function zn(){const e=(0,l().v3)(),t=(0,D().IS)((()=>({link:{display:"inline",color:N().Tj.text.secondary,textDecoration:"underline",cursor:"pointer"}})),[]),n=(0,d().K8)((()=>xn().yg.state.currentScreen),[]),o=(0,d().O$)(a().AppStoreSidebarSpaceStore),i=(0,d().K8)((()=>xn().yg.state.analyticsFrom),[]),r=(0,d().K8)((()=>xn().yg.state.jiraSiteUrl),[]),c=(0,d().K8)((()=>xn().yg.state.sessionId),[]),u=(0,un().$)(),g=(0,s.useCallback)((()=>{(0,p().navigateToJiraUniversalScreen)({screenToShow:"none",analyticsFrom:i,sessionId:c})}),[i,c]);if(!u||!o)return null;const m=(0,S.jsx)(b().Ay,{style:{...t.link,display:"inline"},hoveredStyle:{background:"transparent"},onClick:()=>{(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"ai_settings_redirect",integration_type:"jira",setup_session_id:c,from:i}}}),xn().yg.setState({...xn().yg.state,currentScreen:"none"}),Bn().Ow({currentTab:"ai"})},children:(0,S.jsx)(k().sA,{id:"universalSearch.jira.aiConnectorsSettingsNote1",defaultMessage:"AI Connectors Settings"})}),h=(0,S.jsx)("a",{style:t.link,href:`${r}/plugins/servlet/upm`,target:"_blank",onClick:()=>{(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"jira_uninstall_marketplace_admin",integration_type:"jira",setup_session_id:c,from:i}}})},children:(0,S.jsx)(k().sA,{id:"universalSearch.jira.jiraAdminMarketplace",defaultMessage:"Atlassian admin dashboard"})});return(0,S.jsx)(Fn,{title:(0,S.jsx)(k().sA,{id:"universalQnA.jira.DismissedConnectionScreen",defaultMessage:"Connection dismissed"}),subText:(0,S.jsx)(k().sA,{id:"universalSearch.jira.DismissedConnectionScreenLabel",defaultMessage:"Here’s what you should know:"}),open:"connection_dismiss_screen"===n,onDismiss:()=>{(0,p().navigateToJiraUniversalScreen)({screenToShow:"none",analyticsFrom:i,sessionId:c})},notes:[{title:Nn.connectToJiratitle,description:{...{...Nn.connectToJiraDescription,values:{aiConnectorSettingElem:m}}}},{title:Nn.fullyDisconnectJiraTitle,description:{...{...Nn.fullyDisconnectJiraDescription,values:{atlassianDashboardElem:h}}}}],connectorType:"jira",primaryButtonText:(0,S.jsx)(k().sA,{id:"universalSearch.jira.Button.dismissedConnectionConfirmation",defaultMessage:"Got it"},"note3-1"),onClickPrimaryButton:g,openLearnMoreUrl:void 0})}function En(){const e=(0,d().K8)((()=>xn().yg.state.currentScreen),[]),t=(0,d().K8)((()=>xn().yg.state.sessionId),[]),n=(0,d().K8)((()=>xn().yg.state.analyticsFrom),[]),s=(0,D().IS)((()=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:N().Tj.shadowMD,paddingTop:20,paddingInlineEnd:20,paddingBottom:20,paddingInlineStart:20,gap:6},connectButton:{fontSize:14,fontWeight:z().Wy.semibold,width:"100%"}})),[]),o="error"===e;return(0,S.jsx)(te().a,{showCloseIcon:!0,onDismiss:()=>(0,p().navigateToJiraUniversalScreen)({screenToShow:"none",analyticsFrom:n,sessionId:t}),open:o,render:()=>(0,S.jsxs)("div",{style:s.wrapper,children:[(0,S.jsx)(re().b,{connectorType:"jira",title:(0,S.jsx)(k().sA,{id:"universalSearch.jira.error.title",defaultMessage:"Oops! Something went wrong"}),subtext:(0,S.jsx)(k().sA,{id:"universalSearch.jira.error.description",defaultMessage:"Something went wrong, please try again later."})}),(0,S.jsx)(P().wt,{style:s.footer,children:(0,S.jsx)(ie().A,{colorPalette:"blue",style:s.connectButton,onClick:()=>{(0,p().navigateToJiraUniversalScreen)({screenToShow:"none",analyticsFrom:n,sessionId:t})},children:(0,S.jsx)(k().sA,{id:"universalSearch.jira.error.Dismiss",defaultMessage:"Close"})})})]})})}function Un(){const[e,t]=s.useState(!1),n=(0,s.useMemo)((()=>(0,je().a)("jira")),[]),o=(0,s.useMemo)((()=>(0,je().J)("jira")),[]),i=(0,s.useRef)(!1),a=(0,l().v3)(),r=(0,Se().L)(),u=null==r?void 0:r.id,g=(0,_e().J)(r),m=(0,d().K8)((()=>xn().yg.state.currentScreen),[]),v=(0,d().K8)((()=>xn().yg.state.analyticsFrom),[]),y=(0,d().K8)((()=>xn().yg.state.sessionId),[]),x=(0,d().K8)((()=>h().zD.isAiConnectorEnabled("jira")),[]),_=a.currentUser.id,j=(0,f().P)({name:"ai_connectors",spaceId:u,userId:_}),b=(0,un().$)(),k="introduction"===m,A=(0,d().K8)((()=>c().default.getConfigKey("jira_ai_ingestion_config","learnMoreUrl")),[]);return(0,s.useEffect)((()=>{u&&g&&"introduction"===m&&(i.current||((0,M().u)({environment:a,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:"jira",setup_session_id:y,from:v,is_space_admin:g,is_ai_eligible:j??!1}}}),i.current=!0))}),[u,a,m,y,v,g,j]),x?He().A.isMobile?(0,S.jsx)(Oe().S,{connectorType:"jira",open:k,onClosed:()=>{xn().yg.reset()},learnMoreUrl:A}):g?(0,S.jsx)(Ie().A,{connectorType:"jira",notes:n,onLearnMore:()=>{window.open(A,"_blank")},onConnect:async()=>{u&&b&&await async function(e,t,n,s,o,i){(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_connect",integration_type:"jira",setup_session_id:s,from:o}}}),i(!0),(0,p().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:e,connector:"jira",moment:"started"});const a=await(0,p().getJiraAIConnectionStatusAction)({environment:e,spaceId:n});if(a){const{connectionState:t}=a;if("not_started"===t.status){(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"check_connection_screen_open",integration_type:"jira",setup_session_id:s,from:o}}});if("success"===(await I().callApi({eventName:"addNotionInfoForJiraAIConnection",environment:e,data:{spaceId:n}})).type){(0,p().navigateToJiraUniversalScreen)({screenToShow:"check_connection",analyticsFrom:o,sessionId:s});const t=c().default.getConfigKey("jira_ai_ingestion_config","jiraMarketPlaceAppUrl");t&&((0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"app_install_url_opened",integration_type:"jira",setup_session_id:s,from:o}}}),window.open(t,"_blank"))}}else"pending_selection"===t.status?((0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"project_selection_screen_open",integration_type:"jira",setup_session_id:s,from:o}}}),(0,p().navigateToJiraUniversalScreen)({screenToShow:"connection_complete_screen",analyticsFrom:o,sessionId:s})):"in_progress"===t.status||"editing"===t.status?((0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_open",integration_type:"jira",setup_session_id:s,from:o}}}),(0,p().navigateToJiraUniversalScreen)({screenToShow:"settings",analyticsFrom:o,sessionId:s})):"completed"===t.status?((0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"already_connected_screen_open",integration_type:"jira",setup_session_id:s,from:o}}}),(0,p().navigateToJiraUniversalScreen)({screenToShow:"already_connected",analyticsFrom:o,sessionId:s})):(0,p().navigateToJiraUniversalScreen)({screenToShow:"error",analyticsFrom:o,sessionId:s})}i(!1)}(a,0,u,y,v,t)},onDismiss:()=>{(0,M().u)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_dismiss",integration_type:"jira",setup_session_id:y,from:v}}}),(0,p().navigateToJiraUniversalScreen)({screenToShow:"none",analyticsFrom:v,sessionId:y}),i.current=!1},title:o,isLoading:e,open:k}):(0,S.jsx)(ke().BN,{connector:"jira",handleClose:()=>(0,p().resetAiConnectorStatus)("jira"),open:k,analyticsFrom:v,setupSessionId:y,messages:be().z$}):(0,S.jsx)(S.Fragment,{})}const Ln=(0,k().YK)({searchForAProject:{id:"universalQnA.jira.searchForAProject",defaultMessage:"Search for a Project"},disabledTooltip:{id:"universalSearch.jira.disabledTooltip",defaultMessage:"You can only interact after all projects are loaded"}});function Rn(){const e=(0,k().tz)(),[t,n]=s.useState(""),[o,a]=s.useState(!1),[r,c]=s.useState(!1),g=(0,d().K8)((()=>xn().yg.state.syncControl),[]),[m,h]=s.useState([]),[v,f]=s.useState(!0),[y,x]=s.useState(!0),[_,b]=s.useState(0),[A,C]=s.useState(!1),w=function(e){return(0,D().IS)((()=>({wrapper:{width:400,display:"flex",flexDirection:"column",minHeight:530},logoSection:{paddingTop:20,paddingInlineEnd:20,paddingBottom:9,paddingInlineStart:20,gap:8,justifyContent:"center",alignItems:"center",height:84},logos:{width:40,height:40},arrowLogo:{width:20,height:20,color:N().Tj.icon.secondary},titleWrapper:{width:"100%",justifyContent:"center",alignItems:"center",textAlign:"center"},title:{fontSize:17,fontWeight:z().Wy.medium,lineHeight:"22px",marginBottom:"9px"},subtext:{fontSize:12,lineHeight:"14.52px",color:N().Tj.text.secondary},footer:{position:"absolute",width:"100%",justifySelf:"flex-end",boxShadow:"0px 9px 24px 0px #0F0F0F33",paddingTop:16,paddingInlineEnd:20,paddingBottom:16,paddingInlineStart:20,gap:12,bottom:0},connectButton:{fontSize:14,fontWeight:z().Wy.semibold,width:360},searchBarWrapper:{justifyContent:"center"},searchBar:{width:360,padding:4},selectionContainer:{marginTop:18,marginBottom:0,width:"100%",height:"100%",justifyContent:"center",padding:"0px 20px 0px"},selection:{width:"100%"},waitingForConnection:{fontSize:12,lineHeight:"16px",color:N().Tj.text.secondary},waitingForConnectionWrapper:{gap:4},tryAgainWrapper:{marginTop:16,gap:4},tryAgainSection:{gap:4,alignItems:"center",marginBottom:16,color:N().Tj.text.secondary},tryAgainText:{fontSize:14},channelItem:{gap:4,alignItems:"center"},channelsText:{fontSize:12,lineHeight:"16px",display:"flex",flexDirection:"row",gap:4},divider:{marginTop:5,marginBottom:5},alertIcon:{width:16,height:16},tryAgainButton:{fontSize:12,width:80},futureChannelsCheckboxWrapper:{gap:4,visibility:"visible"},loadingChannelsWrapper:{alignItems:"center",gap:8,fontSize:12,color:N().Tj.text.secondary,marginTop:8},selectionWrapper:{overflowY:"scroll",maxHeight:e?170:124},loadMoreButtonWrapper:{fontSize:12,paddingTop:8,paddingBottom:4},loadMoreButtonhoveredStyle:{background:"none"},channelItemWrapper:{marginTop:12},workspaceAdministratorHeading:{fontSize:14,fontWeight:z().Wy.regular,color:N().Tj.text.primary},orderedList:{paddingInlineStart:18,fontSize:14,fontWeight:z().Wy.regular,color:N().Tj.text.secondary},waitingForConnectionNote:{paddingBottom:4},note:{fontWeight:z().Wy.regular,fontSize:14,lineHeight:"18px",width:330,marginInlineStart:8},noteHeading:{fontWeight:z().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:z().Wy.regular,color:N().Tj.text.secondary,fontSize:14,lineHeight:"18px"},learnMoreButton:{gap:4,alignItems:"center",fontSize:14,color:N().Tj.text.secondary,justifyContent:"center"},buttonContainer:{justifyContent:"center"},link:{color:N().Tj.text.secondary,textDecoration:"underline",cursor:"pointer"},loadingChannels:{color:N().Tj.text.secondary},loadingWrapper:{alignItems:"center",gap:4}})),[e])}(r),T=(0,d().K8)((()=>xn().yg.state.analyticsFrom),[]),F=(0,d().K8)((()=>xn().yg.state.sessionId),[]),E=(0,d().K8)((()=>xn().yg.state.jiraSiteId),[]),U=(0,d().K8)((()=>xn().yg.state.currentScreen),[]),L=(0,l().v3)(),R=(0,i().r)(),K=(0,d().O$)(xn().yg),H="completed"===(0,d().K8)((()=>xn().yg.state.jiraSyncState),[]),O=(0,s.useCallback)((async()=>{if(!R)return;(0,M().u)({environment:L,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"project_selection_connect_button_clicked",integration_type:"jira",setup_session_id:F,from:T}}});let t,n=[],s=[];if(y?s=m.filter((e=>!e.checked)).map((e=>({id:e.id,name:e.name}))):n=m.filter((e=>e.checked)).map((e=>({id:e.id,name:e.name}))),a(!0),H)t=await(0,p().startJiraEditFlow)({environment:L,spaceId:R,jiraSiteId:E,inclusionList:n,exclusionList:s});else{var o,i;const a=await(0,p().getJiraAIConnectionStatusAction)({environment:L,spaceId:R});if("in_progress"===(null==a||null===(o=a.connectionState)||void 0===o?void 0:o.status)||"completed"===(null==a||null===(i=a.connectionState)||void 0===i?void 0:i.status))return j().D6({label:e.formatMessage({defaultMessage:"Jira is already syncing. This can take up to 36 hours.",id:"jira.sync.started.background.2"}),position:"bottom"}),void(0,p().navigateToJiraUniversalScreen)({analyticsFrom:T,sessionId:F,screenToShow:"none"});t=await(0,p().startJiraBulkIngestionAction)({environment:L,spaceId:R,jiraSiteId:E,sessionId:F,inclusionList:n,exclusionList:s})}t?(0,p().navigateToJiraUniversalScreen)({analyticsFrom:T,screenToShow:"none",sessionId:F}):(0,p().navigateToJiraUniversalScreen)({analyticsFrom:T,screenToShow:"error",sessionId:F}),a(!1)}),[R,L,F,T,y,H,m,E,e]),G=(0,s.useCallback)((()=>m.find((e=>e.checked))),[m]),Y=(0,s.useCallback)((e=>{const t=m.map((t=>t.id===e?{...t,checked:!t.checked}:t));h(t);const n=t.find((e=>e.checked)),s=t.find((e=>!e.checked));let o=!1;n&&s?o="partial":n&&(o=!0),f(o)}),[m]);(0,s.useEffect)((()=>{"select_projects"===U&&(0===g.inclusionList.length&&0===g.exclusionList.length?f(!0):f("partial"),x(0===g.inclusionList.length))}),[U,g]);const q=(0,s.useCallback)((()=>{f(!v),h((e=>e.map((e=>({...e,checked:!v})))))}),[v]),J=(0,s.useCallback)((e=>{const t=m.find((t=>t.id===e));return Boolean(null==t?void 0:t.checked)}),[m]),V=(0,s.useCallback)((async e=>{if(!R)return;C(!0);const t=await I().callApi({eventName:"getJiraProjects",environment:L,data:{spaceId:R,jiraSiteId:E,startAt:e}});if("success"===t.type){h((e=>{const n=t.data.projects.map((e=>{let t=!1;return 0===g.inclusionList.length&&0===g.exclusionList.length?t=!0:g.inclusionList.length>0?t=Boolean(g.inclusionList.find((t=>t.id===e.id))):g.exclusionList.length>0&&(t=!g.exclusionList.find((t=>t.id===e.id))),{...e,checked:t}}));return(0,vn().hS)([...e,...n],(e=>e.id))})),b(t.data.total);const n=e+t.data.projects.length;n>e?V(n):c(!0)}}),[L,R,E,g]),$=(0,s.useCallback)((()=>(0,S.jsxs)(P().wt,{children:[(0,S.jsxs)(P().Ye,{style:w.channelItem,children:[(0,S.jsx)(Vt().m,{render:e=>(0,S.jsx)("div",{...e,children:(0,S.jsx)(ne().S,{checked:v,size:14,disabled:!r,onClick:()=>{(0,M().u)({environment:L,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:v?"all_projects_deselected":"all_projects_selected",integration_type:"jira",setup_session_id:K.sessionId,from:K.analyticsFrom}}}),q()}})}),renderTooltip:()=>(0,S.jsx)("div",{style:{width:280},children:(0,S.jsx)(k().sA,{...Ln.disabledTooltip})}),disableTooltip:r}),(0,S.jsxs)("div",{style:w.channelsText,children:[(0,S.jsx)(W().I,{icon:hn().jiraIcon,size:"sm"}),(0,S.jsx)(k().sA,{id:"universalSearch.integration.jiraIngestion.allProjects",defaultMessage:"All projects"})]})]}),(0,S.jsx)(se().A,{style:w.divider,size:4}),(0,S.jsxs)(S.Fragment,{children:[r?(0,S.jsx)(S.Fragment,{}):(0,S.jsxs)(P().Ye,{style:w.loadingChannelsWrapper,children:[(0,S.jsx)(oe().k,{}),(0,S.jsxs)(P().wt,{children:[(0,S.jsx)("div",{children:(0,S.jsx)(k().sA,{id:"universalSearch.integration.jiraIngestion.loadedXProjects",defaultMessage:"{projectsCount} of {totalProjects} projects loaded",values:{projectsCount:m.length,totalProjects:_}})}),(0,S.jsx)("div",{children:(0,S.jsx)(k().sA,{id:"universalSearch.integration.jiraIngestion.loading1000PerMinute",defaultMessage:"This can take up to one minute for every 1,000 projects."})})]})]}),(0,S.jsx)(P().wt,{style:w.selectionWrapper,children:(t?m.filter((e=>e.name.toLowerCase().includes(t.toLowerCase()))):m).map((e=>(0,S.jsxs)(P().Ye,{gap:8,style:w.channelItemWrapper,children:[(0,S.jsx)(Vt().m,{render:t=>(0,S.jsx)("div",{...t,children:(0,S.jsx)(ne().S,{checked:J(e.id),disabled:!r,onClick:()=>{(0,M().u)({environment:L,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:J(e.id)?"specific_project_deselected":"specific_project_selected",integration_type:"jira",setup_session_id:K.sessionId,from:K.analyticsFrom}}}),Y(e.id)},size:14},`${e.id}-checkbox`)}),renderTooltip:()=>(0,S.jsx)("div",{style:{width:280},children:(0,S.jsx)(k().sA,{...Ln.disabledTooltip})}),disableTooltip:r}),(0,S.jsx)(W().I,{icon:hn().jiraIcon,size:"sm"}),(0,S.jsx)("div",{style:w.channelsText,children:` ${e.name}`},`${e.id}-label`)]},e.id)))})]})]})),[w,r,m,_,t,v,L,K.sessionId,K.analyticsFrom,q,J,Y]);return(0,u().Yb)((async()=>{R&&E&&"select_projects"===U&&!r&&!A&&await V(0)}),[R,V,U,E,r,A]),(0,S.jsx)(te().a,{showCloseIcon:!0,open:"select_projects"===U,onDismiss:()=>{(0,M().u)({environment:L,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_close",integration_type:"jira",setup_session_id:F,from:T}}}),(0,p().navigateToJiraUniversalScreen)({analyticsFrom:T,screenToShow:"none",sessionId:F})},render:()=>(0,S.jsxs)("div",{style:w.wrapper,children:[(0,S.jsx)(re().b,{connectorType:"jira",title:(0,S.jsx)(k().sA,{id:"universalQnA.jira.projectSelectionScreenTitle",defaultMessage:"Select projects to connect"}),subtext:(0,S.jsx)(k().sA,{id:"universalQnA.jira.projectSelectionScreenSubtext",defaultMessage:"Connecting more Jira projects will give you more relevant and useful Notion AI responses"})}),(0,S.jsx)(Ct().A,{capture:!0,allowEsc:!0,render:()=>(0,S.jsx)(Vt().m,{textWrap:!0,placement:"top",render:s=>(0,S.jsx)("div",{...s,children:(0,S.jsx)(P().Ye,{...s,style:w.searchBarWrapper,children:(0,S.jsx)(B().A,{id:"jiraUniversalQnASearchBar",style:w.searchBar,disabled:!r,placeholder:e.formatMessage(Ln.searchForAProject),value:t,onChange:e=>{n(e.target.value),(0,M().u)({environment:L,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"filter_jira_projects",integration_type:"jira",setup_session_id:F,from:T}}})}},"jiraUniversalQnASearchBar")})}),renderTooltip:()=>(0,S.jsx)("div",{style:{width:280},children:(0,S.jsx)(k().sA,{...Ln.disabledTooltip})}),disableTooltip:r})}),(0,S.jsx)(P().Ye,{style:w.selectionContainer,children:(0,S.jsx)(P().wt,{style:w.selection,children:$()})}),(0,S.jsxs)(P().wt,{style:w.footer,children:[(0,S.jsxs)(P().Ye,{style:w.futureChannelsCheckboxWrapper,children:[(0,S.jsx)(Vt().m,{render:e=>(0,S.jsx)("div",{...e,children:(0,S.jsx)(ne().S,{checked:y,disabled:!r,size:14,onClick:()=>{(0,M().u)({environment:L,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:y?"dont_join_future_projects":"join_future_projects",integration_type:"jira",setup_session_id:K.sessionId,from:K.analyticsFrom}}}),x(!y)}})}),renderTooltip:()=>(0,S.jsx)("div",{style:{width:280},children:(0,S.jsx)(k().sA,{...Ln.disabledTooltip})}),disableTooltip:r}),(0,S.jsx)("div",{style:w.channelsText,children:(0,S.jsx)(k().sA,{id:"universalSearch.integration.jiraIngestion.allFutureProjects",defaultMessage:"Add projects created in future"})})]}),(0,S.jsx)(Vt().m,{render:e=>(0,S.jsx)("div",{...e,children:(0,S.jsx)(ie().A,{colorPalette:"blue",isLoading:o,style:w.connectButton,onClick:O,disabled:!G()||!r,children:(0,S.jsx)(k().sA,{id:"universalSearch.integration.connect",defaultMessage:"Connect"})})}),renderTooltip:()=>(0,S.jsx)("div",{style:{width:280},children:(0,S.jsx)(k().sA,{...Ln.disabledTooltip})}),disableTooltip:r})]})]})})}const Kn=(0,k().YK)({settingsModalTitle:{id:"universalSearch.jiraIngestion.settingsModalTitle",defaultMessage:"Jira is connected to Notion AI"},settingsModalPendingTitle:{id:"universalSearch.jiraIngestion.settingsModalTitle2",defaultMessage:"Jira is connecting to Notion AI"},settingModalConnectionIsPending:{id:"universalSearch.jiraIngestion.settingsModal.connectionIsPending",defaultMessage:"This can take up to 36h. You can cancel or modify your settings when the connection is complete."},tooltipText:{id:"universalSearch.jiraIngestion.settingsModal.tooltipText",defaultMessage:"You can cancel or modify your settings when the connection is complete. "},learnMoreText:{id:"universalSearch.integration.learnMore",defaultMessage:"Learn more"},editProjectsButton:{id:"universalSearch.jiraIngestion.settingsModal.editSyncControls",defaultMessage:"Edit Projects"},disconnectJira:{id:"universalSearch.jiraIngestion.settingsModal.disconnectJira",defaultMessage:"Disconnect"}});function Hn(){const[e,t]=(0,s.useState)(!0),[n,o]=(0,s.useState)([]),[a,r]=(0,s.useState)(!1),[g,m]=(0,s.useState)(0),h=(0,d().O$)(xn().yg),v=(0,d().K8)((()=>xn().yg.state.jiraSiteId),[]),f=(0,l().v3)(),y=(0,i().r)(),x=(0,d().K8)((()=>xn().yg.state.analyticsFrom),[]),_=(0,d().K8)((()=>xn().yg.state.currentScreen),[]),j=(0,d().K8)((()=>xn().yg.state.jiraSyncState),[]),I=(0,d().K8)((()=>c().default.getConfigKey("jira_ai_ingestion_config","learnMoreUrl")),[]),A="completed"===j;(0,u().Yb)((async()=>{if(!y||"settings"!==_)return;if(!A)return void t(!1);t(!0);const[e,n]=await Promise.all([(0,p().getJiraAIConnectionStatusAction)({environment:f,spaceId:y}),(0,p().getJiraSyncControlAction)({environment:f,spaceId:y,jiraSiteId:v})]);e&&n&&(o(n.data.sampleProjects),m(n.data.totalConnectedProjects),r(n.data.isFutureProjectsSyncEnabled),t(!1))}),[y,f,_,v,A]);const C=e=>{(0,p().navigateToJiraUniversalScreen)({screenToShow:e,analyticsFrom:h.analyticsFrom,sessionId:h.sessionId})},w=function(e){return(0,D().IS)((()=>({wrapper:{width:400,padding:"0 24px",minHeight:e?428:void 0},settingsWrapper:{justifyContent:"center",gap:12},jiraDetailsContainer:{fontSize:z().J.UIRegular.desktop,fontWeight:z().Wy.regular,color:N().Tj.text.secondary,gap:12,paddingBottom:12},projectNameContainer:{gap:2,color:N().Tj.text.primary},footer:{justifyContent:"center",alignItems:"center",width:"100%",gap:8},disconnectButton:{width:"100%"},moreProjectsContainer:{paddingTop:4,paddingInlineEnd:0,paddingBottom:4,paddingInlineStart:0},learnMoreSection:{padding:"24px 0"},learnMoreButton:{fontSize:z().J.UIRegular.desktop,fontWeight:z().Wy.semibold,borderRadius:"4px",width:"100%"},learnMoreText:{fontWeight:z().Wy.medium,fontSize:z().J.UISmall.desktop,gap:5,justifyContent:"center",alignItems:"center",paddingTop:4,paddingInlineEnd:8,paddingBottom:4,paddingInlineStart:8,color:`${N().Tj.text.secondary}`},confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:z().Wy.semibold,color:N().Tj.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:z().J.UIRegular.desktop,fontWeight:z().Wy.regular,color:N().Tj.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:z().J.UIRegular.desktop,fontWeight:z().Wy.regular,color:N().Tj.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:z().J.UIRegular.desktop,fontWeight:z().Wy.regular,width:"100%",textAlign:"center",paddingTop:4,paddingInlineEnd:0,paddingBottom:4,paddingInlineStart:0},confirmDisconnectButton:{fontSize:z().J.UIRegular.desktop,fontWeight:z().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},spinner:{paddingTop:20,justifyContent:"center",alignItems:"center"},projectItemWrapper:{width:"100%",paddingTop:2,paddingInlineEnd:0,paddingBottom:2,paddingInlineStart:0,alignItems:"center"},projectName:{fontSize:z().J.UIRegular.desktop},projectIcon:{width:20,color:N().Tj.text.secondary}})),[e])}(e);return(0,S.jsx)(te().a,{showCloseIcon:!0,open:"settings"===_,onDismiss:()=>{(0,p().navigateToJiraUniversalScreen)({screenToShow:"none",analyticsFrom:x,sessionId:h.sessionId}),o([]),m(0),r(!1)},render:()=>(0,S.jsxs)("div",{style:w.wrapper,children:[(0,S.jsx)(re().b,{connectorType:"jira",title:A?(0,S.jsx)(k().sA,{...Kn.settingsModalTitle}):(0,S.jsx)(k().sA,{...Kn.settingsModalPendingTitle})}),e?(0,S.jsx)(P().Ye,{style:w.spinner,children:(0,S.jsx)(oe().k,{})}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(P().Ye,{style:w.settingsWrapper,children:(0,S.jsxs)(P().wt,{style:w.jiraDetailsContainer,children:[(0,S.jsx)(P().wt,{children:A?(0,S.jsx)(k().sA,{id:"universalSearch.jiraIngestion.settingsModal.canAnswerFrom",defaultMessage:"Notion AI is connected and can answer questions with content from {jiraCountMessage}{futureProjectsMessage}",values:{jiraCountMessage:g?`${g} Jira Projects`:"Jira Project",futureProjectsMessage:a?", including future projects.":"."}}):(0,S.jsx)(k().sA,{...Kn.settingModalConnectionIsPending})}),A?(0,S.jsx)(P().wt,{children:a?(0,S.jsxs)(P().Ye,{style:w.projectItemWrapper,children:[(0,S.jsx)(P().wt,{style:w.projectIcon,children:(0,S.jsx)(W().I,{icon:hn().jiraIcon,size:"sm"})}),(0,S.jsx)(P().wt,{style:w.projectName,children:(0,S.jsx)("div",{children:(0,S.jsx)(k().sA,{id:"universalSearch.jiraIngestion.settingsModal.includeCurrentAndFutureProjects",defaultMessage:"Includes current and future projects"})})})]}):void 0}):null,A?n.map((e=>(0,S.jsx)("div",{children:(0,S.jsxs)(P().Ye,{style:w.projectItemWrapper,children:[(0,S.jsx)(P().wt,{style:w.projectIcon,children:(0,S.jsx)(W().I,{icon:hn().jiraIcon,size:"sm"})}),(0,S.jsx)(P().wt,{style:w.projectName,children:e.name})]})},e.id))):void 0,A?(0,S.jsx)(P().Ye,{style:w.moreProjectsContainer,children:g-3>0?(0,S.jsx)(k().sA,{id:"universalSearch.jiraIngestion.settingsModal.moreProjects",defaultMessage:"... and {moreProjectCount} more",values:{moreProjectCount:g-3}}):(0,S.jsx)(S.Fragment,{})}):void 0]})}),(0,S.jsxs)(P().wt,{style:w.footer,children:[A?(0,S.jsx)(On,{styles:w.disconnectButton,isEditButtonEnabled:!1,navigateToScreen:C}):(0,S.jsx)(Vt().m,{allowHover:!0,textWrap:!0,renderTooltip:()=>(0,S.jsx)("div",{style:{width:240},children:(0,S.jsx)(k().sA,{...Kn.tooltipText})}),render:e=>(0,S.jsx)(On,{events:e,styles:w.disconnectButton,isEditButtonEnabled:!1,navigateToScreen:()=>{}})}),A?(0,S.jsx)(Gn,{styles:w.disconnectButton,isDisconnectButtonEnabled:A,navigateToScreen:C}):(0,S.jsx)(Vt().m,{allowHover:!0,textWrap:!0,renderTooltip:()=>(0,S.jsx)("div",{style:{width:240},children:(0,S.jsx)(k().sA,{...Kn.tooltipText})}),render:e=>(0,S.jsx)(Gn,{events:e,styles:w.disconnectButton,isDisconnectButtonEnabled:A,navigateToScreen:C})})]}),(0,S.jsx)(P().Ye,{style:w.learnMoreSection,children:(0,S.jsx)(b().Ay,{style:w.learnMoreButton,onClick:()=>{(0,M().u)({environment:f,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_learn_more_url_click",integration_type:"jira",setup_session_id:h.sessionId,from:h.analyticsFrom}}}),window.open(I,"_blank")},children:(0,S.jsxs)(P().Ye,{style:w.learnMoreText,children:[(0,S.jsx)(k().sA,{...Kn.learnMoreText}),(0,S.jsx)(W().I,{icon:ze().arrowUpRightSquareSmallIcon,size:"sm"})]})})})]})]})})}function On(e){const{styles:t,events:n,isEditButtonEnabled:s,navigateToScreen:o}=e,i=(0,l().v3)(),a=(0,d().O$)(xn().yg);return(0,S.jsx)(H().A,{...n,size:"lg",style:t,disabled:!s,onClick:()=>{(0,M().u)({environment:i,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_edit_projects_button",integration_type:"jira",setup_session_id:a.sessionId,from:a.analyticsFrom}}}),o("select_projects")},children:(0,S.jsx)(k().sA,{...Kn.editProjectsButton})})}function Gn(e){const{styles:t,events:n,isDisconnectButtonEnabled:s,navigateToScreen:o}=e,a=(0,l().v3)(),r=(0,d().O$)(xn().yg),c=(0,i().r)();(0,d().K8)((()=>xn().yg.state.jiraSyncState),[]);return(0,S.jsx)(Je().E,{...n,style:t,disabled:!s,onClick:()=>{c&&((0,M().u)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_disconnect_button",integration_type:"jira",setup_session_id:r.sessionId,from:r.analyticsFrom}}}),o("disconnect_screen"))},children:(0,S.jsx)(k().sA,{...Kn.disconnectJira})})}var Yn=()=>n(866515),qn=()=>n(265015);function Jn(){const[e,t]=s.useState(!1),[n,o]=s.useState(void 0),a=(0,l().v3)(),r=(0,i().r)(),c=(0,Se().L)(),g=(0,_e().J)(c),m=(0,d().K8)((()=>qn().W.state.currentScreen),[]);(0,u().Yb)((async()=>{if(!r||"authentication_pending"!==m)return;if(!g)return;const e=await I().callApi({eventName:"getAIConnectorAuthorizationUrl",environment:a,data:{connector:"linear",authorizationType:"workspace",spaceId:r,sessionId:qn().W.state.sessionId,client:a.device.isElectron?"desktop":"web"}});if("success"!==e.type)return;const t=e.data.authorizationUrl;o(t)}),[a,m,r,g]);const h=(0,D().IS)((()=>({noteHeading:{fontWeight:z().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:z().Wy.regular,color:N().Tj.text.secondary,fontSize:14,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:N().Tj.text.secondary,textDecoration:"underline",cursor:"pointer"},warningText:{fontSize:14,lineHeight:"18px",color:"#D7813A",paddingInlineStart:14,fontWeight:z().Wy.regular},warningContainer:{marginInlineStart:5,marginInlineEnd:5,marginBottom:15}})),[]),v=(0,un().$)();(0,Yn().n)((async()=>{if(!r)return;if("authentication_pending"!==qn().W.state.currentScreen)return;"not_started"!==await(0,p().getLinearConnectorStatus)({environment:a,spaceId:r})&&qn().W.setState({...qn().W.state,currentScreen:"confirmation"})}),2e3,!0);const f=(0,s.useCallback)((async()=>{if(!r)return;"not_started"!==await(0,p().getLinearConnectorStatus)({environment:a,spaceId:r})?(0,p().navigateToLinearUniversalScreen)({currentScreen:"confirmation"}):t(!0),(0,M().u)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"check_connection_button_clicked",integration_type:"linear",setup_session_id:qn().W.state.sessionId,from:qn().W.state.analyticsFrom}}})}),[a,r]),y=(0,s.useCallback)((()=>{t(!1),(0,M().u)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"check_connection_modal_dismissed",integration_type:"linear",setup_session_id:qn().W.state.sessionId,from:qn().W.state.analyticsFrom}}}),qn().W.reset()}),[a]);if(!v||!r)return null;const x=e?(0,S.jsxs)(P().Ye,{style:h.warningContainer,children:[(0,S.jsx)(W().I,{icon:F().exclamationMarkTriangleFillIcon,colorPalette:"orange",colorVariant:"accentPrimary"}),(0,S.jsx)("div",{style:h.warningText,children:(0,S.jsx)(k().sA,{id:"universalSearch.linear.checkConnection.warning",defaultMessage:"We couldn’t connect to Linear. Please review the instructions and try again, or check our {TroubleshootingGuide}",values:{TroubleshootingGuide:(0,S.jsx)("a",{style:{...h.link,color:"#D7813A"},href:(0,Le().x)("guides.aiConnectorLinear"),target:"_blank",onClick:()=>{(0,M().u)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"troubleshooting_guide_clicked",integration_type:"linear",setup_session_id:qn().W.state.sessionId,from:qn().W.state.analyticsFrom}}})},children:(0,S.jsx)(k().sA,{id:"universalSearch.linear.checkConnection.troubleShootingLink",defaultMessage:"troubleshooting guide."})})}})})]}):void 0;return(0,S.jsx)(E().Q,{title:(0,S.jsx)(k().sA,{id:"universalSearch.linear.checkConnection.title",defaultMessage:"Follow instructions from Linear in your browser"}),open:"authentication_pending"===m,onDismiss:y,warningMessage:x,notes:[(0,S.jsxs)(P().wt,{style:{gap:4},children:[(0,S.jsx)("div",{style:h.noteHeading,children:(0,S.jsx)(k().sA,{id:"universalSearch.linear.checkConnection.openAuthorizationUrlInNewTabTitle",defaultMessage:"Linear should open automatically on a new browser tab."},"note1-1")}),(0,S.jsx)("div",{style:h.noteBody,children:(0,S.jsx)(k().sA,{id:"universalSearch.linear.checkConnection.authWaiting2",defaultMessage:"If it doesn’t, {ClickHereToRetry}",values:{ClickHereToRetry:(0,S.jsx)("a",{style:h.link,href:n,target:"_blank",onClick:()=>{(0,M().u)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"retry_opening_linear_auth_url",integration_type:"linear",setup_session_id:qn().W.state.sessionId,from:qn().W.state.analyticsFrom}}})},children:(0,S.jsx)(k().sA,{id:"universalSearch.linear.checkConnection.confirmModalNote1Retry",defaultMessage:"click here to retry"})})}},"note1-2")})]},"note-1"),(0,S.jsxs)(P().wt,{style:{gap:4},children:[(0,S.jsx)("div",{style:h.noteHeading,children:(0,S.jsx)(k().sA,{id:"universalSearch.linear.checkConnection.followInstructions",defaultMessage:"Follow Linear’s instructions to connect"},"note2")}),(0,S.jsx)("div",{style:h.noteBody,children:(0,S.jsx)(k().sA,{id:"universalSearch.linear.checkConnection.followInstructionsDescription",defaultMessage:"Install the Notion connector in a Linear workspace and return to this window"},"note1-2")})]},"note-2"),(0,S.jsx)(P().wt,{style:{gap:4},children:(0,S.jsx)("div",{style:h.noteHeading,children:(0,S.jsx)(k().sA,{id:"universalSearch.linear.checkConnection.returnToNotion",defaultMessage:"Return to this window, and the process will continue automatically."},"note3")})},"note-3")],openLearnMoreUrl:()=>{window.open((0,Le().x)("guides.aiConnectorLinear"),"_blank")},connectorType:"linear",primaryButtonText:(0,S.jsx)(k().sA,{id:"universalSearch.linear.checkConnection.checkConnectionButton",defaultMessage:"Check Connection"},"note3-1"),onClickPrimaryButton:f})}const Vn=At().w0.linear;function $n(){const e=(0,l().v3)(),t=(0,d().K8)((()=>qn().W.state.currentScreen),[]),n=(0,i().r)(),o=(0,s.useCallback)((()=>{n&&((0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"ingestion_started",integration_type:"linear",setup_session_id:qn().W.state.sessionId,from:qn().W.state.analyticsFrom}}}),j().D6({label:(0,S.jsx)(k().sA,{id:"aiConnectors.linear.acknowledge",defaultMessage:"Started syncing from Linear. This can take up to 36 hours."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,S.jsx)(b().Ay,{onClick:j().N2,children:(0,S.jsx)(k().sA,{id:"aiConnectors.linear.startedMessageDismiss",defaultMessage:"Close"})})}),qn().W.reset())}),[n,e]);return(0,s.useEffect)((()=>{"confirmation"===t&&(0,p().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:e,connector:"linear",moment:"finished"})}),[e,t]),(0,S.jsx)(Qe().v,{open:"confirmation"===t,onDismiss:o,connectorType:"linear",notes:[(0,S.jsx)($e().L,{number:1,title:{...{...Qe().D.connectionInProgressTitle,values:{appName:Vn}}},description:Qe().D.defaultConnectionTime},"item1"),(0,S.jsx)($e().L,{number:2,title:{...{...Qe().D.defaultNotionAiWillBeAbleToAnswerQuestions,values:{appName:Vn}}}},"item2")],onPrimaryButtonClick:o})}const Qn=(0,k().YK)({linearAIConnectorOauthPopupTitle:{defaultMessage:"Connect Linear AI Connector",id:"linearAIConnector.oauthPopupTitle"}});function Xn(){const e=(0,k().tz)(),t=(0,s.useMemo)((()=>(0,je().J)("linear")),[]),n=(0,s.useMemo)((()=>(0,je().a)("linear")),[]),o=(0,l().v3)(),[i,a]=(0,s.useState)("CLOSED"),r=(0,Se().L)(),c=null==r?void 0:r.id,g=(0,d().O$)(qn().W),m=(0,d().K8)((()=>qn().W.state.sessionId),[]),h=(0,d().K8)((()=>qn().W.state.analyticsFrom),[]),v=(0,D().IS)((()=>({loadingWrapper:{padding:20,fontSize:12,fontWeight:z().Wy.regular,justifyContent:"center",gap:8,alignItems:"center"}})),[]),y=(0,_e().J)(r),x=(0,f().P)({name:"ai_connectors",spaceId:c,userId:o.currentUser.id}),_=(0,s.useCallback)((()=>{const e=(0,Le().x)("guides.aiConnectorLinear");(0,M().u)({environment:o,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"learn_more_click_intro_modal",integration_type:"linear",setup_session_id:qn().W.state.sessionId,from:qn().W.state.analyticsFrom}}}),o.device.isElectron?(0,Fe().P)(e):window.open(e,"_blank")}),[o]),j=(0,s.useCallback)((async()=>{if(!c||"introduction"!==g.currentScreen)return null;if(!y)return null;if(!x)return null;const e=await I().callApi({eventName:"getAIConnectorAuthorizationUrl",environment:o,data:{connector:"linear",authorizationType:"workspace",spaceId:c,client:o.device.isElectron?"desktop":"web",sessionId:qn().W.state.sessionId}});if("success"!==e.type)return null;const t=e.data.authorizationUrl;o.device.isElectron?(0,Fe().P)(t):G().P(o,{width:800,height:600,url:t,titleMessage:Qn.linearAIConnectorOauthPopupTitle})}),[c,o,g.currentScreen,y,x]),[b]=(0,u().Yb)((async()=>{if(!c||"introduction"!==g.currentScreen)return;const e=await I().callApi({eventName:"listAIConnectors",environment:o,data:{spaceId:c}});return"success"===e.type?{isLinearConnected:e.data.connectedConnectors.map((e=>e.id)).some((e=>"linear"===e))}:void 0}),[o,g.currentScreen,c]);(0,s.useEffect)((()=>{"introduction"===g.currentScreen?"resolved"===b.status?a("OPEN"):a("LOADING"):a("CLOSED")}),[b.status,g.currentScreen]);const A=(0,s.useRef)(!1),C=(0,s.useCallback)((()=>{qn().W.reset(),(0,M().u)({environment:o,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drop_off_linear_intro_modal",integration_type:"linear",setup_session_id:qn().W.state.sessionId,from:qn().W.state.analyticsFrom}}}),A.current=!1}),[o]),w=(0,s.useCallback)((async()=>{await j(),(0,M().u)({environment:o,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"linear_ai_connector_auth_url_open",integration_type:"linear",setup_session_id:qn().W.state.sessionId,from:qn().W.state.analyticsFrom}}}),(0,p().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:o,connector:"linear",moment:"started"}),(0,p().navigateToLinearUniversalScreen)({currentScreen:"authentication_pending"})}),[o,j]);return(0,s.useEffect)((()=>{c&&y&&"resolved"===b.status&&"introduction"===g.currentScreen&&(A.current||((0,M().u)({environment:o,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:"linear",setup_session_id:g.sessionId,from:g.analyticsFrom,is_space_admin:y,is_ai_eligible:x??!1}}}),A.current=!0))}),[c,o,b.status,g.sessionId,g.analyticsFrom,y,x,g.currentScreen]),c&&"CLOSED"!==i?He().A.isMobile?(0,S.jsx)(Oe().S,{connectorType:"linear",open:"introduction"===g.currentScreen,onClosed:()=>{qn().W.reset()},learnMoreUrl:(0,Le().x)("guides.aiConnectorLinear")}):"LOADING"===i?(0,S.jsx)(te().a,{ariaLabel:e.formatMessage({id:"linearAIConnector.oauthPopupTitle.ariaLabel",defaultMessage:"Loading Linear AI connector status"}),open:"LOADING"===i,render:()=>(0,S.jsxs)(P().Ye,{style:v.loadingWrapper,children:[(0,S.jsx)(k().sA,{id:"universalQna.linear.isFetchingConnection",defaultMessage:"Getting connection status"}),(0,S.jsx)(oe().k,{})]})}):g.isConnected?null:y?(0,S.jsx)(Ie().A,{onConnect:w,onDismiss:C,onLearnMore:_,title:t,connectorType:"linear",notes:n,open:"OPEN"===i}):(0,S.jsx)(ke().BN,{connector:"linear",analyticsFrom:h,setupSessionId:m,handleClose:()=>(0,p().resetAiConnectorStatus)("linear"),open:"OPEN"===i,messages:be().A3}):null}function Zn(){const[e,t]=(0,s.useState)(!1),n=(0,l().v3)(),o=(0,i().r)(),a=(0,k().tz)(),r=(0,d().K8)((()=>qn().W.state.currentScreen),[]),u=(0,d().K8)((()=>c().default.getConfigKey("linear_ingestion","clientId")),[]),p=(0,s.useCallback)((()=>{(0,M().u)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"close_settings",integration_type:"linear",setup_session_id:qn().W.state.sessionId,from:qn().W.state.analyticsFrom}}}),qn().W.setState({...qn().W.state,currentScreen:"none"})}),[n]),g=(0,s.useCallback)((()=>{t(!1)}),[]),m=(0,D().IS)((()=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",paddingTop:20,paddingInlineEnd:20,paddingBottom:20,paddingInlineStart:20,gap:8},disconnectButton:{fontSize:z().J.UIRegular.desktop,fontWeight:z().Wy.medium,width:"100%"},learnMoreButton:{fontSize:z().J.UIRegular.desktop,fontWeight:z().Wy.semibold,borderRadius:"4px",width:"100%"},learnMoreText:{fontWeight:z().Wy.medium,fontSize:z().J.UISmall.desktop,gap:5,justifyContent:"center",alignItems:"center",paddingTop:4,paddingInlineEnd:8,paddingBottom:4,paddingInlineStart:8,color:`${N().Tj.text.secondary}`},confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:z().Wy.semibold,color:N().Tj.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:z().J.UIRegular.desktop,fontWeight:z().Wy.regular,color:N().Tj.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:z().J.UIRegular.desktop,fontWeight:z().Wy.regular,color:N().Tj.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:z().J.UIRegular.desktop,fontWeight:z().Wy.regular,width:"100%",textAlign:"center",paddingTop:4,paddingInlineEnd:0,paddingBottom:4,paddingInlineStart:0},confirmDisconnectButton:{fontSize:z().J.UIRegular.desktop,fontWeight:z().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},editTeamsButton:{width:"100%"}})),[]);return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(te().a,{ariaLabel:a.formatMessage({id:"linearAIConnector.settings.title",defaultMessage:"Linear AI Connector Settings Modal"}),ariaLabelledBy:"Linear AI Connector Settings Modal",showCloseIcon:!0,onDismiss:g,open:e,render:()=>(0,S.jsx)("div",{style:m.confirmWrapper,children:(0,S.jsxs)("div",{style:m.confirmContainer,children:[(0,S.jsx)("div",{style:m.confirmModalTitle,children:(0,S.jsx)(k().sA,{id:"linearAIConnector.settings.confirmation.title",defaultMessage:"Are you sure?"})}),(0,S.jsx)("div",{style:m.confirmModalSubTitle,children:(0,S.jsx)(k().sA,{id:"linearAIConnector.settings.confirmation.subTitle",defaultMessage:"Your Linear data will be permanently deleted from Notion."})}),(0,S.jsx)("div",{style:m.confirmModalDescription,children:(0,S.jsx)(k().sA,{id:"linearAIConnector.settings.confirmation.description",defaultMessage:"This process can take up to 3 hours, and you’ll only be able to reconnect after disconnecting is complete."})}),(0,S.jsxs)(P().wt,{style:m.confirmModalActionButtons,children:[(0,S.jsx)(ie().A,{colorPalette:"red",style:m.confirmDisconnectButton,onClick:async()=>{o&&((0,M().u)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_button_clicked",integration_type:"linear",setup_session_id:qn().W.state.sessionId,from:qn().W.state.analyticsFrom}}}),await I().callApi({eventName:"disconnectAiConnector",environment:n,data:{spaceId:o,connector:"linear"}}),qn().W.reset(),t(!1),j().D6({label:a.formatMessage({defaultMessage:"Linear disconnected. This can take up to 3 hours.",id:"linearAIConnector.settings.confirmation.disconnected"}),position:"bottom"}))},children:(0,S.jsx)(k().sA,{id:"linearAIConnector.settings.confirmDisconnectModal.confirmDisconnect",defaultMessage:"Disconnect for everyone"})}),(0,S.jsx)(b().Ay,{style:m.goBackButton,onClick:g,children:(0,S.jsx)(k().sA,{id:"linearAIConnector.settings.confirmDisconnectModal.goBack",defaultMessage:"Go back"})})]})]})})}),(0,S.jsx)(te().a,{ariaLabel:a.formatMessage({id:"linearAIConnector.settings.settingsModalTitle",defaultMessage:"Linear AI Connector Settings Modal"}),ariaLabelledBy:"Linear AI Connector Settings Modal",showCloseIcon:!0,onDismiss:p,open:"settings"===r,render:()=>(0,S.jsxs)("div",{style:m.wrapper,children:[(0,S.jsx)(re().b,{connectorType:"linear",title:(0,S.jsx)(k().sA,{id:"linearAIConnector.settings.linearIsConnected",defaultMessage:"Linear is connected to Notion AI"}),subtext:(0,S.jsx)(k().sA,{id:"linearAIConnector.settings.canAnswerFrom",defaultMessage:"Notion AI can answer questions about your Linear issues and projects."})}),(0,S.jsxs)(P().wt,{style:m.footer,children:[(0,S.jsx)(H().A,{size:"lg",style:m.editTeamsButton,onClick:()=>{(0,M().u)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"open_linear_for_edit_selection",integration_type:"linear",setup_session_id:qn().W.state.sessionId,from:qn().W.state.analyticsFrom}}}),window.open(`https://linear.app/settings/applications/${u}`,"_blank")},children:(0,S.jsx)(k().sA,{id:"linearAIConnector.settings.editTeams",defaultMessage:"Edit Selected Teams"})}),(0,S.jsx)(Je().E,{style:m.disconnectButton,onClick:()=>{(0,M().u)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"account_disconnect",integration_type:"linear",setup_session_id:qn().W.state.sessionId,from:"connection_settings"}}}),t(!0)},children:(0,S.jsx)(k().sA,{id:"linearAIConnector.settings.disconnectLinear",defaultMessage:"Disconnect"})}),(0,S.jsx)(b().Ay,{style:m.learnMoreButton,onClick:()=>{(0,M().u)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"learn_more_click_settings_modal",integration_type:"linear",setup_session_id:qn().W.state.sessionId,from:"connection_settings"}}});const e=(0,Le().x)("guides.aiConnectorLinear");window.open(e,"_blank")},children:(0,S.jsxs)(P().Ye,{style:m.learnMoreText,children:[(0,S.jsx)(k().sA,{id:"linearAIConnector.settings.learnMore",defaultMessage:"Learn more"}),(0,S.jsx)(W().I,{icon:ze().arrowUpRightSquareSmallIcon,size:"sm"})]})})]})]})})]})}var es=()=>n(169095);function ts(){const e=(0,d().K8)((()=>es().F0.state.currentScreen),[]);return(0,S.jsx)(de().m,{open:"already_connected_screen"===e,onDismiss:()=>{es().F0.reset()},connector:"microsoft-teams"})}function ns(e){const[t,n]=s.useState(!1),[o,a]=s.useState(void 0),r=(0,l().v3)(),c=(0,i().r)(),g=(0,Se().L)(),m=(0,_e().J)(g),h=(0,d().K8)((()=>es().F0.state.currentScreen),[]);(0,u().Yb)((async()=>{if(!c||"check_connection_screen"!==h)return;if(!m)return;const e=await I().callApi({eventName:"getAIConnectorAuthorizationUrl",environment:r,data:{connector:"microsoft-teams",authorizationType:"workspace",spaceId:c,sessionId:es().F0.state.sessionId,client:r.device.isElectron?"desktop":"web"}});if("success"!==e.type)return;const t=e.data.authorizationUrl;a(t)}),[r,h,c,m]);const v=(0,D().IS)((()=>({noteHeading:{fontWeight:z().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:z().Wy.regular,color:N().Tj.text.secondary,fontSize:14,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:N().Tj.text.secondary,textDecoration:"underline",cursor:"pointer"},warningText:{fontSize:14,lineHeight:"18px",color:"#D7813A",paddingInlineStart:14},warningContainer:{marginInlineStart:5,marginInlineEnd:5,marginBottom:15}})),[]),f=(0,d().K8)((()=>es().F0.state.analyticsFrom),[]),y=(0,d().K8)((()=>es().F0.state.sessionId),[]),x=(0,un().$)(),_=(0,s.useCallback)((async({key:e,value:t})=>{if(c)return"already_connected"===t?(await(0,p().getMicrosoftTeamsAIConnectorStatusAction)({environment:r,spaceId:c,sessionId:y}),void(0,p().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"connected_to_another_workspace_screen",analyticsFrom:f,sessionId:y})):void("connected"===t&&(await(0,p().getMicrosoftTeamsAIConnectorStatusAction)({environment:r,spaceId:c,sessionId:y}),(0,p().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"connection_complete_screen",analyticsFrom:f,sessionId:y})))}),[f,y,r,c]);(0,s.useEffect)((()=>{if(!c||null==x||!x.id||!y)return;const e=Ne().Ay.addListener((0,Ee().Vz)({spaceId:c,connectorType:"microsoft-teams",userId:x.id,sessionId:y}),void 0,_,void 0,r);return()=>{e&&Ne().Ay.removeListener(e,r)}}),[r,_,c,null==x?void 0:x.id,y]);const j=(0,s.useCallback)((async()=>{var e;if(!c)return;if((0,M().u)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"check_connection_button_clicked",integration_type:"microsoft-teams",setup_session_id:y,from:f}}}),await(0,p().getMicrosoftTeamsAIConnectorStatusAction)({environment:r,spaceId:c,sessionId:y}),"connected_to_another_workspace"===(null===(e=es().F0.state.error)||void 0===e?void 0:e.reason))return void(0,p().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"connected_to_another_workspace_screen",analyticsFrom:f,sessionId:y});"not_started"!==es().F0.state.connectionStatus?(0,p().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"connection_complete_screen",analyticsFrom:f,sessionId:y}):n(!0)}),[f,r,y,c]),b=(0,s.useCallback)((()=>{n(!1),(0,M().u)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen_dismiss",integration_type:"microsoft-teams",setup_session_id:y,from:f}}}),(0,p().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:f,sessionId:y})}),[f,r,y]),A=(0,s.useCallback)((()=>{(0,M().u)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"trouble_shooting_guide_clicked",integration_type:"microsoft-teams",setup_session_id:y,from:f}}})}),[f,r,y]),C=(0,s.useCallback)((()=>{(0,M().u)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen_open_auth_url",integration_type:"microsoft-teams",setup_session_id:y,from:f}}})}),[f,r,y]);if(!x||!c)return null;const w=t?(0,S.jsxs)(P().Ye,{style:v.warningContainer,children:[(0,S.jsx)(W().I,{icon:F().exclamationMarkTriangleFillIcon,colorPalette:"orange",colorVariant:"accentPrimary"}),(0,S.jsx)("div",{style:v.warningText,children:(0,S.jsx)(k().sA,{id:"universalSearch.microsoftTeams.checkConnection.warning",defaultMessage:"We couldn’t connect to Microsoft Teams. Please review the instructions and try again, or check our {TroubleshootingGuide}",values:{TroubleshootingGuide:(0,S.jsx)("a",{style:{...v.link,color:"#D7813A"},href:(0,Le().x)("guides.aiConnectorMicrosoftTeams"),target:"_blank",onClick:A,children:(0,S.jsx)(k().sA,{id:"universalSearch.microsoftTeams.checkConnection.troubleShootingLink",defaultMessage:"troubleshooting guide."})})}})})]}):void 0;return(0,S.jsx)(E().Q,{title:(0,S.jsx)(k().sA,{id:"universalSearch.microsoftTeams.checkConnection.title",defaultMessage:"Follow instructions from Microsoft Teams in your browser"}),open:"check_connection_screen"===h,onDismiss:b,warningMessage:w,notes:[(0,S.jsxs)(P().wt,{style:{gap:4},children:[(0,S.jsx)("div",{style:v.noteHeading,children:(0,S.jsx)(k().sA,{id:"universalSearch.microsoftTeams.checkConnection.openAuthorizationUrlInNewTabTitle",defaultMessage:"Teams should open automatically on a new browser tab."},"note1-1")}),(0,S.jsx)("div",{style:v.noteBody,children:(0,S.jsx)(k().sA,{id:"universalSearch.microsoftTeams.checkConnection.authWaiting2",defaultMessage:"If it doesn’t, {ClickHereToRetry}",values:{ClickHereToRetry:(0,S.jsx)("a",{style:v.link,href:o,target:"_blank",onClick:C,children:(0,S.jsx)(k().sA,{id:"universalSearch.microsoftTeams.checkConnection.confirmModalNote1Retry",defaultMessage:"click here to retry"})})}},"note1-2")})]},"note-1"),(0,S.jsxs)(P().wt,{style:{gap:4},children:[(0,S.jsx)("div",{style:v.noteHeading,children:(0,S.jsx)(k().sA,{id:"universalSearch.microsoftTeams.checkConnection.followInstructions",defaultMessage:"Follow Team’s instructions to connect"},"note2")}),(0,S.jsx)("div",{style:v.noteBody,children:(0,S.jsx)(k().sA,{id:"universalSearch.microsoftTeams.checkConnection.followInstructionsDescription",defaultMessage:"Install the Notion connector in a Microsoft Teams workspace and return to this window"},"note1-2")})]},"note-2"),(0,S.jsx)(P().wt,{style:{gap:4},children:(0,S.jsx)("div",{style:v.noteHeading,children:(0,S.jsx)(k().sA,{id:"universalSearch.microsoftTeams.checkConnection.returnToNotion",defaultMessage:"Return to this window, and the process will continue automatically."},"note3")})},"note-3")],openLearnMoreUrl:()=>{window.open((0,Le().x)("guides.aiConnectorMicrosoftTeams"),"_blank")},connectorType:"microsoft-teams",primaryButtonText:(0,S.jsx)(k().sA,{id:"universalSearch.microsoftTeams.checkConnection.checkConnectionButton",defaultMessage:"Check Connection"},"note3-1"),onClickPrimaryButton:j})}var ss=()=>n(631524);const os={"google-drive":{pageVisitSource:Nt().y8.AIGoogleDriveQna},"microsoft-teams":{pageVisitSource:Nt().y8.AIMicrosoftTeamsQna},slack:{pageVisitSource:Nt().y8.AISlackQna}},is=(0,k().YK)({alreadyConnected:{id:"universalQna.connector.connectedToAnotherSpace.title",defaultMessage:"You’ve already connected {connector} to another Notion workspace."},subTitle:{id:"universalQna.connector.connectedToAnotherSpace.subtitle",defaultMessage:"Currently, only one workspace can be connected to {connector}. To connect this workspace, please disconnect the existing connection."},visitAnotherSpace:{id:"universalQna.connector.connectedToAnotherSpace.visitAnotherSpaceButton",defaultMessage:"Visit the other workspace"},gotIt:{id:"universalQna.connector.connectedToAnotherSpace.gotItButton",defaultMessage:"Got it"}});function as({open:e,onNavigateToSpace:t,connector:n,connectedSpaceId:o}){const i=(0,l().v3)(),r=(0,k().tz)(),c=os[n],u=At().w0[n],p=(0,d().O$)(g().NT[n]),{sessionId:m,analyticsFrom:h}=p,v=(0,D().IS)((()=>({container:{padding:16,maxWidth:400},tryItButton:{marginTop:16},gotItButton:{marginTop:16,justifyContent:"center"}})),[]),f=(0,s.useCallback)((async()=>{const e=a().default.state.currentUserRootStore;if(!e)return;const s=e.getSpaceViewStores().filter((e=>e.getSpaceId()===o))[0];s&&((0,M().u)({environment:i,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"visit_other_workspace",integration_type:n,setup_session_id:m,from:h}}}),await(0,zt().t)({environment:i,navigationType:"switchingToOrLoadingSpace",pageVisitSource:c.pageVisitSource,spaceViewStore:s,userRootStore:a().default.state.currentUserRootStore,userSettingsStore:a().default.state.currentUserSettingsStore}),t())}),[i,n,m,h,c.pageVisitSource,t,o]),y=(0,s.useCallback)((()=>{(0,M().u)({environment:i,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"connected_to_another_space_dismiss",integration_type:n,setup_session_id:m,from:h}}}),g().NT[n].setState({...p,currentScreen:"none"})}),[h,i,m,n,p]),x=r.formatMessage(is.alreadyConnected,{connector:u});return(0,S.jsx)(te().a,{showCloseIcon:!0,onDismiss:y,open:e,ariaLabel:x,render:()=>(0,S.jsxs)(P().wt,{style:v.container,children:[(0,S.jsx)(re().b,{titleSubtitleGap:!0,fullWidthTitle:!0,subtext:(0,S.jsx)(k().sA,{...is.subTitle,values:{connector:u}}),connectorType:n,title:(0,S.jsx)(k().sA,{...is.alreadyConnected,values:{connector:u}})}),(0,S.jsx)(ie().A,{colorPalette:"blue",size:"lg",style:v.tryItButton,onClick:f,children:(0,S.jsx)(k().sA,{...is.visitAnotherSpace})}),(0,S.jsx)(ss().p,{size:"lg",style:v.gotItButton,onClick:y,children:(0,S.jsx)(k().sA,{...is.gotIt})})]})})}function rs(){const e=(0,d().K8)((()=>es().F0.state.currentScreen),[]),t=(0,d().K8)((()=>{var e;return null===(e=es().F0.state.error)||void 0===e?void 0:e.connectedSpaceId}),[]),n=(0,d().K8)((()=>es().F0.state.analyticsFrom),[]),o=(0,d().K8)((()=>es().F0.state.sessionId),[]);return(0,s.useEffect)((()=>{"connected_to_another_workspace_screen"===e&&(t||(0,p().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:n,sessionId:o}))}),[t,n,o,e]),(0,S.jsx)(as,{open:"connected_to_another_workspace_screen"===e,connector:"microsoft-teams",setupSessionId:o,onNavigateToSpace:()=>{es().F0.reset()},connectedSpaceId:t??""})}const cs=At().w0["microsoft-teams"];function ls(){const e=(0,k().tz)(),t=(0,l().v3)(),n=(0,d().K8)((()=>es().F0.state.currentScreen),[]),o=(0,d().K8)((()=>es().F0.state.sessionId),[]),a=(0,d().K8)((()=>es().F0.state.analyticsFrom),[]),r=(0,i().r)(),c="in_progress"===(0,d().K8)((()=>es().F0.state.connectionStatus),[]),u=(0,s.useCallback)((()=>{(0,M().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"completion_screen_dismiss",integration_type:"microsoft-teams",setup_session_id:o,from:a}}}),(0,p().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:a,sessionId:o})}),[a,t,o]),g=(0,s.useCallback)((async()=>{if(!r)return;(0,M().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"completion_screen_done",integration_type:"microsoft-teams",setup_session_id:o,from:a}}});const n=await(0,p().getMicrosoftTeamsAIConnectorStatusAction)({environment:t,spaceId:r});if(!n)return j().D6({label:e.formatMessage({defaultMessage:"Action failed. Please try again.",id:"universalSearch.microsoftTeams.connectionComplete.retryActionRequest"}),position:"bottom"}),void(0,p().navigateToMicrosoftTeamsUniversalScreen)({analyticsFrom:a,sessionId:o,currentScreen:"none"});if(["disconnecting","editing"].includes(null==n?void 0:n.connectionStatus))return j().D6({label:e.formatMessage({defaultMessage:"Failed to update the connection. Please try again later.",id:"universalSearch.microsoftTeams.connectionComplete.failedToStartSync"}),position:"bottom"}),void(0,p().navigateToMicrosoftTeamsUniversalScreen)({analyticsFrom:a,sessionId:o,currentScreen:"none"});if(["in_progress","completed"].includes(null==n?void 0:n.connectionStatus))return void(0,p().navigateToMicrosoftTeamsUniversalScreen)({analyticsFrom:a,sessionId:o,currentScreen:"none"});await(0,p().getMicrosoftTeamsSyncControlsAction)({environment:t,spaceId:r})||await(0,p().setMicrosoftTeamsSyncControlsAction)({environment:t,spaceId:r,syncControls:{syncFutureTeams:!0,teamsToExcludeFromSync:[],teamsToSync:[]}});await(0,p().startMicrosoftTeamsBulkIngestionAction)({environment:t,spaceId:r,sessionId:o})?(0,p().navigateToMicrosoftTeamsUniversalScreen)({analyticsFrom:a,sessionId:o,currentScreen:"none"}):j().D6({label:e.formatMessage({defaultMessage:"Failed to start ingestion. Please try again later.",id:"universalSearch.microsoftTeams.connectionComplete.failedToStartIngestion"}),position:"bottom"})}),[r,t,a,o,e]),m=(0,s.useCallback)((async()=>{if(!r)return;(0,M().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"microsoft_teams_settings",integration_type:"microsoft-teams",setup_session_id:o,from:a}}});const e=await(0,p().getMicrosoftTeamsAIConnectorStatusAction)({environment:t,spaceId:r});if(!e||"not_started"===e.connectionStatus)return void(0,p().navigateToMicrosoftTeamsUniversalScreen)({analyticsFrom:a,sessionId:o,currentScreen:"error_screen"});const n=e.connectionStatus;"in_progress"!==n&&"editing"!==n?"pending_selection"!==n&&"completed"!==n?(0,p().navigateToMicrosoftTeamsUniversalScreen)({analyticsFrom:a,sessionId:o,currentScreen:"error_screen"}):(0,p().navigateToMicrosoftTeamsUniversalScreen)({analyticsFrom:a,sessionId:o,currentScreen:"settings"}):(0,p().navigateToMicrosoftTeamsUniversalScreen)({analyticsFrom:a,sessionId:o,currentScreen:"edit_blocked_screen"})}),[a,t,o,r]);return(0,s.useEffect)((()=>{"connection_complete_screen"===n&&(0,p().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:t,connector:"microsoft-teams",moment:"finished"})}),[t,n]),(0,S.jsx)(Qe().v,{open:"connection_complete_screen"===n,onDismiss:u,connectorType:"microsoft-teams",notes:[(0,S.jsx)($e().L,{number:1,title:{...{...Qe().D.connectionInProgressTitle,values:{appName:cs}}},description:Qe().D.defaultConnectionTime},"item1"),(0,S.jsx)($e().L,{number:2,title:{...{...Qe().D.defaultNotionAiWillBeAbleToAnswerQuestions,values:{appName:cs}}}},"item2")],onPrimaryButtonClick:g,onEditSettingsClick:c?void 0:m})}function ds(){const e=(0,k().tz)(),t=(0,D().IS)((()=>({confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:z().Wy.semibold,color:N().Tj.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:z().J.UIRegular.desktop,fontWeight:z().Wy.medium,color:N().Tj.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:z().J.UIRegular.desktop,fontWeight:z().Wy.regular,color:N().Tj.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:z().J.UIRegular.desktop,fontWeight:z().Wy.regular,width:"100%",textAlign:"center",paddingTop:4,paddingInlineEnd:0,paddingBottom:4,paddingInlineStart:0},confirmDisconnectButton:{fontSize:z().J.UIRegular.desktop,fontWeight:z().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},notesSectionWrapper:{paddingTop:12,paddingInlineEnd:12,paddingBottom:12,paddingInlineStart:12,gap:13},noteBlockWrapper:{marginBottom:12,gap:8},note:{fontWeight:z().Wy.regular,fontSize:z().J.UIRegular.desktop,lineHeight:"18px"},noteHeading:{fontWeight:z().Wy.medium,fontSize:z().J.UIRegular.desktop,lineHeight:"18px"},noteBody:{fontWeight:z().Wy.regular,color:N().Tj.text.secondary,fontSize:z().J.UIRegular.desktop,lineHeight:"18px",letterSpacing:"0.2px"}})),[]),[n,o]=(0,s.useState)(!1),a=(0,d().K8)((()=>es().F0.state.currentScreen),[]),r=(0,i().r)(),c=(0,d().K8)((()=>es().F0.state.analyticsFrom),[]),u=(0,d().K8)((()=>es().F0.state.sessionId),[]),g=(0,l().v3)(),m=(0,s.useCallback)((()=>{(0,p().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:c,sessionId:u})}),[c,u]),h=(0,s.useCallback)((()=>{(0,p().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:c,sessionId:u})}),[c,u]),v=(0,s.useCallback)((async()=>{if(o(!0),!r)return void o(!1);(0,M().u)({environment:g,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_modal_confirm_disconnect_button",integration_type:"microsoft-teams",setup_session_id:u,from:c}}});const e=await async function(e){const{environment:t,spaceId:n}=e,s=await I().callApi({eventName:"disconnectAiConnector",environment:t,data:{spaceId:n,connector:"microsoft-teams"}});if("success"===s.type)return j().D6({label:Dn().A.getIntl().formatMessage({defaultMessage:"Started disconnecting Microsoft Teams. This can take up to 3 hours.",id:"microsoftTeams.disconnect.started"}),position:"bottom",style:{width:"400px",display:"flex",justifyContent:"space-between"}}),!0;return!1}({environment:g,spaceId:r});e&&es().F0.setState({...es().F0.state,connectionStatus:"disconnecting",currentScreen:"post_disconnect_screen"}),o(!1)}),[g,r,c,u]),f=(0,s.useCallback)((()=>{(0,p().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"settings",analyticsFrom:c,sessionId:u})}),[c,u]),y=(0,s.useCallback)((()=>{const{noteBlockWrapper:e,noteHeading:n,noteBody:s}=t;return[(0,S.jsxs)(P().wt,{style:e,children:[(0,S.jsx)("div",{style:n,children:(0,S.jsx)(k().sA,{...us.note1Heading})}),(0,S.jsx)("div",{style:s,children:(0,S.jsx)(k().sA,{...us.note1Body})})]},"note-1")]}),[t]);return"post_disconnect_screen"===a?(0,S.jsx)(Lt().A,{onClickGotItBtn:h,onDismiss:m,open:"post_disconnect_screen"===a,connectorType:"microsoft-teams",title:(0,S.jsx)(k().sA,{...us.postDisconnectTitle}),descriptionMessage:(0,S.jsx)(k().sA,{...us.postDisconnectDescription}),message:(0,S.jsx)("div",{style:t.notesSectionWrapper,children:y().map(((e,n)=>(0,S.jsx)(P().Ye,{gap:8,style:{marginTop:4,marginBottom:6},children:(0,S.jsx)("div",{style:t.note,children:e})},n)))})}):(0,S.jsx)(te().a,{showCloseIcon:!0,open:"disconnect_screen"===a,onDismiss:m,render:()=>(0,S.jsx)("div",{style:t.confirmWrapper,children:(0,S.jsxs)("div",{style:t.confirmContainer,children:[(0,S.jsx)("div",{style:t.confirmModalTitle,children:(0,S.jsx)(k().sA,{...us.disconnectTitle})}),(0,S.jsx)("div",{style:t.confirmModalSubTitle,children:(0,S.jsx)(k().sA,{...us.disconnectSubTitle})}),(0,S.jsx)("div",{style:t.confirmModalDescription,children:(0,S.jsx)(k().sA,{...us.disconnectDescription})}),(0,S.jsxs)(P().wt,{style:t.confirmModalActionButtons,children:[(0,S.jsx)(ie().A,{colorPalette:"red",style:t.confirmDisconnectButton,isLoading:n,onClick:v,children:(0,S.jsx)(k().sA,{...us.primaryButtonLabel})}),(0,S.jsx)(b().Ay,{style:t.goBackButton,onClick:f,children:(0,S.jsx)(k().sA,{...us.goBackButtonLabel})})]})]})}),ariaLabel:e.formatMessage(us.disconnectModalAriaLabel)})}const us=(0,k().YK)({note1Heading:{id:"universalSearch.microsoftTeams.postDisconnect.note_1.heading",defaultMessage:"Teams data will be permanently deleted from Notion"},note1Body:{id:"universalSearch.microsoftTeams.postDisconnect.note_1.body",defaultMessage:"This process can take up to 3 hours. You’ll only be able to reconnect after disconnecting is complete."},postDisconnectTitle:{id:"universalSearch.microsoftTeams.postDisconnect.title",defaultMessage:"Teams is disconnecting from Notion AI"},postDisconnectDescription:{id:"universalSearch.microsoftTeams.postDisconnect.description",defaultMessage:"Here’s what you should know:"},disconnectTitle:{id:"universalSearch.microsoftTeams.disconnectModal.title",defaultMessage:"Are you sure?"},disconnectSubTitle:{id:"universalSearch.microsoftTeams.disconnectModal.subTitle",defaultMessage:"Teams data will be permanently deleted from Notion."},disconnectDescription:{id:"universalSearch.microsoftTeams.disconnectModal.description",defaultMessage:"This process can take up to 3 hours, and you’ll only be able to reconnect after disconnecting is complete."},primaryButtonLabel:{id:"universalSearch.microsoftTeams.disconnectModal.confirmDisconnect",defaultMessage:"Disconnect for everyone"},goBackButtonLabel:{id:"universalSearch.microsoftTeams.disconnectModal.goBack",defaultMessage:"Go back"},disconnectModalAriaLabel:{id:"universalSearch.microsoftTeams.disconnectModal.label",defaultMessage:"Disconnect Microsoft Teams Modal"}}),ps=(0,k().YK)({primedTextInput:{id:"aiConnectors.microsoftTeams.primedTextInput",defaultMessage:"Search for messages in Microsoft Teams"}});function gs(){const e=(0,k().tz)(),t=(0,l().v3)(),n=(0,d().K8)((()=>es().F0.state.currentScreen),[]),o=(0,d().K8)((()=>es().F0.state.sessionId),[]),i=(0,d().K8)((()=>es().F0.state.analyticsFrom),[]),a=(0,D().IS)((()=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:N().Tj.shadowMD,paddingTop:20,paddingInlineEnd:20,paddingBottom:20,paddingInlineStart:20,gap:6},connectButton:{fontSize:14,fontWeight:z().Wy.semibold,width:"100%"}})),[]),r=(0,s.useCallback)((()=>{(0,M().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"connection_in_progress_got_it",integration_type:"microsoft-teams",setup_session_id:o,from:i}}}),(0,p().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none"})}),[i,t,o]),c=(0,s.useCallback)((()=>{(0,M().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"connection_in_progress_dismiss",integration_type:"microsoft-teams",setup_session_id:o,from:i}}}),(0,p().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none"})}),[i,t,o]);return(0,S.jsx)(te().a,{showCloseIcon:!0,onDismiss:c,open:"edit_blocked_screen"===n,render:()=>(0,S.jsxs)("div",{style:a.wrapper,children:[(0,S.jsx)(re().b,{connectorType:"microsoft-teams",title:(0,S.jsx)(k().sA,{id:"aiConnectors.microsoftTeams.editBlocked.title",defaultMessage:"Connection is in Progress"}),subtext:(0,S.jsx)(k().sA,{id:"aiConnectors.microsoftTeams.editBlocked.description",defaultMessage:"You’ll be able to ask questions and manage your settings soon. This can take up to 72h."})}),(0,S.jsx)(P().wt,{style:a.footer,children:(0,S.jsx)(ie().A,{colorPalette:"blue",style:a.connectButton,onClick:r,children:(0,S.jsx)(k().sA,{id:"aiConnectors.microsoftTeams.editBlocked.gotItButton",defaultMessage:"Got it"})})})]}),ariaLabel:e.formatMessage(ps.primedTextInput)})}function ms(){const e=(0,k().tz)(),t=(0,d().K8)((()=>es().F0.state.currentScreen),[]),n=(0,d().K8)((()=>es().F0.state.sessionId),[]),s=(0,d().K8)((()=>es().F0.state.analyticsFrom),[]),o=(0,D().IS)((()=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:N().Tj.shadowMD,paddingTop:20,paddingInlineEnd:20,paddingBottom:20,paddingInlineStart:20,gap:6},connectButton:{fontSize:14,fontWeight:z().Wy.semibold,width:"100%"}})),[]);return(0,S.jsx)(te().a,{open:"error_screen"===t,showCloseIcon:!0,onDismiss:()=>(0,p().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:s,sessionId:n}),render:()=>(0,S.jsxs)("div",{style:o.wrapper,children:[(0,S.jsx)(re().b,{connectorType:"microsoft-teams",title:(0,S.jsx)(k().sA,{id:"universalSearch.microsoftTeams.error.title",defaultMessage:"Oops! Something went wrong"}),subtext:(0,S.jsx)(k().sA,{id:"universalSearch.microsoftTeams.error.description",defaultMessage:"Something went wrong, please try again later."})}),(0,S.jsx)(P().wt,{style:o.footer,children:(0,S.jsx)(ie().A,{colorPalette:"blue",style:o.connectButton,onClick:()=>{(0,p().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:s,sessionId:n})},children:(0,S.jsx)(k().sA,{id:"universalSearch.microsoftTeams.Dismiss",defaultMessage:"Close"})})})]}),ariaLabel:e.formatMessage({id:"universalSearch.microsoftTeams.error.ariaLabel",defaultMessage:"Microsoft Teams error modal"})})}const hs=(0,k().YK)({microsoftTeamsAIConnectorOauthPopupTitle:{defaultMessage:"Connect Microsoft Teams AI Connector",id:"microsoftTeamsAIConnector.oauthPopupTitle"}});function vs(){const e=(0,l().v3)(),t=(0,Se().L)(),n=(0,_e().J)(t),o=null==t?void 0:t.id,i=e.currentUser.id,a=(0,f().P)({name:"ai_connectors",spaceId:o,userId:i}),r=(0,s.useRef)(!1),c=(0,s.useMemo)((()=>(0,je().a)("microsoft-teams")),[]),u=(0,d().K8)((()=>es().F0.state.currentScreen),[]),g=(0,d().K8)((()=>es().F0.state.connectionStatus),[]),m=(0,d().K8)((()=>es().F0.state.sessionId),[]),v=(0,d().K8)((()=>es().F0.state.analyticsFrom),[]),y=(0,d().K8)((()=>h().zD.isAiConnectorEnabled("microsoft-teams")),[]),x=(0,s.useCallback)((async()=>{if(!o)return;if(!n)return;if(!a)return;(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"microsoft_teams_ai_connector_auth_url_open",integration_type:"microsoft-teams",setup_session_id:m,from:v}}});const t=await I().callApi({eventName:"getAIConnectorAuthorizationUrl",environment:e,data:{connector:"microsoft-teams",authorizationType:"workspace",spaceId:o,sessionId:m,client:e.device.isElectron?"desktop":"web"}});if("success"!==t.type)return;(0,p().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:e,connector:"microsoft-teams",moment:"started"});const s=t.data.authorizationUrl;e.device.isElectron?(0,Fe().P)(s):G().P(e,{width:800,height:600,url:s,titleMessage:hs.microsoftTeamsAIConnectorOauthPopupTitle}),(0,p().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"check_connection_screen",analyticsFrom:v,sessionId:m})}),[o,e,v,m,n,a]),_=(0,s.useCallback)((()=>{(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drop_off_microsoft_teams_intro_modal",integration_type:"microsoft-teams",setup_session_id:m,from:v}}}),r.current=!1,es().F0.reset()}),[v,m,e]);(0,s.useCallback)((()=>{o&&n&&"introduction"===u&&(r.current||((0,M().u)({environment:e,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:"microsoft-teams",setup_session_id:m,from:v,is_space_admin:n,is_ai_eligible:a??!1}}}),r.current=!0),"completed"===g&&(0,p().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"already_connected_screen",analyticsFrom:v,sessionId:m}),"in_progress"!==g&&"editing"!==g||(0,p().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"edit_blocked_screen",analyticsFrom:v,sessionId:m}))}),[o,n,u,g,e,m,v,a]);const j=(0,s.useCallback)((()=>{const t=(0,Le().x)("guides.aiConnectorMicrosoftTeams");(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"learn_more_click_intro_modal",integration_type:"microsoft-teams",setup_session_id:m,from:v}}}),e.device.isElectron?(0,Fe().P)(t):window.open(t,"_blank")}),[e,v,m]);return y&&o&&"introduction"===u?He().A.isMobile?(0,S.jsx)(Oe().S,{connectorType:"microsoft-teams",open:"introduction"===u,onClosed:()=>{es().F0.reset()},learnMoreUrl:(0,Le().x)("guides.aiConnectorMicrosoftTeams")}):n?(0,S.jsx)(Ie().A,{connectorType:"microsoft-teams",notes:c,onLearnMore:j,onConnect:x,onDismiss:_,title:(0,S.jsx)(k().sA,{id:"universalSearch.microsoftTeams.intro.microsoftTeamsTitle",defaultMessage:"To start, install the Notion AI app in Microsoft Teams"}),open:"introduction"===u}):(0,S.jsx)(ke().BN,{connector:"microsoft-teams",handleClose:()=>es().F0.reset(),open:"introduction"===u,analyticsFrom:v,setupSessionId:m,messages:be().Fj}):null}n(814603),n(147566),n(198721);var fs=()=>n(493552),ys=()=>n(352321),xs=()=>n(784892),Ss=()=>n(881690),_s=()=>n(942089);const js=(0,k().YK)({disconnectButton:{id:"universalSearch.microsoftTeams.manualSettings.disconnectButtonText",defaultMessage:"Disconnect"}});function bs(e){const{onDisconnect:t,disabled:n}=e,s=(0,D().IS)((()=>({button:{fontSize:14,fontWeight:z().Wy.semibold,width:360}})),[]);return(0,S.jsx)(H().A,{colorPalette:"red",style:s.button,disabled:n,onClick:t,children:(0,S.jsx)(k().sA,{...js.disconnectButton})})}const ks=(0,k().YK)({saveButton:{id:"universalSearch.microsoftTeams.manualSettings.saveButtonText",defaultMessage:"Save Changes"}});function Is(e){const{onSaveSettings:t,disabled:n}=e,s=(0,D().IS)((()=>({button:{fontSize:14,fontWeight:z().Wy.semibold,width:360}})),[]);return(0,S.jsx)(ie().A,{colorPalette:"blue",style:s.button,onClick:t,disabled:n,children:(0,S.jsx)(k().sA,{...ks.saveButton})})}const As=(0,k().YK)({modalAriaLabel:{id:"universalSearch.microsoftTeams.manualSettings.modalAriaLabel",defaultMessage:"Microsoft Teams Manual Settings"},retryActionRequest:{id:"universalSearch.microsoftTeams.settings.retryActionRequest",defaultMessage:"Action failed. Please try again."},alreadySyncing:{id:"universalSearch.microsoftTeams.settings.alreadySyncing",defaultMessage:"Microsoft Teams is already syncing. This can take up to 72 hours."},syncingWithNewSyncControl:{id:"universalSearch.microsoftTeams.settings.syncingWithNewSyncControl",defaultMessage:"Started syncing from Microsoft Teams. This can take up to 72 hours."},invalidUrlsFound:{id:"universalSearch.microsoftTeams.manualSettings.invalidUrlsFound",defaultMessage:"Some URLs were invalid and could not be parsed: {urls}"}});function Cs(e){try{const t=new URL(e.trim());return t.searchParams.get("groupId")||void 0}catch{return}}function ws(){const[e,t]=(0,s.useState)([]),[n,o]=(0,s.useState)(""),[a,r]=(0,s.useState)("inclusion"),[c,g]=(0,s.useState)(!0),[m,h]=(0,s.useState)(!0),v=(0,D().IS)((()=>({wrapper:{width:400,maxHeight:"80vh",paddingInlineEnd:20,paddingBottom:20,paddingInlineStart:20},content:{flex:1,overflowY:"auto",paddingInlineEnd:4},section:{marginTop:6,marginBottom:8},listTypeSection:{marginBottom:6},listTypeLabel:{fontSize:12,fontWeight:z().Wy.medium,color:N().Tj.text.secondary,marginBottom:8,whiteSpace:"nowrap"},listTypeInput:{fontSize:12,fontWeight:z().Wy.medium,color:N().Tj.text.secondary},radioOption:{display:"flex",alignItems:"center",cursor:"pointer",userSelect:"none"},browseTeamsWrapper:{marginBottom:4,marginInlineStart:"auto"},tokenInput:{borderRadius:6,padding:"6px 8px"},infoCircleIcon:{width:21,height:24,paddingInlineStart:4,paddingBottom:5},footer:{gap:12,marginTop:6,paddingTop:12}})),[]),f=(0,l().v3)(),y=(0,k().tz)(),x=(0,i().r)(),_=(0,d().K8)((()=>es().F0.state.currentScreen),[]);(0,u().Yb)((async()=>{if(!x||"manual_settings"!==_)return void h(!1);h(!0);const e=await f.api.callApi({eventName:"getMicrosoftTeamsManualSelection",environment:f,data:{spaceId:x}});"success"===e.type||404===e.status?("success"===e.type&&(t(e.data.teams.map((e=>({id:e.id,teamId:e.id,displayText:e.displayName})))),r(e.data.listType),g(!1)),h(!1)):h(!1)}),[x,f,_]);const b=(0,s.useCallback)((()=>{(0,M().u)({environment:f,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"manual_settings_modal_close",integration_type:"microsoft-teams",setup_session_id:es().F0.state.sessionId,from:es().F0.state.analyticsFrom}}}),es().F0.setState({...es().F0.state,currentScreen:"none"})}),[f]),I=(0,s.useCallback)((async()=>{if(!x)return;(0,M().u)({environment:f,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"save_manual_settings_button_clicked",integration_type:"microsoft-teams",setup_session_id:es().F0.state.sessionId,from:es().F0.state.analyticsFrom}}}),g(!0);const t=await f.api.callApi({eventName:"getMicrosoftTeamsAIConnectorStatus",environment:f,data:{spaceId:x}});if("success"!==t.type)return j().D6({label:y.formatMessage(As.retryActionRequest),position:"bottom"}),void g(!1);if("success"!==t.data.status)return j().D6({label:y.formatMessage(As.alreadySyncing),position:"bottom"}),g(!1),void es().F0.reset();const n=e.map((e=>e.teamId)),s=await f.api.callApi({eventName:"setMicrosoftTeamsManualSelection",environment:f,data:{spaceId:x,teamIds:n,listType:a}});return"success"!==s.type?(j().D6({label:y.formatMessage(As.retryActionRequest),position:"bottom"}),void g(!1)):s.data.success?(g(!1),j().D6({label:y.formatMessage(As.syncingWithNewSyncControl),position:"bottom"}),void(0,p().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"post_edit_screen"})):(j().D6({label:y.formatMessage(As.retryActionRequest),position:"bottom"}),void g(!1))}),[x,f,e,a,y]),A=(0,s.useCallback)((()=>{x?(0,p().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"disconnect_screen"}):es().F0.reset()}),[x]),C=(0,s.useCallback)((n=>{const s=n.target.value;if(o(s),s.includes(",")||s.includes("\n")){const n=s.split(/[,\n]/).filter((e=>e.trim())),i=[],a=[];for(const t of n){const n=t.trim();if(0===n.length)continue;const s=Cs(n);s?e.some((e=>e.teamId===s))||a.push({id:Date.now().toString()+Math.random().toString(36).substr(2,9),teamId:s,displayText:s}):i.push(n)}i.length>0&&j().D6({label:y.formatMessage(As.invalidUrlsFound,{urls:i.slice(0,3).join(", ")+(i.length>3?"...":"")}),position:"bottom"}),a.length>0?(t((e=>{const t=[...e,...a];return g(0===t.length),t})),o("")):g(0===e.length)}}),[e,y]),w=(0,s.useCallback)((s=>{if("Enter"===s.key){const s=n.trim(),i=Cs(s);if(i&&!e.some((e=>e.teamId===i))){const e={id:Date.now().toString()+Math.random().toString(36).substr(2,9),teamId:i,displayText:i};t((t=>{const n=[...t,e];return g(0===n.length),n})),o("")}else s&&!i&&j().D6({label:y.formatMessage(As.invalidUrlsFound,{urls:s}),position:"bottom"})}}),[n,e,y]),T=(0,s.useCallback)((()=>{const s=n.trim(),i=Cs(s);if(i&&!e.some((e=>e.teamId===i))){const e={id:Date.now().toString()+Math.random().toString(36).substr(2,9),teamId:i,displayText:i};t((t=>{const n=[...t,e];return g(0===n.length),n})),o("")}else s&&!i&&s.startsWith("http")&&j().D6({label:y.formatMessage(As.invalidUrlsFound,{urls:s}),position:"bottom"})}),[n,e,y]),B=(0,s.useCallback)((e=>{t((t=>{const n=t.filter((t=>t.id!==e.id));return g(0===n.length),n}))}),[]),F=(0,s.useCallback)((()=>{t((e=>{const t=e.slice(0,-1);return g(0===t.length),t}))}),[]),E=(0,s.useCallback)(((e,t=40)=>e.length<=t?e:e.substring(0,t-3)+"..."),[]);return(0,S.jsx)(te().a,{open:"manual_settings"===_,showCloseIcon:!0,onDismiss:b,render:()=>(0,S.jsxs)(P().wt,{style:v.wrapper,children:[(0,S.jsx)(re().b,{connectorType:"microsoft-teams",title:(0,S.jsx)(k().sA,{id:"universalSearch.microsoftTeams.manualSettings.subtitle",defaultMessage:"Manually configure teams"}),subtext:(0,S.jsx)(k().sA,{id:"universalSearch.microsoftTeams.manualSettings.description",defaultMessage:"Pick which Teams Notion AI can access"})}),m?(0,S.jsx)(P().wt,{style:v.content,children:(0,S.jsx)(oe().A,{style:{alignSelf:"center"}})}):(0,S.jsxs)(P().wt,{style:v.content,children:[(0,S.jsxs)("div",{style:v.section,children:[(0,S.jsxs)(P().Ye,{children:[(0,S.jsx)("div",{style:v.listTypeLabel,children:(0,S.jsxs)(P().Ye,{children:[(0,S.jsx)(k().sA,{id:"universalSearch.microsoftTeams.manualSettings.listType",defaultMessage:"List type"}),(0,S.jsx)(Vt().m,{renderTooltip:()=>(0,S.jsx)(k().sA,{id:"universalSearch.microsoftTeams.manualSettings.listType.tooltip",defaultMessage:"Select whether the entered teams are allowed (Inclusion) or blocked (Exclusion)."}),render:e=>(0,S.jsx)("div",{...e,children:(0,S.jsx)(W().I,{icon:In().infoCircleIcon,style:v.infoCircleIcon})})})]})}),(0,S.jsx)(fs().D,{styleKey:"captionRegular",colorVariant:"secondary",style:v.browseTeamsWrapper,children:(0,S.jsx)(_s()._,{href:"#",external:!0,onClick:()=>{(0,p().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"settings"})},children:(0,S.jsx)(k().sA,{id:"universalSearch.microsoftTeams.manualSettings.browseTeams",defaultMessage:"Browse teams"})})})]}),(0,S.jsx)(P().Ye,{gap:8,children:(0,S.jsx)("div",{style:v.listTypeSection,children:(0,S.jsxs)(P().Ye,{gap:16,children:[(0,S.jsxs)("div",{style:v.radioOption,role:"radio",tabIndex:0,"aria-checked":"inclusion"===a,onClick:()=>r("inclusion"),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),r("inclusion"))},children:[(0,S.jsx)(Y().A,{isSelected:"inclusion"===a}),(0,S.jsx)("span",{style:v.listTypeInput,children:"Inclusion list"})]}),(0,S.jsxs)("div",{style:v.radioOption,role:"radio",tabIndex:0,"aria-checked":"exclusion"===a,onClick:()=>r("exclusion"),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),r("exclusion"))},children:[(0,S.jsx)(Y().A,{isSelected:"exclusion"===a}),(0,S.jsx)("span",{style:v.listTypeInput,children:"Exclusion list"})]})]})})})]}),(0,S.jsxs)("div",{style:v.section,children:[(0,S.jsx)("div",{style:v.listTypeLabel,children:(0,S.jsxs)(P().Ye,{children:[(0,S.jsx)(k().sA,{id:"universalSearch.microsoftTeams.manualSettings.teamList.v2",defaultMessage:"Team URLs"}),(0,S.jsx)(Vt().m,{renderTooltip:()=>(0,S.jsx)(k().sA,{id:"universalSearch.microsoftTeams.manualSettings.teamList.tooltip.v2",defaultMessage:"Paste Microsoft Teams URLs. You can get a team URL by right-clicking on a team in Microsoft Teams and selecting ‘Get link to team’."}),render:e=>(0,S.jsx)("div",{...e,children:(0,S.jsx)(W().I,{icon:In().infoCircleIcon,style:v.infoCircleIcon})})})]})}),(0,S.jsx)(ys().Ay,{focusInitial:!1,focus:!1,showBorder:!0,format:ys().le.Select,tokenWrapStyle:{gap:4},value:n,onChange:C,onSubmit:w,onBlur:T,onRemoveLastToken:F,type:"text",placeholder:y.formatMessage({id:"universalSearch.microsoftTeams.manualSettings.teamInput.placeholder.v2",defaultMessage:"Paste team URLs"}),tokens:e.map((e=>(0,S.jsx)(Vt().m,{renderTooltip:()=>e.teamId,render:t=>(0,S.jsx)("div",{...t,children:(0,S.jsx)(Ss().A,{value:E(e.displayText,40),format:xs().NY.Medium,isSingle:!0,showRemoveButton:!0,onClickRemove:()=>B(e)})})},e.id))),focusAfterAnimation:!1,style:v.tokenInput})]})]}),(0,S.jsxs)(P().wt,{style:v.footer,children:[(0,S.jsx)(Is,{onSaveSettings:I,disabled:c}),(0,S.jsx)(bs,{onDisconnect:A,disabled:!1})]})]}),ariaLabel:y.formatMessage(As.modalAriaLabel)})}const Ts=(0,k().YK)({primedTextInput:{id:"aiConnectors.microsoftTeams.postEdit.primedTextInput",defaultMessage:"Search for messages in Microsoft Teams"}});function Ms(){const e=(0,k().tz)(),t=(0,d().K8)((()=>es().F0.state.currentScreen),[]),n=(0,D().IS)((()=>({wrapper:{width:400},section:{marginTop:4,marginBottom:6},note:{fontWeight:z().Wy.regular,fontSize:14,lineHeight:"18px",width:330,marginInlineStart:8},sectionContainer:{padding:20,width:400,paddingTop:12},bottomSectionContainer:{padding:20,width:400,paddingTop:0}})),[]),o=(0,s.useCallback)((()=>{(0,p().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none"})}),[]),i=(0,s.useCallback)((()=>{(0,p().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none"})}),[]),a=[(0,S.jsx)(P().wt,{children:(0,S.jsx)(k().sA,{id:"assistantOverflowMenu.MicrosoftTeamsIngestion.postEdit.listpoint1",defaultMessage:"Teams content is being updated according to your new selection"},"note-1-message")},"note-1"),(0,S.jsx)(P().wt,{children:(0,S.jsx)(k().sA,{id:"assistantOverflowMenu.MicrosoftTeamsIngestion.postEdit.listpoint2",defaultMessage:"This can take up to 48h and AI answers will be unavailable until it is complete."},"note-2-message")},"note-2")];return(0,S.jsx)(te().a,{showCloseIcon:!0,onDismiss:i,open:"post_edit_screen"===t,render:()=>(0,S.jsxs)("div",{style:n.wrapper,children:[(0,S.jsx)(re().b,{connectorType:"microsoft-teams",title:(0,S.jsx)(k().sA,{id:"aiConnectors.microsoftTeams.postEdit.title",defaultMessage:"Update in Progress"}),subtext:(0,S.jsx)(k().sA,{id:"aiConnectors.microsoftTeams.postEdit.description",defaultMessage:"Here’s what you should know:"})}),(0,S.jsx)(P().wt,{style:n.sectionContainer,children:a.map(((e,t)=>(0,S.jsxs)(P().Ye,{gap:8,style:n.section,children:[(0,S.jsx)(Ue().A,{number:t+1}),(0,S.jsx)("div",{style:n.note,children:e})]},t)))}),(0,S.jsx)(P().wt,{style:n.bottomSectionContainer,children:(0,S.jsx)(ie().A,{colorPalette:"blue",onClick:o,children:(0,S.jsx)(k().sA,{id:"aiConnectors.microsoftTeams.postEdit.primaryButton",defaultMessage:"Done"})})})]}),ariaLabel:e.formatMessage(Ts.primedTextInput)})}var Ds=()=>n(461475),Ps=()=>n(645200);function Ws(){const{learnMoreUrl:e}=(0,g().hP)("notion-calendar"),t=(0,l().v3)(),n=(0,i().r)();return(0,S.jsx)(J().Z,{connector:"notion-calendar",screenName:"introduction",nextScreens:{notStarted:"authentication",inProgress:"connection_complete_screen",alreadyConnected:"already_connected",error:"error"},usesPopup:!1,learnMoreUrl:e,openAuthUrl:()=>{!async function(e){var t,n;const{environment:s}=e,o=null===(t=a().default.state.currentUserStore)||void 0===t?void 0:t.getEmail(),i=null===(n=a().default.state.sidebarSpaceViewStore)||void 0===n?void 0:n.getSpaceId();if(!o||!i)return;const r=await(0,Ps().II)({environment:s,email:o});if(!r||"dismissedDueToCleanup"===r)return;const c=await(0,Ps().Qz)({environment:s,code:r.code,encryptedToken:r.encryptedToken,spaceId:i,from:"agentSetup"})}({environment:t})},onCheckConnectionFromInProgressState:async()=>{if(!n)return!1;const e=await I().callApi({eventName:"connectAiConnector",environment:t,data:{spaceId:n,connector:"notion-calendar"}});if(!("success"===e.type&&e.data.success))return!1;const s="success"===e.type?e.data:void 0,o=null!=s&&s.success?s.externalSourceName:void 0;return gt().gv.setState({...gt().gv.state,status:"authenticated",isConnected:!0,isPersonalAuthComplete:!0,externalSourceName:o}),!0}})}function Bs(){const e=(0,d().K8)((()=>gt().gv.state.currentScreen),[]);return(0,S.jsx)(de().m,{connector:"notion-calendar",open:"already_connected"===e,onDismiss:()=>{gt().gv.reset()}})}function Fs(){const{learnMoreUrl:e}=(0,g().hP)("notion-calendar");return(0,S.jsx)(ue().A,{connector:"notion-calendar",screenName:"not_admin_screen",learnMoreUrl:e})}function Ns(){return(0,S.jsx)(A().a,{connector:"notion-calendar",screenName:"connection_complete_screen",nextScreens:{notStarted:"authentication",inProgress:"none",alreadyConnected:"already_connected",error:"error"},ingestionNotNeeded:!0,onStartIngestion:void 0})}function zs(){return(0,S.jsx)(tt().$,{connector:"notion-calendar",screenName:"connection_exist_screen",nextScreens:{settings:"none"},connectedSpaceId:""})}function Es(){const e=(0,l().v3)(),t=(0,i().r)(),{learnMoreUrl:n,notionAuthUrl:s,troubleShootingUrl:o}=(0,g().hP)("notion-calendar");return t?(0,S.jsx)(y().R,{connector:"notion-calendar",screenName:"authentication",nextScreens:{notAdminOfConnectorAccount:"not_admin_screen",connectionConflict:"connection_exist_screen",connectionSuccess:"connection_complete_screen",error:"error"},learnMoreUrl:n,troubleShootingUrl:o,staticConnectorAuthUrl:s,setConnectionStateAsConnected:()=>{gt().gv.setState({...gt().gv.state,status:"authenticated",isConnected:!0,isPersonalAuthComplete:!0})},callConnectionApi:async()=>{const n=await I().callApi({eventName:"connectAiConnector",environment:e,data:{spaceId:t,connector:"notion-calendar"}});return"success"===n.type&&n.data.success?Promise.resolve({type:"success",data:{connectionSuccess:!0}}):Promise.resolve({type:"success",data:{connectionSuccess:!1,errorResponse:{status:401}}})}}):null}function Us(){return(0,S.jsx)(Z().e,{connector:"notion-calendar",screenName:"settings",nextScreens:{disconnect:"disconnect_screen",error:"error"},settings:void 0})}function Ls(){return(0,S.jsx)(w().X,{connector:"notion-calendar",postDisconnectScreenName:"post_disconnect_screen",disconnectScreenName:"disconnect_screen",settingsScreenName:"settings",errorScreenName:"error",setStatusAsDisconnected:()=>{gt().gv.setState({...gt().gv.state,status:"not_started",isConnected:!1,isLoaded:!0,isBackendConnected:!1})},showGoogleWorkspaceNote:!1})}function Rs(){return(0,S.jsx)(R().b,{connector:"notion-calendar",screenName:"error"})}var Ks=()=>n(142810),Hs=()=>n(812357);function Os(){const{learnMoreUrl:e}=(0,g().hP)("outlook");return(0,S.jsx)(J().Z,{connector:"outlook",screenName:"introduction",nextScreens:{notStarted:"authentication",inProgress:"none",alreadyConnected:"already_connected",error:"error"},learnMoreUrl:e,usesPopup:!0})}function Gs(){const e=(0,d().K8)((()=>Hs().yF.state.currentScreen),[]);return(0,S.jsx)(de().m,{connector:"outlook",open:"already_connected"===e,onDismiss:()=>{Hs().yF.reset()}})}function Ys(){const{learnMoreUrl:e}=(0,g().hP)("outlook");return(0,S.jsx)(ue().A,{connector:"outlook",screenName:"not_admin_screen",learnMoreUrl:e})}function qs(){return(0,S.jsx)(A().a,{connector:"outlook",screenName:"connection_complete_screen",nextScreens:{notStarted:"authentication",inProgress:"none",alreadyConnected:"already_connected",error:"error"},ingestionNotNeeded:!0,onStartIngestion:void 0})}function Js(){return(0,S.jsx)(tt().$,{connector:"outlook",screenName:"connection_exist_screen",nextScreens:{settings:"none"},connectedSpaceId:""})}function Vs(){const e=(0,l().v3)(),t=(0,i().r)(),{learnMoreUrl:n,troubleShootingUrl:s}=(0,g().hP)("outlook");return t?(0,S.jsx)(y().R,{connector:"outlook",screenName:"authentication",nextScreens:{notAdminOfConnectorAccount:"not_admin_screen",connectionConflict:"connection_exist_screen",connectionSuccess:"connection_complete_screen",error:"error"},learnMoreUrl:n,troubleShootingUrl:s,setConnectionStateAsConnected:()=>{Hs().yF.setState({...Hs().yF.state,status:"authenticated",isConnected:!0,isPersonalAuthComplete:!0})},callConnectionApi:async()=>(await(0,p().updateOutlookAIConnectorStatus)({environment:e,spaceId:t}),(0,m().wd)().includes("outlook")?{type:"success",data:{connectionSuccess:!0}}:{type:"success",data:{connectionSuccess:!1,errorResponse:{status:401}}})}):null}function $s(){return(0,S.jsx)(Z().e,{connector:"outlook",screenName:"settings",nextScreens:{disconnect:"disconnect_screen",error:"error"},settings:void 0})}function Qs(){return(0,S.jsx)(w().X,{connector:"outlook",postDisconnectScreenName:"post_disconnect_screen",disconnectScreenName:"disconnect_screen",settingsScreenName:"settings",errorScreenName:"error",showGoogleWorkspaceNote:!0,marketplaceAppConfigureUrl:"",marketplaceAppName:"",setStatusAsDisconnected:()=>{Hs().yF.reset()}})}function Xs(){return(0,S.jsx)(R().b,{connector:"outlook",screenName:"error"})}var Zs=()=>n(919515);const eo=(0,k().YK)({workspaceAdminBody:{id:"salesforceAiConnector.authModal.workspaceAdminBody",defaultMessage:"You should have API access in Salesforce to connect the app."}});function to(){const{learnMoreUrl:e}=(0,g().hP)("salesforce");return(0,S.jsx)(J().Z,{connector:"salesforce",screenName:"introduction",nextScreens:{notStarted:"authentication",inProgress:"none",alreadyConnected:"already_connected",error:"error"},usesPopup:!0,learnMoreUrl:e})}function no(){const e=(0,l().v3)(),t=(0,i().r)(),{learnMoreUrl:n}=(0,g().hP)("salesforce");return t?(0,S.jsx)(y().R,{connector:"salesforce",screenName:"authentication",nextScreens:{connectionSuccess:"none",notAdminOfConnectorAccount:"none",connectionConflict:"none",error:"error"},learnMoreUrl:n,connectorSpecificSetupNote:eo.workspaceAdminBody,troubleShootingUrl:n,setConnectionStateAsConnected:()=>{Zs().Ci.setState({...Zs().Ci.state,status:"in_progress",ingestionProgress:1,isConnected:!1})},callConnectionApi:async()=>(await(0,p().updateSalesforceAIConnectorStatus)({environment:e,spaceId:t}),Zs().Ci.state.ingestionProgress?{type:"success",data:{connectionSuccess:!0}}:{type:"success",data:{connectionSuccess:!1,errorResponse:{status:401}}})}):null}function so(){return(0,S.jsx)(A().a,{connector:"salesforce",screenName:"connection_complete_screen",nextScreens:{notStarted:"authentication",inProgress:"settings",alreadyConnected:"already_connected",error:"error"},ingestionNotNeeded:!1,onStartIngestion:void 0})}function oo(){return(0,S.jsx)(Z().e,{connector:"salesforce",screenName:"settings",nextScreens:{disconnect:"disconnect",error:"error"},settings:void 0})}function io(){return(0,S.jsx)(w().X,{connector:"salesforce",postDisconnectScreenName:"post_disconnect_screen",disconnectScreenName:"disconnect",settingsScreenName:"settings",errorScreenName:"error",setStatusAsDisconnected:()=>{Zs().Ci.setState({...Zs().Ci.state,status:"disconnecting",isConnected:!1,isDisconnecting:!0,currentScreen:"post_disconnect_screen",isLoaded:!0})},showGoogleWorkspaceNote:!1})}var ao=()=>n(544751);function ro(){const[e,t]=s.useState(!1),[n,o]=s.useState(void 0),a=(0,l().v3)(),r=(0,i().r)(),c=(0,Se().L)(),g=(0,_e().J)(c),m=(0,d().K8)((()=>ao().EF.state.currentScreen),[]);(0,u().Yb)((async()=>{if(!r||"connecting"!==m)return;if(!g)return;const e=await I().callApi({eventName:"getAIConnectorAuthorizationUrl",environment:a,data:{connector:"sharepoint",authorizationType:"workspace",spaceId:r,sessionId:ao().EF.state.sessionId,client:a.device.isElectron?"desktop":"web"}});if("success"!==e.type)return;const t=e.data.authorizationUrl;o(t)}),[a,m,r,g]);const h=(0,D().IS)((()=>({noteHeading:{fontWeight:z().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:z().Wy.regular,color:N().Tj.text.secondary,fontSize:14,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:N().Tj.text.secondary,textDecoration:"underline",cursor:"pointer"},warningText:{fontSize:14,lineHeight:"18px",color:"#D7813A",paddingInlineStart:14,fontWeight:z().Wy.regular},warningContainer:{marginInlineStart:5,marginInlineEnd:5,marginBottom:15}})),[]),v=(0,un().$)();(0,Yn().n)((async()=>{if(!r)return;if("connecting"!==ao().EF.state.currentScreen)return;const e=await(0,p().getSharepointConnectorDetails)({environment:a,spaceId:r});"not_started"!==e.status&&ao().EF.setState({...ao().EF.state,currentScreen:"confirmation",connectionDetails:{status:"pending_selection",progress:0,externalSourceName:e.externalSourceName}})}),2e3,!0);const f=(0,s.useCallback)((async()=>{if(!r)return;"not_started"!==(await(0,p().getSharepointConnectorDetails)({environment:a,spaceId:r})).status?(0,p().navigateToSharepointUniversalScreen)({currentScreen:"confirmation"}):t(!0),(0,M().u)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"check_connection_button_clicked",integration_type:"sharepoint",setup_session_id:ao().EF.state.sessionId,from:ao().EF.state.analyticsFrom}}})}),[a,r]),y=(0,s.useCallback)((()=>{t(!1),(0,M().u)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"check_connection_modal_dismissed",integration_type:"sharepoint",setup_session_id:ao().EF.state.sessionId,from:ao().EF.state.analyticsFrom}}}),ao().EF.reset()}),[a]);if(!v||!r)return null;const x=e?(0,S.jsxs)(P().Ye,{style:h.warningContainer,children:[(0,S.jsx)(W().I,{icon:F().exclamationMarkTriangleFillIcon,colorPalette:"orange",colorVariant:"accentPrimary"}),(0,S.jsx)("div",{style:h.warningText,children:(0,S.jsx)(k().sA,{id:"universalSearch.sharepoint.checkConnection.warning",defaultMessage:"We couldn’t connect to SharePoint. Please review the instructions and try again, or check our {TroubleshootingGuide}",values:{TroubleshootingGuide:(0,S.jsx)("a",{style:{...h.link,color:"#D7813A"},href:(0,Le().x)("guides.aiConnectorSharepoint"),target:"_blank",onClick:()=>{(0,M().u)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"troubleshooting_guide_clicked",integration_type:"sharepoint",setup_session_id:ao().EF.state.sessionId,from:ao().EF.state.analyticsFrom}}})},children:(0,S.jsx)(k().sA,{id:"universalSearch.sharepoint.checkConnection.troubleShootingLink",defaultMessage:"troubleshooting guide."})})}})})]}):void 0;return(0,S.jsx)(E().Q,{title:(0,S.jsx)(k().sA,{id:"universalSearch.sharepoint.checkConnection.title",defaultMessage:"Follow instructions from SharePoint in your browser"}),open:"connecting"===m,onDismiss:y,warningMessage:x,notes:[(0,S.jsxs)(P().wt,{style:{gap:4},children:[(0,S.jsx)("div",{style:h.noteHeading,children:(0,S.jsx)(k().sA,{id:"universalSearch.sharepoint.checkConnection.openAuthorizationUrlInNewTabTitle",defaultMessage:"SharePoint should open automatically on a new browser tab."},"note1-1")}),(0,S.jsx)("div",{style:h.noteBody,children:(0,S.jsx)(k().sA,{id:"universalSearch.sharepoint.checkConnection.authWaiting2",defaultMessage:"If it doesn’t, {ClickHereToRetry}",values:{ClickHereToRetry:(0,S.jsx)("a",{style:h.link,href:n,target:"_blank",onClick:()=>{(0,M().u)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"retry_opening_sharepoint_auth_url",integration_type:"sharepoint",setup_session_id:ao().EF.state.sessionId,from:ao().EF.state.analyticsFrom}}})},children:(0,S.jsx)(k().sA,{id:"universalSearch.sharepoint.checkConnection.confirmModalNote1Retry",defaultMessage:"click here to retry"})})}},"note1-2")})]},"note-1"),(0,S.jsxs)(P().wt,{style:{gap:4},children:[(0,S.jsx)("div",{style:h.noteHeading,children:(0,S.jsx)(k().sA,{id:"universalSearch.sharepoint.checkConnection.followInstructions",defaultMessage:"Follow SharePoint’s instructions to connect"},"note2")}),(0,S.jsx)("div",{style:h.noteBody,children:(0,S.jsx)(k().sA,{id:"universalSearch.sharepoint.checkConnection.followInstructionsDescription",defaultMessage:"Install the Notion connector in a SharePoint workspace and return to this window"},"note1-2")})]},"note-2"),(0,S.jsx)(P().wt,{style:{gap:4},children:(0,S.jsx)("div",{style:h.noteHeading,children:(0,S.jsx)(k().sA,{id:"universalSearch.sharepoint.checkConnection.returnToNotion",defaultMessage:"Return to this window, and the process will continue automatically."},"note3")})},"note-3")],openLearnMoreUrl:()=>{window.open((0,Le().x)("guides.aiConnectorSharepoint"),"_blank")},connectorType:"sharepoint",primaryButtonText:(0,S.jsx)(k().sA,{id:"universalSearch.sharepoint.checkConnection.checkConnectionButton",defaultMessage:"Check Connection"},"note3-1"),onClickPrimaryButton:f})}const co=At().w0.sharepoint;function lo(){const e=(0,k().tz)(),t=(0,l().v3)(),n=(0,d().K8)((()=>ao().EF.state.currentScreen),[]),o=(0,i().r)(),a=(0,s.useCallback)((async()=>{if(!o)return;(0,M().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"edit_settings_button_clicked",integration_type:"sharepoint",setup_session_id:ao().EF.state.sessionId,from:ao().EF.state.analyticsFrom}}});const e=await(0,p().getSharepointConnectorDetails)({environment:t,spaceId:o});e?"in_progress"!==e.status&&"editing"!==e.status?"pending_selection"!==e.status&&"completed"!==e.status?(0,p().navigateToSharepointUniversalScreen)({currentScreen:"error"}):(0,p().navigateToSharepointUniversalScreen)({currentScreen:"settings"}):(0,p().navigateToSharepointUniversalScreen)({currentScreen:"edit_blocked"}):(0,p().navigateToSharepointUniversalScreen)({currentScreen:"error"})}),[o,t]),r=(0,s.useCallback)((async()=>{if(!o)return;(0,M().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"ingestion_started",integration_type:"sharepoint",setup_session_id:ao().EF.state.sessionId,from:ao().EF.state.analyticsFrom}}});const n=await(0,p().getSharepointConnectorDetails)({environment:t,spaceId:o});if(!n)return j().D6({label:e.formatMessage({defaultMessage:"Action failed. Please try again.",id:"universalSearch.sharepoint.connectionComplete.retryActionRequest"}),position:"bottom"}),void ao().EF.reset();if(["disconnecting","editing"].includes(n.status))return j().D6({label:e.formatMessage({defaultMessage:"Failed to update the connection. Please try again later.",id:"universalSearch.sharepoint.connectionComplete.failedToUpdateConnection"}),position:"bottom"}),void ao().EF.reset();if(["in_progress","completed"].includes(n.status))return void ao().EF.reset();await I().callApi({eventName:"startIngestion",environment:t,data:{connector:"sharepoint",spaceId:o,setupSessionId:ao().EF.state.sessionId}})?ao().EF.setInProgressAndClose():j().D6({label:e.formatMessage({defaultMessage:"Failed to start sync. Please try again later.",id:"universalSearch.sharepoint.connectionComplete.failedToStartSync"}),position:"bottom"})}),[o,t,e]);return(0,s.useEffect)((()=>{"confirmation"===n&&(0,p().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:t,connector:"sharepoint",moment:"finished"})}),[t,n]),(0,S.jsx)(Qe().v,{open:"confirmation"===n,onDismiss:r,connectorType:"sharepoint",notes:[(0,S.jsx)($e().L,{number:1,title:{...{...Qe().D.connectionInProgressTitle,values:{appName:co}}},description:Qe().D.defaultConnectionTime},"item1"),(0,S.jsx)($e().L,{number:2,title:{...{...Qe().D.defaultNotionAiWillBeAbleToAnswerQuestions,values:{appName:co}}}},"item2")],onEditSettingsClick:a,onPrimaryButtonClick:r})}function uo(){const e=(0,k().tz)(),t=(0,D().IS)((()=>({confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:z().Wy.semibold,color:N().Tj.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:z().J.UIRegular.desktop,fontWeight:z().Wy.medium,color:N().Tj.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:z().J.UIRegular.desktop,fontWeight:z().Wy.regular,color:N().Tj.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:z().J.UIRegular.desktop,fontWeight:z().Wy.regular,width:"100%",textAlign:"center",paddingTop:4,paddingInlineEnd:0,paddingBottom:4,paddingInlineStart:0},confirmDisconnectButton:{fontSize:z().J.UIRegular.desktop,fontWeight:z().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},notesSectionWrapper:{paddingTop:12,paddingInlineEnd:12,paddingBottom:12,paddingInlineStart:12,gap:13},noteBlockWrapper:{marginBottom:12,gap:8},note:{fontWeight:z().Wy.regular,fontSize:z().J.UIRegular.desktop,lineHeight:"18px"},noteHeading:{fontWeight:z().Wy.medium,fontSize:z().J.UIRegular.desktop,lineHeight:"18px"},noteBody:{fontWeight:z().Wy.regular,color:N().Tj.text.secondary,fontSize:z().J.UIRegular.desktop,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:N().Tj.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{rotate:"45deg",width:12,height:12,cursor:"pointer",display:"inline",padding:0,margin:0}})),[]),[n,o]=(0,s.useState)(!1),a=(0,d().K8)((()=>ao().EF.state.currentScreen),[]),r=(0,i().r)(),c=(0,l().v3)(),u=(0,s.useCallback)((()=>{ao().EF.reset()}),[]),p=(0,s.useCallback)((()=>{ao().EF.reset()}),[]),g=(0,s.useCallback)((async()=>{if(o(!0),!r)return void o(!1);(0,M().u)({environment:c,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_button_clicked",integration_type:"sharepoint",setup_session_id:ao().EF.state.sessionId,from:ao().EF.state.analyticsFrom}}});const e=await async function(e){const{environment:t,spaceId:n}=e,s=await I().callApi({eventName:"disconnectAiConnector",environment:t,data:{spaceId:n,connector:"sharepoint"}});if("success"===s.type)return j().D6({label:Dn().A.getIntl().formatMessage({defaultMessage:"Started disconnecting SharePoint. This can take up to 3 hours.",id:"sharepoint.disconnect.started"}),position:"bottom",style:{width:"400px",display:"flex",justifyContent:"space-between"}}),!0;return!1}({environment:c,spaceId:r});e&&ao().EF.setState({...ao().EF.state,status:"disconnecting",currentScreen:"post_disconnect"}),o(!1)}),[c,r]),m=(0,s.useCallback)((()=>{ao().EF.setState({...ao().EF.state,currentScreen:"settings"})}),[]),h=(0,s.useCallback)((()=>{const{noteBlockWrapper:e,noteHeading:n,noteBody:s}=t;return[(0,S.jsxs)(P().wt,{style:e,children:[(0,S.jsx)("div",{style:n,children:(0,S.jsx)(k().sA,{...po.note1Heading})}),(0,S.jsx)("div",{style:s,children:(0,S.jsx)(k().sA,{...po.note1Body})})]},"note-1")]}),[t]);return"post_disconnect"===a?(0,S.jsx)(Lt().A,{onClickGotItBtn:p,onDismiss:u,open:"post_disconnect"===a,connectorType:"sharepoint",title:(0,S.jsx)(k().sA,{...po.postDisconnectTitle}),descriptionMessage:(0,S.jsx)(k().sA,{...po.postDisconnectDescription}),message:(0,S.jsx)("div",{style:t.notesSectionWrapper,children:h().map(((e,n)=>(0,S.jsx)(P().Ye,{gap:8,style:{marginTop:4,marginBottom:6},children:(0,S.jsx)("div",{style:t.note,children:e})},n)))})}):(0,S.jsx)(te().a,{showCloseIcon:!0,open:"disconnect"===a,onDismiss:u,render:()=>(0,S.jsx)("div",{style:t.confirmWrapper,children:(0,S.jsxs)("div",{style:t.confirmContainer,children:[(0,S.jsx)("div",{style:t.confirmModalTitle,children:(0,S.jsx)(k().sA,{...po.disconnectTitle})}),(0,S.jsx)("div",{style:t.confirmModalSubTitle,children:(0,S.jsx)(k().sA,{...po.disconnectSubTitle})}),(0,S.jsx)("div",{style:t.confirmModalDescription,children:(0,S.jsx)(k().sA,{...po.disconnectDescription})}),(0,S.jsxs)(P().wt,{style:t.confirmModalActionButtons,children:[(0,S.jsx)(ie().A,{colorPalette:"red",style:t.confirmDisconnectButton,isLoading:n,onClick:g,children:(0,S.jsx)(k().sA,{...po.primaryButtonLabel})}),(0,S.jsx)(b().Ay,{style:t.goBackButton,onClick:m,children:(0,S.jsx)(k().sA,{...po.goBackButtonLabel})})]})]})}),ariaLabel:e.formatMessage(po.disconnectModalAriaLabel)})}const po=(0,k().YK)({note1Heading:{id:"universalSearch.sharepoint.postDisconnect.note_1.heading",defaultMessage:"SharePoint data will be permanently deleted from Notion"},note1Body:{id:"universalSearch.sharepoint.postDisconnect.note_1.body",defaultMessage:"This process can take up to 3 hours. You’ll only be able to reconnect after disconnecting is complete."},postDisconnectTitle:{id:"universalSearch.sharepoint.postDisconnect.title",defaultMessage:"SharePoint is disconnecting from Notion AI"},postDisconnectDescription:{id:"universalSearch.sharepoint.postDisconnect.description",defaultMessage:"Here’s what you should know:"},disconnectTitle:{id:"universalSearch.sharepoint.disconnectModal.title",defaultMessage:"Are you sure?"},disconnectSubTitle:{id:"universalSearch.sharepoint.disconnectModal.subTitle",defaultMessage:"SharePoint data will be permanently deleted from Notion."},disconnectDescription:{id:"universalSearch.sharepoint.disconnectModal.description",defaultMessage:"This process can take up to 3 hours, and you’ll only be able to reconnect after disconnecting is complete."},primaryButtonLabel:{id:"universalSearch.sharepoint.disconnectModal.confirmDisconnect",defaultMessage:"Disconnect for everyone"},goBackButtonLabel:{id:"universalSearch.sharepoint.disconnectModal.goBack",defaultMessage:"Go back"},disconnectModalAriaLabel:{id:"universalSearch.sharepoint.disconnectModal.label",defaultMessage:"Disconnect SharePoint Modal"}});function go(){const e=(0,k().tz)(),t=(0,d().K8)((()=>ao().EF.state.currentScreen),[]),n=(0,D().IS)((()=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:N().Tj.shadowMD,paddingTop:20,paddingInlineEnd:20,paddingBottom:20,paddingInlineStart:20,gap:6},connectButton:{fontSize:14,fontWeight:z().Wy.semibold,width:"100%"}})),[]);return(0,S.jsx)(te().a,{open:"error"===t,showCloseIcon:!0,onDismiss:()=>{ao().EF.reset()},render:()=>(0,S.jsxs)("div",{style:n.wrapper,children:[(0,S.jsx)(re().b,{connectorType:"sharepoint",title:(0,S.jsx)(k().sA,{id:"universalSearch.sharepoint.error.title",defaultMessage:"Oops! Something went wrong"}),subtext:(0,S.jsx)(k().sA,{id:"universalSearch.sharepoint.error.description",defaultMessage:"Something went wrong, please try again later."})}),(0,S.jsx)(P().wt,{style:n.footer,children:(0,S.jsx)(ie().A,{colorPalette:"blue",style:n.connectButton,onClick:()=>{ao().EF.reset()},children:(0,S.jsx)(k().sA,{id:"universalSearch.sharepoint.dismissButton",defaultMessage:"Close"})})})]}),ariaLabel:e.formatMessage({id:"universalSearch.sharepoint.error.ariaLabel",defaultMessage:"SharePoint error modal"})})}function mo(e){const{open:t}=e;return(0,S.jsx)(de().m,{open:t,onDismiss:()=>{ao().EF.reset()},connector:"sharepoint"})}const ho=(0,k().YK)({sharepointAIConnectorOauthPopupTitle:{defaultMessage:"Connect SharePoint AI Connector",id:"sharepointAIConnector.oauthPopupTitle"}});function vo(){const e=(0,k().tz)(),t=(0,s.useMemo)((()=>(0,je().J)("sharepoint")),[]),n=(0,s.useMemo)((()=>(0,je().a)("sharepoint")),[]),o=(0,l().v3)(),[i,a]=(0,s.useState)("CLOSED"),r=(0,Se().L)(),c=null==r?void 0:r.id,g=(0,d().O$)(ao().EF),m=(0,d().K8)((()=>ao().EF.state.sessionId),[]),h=(0,d().K8)((()=>ao().EF.state.analyticsFrom),[]),v=(0,D().IS)((()=>({loadingWrapper:{padding:20,fontSize:12,fontWeight:z().Wy.regular,justifyContent:"center",gap:8,alignItems:"center"}})),[]),y=(0,_e().J)(r),x=(0,f().P)({name:"ai_connectors",spaceId:null==r?void 0:r.id,userId:o.currentUser.id}),_=(0,s.useCallback)((()=>{const e=(0,Le().x)("guides.aiConnectorSharepoint");(0,M().u)({environment:o,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"learn_more_click_intro_modal",integration_type:"sharepoint",setup_session_id:ao().EF.state.sessionId,from:ao().EF.state.analyticsFrom}}}),o.device.isElectron?(0,Fe().P)(e):window.open(e,"_blank")}),[o]),j=(0,s.useCallback)((async()=>{if(!c)return;if(!y)return;if(!x)return;const e=await I().callApi({eventName:"getAIConnectorAuthorizationUrl",environment:o,data:{connector:"sharepoint",authorizationType:"workspace",spaceId:c,client:o.device.isElectron?"desktop":"web",sessionId:ao().EF.state.sessionId}});if("success"!==e.type)return;const t=e.data.authorizationUrl;o.device.isElectron?(0,Fe().P)(t):G().P(o,{width:800,height:600,url:t,titleMessage:ho.sharepointAIConnectorOauthPopupTitle}),ao().EF.setState({...ao().EF.state,authUrl:t,currentScreen:"connecting"})}),[c,o,y,x]),[b]=(0,u().Yb)((async()=>{if(!c||"introduction"!==g.currentScreen)return;const e=await I().callApi({eventName:"listAIConnectors",environment:o,data:{spaceId:c}});return"success"===e.type?{isSharepointConnected:e.data.connectedConnectors.map((e=>e.id)).some((e=>"sharepoint"===e))}:void 0}),[o,g.currentScreen,c]);(0,s.useEffect)((()=>{"introduction"===g.currentScreen?"resolved"===b.status?a("OPEN"):a("LOADING"):a("CLOSED")}),[b.status,g.currentScreen]);const A=(0,s.useRef)(!1),C=(0,s.useCallback)((()=>{ao().EF.reset(),(0,M().u)({environment:o,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drop_off_sharepoint_intro_modal",integration_type:"sharepoint",setup_session_id:ao().EF.state.sessionId,from:ao().EF.state.analyticsFrom}}}),A.current=!1}),[o]),w=(0,s.useCallback)((async()=>{await j(),(0,M().u)({environment:o,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"sharepoint_ai_connector_auth_url_open",integration_type:"sharepoint",setup_session_id:ao().EF.state.sessionId,from:ao().EF.state.analyticsFrom}}}),(0,p().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:o,connector:"sharepoint",moment:"started"}),ao().EF.setState({...ao().EF.state,currentScreen:"connecting"})}),[o,j]);return(0,s.useEffect)((()=>{c&&y&&"resolved"===b.status&&"introduction"===g.currentScreen&&(A.current||((0,M().u)({environment:o,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:"sharepoint",setup_session_id:g.sessionId,from:g.analyticsFrom,is_space_admin:y,is_ai_eligible:x??!1}}}),A.current=!0))}),[c,o,b.status,g.sessionId,g.analyticsFrom,y,x,g.currentScreen]),c&&"CLOSED"!==i?He().A.isMobile?(0,S.jsx)(Oe().S,{connectorType:"sharepoint",open:"introduction"===g.currentScreen,onClosed:()=>{ao().EF.reset()},learnMoreUrl:(0,Le().x)("guides.aiConnectorSharepoint")}):"LOADING"===i?(0,S.jsx)(te().a,{ariaLabel:e.formatMessage({id:"sharepointAIConnector.oauthPopupTitle.ariaLabel",defaultMessage:"Loading SharePoint AI connector status"}),open:"LOADING"===i,render:()=>(0,S.jsxs)(P().Ye,{style:v.loadingWrapper,children:[(0,S.jsx)(k().sA,{id:"universalQna.sharepoint.isFetchingConnection",defaultMessage:"Getting connection status"}),(0,S.jsx)(oe().k,{})]})}):g.isConnected?(0,S.jsx)(mo,{open:!0}):y?(0,S.jsx)(Ie().A,{onConnect:w,onDismiss:C,onLearnMore:_,title:t,connectorType:"sharepoint",notes:n,open:"OPEN"===i}):(0,S.jsx)(ke().BN,{connector:"sharepoint",analyticsFrom:h,setupSessionId:m,handleClose:()=>(0,p().resetAiConnectorStatus)("sharepoint"),open:"OPEN"===i,messages:be().oO}):null}var fo=()=>n(842599),yo=()=>n(977270);function xo(e){const{onSaveSettings:t,disabled:n}=e,s=jo();return(0,S.jsx)(ie().A,{colorPalette:"blue",style:s.connectButton,onClick:t,disabled:n,children:(0,S.jsx)(k().sA,{..._o.saveButton})})}function So(){const[e,t]=(0,s.useState)(!0),[n,o]=(0,s.useState)(!1),[a,r]=(0,s.useState)(""),[c,g]=(0,s.useState)([]),[m,h]=(0,s.useState)([]),[v,f]=(0,s.useState)([]),[y,x]=(0,s.useState)(!0),[_,b]=(0,s.useState)(!1),A=jo(),C=(0,l().v3)(),w=(0,k().tz)(),T=(0,i().r)(),D=(0,d().K8)((()=>ao().EF.state.currentScreen),[]),W=(0,d().K8)((()=>{var e;return null===(e=ao().EF.state.connectionDetails)||void 0===e?void 0:e.status}),[]);(0,u().Yb)((async()=>{if(!T||"settings"!==D)return;if(!W)return t(!1),void ao().EF.reset();if(["in_progress","disconnecting","editing"].includes(W))return t(!1),void ao().EF.reset();t(!0);const e=await I().callApi({eventName:"getAllSharepointSites",environment:C,data:{spaceId:T}}),n=await I().callApi({eventName:"getSharepointSelection",environment:C,data:{spaceId:T}});if("failed"===e.type||"failed"===n.type)return;const s=e.data;g(n.data.includedSites),h(n.data.excludedSites),b(n.data.includeFutureSites),f(s),t(!1)}),[T,D,W,C]),(0,s.useEffect)((()=>{const e=v.filter((e=>![...c,...m].includes(e.id)));if(e.length>0){const t=_?e.map((e=>e.id)):[],n=_?[]:e.map((e=>e.id));t.length>0&&g((e=>[...e,...t])),n.length>0&&h((e=>[...e,...n]))}}),[v,_,c,m]),(0,s.useEffect)((()=>{c.length===v.length?x(!0):c.length>0?x("partial"):x(!1)}),[c,v]);const F=(0,s.useCallback)((e=>c.includes(e)),[c]),N=(0,s.useCallback)((e=>{c.includes(e)?(g((t=>t.filter((t=>t!==e)))),h((t=>[...t,e]))):(h((t=>t.filter((t=>t!==e)))),g((t=>[...t,e])))}),[c]),z=(0,s.useCallback)((()=>{c.length>0?(g([]),h(v.map((e=>e.id)))):(g(v.map((e=>e.id))),h([]))}),[c,v]),E=(0,s.useCallback)((()=>c.length>0),[c]),U=(0,d().K8)((()=>yo().AssistantFeatureGateStore.isSharepointSelectionV2Enabled()),[]),L=(0,s.useCallback)((()=>{(0,M().u)({environment:C,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_close",integration_type:"sharepoint",setup_session_id:ao().EF.state.sessionId,from:ao().EF.state.analyticsFrom}}}),ao().EF.setState({...ao().EF.state,currentScreen:"none"})}),[C]),R=(0,s.useCallback)((async()=>{if(!T)return;(0,M().u)({environment:C,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"save_settings_button_clicked",integration_type:"sharepoint",setup_session_id:ao().EF.state.sessionId,from:ao().EF.state.analyticsFrom}}}),o(!0);const e=await(0,p().getSharepointConnectorDetails)({environment:C,spaceId:T});return e?"completed"!==e.status&&"pending_selection"!==e.status?(j().D6({label:w.formatMessage(_o.alreadySyncing),position:"bottom"}),o(!1),void ao().EF.reset()):(await I().callApi({eventName:"setSharepointSelection",environment:C,data:{spaceId:T,allSites:!0===y,includedSites:c,excludedSites:m,includeFutureSites:_}}),await I().callApi({eventName:"startIngestion",environment:C,data:{connector:"sharepoint",spaceId:T,setupSessionId:ao().EF.state.sessionId}}),o(!1),j().D6({label:w.formatMessage(_o.syncingWithNewSyncControl),position:"bottom"}),(0,p().navigateToSharepointUniversalScreen)({currentScreen:"post_edit"}),void ao().EF.setInProgressAndClose()):(j().D6({label:w.formatMessage(_o.retryActionRequest),position:"bottom"}),void o(!1))}),[T,C,w,y,c,m,_]),K=(0,s.useCallback)((()=>{T?(0,p().navigateToSharepointUniversalScreen)({currentScreen:"disconnect"}):ao().EF.reset()}),[T]),H=(0,s.useCallback)((()=>(0,S.jsxs)(P().wt,{children:[(0,S.jsxs)(P().Ye,{style:A.siteItem,children:[(0,S.jsx)("div",{children:(0,S.jsx)(ne().S,{disabled:n,checked:y,size:14,onClick:()=>{z()}})}),(0,S.jsx)("div",{style:A.sitesText,children:(0,S.jsx)(k().sA,{id:"universalSearch.sharepoint.settings.allSitesToggle",defaultMessage:"All sites"})}),U?(0,S.jsx)("div",{style:A.manualSettingsLink,children:(0,S.jsx)(_s()._,{href:"#",external:!0,onClick:()=>{(0,p().navigateToSharepointUniversalScreen)({currentScreen:"manual_settings"})},children:(0,S.jsx)(k().sA,{id:"universalSearch.sharepoint.manualSettings.manualSettings",defaultMessage:"Manual Settings"})})}):void 0]}),(0,S.jsx)(se().A,{style:A.divider,size:4}),(0,S.jsx)(S.Fragment,{children:e?(0,S.jsxs)(P().Ye,{style:A.futureSitesCheckboxWrapper,children:[(0,S.jsx)(oe().k,{}),(0,S.jsx)("div",{style:A.sitesText,children:(0,S.jsx)(k().sA,{id:"universalSearch.sharepoint.settings.loadingSites",defaultMessage:"Fetching sites. This can take up to a few minutes based on the number of sites in your account."})})]}):(0,S.jsx)(P().wt,{style:A.selectionWrapper,children:(a?v.filter((e=>(e.name||e.id).toLowerCase().includes(a.toLowerCase()))):v).map((e=>(0,S.jsxs)(P().Ye,{gap:8,style:A.siteItemWrapper,children:[(0,S.jsx)("div",{children:(0,S.jsx)(ne().S,{disabled:n,checked:F(e.id),onClick:()=>{N(e.id)},size:14},`${e.id}-checkbox`)}),(0,S.jsx)("div",{style:A.sitesText,children:` ${e.name||e.id}`},`${e.id}-label`)]},e.id)))})})]})),[A,n,y,e,a,v,z,F,N,U]);return(0,S.jsx)(te().a,{open:"settings"===D,showCloseIcon:!0,onDismiss:L,render:()=>(0,S.jsxs)("div",{style:A.wrapper,children:[(0,S.jsx)(re().b,{connectorType:"sharepoint",title:(0,S.jsx)(k().sA,{id:"universalSearch.sharepoint.settings.title",defaultMessage:"Connection Settings"})}),(0,S.jsx)(Ct().A,{capture:!0,allowEsc:!0,render:()=>(0,S.jsx)("div",{children:(0,S.jsx)(P().Ye,{style:A.searchBarWrapper,children:(0,S.jsx)(B().A,{id:"sharepointUniversalQnASearchBar",style:A.searchBar,placeholder:w.formatMessage(_o.searchBoxPlaceholder),value:a,onChange:e=>{r(e.target.value)},disabled:e},"sharepointUniversalQnASearchBar")})})}),(0,S.jsx)(P().Ye,{style:A.selectionContainer,children:(0,S.jsx)(P().wt,{style:A.selection,children:H()})}),(0,S.jsxs)(P().wt,{style:A.footer,children:[(0,S.jsxs)(P().Ye,{style:A.futureSitesCheckboxWrapper,children:[(0,S.jsx)("div",{children:(0,S.jsx)(ne().S,{disabled:n,checked:_,size:14,onClick:()=>{b(!_)}})}),(0,S.jsx)("div",{style:A.sitesText,children:(0,S.jsx)(k().sA,{..._o.syncFutureSitesCheckboxLabel})})]}),(0,S.jsx)(xo,{onSaveSettings:R,disabled:n||e||!E()&&!_}),(0,S.jsx)(bo,{onDisconnect:K,disabled:n||e||"in_progress"===W})]})]}),ariaLabel:w.formatMessage(_o.modalAriaLabel)})}const _o=(0,k().YK)({saveButton:{id:"universalSearch.sharepoint.settings.settingsModal.saveChangesButtonText",defaultMessage:"Save Changes"},disconnectButton:{id:"universalSearch.sharepoint.settings.settingsModal.disconnectButtonText",defaultMessage:"Disconnect"},modalAriaLabel:{id:"universalSearch.sharepoint.settings.modalAriaLabel",defaultMessage:"SharePoint error modal"},searchBoxPlaceholder:{id:"universalSearch.sharepoint.settings.searchBoxPlaceholder",defaultMessage:"Search for a site"},alreadySyncing:{defaultMessage:"SharePoint is already syncing. This can take up to 72 hours.",id:"universalSearch.sharepoint.settings.alreadySyncing"},retryActionRequest:{defaultMessage:"Action failed. Please try again.",id:"universalSearch.sharepoint.settings.retryActionRequest"},syncFutureSitesCheckboxLabel:{id:"universalSearch.sharepoint.settings.syncFutureSitesCheckboxLabel",defaultMessage:"Include sites created in the future"},syncingWithNewSyncControl:{id:"universalSearch.sharepoint.settings.syncingWithNewSyncControl",defaultMessage:"Started syncing from SharePoint. This can take up to 72 hours."}});function jo(){return(0,D().IS)((()=>({wrapper:{width:400,display:"flex",flexDirection:"column",minHeight:530},footer:{width:"100%",justifySelf:"flex-end",boxShadow:"0px 9px 24px 0px #0F0F0F33",paddingTop:16,paddingInlineEnd:20,paddingBottom:16,paddingInlineStart:20,gap:12,bottom:0},connectButton:{fontSize:14,fontWeight:z().Wy.semibold,width:360},searchBarWrapper:{justifyContent:"center"},searchBar:{width:360,padding:4},selectionContainer:{marginTop:18,marginBottom:0,width:"100%",height:"100%",justifyContent:"center",padding:"0px 20px 0px",flexGrow:1},selection:{width:"100%"},siteItem:{gap:4,alignItems:"center"},sitesText:{fontSize:12,lineHeight:"16px",display:"flex",flexDirection:"row",gap:4},divider:{marginTop:5,marginBottom:5},futureSitesCheckboxWrapper:{gap:12,visibility:"visible"},selectionWrapper:{overflowY:"scroll",maxHeight:170},siteItemWrapper:{marginTop:12},manualSettingsLink:{fontSize:12,paddingInlineStart:"200px"}})),[])}function bo(e){const{onDisconnect:t,disabled:n}=e,s=jo();return(0,S.jsx)(H().A,{colorPalette:"red",style:s.connectButton,disabled:n,onClick:t,children:(0,S.jsx)(k().sA,{..._o.disconnectButton})})}function ko(){const[e,t]=(0,s.useState)([]),[n,o]=(0,s.useState)(""),[a,r]=(0,s.useState)([]),[c,g]=(0,s.useState)(""),[m,h]=(0,s.useState)("inclusion"),[v,f]=(0,s.useState)(!0),[y,x]=(0,s.useState)(!0),_=(0,D().IS)((()=>({wrapper:{width:400,maxHeight:"80vh",paddingInlineEnd:20,paddingBottom:20,paddingInlineStart:20},content:{flex:1,overflowY:"auto",paddingInlineEnd:4},section:{marginTop:6,marginBottom:8},sectionHeader:{fontSize:12,fontWeight:z().Wy.medium,marginBottom:6},listTypeSection:{marginBottom:6},listTypeLabel:{fontSize:12,fontWeight:z().Wy.medium,color:N().Tj.text.secondary,marginBottom:8},listTypeInput:{fontSize:12,fontWeight:z().Wy.medium,color:N().Tj.text.secondary},radioOption:{display:"flex",alignItems:"center",cursor:"pointer",userSelect:"none"},radioLabel:{fontSize:14,color:N().Tj.text.primary},inputContainer:{minHeight:56,padding:"8px 12px"},browseSitesWrapper:{marginBottom:4,paddingInlineStart:204},tokenInput:{borderRadius:6,padding:"6px 8px"},infoCircleIcon:{width:21,height:24,paddingInlineStart:4,paddingBottom:5},footer:{gap:12,marginTop:6,paddingTop:12}})),[]),b=(0,l().v3)(),A=(0,k().tz)(),C=(0,i().r)(),w=(0,d().K8)((()=>ao().EF.state.currentScreen),[]);(0,u().Yb)((async()=>{if(!C||"manual_settings"!==w)return void x(!1);x(!0);const e=await I().callApi({eventName:"getSharepointManualSelection",environment:b,data:{spaceId:C}});"success"!==e.type&&404!==e.status||("success"===e.type&&(t(e.data.sites.map((e=>({id:e,url:e})))),r(e.data.users.map((e=>({id:e,email:e})))),h(e.data.listType),f(!1)),x(!1))}),[C,b,w]);const T=(0,s.useCallback)((()=>{(0,M().u)({environment:b,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"manual_settings_modal_close",integration_type:"sharepoint",setup_session_id:ao().EF.state.sessionId,from:ao().EF.state.analyticsFrom}}}),ao().EF.setState({...ao().EF.state,currentScreen:"none"})}),[b]),B=(0,s.useCallback)((async()=>{if(!C)return;(0,M().u)({environment:b,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"save_manual_settings_button_clicked",integration_type:"sharepoint",setup_session_id:ao().EF.state.sessionId,from:ao().EF.state.analyticsFrom}}}),f(!0);const t=await(0,p().getSharepointConnectorDetails)({environment:b,spaceId:C});if(!t)return j().D6({label:A.formatMessage(_o.retryActionRequest),position:"bottom"}),void f(!1);if("completed"!==t.status&&"pending_selection"!==t.status)return j().D6({label:A.formatMessage(_o.alreadySyncing),position:"bottom"}),f(!1),void ao().EF.reset();const n=e.map((e=>e.url)),s=a.map((e=>e.email));await I().callApi({eventName:"setSharepointManualSelection",environment:b,data:{spaceId:C,sites:n,users:s,listType:m}}),await I().callApi({eventName:"startIngestion",environment:b,data:{connector:"sharepoint",spaceId:C,setupSessionId:ao().EF.state.sessionId}}),f(!1),j().D6({label:A.formatMessage(_o.syncingWithNewSyncControl),position:"bottom"}),(0,p().navigateToSharepointUniversalScreen)({currentScreen:"post_edit"})}),[C,b,e,a,m,A]),F=(0,s.useCallback)((()=>{C?(0,p().navigateToSharepointUniversalScreen)({currentScreen:"disconnect"}):ao().EF.reset()}),[C]),E=(0,s.useCallback)((t=>{const n=t.target.value,{extractedEmails:s,newInputValue:o}=(0,fo().Ct)(n),i=s.filter((e=>(0,fo().DT)(e.trim()))).map((e=>({id:Date.now().toString()+Math.random().toString(36).substr(2,9),email:e.trim()}))).filter((e=>!a.some((t=>t.email===e.email))));i.length>0?r((t=>{const n=[...t,...i];return f(!(n.length>0||e.length>0)),n})):f(!(a.length>0||e.length>0)),g(o)}),[a,e]),U=(0,s.useCallback)((t=>{if("Enter"===t.key){const t=c.trim();if(t&&(0,fo().DT)(t)&&!a.some((e=>e.email===t))){const n={id:Date.now().toString()+Math.random().toString(36).substr(2,9),email:t};r((t=>{const s=[...t,n];return f(!(s.length>0||e.length>0)),s})),g("")}}}),[c,a,e]),L=(0,s.useCallback)((t=>{r((n=>{const s=n.filter((e=>e.id!==t.id));return f(!(s.length>0||e.length>0)),s}))}),[e]),R=(0,s.useCallback)((()=>{r((t=>{const n=t.slice(0,-1);return f(!(n.length>0||e.length>0)),n}))}),[e]),K=(0,s.useCallback)((()=>{const t=c.trim();if(t&&(0,fo().DT)(t)&&!a.some((e=>e.email===t))){const n={id:Date.now().toString()+Math.random().toString(36).substr(2,9),email:t};r((t=>{const s=[...t,n];return f(!(s.length>0||e.length>0)),s})),g("")}}),[c,a,e]),H=(0,s.useCallback)((e=>{try{const t=new URL(e);return t.hostname.includes("sharepoint.com")&&t.pathname.includes("/sites/")}catch{return!1}}),[]),O=(0,s.useCallback)((n=>{const s=n.target.value;if(o(s),s.includes(",")||s.includes("\n")){const n=s.split(/[,\n]/).filter((e=>e.trim())).filter((e=>H(e.trim()))).map((e=>({id:Date.now().toString()+Math.random().toString(36).substr(2,9),url:e.trim()}))).filter((t=>!e.some((e=>e.url===t.url))));n.length>0?(t((e=>{const t=[...e,...n];return f(!(t.length>0||a.length>0)),t})),o("")):f(!(e.length>0||a.length>0))}}),[e,H,a]),G=(0,s.useCallback)((s=>{if("Enter"===s.key){const s=n.trim();if(s&&H(s)&&!e.some((e=>e.url===s))){const e={id:Date.now().toString()+Math.random().toString(36).substr(2,9),url:s};t((t=>{const n=[...t,e];return f(!(n.length>0||a.length>0)),n})),o("")}}}),[n,e,H,a]),q=(0,s.useCallback)((()=>{const s=n.trim();if(s&&H(s)&&!e.some((e=>e.url===s))){const e={id:Date.now().toString()+Math.random().toString(36).substr(2,9),url:s};t((t=>{const n=[...t,e];return f(!(n.length>0||a.length>0)),n})),o("")}}),[n,e,H,a]),J=(0,s.useCallback)((e=>{t((t=>{const n=t.filter((t=>t.id!==e.id));return f(!(n.length>0||a.length>0)),n}))}),[a]),V=(0,s.useCallback)((()=>{t((e=>{const t=e.slice(0,-1);return f(!(t.length>0||a.length>0)),t}))}),[a]),$=(0,s.useCallback)(((e,t=30)=>e.length<=t?e:e.substring(0,t-3)+"..."),[]),Q=(0,s.useCallback)(((e,t=30)=>{const n=e.indexOf("/sites/");if(-1===n)return e;const s=".../sites/"+e.substring(n+7).split("?")[0].split("/")[0];return s.length<=t?s:s.substring(0,t-3)+"..."}),[]);return(0,S.jsx)(te().a,{open:"manual_settings"===w,showCloseIcon:!0,onDismiss:T,render:()=>(0,S.jsxs)(P().wt,{style:_.wrapper,children:[(0,S.jsx)(re().b,{connectorType:"sharepoint",title:(0,S.jsx)(k().sA,{id:"universalSearch.sharepoint.manualSettings.subtitle",defaultMessage:"Manually configure sites"}),subtext:(0,S.jsx)(k().sA,{id:"universalSearch.sharepoint.manualSettings.description",defaultMessage:"Pick which Sites Notion AI can access"})}),y?(0,S.jsx)(P().wt,{style:_.content,children:(0,S.jsx)(oe().A,{style:{alignSelf:"center"}})}):(0,S.jsxs)(P().wt,{style:_.content,children:[(0,S.jsxs)("div",{style:_.section,children:[(0,S.jsxs)(P().Ye,{children:[(0,S.jsx)("div",{style:_.listTypeLabel,children:(0,S.jsxs)(P().Ye,{children:[(0,S.jsx)(k().sA,{id:"universalSearch.sharepoint.manualSettings.listType",defaultMessage:"List type"}),(0,S.jsx)(Vt().m,{renderTooltip:()=>(0,S.jsx)(k().sA,{id:"universalSearch.sharepoint.manualSettings.listType.tooltip",defaultMessage:"Select whether the entered inputs are allowed (Inclusion) or blocked (Exclusion)."}),render:e=>(0,S.jsx)("div",{...e,children:(0,S.jsx)(W().I,{icon:In().infoCircleIcon,style:_.infoCircleIcon})})})]})}),(0,S.jsx)(fs().D,{styleKey:"captionRegular",colorVariant:"secondary",style:_.browseSitesWrapper,children:(0,S.jsx)(_s()._,{href:"#",external:!0,onClick:()=>{(0,p().navigateToSharepointUniversalScreen)({currentScreen:"settings"})},children:(0,S.jsx)(k().sA,{id:"universalSearch.sharepoint.manualSettings.browseSites",defaultMessage:"Browse sites"})})})]}),(0,S.jsx)(P().Ye,{gap:8,children:(0,S.jsx)("div",{style:_.listTypeSection,children:(0,S.jsxs)(P().Ye,{gap:16,children:[(0,S.jsxs)("div",{style:_.radioOption,role:"radio",tabIndex:0,"aria-checked":"inclusion"===m,onClick:()=>h("inclusion"),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),h("inclusion"))},children:[(0,S.jsx)(Y().A,{isSelected:"inclusion"===m}),(0,S.jsx)("span",{style:_.listTypeInput,children:"Inclusion list"})]}),(0,S.jsxs)("div",{style:_.radioOption,role:"radio",tabIndex:0,"aria-checked":"exclusion"===m,onClick:()=>h("exclusion"),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),h("exclusion"))},children:[(0,S.jsx)(Y().A,{isSelected:"exclusion"===m}),(0,S.jsx)("span",{style:_.listTypeInput,children:"Exclusion list"})]})]})})})]}),(0,S.jsxs)("div",{style:_.section,children:[(0,S.jsx)("div",{style:_.listTypeLabel,children:(0,S.jsx)(k().sA,{id:"universalSearch.sharepoint.manualSettings.siteList",defaultMessage:"Site list"})}),(0,S.jsx)(ys().Ay,{focusInitial:!1,focus:!1,showBorder:!0,format:ys().le.Select,tokenWrapStyle:{gap:4},value:n,onChange:O,onSubmit:G,onBlur:q,onRemoveLastToken:V,type:"url",placeholder:A.formatMessage({id:"universalSearch.sharepoint.manualSettings.siteInput.placeholder",defaultMessage:"Enter SharePoint site URLs"}),tokens:e.map((e=>(0,S.jsx)(Vt().m,{renderTooltip:()=>e.url,render:t=>(0,S.jsx)("div",{...t,children:(0,S.jsx)(Ss().A,{value:Q(e.url,45),format:xs().NY.Medium,isSingle:!0,showRemoveButton:!0,onClickRemove:()=>J(e)})})},e.id))),focusAfterAnimation:!1,style:_.tokenInput})]}),(0,S.jsxs)("div",{style:_.section,children:[(0,S.jsx)("div",{style:_.listTypeLabel,children:(0,S.jsxs)(P().Ye,{children:[(0,S.jsx)(k().sA,{id:"universalSearch.sharepoint.manualSettings.userList",defaultMessage:"OneDrive user emails"}),(0,S.jsx)(Vt().m,{renderTooltip:()=>(0,S.jsx)(k().sA,{id:"universalSearch.sharepoint.manualSettings.siteList.tooltip",defaultMessage:"List of OneDrive user emails."}),render:e=>(0,S.jsx)("div",{...e,children:(0,S.jsx)(W().I,{icon:In().infoCircleIcon,style:_.infoCircleIcon})})})]})}),(0,S.jsx)(ys().Ay,{focusInitial:!1,focus:!1,showBorder:!0,format:ys().le.Select,tokenWrapStyle:{gap:4},value:c,onChange:E,onSubmit:U,onBlur:K,onRemoveLastToken:R,type:"email",placeholder:A.formatMessage({id:"universalSearch.sharepoint.manualSettings.userInput.placeholder",defaultMessage:"Enter OneDrive user emails"}),tokens:a.map((e=>(0,S.jsx)(Vt().m,{renderTooltip:()=>e.email,render:t=>(0,S.jsx)("div",{...t,children:(0,S.jsx)(Ss().A,{value:$(e.email,50),format:xs().NY.Medium,isSingle:!0,showRemoveButton:!0,onClickRemove:()=>L(e)})})},e.id))),focusAfterAnimation:!1,style:_.tokenInput})]})]}),(0,S.jsxs)(P().wt,{style:_.footer,children:[(0,S.jsx)(xo,{onSaveSettings:B,disabled:v}),(0,S.jsx)(bo,{onDisconnect:F,disabled:!1})]})]}),ariaLabel:A.formatMessage(_o.modalAriaLabel)})}const Io=(0,k().YK)({primedTextInput:{id:"aiConnectors.sharepoint.postEdit.primedTextInput",defaultMessage:"Search for content in SharePoint"}});function Ao(){const e=(0,k().tz)(),t=(0,d().K8)((()=>ao().EF.state.currentScreen),[]),n=(0,D().IS)((()=>({wrapper:{width:400},section:{marginTop:4,marginBottom:6},note:{fontWeight:z().Wy.regular,fontSize:14,lineHeight:"18px",width:330,marginInlineStart:8},sectionContainer:{padding:20,width:400,paddingTop:12},bottomSectionContainer:{padding:20,width:400,paddingTop:0}})),[]),o=(0,s.useCallback)((()=>{ao().EF.reset()}),[]),i=(0,s.useCallback)((()=>{ao().EF.reset()}),[]),a=[(0,S.jsx)(P().wt,{children:(0,S.jsx)(k().sA,{id:"assistantOverflowMenu.sharepointIngestion.postEdit.listpoint1",defaultMessage:"SharePoint content will be updated according to the new selection."},"note-1-message")},"note-1"),(0,S.jsx)(P().wt,{children:(0,S.jsx)(k().sA,{id:"assistantOverflowMenu.sharepointIngestion.postEdit.listpoint2",defaultMessage:"This can take up to 72 hours and AI answers will be unavailable until it’s complete"},"note-2-message")},"note-2")];return(0,S.jsx)(te().a,{showCloseIcon:!0,onDismiss:i,open:"post_edit"===t,render:()=>(0,S.jsxs)("div",{style:n.wrapper,children:[(0,S.jsx)(re().b,{connectorType:"sharepoint",title:(0,S.jsx)(k().sA,{id:"aiConnectors.sharepoint.postEdit.title",defaultMessage:"Update in Progress"}),subtext:(0,S.jsx)(k().sA,{id:"aiConnectors.sharepoint.postEdit.description",defaultMessage:"Here’s what you should know:"})}),(0,S.jsx)(P().wt,{style:n.sectionContainer,children:a.map(((e,t)=>(0,S.jsxs)(P().Ye,{gap:8,style:n.section,children:[(0,S.jsx)(Ue().A,{number:t+1}),(0,S.jsx)("div",{style:n.note,children:e})]},t)))}),(0,S.jsx)(P().wt,{style:n.bottomSectionContainer,children:(0,S.jsx)(ie().A,{colorPalette:"blue",onClick:o,children:(0,S.jsx)(k().sA,{id:"aiConnectors.sharepoint.postEdit.primaryButton",defaultMessage:"Done"})})})]}),ariaLabel:e.formatMessage(Io.primedTextInput)})}var Co=()=>n(755531),wo=()=>n(343733),To=()=>n(656633),Mo=()=>n(244851),Do=()=>n(404141),Po=()=>n(991249),Wo=()=>n(528093),Bo=()=>n(829148);function Fo(){const e=(0,l().v3)(),t=(0,Se().L)(),n=(0,_e().J)(t),o=null==t?void 0:t.id,i=e.currentUser.id,r=(0,Wo()._)({name:"ai_connectors",spaceId:o,userId:i}),c=(0,k().tz)(),u=(0,d().K8)((()=>Mo().O.state.open&&"slack_announcement"===Mo().O.state.modal),[]),g=(0,s.useCallback)((({source:t,upsell:n})=>{if(!a().default.state.sidebarSpaceViewStore||!o)return;const s=(0,To().vp)(e,o);Mo().O.setState({...Mo().O.state,open:!1}),"closeButton"!==t&&(n?s?(Do().Ay.setState({...Do().Ay.state,open:!0,openedFrom:"slack_universal_qna_announcement_modal",currentTab:"plans",defaultSubtab:void 0,highlightedSetting:void 0}),(0,wo().Q)(e,{from:"slack_universal_qna_announcement_modal"})):Po().K(e,{from:"slack_universal_qna_announcement_modal",upsell:n,spaceStore:(0,Co().S)()}):(0,p().navigateToAIConnectorOnboarding)({analyticsFrom:"slack_universal_qna_announcement_modal",connector:"slack"}))}),[e,o]);return r?(0,S.jsx)(te().a,{ariaLabel:c.formatMessage(be().vK.title),open:u,render:()=>(0,S.jsx)(Bo().Y,{messages:be().vK,aiConnectorsFeatureAvailability:r,onDismiss:g,calloutKey:"ai_slack_ai_connector_announcement",eventName:"ai_slack_universal_qna_announcement_modal_shown",learnMoreHref:(0,Le().x)("guides.aiConnectorSlack"),connector:"slack",showNarrowCta:n})}):null}var No=()=>n(792057),zo=()=>n(610083);const Eo=(0,k().YK)({userAccessNotAllowed:{id:"universalSearch.slackChannelSelection.errorModal.userAccessNotAllowed.title",defaultMessage:"User does not have access to Slack channels"},default:{id:"universalSearch.slackChannelSelection.errorModal.default.title",defaultMessage:"Oops! Something went wrong"}}),Uo=(0,k().YK)({userAccessNotAllowed:{id:"universalSearch.slackChannelSelection.errorModal.userAccessNotAllowed.subtext",defaultMessage:"User {email} does not have access to Slack channels"},default:{id:"universalSearch.slackChannelSelection.errorModal.default.subtext",defaultMessage:"Oops! Something went wrong"}});function Lo(e){const{title:t,subtext:n}=e;return(0,S.jsx)(R().b,{connector:"slack",screenName:"error",title:t,subtext:n,handleErrorDismissClick:()=>{zo().Rh.setState({...zo().Rh.state,errorCode:void 0})}})}const Ro=(0,k().YK)({searchForAChannel:{id:"universalQnA.slack.searchForAChannel",defaultMessage:"Search for a Channel"}});function Ko(){const e=(0,k().tz)(),[t,n]=s.useState(""),[a,r]=s.useState(!1),[u,g]=s.useState(!0),[m,h]=s.useState([]),v=(0,s.useRef)(!1),f=(0,l().v3)(),y=(0,i().r)(),x=(0,d().O$)(zo().Rh),_="error"===x.currentScreen,j=x.errorCode,A=(0,s.useCallback)((()=>{const e=c().default.getConfigKey("ingestion","slack");window.open(null==e?void 0:e.learnMoreUrl,"_blank")}),[]),C=(0,o().T)(),w=(0,un().$)(),T=(0,d().K8)((()=>null==w?void 0:w.getEmail()),[w]),F=(0,d().K8)((()=>yo().AssistantFeatureGateStore.isSlackV2AiConnectorEnabled()),[]),E=(0,s.useCallback)((()=>{v.current=!1,r(!1),n(""),g(!0),h([])}),[]),U=(0,s.useCallback)((async(e,t=0,n)=>{try{const c=await I().callApi({eventName:"getSlackPublicChannels",environment:f,data:{spaceId:e,cursor:n}});if("success"===c.type){h((e=>(0,vn().hS)([...e,...c.data.channels],(e=>e.id))));const t=c.data.cursor;zo().Rh.state.isEditing&&(g(!1),zo().Rh.setState({...zo().Rh.state,isEditing:!1})),t?U(e,0,t):r(!0)}else{if(t>=10){var s,o,i,a;if("SlackError"===(null==c||null===(s=c.body)||void 0===s?void 0:s.name)&&"slack_ai_connector_error"===(null==c||null===(o=c.body)||void 0===o||null===(o=o.clientData)||void 0===o?void 0:o.type)&&"USER_ACCESS_NOT_ALLOWED"===(null==c||null===(i=c.body)||void 0===i||null===(i=i.clientData)||void 0===i?void 0:i.code))zo().Rh.setState({...zo().Rh.state,currentScreen:"error",errorCode:null==c||null===(a=c.body)||void 0===a||null===(a=a.clientData)||void 0===a?void 0:a.code});else zo().Rh.setState({...zo().Rh.state,currentScreen:"error"});return}setTimeout((()=>{U(e,t+1,n)}),3e4)}}catch{if(t>=10)return;setTimeout((()=>{U(e,t+1,n)}),3e4)}}),[f]),L=(0,s.useCallback)((async()=>{zo().Rh.setState({...x,currentScreen:"confirmation"}),E(),y&&(await I().callApi({eventName:"ingestSlackPublicData",environment:f,data:{spaceId:y,selection:x.selection,setupSessionId:x.sessionId}}),(0,M().u)({environment:f,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"confirm_slack_public_data_ingestion",integration_type:"slack",setup_session_id:x.sessionId,from:x.analyticsFrom,connection_version:F?2:void 0}}}))}),[f,E,x,y,F]),R=(0,s.useCallback)((async()=>{var e;if(!y)return;const t=zo().Rh.state;if(!y||v.current||"data-selection"!==t.currentScreen)return;if(t.isEditing)return v.current=!0,void U(y);let n=!1;if("failed"!==(await(0,p().updateSlackQnAConnectionState)({environment:f,spaceId:y})).status){if(null!==(e=zo().Rh.state.connectedApps)&&void 0!==e&&e.includes("slack-admin")&&(n=!0),n){if(zo().Rh.state.isSlackGridAiConnectorEnabled){const e=await I().callApi({eventName:"getUrlForGridSetup",environment:f,data:{spaceId:y}});return void("success"===e.type&&zo().Rh.setState({...zo().Rh.state,currentScreen:"confirmation",gridSetupUrl:e.data.url}))}g(!1),v.current=!0,U(y)}}else zo().Rh.setState({...t,currentScreen:"alreadyConnected"})}),[y,v,U,f]),K=(0,s.useCallback)((({key:e,value:t})=>{const n=zo().Rh.state;"already_connected"!==t?"connected"===t&&R():zo().Rh.setState({...n,currentScreen:"alreadyConnected"})}),[R]);(0,s.useEffect)((()=>{if(!y||!C)return;const e=Ne().Ay.addListener((0,Ee().Vz)({spaceId:y,connectorType:"slack",userId:C,sessionId:x.sessionId}),void 0,K,void 0,f);return()=>{e&&Ne().Ay.removeListener(e,f)}}),[f,K,y,C,x.sessionId]),(0,s.useEffect)((()=>{"data-selection"===x.currentScreen&&(v.current=!1,R())}),[R,x.currentScreen]);const H=function(e,t){return(0,D().IS)((()=>({wrapper:{width:400,display:"flex",flexDirection:"column",minHeight:e?void 0:530},logoSection:{paddingTop:20,paddingInlineEnd:20,paddingBottom:9,paddingInlineStart:20,gap:8,justifyContent:"center",alignItems:"center",height:84},logos:{width:40,height:40},arrowLogo:{width:20,height:20,color:N().Tj.icon.secondary},titleWrapper:{width:"100%",justifyContent:"center",alignItems:"center",textAlign:"center"},title:{fontSize:17,fontWeight:z().Wy.medium,lineHeight:"22px",marginBottom:"9px"},subtext:{fontSize:12,lineHeight:"14.52px",color:N().Tj.text.secondary},footer:{position:"absolute",width:"100%",justifySelf:"flex-end",boxShadow:"0px 9px 24px 0px #0F0F0F33",paddingTop:16,paddingInlineEnd:20,paddingBottom:16,paddingInlineStart:20,gap:12,bottom:0},connectButton:{fontSize:14,fontWeight:z().Wy.semibold,width:360},searchBarWrapper:{justifyContent:"center"},searchBar:{width:360,padding:4},selectionContainer:{marginTop:18,marginBottom:e?24:0,width:"100%",height:"100%",justifyContent:"center",padding:"0px 20px 0px"},selection:{width:"100%"},waitingForConnection:{fontSize:12,lineHeight:"16px",color:N().Tj.text.secondary},waitingForConnectionWrapper:{gap:4},tryAgainWrapper:{marginTop:16,gap:4},tryAgainSection:{gap:4,alignItems:"center",marginBottom:16,color:N().Tj.text.secondary},tryAgainText:{fontSize:14},channelItem:{gap:4,alignItems:"center"},channelsText:{fontSize:12,lineHeight:"16px"},divider:{marginTop:5,marginBottom:5},alertIcon:{width:16,height:16},tryAgainButton:{fontSize:12,width:80},futureChannelsCheckboxWrapper:{gap:4,visibility:e?"hidden":"visible"},loadingChannelsWrapper:{alignItems:"center",gap:8,fontSize:12,color:N().Tj.text.secondary,marginTop:8},selectionWrapper:{overflowY:"scroll",maxHeight:t?170:124},loadMoreButtonWrapper:{fontSize:12,paddingTop:8,paddingBottom:4},loadMoreButtonhoveredStyle:{background:"none"},channelItemWrapper:{marginTop:12},workspaceAdministratorHeading:{fontSize:14,fontWeight:z().Wy.regular,color:N().Tj.text.primary},orderedList:{paddingInlineStart:18,fontSize:14,fontWeight:z().Wy.regular,color:N().Tj.text.secondary},waitingForConnectionNote:{paddingBottom:4},note:{fontWeight:z().Wy.regular,fontSize:14,lineHeight:"18px",width:330,marginInlineStart:8},noteHeading:{fontWeight:z().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:z().Wy.regular,color:N().Tj.text.secondary,fontSize:14,lineHeight:"18px"},learnMoreButton:{gap:4,alignItems:"center",fontSize:14,color:N().Tj.text.secondary,justifyContent:"center"},buttonContainer:{justifyContent:"center"},link:{color:N().Tj.text.secondary,textDecoration:"underline",cursor:"pointer"},loadingChannels:{color:N().Tj.text.secondary},loadingWrapper:{alignItems:"center",gap:4,justifyContent:"center"}})),[e,t])}(u,a),O=(0,s.useCallback)((e=>{const{selection:t}=x;return t.allSelected?!t.excludedChannels.includes(e):!!t.selectedChannels.includes(e)}),[x]),G=(0,s.useCallback)((()=>{const{selection:e}=x;return e.allSelected?!(e.excludedChannels.length>0)||"partial":e.selectedChannels.length>0&&"partial"}),[x]),Y=(0,s.useCallback)((()=>{const{selection:e}=x;return!!e.allSelected||(!!e.joinFutureChannels||e.selectedChannels.length>0)}),[x]),q=(0,s.useCallback)((()=>[(0,S.jsxs)(P().wt,{style:{gap:4},children:[(0,S.jsx)("div",{style:H.noteHeading,children:(0,S.jsx)(k().sA,{id:"universalSearch.slack.waitingForConnectionNoteHeading1",defaultMessage:"Slack should open automatically on a new tab."},"note1-1")}),(0,S.jsx)("div",{style:H.noteBody,children:(0,S.jsx)(k().sA,{id:"universalSearch.slack.waitingForConnectionNoteBody1",defaultMessage:"If it doesn’t, {ClickHereToRetry}",values:{ClickHereToRetry:(0,S.jsx)("a",{style:H.link,href:x.authUrl,target:"_blank",children:(0,S.jsx)(k().sA,{id:"universalSearch.slack.confirmModalNote1Retry",defaultMessage:"click here to retry"})})}},"note1-2")})]},"note-1"),(0,S.jsxs)(P().wt,{style:{gap:4},children:[(0,S.jsx)("div",{style:H.noteHeading,children:x.isSlackGridAiConnectorEnabled?(0,S.jsx)(k().sA,{id:"universalSearch.slack.grid.workspaceOrAdminHeading",defaultMessage:"If you are a Slack organization owner:"},"gridNote2-2"):(0,S.jsx)(k().sA,{id:"universalSearch.slack.workspaceAdminHeading",defaultMessage:"If you are a Slack workspace owner:"},"note2-2")}),(0,S.jsx)("div",{style:H.noteBody,children:(0,S.jsx)(k().sA,{id:"universalSearch.slack.workspaceAdminBody",defaultMessage:"Follow Slack’s instructions to connect. Return to this window, and the process will continue automatically."},"note2-3")}),(0,S.jsxs)(P().wt,{style:{marginTop:16,gap:4},children:[(0,S.jsx)("div",{style:H.noteHeading,children:(0,S.jsx)(k().sA,{id:"universalSearch.slack.notWorkspaceAdminHeading",defaultMessage:"If you are not authorized to install external apps:"},"note2-4")}),(0,S.jsx)("div",{style:H.noteBody,children:(0,S.jsx)(k().sA,{id:"universalSearch.slack.notWorkspaceAdminBody",defaultMessage:"Follow the instructions to request access to the connection. Then, revisit the connect menu to continue setup."},"note2-5")})]})]},"note-2")]),[x,H]),J=(0,s.useCallback)((()=>x.isEditing?(0,S.jsxs)(P().Ye,{style:H.loadingWrapper,children:[(0,S.jsx)(oe().k,{}),(0,S.jsx)("div",{style:H.loadingChannels,children:(0,S.jsx)(k().sA,{defaultMessage:"Loading channels",id:"slackChannelSelection.isLoadingChannels"})})]}):u?(0,S.jsxs)(P().wt,{style:H.waitingForConnectionWrapper,children:[q().map(((e,t)=>(0,S.jsxs)(P().Ye,{gap:8,style:{marginTop:4,marginBottom:6},children:[(0,S.jsx)(Ue().A,{number:t+1}),(0,S.jsx)("div",{style:H.note,children:e})]},t))),(0,S.jsx)(P().Ye,{style:H.buttonContainer,children:(0,S.jsx)(b().Ay,{style:{marginTop:16,width:120,borderRadius:6},onClick:A,children:(0,S.jsxs)(P().Ye,{style:H.learnMoreButton,children:[(0,S.jsx)(k().sA,{id:"universalSearch.slack.waitingForConnection.learnMore",defaultMessage:"Learn More"}),(0,S.jsx)(W().I,{icon:ze().arrowUpRightSquareSmallIcon,size:"sm"})]})})})]}):(0,S.jsxs)(P().wt,{children:[(0,S.jsxs)(P().Ye,{style:H.channelItem,children:[(0,S.jsx)(ne().S,{checked:G(),size:14,onClick:()=>{(0,M().u)({environment:f,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:x.selection.allSelected?"all_channels_deselected":"all_channels_selected",integration_type:"slack",setup_session_id:x.sessionId,from:x.analyticsFrom,connection_version:F?2:void 0}}}),zo().Rh.setState({...x,selection:{...x.selection,allSelected:!x.selection.allSelected,selectedChannels:[],excludedChannels:[]}})}}),(0,S.jsx)("div",{style:H.channelsText,children:(0,S.jsx)(k().sA,{id:"universalSearch.integration.slackIngestion.allPublicChannels",defaultMessage:"All public channels"})})]}),(0,S.jsx)(se().A,{style:H.divider,size:4}),(0,S.jsxs)(S.Fragment,{children:[a?(0,S.jsx)(S.Fragment,{}):(0,S.jsxs)(P().Ye,{style:H.loadingChannelsWrapper,children:[(0,S.jsx)(oe().k,{}),(0,S.jsxs)(P().wt,{children:[(0,S.jsx)("div",{children:(0,S.jsx)(k().sA,{id:"universalSearch.integration.slackIngestion.loadedXChannels",defaultMessage:"{channelsCount} channels loaded...",values:{channelsCount:m.length}})}),(0,S.jsx)("div",{children:(0,S.jsx)(k().sA,{id:"universalSearch.integration.slackIngestion.loading1000PerMinute",defaultMessage:"This can take up to one minute for every 1,000 public channels."})})]})]}),(0,S.jsx)(P().wt,{style:H.selectionWrapper,children:(t?m.filter((e=>e.name.includes(t))):m).map((e=>(0,S.jsxs)(P().Ye,{gap:8,style:H.channelItemWrapper,children:[(0,S.jsx)(ne().S,{checked:O(e.id),onClick:()=>{const{selection:t}=x;(0,M().u)({environment:f,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:O(e.id)?"specific_channel_deselected":"specific_channel_selected",integration_type:"slack",setup_session_id:x.sessionId,from:x.analyticsFrom,connection_version:F?2:void 0}}}),t.allSelected?t.excludedChannels.includes(e.id)?zo().Rh.setState({...x,selection:{...t,excludedChannels:t.excludedChannels.filter((t=>t!==e.id))}}):zo().Rh.setState({...x,selection:{...t,excludedChannels:t.excludedChannels.concat(e.id)}}):zo().Rh.setState({...x,selection:{...t,allSelected:!1,selectedChannels:t.selectedChannels.includes(e.id)?t.selectedChannels.filter((t=>t!==e.id)):t.selectedChannels.concat(e.id),excludedChannels:[]}})},size:14},`${e.id}-checkbox`),(0,S.jsx)("div",{style:H.channelsText,children:`# ${e.name}`},`${e.id}-label`)]},e.id)))})]})]})),[x,u,H,G,t,m,a,q,A,f,O,F]);return _?(0,S.jsx)(Lo,{title:"USER_ACCESS_NOT_ALLOWED"===j?(0,S.jsx)(S.Fragment,{children:e.formatMessage(Eo.userAccessNotAllowed)}):(0,S.jsx)(S.Fragment,{children:e.formatMessage(Eo.default)}),subtext:"USER_ACCESS_NOT_ALLOWED"===j?(0,S.jsx)(S.Fragment,{children:e.formatMessage(Uo.userAccessNotAllowed,{email:T})}):(0,S.jsx)(S.Fragment,{children:e.formatMessage(Uo.default)})}):(0,S.jsx)(te().a,{overlayZIndex:999,showCloseIcon:!0,onDismiss:async()=>{const{accept:e}=await No().Gh({message:(0,S.jsx)(k().sA,{id:"universalQna.slackChannelSelection.closeConfirm",defaultMessage:"Are you sure you want to dismiss? You will lose all the progress you made."}),acceptLabel:(0,S.jsx)(k().sA,{id:"universalQna.slackChannelSelection.dismiss",defaultMessage:"Dismiss"})});e&&(zo().Rh.setState({...zo().Rh.state,currentScreen:"none",isEditing:!1,selection:{allSelected:!0,selectedChannels:[],excludedChannels:[],joinFutureChannels:!0,selectedFeature:void 0}}),E(),(0,M().u)({environment:f,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drop_off_slack_data_selection",integration_type:"slack",setup_session_id:x.sessionId,from:x.analyticsFrom,connection_version:F?2:void 0}}}))},open:"data-selection"===x.currentScreen,render:()=>(0,S.jsxs)("div",{style:H.wrapper,children:[(0,S.jsx)(re().b,{connectorType:"slack",title:!u||x.isEditing?(0,S.jsx)(k().sA,{id:"universalQnA.slack.channelSelectionScreenTitle",defaultMessage:"Select channels to connect"}):(0,S.jsx)(k().sA,{id:"universalQnA.slack.channelSelectionWaitingScreenTitle",defaultMessage:"Follow instructions from Slack in your browser"}),subtext:!u||x.isEditing?(0,S.jsx)(k().sA,{id:"universalQnA.slack.channelSelectionScreenSubtext",defaultMessage:"Connecting more Slack channels will give you more relevant and useful Notion AI responses"}):(0,S.jsx)(S.Fragment,{})}),u?(0,S.jsx)(S.Fragment,{}):(0,S.jsx)(Ct().A,{capture:!0,allowEsc:!0,render:()=>(0,S.jsx)(Vt().m,{textWrap:!0,placement:"top",render:s=>(0,S.jsx)("div",{...s,children:(0,S.jsx)(P().Ye,{...s,style:H.searchBarWrapper,children:(0,S.jsx)(B().A,{id:"slackUniversalQnASearchBar",style:H.searchBar,placeholder:e.formatMessage(Ro.searchForAChannel),value:t,onChange:e=>{n(e.target.value),(0,M().u)({environment:f,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"filter_slack_channels",integration_type:"slack",setup_session_id:x.sessionId,from:x.analyticsFrom,connection_version:F?2:void 0}}})}},"slackUniversalQnASearchBar")})}),renderTooltip:()=>(0,S.jsx)("div",{style:{width:250},children:(0,S.jsx)(k().sA,{id:"universalSearch.slack.searchBarTooltip",defaultMessage:"All channels may not have been searched. Full search will be available once all channels are loaded."})}),disableTooltip:a})}),(0,S.jsx)(P().Ye,{style:H.selectionContainer,children:(0,S.jsx)(P().wt,{style:H.selection,children:J()})}),u?void 0:(0,S.jsxs)(P().wt,{style:H.footer,children:[(0,S.jsxs)(P().Ye,{style:H.futureChannelsCheckboxWrapper,children:[(0,S.jsx)(ne().S,{checked:x.selection.joinFutureChannels,size:14,onClick:()=>{(0,M().u)({environment:f,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:x.selection.joinFutureChannels?"dont_join_future_channels":"join_future_channels",integration_type:"slack",setup_session_id:x.sessionId,from:x.analyticsFrom,connection_version:F?2:void 0}}}),zo().Rh.setState({...x,selection:{...x.selection,joinFutureChannels:!x.selection.joinFutureChannels}})}}),(0,S.jsx)("div",{style:H.channelsText,children:(0,S.jsx)(k().sA,{id:"universalSearch.integration.slackIngestion.allFuturePublicChannels",defaultMessage:"Add public channels created in future"})})]}),(0,S.jsx)(ie().A,{colorPalette:"blue",style:H.connectButton,onClick:L,disabled:!Y(),children:(0,S.jsx)(k().sA,{id:"universalSearch.integration.connect",defaultMessage:"Connect"})})]})]})})}var Ho=()=>n(265060),Oo=()=>n(203717),Go=()=>n(529099),Yo=()=>n(398544),qo=()=>n(970236);const Jo=(0,k().YK)({readAndPostTitle:{id:"universalSearch.slack.readAndPostTitle",defaultMessage:"Read and post messages"},readAndPostSubtitle:{id:"universalSearch.slack.readAndPostSubtitle",defaultMessage:"Notion AI can read and post messages to Slack channels"},readOnlyTitle:{id:"universalSearch.slack.readOnlyTitle",defaultMessage:"Read messages only"},readOnlySubtitle:{id:"universalSearch.slack.readOnlySubtitle",defaultMessage:"Notion AI can read messages in Slack channels"},recommended:{id:"universalSearch.slack.recommended",defaultMessage:"Recommended"}});function Vo({selectedFeature:e,onSelect:t,showOnlyReadOption:n=!1}){const s=(0,D().IS)((()=>({container:{display:"flex",flexDirection:"column",gap:6},radioButton:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:10,height:"auto",paddingTop:12,paddingBottom:12,paddingInlineStart:12,paddingInlineEnd:14,borderRadius:8,border:void 0,boxShadow:`inset 0 0 0 1px ${N().Tj.border.secondary}`,font:"inherit",background:N().Tj.background.primary},radioButtonSelected:{boxShadow:`inset 0 0 0 1px ${N().Tj.blue.border.primary}`},radioContent:{display:"flex",flexDirection:"column",gap:2,flex:1,textAlign:"start",paddingInlineStart:2},radioTitle:{display:"flex",alignItems:"center",gap:4},radioSubtitle:{whiteSpace:"break-spaces",color:N().Tj.text.secondary}})),[]);return n?(0,S.jsx)("div",{style:s.container,children:(0,S.jsxs)("div",{style:{...s.radioButton,...s.radioButtonSelected},children:[(0,S.jsxs)("div",{style:s.radioContent,children:[(0,S.jsx)(O().A,{style:s.radioTitle,children:(0,S.jsx)(k().sA,{...Jo.readOnlyTitle})}),(0,S.jsx)(O().A,{isSmall:!0,isMultiline:!0,style:s.radioSubtitle,children:(0,S.jsx)(k().sA,{...Jo.readOnlySubtitle})})]}),(0,S.jsx)(Y().A,{isSelected:!0,radioButtonColor:"blue"})]})}):(0,S.jsxs)("div",{style:s.container,children:[(0,S.jsxs)(H().A,{size:"lg",onClick:()=>t("enterprise_search_and_custom_agent"),style:{...s.radioButton,..."enterprise_search_and_custom_agent"===e?s.radioButtonSelected:{}},children:[(0,S.jsxs)("div",{style:s.radioContent,children:[(0,S.jsxs)(O().A,{style:s.radioTitle,children:[(0,S.jsx)(k().sA,{...Jo.readAndPostTitle}),(0,S.jsx)(qo().E,{color:"blue",content:(0,S.jsx)(k().sA,{...Jo.recommended})})]}),(0,S.jsx)(O().A,{isSmall:!0,isMultiline:!0,style:s.radioSubtitle,children:(0,S.jsx)(k().sA,{...Jo.readAndPostSubtitle})})]}),(0,S.jsx)(Y().A,{isSelected:"enterprise_search_and_custom_agent"===e,radioButtonColor:"blue"})]}),(0,S.jsxs)(H().A,{size:"lg",onClick:()=>t("enterprise_search"),style:{...s.radioButton,..."enterprise_search"===e?s.radioButtonSelected:{}},children:[(0,S.jsxs)("div",{style:s.radioContent,children:[(0,S.jsx)(O().A,{style:s.radioTitle,children:(0,S.jsx)(k().sA,{...Jo.readOnlyTitle})}),(0,S.jsx)(O().A,{isSmall:!0,isMultiline:!0,style:s.radioSubtitle,children:(0,S.jsx)(k().sA,{...Jo.readOnlySubtitle})})]}),(0,S.jsx)(Y().A,{isSelected:"enterprise_search"===e,radioButtonColor:"blue"})]})]})}const $o=(0,k().YK)({title:{id:"slackConfigureAccess.title",defaultMessage:"Configure access"},subtitle:{id:"slackConfigureAccess.subtitle",defaultMessage:"Pick which type of access Notion AI will have"},permissionHeader:{id:"slackConfigureAccess.permissionHeader",defaultMessage:"Select permission"},privateChannelAccess:{id:"slackConfigureAccess.privateChannelAccess",defaultMessage:"Include access to private channels"},connectButton:{id:"slackConfigureAccess.connectButton",defaultMessage:"Connect"},slackOauthPopupTitle:{id:"slackConfigureAccess.slackOauthPopupTitle",defaultMessage:"Authenticate Slack"}});function Qo(){const e=(0,l().v3)(),t=(0,k().tz)(),n=(0,i().r)(),o=(0,D().IS)((()=>({wrapper:{width:477,backgroundColor:N().Tj.background.primary,display:"flex",flexDirection:"column",gap:24,paddingBottom:20},header:{paddingTop:40,paddingInlineEnd:20,paddingInlineStart:20,display:"flex",flexDirection:"column",alignItems:"center",gap:12},logoContainer:{display:"flex",alignItems:"center",justifyContent:"center",gap:9},logo:{width:40,height:40,borderRadius:8,display:"flex",alignItems:"center",justifyContent:"center"},arrowIcon:{color:N().Tj.text.tertiary},title:{fontSize:26,fontWeight:z().Wy.bold,color:N().Tj.text.primary,textAlign:"center",lineHeight:"32px",letterSpacing:.208},subtitle:{fontSize:14,fontWeight:z().Wy.regular,color:N().Tj.text.secondary,lineHeight:"20px",textAlign:"center"},content:{paddingInlineEnd:20,paddingInlineStart:20,display:"flex",flexDirection:"column",gap:12},section:{display:"flex",flexDirection:"column",gap:12},sectionHeader:{fontSize:12,fontWeight:z().Wy.medium,color:N().Tj.text.secondary,lineHeight:"16px"},checkboxRow:{display:"flex",alignItems:"flex-start",gap:8,cursor:"pointer"},checkboxWrapper:{paddingTop:2},checkboxLabel:{fontSize:14,fontWeight:z().Wy.regular,color:N().Tj.text.primary,lineHeight:"18px",cursor:"pointer"},footer:{paddingInlineEnd:20,paddingInlineStart:20},connectButton:{width:"100%"}})),[]),a=(0,d().K8)((()=>zo().Rh.state.currentScreen),[]),r=(0,d().K8)((()=>zo().Rh.state.sessionId),[]),c=(0,d().K8)((()=>zo().Rh.state.analyticsFrom),[]),u=(0,d().K8)((()=>h().zD.isSlackConnectorUnificationEnabled()),[]),p=(0,d().K8)((()=>zo().Rh.state.isSlackGridAiConnectorEnabled),[]),g=(0,d().K8)((()=>h().zD.isSlackPrivateSettingsEnabled()),[]),m=(0,d().K8)((()=>h().zD.isSlackV2AiConnectorEnabled()),[]),v=g&&!p,[f,y]=(0,s.useState)("enterprise_search_and_custom_agent"),[x,_]=(0,s.useState)(!1),[j,b]=(0,s.useState)(!1),I="configure-access"===a,A=(0,s.useCallback)((()=>{zo().Rh.reset(),(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drop_off_slack_configure_access_modal",integration_type:"slack",setup_session_id:r,from:c,connection_version:m?2:void 0}}})}),[e,r,c,m]),C=(0,s.useCallback)((async()=>{if(n){b(!0);try{const t="enterprise_search_and_custom_agent"===f,s=await e.api.callApi({eventName:"getSlackIngestionAuthorizeUrl",environment:e,data:{spaceId:n,isAdminAuth:!0,isWriteAccessApproved:u?t:void 0,isPrivateAccessEnabled:!v||x,isDesktopApp:e.device.isElectron,sessionId:r}});"success"===s.type&&(zo().Rh.setState({...zo().Rh.state,privateAccessEnabled:x,currentScreen:"data-selection",authUrl:s.data.url}),e.device.isElectron?(0,Fe().P)(s.data.url):await G().P(e,{width:800,height:600,url:s.data.url,titleMessage:$o.slackOauthPopupTitle}),(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"connect_slack_from_configure_access",integration_type:"slack",setup_session_id:r,from:c,connection_version:m?2:void 0}}}))}finally{b(!1)}}}),[e,n,f,x,r,c,u,v,m]);return(0,S.jsx)(te().a,{ariaLabel:t.formatMessage({id:"slackConfigureAccessModal.ariaLabel",defaultMessage:"Slack Configure Access Modal"}),showCloseIcon:!0,onDismiss:A,open:I,render:()=>(0,S.jsxs)("div",{style:o.wrapper,children:[(0,S.jsxs)("div",{style:o.header,children:[(0,S.jsxs)(P().Ye,{style:o.logoContainer,children:[(0,S.jsx)("div",{style:o.logo,children:(0,S.jsx)(Ho().Q,{iconGroup:Oo().G.slack,overrideSize:()=>32,variantName:"default"})}),(0,S.jsx)(W().I,{icon:Yo().arrowLeftRightSmallIcon,size:"sm",colorVariant:"tertiary"}),(0,S.jsx)("div",{style:o.logo,children:(0,S.jsx)(W().I,{icon:Go().aiFaceIcon,size:32})})]}),(0,S.jsxs)(P().wt,{style:{gap:4,alignItems:"center"},children:[(0,S.jsx)("div",{style:o.title,children:(0,S.jsx)(k().sA,{...$o.title})}),u?(0,S.jsx)("div",{style:o.subtitle,children:(0,S.jsx)(k().sA,{...$o.subtitle})}):void 0]})]}),(0,S.jsxs)("div",{style:o.content,children:[(0,S.jsxs)("div",{style:o.section,children:[(0,S.jsx)("div",{style:o.sectionHeader,children:(0,S.jsx)(k().sA,{...$o.permissionHeader})}),(0,S.jsx)(Vo,{selectedFeature:f,onSelect:y,showOnlyReadOption:!u})]}),v?(0,S.jsxs)("label",{style:o.checkboxRow,children:[(0,S.jsx)("div",{style:o.checkboxWrapper,children:(0,S.jsx)(ne().S,{checked:x,onClick:()=>_(!x),size:14})}),(0,S.jsx)("span",{style:o.checkboxLabel,children:(0,S.jsx)(k().sA,{...$o.privateChannelAccess})})]}):void 0]}),(0,S.jsx)("div",{style:o.footer,children:(0,S.jsxs)(ie().A,{colorPalette:"blue",style:o.connectButton,size:"lg",disabled:j,onClick:C,children:[(0,S.jsx)(k().sA,{...$o.connectButton}),(0,S.jsx)(W().I,{icon:ze().arrowUpRightSquareSmallIcon,size:"sm"})]})})]})})}const Xo=(0,k().YK)({instruction1:{id:"universalSearch.slack.grid.confirmModalNote1",defaultMessage:"Select your workspaces on your Slack Admin Dashboard"}}),Zo=(0,k().YK)({instruction1:{id:"universalSearch.slack.confirmModalNote1",defaultMessage:"Notion AI will join your selected channels in Slack"}});const ei=function(){const e=(0,l().v3)(),t=(0,d().O$)(zo().Rh),n=(0,s.useCallback)((()=>{const e=t.isSlackGridAiConnectorEnabled?Xo:Zo;return[(0,S.jsx)($e().L,{number:1,title:e.instruction1},"item1"),(0,S.jsx)($e().L,{number:2,title:Qe().D.defaultConnectionTime},"item2"),(0,S.jsx)($e().L,{number:3,title:{...{...Qe().D.defaultNotionAiWillBeAbleToAnswerQuestions,values:{appName:"Slack"}}}},"item3")]}),[t.isSlackGridAiConnectorEnabled]),o=(0,s.useCallback)((()=>{j().D6({label:(0,S.jsx)(k().sA,{id:"slackIngestionConfirmModal.ingestion.acknowledge",defaultMessage:"Started syncing from Slack. This can take up to 36 hours."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,S.jsx)(b().Ay,{onClick:j().N2,children:(0,S.jsx)(k().sA,{id:"slackIngestionConfirmModal.ingestion.startedMessageDismiss",defaultMessage:"Close"})})})}),[]),i=(0,s.useCallback)((()=>{if((0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:t.isSlackGridAiConnectorEnabled?"slack_grid_select_workspaces_clicked":"completion_screen_done",integration_type:"slack",setup_session_id:t.sessionId,from:t.analyticsFrom}}}),t.isSlackGridAiConnectorEnabled){const n=t.gridSetupUrl;if(!n)return;e.device.isElectron?(0,Fe().P)(n):window.open(n,"_blank")}else zo().Rh.setState({...t,isPublicSync:!0,inProgress:!0,currentScreen:"none",ingestionProgress:1}),o()}),[e,t,o]),a=(0,s.useCallback)((()=>{zo().Rh.reset(),(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"completion_screen_dismiss",integration_type:"slack",setup_session_id:t.sessionId,from:t.analyticsFrom}}})}),[e,t.analyticsFrom,t.sessionId]);return(0,s.useEffect)((()=>{"confirmation"===t.currentScreen&&(0,p().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:e,connector:"slack",moment:"finished"})}),[e,t.currentScreen]),(0,S.jsx)(Qe().v,{open:"confirmation"===t.currentScreen,connectorType:"slack",notes:n(),onDismiss:a,title:t.isSlackGridAiConnectorEnabled?(0,S.jsx)(k().sA,{id:"universalSearch.slack.heresWhatToDoNext",defaultMessage:"Here’s what to do next"}):void 0,onPrimaryButtonClick:i,primaryButtonText:t.isSlackGridAiConnectorEnabled?(0,S.jsx)(k().sA,{id:"universalSearch.integration.girdConfirmIngestion",defaultMessage:"Select Slack workspaces"}):void 0})};var ti=()=>n(250910),ni=()=>n(546926),si=()=>n(287188),oi=()=>n(890492),ii=()=>n(81068),ai=()=>n(663639),ri=()=>n(736847),ci=()=>n(324254),li=()=>n(175882),di=()=>n(399613),ui=()=>n(655600),pi=()=>n(751699);const gi=(0,k().YK)({title:{id:"slackSettingsDetail.title",defaultMessage:"Slack"},description:{id:"slackSettingsDetail.description",defaultMessage:"Connect your Slack workspace to your Notion workspace so that you can find quick answers in Notion using information from your Slack conversations"},enterpriseSearchHeader:{id:"slackSettingsDetail.enterpriseSearch.header",defaultMessage:"Enterprise Search"},publicChannelsLabel:{id:"slackSettingsDetail.publicChannels.label",defaultMessage:"Public channels"},publicChannelsDescription:{id:"slackSettingsDetail.publicChannels.description",defaultMessage:"Allow Enterprise Search to look across public channels"},selectChannels:{id:"slackSettingsDetail.selectChannels",defaultMessage:"Select channels"},aiAgentsHeader:{id:"slackSettingsDetail.aiAgents.header",defaultMessage:"AI Agents"},configureAgentAccessLabel:{id:"slackSettingsDetail.configureAgentAccess.label",defaultMessage:"Configure agent access"},configureAgentAccessDescription:{id:"slackSettingsDetail.configureAgentAccess.description",defaultMessage:"Select the level of access agents have across Slack"},readAndPostMessages:{id:"slackSettingsDetail.readAndPostMessages",defaultMessage:"Read and post messages"},readAndPostMessagesDescription:{id:"slackSettingsDetail.readAndPostMessagesDescription",defaultMessage:"Notion AI can read and post messages to Slack channels"},readMessagesOnly:{id:"slackSettingsDetail.readMessagesOnly",defaultMessage:"Read messages only"},readMessagesOnlyDescription:{id:"slackSettingsDetail.readMessagesOnlyDescription",defaultMessage:"Notion AI can read messages in Slack channels"},selectAccess:{id:"slackSettingsDetail.selectAccess",defaultMessage:"Select access"},permissionHeader:{id:"slackSettingsDetail.permission.header",defaultMessage:"Permission"},enablePrivateChannelAccess:{id:"slackSettingsDetail.enablePrivateChannelAccess",defaultMessage:"Enable private channel access"},privateChannelAccessDescription:{id:"slackSettingsDetail.privateChannelAccessDescription",defaultMessage:"Allow Enterprise Search and Agents to look across private channels"},privateAccessEnabledTooltip:{id:"slackSettingsDetail.privateAccessEnabledTooltip",defaultMessage:"To disable private channel access you must disconnect Slack"},enablePrivateAccessConfirmTitle:{id:"slackSettingsDetail.enablePrivateAccessConfirm.title",defaultMessage:"Are you sure you want to enable private channel access?"},enablePrivateAccessConfirmDescription:{id:"slackSettingsDetail.enablePrivateAccessConfirm.description",defaultMessage:"Once enabled, Slack must be disconnected to disable this setting."},enablePrivateAccessConfirmButton:{id:"slackSettingsDetail.enablePrivateAccessConfirm.button",defaultMessage:"Enable private channel access"},reauthenticateBanner:{id:"slackSettingsDetail.reauthenticateBanner",defaultMessage:"Re-authenticate to enable private channel access"},authenticate:{id:"slackSettingsDetail.authenticate",defaultMessage:"Authenticate"},publicChannelsDisabledTooltip:{id:"slackSettingsDetail.publicChannelsDisabledTooltip",defaultMessage:"Public channels are always enabled when Slack is connected"},dangerZoneHeader:{id:"slackSettingsDetail.dangerZone.header",defaultMessage:"Danger zone"},removeAndDisconnect:{id:"slackSettingsDetail.removeAndDisconnect",defaultMessage:"Remove and disconnect"},removeAndDisconnectDescription:{id:"slackSettingsDetail.removeAndDisconnectDescription",defaultMessage:"Remove Slack’s Notion AI integration"},disconnectSlack:{id:"slackSettingsDetail.disconnectSlack",defaultMessage:"Disconnect Slack"}});function mi(){const e=(0,l().v3)(),t=(0,k().tz)(),n=(0,i().r)(),o=(0,D().IS)((()=>({wrapper:{width:560,maxWidth:"100%",maxHeight:"90vh",overflow:"auto"},content:{padding:"0 24px"},logoContainer:{width:60,height:60,borderRadius:12,border:`1px solid ${N().Tj.border.secondary}`,boxShadow:"0 1px 4px rgba(0, 0, 0, 0.08)",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:16},title:{fontSize:20,fontWeight:z().Wy.semibold,color:N().Tj.text.primary,marginBottom:8},description:{fontSize:14,fontWeight:z().Wy.regular,color:N().Tj.text.secondary,lineHeight:1.5},section:{marginBottom:24},sectionHeader:{fontSize:15,fontWeight:z().Wy.semibold,color:N().Tj.text.primary,marginBottom:8},settingRow:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 0",gap:16},settingLabelContainer:{display:"flex",flexDirection:"column",gap:2,flex:1,minWidth:0},settingLabel:{fontSize:14,fontWeight:z().Wy.medium,color:N().Tj.text.primary},settingDescription:{fontSize:12,color:N().Tj.text.secondary,lineHeight:1.4},selectChannelsLink:{fontSize:14,color:N().Tj.blue.text.accentPrimary},dropdownButton:{height:32,paddingInlineStart:12,paddingInlineEnd:8,borderRadius:6,border:`1px solid ${N().Tj.border.primary}`,gap:4,display:"flex",alignItems:"center",cursor:"pointer",backgroundColor:"transparent"},dropdownButtonText:{fontSize:14,color:N().Tj.text.primary},menuSectionHeader:{fontSize:12,fontWeight:z().Wy.medium,color:N().Tj.text.secondary,padding:"8px 14px 4px"},menuItem:{paddingTop:8,paddingBottom:8},menuItemLabel:{fontSize:14,fontWeight:z().Wy.medium,color:N().Tj.text.primary},menuItemCaption:{fontSize:12,color:N().Tj.text.secondary,marginTop:2},reauthBanner:{display:"flex",alignItems:"center",justifyContent:"space-between",backgroundColor:N().Tj.yellow.background.secondary,borderRadius:8,padding:"10px 12px",marginTop:12},reauthBannerContent:{display:"flex",alignItems:"center",gap:8},reauthBannerText:{fontSize:14,color:N().Tj.yellow.text.accentPrimary},dangerZoneRow:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 0"}})),[]),a=(0,d().K8)((()=>zo().Rh.state.writeAccessApproved??!1),[]),r=(0,d().K8)((()=>zo().Rh.state.privateAccessEnabled??!0),[]),c=(0,d().K8)((()=>zo().Rh.state.currentScreen),[]),u=(0,d().K8)((()=>zo().Rh.state.sessionId),[]),p=(0,d().K8)((()=>zo().Rh.state.analyticsFrom),[]),g=(0,d().K8)((()=>(0,ui().kv)()),[]),m=void 0!==g,v=(0,d().K8)((()=>h().zD.isSlackConnectorUnificationEnabled()),[]),[f,y]=(0,s.useState)(a?"enterprise_search_and_custom_agent":"enterprise_search"),[x,_]=(0,s.useState)(!1),[j,I]=(0,s.useState)(r),A="private-settings"===c;(0,s.useEffect)((()=>{A&&(y(a?"enterprise_search_and_custom_agent":"enterprise_search"),I(r))}),[A,a,r]),(0,s.useEffect)((()=>{if(!A||!n)return;const t=async()=>{try{const t=await e.api.callApi({eventName:"getIngestionOptions",environment:e,data:{spaceId:n}});if("success"===t.type){const e=t.data.writeAccessApproved??!1;y(e?"enterprise_search_and_custom_agent":"enterprise_search");const n=t.data.privateAccessEnabled??!0;zo().Rh.setState({...zo().Rh.state,writeAccessApproved:e,privateAccessEnabled:n}),I(n)}}catch{}},s=()=>{"visible"===document.visibilityState&&t()},o=()=>{t()};return document.addEventListener("visibilitychange",s),window.addEventListener("focus",o),()=>{document.removeEventListener("visibilitychange",s),window.removeEventListener("focus",o)}}),[A,n,e]);const C=(0,s.useCallback)((()=>{zo().Rh.setState({...zo().Rh.state,currentScreen:"none"})}),[]),[w,T]=(0,s.useState)(!1),B=(0,s.useCallback)((async()=>{if(n){T(!0);try{const t=await e.api.callApi({eventName:"getIngestionOptions",environment:e,data:{spaceId:n}});"success"===t.type&&((0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"edit_channels",integration_type:"slack",setup_session_id:u,from:p}}}),zo().Rh.setState({...zo().Rh.state,currentScreen:"data-selection",selection:{...zo().Rh.state.selection,allSelected:t.data.selection.allSelected,selectedChannels:t.data.selection.selectedChannels,excludedChannels:t.data.selection.excludedChannels,joinFutureChannels:t.data.selection.joinFutureChannels},isEditing:!0}))}finally{T(!1)}}}),[e,n,u,p]),F=(0,s.useCallback)((()=>{(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"slack_settings_detail_authenticate",integration_type:"slack",setup_session_id:u,from:p}}}),n&&("slack_v2_user_connection"===g?pi().JR({environment:e,spaceId:n}):"slack_re_auth"===g&&(0,di().t)({connector:"slack",environment:e,spaceId:n,analyticsProperties:{analyticsFrom:p,buttonName:g}}))}),[e,u,p,g,n]),E=(0,s.useCallback)((()=>{zo().Rh.setState({...zo().Rh.state,currentScreen:"settings-disconnect"})}),[]),U=(0,s.useCallback)((async t=>{if(!n||t===f)return;_(!0);const s="enterprise_search_and_custom_agent"===t;try{if(s){await pi().FM({environment:e,spaceId:n,isWriteAccessApproved:s,isPrivateAccessEnabled:j});const t=await e.api.callApi({eventName:"getIngestionOptions",environment:e,data:{spaceId:n}});if("success"===t.type){const e=t.data.writeAccessApproved??!1;y(e?"enterprise_search_and_custom_agent":"enterprise_search"),zo().Rh.setState({...zo().Rh.state,writeAccessApproved:e})}}else{"success"===(await e.api.callApi({eventName:"updateSlackWriteAccess",environment:e,data:{spaceId:n,writeAccessApproved:s}})).type&&(y(t),zo().Rh.setState({...zo().Rh.state,writeAccessApproved:s}),(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"save_write_access_disable",integration_type:"slack",setup_session_id:u,from:p}}}))}}finally{_(!1)}}),[e,n,f,u,p,j]),L=(0,s.useCallback)((async()=>{if(j||!n)return;const{accept:s}=await No().Gh({message:t.formatMessage(gi.enablePrivateAccessConfirmTitle),description:t.formatMessage(gi.enablePrivateAccessConfirmDescription),acceptLabel:t.formatMessage(gi.enablePrivateAccessConfirmButton)});s&&((0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"enable_private_channel_access_confirm",integration_type:"slack",setup_session_id:u,from:p}}}),await pi().FM({environment:e,spaceId:n,isWriteAccessApproved:"enterprise_search_and_custom_agent"===f,isPrivateAccessEnabled:!0}))}),[j,n,t,e,u,p,f]);return(0,S.jsx)(te().a,{ariaLabel:t.formatMessage({id:"slackSettingsDetailModal.ariaLabel",defaultMessage:"Slack Settings Modal"}),showCloseIcon:!0,onDismiss:C,open:A,render:()=>(0,S.jsxs)("div",{style:o.wrapper,children:[(0,S.jsx)("div",{style:o.content,children:(0,S.jsxs)(P().wt,{style:{paddingTop:20},children:[(0,S.jsx)("div",{style:o.logoContainer,children:(0,S.jsx)(Ho().Q,{iconGroup:Oo().G.slack,overrideSize:()=>40,variantName:"default"})}),(0,S.jsx)("div",{style:o.title,children:(0,S.jsx)(k().sA,{...gi.title})}),(0,S.jsx)("div",{style:o.description,children:(0,S.jsx)(k().sA,{...gi.description})})]})}),(0,S.jsxs)("div",{style:o.content,children:[(0,S.jsxs)("div",{style:{...o.section,marginTop:24},children:[(0,S.jsx)("div",{style:o.sectionHeader,children:(0,S.jsx)(k().sA,{...gi.enterpriseSearchHeader})}),(0,S.jsxs)("div",{style:o.settingRow,children:[(0,S.jsxs)("div",{style:o.settingLabelContainer,children:[(0,S.jsx)("div",{style:o.settingLabel,children:(0,S.jsx)(k().sA,{...gi.publicChannelsLabel})}),(0,S.jsx)("div",{style:o.settingDescription,children:(0,S.jsx)(k().sA,{...gi.publicChannelsDescription})})]}),(0,S.jsxs)(P().Ye,{style:{alignItems:"center",gap:12},children:[w?(0,S.jsx)(oe().k,{size:"sm"}):(0,S.jsx)(ss().p,{style:o.selectChannelsLink,onClick:B,children:(0,S.jsx)(k().sA,{...gi.selectChannels})}),(0,S.jsx)(Vt().m,{renderTooltip:()=>(0,S.jsx)(k().sA,{...gi.publicChannelsDisabledTooltip}),render:e=>(0,S.jsx)("div",{...e,children:(0,S.jsx)(si().A,{on:!0,disabled:!0})})})]})]})]}),v?(0,S.jsxs)("div",{style:o.section,children:[(0,S.jsx)("div",{style:o.sectionHeader,children:(0,S.jsx)(k().sA,{...gi.aiAgentsHeader})}),(0,S.jsxs)("div",{style:o.settingRow,children:[(0,S.jsxs)("div",{style:o.settingLabelContainer,children:[(0,S.jsx)("div",{style:o.settingLabel,children:(0,S.jsx)(k().sA,{...gi.configureAgentAccessLabel})}),(0,S.jsx)("div",{style:o.settingDescription,children:(0,S.jsx)(k().sA,{...gi.configureAgentAccessDescription})})]}),x?(0,S.jsx)(oe().k,{size:"sm"}):(0,S.jsx)(ti().A,{popupType:ti().z.Popup,placementToOrigin:"bottom",alignmentToOrigin:"end",renderOrigin:e=>(0,S.jsxs)(b().Ay,{...e,style:o.dropdownButton,children:[(0,S.jsx)("span",{style:o.dropdownButtonText,children:"enterprise_search_and_custom_agent"===f?t.formatMessage(gi.readAndPostMessages):t.formatMessage(gi.readMessagesOnly)}),(0,S.jsx)(W().I,{icon:ci().arrowChevronSingleDownSmallIcon,size:"sm"})]}),render:e=>{const t=[{key:"enterprise_search_and_custom_agent",action:()=>{e.close(),U("enterprise_search_and_custom_agent")},render:e=>(0,S.jsx)(ii().A,{...e,style:o.menuItem,title:(0,S.jsxs)("div",{children:[(0,S.jsx)("div",{style:o.menuItemLabel,children:(0,S.jsx)(k().sA,{...gi.readAndPostMessages})}),(0,S.jsx)("div",{style:o.menuItemCaption,children:(0,S.jsx)(k().sA,{...gi.readAndPostMessagesDescription})})]})})},{key:"enterprise_search",action:()=>{e.close(),U("enterprise_search")},render:e=>(0,S.jsx)(ii().A,{...e,style:o.menuItem,title:(0,S.jsxs)("div",{children:[(0,S.jsx)("div",{style:o.menuItemLabel,children:(0,S.jsx)(k().sA,{...gi.readMessagesOnly})}),(0,S.jsx)("div",{style:o.menuItemCaption,children:(0,S.jsx)(k().sA,{...gi.readMessagesOnlyDescription})})]})})}];return(0,S.jsxs)(oi().A,{menuType:ni().gu.Popup,minWidth:280,children:[(0,S.jsx)("div",{style:o.menuSectionHeader,children:(0,S.jsx)(k().sA,{...gi.selectAccess})}),(0,S.jsx)(ai().A,{type:ai().O.Vertical,initialFocus:void 0,sections:[{key:"access-options",render:e=>(0,S.jsx)(ri().A,{...e}),items:t}]})]})}})]})]}):void 0,(0,S.jsxs)("div",{style:o.section,children:[(0,S.jsx)("div",{style:o.sectionHeader,children:(0,S.jsx)(k().sA,{...gi.permissionHeader})}),(0,S.jsxs)("div",{style:o.settingRow,children:[(0,S.jsxs)("div",{style:o.settingLabelContainer,children:[(0,S.jsx)("div",{style:o.settingLabel,children:(0,S.jsx)(k().sA,{...gi.enablePrivateChannelAccess})}),(0,S.jsx)("div",{style:o.settingDescription,children:(0,S.jsx)(k().sA,{...gi.privateChannelAccessDescription})})]}),j?(0,S.jsx)(Vt().m,{renderTooltip:()=>(0,S.jsx)(k().sA,{...gi.privateAccessEnabledTooltip}),render:e=>(0,S.jsx)("div",{...e,children:(0,S.jsx)(si().A,{on:!0,disabled:!0})})}):(0,S.jsx)(si().A,{on:!1,onClick:L})]}),m?(0,S.jsxs)("div",{style:o.reauthBanner,children:[(0,S.jsxs)("div",{style:o.reauthBannerContent,children:[(0,S.jsx)(W().I,{icon:li().exclamationMarkTriangleSmallIcon,colorPalette:"yellow",colorVariant:"accentPrimary",size:"sm"}),(0,S.jsx)("span",{style:o.reauthBannerText,children:(0,S.jsx)(k().sA,{...gi.reauthenticateBanner})})]}),(0,S.jsx)(H().A,{size:"sm",colorPalette:"yellow",onClick:F,children:(0,S.jsx)(k().sA,{...gi.authenticate})})]}):void 0]}),(0,S.jsxs)("div",{style:{...o.section,marginBottom:20},children:[(0,S.jsx)("div",{style:o.sectionHeader,children:(0,S.jsx)(k().sA,{...gi.dangerZoneHeader})}),(0,S.jsxs)("div",{style:o.dangerZoneRow,children:[(0,S.jsxs)("div",{style:o.settingLabelContainer,children:[(0,S.jsx)("div",{style:o.settingLabel,children:(0,S.jsx)(k().sA,{...gi.removeAndDisconnect})}),(0,S.jsx)("div",{style:o.settingDescription,children:(0,S.jsx)(k().sA,{...gi.removeAndDisconnectDescription})})]}),(0,S.jsx)(Je().E,{size:"md",colorPalette:"red",onClick:E,children:(0,S.jsx)(k().sA,{...gi.disconnectSlack})})]})]})]})]})})}const hi=function(){const e=(0,d().O$)(zo().Rh),[t,n]=(0,s.useState)(!1),o=(0,l().v3)(),a=(0,i().r)(),[r,p]=(0,s.useState)(!1),[g,m]=(0,s.useState)(!0),[v,f]=(0,s.useState)([]),[y,x]=(0,s.useState)(!1);(0,s.useEffect)((()=>{"settings-disconnect"===e.currentScreen&&n(!0)}),[e.currentScreen]),(0,u().Yb)((async()=>{const t="settings"===e.currentScreen||"settings-disconnect"===e.currentScreen;if(!a||!t)return;m(!0);const n=await I().callApi({eventName:"getIngestedSlackChannels",environment:o,data:{spaceId:a}});"success"===n.type&&f(n.data.channels),m(!1)}),[o,e.currentScreen,a]);const _=(0,s.useCallback)((()=>{const e=c().default.getConfigKey("ingestion","slack"),t=null==e?void 0:e.learnMoreUrl;t&&window.open(t,"_blank")}),[]),A=(0,s.useCallback)((()=>{zo().Rh.setState({...zo().Rh.state,currentScreen:"none"})}),[]),C=(0,s.useCallback)((()=>{n(!1)}),[]),w=(0,s.useCallback)((async()=>{if(!a)return;p(!0);"success"===(await I().callApi({eventName:"disconnectSlackIngestion",environment:o,data:{spaceId:a,disconnectForWorkspace:!0,disconnectReason:"admin_disconnect"}})).type?(zo().Rh.setState({...zo().Rh.state,isDisconnecting:!0}),j().D6({label:(0,S.jsx)(k().sA,{id:"slackIngestionConfirmModal.ingestion.acknowledgeDisconnect",defaultMessage:"Started disconnecting Slack. This can take up to 3 hours."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,S.jsx)(b().Ay,{onClick:j().N2,children:(0,S.jsx)(k().sA,{id:"slackIngestionConfirmModal.ingestion.dismissAcknowledgeDisconnect",defaultMessage:"Close"})})}),n(!1),zo().Rh.reset()):(p(!1),j().D6({label:(0,S.jsx)(k().sA,{id:"slackIngestionConfirmModal.ingestion.disconnectError",defaultMessage:"Failed to disconnect Slack. Please try again later."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,S.jsx)(b().Ay,{onClick:j().N2,children:(0,S.jsx)(k().sA,{id:"slackIngestionConfirmModal.ingestion.closeSnackbarError",defaultMessage:"Close"})})})),p(!1)}),[o,a]),T=(0,D().IS)((()=>({wrapper:{width:400},channelDetailsContainer:{width:352,fontSize:14,fontWeight:z().Wy.regular,color:N().Tj.text.secondary},channelDetailsSubtitle:{textAlign:"center",marginBottom:"16px"},channelDetailsWrapper:{justifyContent:"center",paddingTop:"12px",paddingBottom:"12px"},channelNamesContainer:{gap:2,color:N().Tj.text.primary},footer:{justifyContent:"center",alignItems:"center",width:"100%",paddingTop:20,paddingInlineEnd:20,paddingBottom:20,paddingInlineStart:20,gap:8},disconnectButton:{fontSize:14,fontWeight:z().Wy.medium,width:"100%"},moreChannelsContainer:{paddingTop:8},learnMoreButton:{fontSize:14,fontWeight:z().Wy.semibold,borderRadius:"4px",width:"100%"},learnMoreText:{fontWeight:z().Wy.medium,fontSize:12,gap:5,justifyContent:"center",alignItems:"center",paddingTop:4,paddingInlineEnd:8,paddingBottom:4,paddingInlineStart:8,color:`${N().Tj.text.secondary}`},confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:z().Wy.semibold,color:N().Tj.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:14,fontWeight:z().Wy.regular,color:N().Tj.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:14,fontWeight:z().Wy.regular,color:N().Tj.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:14,fontWeight:z().Wy.regular,width:"100%",textAlign:"center",paddingTop:4,paddingInlineEnd:0,paddingBottom:4,paddingInlineStart:0},confirmDisconnectButton:{fontSize:14,fontWeight:z().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},spinner:{paddingTop:20,paddingBottom:40,justifyContent:"center",alignItems:"center"},editChannelsButton:{fontSize:14,fontWeight:z().Wy.medium,width:"100%"}})),[]);return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(te().a,{showCloseIcon:!0,onDismiss:C,open:t,render:()=>(0,S.jsx)("div",{style:T.confirmWrapper,children:(0,S.jsxs)("div",{style:T.confirmContainer,children:[(0,S.jsx)("div",{style:T.confirmModalTitle,children:(0,S.jsx)(k().sA,{id:"slackIngestionSettings.confirmation.title",defaultMessage:"Are you sure?"})}),(0,S.jsx)("div",{style:T.confirmModalSubTitle,children:(0,S.jsx)(k().sA,{id:"slackIngestionSettings.confirmation.subTitle",defaultMessage:"Your Slack data will be permanently deleted from Notion."})}),(0,S.jsx)("div",{style:T.confirmModalDescription,children:(0,S.jsx)(k().sA,{id:"slackIngestionSettings.confirmation.description",defaultMessage:"This process can take up to 3 hours, and you’ll only be able to reconnect after disconnecting is complete."})}),(0,S.jsxs)(P().wt,{style:T.confirmModalActionButtons,children:[(0,S.jsx)(ie().A,{colorPalette:"red",style:T.confirmDisconnectButton,disabled:r,onClick:w,children:(0,S.jsx)(k().sA,{id:"slackIngestion.confirmDisconnectModal.confirmDisconnect",defaultMessage:"Disconnect for everyone"})}),(0,S.jsx)(b().Ay,{style:T.goBackButton,onClick:C,children:(0,S.jsx)(k().sA,{id:"slackIngestion.confirmDisconnectModal.goBack",defaultMessage:"Go back"})})]})]})})}),(0,S.jsx)(te().a,{showCloseIcon:!0,onDismiss:A,open:"settings"===e.currentScreen,render:()=>(0,S.jsxs)("div",{style:T.wrapper,children:[(0,S.jsx)(re().b,{connectorType:"slack",title:(0,S.jsx)(k().sA,{id:"universalSearch.slack.settingsModalTitle",defaultMessage:"Slack is connected to Notion AI"}),subtext:g||e.isSlackGridAiConnectorEnabled?void 0:(0,S.jsx)(k().sA,{id:"universalSearch.slackIngestion.settingsModal.canAnswerFrom",defaultMessage:"Notion AI can answer questions about {channelsCount} public channels in Slack.",values:{channelsCount:v.length}})}),g?(0,S.jsx)(P().Ye,{style:T.spinner,children:(0,S.jsx)(oe().k,{})}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(P().Ye,{style:T.channelDetailsWrapper,children:e.isSlackGridAiConnectorEnabled?(0,S.jsx)(P().wt,{style:T.channelDetailsContainer,children:(0,S.jsx)(k().sA,{id:"slackSettings.grid.note",defaultMessage:"This Notion workspace is connected to Slack Enterprise Grid. Settings can be only configured in the Slack Admin Dashboard."})}):(0,S.jsxs)(P().wt,{style:T.channelDetailsContainer,children:[(0,S.jsx)(P().wt,{style:T.channelNamesContainer,children:v.slice(0,4).map((e=>(0,S.jsx)("div",{children:`# ${e}`},e)))}),v.length-4>0?(0,S.jsx)(P().Ye,{style:T.moreChannelsContainer,children:(0,S.jsx)(k().sA,{id:"universalSearch.slackIngestion.settingsModal.moreChannels",defaultMessage:"{moreChannelsCount} more",values:{moreChannelsCount:v.length-4}})}):(0,S.jsx)(S.Fragment,{})]})}),(0,S.jsxs)(P().wt,{style:T.footer,children:[(0,S.jsx)(H().A,{size:"lg",disabled:y,style:T.editChannelsButton,onClick:async()=>{if(!a)return;if(e.isSlackGridAiConnectorEnabled){x(!0);const e=await I().callApi({eventName:"getUrlForGridSetup",environment:o,data:{spaceId:a}});return"success"===e.type&&(o.device.isElectron?(0,Fe().P)(e.data.url):window.open(e.data.url,"_blank")),void x(!1)}x(!0);const t=await I().callApi({eventName:"getIngestionOptions",environment:o,data:{spaceId:a}});"success"===t.type&&((0,M().u)({environment:o,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"edit_channels",integration_type:"slack",setup_session_id:e.sessionId,from:e.analyticsFrom}}}),zo().Rh.setState({...e,currentScreen:"data-selection",selection:{...e.selection,allSelected:t.data.selection.allSelected,selectedChannels:t.data.selection.selectedChannels,excludedChannels:t.data.selection.excludedChannels,joinFutureChannels:t.data.selection.joinFutureChannels},isEditing:!0})),x(!1)},children:y?(0,S.jsxs)(P().Ye,{style:{alignItems:"center",gap:4,fontWeight:z().Wy.regular},children:[(0,S.jsx)(oe().k,{}),(0,S.jsx)(k().sA,{id:"slackUniversalSearch.integration.loadingPreviousSelection",defaultMessage:"Loading previous selection"})]}):e.isSlackGridAiConnectorEnabled?(0,S.jsx)(k().sA,{id:"slackUniversalSearch.integration.editTeams",defaultMessage:"Edit settings"}):(0,S.jsx)(k().sA,{id:"slackUniversalSearch.integration.editChannels",defaultMessage:"Edit channels"})}),h().zD.isSlackConnectorUnificationEnabled()?void 0:(0,S.jsx)(Je().E,{style:T.disconnectButton,onClick:()=>{n(!0)},children:(0,S.jsx)(k().sA,{id:"slackUniversalSearch.integration.disconnectSlack",defaultMessage:"Disconnect"})}),(0,S.jsx)(b().Ay,{style:T.learnMoreButton,onClick:_,children:(0,S.jsxs)(P().Ye,{style:T.learnMoreText,children:[(0,S.jsx)(k().sA,{id:"universalSearch.integration.learnMore",defaultMessage:"Learn more"}),(0,S.jsx)(W().I,{icon:ze().arrowUpRightSquareSmallIcon,size:"sm"})]})})]})]})]})})]})};var vi=()=>n(682563),fi=()=>n(821983),yi=()=>n(471095),xi=()=>n(385847),Si=()=>n(438177);function _i(e){const{open:t}=e,n=(0,D().IS)((()=>({loadingWrapper:{padding:20,fontSize:z().J.UISmall.desktop,fontWeight:z().Wy.regular,justifyContent:"center",gap:8,alignItems:"center"}})),[]);return(0,S.jsx)(te().a,{showCloseIcon:!0,open:t,render:()=>(0,S.jsxs)(P().Ye,{style:n.loadingWrapper,children:[(0,S.jsx)(k().sA,{id:"aiConnectors.common.isFetchingConnection",defaultMessage:"Getting connection status"}),(0,S.jsx)(oe().k,{})]})})}function ji(){const e=(0,k().tz)(),t=(0,D().IS)((()=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:N().Tj.shadowMD,paddingTop:20,paddingInlineEnd:20,paddingBottom:20,paddingInlineStart:20,gap:6},connectButton:{fontSize:14,fontWeight:z().Wy.semibold,width:"100%"}})),[]);return(0,S.jsx)(te().a,{ariaLabel:e.formatMessage({defaultMessage:"Slack AI Connector is currently facing issues and cannot be connected.",id:"slackAiConnector.facingIssues.ariaLabel"}),showCloseIcon:!0,onDismiss:()=>zo().Rh.reset(),open:!0,render:()=>(0,S.jsxs)("div",{style:t.wrapper,children:[(0,S.jsx)(re().b,{connectorType:"slack",title:(0,S.jsx)(k().sA,{id:"slackAiConnector.facingIssues.title",defaultMessage:"Slack AI Connector is currently facing issues"}),subtext:(0,S.jsx)(k().sA,{id:"slackAiConnector.facingIssues.description",defaultMessage:"Apologies, we are currently facing issues with the Slack AI Connector and can not allow new connections. Please try again later."})}),(0,S.jsx)(P().wt,{style:t.footer,children:(0,S.jsx)(ie().A,{colorPalette:"blue",style:t.connectButton,onClick:()=>zo().Rh.reset(),children:(0,S.jsx)(k().sA,{id:"slackAiConnector.facingIssues.dismiss",defaultMessage:"Close"})})})]})})}function bi(e){const{open:t}=e;return(0,S.jsx)(de().m,{open:t,onDismiss:()=>{zo().Rh.reset()},connector:"slack"})}const ki=(0,k().YK)({slackUniversalSearchOauthPopupTitle:{id:"universalSearch.slack.slackOauthPopupTitle",defaultMessage:"Authenticate Slack"},introModalV2Title:{id:"universalSearch.slack.introModalV2Title",defaultMessage:"Connect Slack to Notion AI"},introModalV2Subtitle:{id:"universalSearch.slack.introModalV2Subtitle",defaultMessage:"Enable search and use Agents with Slack"},introModalV2ControlTitle:{id:"universalSearch.slack.introModalV2ControlTitle",defaultMessage:"You control what Notion AI can access"},introModalV2ControlDescription:{id:"universalSearch.slack.introModalV2ControlDescription",defaultMessage:"Choose what Notion AI can access. You can change these setting at any time"},introModalV2PermissionsTitle:{id:"universalSearch.slack.introModalV2PermissionsTitle",defaultMessage:"Slack permissions are strictly respected"},introModalV2PermissionsDescription:{id:"universalSearch.slack.introModalV2PermissionsDescription",defaultMessage:"Members can only get AI answers about content they are authorized to see in Slack"},introModalV2NoTrainingTitle:{id:"universalSearch.slack.introModalV2NoTrainingTitle",defaultMessage:"Notion does not train AI models on your Slack data"},continueButton:{id:"universalSearch.slack.continueButton",defaultMessage:"Continue"}});function Ii(){var e,t;const n=(0,l().v3)(),o=(0,i().r)(),r=n.currentUser.id,g=(0,d().K8)((()=>h().zD.isSlackConnectorUnificationEnabled()),[]),m=(0,d().K8)((()=>h().zD.isSlackPrivateSettingsEnabled()),[]),v=g||m,y=(0,s.useMemo)((()=>g?(0,S.jsx)(k().sA,{...ki.introModalV2Title}):(0,je().J)("slack")),[g]),x=(0,s.useMemo)((()=>g?(0,S.jsx)(k().sA,{...ki.introModalV2Subtitle}):void 0),[g]),_=(0,s.useMemo)((()=>g?[{icon:vi().gearFillIcon,title:(0,S.jsx)(k().sA,{...ki.introModalV2ControlTitle}),description:(0,S.jsx)(k().sA,{...ki.introModalV2ControlDescription})},{icon:fi().keyFillIcon,title:(0,S.jsx)(k().sA,{...ki.introModalV2PermissionsTitle}),description:(0,S.jsx)(k().sA,{...ki.introModalV2PermissionsDescription})},{icon:yi().lockFillIcon,title:(0,S.jsx)(k().sA,{...ki.introModalV2NoTrainingTitle})}]:(0,je().a)("slack")),[g]),j=(0,f().P)({name:"ai_connectors",spaceId:o,userId:r}),b=(0,d().K8)((()=>h().zD.state.isAiEnabled()),[]),A=(0,d().O$)(a().AppStoreSidebarSpaceStore),C=(0,d().O$)(zo().Rh),w=(0,d().K8)((()=>c().default.getConfigKey("ingestion","slack").learnMoreUrl),[]),T=(0,d().K8)((()=>c().default.getConfigKey("ai_connectors_onboarding_blocked","currently_facing_issues")),[]),D=(0,d().K8)((()=>h().zD.isSlackV2AiConnectorEnabled()),[]),P=null==T?void 0:T.includes("slack"),[W]=(0,u().Yb)((async()=>{if(!o||"introduction"!==C.currentScreen)return;const e=await(0,xi().u)({environment:n,spaceId:o,connector:"slack"});return void 0!==e&&"failed"!==e?{isPublicConnected:void 0!==e.details.connectionDetails}:{isPublicConnected:!1}}),[n,C.currentScreen,o]),B=(0,d().K8)((()=>A&&(0,Si().o)(A)),[A]),F=(0,_e().J)(A),N=!A||!o||(null===(e=W.value)||void 0===e?void 0:e.isPublicConnected)||!b||!B,z="resolved"===W.status&&"introduction"===C.currentScreen,E=F?"proceed_to_slack_data_selection":"contact_workspace_owners";(0,s.useEffect)((()=>{!N&&z&&(F?(0,M().u)({environment:n,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:"slack",setup_session_id:C.sessionId,from:C.analyticsFrom,is_space_admin:F,is_ai_eligible:j??!1}}}):(0,M().u)({environment:n,event:{eventName:"universal_qna_request_modal_open",eventProperties:{integration_type:"slack",from:C.analyticsFrom,is_ai_eligible:j??!1}}}))}),[n,N,C.sessionId,C.analyticsFrom,z,F,j]);const U=(0,s.useCallback)((()=>{zo().Rh.reset(),(0,M().u)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drop_off_slack_intro_modal",integration_type:"slack",setup_session_id:C.sessionId,from:C.analyticsFrom,connection_version:D?2:void 0}}})}),[n,C,D]),L=(0,s.useCallback)((async()=>{if(!o)return;if((0,p().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:n,connector:"slack",moment:"started"}),!j)return(0,M().u)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"show_purchase_ai",integration_type:"slack",setup_session_id:C.sessionId,from:C.analyticsFrom}}}),Bn().Ow({openedFrom:"slack_qna_intro_modal",currentTab:"plans"}),void zo().Rh.reset();if(v)return zo().Rh.setState({...zo().Rh.state,currentScreen:"configure-access"}),void(0,M().u)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"continue_from_intro",integration_type:"slack",setup_session_id:C.sessionId,from:C.analyticsFrom,connection_version:D?2:void 0}}});zo().Rh.setState({...zo().Rh.state,currentScreen:"data-selection"});const e=await I().callApi({eventName:"getSlackIngestionAuthorizeUrl",environment:n,data:{spaceId:o,isAdminAuth:!0,isDesktopApp:n.device.isElectron,sessionId:C.sessionId}});"success"===e.type&&(zo().Rh.setState({...zo().Rh.state,authUrl:e.data.url}),n.device.isElectron?(0,Fe().P)(e.data.url):await G().P(n,{width:800,height:600,url:e.data.url,titleMessage:ki.slackUniversalSearchOauthPopupTitle}),(0,M().u)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:E,integration_type:"slack",setup_session_id:C.sessionId,from:C.analyticsFrom,connection_version:D?2:void 0}}}))}),[n,j,D,C,o,v,E]);if(!o)return(0,S.jsx)(S.Fragment,{});if(!He().A.isMobile&&N){var R;const e=Boolean(null===(R=W.value)||void 0===R?void 0:R.isPublicConnected);return e?(0,S.jsx)(bi,{open:z&&e}):(0,S.jsx)(S.Fragment,{})}return He().A.isMobile?(0,S.jsx)(Oe().S,{connectorType:"slack",open:"introduction"===C.currentScreen,onClosed:()=>{zo().Rh.reset()},learnMoreUrl:w}):!P||"introduction"!==C.currentScreen||"resolved"!==W.status||null!==(t=W.value)&&void 0!==t&&t.isPublicConnected?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(_i,{open:"introduction"===C.currentScreen&&"resolved"!==W.status}),F?(0,S.jsx)(Ie().A,{onConnect:L,onDismiss:U,onLearnMore:()=>{window.open(w,"_blank")},title:y,subtitle:x,connectorType:"slack",notes:_,open:z,borderAroundNotes:g,grayscaleNoteIcons:g,overridePrimaryMessage:g?(0,S.jsx)(k().sA,{...ki.continueButton}):void 0}):(0,S.jsx)(ke().BN,{connector:"slack",handleClose:()=>(0,p().resetAiConnectorStatus)("slack"),open:z,analyticsFrom:C.analyticsFrom,setupSessionId:C.sessionId,messages:be().vK})]}):(0,S.jsx)(ji,{})}const Ai=function(){const e=(0,l().v3)(),t=(0,d().O$)(zo().Rh),n=(0,D().IS)((()=>({wrapper:{width:400,padding:24},logoSection:{paddingTop:"40px",paddingBottom:"16px",gap:8,justifyContent:"center",alignItems:"center"},titleWrapper:{width:"100%",justifyContent:"center",textAlign:"center"},title:{fontSize:17,fontWeight:z().Wy.medium,lineHeight:"22px",marginBottom:"24px",textWrap:"balance"},nextStepsWrapper:{width:"100%",justifyContent:"center",color:N().Tj.text.secondary},footer:{justifyContent:"center",alignItems:"center",bottom:0,width:"100%",gap:12,marginTop:12},gotIt:{fontSize:14,fontWeight:z().Wy.medium,width:"100%"},pickAnother:{fontSize:14,fontWeight:z().Wy.medium,width:"100%",textAlign:"center"}})),[]),o=(0,s.useCallback)((()=>{zo().Rh.reset()}),[]),i=(0,s.useCallback)((()=>{zo().Rh.setState({...zo().Rh.getInitialState(),currentScreen:"introduction"})}),[]);return(0,S.jsx)(te().a,{showCloseIcon:!0,onDismiss:()=>{zo().Rh.reset(),(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"slack_workspace_already_connected_modal_close",integration_type:"slack",setup_session_id:t.sessionId,from:t.analyticsFrom}}})},open:"alreadyConnected"===t.currentScreen,render:()=>(0,S.jsxs)("div",{style:n.wrapper,children:[(0,S.jsx)(P().Ye,{style:n.logoSection,children:(0,S.jsx)(W().I,{icon:F().exclamationMarkTriangleFillIcon,size:"xl"})}),(0,S.jsx)(P().Ye,{style:n.titleWrapper,children:(0,S.jsx)(P().Ye,{style:n.title,children:(0,S.jsx)(k().sA,{id:"universalSearch.slack.workspaceAlreadyConnected",defaultMessage:"Slack is already connected to another Notion workspace"})})}),(0,S.jsx)(P().Ye,{style:n.nextStepsWrapper,children:(0,S.jsx)(k().sA,{id:"universalSearch.slack.onlyOneWorkspaceCanBeConnected",defaultMessage:"Currently, Slack can be only connected to one workspace at a time"})}),(0,S.jsxs)(P().wt,{style:n.footer,children:[(0,S.jsx)(H().A,{size:"lg",style:n.gotIt,onClick:o,children:(0,S.jsx)(k().sA,{id:"universalSearch.slack.gotItOneWorkspaceConnected",defaultMessage:"Got it"})}),(0,S.jsx)(b().Ay,{style:n.pickAnother,onClick:i,children:(0,S.jsx)(k().sA,{id:"universalSearch.slack.pickDifferentWorkspace",defaultMessage:"Pick a different Slack workspace"})})]})]})})};var Ci=()=>n(721479);const wi=(0,k().YK)({selectPermissionTitle:{id:"universalSearch.slack.selectPermissionTitle",defaultMessage:"Select permission"},readAndPostTitle:{id:"universalSearch.slack.readAndPostTitle",defaultMessage:"Read and post messages"},readAndPostSubtitle:{id:"universalSearch.slack.readAndPostSubtitle",defaultMessage:"Notion AI can read and post messages to Slack channels"},readOnlyTitle:{id:"universalSearch.slack.readOnlyTitle",defaultMessage:"Read messages only"},readOnlySubtitle:{id:"universalSearch.slack.readOnlySubtitle",defaultMessage:"Notion AI can read messages in Slack channels"},recommended:{id:"universalSearch.slack.recommended",defaultMessage:"Recommended"},allowPrivateChannelAccess:{id:"universalSearch.slack.allowPrivateChannelAccess",defaultMessage:"Allow private channel access"},allowPrivateChannelAccessDescription:{id:"universalSearch.slack.allowPrivateChannelAccessDescription",defaultMessage:"Allow members to connect their private slack channels"},disablePrivateAccessTooltip:{id:"universalSearch.slack.disablePrivateAccessTooltip",defaultMessage:"To disable private channel access you must disconnect Slack"}});function Ti({selectedFeature:e,onSelect:t,privateAccessEnabled:n=!1,onPrivateAccessChange:s,showPrivateAccessOption:o=!1}){const i=(0,D().IS)((()=>({container:{display:"flex",flexDirection:"column",gap:12,padding:"16px 20px"},sectionTitle:{color:N().Tj.text.secondary,fontWeight:z().Wy.medium},radioContainer:{display:"flex",flexDirection:"column",gap:6},radioButton:{display:"flex",justifyContent:"space-between",gap:12,height:"auto",paddingTop:12,paddingBottom:12,paddingInlineStart:12,paddingInlineEnd:14,borderRadius:8,border:void 0,boxShadow:`inset 0 0 0 1px ${N().Tj.border.primary}`,font:"inherit"},radioButtonSelected:{boxShadow:`inset 0 0 0 1px ${N().Tj.blue.icon.accentPrimary}`},radioContent:{display:"flex",flexDirection:"column",gap:2,flex:1},radioTitle:{display:"flex",alignItems:"center",gap:6},radioSubtitle:{whiteSpace:"break-spaces"},privateAccessRow:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},privateAccessContent:{display:"flex",flexDirection:"column",gap:2},privateAccessTitle:{display:"flex",alignItems:"center",gap:4},tooltipIconWrapper:{display:"flex",alignItems:"center"}})),[]);return(0,S.jsxs)("div",{style:i.container,children:[(0,S.jsx)(O().A,{isSmall:!0,style:i.sectionTitle,children:(0,S.jsx)(k().sA,{...wi.selectPermissionTitle})}),(0,S.jsxs)("div",{style:i.radioContainer,children:[(0,S.jsxs)(H().A,{size:"lg",onClick:()=>t("enterprise_search_and_custom_agent"),style:{...i.radioButton,..."enterprise_search_and_custom_agent"===e?i.radioButtonSelected:{}},children:[(0,S.jsxs)("div",{style:i.radioContent,children:[(0,S.jsxs)(O().A,{style:i.radioTitle,children:[(0,S.jsx)(k().sA,{...wi.readAndPostTitle}),(0,S.jsx)(qo().E,{color:"blue",content:(0,S.jsx)(k().sA,{...wi.recommended})})]}),(0,S.jsx)(O().A,{isSmall:!0,isMultiline:!0,style:i.radioSubtitle,children:(0,S.jsx)(k().sA,{...wi.readAndPostSubtitle})})]}),(0,S.jsx)(Y().A,{isSelected:"enterprise_search_and_custom_agent"===e,radioButtonColor:"blue"})]}),(0,S.jsxs)(H().A,{size:"lg",onClick:()=>t("enterprise_search"),style:{...i.radioButton,..."enterprise_search"===e?i.radioButtonSelected:{}},children:[(0,S.jsxs)("div",{style:i.radioContent,children:[(0,S.jsx)(O().A,{style:i.radioTitle,children:(0,S.jsx)(k().sA,{...wi.readOnlyTitle})}),(0,S.jsx)(O().A,{isSmall:!0,isMultiline:!0,style:i.radioSubtitle,children:(0,S.jsx)(k().sA,{...wi.readOnlySubtitle})})]}),(0,S.jsx)(Y().A,{isSelected:"enterprise_search"===e,radioButtonColor:"blue"})]})]}),o?(0,S.jsxs)("div",{style:i.privateAccessRow,children:[(0,S.jsxs)("div",{style:i.privateAccessContent,children:[(0,S.jsxs)("div",{style:i.privateAccessTitle,children:[(0,S.jsx)(fs().D,{styleKey:"bodyRegular",children:(0,S.jsx)(k().sA,{...wi.allowPrivateChannelAccess})}),(0,S.jsx)(Vt().m,{placement:"top",renderTooltip:()=>(0,S.jsx)(k().sA,{...wi.disablePrivateAccessTooltip}),render:e=>(0,S.jsx)("span",{...e,style:i.tooltipIconWrapper,children:(0,S.jsx)(W().I,{icon:Ci().questionMarkCircleSmallIcon,size:"xs",colorVariant:"secondary"})})})]}),(0,S.jsx)(O().A,{isSmall:!0,isSecondaryColor:!0,children:(0,S.jsx)(k().sA,{...wi.allowPrivateChannelAccessDescription})})]}),(0,S.jsx)(si().A,{on:n,onClick:()=>null==s?void 0:s(!n)})]}):null]})}const Mi=(0,k().YK)({title:{id:"universalSearch.slack.writeAccessTitle",defaultMessage:"Configure Agents’ access to Slack"},saveButton:{id:"universalSearch.slack.writeAccessSave",defaultMessage:"Save"}});function Di(){const e=(0,l().v3)(),t=(0,k().tz)(),n=(0,i().r)(),o=(0,D().IS)((()=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",paddingTop:20,paddingInlineEnd:20,paddingBottom:20,paddingInlineStart:20,gap:8},saveButton:{fontSize:14,fontWeight:z().Wy.medium,width:"100%"},learnMoreButton:{fontSize:14,fontWeight:z().Wy.semibold,borderRadius:"4px",width:"100%",marginTop:6},learnMoreText:{fontWeight:z().Wy.medium,fontSize:12,gap:5,justifyContent:"center",alignItems:"center",paddingTop:4,paddingInlineEnd:8,paddingBottom:4,paddingInlineStart:8,color:`${N().Tj.text.secondary}`}})),[]),a=(0,d().K8)((()=>zo().Rh.state.currentScreen),[]),r=(0,d().K8)((()=>zo().Rh.state.writeAccessApproved),[]),u=(0,d().K8)((()=>zo().Rh.state.privateAccessEnabled),[]),[p,g]=(0,s.useState)(r?"enterprise_search_and_custom_agent":"enterprise_search"),[m,h]=(0,s.useState)(!1);(0,s.useEffect)((()=>{g(r?"enterprise_search_and_custom_agent":"enterprise_search")}),[r]);const v=(0,s.useCallback)((()=>{zo().Rh.setState({...zo().Rh.state,currentScreen:"none"})}),[]),f=(0,s.useCallback)((()=>{const e=c().default.getConfigKey("ingestion","slack"),t=null==e?void 0:e.learnMoreUrl;t&&window.open(t,"_blank")}),[]),y=(0,s.useCallback)((async()=>{if(!n)return;h(!0);const t="enterprise_search_and_custom_agent"===p;if(t)await pi().FM({environment:e,spaceId:n,isWriteAccessApproved:t,isPrivateAccessEnabled:u??!0}),v();else{"success"===(await I().callApi({eventName:"updateSlackWriteAccess",environment:e,data:{spaceId:n,writeAccessApproved:t}})).type&&((0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:t?"save_write_access_enable":"save_write_access_disable",integration_type:"slack",setup_session_id:"",from:"unknown"}}}),zo().Rh.setState({...zo().Rh.state,writeAccessApproved:t}),v())}h(!1)}),[e,v,p,n,u]);return(0,S.jsx)(te().a,{ariaLabel:t.formatMessage({id:"slackWriteAccessConfigurationModal.ariaLabel",defaultMessage:"Slack Write Access Configuration Modal"}),showCloseIcon:!0,onDismiss:v,open:"write-access-config"===a,render:()=>(0,S.jsxs)("div",{style:o.wrapper,children:[(0,S.jsx)(re().b,{connectorType:"slack",title:(0,S.jsx)(k().sA,{...Mi.title})}),(0,S.jsx)(Ti,{selectedFeature:p,onSelect:g}),(0,S.jsxs)("div",{style:o.footer,children:[(0,S.jsx)(ie().A,{colorPalette:"blue",style:o.saveButton,size:"lg",disabled:m,onClick:y,children:(0,S.jsx)(k().sA,{...Mi.saveButton})}),(0,S.jsx)(b().Ay,{style:o.learnMoreButton,onClick:f,children:(0,S.jsxs)(P().Ye,{style:o.learnMoreText,children:[(0,S.jsx)(k().sA,{id:"universalSearch.integration.learnMore",defaultMessage:"Learn more"}),(0,S.jsx)(W().I,{icon:ze().arrowUpRightSquareSmallIcon,size:"sm"})]})})]})]})})}var Pi=()=>n(9903);const Wi={...be().gp,...ke().LA,...(0,k().YK)({subtitleForAnnouncement:{defaultMessage:"Upgrade your plan to use AI Connectors.",id:"NotionAIConnectorUpsellIntroModal.subtitleForAnnouncement"}})};function Bi(){const e=(0,l().v3)(),t=(0,Se().L)(),n=(0,_e().J)(t),o=null==t?void 0:t.id,i=e.currentUser.id,a=(0,Wo()._)({name:"ai_connectors",spaceId:o,userId:i}),r=(0,k().tz)(),c=(0,d().O$)(Mo().O),u=c.open&&"ai_plan_upsell_admin_intro"===c.modal,p=(0,s.useCallback)((({source:t,upsell:n})=>{Mo().O.setState({open:!1}),"closeButton"!==t&&n&&c.open&&"ai_plan_upsell_admin_intro"===c.modal&&(Po().K(e,{from:"ai_connector_ai_upsell_intro_modal",upsell:n,spaceStore:(0,Co().S)()}),"generic"!==c.connector&&Pi().A.setState({...Pi().A.state,connectorTriggeringUpsell:c.connector,upsellTriggeredAt:Date.now()}))}),[e,c]);if(!u||!a)return null;const g=c.connector;return(0,S.jsx)(te().a,{ariaLabel:r.formatMessage(be().vK.title),open:u,render:()=>(0,S.jsx)(Bo().Y,{messages:Wi,aiConnectorsFeatureAvailability:a,onDismiss:p,calloutKey:void 0,eventName:"ai_connector_ai_plan_upsell_intro_modal_opened",learnMoreHref:(0,Le().x)("guides.aiConnectors"),connector:g,showNarrowCta:n})})}function Fi(e){const t=(0,k().tz)(),{open:n,onDismiss:s,onConfirm:o,ariaLabel:i,title:a,subtitle:r,buttonLabel:c,connectorType:l}=e,d=(0,D().IS)((()=>({wrapper:{width:400,paddingTop:0,paddingInlineEnd:20,paddingBottom:20,paddingInlineStart:20},button:{marginTop:20,width:"100%"}})),[]);return(0,S.jsx)(te().a,{ariaLabel:t.formatMessage(i),showCloseIcon:!0,onDismiss:s,open:n,render:()=>(0,S.jsxs)("div",{style:d.wrapper,children:[(0,S.jsx)(re().b,{connectorType:l,title:a,subtext:r}),(0,S.jsx)(ie().A,{colorPalette:"blue",size:"xl",style:d.button,onClick:o,children:c})]})})}const Ni=(0,k().YK)({title:{id:"universalSearch.authNeededModal.authNeededModalTitle",defaultMessage:"Authentication needed"},subtitle:{id:"universalSearch.authNeededModal.authNeededModalSubtitle",defaultMessage:"We couldn’t verify your {appName} e-mail. To get {appName} answers and results, please authenticate."},buttonLabel:{id:"universalSearch.authNeededModal.authNeededModalButtonLabel",defaultMessage:"Connect your account"}});function zi(){const{open:e,connector:t}=(0,d().K8)((()=>({open:Mo().O.state.open&&"auth_needed"===Mo().O.state.modal,connector:Mo().O.state.open&&"auth_needed"===Mo().O.state.modal?Mo().O.state.connector:"slack"})),[]),n=(0,l().v3)(),s=(0,i().r)(),o=(0,k().tz)();return(0,S.jsx)(Fi,{ariaLabel:Ni.title,title:o.formatMessage(Ni.title,{appName:At().w0[t]}),subtitle:o.formatMessage(Ni.subtitle,{appName:At().w0[t]}),buttonLabel:o.formatMessage(Ni.buttonLabel),connectorType:t,onDismiss:()=>{Mo().O.setState({open:!1})},onConfirm:()=>(async e=>{s&&("github"===e||"linear"===e||"salesforce"===e||"asana"===e?await(0,di().t)({connector:e,environment:n,spaceId:s,analyticsProperties:{buttonName:"user_auth_connect",analyticsFrom:"ai_chat_scoped_search_menu"},onAuthSuccess:()=>{Mo().O.setState({open:!1})}}):"slack"===e?((0,di().t)({connector:e,environment:n,spaceId:s,analyticsProperties:{buttonName:"user_auth_connect",analyticsFrom:"ai_chat_scoped_search_menu"}}),Mo().O.setState({open:!1})):"discord"===e?(0,di().t)({connector:e,environment:n,spaceId:s,analyticsProperties:{buttonName:"user_auth_connect",analyticsFrom:"ai_chat_scoped_search_menu"}}):(0,et().HB)(e))})(t),open:e})}function Ei(){const{open:e,connector:t}=(0,d().K8)((()=>({open:Mo().O.state.open&&"progress"===Mo().O.state.modal,connector:Mo().O.state.open&&"progress"===Mo().O.state.modal?Mo().O.state.connector:"slack"})),[]),n=At().w0[t],s=()=>{Mo().O.setState({open:!1})};return(0,S.jsx)(Ie().A,{onConnect:s,onDismiss:s,title:(0,S.jsx)(k().sA,{id:"universalSearchProgressModal.generalizedTitle",defaultMessage:"{connector} is connecting to Notion AI",values:{connector:n}}),connectorType:t,subtitle:(0,S.jsx)(k().sA,{id:"universalSearchProgressModal.subtitle",defaultMessage:"This can take up to 36hr.{br}You’ll be able to get answers soon.",values:{br:(0,S.jsx)("br",{})}}),overridePrimaryMessage:(0,S.jsx)(k().sA,{id:"universalSearchProgressModal.ctaMessage",defaultMessage:"Got it"}),centerNotes:!0,noteStyleOverrides:{fontSize:"14px"},open:e})}var Ui=()=>n(19575);const Li={...be().gp,...(0,k().YK)({title:{defaultMessage:"Find anything across all of your apps with Notion AI",id:"NotionAIConnectorSalesAssistedRequestModal.title"},subtitleForAnnouncement:{defaultMessage:"Get search results, AI answers, summaries and more without leaving Notion.",id:"NotionAIConnectorSalesAssistedRequestModal.subtitleForAnnouncement"},notifyWorkspaceOwner:{defaultMessage:"Notify your sales representative for access",id:"NotionAIConnectorSalesAssistedRequestModal.notifyWorkspaceOwners"}})};function Ri(){const e=(0,l().v3)(),t=(0,i().r)(),n=e.currentUser.id,o=(0,Wo()._)({name:"ai_connectors",spaceId:t,userId:n}),a=(0,k().tz)(),r=(0,d().O$)(Mo().O),c=r.open&&"sales_assisted_admin_request"===r.modal,u=(0,s.useCallback)((({source:e})=>{Mo().O.setState({open:!1}),"closeButton"!==e&&r.open&&"sales_assisted_admin_request"===r.modal&&(0,Ui().cz)()}),[r]);if(!c||!o)return null;const p=r.connector;return(0,S.jsx)(te().a,{ariaLabel:a.formatMessage(be().vK.title),open:c,render:()=>(0,S.jsx)(Bo().Y,{messages:Li,aiConnectorsFeatureAvailability:o,onDismiss:u,calloutKey:void 0,eventName:"ai_connector_sales_assisted_intro_modal_opened",learnMoreHref:void 0,connector:p,showNarrowCta:!1,isSalesAssisted:!0})})}function Ki(){const e=(0,i().r)(),t=(0,o().T)(),n=(0,l().v3)(),y=(0,d().O$)(Pi().A),x=(0,f().P)({name:"ai_connectors",spaceId:e,userId:t}),j=(0,d().K8)((()=>h().zD.canUseAiConnectorSearchScope("github")),[]),b=(0,d().K8)((()=>h().zD.canUseAiConnectorSearchScope("gmail")),[]),k=(0,d().K8)((()=>h().zD.canUseAiConnectorSearchScope("google-calendar")),[]),I=(0,d().K8)((()=>h().zD.canUseAiConnectorSearchScope("notion-mail")),[]),A=(0,d().K8)((()=>h().zD.canUseAiConnectorSearchScope("notion-calendar")),[]),w=(0,d().K8)((()=>h().zD.canUseAiConnectorSearchScope("outlook")),[]),M=(0,d().K8)((()=>h().zD.canUseAiConnectorSearchScope("jira")),[]),D=(0,r().X)("jira_qna_ingestion_v2"),P=(0,d().K8)((()=>h().zD.canUseAiConnectorSearchScope("microsoft-teams")),[]),W=(0,d().K8)((()=>h().zD.canUseAiConnectorSearchScope("sharepoint")),[]),B=(0,d().K8)((()=>h().zD.canUseAiConnectorSearchScope("linear")),[]),F=(0,d().K8)((()=>h().zD.canUseAiConnectorSearchScope("salesforce")),[]),N=(0,d().K8)((()=>h().zD.canUseAiConnectorSearchScope("discord")),[]),z=(0,d().K8)((()=>h().zD.canUseAiConnectorSearchScope("box")),[]),E=(0,d().K8)((()=>h().zD.canUseAiConnectorSearchScope("asana")),[]),U=(0,d().K8)((()=>a().default.getState().sidebarSpaceViewStore),[]);(0,s.useEffect)((()=>{"introduction"!==Re().o.state.currentScreen&&Re().o.reset()}),[]);const R=(0,d().K8)((()=>(0,m().wd)()),[]),H=(0,d().K8)((()=>(0,m().kB)()),[]);(0,s.useEffect)((()=>{if(U)for(const e of H)(0,p().maybeTrackSprigAiConnectorOnboardingSurvey)({environment:n,connector:e,connectedApps:R})}),[n,R,H,U]);const O=(0,r().X)("install_from_jira_marketplace");return(0,g().ts)(),(0,u().Yb)((async()=>{e&&P&&("introduction"!==es().F0.state.currentScreen&&es().F0.reset(),await(0,p().getMicrosoftTeamsAIConnectorStatusAction)({environment:n,spaceId:e}))}),[e,P,n]),(0,s.useEffect)((()=>{const{connectorTriggeringUpsell:e,upsellTriggeredAt:t}=y,n=c().default.getConfigKey("ingestion","upsellMaxDurationInSeconds")||36e5;if(x&&e&&t){if(Date.now()-t>n)return void Pi().A.reset();switch(e){case"slack":zo().Rh.setState({...zo().Rh.state,currentScreen:"introduction"});break;case"google-drive":v().d.setState({...v().d.state,currentScreen:"introduction"});break;case"jira":xn().yg.setState({...xn().yg.state,currentScreen:"introduction"});break;case"github":Re().o.setState({...Re().o.state,currentScreen:"introduction"})}Pi().A.reset()}}),[y,x]),(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(ke().zK,{}),(0,S.jsx)(Bi,{}),(0,S.jsx)(Ri,{}),(0,S.jsx)(Ei,{}),(0,S.jsx)(zi,{}),(0,S.jsx)(Fo,{}),(0,S.jsx)(Ii,{}),(0,S.jsx)(Ko,{}),(0,S.jsx)(ei,{}),(0,S.jsx)(hi,{}),(0,S.jsx)(mi,{}),(0,S.jsx)(Di,{}),(0,S.jsx)(Qo,{}),(0,S.jsx)(Ai,{}),(0,S.jsx)(en,{}),(0,S.jsx)(Kt,{}),(0,S.jsx)(Yt,{}),(0,S.jsx)(Jt,{}),(0,S.jsx)(Zt,{}),(0,S.jsx)(Rt,{}),(0,S.jsx)(Ft,{}),(0,S.jsx)(kt,{}),(0,S.jsx)(It,{}),(0,S.jsx)(Wt,{}),(0,S.jsx)(Et,{}),k?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(ht,{}),(0,S.jsx)(vt,{}),(0,S.jsx)(St,{}),(0,S.jsx)(yt,{}),(0,S.jsx)(ft,{}),(0,S.jsx)(xt,{}),(0,S.jsx)(bt,{}),(0,S.jsx)(_t,{}),(0,S.jsx)(jt,{})]}):void 0,b?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(ot,{}),(0,S.jsx)(it,{}),(0,S.jsx)(lt,{}),(0,S.jsx)(rt,{}),(0,S.jsx)(at,{}),(0,S.jsx)(ct,{}),(0,S.jsx)(pt,{}),(0,S.jsx)(dt,{}),(0,S.jsx)(ut,{})]}):void 0,I?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(Ks().xF,{}),(0,S.jsx)(Ks().y_,{}),(0,S.jsx)(Ks().vu,{}),(0,S.jsx)(Ks().cP,{}),(0,S.jsx)(Ks().aJ,{}),(0,S.jsx)(Ks().Fp,{}),(0,S.jsx)(Ks().PY,{}),(0,S.jsx)(Ks().qt,{}),(0,S.jsx)(Ks().ht,{})]}):void 0,A?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(Ws,{}),(0,S.jsx)(Bs,{}),(0,S.jsx)(Es,{}),(0,S.jsx)(Ns,{}),(0,S.jsx)(Fs,{}),(0,S.jsx)(zs,{}),(0,S.jsx)(Rs,{}),(0,S.jsx)(Us,{}),(0,S.jsx)(Ls,{})]}):void 0,w?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(Os,{}),(0,S.jsx)(Gs,{}),(0,S.jsx)(Vs,{}),(0,S.jsx)(qs,{}),(0,S.jsx)(Ys,{}),(0,S.jsx)(Js,{}),(0,S.jsx)(Xs,{}),(0,S.jsx)($s,{}),(0,S.jsx)(Qs,{})]}):void 0,j?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(qe,{}),(0,S.jsx)(Ke,{}),(0,S.jsx)(Ze,{}),(0,S.jsx)(Ve,{})]}):void 0,M?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(Un,{}),(0,S.jsx)(_n,{}),(0,S.jsx)(Mn,{}),(0,S.jsx)(Wn,{}),(0,S.jsx)(Hn,{}),(0,S.jsx)(Sn,{}),(0,S.jsx)(Rn,{}),(0,S.jsx)(En,{}),O?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(wn,{}),(0,S.jsx)(zn,{})]}):void 0]}):void 0,D?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(mn,{}),(0,S.jsx)(on,{}),(0,S.jsx)(rn,{}),(0,S.jsx)(dn,{}),(0,S.jsx)(yn,{}),(0,S.jsx)(cn,{}),(0,S.jsx)(gn,{})]}):void 0,P?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(vs,{}),(0,S.jsx)(ns,{}),(0,S.jsx)(ls,{}),(0,S.jsx)(gs,{}),(0,S.jsx)(Ms,{}),(0,S.jsx)(ms,{}),(0,S.jsx)(ts,{}),(0,S.jsx)(Ds().n,{}),(0,S.jsx)(ws,{}),(0,S.jsx)(ds,{}),(0,S.jsx)(rs,{})]}):void 0,W?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(vo,{}),(0,S.jsx)(ro,{}),(0,S.jsx)(lo,{}),(0,S.jsx)(So,{}),(0,S.jsx)(ko,{}),(0,S.jsx)(uo,{}),(0,S.jsx)(go,{}),(0,S.jsx)(Ao,{})]}):void 0,B?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(Xn,{}),(0,S.jsx)(Jn,{}),(0,S.jsx)($n,{}),(0,S.jsx)(Zn,{})]}):void 0,F?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(to,{}),(0,S.jsx)(no,{}),(0,S.jsx)(so,{}),(0,S.jsx)(oo,{}),(0,S.jsx)(io,{})]}):void 0,N?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(Te,{}),(0,S.jsx)(Me,{}),(0,S.jsx)(De,{}),(0,S.jsx)(Pe,{}),(0,S.jsx)(We,{}),(0,S.jsx)(Be,{})]}):void 0,E?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(X,{}),(0,S.jsx)(L,{}),(0,S.jsx)(_,{}),(0,S.jsx)(C,{}),(0,S.jsx)(ee,{}),(0,S.jsx)(T,{}),(0,S.jsx)(K,{}),(0,S.jsx)(le,{})]}):void 0,z?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(ge,{}),(0,S.jsx)(me,{}),(0,S.jsx)(fe,{}),(0,S.jsx)(he,{}),(0,S.jsx)(ve,{}),(0,S.jsx)(ye,{}),(0,S.jsx)(xe,{})]}):void 0]})}},611947:(e,t,n)=>{n.r(t),n.d(t,{checkIsTutorialDone:()=>h,dismissTutorial:()=>d,resetTutorials:()=>u,tutorialAdvanceToStep:()=>p,tutorialAdvanceToStepAfter:()=>g,tutorialGoToNextStep:()=>c,tutorialGoToPrevStep:()=>l,tutorialGoToStep:()=>m});var s=()=>n(907258),o=()=>n(541235),i=()=>n(680977),a=()=>n(547149),r=()=>n(646355);function c(e,t,n){var o;const{currentUserSettingsStore:a}=s().default.state;if(!a)return;const c=null===(o=a.getSettings())||void 0===o?void 0:o.tutorials;n?(0,i().m)({userSettingsStore:a,transaction:n,data:{tutorials:{...c,[t]:(0,r().i9)(a,t)}}}):v({userAction:"TutorialActions.nextStep",environment:e,perform:e=>{(0,i().m)({userSettingsStore:a,transaction:e,data:{tutorials:{...c,[t]:(0,r().i9)(a,t)}}})},userId:a.id})}function l(e,t){var n;const{currentUserSettingsStore:o}=s().default.state;if(!o)return;const a=null===(n=o.getSettings())||void 0===n?void 0:n.tutorials;v({userAction:"TutorialActions.prevStep",environment:e,perform:e=>{(0,i().m)({userSettingsStore:o,transaction:e,data:{tutorials:{...a,[t]:(0,r().KD)(o,t)}}})},userId:o.id})}function d(e,t){var n;const{currentUserSettingsStore:a}=s().default.state;if(!a)return;const r=null===(n=a.getSettings())||void 0===n?void 0:n.tutorials;(null==r?void 0:r[t])!==o().YD&&v({userAction:"TutorialActions.dismissTutorial",environment:e,perform:e=>{(0,i().m)({userSettingsStore:a,transaction:e,data:{tutorials:{...r,[t]:o().YD}}})},userId:a.id})}function u(e){const{currentUserSettingsStore:t}=s().default.state;t&&v({userAction:"TutorialActions.resetTutorialsDebug",environment:e,perform:e=>{(0,i().m)({userSettingsStore:t,transaction:e,data:{tutorials:{}}})},userId:t.id})}function p(e,t,n){var a;const{currentUserSettingsStore:c}=s().default.state;if(!c||(0,r().x$)(c,t))return;const l=(0,r().gt)(c,t);o().c$[t].steps.findIndex((e=>e.id===l))>=o().c$[t].steps.findIndex((e=>e.id===n))||(0,i().m)({userSettingsStore:c,transaction:e,data:{tutorials:{...null===(a=c.getSettings())||void 0===a?void 0:a.tutorials,[t]:n}}})}function g(e,t,n){if((0,r().ll)(n))return;const s=(0,r().tb)(t,n);s&&p(e,t,s)}function m(e,t,n,o){var a;const{currentUserSettingsStore:r}=s().default.state;if(!r)return;const c=null===(a=r.getSettings())||void 0===a?void 0:a.tutorials;o?(0,i().m)({userSettingsStore:r,transaction:o,data:{tutorials:{...c,[t]:n}}}):v({userAction:"TutorialActions.nextStep",environment:e,perform:e=>{(0,i().m)({userSettingsStore:r,transaction:e,data:{tutorials:{...c,[t]:n}}})},userId:r.id})}function h(e){const{currentUserSettingsStore:t}=s().default.state;return!!t&&(0,r().x$)(t,e)}function v(e){return a().createAndCommit({...e,canUndo:!1})}},612900:(e,t,n)=>{n.d(t,{u:()=>i});var s=()=>n(79926);const o=new(s().O2)("PulsingWrapper",(async()=>n.e(45248).then(n.bind(n,673962)))),i=(0,s().jQ)(o,(e=>e.PulsingWrapper),{renderLoading:(e,t)=>t.children})},625194:(e,t,n)=>{n.d(t,{m:()=>a});var s=n(296540),o=()=>n(96330),i=n(474848);const a=s.memo((function(e){const{textValue:t}=e,n=(0,s.useMemo)((()=>(0,o().X1)((0,o().eC)(t))),[t]);return(0,i.jsx)("span",{children:n})}))},646355:(e,t,n)=>{n.d(t,{KD:()=>c,gt:()=>l,i9:()=>r,ll:()=>i,tb:()=>a,x$:()=>o});n(18107),n(967357);var s=()=>n(541235);function o(e,t){return i(l(e,t))}function i(e){return void 0!==e&&(e===s().q_||e===s().YD)}function a(e,t){if(i(t))return;const n=s().c$[e],o=n.steps.findIndex((e=>e.id===t));return-1===o?n.steps[0].id:o===n.steps.length-1?s().q_:n.steps[o+1].id}function r(e,t){const n=l(e,t);if(n&&!i(n))return a(t,n)}function c(e,t){const n=l(e,t);if(n)return function(e,t){const n=s().c$[e];var o;if(i(t))return null===(o=n.steps.at(-1))||void 0===o?void 0:o.id;const a=n.steps.findIndex((e=>e.id===t));return-1!==a&&0!==a?n.steps[a-1].id:void 0}(t,n)}function l(e,t){var n;if(!e)return;const o=((null===(n=e.getSettings())||void 0===n?void 0:n.tutorials)||{})[t];return void 0===o?s().c$[t].steps[0].id:o}},682563:(e,t,n)=>{n.r(t),n.d(t,{gearFillIcon:()=>o,iconDefinition:()=>s});n(296540);const s={viewBox:"0 0 20 20",fittedViewBox:"2.83 2.82 14.36 14.36",svg:(0,n(474848).jsx)("path",{d:"M15.76 5.73c.12.16.12.39 0 .56l.01-.01-.74 1.05c-.11.16-.12.35-.05.52l.09.21c.07.18.22.31.4.34l1.25.22c.21.03.37.19.4.4.05.32.07.64.07.96V10c0 .36-.03.71-.08 1.05-.03.21-.2.36-.4.4l-1.27.22a.52.52 0 0 0-.4.33l-.09.21a.51.51 0 0 0 .04.52l.73 1.03c.12.17.13.4 0 .57-.19.26-.4.5-.63.74h-.01c-.25.25-.51.48-.79.69a.48.48 0 0 1-.56 0l-1.05-.74a.54.54 0 0 0-.52-.05l-.21.09a.53.53 0 0 0-.34.4l-.22 1.25c-.03.21-.19.37-.4.4-.32.05-.64.07-.96.07h-.02c-.36 0-.71-.03-1.05-.08a.49.49 0 0 1-.4-.4l-.22-1.27a.52.52 0 0 0-.33-.4l-.21-.09a.51.51 0 0 0-.52.04l-1.03.73a.48.48 0 0 1-.57 0c-.25-.19-.49-.4-.72-.64h-.01c-.25-.25-.48-.51-.69-.79a.48.48 0 0 1 0-.56L5 12.67c.11-.15.12-.34.05-.51l-.09-.21a.53.53 0 0 0-.4-.34l-1.25-.22a.47.47 0 0 1-.4-.4c-.05-.32-.07-.64-.07-.96v-.02c0-.36.03-.71.08-1.05.03-.21.2-.36.4-.4l1.27-.22a.52.52 0 0 0 .4-.33l.09-.21a.51.51 0 0 0-.04-.52l-.73-1.03a.48.48 0 0 1 0-.57c.19-.26.4-.5.63-.74h.01c.25-.26.51-.48.79-.69a.48.48 0 0 1 .56 0l1.05.74c.15.11.34.12.51.05l.21-.09a.53.53 0 0 0 .34-.4l.22-1.25c.03-.21.19-.37.4-.4.32-.05.64-.07.96-.07h.02c.36 0 .71.03 1.05.08.21.03.36.2.4.4l.22 1.27c.03.19.16.33.33.4l.21.09c.17.08.37.07.52-.04l1.03-.73c.17-.12.4-.13.57 0 .25.19.49.4.72.64h.01c.25.25.48.51.69.79M12.08 10c0-1.15-.93-2.08-2.08-2.08S7.92 8.85 7.92 10s.93 2.08 2.08 2.08 2.08-.93 2.08-2.08"})},o=(0,n(340498).wt)("gearFill",s,"fill")},730307:(e,t,n)=>{n.d(t,{l:()=>g});var s=()=>n(779315),o=()=>n(292985),i=()=>n(161479),a=()=>n(878523),r=()=>n(129522),c=()=>n(404783),l=()=>n(555776),d=()=>n(116008),u=()=>n(36088),p=()=>n(405981);async function g(e){var t;const{environment:n,blockStore:g,rect:m,property_id:h,from:v}=e;if(d().A.hasContent())return void(0,p()._y)({environment:n,reason:"starting_new"});const f=r().K.getRect(g);if(!f)return;const y=new(c().A)(n,(0,i().e)(g.pointer.spaceId)),x=f.width,S=f.height,_=f.right-x;d().A.setState({open:!0,rect:m||new DOMRect(_,f.top,x,S),type:"block",content:"comment",blockStore:g,blockId:g.id,discussionInputStore:y,property_id:h,lastKnownBlockStore:g,from:v}),(0,o().V)({element:null===(t=s().A.UpdateSidebarCommentScroller)||void 0===t?void 0:t.getNode(),environment:n,options:{top:0,behavior:"smooth"}}),l().A.setActiveWithSource("text_annotation"),await(0,u().M)({discussionInputStore:y,environment:n}),a().j4(n,{from:v})}},783793:(e,t,n)=>{n.d(t,{o:()=>l,x:()=>c});n(296540);var s=()=>n(401497),o=()=>n(100622),i=()=>n(278589),a=()=>n(200424),r=n(474848);function c(e){const{variant:t,imgSource:n,tintColor:a,faceStyle:c,shadowVariant:d="strong",style:u,...p}=e,g=(0,s().IS)((()=>{const e=(0,i().N)(t);return{faceImgWrap:{width:e,height:e,borderRadius:"100%",background:o().Tj.assistantCornerButtonBackground,..."strong"===d&&{boxShadow:e>=90?o().Tj.shadowMDThickerOutline:o().Tj.shadowMD},..."light"===d&&{borderRadius:"50%",boxShadow:e>=90?o().Tj.shadowSMThickerOutline:o().Tj.shadowSM},overflow:"hidden",...u}}}),[t,d,u]);return(0,r.jsx)("div",{...p,children:(0,r.jsx)("div",{style:g.faceImgWrap,children:(0,r.jsx)(l,{imgSource:n,variant:t,tintColor:a,style:c})})})}function l(e){const{imgSource:t,variant:n,tintColor:o,style:c,alt:l,...d}=e,u=(0,i().N)(n),p=t??a(),g=l??"Notion AI face",m=(0,s().IS)((()=>({faceImg:{height:u,width:u,transform:"scaleX(var(--direction, 1))",...c},tintedFace:{height:u,width:u,transform:"scaleX(var(--direction, 1))",backgroundColor:o,WebkitMaskImage:`url(${p})`,maskImage:`url(${p})`,WebkitMaskRepeat:"no-repeat",maskRepeat:"no-repeat",WebkitMaskPosition:"center",maskPosition:"center",WebkitMaskSize:"contain",maskSize:"contain",...c}})),[u,c,o,p]);return void 0!==o?(0,r.jsx)("div",{style:m.tintedFace,role:"img","aria-label":g}):(0,r.jsx)("img",{...d,style:m.faceImg,src:p,alt:g})}},803960:(e,t,n)=>{n.r(t),n.d(t,{arrowChevronSingleDownIcon:()=>o,iconDefinition:()=>s});n(296540);const s={viewBox:"0 0 20 20",fittedViewBox:"3.97 6.97 12.06 6.66",svg:(0,n(474848).jsx)("path",{d:"M9.558 13.442c.244.244.64.244.884 0l5.4-5.4a.625.625 0 0 0-.884-.884L10 12.116 5.042 7.158a.625.625 0 1 0-.884.884z"})},o=(0,n(340498).wt)("arrowChevronSingleDown",s,"default")},837622:(e,t,n)=>{n.d(t,{A:()=>u});var s=n(296540),o=()=>n(590526),i=()=>n(401497),a=()=>n(201980),r=()=>n(116008),c=()=>n(279115),l=()=>n(29554),d=n(474848);const u=s.memo((function(e){const{parentStore:t,withComma:u,linkifyUrls:p,disableCommentHighlight:g,disableLinks:m,shouldTruncate:h,clampLines:v,textValue:f}=e,y=(0,n(484714).v3)(),x=(0,i().DP)(),S=(0,n(712030).Ol)();(0,s.useEffect)((()=>{void 0!==f&&y.KatexStore.loadIfNeeded((()=>f))}),[y.KatexStore,f]);const{collectionContextStore:_,property:j}=(0,s.useContext)(n(971003).L8),{collectionViewBlockId:b,collectionViewId:k}=(0,o().K8)((()=>{var e,t;return{collectionViewId:null==_||null===(e=_.collectionViewStore())||void 0===e?void 0:e.id,collectionViewBlockId:null==_||null===(t=_.collectionViewBlockStore())||void 0===t?void 0:t.id}}),[_]),I=(0,o().K8)((()=>y.KatexStore.getKatex()),[y.KatexStore]),A=(0,o().K8)((()=>{const e=c().qu.state,n=c().wb.state;return e&&j&&f?l().nu({textValue:f,blockId:t.id,textProps:{type:"page_property_value_match",collectionViewBlockId:b,collectionViewId:k,propertyId:j},find:e,currentFocusedResult:n,store:t}):f}),[j,t,f,b,k]),C=(0,o().K8)((()=>{if(r().A.getPropertyId()!==j||r().A.getBlockStore()!==t)return A;const e=r().A.getMultiSelection();return e?a().Mwp({textValue:A,selection:{startIndex:e.start.index,endIndex:e.end.index},annotation:[a().Ifu.TemporaryComment]}):f?a().Mwp({textValue:A,selection:{startIndex:0,endIndex:a().qAZ(f).length},annotation:[a().Ifu.TemporaryComment]}):A}),[t,j,f,A]),w=(0,o().K8)((()=>void 0===C?null:l().S5({environment:y,textValue:C&&{value:C,spaceId:(0,n(161479).e)(t.pointer.spaceId)},parentStore:t,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disableCommentAnnotations:g??!1,disabled:!0,theme:x,disableLinks:m??!1,emojiType:S,katex:I,formulaValueTypes:[],stopLinkPropagation:!0,linkTargetBlank:!0})),[C,y,t,g,x,m,S,I],{silenceRerenderDefender:!0}),T=(0,s.useMemo)((()=>{if(!p||void 0===f)return null;const e=(0,a().k4p)(f);return(0,n(735577).A)(e)?(0,n(713998).MO)(f):null}),[p,f]),M=(0,i().IS)((()=>({text:{...h&&!v?n(284371).RC:void 0,...h&&v?{...(0,n(115512).pA)(v),overflow:"hidden",textOverflow:"ellipsis"}:{}}})),[h,v]);return(0,d.jsxs)("span",{style:M.text,children:[T?(0,d.jsx)(n(552712).N,{href:T,style:{display:"inline",pointerEvents:"auto",...(0,n(468882).w_)()},external:!0,onClick:e=>e.stopPropagation(),children:w}):w,u?", ":null]})}))},848401:(e,t,n)=>{n.d(t,{Ay:()=>h,mI:()=>g,vb:()=>m});n(296540);var s=()=>n(401497),o=()=>n(718827),i=()=>n(807449),a=()=>n(784892),r=()=>n(563692),c=()=>n(340498),l=()=>n(69708),d=()=>n(284371),u=n(474848);const p=(0,l().YK)({removeTokenLabel:{defaultMessage:"Remove {title}",id:"uiGenericToken.removeTokenLabel"},removeTokenLabelGeneric:{defaultMessage:"Remove Item",id:"uiGenericToken.removeTokenLabelGeneric"}}),g=a().NY,m={[a().NY.ExtremeSmall]:{height:12,fontSize:10,margin:"0 4px 0 0",marginEditState:"0 6px 0 0",closeIconSize:c().Ev.xxs,avatarSize:14},[a().NY.ExtraSmall]:{height:14,fontSize:12,margin:"0 6px 0 0",marginEditState:"0 6px 0 0",closeIconSize:c().Ev.xxs,avatarSize:14},[a().NY.Small]:{height:18,fontSize:12,margin:"0 6px 6px 0",marginEditState:"0 6px 6px 0",closeIconSize:c().Ev.xxs,avatarSize:16},[a().NY.CompactEssential]:{height:20,fontSize:14,margin:"0 10px 6px 0",marginEditState:"0 6px 6px 0",closeIconSize:c().Ev.xxs,avatarSize:20},[a().NY.Medium]:{height:20,fontSize:14,margin:"0 10px 6px 0",marginEditState:"0 6px 6px 0",closeIconSize:c().Ev.xxs,avatarSize:20},[a().NY.Inline]:{height:20,fontSize:14,closeIconSize:c().Ev.xxs,avatarSize:20,margin:"0 -5px 0 0",marginEditState:"0 6px 0 0"},[a().NY.Large]:{height:24,fontSize:16,margin:"0 8px 8px 0",marginEditState:"0 8px 8px 0",closeIconSize:c().Ev.sm,avatarSize:24}};function h({avatarSize:e,format:t,isSingle:n,onClickRemove:a,renderAvatar:c,showRemoveButton:g,shouldShrink:h,style:v,title:f}){const y=(0,l().tz)(),{height:x,fontSize:S,margin:_,marginEditState:j,closeIconSize:b,avatarSize:k}=m[t],I=e??k,A=(0,s().IS)((()=>({root:{display:"flex",alignItems:"center",flexShrink:h?1:0,minWidth:0,height:x,borderRadius:6,fontSize:S,lineHeight:"120%",margin:n?0:g?j:_,...v}})),[S,x,n,_,j,h,g,v]);return(0,u.jsxs)("div",{style:A.root,children:[null==c?void 0:c(I),(0,u.jsx)("div",{className:"notranslate",style:{...d().RC},children:f}),g?(0,u.jsx)(o().Ay,{ariaLabel:void 0!==f?y.formatMessage(p.removeTokenLabel,{title:f}):y.formatMessage(p.removeTokenLabelGeneric),onClick:a,style:{display:"flex",alignItems:"center",justifyContent:"center",width:x,height:x,marginInlineStart:2,marginInlineEnd:2,flexGrow:0,flexShrink:0,borderRadius:6},children:(0,u.jsx)(i().I,{icon:r().xMarkFillSmallIcon,size:b,style:{opacity:.5}})}):null]})}},852219:(e,t,n)=>{n.r(t),n.d(t,{bookSmallIcon:()=>o,iconDefinition:()=>s});n(296540);const s={viewBox:"0 0 16 16",fittedViewBox:"1.48 2.62 13.03 10.76",svg:(0,n(474848).jsx)("path",{d:"M1.73 3.768C3.598 2.34 6.058 2.25 8 3.501c1.942-1.251 4.402-1.162 6.27.267a.63.63 0 0 1 .245.497v8.485a.625.625 0 0 1-1.005.496c-1.543-1.18-3.584-1.18-5.128-.001l-.015.01a.7.7 0 0 1-.19.094.62.62 0 0 1-.56-.105c-1.543-1.18-3.584-1.178-5.127.002a.625.625 0 0 1-1.005-.496V4.265c0-.195.09-.379.245-.497m1.005 7.87a5.37 5.37 0 0 1 4.64 0V4.586a4.14 4.14 0 0 0-4.64 0zm5.89 0a5.37 5.37 0 0 1 4.64 0V4.586a4.14 4.14 0 0 0-4.64 0z"})},o=(0,n(340498).wt)("bookSmall",s,"small")},859384:(e,t,n)=>{n.d(t,{M:()=>i});n(296540);var s=n(474848);const o={viewBox:"0 0 20 20",fittedViewBox:"3.12 2.99 13.88 13.88",svg:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("path",{d:"m16.774 4.341-.59.589-1.109-1.11.596-.594a.784.784 0 0 1 1.103 0c.302.302.302.8 0 1.102zM8.65 12.462l6.816-6.813-1.11-1.11-6.822 6.808a1.1 1.1 0 0 0-.236.393l-.289.932c-.052.196.131.38.315.314l.932-.288a.9.9 0 0 0 .394-.236"}),(0,s.jsx)("path",{d:"M4.375 6.25c0-1.036.84-1.875 1.875-1.875H11a.625.625 0 1 0 0-1.25H6.25A3.125 3.125 0 0 0 3.125 6.25v7.5c0 1.726 1.4 3.125 3.125 3.125h7.5c1.726 0 3.125-1.4 3.125-3.125V9a.625.625 0 1 0-1.25 0v4.75c0 1.036-.84 1.875-1.875 1.875h-7.5a1.875 1.875 0 0 1-1.875-1.875z"})]})},i=(0,n(340498).wt)("compose",o,"default")},883701:(e,t,n)=>{n.d(t,{J:()=>r});var s=()=>n(34977),o=()=>n(457205),i=()=>n(849255),a=()=>n(534177);function r(e,t){if(t&&t.asActor)switch(t.pointer.table){case"bot":return new(o().v)(e,t.pointer);case"agent":return new(s().p)(e,t.pointer);case"notion_user":return new(i().L)(e,t.pointer);default:(0,a().HB)(t.pointer)}}},888643:(e,t,n)=>{n.d(t,{k:()=>o});var s=()=>n(402014);function o(e){(0,s().SQ)(e,s().y$.Click,(()=>{}))}},921123:(e,t,n)=>{n.r(t),n.d(t,{archiveBoxFillIcon:()=>o,iconDefinition:()=>s});n(296540);const s={viewBox:"0 0 20 20",fittedViewBox:"3.12 3.12 13.75 13.75",svg:(0,n(474848).jsx)("path",{d:"M3.125 4.25c0-.621.504-1.125 1.125-1.125h11.5c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125H4.25A1.125 1.125 0 0 1 3.125 5.75zm1 3.875h11.75v7.625c0 .621-.504 1.125-1.125 1.125h-9.5a1.125 1.125 0 0 1-1.125-1.125zM8 9.875a.625.625 0 1 0 0 1.25h4a.625.625 0 1 0 0-1.25z"})},o=(0,n(340498).wt)("archiveBoxFill",s,"fill")},933117:(e,t,n)=>{n.d(t,{A:()=>m});n(944114),n(898992),n(803949),n(581454);var s=n(296540),o=()=>n(245720),i=()=>n(30537),a=()=>n(546926),r=()=>n(890492),c=()=>n(663639),l=()=>n(736847),d=()=>n(69708),u=()=>n(496603),p=()=>n(534177),g=n(474848);const m=function({renderOrigin:e,onClick:t,items:s,getKey:o,renderItem:i,selectedItem:r,onSelect:c,dontCloseParentOnSelect:l,menuTypeOverride:d,menuTitle:u,width:p,minWidth:m,disabled:h,originGap:y,buttonPopupStore:x,sameWidthAsOrigin:S}){const _=(0,n(590526).uB)(x,n(118307).A),j=d??(n(726637).A.isMobile?a().gu.Modal:a().gu.Popup);return(0,g.jsx)(n(250910).A,{popupType:f(j),bottomSheetInitialState:"half",renderOrigin:e,buttonPopupStore:_,placementToOrigin:"bottom",onClick:t,render:e=>(0,g.jsx)(v,{parent:e,items:s,getKey:o,renderItem:i,selectedItem:r,onSelect:c,dontCloseParentOnSelect:l,menuType:j,menuTitle:u,width:p,minWidth:m}),disabled:h,originGap:y,sameWidthAsOrigin:S})};function h(e,t,n,o,i,a,r,c){return{key:0,render:e=>(0,s.createElement)(l().A,{...e,key:t,topBorder:t>0}),items:e.map((e=>({key:o(e),render:t=>i({...t,value:e,key:o(e),selectedItem:a}),action:()=>{!function(e,t,n){t!==e&&n(e)}(e,a,r),c||n.close()}})))}}function v({parent:e,items:t,getKey:n,renderItem:s,selectedItem:i,onSelect:l,dontCloseParentOnSelect:m,menuType:v,menuTitle:f,width:y,minWidth:x}){const S=[];if(function(e){return e.length>0&&e[0]instanceof Array}(t))t.forEach(((t,o)=>{const a=h(t,o,e,n,s,i,l,m);S.push(a)}));else{const o=h(t,0,e,n,s,i,l,m);S.push(o)}const _=(0,g.jsx)(c().A,{type:c().O.Vertical,initialFocus:u().SL(u().Bq(t),(e=>u().n4(e,i))),sections:S});let j;switch(v){case a().gu.ActionSheet:j={menuType:a().gu.ActionSheet};break;case a().gu.Modal:j={menuType:a().gu.Modal,title:f,right:(0,g.jsx)(d().sA,{...o().W.done}),onClickRight:e.close};break;case a().gu.Popup:j={menuType:a().gu.Popup,width:y||160,minWidth:x};break;default:(0,p().HB)(v)}return(0,g.jsx)(r().A,{...j,children:_})}function f(e){switch(e){case a().gu.ActionSheet:return i().n.SlideUp;case a().gu.Modal:return i().n.BottomSheet;case a().gu.Popup:return i().n.Popup}}}}]);