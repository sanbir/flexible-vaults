"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[85160],{168345:(e,t,a)=>{a.d(t,{L:()=>i});a(296540);const s={viewBox:"0 0 20 20",fittedViewBox:"2.37 3.13 15.26 14.86",svg:(0,a(474848).jsx)("path",{d:"M15.5 3.13c1.174 0 2.125.951 2.125 2.125v7.5A2.125 2.125 0 0 1 15.5 14.88h-4.935l-3.871 2.978a.625.625 0 0 1-1.006-.496V14.88H4.5a2.125 2.125 0 0 1-2.125-2.125v-7.5c0-1.174.951-2.125 2.125-2.125zm.875 2.125a.875.875 0 0 0-.875-.875h-11a.875.875 0 0 0-.875.875v7.5c0 .483.392.875.875.875h1.813c.345 0 .625.28.625.625v1.838l3.033-2.334a.63.63 0 0 1 .381-.13H15.5a.875.875 0 0 0 .875-.874z"})},i=(0,a(340498).wt)("comment",s,"default")},196131:(e,t,a)=>{a.d(t,{C7:()=>r,CH:()=>n,JD:()=>i});a(898992),a(672577);var s=()=>a(842599);function i(e,t){return!!e&&r(e.getEmail(),t)}function r(e,t){return void 0!==n(e,t)}function n(e,t){if(!e)return;const a=(0,s().zN)(e);return t.find((e=>e.url===a))}},210198:(e,t,a)=>{a.d(t,{Z:()=>E,Y:()=>re});a(898992),a(354520),a(581454);var s=a(296540),i=()=>a(484714),r=()=>a(401497),n=()=>a(741615),o=()=>a(699143),l=()=>a(160432),u=()=>a(493552),d=()=>a(940148),c=()=>a(168345),g=()=>a(798880),p=()=>a(795523),m=()=>a(69708),f=()=>a(100622),v=()=>a(534177),_=()=>a(209660),y=()=>a(702723),b=()=>a(606273),h=()=>a(384100),S=()=>a(645109),x=()=>a(479314),q=()=>a(568688);var M=()=>a(920769),w=()=>a(827774),I=()=>a(6313),A=()=>a(599500),P=()=>a(920198),T=()=>a(590526),j=()=>a(394888),R=()=>a(849255),U=()=>a(227791),k=()=>a(89002),D=()=>a(31511),C=()=>a(631524),B=()=>a(979340),F=()=>a(453697),K=()=>a(264280),N=()=>a(898568),G=()=>a(543786),L=a(474848);function z({feature:e,request:t,userId:a,onDismiss:s}){const o=(0,m().tz)(),d=(0,P().L)(),c=(0,i().v3)(),v=(0,n()._3)({spaceId:null==d?void 0:d.id}),_=(0,r().IS)((()=>({fullWidth:{width:"100%",textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center"},cancelButton:{...K().W,height:32,color:f().Tj.text.secondary},input:{color:f().Tj.text.primary}})),[]),{userStore:y,userDisplayName:b}=(0,T().K8)((()=>{if(!d||!a)return{userStore:void 0,userDisplayName:void 0};const e=R().L.createChildStore(d,{table:g().oo,id:a});return{userStore:e,userDisplayName:e.getDisplayName(o)}}),[d,a,o]),{entrypoint:h}=t,S=(()=>{switch(h){case"ai_connectors_request_modal":return o.formatMessage(V.subtitleAiConnectorsModal);case"ai_for_work_announcement_modal":return o.formatMessage(V.subtitleAiForWorkModal);default:return o.formatMessage(V.subtitlePlans)}})(),x=(0,T().K8)((()=>p().N8(v)),[v]),q=(0,G().t)(),M=re(t.request,x,q);if(!M)return null;const w=(0,B().u2)({intl:o,product:t.request});return(0,L.jsx)(j().s,{ariaLabel:o.formatMessage(V.ariaLabel),isOpen:!0,onDismiss:s,showCloseIcon:!0,areaConstraint:{width:{type:"fixed",length:400},height:{type:"unlimited",scroll:"allow"}},render:()=>(0,L.jsx)(k().t,{showDismissButton:!1,header:(0,L.jsx)(N().rQ,{icon:(0,L.jsx)(F().A,{userStore:y,size:40}),title:o.formatMessage(V.title,{feature:w,user:b}),byline:S}),footer:(0,L.jsx)(U().Y,{gap:16,children:(0,L.jsxs)(U().Y,{gap:8,children:[(0,L.jsx)(l().A,{colorPalette:"blue","aria-label":o.formatMessage(M),onClick:async()=>{await(0,I().F)({environment:c,spaceStore:d,billingData:v,product:t.request,from:"upgrade_requests_page"}),s()},style:{height:32},children:o.formatMessage(M)}),(0,L.jsx)("div",{style:{textAlign:"center"},children:(0,L.jsx)(u().D,{styleKey:"captionRegular",colorVariant:"secondary",children:o.formatMessage(V.billingNotice)})}),(0,L.jsx)(C().p,{size:"lg",onClick:s,style:{..._.fullWidth,..._.cancelButton},"aria-label":o.formatMessage(V.cancelButton),children:o.formatMessage(V.cancelButton)})]})}),children:(0,L.jsxs)(U().Y,{gap:8,children:[(0,L.jsx)(u().D,{styleKey:"captionMedium",colorVariant:"secondary",children:o.formatMessage(V.noteLabel)}),(0,L.jsxs)(U().Y,{style:{position:"relative"},gap:8,children:[(0,L.jsx)(D().A,{disabled:!0,format:"large",value:t.reason_for_request,inputStyle:{..._.input,paddingBottom:24},textarea:!0,autosize:!0}),(0,L.jsx)(u().D,{styleKey:"captionRegular",colorVariant:"secondary",style:{position:"absolute",bottom:8,insetInlineStart:8},children:o.formatDate(t.created_time,{year:"numeric",month:"long",day:"numeric"})})]})]})})})}const V=(0,m().YK)({cancelButton:{id:"viewUpgradeRequestModal.cancelButton",defaultMessage:"Cancel"},billingNotice:{id:"viewUpgradeRequestModal.billingNotice",defaultMessage:"You’ll be able to confirm the updated bill on the next step"},subtitlePlans:{id:"viewUpgradeRequestModal.subtitlePlans",defaultMessage:"This request was made from the Plans page"},subtitleAiConnectorsModal:{id:"viewUpgradeRequestModal.subtitleAiConnectorsModal",defaultMessage:"This request was made from AI Connector onboarding."},subtitleAiForWorkModal:{id:"viewUpgradeRequestModal.subtitleAiForWorkModal",defaultMessage:"This request was made from the AI for Work announcement."},title:{id:"viewUpgradeRequestModal.title",defaultMessage:"{user} would like access to Notion {feature}"},ariaLabel:{id:"viewUpgradeRequestModal.modal.ariaLabel",defaultMessage:"View plan request modal"},noteLabel:{id:"viewUpgradeRequestModal.noteLabel",defaultMessage:"Note"}});var W=()=>a(807449),H=()=>a(406094);function Y({title:e,loadedIconFunction:t,buttonAction:a,buttonText:s,buttonAriaLabel:i}){return(0,L.jsxs)(o().Y1,{gap:16,align:"center",direction:"vertical",padding:"32px 0 88px 0",height:"fill",children:[(0,L.jsx)(W().I,{icon:t,size:"xl",colorVariant:"tertiary"}),(0,L.jsx)(u().D,{style:{textAlign:"center"},styleKey:"bodyRegular",colorVariant:"secondary",children:e}),(0,L.jsx)(H().A,{size:"lg",onClick:a,ariaLabel:i,children:(0,L.jsx)(u().D,{style:{textAlign:"center"},styleKey:"bodyMedium",children:s})})]})}var O=()=>a(383716);function E({spaceStore:e}){const t=(0,m().tz)(),{setPage:a,isSalesEligible:i}=(0,s.useContext)(x().K),{requests:r,isLoading:n}=(0,q().I)({spaceId:e.id});if(n)return null;const l=Object.keys(r).length,u=1===l,d=0===l;return(0,L.jsxs)(o().Y1,{height:"fill",direction:"vertical",gap:32,padding:"36px 60px",style:{overflowY:"auto"},children:[(0,L.jsx)(O().n,{title:t.formatMessage(ne.title),goBack:()=>a("home")}),d?(0,L.jsx)(Y,{title:t.formatMessage(ne.noRequestsTitle),buttonAriaLabel:"explore plans",buttonText:t.formatMessage(ne.noRequestsButtonTitle),buttonAction:()=>{_().Ow({currentTab:"plans"})},loadedIconFunction:c().L}):(0,v().WP)(r).map((([t,a])=>a?(0,L.jsx)($,{expandByDefault:!0,hasOneRequestType:u,requestType:t,requests:a,spaceStore:e,isSalesEligible:i},t):null))]})}function $({expandByDefault:e=!1,requestType:t,requests:a,spaceStore:r,isSalesEligible:u,hasOneRequestType:d}){const c=(0,i().v3)(),g=(0,n()._3)({spaceId:r.id}),[f,v]=s.useState(e),_=(0,m().tz)(),b=p().N8(g),h=re(t,b,u),x=async()=>{await(0,I().F)({environment:c,spaceStore:r,billingData:g,product:t,from:"upgrade_requests_page"})},q=(0,M().O)(),P="business"===t,T=P&&q,j=p().TB(g)&&"business"===p().AI(g),{showTrialInfoModal:R}=(0,w().C)();return(0,L.jsxs)("div",{children:[(0,L.jsx)(y().A,{spaceStore:r,title:(0,L.jsx)(J,{requestType:t,requestCount:a.length,isExpanded:f,handleClick:()=>{v(!f)},shouldHideToggle:d}),type:"custom",disableSettingsItemClick:!0,badge:P&&j?(0,L.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,L.jsx)(A().g,{showIcon:!1,onClick:()=>R({openedFrom:"upgrade_requests_page"}),trialProducts:p().N(g)})}):void 0,customButton:h&&(0,L.jsxs)(o().Y1,{direction:"horizontal",gap:8,align:"center-right",children:[T?(0,L.jsx)(S().c,{openedFrom:"upgrade_requests_page",onClick:x,styleOverrides:{flex:"none",height:28,padding:"4px 8px"}}):void 0,(0,L.jsx)(l().A,{colorPalette:"blue",onClick:x,children:_.formatMessage(h)})]})}),f?(0,L.jsx)(ie,{spaceStore:r,requests:a}):void 0]})}function J({handleClick:e,isExpanded:t,requestType:a,requestCount:s,shouldHideToggle:i}){const n=(0,m().tz)(),l=function(e){switch(e){case"ai":return ne.ai;case"business":return ne.business;case"enterprise":return ne.enterprise;case"ai_credit_pack":return ne.ai_credit_pack;default:(0,v().HB)(e)}}(a),d=(0,r().IS)((()=>({toggleButton:{color:f().Tj.icon.primary}})),[]);return(0,L.jsxs)(o().Y1,{direction:"horizontal",gap:6,align:"center-left",width:"hug",padding:"0px 6px 0px 0px",children:[i?void 0:(0,L.jsx)(b().f,{isSidebar:!1,fill:!0,onClick:()=>{e()},open:t,color:d.toggleButton.color}),l?(0,L.jsx)(u().D,{styleKey:"bodyMedium",colorVariant:"primary",children:n.formatMessage(l)}):void 0,(0,L.jsx)(u().D,{styleKey:"bodyRegular",colorVariant:"secondary",children:s})]})}const Q={id:"note",headerTitle:(0,L.jsx)(m().sA,{id:"RequestsSettingsPage.UpgradesPage.noteColumn",defaultMessage:"Note"}),renderCell:({value:e})=>(0,L.jsx)(Z,{value:e}),sortable:!1,widthData:{minWidth:150,maxWidth:310,widthPercent:37}};function Z(e){const t=e.value.reason_for_request??"—",a=(0,r().IS)((()=>({container:{width:"100%"},textWithEllipsis:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}})),[]);return(0,L.jsx)("div",{style:a.container,children:(0,L.jsx)(u().D,{style:a.textWithEllipsis,styleKey:"bodyRegular",children:t})})}function X({value:e,isRowHovered:t}){const i=(0,m().tz)(),[n,l]=s.useState(!1),[u,d]=s.useState(null),c=(0,r().IS)((()=>({icon:{height:14,width:14,color:f().Tj.icon.secondary}})),[]),g=i.formatMessage({id:"RequestsSettingsPage.UpgradesPage.viewDetail",defaultMessage:"View Detail"});return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(o().Y1,{direction:"horizontal",width:"fill",gap:"auto",align:"center",children:t?(0,L.jsx)(a(26697).m,{placement:"top",renderTooltip:()=>g,render:t=>(0,L.jsx)(a(695115).A,{ariaLabel:g,hasBackground:!0,icon:a(8741).arrowDiagonalUpRightSmallIcon,showShadow:!0,iconStyle:c.icon,onClick:t=>{d(e),l(!0),t.stopPropagation()},...t})}):void 0}),n&&u?(0,L.jsx)(z,{feature:u.request,request:u,userId:u.created_by_id,onDismiss:()=>l(!1)}):void 0]})}const ee={id:"date",headerTitle:(0,L.jsx)(m().sA,{id:"RequestsSettingsPage.UpgradesPage.dateColumn",defaultMessage:"Date"}),renderCell:({value:e})=>(0,L.jsx)(a(625383).d,{dateTs:e.created_time}),sortable:!1,widthData:{minWidth:150,maxWidth:240,widthPercent:24}},te={id:"dateWithViewDetail",headerTitle:"",renderCell:({value:e,isRowHovered:t})=>(0,L.jsx)(X,{value:e,isRowHovered:t}),sortable:!1,widthData:{minWidth:100,maxWidth:100,widthPercent:6}},ae=[{id:"requestedBy",headerTitle:(0,L.jsx)(m().sA,{id:"RequestsSettingsPage.UpgradesPage.requestedByColumn",defaultMessage:"Requested By"}),renderCell:({userStore:e})=>(0,L.jsx)(a(317131).l,{customAvatarStyles:{marginInlineEnd:8},userStores:[e]}),sortable:!1,widthData:{minWidth:150,maxWidth:240,widthPercent:30}},Q,ee,te],se=8;function ie({requests:e,spaceStore:t}){const[a,i]=s.useState(!1),[n,o]=s.useState(null),{header:l}=(0,r().IS)((()=>({header:{boxShadow:`inset 0 -1px 0 ${f().Tj.border.primary}`}})),[]),u=ae.map((e=>({...e,headerStyle:l}))),c=(0,r().IS)((()=>{const e=(0,d().rC)({columnRenderInfo:u,containerMarginTop:8});return{...e,container:{...e.container,width:"100%"}}}),[u]),p=e.map((e=>{if(e.created_by_table!==g().oo)return;return{value:e,userStore:(0,h().z)({userId:e.created_by_id,spaceStore:t}),id:e.id,isClickable:!0}})).filter(v().O9),{pageRows:m,loadMoreMethod:_}=function({rows:e,limit:t}){const[a,i]=(0,s.useState)(t),[r,n]=(0,s.useState)(0),o=e.length,l=o>t;return{pageRows:(0,s.useMemo)((()=>l?e.slice(r,a):e),[e,r,a,l]),loadMoreMethod:(0,s.useMemo)((()=>{if(l)return{type:"pages",onLoadNext:()=>{if(a>=o)return;const e=Math.min(a+t,o);i(e),n(r+t)},onLoadPrevious:()=>{0!==r&&(i(r),n(r-t))},hasNextPage:a<o,hasPrevPage:r>0,currentPage:Math.floor(r/t)+1,finalPage:Math.floor(o/t)+1}}),[o,r,a,t,l])}}({rows:p,limit:se});return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(d().WE,{columnRenderInfo:u,rows:m,hideHeaderRowPadding:!0,renderNoRowsComponent:()=>null,styles:c,loadMoreMethod:_,onRowClick:e=>{o(e.value),i(!0)},showRowBorders:!0}),a&&n?(0,L.jsx)(z,{feature:n.request,request:n,userId:n.created_by_id,onDismiss:()=>i(!1)}):void 0]})}function re(e,t,a){if(t||a&&"enterprise"===e)return ne.contactSales;switch(e){case"ai":return ne.aiUpgrade;case"business":case"enterprise":return ne.planUpgrade;case"ai_credit_pack":return ne.creditPacksPurchase;default:(0,v().HB)(e)}}const ne=(0,m().YK)({title:{id:"RequestsSettingPage.UpgradePage.title",defaultMessage:"Upgrades"},aiUpgrade:{id:"RequestsSettingsPage.UpgradesPage.aiUpgrade",defaultMessage:"Upgrade AI"},creditPacksPurchase:{id:"RequestsSettingsPage.UpgradesPage.creditPacksPurchase",defaultMessage:"Add AI Credits"},planUpgrade:{id:"RequestsSettingsPage.UpgradesPage.planUpgrade",defaultMessage:"Upgrade Plan"},contactSales:{id:"RequestsSettingsPage.UpgradesPage.contactSales",defaultMessage:"Contact Sales"},ai:{id:"RequestsSettingsPage.UpgradesPage.notionAI",defaultMessage:"Notion AI"},business:{id:"RequestsSettingsPage.UpgradesPage.business",defaultMessage:"Business"},enterprise:{id:"RequestsSettingsPage.UpgradesPage.enterprise",defaultMessage:"Enterprise"},ai_credit_pack:{id:"RequestsSettingsPage.UpgradesPage.aiCreditPack",defaultMessage:"AI Credits"},noRequestsTitle:{id:"RequestsSettingsPage.UpgradesPage.NoPendingRequestsTitle",defaultMessage:"No upgrade requests in your workspace"},noRequestsButtonTitle:{id:"RequestsSettingsPage.UpgradesPage.NoPendingRequestsButtonTitle",defaultMessage:"Explore plans"}})},350648:(e,t,a)=>{a.d(t,{D2:()=>M,Ip:()=>S,Jk:()=>x,YT:()=>q,e2:()=>b,g:()=>h});a(517642),a(658004),a(733853),a(845876),a(432475),a(515024),a(731698),a(898992),a(354520);var s=()=>a(907258),i=()=>a(929219),r=()=>a(675133),n=()=>a(128933),o=()=>a(584262),l=()=>a(798880),u=()=>a(946141),d=()=>a(769864),c=()=>a(384944),g=()=>a(117484),p=()=>a(254600),m=()=>a(406767),f=()=>a(547149),v=()=>a(465960),_=()=>a(51781);const y=(0,a(69708).YK)({joinTeamSuccessMessage:{id:"teamInviteLinkActions.joinTeam.confirmationMessage",defaultMessage:"Joined {teamName}"},requestTeamSuccessMessage:{id:"teamInviteLinkActions.requestAccess.successMessage",defaultMessage:"Successfully requested membership"},requestTeamFailureMessage:{id:"teamInviteLinkActions.requestAccess.failureMessage",defaultMessage:"Failed to request membership"}});async function b({environment:e,userId:t,teamStore:a,user:s}){const i=a.getSpaceId();if(!i)return;await v().rU({environment:e,teamId:a.id,spaceId:i,teamUserInfo:s,isSettingDefaultTeam:!1,inviterId:t})&&(u().vo(e,{store:a,joined_role:"member",from:"team_invite_link"}),await h({environment:e,userId:t,teamStore:a}),n().D6({label:r().A.formatMessage(y.joinTeamSuccessMessage,{teamName:a.getName()})}))}async function h({environment:e,userId:t,teamStore:a}){const r=s().default.state.currentUserRootStore,n=a.getSpaceId();if(!n||!r)return;const l=r.getSpaceViewStores().filter((e=>e.getSpaceId()===n))[0];await(0,p().t)({environment:e,spaceViewStore:l,userSettingsStore:void 0,userRootStore:r,pageVisitSource:o().y8.JoinTeam,navigationType:"switchingToOrLoadingSpace"}),(0,_().fetchUnfetchedTeamsFromLocalStorage)();i().A.state.online&&(0,_().fetchUnfetchedTeams)({userId:t,spaceId:n,teamTypes:new Set(["Joined"]),environment:e}),v().L0({environment:e,teamStore:a,shouldScroll:!0})}async function S({environment:e,teamId:t,message:a}){if(!e.currentUser.id)return;"success"===(await d().callApi({eventName:"requestAccess",environment:e,data:{type:"current-actor-to-team",teamId:t,message:a}})).type?(u().XQ(e,{teamId:t}),await q({environment:e}),new Promise((e=>setTimeout(e,500))).then((()=>{n().D6({label:r().A.formatMessage(y.requestTeamSuccessMessage)})}))):n().D6({label:r().A.formatMessage(y.requestTeamFailureMessage)})}async function x({environment:e,teamStore:t,accessRequestStore:a,status:s}){const i=a.getForActorId();if(!i)return;const r=a.getRecordModel({table:l().oo,id:i});if(r){if("approved"===s){const a=[{type:"member",entity_type:"user",user_id:r.id}];if(!(await v().Zd({environment:e,teamStore:t,teamMemberInfos:a,isSettingDefaultTeam:!1,createNewTeamFlowId:void 0})))return}f().createAndCommit({userAction:"GrantAccessActivityAction.handleGrantAccess",environment:e,canUndo:!0,perform:t=>{c().zv({store:a,transaction:t,data:{resolved_time:Date.now(),resolved_by_table:l().oo,resolved_by_id:e.currentUser.id,status:s}})}}),u().GW(e,{store:t,resolution:s})}}async function q({environment:e}){const{lastVisitedSpaceView:t,userRootStore:a,userSettingsStore:s}=await(0,m().e)({environment:e,disableRedirectUrl:!1});t?await(0,p().t)({environment:e,spaceViewStore:t,userRootStore:a,userSettingsStore:s,pageVisitSource:o().y8.BackForward,navigationType:"switchingToOrLoadingSpace"}):await(0,g().t)({environment:e,userRootStore:a,userSettingsStore:s,pageVisitSource:o().y8.BackForward})}async function M({environment:e,teamId:t}){const a=await d().callApi({eventName:"getTeamAccessRequestMetadata",environment:e,data:{teamId:t}});if("success"===a.type)return a.data}},383716:(e,t,a)=>{a.d(t,{n:()=>c});a(296540);var s=()=>a(726637),i=()=>a(699143),r=()=>a(695115),n=()=>a(879765),o=()=>a(69708),l=()=>a(284371),u=()=>a(8178),d=a(474848);function c(e){const t=(0,o().tz)(),{title:a,goBack:c}=e;return(0,d.jsxs)(i().Y1,{direction:"horizontal",gap:6,children:[c?(0,d.jsx)(r().A,{ariaLabel:t.formatMessage({id:"requestsPageHeader.back",defaultMessage:"Back"}),icon:n().$,onClick:c}):void 0,(0,d.jsx)(u().A,{large:!s().A.isMobile,divider:"none",fontSize:16,fontWeight:l().Wy.medium,style:{marginBottom:0},children:a})]})}},479314:(e,t,a)=>{a.d(t,{K:()=>i});const s={currentPage:"home",setPage:()=>{},isSalesEligible:!1},i=(0,a(296540).createContext)(s);i.displayName="RequestsSettingsPageContext"},529601:(e,t,a)=>{a.d(t,{$S:()=>g,Im:()=>p,SJ:()=>y,VH:()=>v,bb:()=>c,sf:()=>b,yQ:()=>_});a(898992),a(354520),a(581454),a(737550);var s=()=>a(496603),i=()=>a(534177),r=()=>a(842599),n=()=>a(289106),o=()=>a(259524),l=()=>a(743246),u=()=>a(176581),d=()=>a(196131);function c(e){return"member"!==(null==e?void 0:e.currentRole)&&"restricted_member"!==(null==e?void 0:e.currentRole)}function g({space:e,domains:t,team:a,spaceUser:r,invitees:n,internalGuestFeatureAvailability:o,guestFeatureAvailability:l,publicPageDataGuestSetting:u,experimentService:d,shareTarget:c}){const g=p({domains:t,internalGuestFeatureAvailability:o,guestFeatureAvailability:l,invitees:n,space:e,spaceUser:r,team:a,publicPageDataGuestSetting:u}),m=f({domains:t,internalGuestFeatureAvailability:o,guestFeatureAvailability:l,invitees:n,space:e,spaceUser:r,team:a,publicPageDataGuestSetting:u}),_=function({team:e,space:t,spaceUser:a,invitees:i,shareTarget:r,experimentService:n}){const o=v({team:e,space:t,spaceUser:a,shareTarget:r,experimentService:n});return(0,s().Cr)(i.map((e=>[e.email,o])))}({invitees:n,team:a,space:e,spaceUser:r,shareTarget:c,experimentService:d}),y=n.some((e=>{const t=m[e.email],a=g[e.email];return"can_autojoin"!==t.type&&h(a)}));return(0,s().Cr)(n.map((e=>{const{email:t,currentRole:a}=e,s=m[t],r=_[t],n=g[t];if("member"===a)return[t,{type:"member_page_add"}];if("guest"===a&&"can_add"===n.type)return[t,{type:"guest_page_add"}];if("restricted_member"===a)return"can_add"===r.type?[t,{type:"member_page_add"}]:"can_request"===r.type?[t,{type:"restricted_member_request"}]:[t,{type:"none",reason:r.reason}];if("can_autojoin"===s.type)return[t,{type:"member",reason:"autojoin_domain"}];if("cannot_add"===(o=g[t]).type&&"over_general_guest_limit"===o.reason)return[t,{type:"none",reason:"must_upgrade"}];if("can_add"===s.type&&y)return[t,{type:"member",reason:"over_internal_guest_limit"}];if("can_add"===n.type)return[t,{type:"guest"}];if("can_request"===n.type)return[t,{type:"guest_request"}];if("can_add"===s.type)return[t,{type:"member",reason:"guests_disabled"}];if("can_request"===s.type)return[t,{type:"member_request"}];if("cannot_add"===s.type&&"not_authorized_domain"===s.reason)return[t,{type:"none",reason:"not_authorized_domain"}];if("cannot_add"===n.type){return[t,{type:"none",reason:n.reason}]}if("cannot_add"===s.type){return[t,{type:"none",reason:s.reason}]}return(0,i().HB)(s)&&(0,i().HB)(n);var o})))}function p({space:e,domains:t,team:a,internalGuestFeatureAvailability:i,guestFeatureAvailability:r,optimism:n="pessimistic",spaceUser:o,invitees:l,publicPageDataGuestSetting:u}){const c=_({space:e,team:a,spaceUser:o,publicPageDataGuestSetting:u}),g=m(n,r,b(l)),p=function(e,t){return e.filter((e=>(0,d().C7)(e.email,t)&&!e.currentRole)).length}(l,t),f=m(n,i,p);return(0,s().Cr)(l.map((e=>{const a=(0,d().C7)(e.email,t),s=void 0!==e.currentRole;let i;return i=s||g?!a||s||f?"cannot_add"===c.type?{type:"cannot_add",reason:"disabled_by_admins"}:c:{type:"cannot_add",reason:"over_internal_guest_limit"}:{type:"cannot_add",reason:"over_general_guest_limit"},[e.email,i]})))}function m(e,t,a){const s=t.limit,i="unlimited"===s.total?"unlimited":s.total-s.current;return"optimistic"===e?"unlimited"===i||i>=1:"unlimited"===i||i>=a}function f({space:e,team:t,domains:a,spaceUser:n,invitees:o,internalGuestFeatureAvailability:l,guestFeatureAvailability:u,publicPageDataGuestSetting:d}){const c=y({space:e,domains:a,spaceUser:n}),g=p({space:e,domains:a,internalGuestFeatureAvailability:l,guestFeatureAvailability:u,team:t,spaceUser:n,invitees:o,publicPageDataGuestSetting:d}),m=!n.isMember();return(0,s().Cr)(o.map((e=>{const t=(0,r().zN)(e.email);if(!t)return[e.email,{type:"cannot_add",reason:"invalid_email"}];const a=h(g[e.email]),s=c.autojoinDomains;let n;return s.includes(t)?n={type:"can_autojoin"}:"can_add"===c.type?n={type:"can_add"}:"can_request"===c.type||a&&!m?n={type:"can_request"}:s.length>0?n={type:"cannot_add",reason:"not_authorized_domain"}:"cannot_add"===c.type?n={type:"cannot_add",reason:"disabled_by_admins"}:(0,i().HB)(c),[e.email,n]})))}function v({team:e,space:t,spaceUser:a,shareTarget:s,experimentService:i}){var r;if(s===l().C0)return{type:"cannot_add",reason:"no_restricted_members_for_workflows"};return i.checkGate({gateName:"teamspaces_disable_restricted_members_setting",actor:n().S,customIDs:{spaceId:t.id}})&&(null==e?void 0:e.getDisableRestrictedMembers())?{type:"cannot_add",reason:"restricted_members_disabled_by_admins"}:(0,o().uS)({roleThatCanAddRestrictedMembersToPages:null===(r=t.getSettings())||void 0===r?void 0:r.roles_that_can_add_restricted_members_to_pages,spaceUser:a})}function _({space:e,team:t,spaceUser:a,publicPageDataGuestSetting:s}){const r=a.isWorkspaceOwner(),n=(0,i().O9)(s)?s:(0,u().v)({space:e,team:t});return r&&"can_request"===n.type?{type:"can_add"}:n}function y({space:e,domains:t,spaceUser:a}){const s=!a.isMember(),i=function({space:e,domains:t}){const a=t.filter((e=>e.isAutojoinable)).map((e=>e.url));return e.getSettings().disable_membership_requests?{type:"cannot_add",autojoinDomains:a}:{type:"can_request",autojoinDomains:a}}({space:e,domains:t});return s?{type:"cannot_add",autojoinDomains:[]}:a.isWorkspaceOwner()?{...i,type:"can_add"}:i}function b(e){return e.filter((e=>!e.currentRole)).length}function h(e){return"cannot_add"===e.type&&"over_internal_guest_limit"===e.reason}},543786:(e,t,a)=>{a.d(t,{t:()=>u});var s=()=>a(920198),i=()=>a(484714),r=()=>a(590526),n=()=>a(741615),o=()=>a(495106),l=()=>a(946473);function u(){const e=(0,i().v3)(),t=(0,s().L)(),a=(0,n().lh)({spaceId:null==t?void 0:t.id}),u=(0,r().K8)((()=>o().T.getData(e,{userId:e.currentUser.id||""})),[e]);return(0,r().K8)((()=>(0,l().q)(u,t,a)),[u,t,a])}},616092:(e,t,a)=>{a.d(t,{Hq:()=>g,kK:()=>f,mF:()=>c});var s=()=>a(242422),i=()=>a(484714),r=()=>a(590526),n=()=>a(613848),o=()=>a(529601),l=()=>a(366858),u=()=>a(940241),d=()=>a(528093);function c({space:e,team:t,spaceUser:a,invitees:i,store:n}){const c=(0,r().K8)((()=>null==a?void 0:a.getUserId()),[a]),g=(0,d()._)({name:"internal_guests",spaceId:null==e?void 0:e.id,userId:c,amount:0}),v=(0,d()._)({name:"guests",spaceId:null==e?void 0:e.id,userId:c,amount:0}),_=(0,u().o)({store:n}),y=p(e),b=m(a),h=f(b,t),S=(0,l().A)(e);return(0,r().K8)((()=>{if(y&&b&&v&&g&&S)return(0,o().$S)({space:y,domains:S,team:h,spaceUser:b,invitees:i,internalGuestFeatureAvailability:g,guestFeatureAvailability:v,publicPageDataGuestSetting:_,experimentService:s().default,shareTarget:n.table})}),[y,h,g,v,b,i,S,_,n])}function g({space:e,team:t,spaceUser:a,invitees:s,optimism:i="pessimistic",publicPageDataGuestSetting:n}){const u=(0,r().K8)((()=>null==a?void 0:a.getUserId()),[a]),c=(0,d()._)({name:"internal_guests",spaceId:null==e?void 0:e.id,userId:u,amount:0}),g=(0,d()._)({name:"guests",spaceId:null==e?void 0:e.id,userId:u,amount:0}),v=p(e),_=m(a),y=f(_,t),b=(0,l().A)(e);return(0,r().K8)((()=>{if(v&&_&&g&&c&&b)return(0,o().Im)({space:v,domains:b,team:y,spaceUser:_,invitees:s,optimism:i,guestFeatureAvailability:g,internalGuestFeatureAvailability:c,publicPageDataGuestSetting:n})}),[v,_,b,y,s,g,c,i,n])}function p(e){const t=(0,i().v3)(),a=(0,r().K8)((()=>null==e?void 0:e.getModel()),[e]),s=(0,r().K8)((()=>{if(null==e||!e.id)return;const a=n().A.getData(t,{spaceId:e.id,userId:t.currentUser.id});return a?{id:a.id,disable_guests:a.disableGuests,getSettings:()=>({disable_membership_requests:!1,enable_guest_invite_requests:a.enableGuestInviteRequest})}:void 0}),[e,t]);return a??s}function m(e){return(0,r().K8)((()=>null==e?void 0:e.getModel()),[e])??{isMember:()=>!1,isWorkspaceOwner:()=>!1}}function f(e,t){const a=(0,r().K8)((()=>null==t?void 0:t.getModel()),[t]);return(0,r().K8)((()=>null==e?void 0:e.isMember()),[e])?a:{getDisableGuests:()=>!1,getDisableRestrictedMembers:()=>!1}}},645109:(e,t,a)=>{a.d(t,{c:()=>c});var s=a(296540),i=()=>a(401497),r=()=>a(86269),n=()=>a(406094),o=()=>a(29182),l=()=>a(69708),u=()=>a(261505),d=a(474848);function c({openedFrom:e,styleOverrides:t}){const{animationState:a,animationTriggers:c}=(0,r().lP)(),p=(0,s.useMemo)((()=>{switch(e){case"business_trial_verify_pages_upsell":return"pageVerification";case"business_trial_private_teamspaces_upsell":return"privateTeamspaces";case"business_trial_ai_connectors_upsell":return"aiConnectors";case"upgrade_requests_page":return"free";default:return"blank"}}),[e]),m=(0,i().IS)((()=>({button:{display:"flex",alignItems:"center",flex:1}})),[]);return(0,d.jsx)(n().A,{...c,size:"lg",iconLeading:{type:"animated",icon:o().P,colorPalette:"orange",colorVariant:"accentPrimary",size:"sm",animationState:a},style:{...m.button,...t},onClick:()=>{(0,u().openBusinessTrialStartModal)({openedFrom:e})},children:(0,d.jsx)(l().sA,{...g[p]})})}const g=(0,l().YK)({blank:{id:"selfServeBusinessTrial.tryButton.blank",defaultMessage:"Try"},privateTeamspaces:{id:"selfServeBusinessTrial.tryButton.privateTeamspaces",defaultMessage:"Try for free"},aiConnectors:{id:"selfServeBusinessTrial.tryButton.connectors",defaultMessage:"Try connectors"},pageVerification:{id:"selfServeBusinessTrial.tryButton.pageVerification",defaultMessage:"Try for free"},free:{id:"selfServeBusinessTrial.tryButton.free",defaultMessage:"Try for free"}})},692026:(e,t,a)=>{a.d(t,{C:()=>i});var s=()=>a(534177);function i(e){return e.isGuestInviteRequest()?"guest_invite_request":e.isRestrictedMemberInviteRequest()?"restricted_member_invite_request":e.isPageAccessRequest()?"page_access_request":e.isSpaceMembershipRequest()?"space_membership_request":e.isTeamMembershipRequest()?"team_membership_request":void(0,s().HB)(e)}},773442:(e,t,a)=>{a.d(t,{I:()=>c,T:()=>g});a(18107),a(967357),a(581454);var s=()=>a(230711),i=()=>a(484714),r=()=>a(590526),n=()=>a(849255),o=()=>a(692026),l=()=>a(798880),u=()=>a(496603),d=()=>a(616092);function c({spaceStore:e,request:t}){var a;const s=(0,i().v3)(),o=(0,r().K8)((()=>{if(t)return new(n().L)(s,{id:t.getForActorId(),table:l().oo}).getModel()}),[t,s]),d=t&&o?{accessRequest:t,forActor:o}:void 0;return null===(a=g({spaceStore:e,requests:(0,u().oE)([d])}))||void 0===a?void 0:a.at(0)}function g({spaceStore:e,requests:t}){const a=function({spaceStore:e,requests:t}){const a=(0,i().v3)(),n=(0,r().K8)((()=>null==t?void 0:t.map((t=>{const a=(0,s().dp)(e,t.forActor.id);return{email:t.forActor.email,currentRole:a.isPageGuest()?"guest":a.isMember()?"member":void 0}}))),[t,e]),o=a.currentUser.id,l=o?(0,s().dp)(e,o):void 0;return(0,d().Hq)({space:e,spaceUser:l,team:void 0,optimism:"optimistic",invitees:n??[],publicPageDataGuestSetting:void 0})}({spaceStore:e,requests:t});return(0,r().K8)((()=>null==t?void 0:t.map((e=>{var t;const s=(0,o().C)(e.accessRequest),i=null==a||null===(t=a[e.forActor.email])||void 0===t?void 0:t.type;return"guest_invite_request"!==s?s:"cannot_add"===i?"space_membership_request":"guest_invite_request"}))),[t,a])}},920769:(e,t,a)=>{a.d(t,{O:()=>n});var s=()=>a(590526),i=()=>a(187623),r=()=>a(141273);function n(){const e=(0,r().g)("stacked_business_trial"),t=(0,r().g)("business_reverse"),a=(0,r().g)("stacked_business_trial_14d"),n=(0,r().g)("business_reverse_14d"),o=(0,r().g)("mwn_stacked_business_trial_14d"),l=(0,r().g)("mwn_business_reverse_14d");return!(0,s().K8)((()=>(0,i().A)()),[])&&(e||t||a||n||o||l)}},940241:(e,t,a)=>{a.d(t,{o:()=>d});var s=()=>a(242422),i=()=>a(484714),r=()=>a(590526),n=()=>a(267956),o=()=>a(519831),l=()=>a(743246);const u=new(a(62175).U)(((e,t)=>{if("block-space"===t.type)return`${t.type}-${t.blockId}-${t.spaceId}`;(0,a(534177).HB)(t.type)}),(async(e,t)=>{const s=(0,a(785728).WS)({spaceId:t.spaceId,recordId:t.blockId,verifyShortSpaceIdVersion:!0}),i=await e.api.callApi({eventName:"getPublicPageData",environment:e,data:t,headers:s});return"success"===i.type?i.data:void 0}));function d(e){const{store:t}=e,a=(0,i().v3)();return(0,r().K8)((()=>{if(!s().default.checkGate({gateName:"ui_guest_disable_changes"}))return;if(t.table===o().Vl||t.table===l().C0)return{type:"cannot_add"};const e=t.id,i=t.getSpaceId(),r=n().A.state.publicPageData;var d;if((null==r?void 0:r.pageId)===e)return(null==r||null===(d=r.securitySettings)||void 0===d?void 0:d.guestSetting)??{type:"can_add"};{var c;const t=u.getData(a,{type:"block-space",blockId:e,spaceId:i});return(null==t||null===(c=t.securitySettings)||void 0===c?void 0:c.guestSetting)??{type:"can_add"}}}),[t,a])}}}]);