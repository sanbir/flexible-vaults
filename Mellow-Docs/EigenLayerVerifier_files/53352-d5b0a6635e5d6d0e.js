"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[53352],{34423:(e,t,a)=>{a.d(t,{T:()=>y});var r=a(296540),o=()=>a(484714),n=()=>a(590526),i=()=>a(62371),s=()=>a(748054),l=()=>a(69708),u=()=>a(896628),d=()=>a(908201),c=()=>a(547149),g=()=>a(828973),p=a(474848);function y({groupBy:e}){const t=(0,o().v3)(),a=(0,d().ET)(),{viewType:y,startWeekOn:m}=(0,n().K8)((()=>{const e=a.normalizedFormatStore.state;return{viewType:a.getViewType(),startWeekOn:(null==e?void 0:e.start_week_on)??0}}),[a]),h=(0,r.useCallback)((e=>{c().createAndCommit({userAction:"CollectionSettingsViewGroup.handleStartWeekOnChange",environment:t,canUndo:!0,perform:t=>{const r=a.collectionViewStore();r&&u().zA({stores:[r],update:{start_week_on:e},transaction:t})}})}),[t,a]);if(!(0,i().Ik)(e)&&"formula"!==e.type)return null;if((0,i().Ik)(e)&&"week"!==e.groupBy)return null;if("formula"===e.type){const t=e.groupBy;if(!(0,i().Ik)(t))return null;if("week"!==t.groupBy)return null}return(0,p.jsx)(g().A,{title:(0,p.jsx)(l().sA,{id:"database.viewSettings.groupTab.startWeekOn",defaultMessage:"Start week on"}),popupStyle:{minWidth:190},selectedKey:m,onChange:h,icon:"chart"===y?s().M:void 0,options:[{key:0,type:"button",title:(0,p.jsx)(l().sA,{id:"database.viewSettings.groupTab.startWeekOn.sunday",defaultMessage:"Sunday"})},{key:1,type:"button",title:(0,p.jsx)(l().sA,{id:"database.viewSettings.groupTab.startWeekOn.monday",defaultMessage:"Monday"})}]})}},110731:(e,t,a)=>{a.d(t,{b:()=>r});a(898992),a(672577);function r(e){var t,a;const{viewModule:r,dashboardViewStore:o}=(null===(t=e.dashboardWidgetStore)||void 0===t?void 0:t.state)??{};if(r)return null==o||null===(a=o.getDashboardLayoutStore())||void 0===a||null===(a=a.getDashboardModules())||void 0===a?void 0:a.find((e=>e.modules.find((e=>e.id===r.id))))}},154378:(e,t,a)=>{a.d(t,{_G:()=>X,$k:()=>K,w$:()=>U,H$:()=>E,l9:()=>q,NH:()=>W,jY:()=>H,JI:()=>O,ck:()=>L,i5:()=>Y,EN:()=>Z,gc:()=>I,wK:()=>z});var r=()=>a(906745),o=a(296540),n=()=>a(726637),i=()=>a(401497),s=()=>a(764880),l=()=>a(100594),u=()=>a(901610),d=()=>a(62371),c=()=>a(713998),g=()=>a(534177),p=()=>a(825237),y=()=>a(651124),m=()=>a(792071),h=a(474848);const v=o.memo((function(e){const{size:t,style:a,icon:r,baseUrl:o,getRecordModel:n}=e;return(0,h.jsx)("div",{style:{height:t,width:t,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,verticalAlign:"top",marginTop:1,...a},children:(0,h.jsx)(b,{icon:r,size:t,baseUrl:o,getRecordModel:n})})}));function f(e){return.9*e}function S(e){return.888*e}function b({icon:e,size:t,baseUrl:a,getRecordModel:r}){if(!e)return null;const o=(e,r)=>{const o=p().wY({url:e,baseUrl:a,fullyQualified:!0,permissionRecord:r,width:S(t),userId:void 0});return(0,h.jsx)("img",{alt:"icon",src:o,style:{width:S(t),height:S(t),objectFit:"cover",borderRadius:4,marginTop:1}})},n=(0,y().WO)(e.icon);switch(n.type){case"unicode_emoji":return(0,h.jsx)("div",{style:{fontSize:f(t)},children:n.emoji.unicode});case"custom_emoji":const a=m().xm7.resolveCustomEmojiIcon(e,r);return a?o(a.icon,a.pointer):null;case"app_package_asset":case"notion_icon":case"url":return o(e.icon,e.pointer);default:(0,g().HB)(n)}}var x=()=>a(522419),C=()=>a(216519);const w=function(e){const{botValue:t,avatarSize:a,baseUrl:r,theme:o,style:n}=e;if(null!=t&&t.icon){const i=x().GM(t.icon)?p().x8({url:t.icon,width:e.avatarSize,fullyQualified:!0,stripGoogleIconQuery:!0,baseUrl:r,userId:void 0}):t.icon;return(0,h.jsx)("div",{style:{...(0,C().fo)({theme:o,avatarSize:a}),...n},children:(0,h.jsx)("img",{src:i,style:{display:"block",width:"100%",height:"100%",objectFit:"cover"}})})}if(null!=t&&t.name){const e=t.name[0];return(0,h.jsx)("div",{children:(0,h.jsx)("div",{style:{...(0,C().ws)({theme:o,avatarSize:a}),...n},children:(0,h.jsx)("div",{children:e})})})}return(0,h.jsx)("span",{children:"ðŸ¤–"})};var M=()=>a(888867),A=()=>a(437607);function T(e){const{group:t,getRecordModel:a,size:r=20,baseUrl:o,theme:n,groupIconStyles:i}=e,s={...(0,C().fo)({theme:n,avatarSize:r}),...e.avatarBackground};if(null!=t&&t.icon){const e=(0,y().WO)(t.icon);switch(e.type){case"unicode_emoji":return(0,h.jsx)("div",{style:s,children:(0,h.jsx)("div",{style:{fontSize:.9*r},children:e.emoji.unicode})});case"custom_emoji":const n=(0,A().S4)({spacePermissionGroupId:t.id,spaceId:t.space_id}),l=m().xm7.resolveCustomEmojiIcon({pointer:n,icon:t.icon},a);if(!l)return(0,h.jsx)(B,{groupIconStyles:i});const u=p().wY({url:l.icon,baseUrl:o,fullyQualified:!0,permissionRecord:l.pointer,width:r,userId:void 0});return(0,h.jsx)("div",{style:s,children:(0,h.jsx)("img",{src:u,alt:t.name,style:{display:"block",width:"100%",height:"100%",objectFit:"cover"}})});case"app_package_asset":case"notion_icon":case"url":const d=x().GM(t.icon)?p().x8({url:t.icon,width:r,fullyQualified:!0,stripGoogleIconQuery:!0,baseUrl:o,userId:void 0}):t.icon;return(0,h.jsx)("div",{style:s,children:(0,h.jsx)("img",{src:d,alt:t.name,style:{display:"block",width:"100%",height:"100%",objectFit:"cover"}})});default:(0,g().HB)(e)}}return(0,h.jsx)(B,{groupIconStyles:i})}function B(e){const{groupIconStyles:t}=e;return(0,h.jsx)("div",{style:null==t?void 0:t.iconContainer,children:(0,M().s)(null==t?void 0:t.icon)})}var _=()=>a(597777),V=()=>a(869190),k=()=>a(72135),G=()=>a(379632),F=()=>a(100622),j=()=>a(284371),P=()=>a(934201),R=()=>a(698449),D=()=>a(497577);const K=(0,a(69708).YK)({titlePlaceholder:{defaultMessage:"Untitled",id:"chartLabelFormatHelpers.untitledBlock"}});function I(e,t,a){const r=a?16:20,l=(0,i().IS)((()=>({wrapper:{display:"flex",alignItems:"center",gap:6,minWidth:0},initialStyle:{backgroundColor:F().Tj.background.elevated,border:`1px solid ${F().Tj.border.primary}`,color:F().Tj.text.secondary},avatarStyle:{background:"none"},botStyle:{backgroundColor:F().Tj.background.elevated,border:`1px solid ${F().Tj.border.primary}`,color:F().Tj.text.secondary,fontSize:a?8:10},avatarWrapper:{flexShrink:0},nameWrapper:{minWidth:0,...j().RC}})),[a]),u=(0,D().E)({size:r});return(0,o.useCallback)(((o,i)=>{var d;if(!i)return o.toString();let c,g,p;if(i.actorPointer&&e)if((0,A().I6)(i.actorPointer)){var y;const a=(0,A().S4)({spacePermissionGroupId:i.actorPointer.id,spaceId:i.actorPointer.spaceId});g=e(a),p=(0,R().Pf)({intl:t,groupName:null===(y=g)||void 0===y?void 0:y.name})}else{var v;const a=(0,s().xC)({pointer:i.actorPointer,getRecordModel:e});g=null==a?void 0:a.asActor,p=null===(v=g)||void 0===v?void 0:v.getDisplayName(t)}return p||(p=o||t.formatMessage(m().Fvx.messages.anonymousPlaceholder)),c="space_permission_group"===(null===(d=g)||void 0===d?void 0:d.table)&&e&&g instanceof m().G1c?(0,h.jsx)(T,{group:g,getRecordModel:e,size:r,baseUrl:n().A.domainBaseUrl,theme:(0,F().x0)(),avatarBackground:l.avatarStyle,groupIconStyles:u}):g instanceof m().Fvx&&g.isUser()?(0,h.jsx)(C().Ay,{userValue:g,avatarSize:r,baseUrl:n().A.domainBaseUrl,theme:(0,F().x0)(),fontSize:a?8:10,initialStyle:l.initialStyle,avatarStyle:l.avatarStyle}):g instanceof m().HaY&&g.isBot()?(0,h.jsx)(w,{botValue:g,avatarSize:r,baseUrl:n().A.domainBaseUrl,theme:(0,F().x0)(),style:l.botStyle}):(0,h.jsx)(C().Ay,{userValue:{name:"?"},avatarSize:r,baseUrl:n().A.domainBaseUrl,theme:(0,F().x0)(),fontSize:a?8:10,initialStyle:l.initialStyle,avatarStyle:l.avatarStyle}),G().A.renderToStaticMarkup((0,h.jsxs)("div",{style:l.wrapper,children:[(0,h.jsx)("div",{style:l.avatarWrapper,children:c}),a?(0,h.jsx)("div",{style:l.nameWrapper,children:p}):null]}))}),[e,t,a,l,u,r])}function z(e,t,a){const r=(0,i().IS)((()=>({wrapper:{display:"flex",alignItems:"center",gap:6,minWidth:0},avatarWrapper:{flexShrink:0},titleWrapper:{minWidth:0,...j().RC}})),[]),s=t.formatMessage(K.titlePlaceholder);return(0,o.useCallback)(((o,i)=>{if(!i||!e)return o.toString()||s;let l;if(i.pagePointer&&e&&(l=e(i.pagePointer)),!l)return o.toString()||s;const u=l.getRenderTitleWithPlaceholder({getRecordModel:e,userTimeZone:a,intl:t}),d=l.getRenderIcon({getRecordModel:e});return G().A.renderToStaticMarkup((0,h.jsxs)("div",{style:r.wrapper,children:[d?(0,h.jsx)("div",{style:r.avatarWrapper,children:(0,h.jsx)(v,{getRecordModel:e,icon:d,size:16,baseUrl:n().A.domainBaseUrl})}):void 0,(0,h.jsx)("div",{style:r.titleWrapper,children:u})]}))}),[e,a,t,s,r.wrapper,r.avatarWrapper,r.titleWrapper])}function L(e){var t,a,r,o;const n="count"===(null===(t=e.aggregation)||void 0===t?void 0:t.aggregator)||"unique"===(null===(a=e.aggregation)||void 0===a?void 0:a.aggregator)?"number":O(e.propertySchema);let i;return i="count"===(null===(r=e.aggregation)||void 0===r?void 0:r.aggregator)||"unique"===(null===(o=e.aggregation)||void 0===o?void 0:o.aggregator)?"precision_0":"precision_from_number_property"===e.numberPrecisionOverride?Y(e.propertySchema):e.numberPrecisionOverride,t=>"string"==typeof t?t:i&&"precision_uncapped"!==i?(0,k().ZV)(t,n,e.intl,"compact",i):(0,k().ZV)(Z(t,2),n,e.intl,"compact",void 0)}function H({groupBy:e,dateFormat:t,intl:a}){return(r,o)=>{let n;return n=o?o.name:"string"==typeof r?r:r.toString(),E({dateString:n,dateFormat:t,groupBy:e,intl:a})}}function E({dateString:e,dateFormat:t,groupBy:a,intl:o}){const n=parseInt(e,10);if(isNaN(n))return e;switch(a){case"relative":default:return e;case"day":return(0,V().ZF)({value:{type:"date",start_date:r().DateTime.fromMillis(n).toISODate()},date_format:t||_().vz,allowRelativeDates:!0,intl:o});case"week":case"month":case"year":const i=r().DateTime.fromMillis(n),s={type:a,range:{type:"daterange",start_date:i.toISODate(),end_date:i.plus({[`${a}s`]:1}).minus({days:1}).toISODate()}};return(0,P().nc)({value:s,intl:o})}}function O(e){let t;return("number"===e.type||"formula"===e.type)&&(t=e.number_format),t}function Y(e){return"number"===e.type||"formula"===e.type?e.number_precision:void 0}function W({chartConfig:e,schema:t,highChartsLabel:a,highChartsValue:r,isMultiSeries:o,intl:n,numberPrecisionOverride:i}){let s=a,d=r;if(!e)return{label:s,value:d};const g=e.dataConfig;let p,y,m,h;if(o){if((0,u().m)(e)&&"groups_reducer"===e.dataConfig.type){var v;const a=e.dataConfig;if(p=null===(v=a.aggregationConfig.stackOptions)||void 0===v?void 0:v.groupBy,p){const e=(0,c()._g)({schema:t,property:p.property});e&&(0,l().zn)(e)&&(y=e)}h=a.aggregationConfig.aggregation,"count"!==h.aggregator&&(m=(0,c()._g)({schema:t,property:h.property}))}}else"groups_reducer"===g.type?(p=g.groupBy,y=(0,c()._g)({schema:t,property:g.groupBy.property}),h=g.aggregationConfig.aggregation,"count"!==h.aggregator&&(m=(0,c()._g)({schema:t,property:h.property}))):m=(0,c()._g)({schema:t,property:g.valueProperty});if(s=y?U({propertySchema:y,groupByFormat:p,aggregation:void 0,highChartsLabel:a,intl:n}):s,d&&"number"==typeof d&&m&&(0,l().JW)(m)){var f,S,b,x;const e="count"===(null===(f=h)||void 0===f?void 0:f.aggregator)||"unique"===(null===(S=h)||void 0===S?void 0:S.aggregator)?"number":O(m),t="count"===(null===(b=h)||void 0===b?void 0:b.aggregator)||"unique"===(null===(x=h)||void 0===x?void 0:x.aggregator)?"precision_0":i??Y(m);d=t&&"precision_uncapped"!==t?(0,k().ZV)(d,e,n,"compact",t):(0,k().ZV)(Z(d,2),e,n,"compact")}return{label:s,value:d}}function U(e){const{propertySchema:t,groupByFormat:a,aggregation:r,highChartsLabel:o,intl:n}=e;if(t&&(0,l().JW)(t)){const e="count"===(null==r?void 0:r.aggregator)||"unique"===(null==r?void 0:r.aggregator)?"number":O(t),a=parseInt(o,10);return isNaN(a)||"percent"===e?o:(0,k().ZV)(a,e,n,"compact")}const i="formula"===(null==a?void 0:a.type)?a.groupBy:a;return t&&(0,l().i8)(t)&&i&&(0,d().Ik)(i)?E({dateString:o,dateFormat:t.date_format,groupBy:i.groupBy,intl:n}):o}const N=1.2,$=2;function X(e){var t,a,r,o;if("count"===(null===(t=e.aggregation)||void 0===t?void 0:t.aggregator)||"unique"===(null===(a=e.aggregation)||void 0===a?void 0:a.aggregator))return!1;return"percent"===O(e.propertySchema)||(void 0!==e.userYAxisMax&&void 0!==e.userYAxisMin&&Math.abs(e.userYAxisMax-e.userYAxisMin)<$||(!!(null!==(r=e.userYAxisMax)&&void 0!==r&&r.toString().includes(".")||null!==(o=e.userYAxisMin)&&void 0!==o&&o.toString().includes("."))||Math.abs(e.dataYAxisMax)<N&&Math.abs(e.dataYAxisMin)<N))}function q(e){return e%1==0?e:e.toFixed(1)}function Z(e,t){const a=Math.pow(10,t);return Math.round(e*a)/a}},204957:(e,t,a)=>{a.d(t,{f:()=>g});var r=()=>a(920198),o=()=>a(484714),n=()=>a(590526),i=()=>a(187174),s=()=>a(869558),l=()=>a(789586),u=()=>a(129286);const d=new(a(62175).U)(((e,{spaceId:t,collectionViewId:a})=>`${e.currentUser.id}|${t}|${a}`),(async(e,{spaceId:t,collectionViewId:a})=>{if(!t||!a)return{canViewChart:!1,canViewChartError:"paywall_error"};const r=await e.api.callApi({eventName:"canViewChart",environment:e,data:{spaceId:t,collectionViewId:a}});return"success"!==r.type?{canViewChart:!1,canViewChartError:"paywall_error"}:{canViewChart:r.data.can_view_chart,canViewChartError:void 0}}));a(852832).exposeDebugValue("CollectionViewCanViewChartStore",d);const c=d;function g({collectionContextStore:e}){const t=(0,o().v3)(),a=(0,r().L)(),d=t.currentUser.id,g=null==a?void 0:a.id,{collectionViewStore:p,collectionViewBlockStore:y}=(0,n().K8)((()=>({collectionViewStore:e.collectionViewStore(),collectionViewBlockStore:e.collectionViewBlockStore()})),[e]),m=(0,n().K8)((()=>{const t=null==p?void 0:p.id,a=e.updateFreeChartsResultStore.state;if(t&&a&&a.has(t))return a.get(t)}),[e.updateFreeChartsResultStore,p]),h=(0,l().P)({name:"view_chart",spaceId:g,userId:d,amount:"unknown"}),[{value:v}]=(0,i().Yb)((async()=>await async function(e){const{collectionViewStore:t,collectionViewBlockStore:a,environment:r,spaceCanViewUnlimitedCharts:o,updateFreeChartsResult:n}=e,i=null==t?void 0:t.id,l=null==t?void 0:t.getSpaceId();if(!i||!l)return{canViewChart:!1,canViewChartError:"paywall_error"};if(o)return{canViewChart:!0,canViewChartError:void 0};if(await u().transactionQueue.awaitRecordTransaction({table:s().Gy,id:i}),null!=n&&n.isPending)return{canViewChart:void 0,canViewChartError:void 0};if(null==a?void 0:a.pathIsAccessibleAndAlive())return void 0!==(null==n?void 0:n.value)?{canViewChart:n.value,canViewChartError:void 0}:await c.awaitData(r,{spaceId:l,collectionViewId:i});{const e=await c.awaitData(r,{spaceId:l,collectionViewId:i});return await c.awaitData(r,{spaceId:l,collectionViewId:i},Boolean(e))}}({collectionViewStore:p,collectionViewBlockStore:y,environment:t,spaceCanViewUnlimitedCharts:Boolean(h),updateFreeChartsResult:m})),[p,y,t,h,m]),{canViewChart:f,canViewChartError:S}=v??{canViewChart:void 0,canViewChartError:void 0};return{canViewChart:f,canViewChartError:S}}},274031:(e,t,a)=>{a.d(t,{b:()=>o,y:()=>n});var r=()=>a(675133);const o=(0,a(69708).YK)({noData:{defaultMessage:"No data",id:"chartError.noData"},badYAxisRange:{defaultMessage:"No data due to axis range",id:"chartError.badYAxisRange"},unconfiguredProperty:{id:"chartError.unconfiguredProperty",defaultMessage:"Property is not configured. Please make another selection."},unsupportedProperty:{id:"chartError.unsupportedProperty",defaultMessage:"This property type is not supported. Please select another property"},unsupportedFormula:{id:"chartError.unsupportedFormula",defaultMessage:"This formula is not supported. Please select another property or adjust your formula."},deletedProperty:{id:"chartError.deletedProperty",defaultMessage:"This property has been deleted. Please select another property."},invalidAggregation:{id:"chartError.invalidAggregation",defaultMessage:"Previously selected property is no longer valid with the current aggregation. Please make another selection."},invalidPropertyValueChart:{id:"chartError.invalidPropertyValueChart",defaultMessage:"Selected property is no longer valid with the previous configured chart. Please make another selection."},noValues:{id:"chartError.noValues",defaultMessage:"This property has no values. Please add some values or select another property."}});function n(e){switch(e){case"groupBy_property_not_configured":case"aggregation_property_not_configured":case"name_property_not_configured":case"property_value_property_not_configured":return r().A.formatMessage(o.unconfiguredProperty);case"groupBy_property_not_groupable":case"stackBy_property_not_groupable":return r().A.formatMessage(o.unsupportedProperty);case"groupBy_formula_not_groupable":case"stackBy_formula_not_groupable":return r().A.formatMessage(o.unsupportedFormula);case"groupBy_property_deleted":case"stackBy_property_deleted":case"aggregation_deleted":case"name_property_deleted":case"property_value_property_deleted":return r().A.formatMessage(o.deletedProperty);case"aggregation_invalid":return r().A.formatMessage(o.invalidAggregation);case"stackBy_property_no_values":return r().A.formatMessage(o.noValues);case"name_property_invalid":case"property_value_property_invalid":return r().A.formatMessage(o.invalidPropertyValueChart)}}},322638:(e,t,a)=>{a.d(t,{$1:()=>E,FE:()=>D,FZ:()=>G,G_:()=>M,Iq:()=>K,Le:()=>B,QJ:()=>R,Qn:()=>L,RO:()=>T,TP:()=>_,TQ:()=>P,WG:()=>V,Zr:()=>w,Zv:()=>z,b$:()=>j,bg:()=>C,k1:()=>H,pP:()=>A,uB:()=>I,v5:()=>F,zH:()=>k});a(944114);var r=()=>a(726637),o=()=>a(590526),n=()=>a(401497),i=()=>a(100594),s=()=>a(901610),l=()=>a(67657),u=()=>a(708685),d=()=>a(713998),c=()=>a(69708),g=()=>a(100622),p=()=>a(496603),y=()=>a(534177),m=()=>a(436696),h=()=>a(384944),v=()=>a(895876),f=()=>a(34026),S=()=>a(525955),b=()=>a(390650),x=()=>a(547149);const C=(0,c().YK)({chartType:{defaultMessage:"Chart type",id:"database.viewSettings.mainTab.chartType.title"},chartDevFeedbackLink:{defaultMessage:"Give dev feedback",id:"database.viewSettings.mainTab.chartDevFeedbackLink"},chartData:{defaultMessage:"Data",id:"database.viewSettings.mainTab.chartData.title"},chartStyle:{defaultMessage:"Style",id:"database.viewSettings.mainTab.chartStyle.title"},chartMoreStyle:{defaultMessage:"More style options",id:"database.viewSettings.mainTab.moreChartStyles.title"},chartXAxis:{defaultMessage:"X axis",id:"database.viewSettings.mainTab.axisChart.xAxis"},chartXAxisGroupByUnique:{defaultMessage:"Unique",id:"database.viewSettings.mainTab.axisChart.xAxis.groupBy.unique"},chartAggregateByValues:{defaultMessage:"Values",id:"database.viewSettings.mainTab.axisChart.aggregateByValues"},chartGroupBy:{defaultMessage:"Group by",id:"database.viewSettings.mainTab.axisChart.groupBy"},chartYAxisRange:{defaultMessage:"Range",id:"database.viewSettings.mainTab.axisChart.yAxisRange"},chartYAxisRangeMenu:{defaultMessage:"Set custom range",id:"database.viewSettings.mainTab.axisChart.yAxisRangeMenu"},chartYAxisRangeAuto:{defaultMessage:"Auto",id:"database.viewSettings.mainTab.axisChart.yAxisRangeAuto"},chartYAxisRangeCustom:{defaultMessage:"Custom",id:"database.viewSettings.mainTab.axisChart.yAxisRangeCustom"},chartYAxisRangeReset:{defaultMessage:"Reset",id:"database.viewSettings.mainTab.axisChart.yAxisRangeReset"},chartYAxisRangeMinPlaceholder:{defaultMessage:"Min",id:"database.viewSettings.mainTab.axisChart.yAxisRangeMinPlaceholder"},chartYAxisRangeMaxPlaceholder:{defaultMessage:"Max",id:"database.viewSettings.mainTab.axisChart.yAxisRangeMaxPlaceholder"},chartSortBy:{defaultMessage:"Sort by",id:"database.viewSettings.mainTab.axisChart.sortBy"},chartYAxis:{defaultMessage:"Y axis",id:"database.viewSettings.mainTab.axisChart.yAxis"},chartCumulative:{defaultMessage:"Cumulative",id:"database.viewSettings.mainTab.axisChart.cumulative"},chartHelp:{defaultMessage:"Learn about charts",id:"database.viewSettings.mainTab.charts.learnMoreButton"},chartDuplicate:{defaultMessage:"Duplicate chart",id:"database.viewSettings.mainTab.charts.duplicate"},chartReset:{defaultMessage:"Reset chart",id:"database.viewSettings.mainTab.charts.reset"},chartWhatToShow:{defaultMessage:"What to show",id:"database.viewSettings.mainTab.charts.whatToShow"},chartSliceDonutBy:{defaultMessage:"Slice donut by",id:"database.viewSettings.mainTab.charts.sliceDonutBy"},chartSliceDonutAggregation:{defaultMessage:"Each slice represents",id:"database.viewSettings.mainTab.charts.sliceDonutAggregation"},noneMenuItem:{defaultMessage:"None",id:"database.viewSettings.mainTab.charts.noneMenuItem"},noResultsMenuItem:{defaultMessage:"No results",id:"chartSettingsPropertySearchMenuItem.search.noResults.title"}}),w=(0,c().YK)({chartStyleTitle:{defaultMessage:"Style",id:"database.viewSettings.chartStyleTab.title"},chartColor:{defaultMessage:"Color",id:"database.viewSettings.chartStyleTab.chartColor"},chartHeight:{defaultMessage:"Height",id:"database.viewSettings.chartStyleTab.chartHeight"},chartSmoothLine:{defaultMessage:"Smooth line",id:"database.viewSettings.chartStyleTab.chartSmoothLine"},chartLineFillArea:{defaultMessage:"Gradient area",id:"database.viewSettings.chartStyleTab.chartLineFillArea"},chartWeightColorValue:{defaultMessage:"Color by value",id:"database.viewSettings.chartStyleTab.chartWeightColorValue"},chartGroupStyle:{defaultMessage:"Group style",id:"database.viewSettings.chartStyleTab.groupStyle"},chartGridLine:{defaultMessage:"Grid line",id:"database.viewSettings.chartStyleTab.chartGridLine"},chartAxisAvatarFormat:{defaultMessage:"Label style",id:"database.viewSettings.chartStyleTab.chartAxisAvatarFormat"},chartAxisName:{defaultMessage:"Axis name",id:"database.viewSettings.chartStyleTab.chartAxisName"},chartLegend:{defaultMessage:"Legend",id:"database.viewSettings.chartStyleTab.chartLegend"},chartCaption:{defaultMessage:"Caption",id:"database.viewSettings.chartStyleTab.chartCaption"},chartCaptionPlaceholder:{defaultMessage:"Caption",id:"database.viewSettings.chartStyleTab.chartCaptionPlaceholder"},chartHideEmptyGroups:{defaultMessage:"Omit zero values",id:"database.viewSettings.chartStyleTab.chartOmitZeroValues"},chartDataLabels:{defaultMessage:"Data labels",id:"database.viewSettings.chartStyleTab.chartDataLabels"},chartShowDonutValue:{defaultMessage:"Show value in center",id:"database.viewSettings.chartStyleTab.chartHideDonutValue"},chartHideNegativeValues:{defaultMessage:"Hide negative values",id:"database.viewSettings.chartStyleTab.chartHideNegativeValues"},chartValueLabelPlaceholder:{defaultMessage:"Value label",id:"database.viewSettings.chartStyleTab.chartValueLabelPlaceholder"}}),M=(0,c().YK)({none:{defaultMessage:"None",id:"database.viewSettings.chartStyleTab.gridOptions.none"},horizontal:{defaultMessage:"Horizontal",id:"database.viewSettings.chartStyleTab.gridOptions.horizontal"},vertical:{defaultMessage:"Vertical",id:"database.viewSettings.chartStyleTab.gridOptions.vertical"},both:{defaultMessage:"Both",id:"database.viewSettings.chartStyleTab.gridOptions.both"}}),A=(0,c().YK)({auto:{id:"database.viewSettings.chartStyleTab.colorTheme.auto",defaultMessage:"Auto"},colorful:{id:"database.viewSettings.chartStyleTab.colorTheme.colorful",defaultMessage:"Colorful"},gray:{id:"database.viewSettings.chartStyleTab.colorTheme.gray",defaultMessage:"Colorless"},blue:{id:"database.viewSettings.chartStyleTab.colorTheme.blue",defaultMessage:"Blue"},yellow:{id:"database.viewSettings.chartStyleTab.colorTheme.yellow",defaultMessage:"Yellow"},green:{id:"database.viewSettings.chartStyleTab.colorTheme.green",defaultMessage:"Green"},purple:{id:"database.viewSettings.chartStyleTab.colorTheme.purple",defaultMessage:"Purple"},teal:{id:"database.viewSettings.chartStyleTab.colorTheme.teal",defaultMessage:"Teal"},orange:{id:"database.viewSettings.chartStyleTab.colorTheme.orange",defaultMessage:"Orange"},pink:{id:"database.viewSettings.chartStyleTab.colorTheme.pink",defaultMessage:"Pink"},red:{id:"database.viewSettings.chartStyleTab.colorTheme.red",defaultMessage:"Red"}}),T=(0,c().YK)({avatar:{defaultMessage:"Avatar",id:"database.viewSettings.chartStyleTab.axisAvtarFormat.avatar"},avatar_name:{defaultMessage:"Avatar and name",id:"database.viewSettings.chartStyleTab.axisAvtarFormat.avatarName"},name:{defaultMessage:"Name",id:"database.viewSettings.chartStyleTab.axisAvtarFormat.name"}}),B=(0,c().YK)({none:{defaultMessage:"None",id:"database.viewSettings.chartStyleTab.axisLabelOptions.none"},x_axis:{defaultMessage:"X axis",id:"database.viewSettings.chartStyleTab.axisLabelOptions.xAxis"},y_axis:{defaultMessage:"Y axis",id:"database.viewSettings.chartStyleTab.axisLabelOptions.yAxis"},both:{defaultMessage:"Both",id:"database.viewSettings.chartStyleTab.axisLabelOptions.both"}}),_=(0,c().YK)({normal:{defaultMessage:"Stacked",id:"database.viewSettings.chartStyleTab.axisGroupStyleFormat.normal"},percent:{defaultMessage:"Percent",id:"database.viewSettings.chartStyleTab.axisGroupStyleFormat.percent"},side_by_side:{defaultMessage:"Not stacked",id:"database.viewSettings.chartStyleTab.axisGroupStyleFormat.side_by_side"}}),V=(0,c().YK)({small:{defaultMessage:"Small",id:"database.viewSettings.chartStyleTab.chartSettingsChartHeightFormat.small"},medium:{defaultMessage:"Medium",id:"database.viewSettings.chartStyleTab.chartSettingsChartHeightFormat.medium"},large:{defaultMessage:"Large",id:"database.viewSettings.chartStyleTab.chartSettingsChartHeightFormat.large"},extra_large:{defaultMessage:"Extra large",id:"database.viewSettings.chartStyleTab.chartSettingsChartHeightFormat.extra_large"}}),k=(0,c().YK)({none:{defaultMessage:"None",id:"database.viewSettings.chartStyleTab.donutDataLabels.none"},value:{defaultMessage:"Value (%)",id:"database.viewSettings.chartStyleTab.donutDataLabels.value"},name:{defaultMessage:"Name",id:"database.viewSettings.chartStyleTab.donutDataLabels.name"},name_and_value:{defaultMessage:"Name and value (%)",id:"database.viewSettings.chartStyleTab.donutDataLabels.nameAndValue"}}),G=(0,c().YK)({column:{id:"chartType.bar.vertical",defaultMessage:"Vertical bar"},bar:{id:"chartType.bar.horizontal",defaultMessage:"Horizontal bar"},line:{id:"chartType.line",defaultMessage:"Line"},donut:{id:"chartType.donut",defaultMessage:"Donut"}}),F=(0,c().YK)({addReferenceLine:{defaultMessage:"Add reference line",id:"database.viewSettings.chartStyleTab.referenceLine.addReferenceLine"},addMoreReferenceLines:{defaultMessage:"Add reference line",id:"database.viewSettings.chartStyleTab.referenceLine.addMoreReferenceLines"},referenceLine:{defaultMessage:"Reference line",id:"database.viewSettings.chartStyleTab.referenceLine.referenceLine"},value:{defaultMessage:"Value",id:"database.viewSettings.chartStyleTab.referenceLine.value"},deleteReferenceLine:{defaultMessage:"Delete",id:"database.viewSettings.chartStyleTab.referenceLine.deleteReferenceLine"},label:{defaultMessage:"Label",id:"database.viewSettings.chartStyleTab.referenceLine.label"},strokeStyle:{defaultMessage:"Style",id:"database.viewSettings.chartStyleTab.referenceLine.strokeStyle"},color:{defaultMessage:"Color",id:"database.viewSettings.chartStyleTab.referenceLine.color"},maxReferenceLinesReached:{defaultMessage:"Youâ€™ve reached the maximum of 10 reference lines per chart",id:"database.viewSettings.chartStyleTab.referenceLine.maxReferenceLinesReached"},emptyStateDescription:{defaultMessage:"Add reference lines to set targets, mark thresholds, and bring clarity to your charts.",id:"database.viewSettings.chartStyleTab.referenceLine.emptyStateDescription"}}),j=(0,c().YK)({Solid:{defaultMessage:"Solid",id:"database.viewSettings.chartStyleTab.referenceLine.strokeStyle.solid"},Dash:{defaultMessage:"Dash",id:"database.viewSettings.chartStyleTab.referenceLine.strokeStyle.dash"}});function P({aggregation:e,databaseType:t,intl:a}){if((0,l().Iq)(e)&&t){const e=(0,p().ZH)((0,v().$O)(t));return a.formatMessage({id:"chartYAxis.aggregate.count",defaultMessage:"{value} count"},{value:e})}if((0,l().Iq)(e))return a.formatMessage({id:"chartYAxis.aggregate.unTypedCount",defaultMessage:"Count"});if("unique"===e.aggregator)return a.formatMessage({id:"chartYAxis.aggregate.distinct",defaultMessage:"Distinct"});{const t=(0,l().V1)(e);return S().SE[t]}}function R(e,t,a,r,o,n){if("placeholder"===t.type||t.type===e)return;let l;if("donut"===e){if("donut"===t.type)return;(0,s().m)(t)?l=(0,i().YU)(t,n):(0,y().HB)(t)}else(0,s().I)(e)?(0,s().m)(t)?l=(0,i().SK)(t,e):"donut"===t.type?l=(0,i()._x)(t,e):(0,y().HB)(t):(0,y().HB)(e);x().createAndCommit({userAction:"chartSettings.setChartType",environment:a,canUndo:!0,perform:e=>{h().zv({store:r.getFormatStore().getKeyStore("chart_config"),data:l,transaction:e})}}),(0,m().X)({environment:a,collectionContextStore:o,action:"charts_update_chart_type",charts_analytics_context:(0,b().nL)(o)})}function D(){return{fill:g().Tj.palette.orange[400]}}function K(e){const t=e.type;if("formula"===t){const t=(0,u().getFormulaPropertySchemaResultType)(e);return"text"===t||"checkbox"===t||"person"===t}return"title"===t||"text"===t||"url"===t||"email"===t||"phone_number"===t||"checkbox"===t||"person"===t||"select"===t||"multi_select"===t||"status"===t||"relation"===t||"created_by"===t||"last_edited_by"===t}function I(e,t){const a=null==e?void 0:e.dataConfig;return(0,o().K8)((()=>{let e;if("groups_reducer"===(null==a?void 0:a.type)?e=a.groupBy.property:"results_reducer"===(null==a?void 0:a.type)&&(e=a.nameProperty),e&&t)return(0,d()._g)({schema:t,property:e})}),[a,t],{useDeepEqual:!0})}function z(e,t){const a=null==e?void 0:e.dataConfig;return(0,o().K8)((()=>{let e;if("groups_reducer"===(null==a?void 0:a.type)?e=a.aggregationConfig.aggregation.property:"results_reducer"===(null==a?void 0:a.type)&&(e=a.valueProperty),e)return(0,d()._g)({schema:t,property:e})}),[a,t],{useDeepEqual:!0})}function L({environment:e,collectionContextStore:t,chartConfig:a,sort:r}){const o=[];"results_reducer"===a.dataConfig.type&&("x-ascending"===r?o.push({property:a.dataConfig.nameProperty,direction:"ascending"}):"x-descending"===r&&o.push({property:a.dataConfig.nameProperty,direction:"descending"})),f().IU({environment:e,collectionContextStore:t,temporaryState:{...t.temporaryStateStore.state,sorts:{value:o}}})}function H(){const e=250;return(0,n().IS)((()=>({whatToShowRightText:{maxWidth:r().A.isMobile?e:125},sortByRightText:{maxWidth:r().A.isMobile?e:163},groupByRightText:{maxWidth:r().A.isMobile?e:151},donutSliceRightText:{maxWidth:r().A.isMobile?e:124},donutSliceValueRightText:{maxWidth:r().A.isMobile?e:95},avatarStyle:{maxWidth:r().A.isMobile?e:110},donutDataLabelsRightText:{maxWidth:r().A.isMobile?e:90}})),[])}function E(e,t){return void 0===e||void 0===t?0:(e+t)/2}},352377:(e,t,a)=>{a.d(t,{L:()=>w});a(581454);var r=a(296540),o=()=>a(726637),n=()=>a(383036),i=()=>a(484714),s=()=>a(590526),l=()=>a(401497),u=()=>a(695115),d=()=>a(26697),c=()=>a(424400),g=()=>a(736847),p=()=>a(452706),y=()=>a(514608),m=()=>a(288739),h=()=>a(230979),v=()=>a(68207),f=()=>a(69708),S=()=>a(934201),b=()=>a(100622),x=a(474848);function C(e){const t=(0,i().Y0)(),r=(0,l().IS)((()=>{let a,r=o().A.isMobile?b().Tj.popoverBackground:b().Tj.background.secondary;return"yellow"===e.color&&(r=b().Tj.yellow.background.secondary,a=b().Tj.yellow.text.secondary),{container:{display:"flex",width:"100%",position:"relative",borderRadius:6,padding:t.isPhone?16:12,backgroundColor:r},icon:{width:14,height:14,marginTop:2},messageContainer:{display:"flex",flexDirection:"column",fontSize:t.isPhone?14:12},title:{fontWeight:500,color:e.color?a:void 0},caption:{color:e.color?a:b().Tj.text.secondary}}}),[t,e.color]);return(0,x.jsx)(g().A,{topBorder:!0,shouldShowBottomDivider:o().A.isMobile,style:{padding:12},children:(0,x.jsxs)("div",{style:r.container,children:[e.icon?(0,x.jsxs)(x.Fragment,{children:[t.isPhone?void 0:e.icon(r.icon),(0,x.jsx)(a(132389).A,{size:8})]}):void 0,(0,x.jsxs)("div",{style:r.messageContainer,children:[(0,x.jsx)("div",{style:r.title,children:e.title}),(0,x.jsx)("div",{style:r.caption,children:e.caption})]})]})})}const w=r.memo((function(e){const{groupBy:t,groupByKey:n,groupsFormatKey:l,collectionContextStore:u,groupsDisplayState:d,disableReorder:y}=e,m=(0,i().v3)(),h=(0,s().O$)(u.normalizedSchemaStore),v=(0,s().O$)(u.normalizedFormatStore),b=(0,s().O$)(u.canConfigureBlockStore),w=0===(null==d?void 0:d.visibleGroups.length)&&(null==d?void 0:d.hiddenGroups.length)>0,A=(0,s().K8)((()=>(0,S().Z3)({disableReorder:Boolean(y),groupByKey:n,format:v,canConfigureBlock:b,isMobile:o().A.isMobile})),[y,n,v,b]),T=!!d&&(d.currentGroups.length>p().O3&&d.hasMore),B=(0,r.useCallback)((()=>{if(!b)return;let e=[];e=w?(null==d?void 0:d.hiddenGroups.map((e=>({...e,hidden:void 0,emptyHidden:void 0}))))??[]:(null==d?void 0:d.currentGroups.map((e=>({...e,hidden:!0,emptyHidden:void 0}))))??[];const t=(0,a(45941).u8)({isMobile:o().A.isMobile});u.groupsLimitStore.setState(t),a(547149).createAndCommit({userAction:"CollectionSettingsViewGroup.handleHideAllClick",environment:m,canUndo:!0,perform:t=>{(0,a(800002).o)({collectionContextStore:u,newGroups:e,groupsFormatKey:l,transaction:t})}}),(0,a(436696).X)({environment:m,collectionContextStore:u,action:"click_groups_hide_all"})}),[b,w,u,m,null==d?void 0:d.hiddenGroups,null==d?void 0:d.currentGroups,l]),_=(0,r.useMemo)((()=>({topBorder:!0,disableMobileBorders:!0,noTextOverflow:!0,title:(0,x.jsx)(f().sA,{...S().K0.groups}),desktopTitleStyle:{paddingTop:4,marginBottom:8}})),[]);if(!d)return(0,x.jsx)(g().A,{..._,children:(0,x.jsx)(a(98126).A,{style:{alignSelf:"center",marginBottom:12}})});if(0===d.currentGroups.length)return(0,x.jsx)(g().A,{..._,children:(0,x.jsx)(c().Ay,{title:(0,x.jsx)(f().sA,{...S().K0.noGroups})})});const V=d.currentGroups.map((e=>(0,a(62371).Ix)(e)));return(0,x.jsxs)(x.Fragment,{children:[T?(0,x.jsx)(C,{title:(0,x.jsx)(f().sA,{...S().K0.groupLimitReachedTitle}),caption:(0,x.jsx)(f().sA,{...S().K0.groupLimitReachedCaption}),color:"yellow"}):void 0,(0,x.jsx)(g().A,{topBorder:!T,title:(0,x.jsx)(f().sA,{...S().K0.groups}),desktopStyle:T?{position:"relative",top:-12}:void 0,right:(0,x.jsx)(a(631524).p,{size:"sm",shouldShrink:!0,colorPalette:"blue",disabled:!b,onClick:B,style:{fontSize:12},children:w?(0,x.jsx)(f().sA,{id:"database.groupMenu.showAllGroups",defaultMessage:"Show all"}):(0,x.jsx)(f().sA,{id:"database.groupMenu.hideAllGroups",defaultMessage:"Hide all"})}),children:(0,x.jsx)(a(376254).H,{type:a(611648).A.Y,style:{maxHeight:400},children:(0,x.jsx)(a(271205).Ay,{direction:"vertical",keys:V,disabled:!A,renderKey:(e,a)=>{const r=d.currentGroups[a];return(0,x.jsx)(M,{collectionContextStore:u,schema:h,groupsDisplayState:d,groupBy:t,groupFormat:r,groupsFormatKey:l,canReorder:A})},onDrop:e=>{d&&(0,a(864403).r)({environment:m,collectionContextStore:u,groupsFormatKey:l,groupByKey:n,currentGroups:d.currentGroups,newGroupIds:e,containsAllGroups:!0})}})})})]})}),a(821062).A),M=r.memo((function(e){const{collectionContextStore:t,schema:o,groupsDisplayState:g,groupBy:b,groupFormat:C,groupsFormatKey:w,canReorder:M}=e,A=(0,i().v3)(),T=(0,f().tz)(),[B,_]=(0,r.useState)(!1),[V,k]=(0,r.useState)(!1),G=(0,s().O$)(t.canConfigureBlockStore),F=(0,r.useCallback)((e=>{(0,a(604656).m)({environment:A,collectionContextStore:t,currentGroups:g.currentGroups,groupsFormatKey:w,groupFormat:C,action:e})}),[w,A,t,g.currentGroups,C]),j=()=>{F("toggle_group_visibility")},P=()=>{F("toggle_group_pin")},R={onMouseEnter:()=>{k(!0)},onMouseLeave:()=>{k(!1)}},D={onMouseEnter:()=>{_(!0)},onMouseLeave:()=>{_(!1)}},K=(0,l().IS)((()=>({title:{marginInlineStart:-2,opacity:C.hidden?.4:1}})),[C.hidden]);return(0,x.jsx)(c().Ay,{left:M?(0,x.jsx)(a(148860).t,{}):void 0,title:(0,x.jsx)(a(330918).d,{groupBy:b,groupFormat:C,currentGroups:g.currentGroups,schema:o,disabled:!0,isHiddenGroup:!1,collectionContextStore:t,source:"collection_settings"}),titleStyle:K.title,right:(0,x.jsxs)(x.Fragment,{children:["board_columns"===w?(0,x.jsx)(d().m,{renderTooltip:e=>(0,x.jsx)(f().sA,{...e,...C.pinned?S().K0.unpinGroup:S().K0.pinGroup}),render:e=>{const t=B&&G;return C.pinned?(0,x.jsx)(u().A,{...(0,n().A)(e,D),icon:t?h().N:v().S,colorVariant:"primary",ariaLabel:T.formatMessage(S().K0.unpinGroup),onClick:P,disabled:!G}):G?(0,x.jsx)(u().A,{...(0,n().A)(e,D),icon:t?v().S:h().N,ariaLabel:T.formatMessage(S().K0.pinGroup),onClick:P,disabled:g.pinnedGroups.groups.length>=p().U5}):null}}):void 0,(0,x.jsx)(d().m,{renderTooltip:e=>(0,x.jsx)(f().sA,{...e,...C.hidden?S().K0.showGroup:S().K0.hideGroup}),render:e=>{const t=V&&G;let a=t?m().M:y().eyeFillSmallIcon,r=!t;return C.hidden&&(a=t?y().eyeFillSmallIcon:m().M,r=t),(0,x.jsx)(u().A,{...(0,n().A)(e,R),icon:a,colorVariant:r?"primary":"secondary",ariaLabel:C.hidden?T.formatMessage(S().K0.showGroup):T.formatMessage(S().K0.hideGroup),onClick:j,disabled:!G})}})]})})}))},406007:(e,t,a)=>{a.d(t,{$:()=>c,Z:()=>l});var r=()=>a(590526),o=()=>a(100594),n=()=>a(110731),i=()=>a(840503),s=()=>a(908201);const l=o().bg.medium,u={[o().bg.small]:300,[o().bg.medium]:400,[o().bg.large]:600,[o().bg.extra_large]:800};function d(e){return e<u[o().bg.medium]?o().bg.small:e<u[o().bg.large]?o().bg.medium:e<u[o().bg.extra_large]?o().bg.large:o().bg.extra_large}function c({chartHeightFormat:e}){const t=(0,s().Ks)();return(0,r().K8)((()=>function({collectionContextStore:e,chartHeightFormat:t}){const a=e&&(0,n().b)(e);if(a){const e=50,t=(0,i().I)({rowId:a.id,heightConfig:a.heightConfig,ignoreDragState:!1})-e;return{pixelHeight:t,semanticHeight:d(t)}}const r=t??l;return{pixelHeight:u[r],semanticHeight:r}}({collectionContextStore:t,chartHeightFormat:e})),[t,e],{recomputeSchedule:{type:"debounce",debounceMs:200,initialValue:{pixelHeight:0,semanticHeight:e??l},maxWait:1e3,leading:!0,trailing:!0}})}},447385:(e,t,a)=>{a.d(t,{x:()=>o});var r=()=>a(242422);function o(){return r().default.getConfigKey("collection_reducer_request_settings","chart").debounce_wait_ms}},526920:(e,t,a)=>{a.d(t,{BV:()=>g,FI:()=>m,H0:()=>S,HH:()=>h,LF:()=>c,NF:()=>w,Pi:()=>p,Q1:()=>b,US:()=>f,nH:()=>C,tm:()=>v,wW:()=>y});var r=()=>a(100594),o=()=>a(898244),n=()=>a(278238),i=()=>a(751735),s=()=>a(100622),l=()=>a(406944),u=()=>a(534177),d=()=>a(934201);function c(e){return void 0!==e&&"auto"!==e&&"colorful"!==e}function g(e,t){if("auto"===e);else{if("colorful"===e)return l().O.colorful.slice(0,6);if(p(e)){const a="gray"===e?"dark"===t?"white":"black":e;return l().O[a]}(0,u().HB)(e)}}function p(e){return r().VY.includes(e)}function y(e,t,a){const r=function(e,t,a){if("auto"===e)return;let r;r="gray"===e?"dark"===a.mode?"white":"black":e;const o=l().O[r];return t&&p(e)?[o[0],o[3]]:o}(e,t,a);if(r)return p(e)&&t?{colorAxis:{minColor:r[1],maxColor:r[0],showInLegend:!1},colors:r}:{colorAxis:void 0,colors:r}}function m(e,t){return n().l8[t][e]}function h({collectionContextStore:e,groupValue:t,index:a,groupBy:r,theme:n,environment:i}){var s,u;const c=e.normalizedSchemaStore.state,g=e.normalizedFormatStore.state;if("placeholder"===(null===(s=g.chart_config)||void 0===s?void 0:s.type)||void 0===t.value)return"light"===n.mode?l().O.translucentGray[0]:l().O.translucentGray[1];const p=c[r.property],m=p&&((0,o().lx)(p)||(0,o().DD)(p)),h=(null===(u=g.chart_config)||void 0===u||null===(u=u.chartFormat)||void 0===u?void 0:u.colorTheme)||"auto";if("auto"===h&&m){const e=(0,d().$e)({environment:i,groupFormat:{property:r.property,value:t},schema:c,format:g,theme:n,ignoreDisableColorColumns:!0});if(e)return e.chartColor}const v=y("auto"===h?"colorful":h,!1,n),f=(null==v?void 0:v.colors)||l().O.colorful;return f[a%f.length]}function v(e){const{color:t,hideLineFillArea:a,isStacked:r}=e;return a?{linearGradient:{x1:0,x2:0,y1:0,y2:1},stops:[[0,"rgba(0, 0, 0, 0)"],[1,"rgba(0, 0, 0, 0)"]]}:r?(0,i().X4)(t,.1):{linearGradient:{x1:0,x2:0,y1:0,y2:1},stops:[[0,(0,i().X4)(t,.1)],[1,(0,i().X4)(t,0)]]}}function f(e){return e===r().PC.normal||e===r().PC.percent}function S(e){return{pattern:{path:{d:"M 2.5 7.5 L 10.5 -0.5 M -0.5 4.5 L 4.5 -0.5 M 4.5 10.5 L 10.5 4.5",strokeWidth:1,stroke:e},width:6,height:6,backgroundColor:(0,i().X4)(e,.1)}}}const b=["gradient","blue","red","yellow","grey","none"],x=(0,a(69708).YK)({gradient:{defaultMessage:"Gradient",id:"chart.export.background.gradient"},blue:{defaultMessage:"Blue",id:"chart.export.background.blue"},red:{defaultMessage:"Red",id:"chart.export.background.red"},yellow:{defaultMessage:"Yellow",id:"chart.export.background.yellow"},grey:{defaultMessage:"Grey",id:"chart.export.background.grey"},none:{defaultMessage:"None",id:"chart.export.background.none"}});function C(e){return x[e]}function w(e,t,a){const r="light"===e.mode?a?100:50:a?600:500;switch(t){case"blue":return e.palette.blue[r];case"red":return e.palette.red[r];case"yellow":return e.palette.yellow[r];case"grey":return e.palette.gray[r];case"none":const o=a?e.buttonHoveredBackground:e.popoverBackground;return`linear-gradient(to top right, ${o} calc(50% - 1px), ${s().Tj.border.secondaryTranslucent}, ${o} calc(50% + 1px) )`;case"gradient":return`${a?`linear-gradient(${e.buttonHoveredBackground}, ${e.buttonHoveredBackground}), `:""}${"dark"===e.mode?"linear-gradient(123deg, #3C3F41 40.15%, #4A2F27 89.33%)":"linear-gradient(123deg, #FEF5E9 40.15%, #FEE9E9 89.33%)"}`;default:(0,u().HB)(t)}}},646060:(e,t,a)=>{a.d(t,{x:()=>u});var r=()=>a(590526),o=()=>a(282339),n=()=>a(62371),i=()=>a(452706),s=()=>a(790063),l=()=>a(901610);function u({chartConfig:e,chartError:t,collectionContextStore:a}){const u=(0,r().O$)(a.normalizedFormatStore);return(0,r().K8)((()=>{if((!t||(0,o().xG)(t))&&e)return function({chartConfig:e,format:t}){var a,r,o;if("placeholder"===e.type||"groups_reducer"!==(null===(a=e.dataConfig)||void 0===a?void 0:a.type))return;const u=t.collection_groups||[],d=t.chart_subgroups||[],c=e.dataConfig.groupBy,g=(0,l().m)(e)?null===(r=e.dataConfig.aggregationConfig.stackOptions)||void 0===r?void 0:r.groupBy:void 0,p=(0,s().p)(e);if(!p)return;const y=null===(o=e.chartFormat)||void 0===o?void 0:o.axisHideEmptyGroups,m=(0,n().w9)(c,t);return{version:"v2",type:"groups",omitZeroAggregationGroups:Boolean(y),groupBy:m,limit:i().y5,groupSortPreference:u,aggregation:g?{type:"intersection_and_independent",intersectionAggregation:p,groupAggregation:p,subGroupAggregation:p}:{type:"independent",groupAggregation:p},subGroup:g?{groupBy:(0,n().w9)(g,t),limit:i().av,groupSortPreference:d}:void 0}}({chartConfig:e,format:u})}),[t,e,u],{useDeepEqual:!0})}},651987:(e,t,a)=>{a.d(t,{AY:()=>O,CL:()=>J,CS:()=>Z,Tm:()=>D,UX:()=>E,cN:()=>K,hu:()=>X,p4:()=>Y});a(944114),a(898992),a(803949),a(581454);var r=()=>a(906745),o=()=>a(242422),n=()=>a(675133),i=()=>a(295633),s=()=>a(764880),l=()=>a(433337),u=()=>a(100594),d=()=>a(499755),c=()=>a(901610),g=()=>a(302322),p=()=>a(708685),y=()=>a(62371),m=()=>a(898244),h=()=>a(713998),v=()=>a(254947),f=()=>a(80979),S=()=>a(799829),b=()=>a(450648),x=()=>a(179034),C=()=>a(437607),w=()=>a(406944),M=()=>a(496603),A=()=>a(534177),T=()=>a(895876),B=()=>a(89053),_=()=>a(934201),V=()=>a(113105),k=()=>a(842076),G=()=>a(71304),F=()=>a(698449),j=()=>a(442025),P=()=>a(526920),R=()=>a(154378);function D(e){var t,a;const{collectionContextStore:r,groupedDataConfig:o,xAxisType:n,aggregationResults:i,subGroupResults:s,timezone:l,theme:c,environment:g,intl:p,groupTotals:m}=e;let{groupResults:v}=e;const f=null===(t=r.collectionViewStore())||void 0===t?void 0:t.getChartConfig();if(!f||"placeholder"===f.type)return;const S=o.groupBy;if(!S)return;if(!(0,y().rj)(S.type))return;const b=o.aggregationConfig;if(!b)return;if(!i)return;const x=r.normalizedSchemaStore.state,C=(0,h()._g)({schema:x,property:S.property});if(!C)return;const A=null==f?void 0:f.chartFormat,T=null==A?void 0:A.weightColorValue,B=null==A?void 0:A.mainSort,_=null==A?void 0:A.smoothLine,V=Boolean(null==A?void 0:A.axisHideEmptyGroups),k="datetime"===n||"linear"===n;"formula"!==S.type&&"descending"===S.sort.type&&k&&(v=v.reverse());const G=!k,F=k;let j=0,R=0,D=[],K=[];const I=b.seriesFormat.displayType,z=null===(a=b.stackOptions)||void 0===a?void 0:a.groupBy;if(s&&z){if(!(0,h()._g)({schema:x,property:z.property}))return;const e=new Map,t=null==A?void 0:A.axisCumulative;let a=0;s.forEach((e=>{const o=e.value,n=W({collectionContextStore:r,groupBy:z,groupValue:o,removeUncategorizedDateOrNumber:!1,environment:g,intl:p,timezone:l});if(!n)return;const s=(0,y().AC)(o),d=i[s],h=d?U(d):void 0;if(V&&!h)return;const b=L(n.stringValue,I,_),{maxGroupValue:x,minGroupValue:C,dataPoints:w}=H({collectionContextStore:r,subGroupKey:s,groupBy:S,hideEmptyGroups:V,groupResults:v,aggregationResults:i,groupTotals:m,timezone:l,environment:g,shouldSetDataPointColor:"line"!==I&&!T,theme:c,intl:p,useIndexAsX:G,removeUncategorizedDateOrNumber:F,seriesDisplayType:I});var M;(b.color=(0,P().HH)({collectionContextStore:r,groupValue:o,index:a,groupBy:z,theme:c,environment:g}),"line"===I)&&(b.fillColor=(0,P().tm)({color:b.color,hideLineFillArea:Boolean(null===(M=f.chartFormat)||void 0===M?void 0:M.hideLineFillArea),isStacked:(0,P().US)(null==A?void 0:A.axisGroupStyle)}));if(t&&Z(f)){const{maxDataPoint:e,minDataPoint:t,cumulatedDataPoints:a}=Q(w);b.data=a,"line"===I&&A.axisGroupStyle===u().PC.side_by_side?(e>j&&(j=e),t<R&&(R=t)):(j+=e,R+=t)}else b.data=w,j=Math.max(x,j),R=Math.min(C,R);D.push(b),a+=1})),"y-ascending"!==B&&"y-descending"!==B||(D=function(e,t){const a=(0,M().mg)(e);return a.forEach((e=>{const a=e.data.sort(((e,a)=>"y-ascending"===t?(e.total?e.total:0)-(a.total?a.total:0):(a.total?a.total:0)-(e.total?e.total:0)));a.forEach(((e,t)=>{e.x=t})),e.data=a})),a}(D,B));for(const r of D)for(const t of r.data)e.set(t.x,t);K=Array.from(e).sort(((e,t)=>e[0]-t[0])).map((([e,t])=>t))}else{var E;const e=C.name,{maxGroupValue:t,minGroupValue:a,dataPoints:o}=H({collectionContextStore:r,subGroupKey:void 0,groupBy:S,hideEmptyGroups:V,groupResults:v,aggregationResults:i,groupTotals:m,timezone:l,environment:g,shouldSetDataPointColor:"line"!==I&&!(0,P().LF)(null==A?void 0:A.colorTheme)&&!T,theme:c,intl:p,useIndexAsX:G,removeUncategorizedDateOrNumber:F,seriesDisplayType:I}),n=L(e.toString(),I,_);if("line"===I){var O,Y,N;const e=(null===(O=(0,P().wW)((null===(Y=f.chartFormat)||void 0===Y?void 0:Y.colorTheme)||"colorful",!1,c))||void 0===O||null===(O=O.colors)||void 0===O?void 0:O[0])||w().O.colorful[0];n.fillColor=(0,P().tm)({color:e,hideLineFillArea:Boolean(null===(N=f.chartFormat)||void 0===N?void 0:N.hideLineFillArea),isStacked:(0,P().US)(null==A?void 0:A.axisGroupStyle)})}if((null==A?void 0:A.axisCumulative)&&Z(f)){const{maxDataPoint:e,minDataPoint:t,cumulatedDataPoints:a}=Q(o);n.data=a,j+=e,R+=t}else n.data=o,j=Math.max(t,j),R=Math.min(a,R);const s=null===(E=f.chartFormat)||void 0===E?void 0:E.mainSort;s!==d().S0.yAscending&&s!==d().S0.yDescending||(n.data=q(n.data,s)),K=n.data,D.push(n)}return{seriesData:D,maxValue:j,minValue:R,dataPointsForXAxisLabels:K}}function K(e){var t,a,r,n;const{groupedDataConfig:i,collectionContextStore:s,groupResults:l,aggregationResults:u,timezone:c,environment:g,theme:p,intl:y,groupTotals:m}=e,v=null===(t=s.collectionViewStore())||void 0===t?void 0:t.getChartConfig();if(!v||"placeholder"===v.type)return;const f=s.normalizedSchemaStore.state,S=i.groupBy,b=(0,h()._g)({schema:f,property:S.property});if(!b)return;const x=b.name,{dataPoints:C}=H({collectionContextStore:s,subGroupKey:void 0,groupBy:S,groupResults:l,aggregationResults:u,groupTotals:m,timezone:c,environment:g,shouldSetDataPointColor:!Boolean(null===(a=v.chartFormat)||void 0===a?void 0:a.weightColorValue),theme:p,intl:y,hideEmptyGroups:!0,useIndexAsX:!0,removeUncategorizedDateOrNumber:!1}),w=null===(r=v.chartFormat)||void 0===r?void 0:r.mainSort,M=z(I(C)),A=!o().default.checkGate({gateName:"donut_chart_negative_values"})||null!==(n=v.chartFormat)&&void 0!==n&&n.hideNegativeValues?C:M;return w===d().S0.yAscending||w===d().S0.yDescending?[{name:x,data:q(A,w)}]:[{name:x,data:A}]}function I(e){if(!e||0===e.length)return[];return e.map((e=>{const t={...e};return void 0!==t.y&&(t.originalY=e.y,t.y=Math.abs(e.y)),t}))}function z(e){if(!e||0===e.length)return[];return e.map((e=>{const t={...e};return void 0!==t.originalY&&t.originalY<0&&"string"==typeof t.color&&(t.color=(0,P().H0)(t.color)),t}))}function L(e,t,a){let r;return r="line"===t?a?"areaspline":"area":t,{name:e,type:r,data:[]}}function H({collectionContextStore:e,subGroupKey:t,groupBy:a,hideEmptyGroups:r,groupResults:o,aggregationResults:n,groupTotals:i,timezone:s,environment:l,shouldSetDataPointColor:d,theme:c,intl:g,useIndexAsX:p,removeUncategorizedDateOrNumber:m,seriesDisplayType:h}){var v;let f=0,S=0;const b=[],x=null===(v=e.collectionViewStore())||void 0===v?void 0:v.getChartConfig();if(!x||"placeholder"===x.type)return{maxGroupValue:f,minGroupValue:S,dataPoints:b};let C=0;return o.forEach(((o,v)=>{var w,M,A,T,B;const _=o.value,V=(0,y().AC)(_),k=t?(0,y().A)([t,V]):V,G=n[k],F=n[V];if(!G||!F)return;const j=W({collectionContextStore:e,groupBy:a,removeUncategorizedDateOrNumber:m,groupValue:_,environment:l,intl:g,timezone:s}),R=U(G),D=(null===(w=i.get(V))||void 0===w?void 0:w.max)||0,K=(null===(M=i.get(V))||void 0===M?void 0:M.min)||0,I=(null===(A=i.get(V))||void 0===A?void 0:A.total)||0,z=d&&!t?(0,P().HH)({collectionContextStore:e,groupValue:_,index:C,groupBy:a,theme:c,environment:l}):void 0;if(void 0===j||void 0===R||void 0===D||void 0===K)return;if(r&&0===I)return;const L=r&&"side_by_side"===(null===(T=x.chartFormat)||void 0===T?void 0:T.axisGroupStyle)&&0===R,H=null===(B=x.chartFormat)||void 0===B?void 0:B.axisGroupStyle;let E;H===u().PC.side_by_side?(R>f&&(f=R),R<S&&(S=R)):"line"===h&&H===u().PC.normal?(f=Math.max(f,I),S=Math.min(S,I)):(f=Math.max(f,D),S=Math.min(S,K)),p?(E={x:t?v:C,y:R,name:j.stringValue,total:I},j.actorPointer&&(E.actorPointer=j.actorPointer),L&&(E.visible=!1)):(E={x:j.numberValue,y:R,name:j.stringValue,total:I},L&&(E.visible=!1)),z&&(E.color=z),E.groupFormat=o,b.push(E),C+=1})),{maxGroupValue:f,minGroupValue:S,dataPoints:b}}function E({collectionContextStore:e,resultsDataConfig:t,resultsChartReducerResults:a,chartType:r,timezone:n,theme:s,intl:l,environment:u}){var c,y,m;const v=null===(c=e.collectionViewStore())||void 0===c?void 0:c.getChartConfig();if(!v||"placeholder"===v.type)return;const S=null==v?void 0:v.chartFormat,x=null==S?void 0:S.weightColorValue,C=null==S?void 0:S.smoothLine,M=e.normalizedSchemaStore.state,A=(0,h()._g)({schema:M,property:t.valueProperty});if(!A)return;const T=Boolean(null===(y=v.chartFormat)||void 0===y?void 0:y.axisHideEmptyGroups),_=[],V=A.name,G="axis"===r?t.valueSeriesFormat.displayType:"column",{maxDataPoint:F,minDataPoint:j,dataPoints:D}=function({collectionContextStore:e,hideEmptyGroups:t,resultsDataConfig:a,resultsChartReducerResults:r,shouldSetDataPointColor:n,theme:s,useIndexAsX:l,timezone:u,intl:c,environment:y}){var m,v,S;let x=0,C=0;const w=[],M=e.normalizedFormatStore.state.chart_config,A=e.collectionStore();if(!A||!M||"placeholder"===M.type||!r)return{maxDataPoint:x,minDataPoint:C,dataPoints:w};let T=0;const _=(null===(m=M.chartFormat)||void 0===m?void 0:m.colorTheme)||"auto",V=(0,P().wW)("auto"===_?"colorful":_,!1,s),G=e.normalizedSchemaStore.state,F=(0,h()._g)({schema:G,property:a.nameProperty}),j=(0,h()._g)({schema:G,property:a.valueProperty}),D=new Map,K=new Map,I=new Map;if(r.blockIds.forEach((e=>{const r=i().B.createChildStore(A,{table:"block",id:e,spaceId:A.getSpaceId()}),s=r.getModel(),d=(()=>{if("formula"===(null==F?void 0:F.type)){if("text"!==(0,p().getFormulaPropertySchemaResultType)(F)||!s)return;return(0,f().primitiveFormulaValueFromPropertySchema)({schema:G,property:a.nameProperty,blockModel:s,getRecordModel:r.getRecordModel,intl:c,userTimeZone:u,depth:0,resultCache:D,regExpCache:K,formatDateCache:I,experimentService:o().default,collectionFeatureGates:(0,B().i)(),spaceIdCreator:y.idCreator.getSpaceIdCreatorSync(s.space_id),getRelationEdgeList:(0,k().Y)({environment:y,spaceId:s.space_id})})??""}const e=r.getPropertyValue(a.nameProperty),t=(0,b().r4)({textValue:e,getRecordModel:r.getRecordModel,userTimeZone:u,intl:c});return"title"===(null==F?void 0:F.type)?t||c.formatMessage(R().$k.titlePlaceholder):t})(),m=(()=>{if("formula"===(null==j?void 0:j.type)){if("number"!==(0,p().getFormulaPropertySchemaResultType)(j)||!s)return;const e=(0,f().primitiveFormulaValueFromPropertySchema)({schema:G,property:a.valueProperty,blockModel:s,getRecordModel:r.getRecordModel,intl:c,userTimeZone:u,depth:0,resultCache:D,regExpCache:K,formatDateCache:I,experimentService:o().default,collectionFeatureGates:(0,B().i)(),spaceIdCreator:y.idCreator.getSpaceIdCreatorSync(s.space_id),getRelationEdgeList:(0,k().Y)({environment:y,spaceId:s.space_id})});if("number"!=typeof e)return;return e}const e=r.getPropertyValue(a.valueProperty);return(0,g().M)(e)})();if(t&&void 0===m)return;let h;m&&m>x&&(x=m),m&&m<C&&(C=m);const v=null==V?void 0:V.colors;if(v&&n&&(h=v[T%v.length]),l){const e={x:T,y:m,name:d,color:h};"title"===(null==F?void 0:F.type)&&s&&(e.pagePointer=s.pointer),w.push(e)}T+=1})),(null==M||null===(v=M.chartFormat)||void 0===v?void 0:v.axisCumulative)&&Z(M)){const{maxDataPoint:e,minDataPoint:t,cumulatedDataPoints:a}=Q(w);return{maxDataPoint:e,minDataPoint:t,dataPoints:a}}const z=null===(S=M.chartFormat)||void 0===S?void 0:S.mainSort;if(z===d().S0.yAscending||z===d().S0.yDescending){const e=q(w,z);return{maxDataPoint:x,minDataPoint:C,dataPoints:e}}return{maxDataPoint:x,minDataPoint:C,dataPoints:w}}({collectionContextStore:e,hideEmptyGroups:T,resultsDataConfig:t,resultsChartReducerResults:a,shouldSetDataPointColor:"line"!==G&&!x,theme:s,useIndexAsX:!0,timezone:n,intl:l,environment:u}),K=L(V.toString(),G,C);if("line"===G){var H,E,O,Y;const e=(null===(H=(0,P().wW)((null===(E=v.chartFormat)||void 0===E?void 0:E.colorTheme)||"colorful",!1,s))||void 0===H||null===(H=H.colors)||void 0===H?void 0:H[0])||w().O.colorful[0];K.fillColor=(0,P().tm)({color:e,hideLineFillArea:Boolean(null===(O=v.chartFormat)||void 0===O?void 0:O.hideLineFillArea),isStacked:(0,P().US)(null===(Y=v.chartFormat)||void 0===Y?void 0:Y.axisGroupStyle)})}if("donut"!==r||!o().default.checkGate({gateName:"donut_chart_negative_values"})||null!==(m=v.chartFormat)&&void 0!==m&&m.hideNegativeValues)K.data=D;else{const e=z(I(D));K.data=e}return _.push(K),{maxValue:F,minValue:j,seriesData:_}}function O({groupedDataConfig:e,hideEmptyGroups:t,mainSort:a}){if(t||"y-ascending"===a||"y-descending"===a)return"category";const{type:r}=e.groupBy;return(0,y().Ik)(e.groupBy)&&"relative"!==e.groupBy.groupBy?"datetime":"number"===r?"linear":"category"}function Y({mainSort:e,xAxisType:t}){return"datetime"===t&&"x-descending"===e||"linear"===t&&"x-descending"===e}function W({collectionContextStore:e,groupBy:t,groupValue:a,removeUncategorizedDateOrNumber:o,environment:n,intl:l,timezone:u}){const d=e.collectionViewBlockStore();if(!d)return;const g=e.normalizedSchemaStore.state,p=(0,h()._g)({schema:g,property:t.property});if(!p)return;const f=p.name;if(!a.value){if(o&&("number"===a.type&&"number"===(null==p?void 0:p.type)||(0,y().DH)(a)))return;if((0,y().D1)(a)&&(0,m().nC)(p)){const e=d.getAssociatedCollectionStore();return{stringValue:$(f,!!e&&(0,j().Vu)({collectionStore:e,property:t.property,propertySchema:p,parentStore:e}))}}return{stringValue:$(f)}}if((0,y().DH)(a)){const e=(0,_().nc)({intl:l,value:a.value}),o="formula"===t.type?t.groupBy:t;if((0,y().Ik)(o)&&"relative"===o.groupBy)return{stringValue:e};if("day"===a.value.type||"month"===a.value.type||"week"===a.value.type||"year"===a.value.type){const e=r().DateTime.fromISO(a.value.range.start_date,{zone:u}).startOf("day").toMillis();return{stringValue:e.toString(),numberValue:e}}return{stringValue:e}}if((0,y().D1)(a)&&(0,m().nC)(p)){const e=a.value;if((0,y().WO)(e)){const t=e.id,a=i().B.createChildStore(d,{id:t,table:x().ev});return{stringValue:(0,G().tS)({environment:n,intl:l,store:a})}}if((0,y().zx)(e)){var b;const t=(0,V().LQ)(p,d);if(!t)return;const a=null===(b=S().n$[t])||void 0===b||null===(b=b[e.value.variable])||void 0===b?void 0:b.messageDescriptor;return a?{stringValue:l.formatMessage(a)}:void 0}}else if((0,y().rM)(a)){const e=a.value,t=null==e?void 0:e.type;if("by_group"===t&&null!=e&&e.group)return(0,v().wC)(e.group)?{stringValue:l.formatMessage((0,v().gh)(e.group))}:{stringValue:e.group};if("by_option"===t&&null!=e&&e.option)return{stringValue:null==e?void 0:e.option}}else{if("select"===a.type||"multi_select"===a.type)return{stringValue:a.value};if("number"===a.type){var w;const t=a.value,r=t.type;let o;const n=null===(w=e.collectionViewStore())||void 0===w?void 0:w.getChartConfig();var M;if(n&&(0,c().m)(n))o=null===(M=n.chartFormat)||void 0===M?void 0:M.numberPrecisionOverride;const i=(0,R().ck)({propertySchema:p,aggregation:void 0,intl:l,numberPrecisionOverride:o});if(!i)return;if("range"===r)return{stringValue:i(t.start),numberValue:t.start};if("unique"===r)return{stringValue:i(t.value),numberValue:t.value};"out_of_range"===r||(0,A().HB)(r)}else{if((0,y().GG)(a)){const e=a.value;if((0,C().I6)(e)){const t=(0,C().S4)({spacePermissionGroupId:e.id,spaceId:e.spaceId}),a=d.getRecordModel(t);if(!a)return;return{stringValue:(0,F().Pf)({intl:l,groupName:a.name}),actorPointer:e}}const t=(0,s().xC)({pointer:e,getRecordModel:d.getRecordModel});if(!t)return;return{stringValue:(0,s().lR)(l,t),actorPointer:e}}if("checkbox"===a.type)return{stringValue:p.name};if("title"===a.type){if("exact"===a.value.type)return{stringValue:a.value.value||l.formatMessage(R().$k.titlePlaceholder)}}else if((0,y().kO)(a)){if("exact"===a.value.type)return{stringValue:a.value.value}}else if("formula"===a.type&&"formula"===t.type){return W({collectionContextStore:e,groupBy:t,groupValue:a.value,removeUncategorizedDateOrNumber:o,environment:n,intl:l,timezone:u})}}}}function U(e){if(!e)return;const t=e.aggregationResult;return"number"===t.type?t.value:void 0}const N=(0,a(69708).YK)({chartUncategorizedGroup:{defaultMessage:"No {name}",id:"database.chartView.uncategorizedGroupLabel"}});function $(e,t){return t?n().A.formatMessage(j().zX.sprintUncategorizedGroup,{name:e??n().A.formatMessage(l().TZ.sprint_plural)}):n().A.formatMessage(N.chartUncategorizedGroup,{name:e??(0,T().oj)(void 0)})}function X(e){if("column"!==e.type&&"bar"!==e.type)return!1;{const a=e.dataConfig.type;var t;if("groups_reducer"===a)return void 0===(null===(t=e.dataConfig.aggregationConfig.stackOptions)||void 0===t?void 0:t.groupBy);if("results_reducer"===a)return!0;(0,A().HB)(a)}}function q(e,t){const a=(0,M().mg)(e).sort(((e,a)=>{const r=void 0===e.y?-1/0:e.y,o=void 0===a.y?-1/0:a.y;return t===d().S0.yDescending?o-r:r-o}));return a.forEach(((e,t)=>{e.x=t})),a}function Z(e){var t;const a=(0,c().m)(e),r="groups_reducer"===e.dataConfig.type?e.dataConfig.aggregationConfig.aggregation.aggregator:"count",o="count"===r||"sum"===r,n=null===(t=e.chartFormat)||void 0===t?void 0:t.mainSort;return a&&o&&"x-ascending"===n}function Q(e){let t=0,a=0;const r=[];let o=0;for(const n of e){const e=n.y||0,i={...n,y:e+o};r.push(i),o+=e,o>a&&(a=o),o<t&&(t=o)}return{maxDataPoint:a,minDataPoint:t,cumulatedDataPoints:r}}function J({groupedChartReducerResults:e,chartConfig:t,sortType:a}){const r=null==e?void 0:e.aggregationResults;if(!r)return;const o=t.chartFormat,n=null==o?void 0:o.mainSort;let i;"main"!==a||"y-ascending"!==n&&"y-descending"!==n||(i="y-ascending"===n?"asc":"desc");const s=null==o?void 0:o.axisHideEmptyGroups,l=function(e){const{groupResults:t,aggregationResults:a,subGroupResults:r}=e,o=new Map;return t.forEach((e=>{const t=e.value,n=(0,y().AC)(t);let i=0,s=0;if(r)r.forEach((e=>{const t=e.value,r=(0,y().AC)(t),o=(0,y().A)([r,n]),l=U(a[o])||0;l>0&&(i+=l),l<0&&(s+=l)}));else{const e=U(a[n])||0;e>i&&(i=e),e<s&&(s=e)}o.set(n,{min:s,max:i,total:s+i})})),o}({aggregationResults:r,groupResults:e.results,subGroupResults:e.subGroupResults});return{aggregationResults:r,yAxisSortOrder:i,hideZeroAggregations:s||"donut"===t.type,groupTotals:l}}},700397:(e,t,a)=>{a.d(t,{$r:()=>g,CC:()=>u,CT:()=>p,Ez:()=>f,I4:()=>v,Os:()=>d,PQ:()=>h,Ty:()=>r,Wr:()=>i,cQ:()=>n,hv:()=>m,ih:()=>l,oF:()=>s,pO:()=>c,pt:()=>y,yV:()=>o});const r=24,o=6,n=12,i=24,s=8,l=16,u=i+2*s,d=2,c=2*o+d,g=100,p=50,y=240,m=12,h=340,v=240,f=740},790063:(e,t,a)=>{function r(e){if("placeholder"!==e.type&&"groups_reducer"===e.dataConfig.type)return e.dataConfig.aggregationConfig.aggregation}a.d(t,{p:()=>r})},812480:(e,t,a)=>{a.d(t,{WK:()=>X,bO:()=>U,cS:()=>q,dU:()=>L,eD:()=>$,hC:()=>O,oz:()=>z,rq:()=>H});a(16280),a(581454);var r=a(296540),o=()=>a(484714),n=()=>a(590526),i=()=>a(401497),s=()=>a(736847),l=()=>a(956675),u=()=>a(708685),d=()=>a(62371),c=()=>a(898244),g=()=>a(452706),p=()=>a(236262),y=()=>a(69708),m=()=>a(496603),h=()=>a(534177),v=()=>a(436696),f=()=>a(896628),S=()=>a(278094),b=()=>a(800002),x=()=>a(934201),C=()=>a(422164),w=()=>a(101981),M=()=>a(574036),A=()=>a(232930),T=()=>a(396671),B=()=>a(547149),_=()=>a(339798),V=()=>a(701311),k=()=>a(261503),G=()=>a(352377),F=()=>a(95441),j=()=>a(735695),P=()=>a(497222),R=()=>a(828973),D=()=>a(34423),K=a(474848);const I=a(757695).Store.createClass(void 0,{name:"ReducerResultStore"});function z(e){const{collectionContextStore:t,groupsFormatKey:a,groupByKey:r,collectionSettingsStore:i}=e,l=(0,o().v3)(),u=(0,n().uB)(void 0,I),g=(0,n().O$)(t.normalizedSchemaStore),m=(0,n().O$)(u),h=(0,n().K8)((()=>(0,d().H2)(t.normalizedFormatStore.state,r,a)),[t,r,a]),S=(0,T().d)({groupBy:h,reducerResult:m}),b=(0,n().K8)((()=>function(e,t){return ee(e)&&(0,x().Qt)({viewType:J(e),groupByKey:t})}(t,r)),[t,r]),C=h&&"board_columns_by"===r&&(0,c().us)(h.type);return(0,K.jsxs)(j().A,{collectionSettingsStore:i,title:(0,K.jsx)(te,{collectionSettingsStore:i,collectionContextStore:t}),children:[(0,K.jsxs)(s().A,{children:[(0,K.jsx)(ae,{collectionContextStore:t,collectionSettingsStore:i,groupByKey:r,groupsFormatKey:a,groupBy:h}),h&&E({groupBy:h,schema:g})?(0,K.jsx)(oe,{collectionContextStore:t,collectionSettingsStore:i,groupByKey:r,groupsFormatKey:a,groupBy:h}):void 0,h?(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(D().T,{groupBy:h}),(0,K.jsx)(ne,{collectionContextStore:t,groupByKey:r,groupBy:h,groupsFormatKey:a}),(0,K.jsx)(ie,{groupByKey:r,collectionContextStore:t,groupsFormatKey:a,groupsDisplayState:S,groupBy:h})]}):void 0,C?(0,K.jsx)(re,{collectionContextStore:t}):void 0]}),h?(0,K.jsx)(se,{groupsFormatKey:a,collectionContextStore:t,groupByKey:r,reducerResultStore:u,groupsDisplayState:S}):void 0,(0,K.jsxs)(s().A,{topBorder:!0,children:[h&&b?(0,K.jsx)(P().A,{isGray:!0,icon:p().trashIcon,title:(0,K.jsx)(y().sA,{defaultMessage:"Remove grouping",id:"database.viewSettings.groupTab.removeButton.title"}),onClick:()=>function(e,t,a,r){const o=t.collectionViewStore();if(!o)return;B().createAndCommit({userAction:"CollectionSettingsViewGroup.handleRemoveClick",environment:e,canUndo:!0,perform:e=>{f().zA({stores:[o],update:{[a]:void 0,[r]:void 0},transaction:e})}}),(0,v().X)({environment:e,collectionContextStore:t,action:"click_remove_grouping"})}(l,t,r,a),isRedOnHover:!0}):void 0,(0,K.jsx)(F().A,{href:(0,A().x)("guides.databaseGroup"),title:(0,K.jsx)(y().sA,{defaultMessage:"Learn about grouping",id:"database.viewSettings.groupTab.learnMoreButton.title"}),analyticsFrom:"view_settings_group"})]})]})}function L(e){const{groupByPropertySchema:t}=e,a=(0,i().IS)((()=>({property:{maxWidth:"clamp(100px, 40vw, 150px)"}})),[]);return t?(0,K.jsx)(C().mA,{propertySchema:t,showIcon:!1,style:a.property}):null}function H(e,t){return"collection_group_by"===e&&"board"===t?(0,K.jsx)(y().sA,{defaultMessage:"Sub-group by",id:"database.viewSettings.groupTab.subGroupProperty"}):(0,K.jsx)(y().sA,{defaultMessage:"Group by",id:"database.viewSettings.groupTab.groupProperty"})}function E(e){const{groupBy:t,schema:a}=e,r=a[t.property];if(!r||!(0,d().Eg)(r))return;let o;if("formula"===r.type){const e=(0,u().getFormulaPropertySchemaResultType)(r);if("unknown"===e||"array"===e||"undefined"===e)return;o="block"===e?"relation":e}else o=r.type;return(0,d()._o)(o)||(0,d().Vs)(o)||"number"===o||"status"===o?o:void 0}function O(e){const t=E(e);if(t)return(0,d()._o)(t)?(0,K.jsx)(y().sA,{defaultMessage:"Date by",id:"database.viewSettings.groupByTypeTab.dateBy"}):(0,d().Vs)(t)?(0,K.jsx)(y().sA,{defaultMessage:"Text by",id:"database.viewSettings.groupByTypeTab.textBy"}):"number"===t?(0,K.jsx)(y().sA,{defaultMessage:"Number by",id:"database.viewSettings.groupByTypeTab.numberBy"}):"status"===t?(0,K.jsx)(y().sA,{defaultMessage:"Status by",id:"database.viewSettings.groupByTypeTab.statusBy"}):void 0}function Y(e){return(0,d().Ik)(e)?e:"formula"===e.type&&"date"===e.groupBy.type?e.groupBy:void 0}function W(e){return(0,d().Vh)(e)?e:"formula"===e.type&&"text"===e.groupBy.type?e.groupBy:void 0}function U(e){return"number"===e.type?e:"formula"===e.type&&"number"===e.groupBy.type?{...e.groupBy,property:e.property}:void 0}function N(e){const{groupBy:t}=e,a=E(e);if(a)if((0,d()._o)(a)){const e=Y(t);if(e)return Z(e.groupBy)}else if((0,d().Vs)(a)){const e=W(t);if(e)return Q(e.groupBy)}else if("number"===a){const e=U(t);if(e)return(0,K.jsx)(y().sA,{defaultMessage:"{start} to {end}",id:"database.groupMenu.numberGroupBy.range",values:{start:e.start,end:e.end}})}}const $=(0,y().YK)({group:{defaultMessage:"Group",id:"database.groupMenu.statusGroupBy.group"},option:{defaultMessage:"Option",id:"database.groupMenu.statusGroupBy.option"}});const X=(0,y().YK)({relative:{defaultMessage:"Relative",id:"database.groupMenu.dateGroupBy.relative"},day:{defaultMessage:"Day",id:"database.groupMenu.dateGroupBy.day"},week:{defaultMessage:"Week",id:"database.groupMenu.dateGroupBy.week"},month:{defaultMessage:"Month",id:"database.groupMenu.dateGroupBy.month"},year:{defaultMessage:"Year",id:"database.groupMenu.dateGroupBy.year"}}),q=(0,y().YK)({relative:{defaultMessage:"Relative",id:"database.groupMenu.dateGroupBy.relative"},day:{defaultMessage:"Days",id:"database.groupMenu.dateGroupBy.days"},week:{defaultMessage:"Weeks",id:"database.groupMenu.dateGroupBy.weeks"},month:{defaultMessage:"Months",id:"database.groupMenu.dateGroupBy.months"},year:{defaultMessage:"Years",id:"database.groupMenu.dateGroupBy.years"}});function Z(e){return"relative"===e?(0,K.jsx)(y().sA,{...X.relative}):"day"===e?(0,K.jsx)(y().sA,{...X.day}):"week"===e?(0,K.jsx)(y().sA,{...X.week}):"month"===e?(0,K.jsx)(y().sA,{...X.month}):"year"===e?(0,K.jsx)(y().sA,{...X.year}):void(0,h().HB)(e)}function Q(e){return"exact"===e?(0,K.jsx)(y().sA,{defaultMessage:"Exact",id:"database.groupMenu.textGroupBy.exact"}):"alphabet_prefix"===e?(0,K.jsx)(y().sA,{defaultMessage:"Alphabetical",id:"database.groupMenu.textGroupBy.alphabetical"}):void(0,h().HB)(e)}function J(e){var t;const a=null===(t=e.collectionViewStore())||void 0===t?void 0:t.getType();if(!a)throw new Error("View type was not defined.");return a}function ee(e){return e.permissionScopesStore.state.canConfigureBlock}function te({collectionSettingsStore:e,collectionContextStore:t}){const a=(0,n().K8)((()=>(0,k().S)(e)),[e]),r=(0,n().K8)((()=>J(t)),[t]);return a&&"group"===a.type?"collection_group_by"===a.groupByKey&&"board"===r?(0,K.jsx)(y().sA,{defaultMessage:"Sub-group",id:"database.viewSettings.groupTab.subGroup.title"}):(0,K.jsx)(y().sA,{defaultMessage:"Group",id:"database.viewSettings.groupTab.group.title"}):null}function ae({groupBy:e,collectionContextStore:t,collectionSettingsStore:a,groupByKey:r,groupsFormatKey:i}){const s=(0,o().v3)(),l=(0,n().O$)(t.normalizedSchemaStore),u=e?l[e.property]:void 0,d=(0,n().K8)((()=>ee(t)),[t]),c=(0,n().K8)((()=>J(t)),[t]);return(0,K.jsx)(P().A,{title:H(r,c),showChevron:!0,right:(0,K.jsx)(L,{groupByPropertySchema:u}),onClick:()=>{(0,v().X)({environment:s,collectionContextStore:t,action:"click_group_by_property",original_view_type:void 0,property_type:null==u?void 0:u.type}),_().a2({collectionSettingsStore:a,item:{type:"groupByProperty",groupByKey:r,groupsFormatKey:i}})},disabled:!d})}function re(e){const{collectionContextStore:t}=e,a=(0,o().v3)(),s=(0,n().O$)(t.canConfigureBlockStore),l=(0,n().O$)(t.normalizedFormatStore),u=(0,n().K8)((()=>(0,x().FS)(l)),[l]),d=(0,r.useCallback)((()=>{_().ut({environment:a,collectionContextStore:t})}),[a,t]),c=(0,i().IS)((()=>({textWrapper:{opacity:1}})),[]);return(0,K.jsx)(M().A,{title:(0,K.jsx)(y().sA,{id:"database.viewSettings.groupTab.colorColumns",defaultMessage:"Color columns"}),on:!u,focused:!1,onClick:d,disabled:!s,textWrapperStyle:c.textWrapper})}function oe({groupBy:e,collectionContextStore:t,collectionSettingsStore:a,groupByKey:r,groupsFormatKey:i}){const s=(0,o().v3)(),l=(0,n().O$)(t.normalizedSchemaStore),u=(0,n().K8)((()=>ee(t)),[t]),c="formula"===e.type?{...e.groupBy,property:e.property}:e;return(0,d().Ik)(c)?(0,K.jsx)(R().A,{title:O({groupBy:c,schema:l}),popupStyle:{minWidth:190},selectedKey:c.groupBy,options:d().BI.map((e=>({key:e,type:"button",title:Z(e)}))),onChange:e=>function(e,t,a,r,o){const n=(0,d().H2)(a.normalizedFormatStore.state,r,o),i=a.collectionViewStore();if(!n||!i)return;const s=Y(n);if(s){if((0,d().Ik)(n))B().createAndCommit({userAction:"CollectionSettingsViewGroup.handleDateGroupByTypeChange",environment:t,canUndo:!0,perform:t=>{f().zA({stores:[i],update:{[r]:{...n,groupBy:e},[o]:void 0},transaction:t}),"week"===e&&f().Jo(i,t)}});else if("formula"===n.type){const a={...m().cJ(s,"property"),type:"date",groupBy:e},l={...n,groupBy:a};B().createAndCommit({userAction:"CollectionSettingsViewGroup.handleDateGroupByTypeChange",environment:t,canUndo:!0,perform:t=>{f().zA({stores:[i],update:{[r]:l,[o]:void 0},transaction:t}),"week"===e&&f().Jo(i,t)}})}(0,v().X)({environment:t,collectionContextStore:a,action:"update_date_group_by"})}}(e,s,t,r,i),disabled:!u}):(0,d().Vh)(c)?(0,K.jsx)(R().A,{title:O({groupBy:c,schema:l}),popupStyle:{minWidth:190},selectedKey:c.groupBy,options:d().ah.map((e=>({key:e,type:"button",title:Q(e)}))),onChange:e=>function(e,t,a,r,o){const n=(0,d().H2)(a.normalizedFormatStore.state,r,o),i=a.collectionViewStore();if(!n||!i)return;const s=W(n);if(s){if((0,d().Vh)(n))B().createAndCommit({userAction:"CollectionSettingsViewGroup.handleTextGroupByTypeChange",environment:t,canUndo:!0,perform:t=>{f().zA({stores:[i],update:{[r]:{...n,groupBy:e},[o]:void 0},transaction:t})}});else if("formula"===n.type){const a={...m().cJ(s,"property"),groupBy:e},l={...n,groupBy:a};B().createAndCommit({userAction:"CollectionSettingsViewGroup.handleTextGroupByTypeChange",environment:t,canUndo:!0,perform:e=>{f().zA({stores:[i],update:{[r]:l,[o]:void 0},transaction:e})}})}(0,v().X)({environment:t,collectionContextStore:a,action:"update_text_group_by"})}}(e,s,t,r,i),disabled:!u}):"number"===c.type?(0,K.jsx)(P().A,{title:O({groupBy:c,schema:l}),showChevron:!0,right:N({groupBy:c,schema:l}),onClick:()=>{_().a2({collectionSettingsStore:a,item:{type:"groupByNumber",groupByKey:r,groupsFormatKey:i}})},disabled:!u}):"status"===c.type?(0,K.jsx)(R().A,{title:O({groupBy:c,schema:l}),popupStyle:{minWidth:190},selectedKey:c.groupBy,options:d().PC.map((e=>{return{key:e,type:"button",title:(t=e,"group"===t?(0,K.jsx)(y().sA,{...$.group}):"option"===t?(0,K.jsx)(y().sA,{...$.option}):void(0,h().HB)(t))};var t})),onChange:e=>function(e,t,a,r,o){const n=(0,d().H2)(a.normalizedFormatStore.state,r,o),i=a.collectionViewStore();n&&i&&"status"===(null==n?void 0:n.type)&&(B().createAndCommit({userAction:"CollectionSettingsViewGroup.handleStatusGroupByTypeChange",environment:t,canUndo:!0,perform:t=>{f().zA({stores:[i],update:{[r]:{...n,groupBy:e},[o]:void 0},transaction:t})}}),(0,v().X)({environment:t,collectionContextStore:a,action:"update_status_group_by"}))}(e,s,t,r,i),disabled:!u}):null}function ne({groupBy:e,collectionContextStore:t,groupByKey:a,groupsFormatKey:r}){const i=(0,y().tz)(),s=(0,o().v3)(),l=(0,n().K8)((()=>(0,d().Nf)(e)),[e]),u=(0,n().K8)((()=>ee(t)),[t]);if(l.length<=1)return null;const c=(0,d().Kq)(e);return(0,K.jsx)(R().A,{title:(0,K.jsx)(y().sA,{defaultMessage:"Sort",id:"database.viewSettings.groupTab.sort"}),popupStyle:{minWidth:190},selectedKey:c.type,options:l.map((t=>({key:t,type:"button",title:i.formatMessage((0,x().rA)(e,t))}))),onChange:e=>{B().createAndCommit({userAction:"CollectionSettingsViewGroup.handleSortTypeChange",environment:s,canUndo:!0,perform:o=>{(0,S().y)({sortType:e,environment:s,collectionContextStore:t,groupByKey:a,groupsFormatKey:r,transaction:o})}})},disabled:!u})}function ie({groupBy:e,groupByKey:t,collectionContextStore:a,groupsFormatKey:i,groupsDisplayState:s}){const l=(0,o().v3)(),u=(0,r.useCallback)((()=>function(e,t,a,r,o){const n=(0,d().H2)(a.normalizedFormatStore.state,t,r);if(!o)return;const{currentGroups:i}=o,s=a.collectionViewStore();if(!n||!s)return;const l=!n.hideEmptyGroups;B().createAndCommit({userAction:"CollectionSettingsViewGroup.handleHideEmptyGroupsClick",environment:e,canUndo:!0,perform:e=>{if(l){const t=i.map((e=>!1===e.hidden?{...e,hidden:void 0}:e));(0,b().o)({collectionContextStore:a,newGroups:t,groupsFormatKey:r,transaction:e})}f().zA({stores:[s],update:{[t]:{...n,hideEmptyGroups:l}},transaction:e})}}),(0,v().X)({environment:e,collectionContextStore:a,action:"toggle_hide_empty_groups"})}(l,t,a,i,s)),[l,t,a,i,s]),c=(0,n().K8)((()=>ee(a)),[a]);return(0,K.jsx)(M().A,{title:(0,K.jsx)(y().sA,{defaultMessage:"Hide empty groups",id:"database.viewSettings.groupTab.hideEmptyGroups"}),on:Boolean(e.hideEmptyGroups),focused:!1,onClick:u,disabled:!c,textWrapperStyle:{opacity:1}})}function se({groupsFormatKey:e,collectionContextStore:t,groupByKey:a,reducerResultStore:r,groupsDisplayState:o}){const i=(0,n().O$)(t.normalizedSchemaStore),s=(0,n().K8)((()=>(0,d().H2)(t.normalizedFormatStore.state,a,e)),[t,a,e]),u=(0,n().K8)((()=>{if(!s)return;const r=t.normalizedFormatStore.state;return(0,l().p)({groupBy:s,schema:i,format:r,groupsFormatKey:e,limit:g().O3,returnHiddenGroups:!0,returnPinnedGroups:"board_columns_by"===a,aggregation:void 0})}),[s,t.normalizedFormatStore,i,e,a]);return s?u?(0,K.jsx)(w().A,{id:(0,V().Q)(e),reducer:u,collectionContextStore:t,resultStore:r,render:()=>(0,K.jsx)(G().L,{collectionContextStore:t,groupBy:s,groupByKey:a,groupsFormatKey:e,groupsDisplayState:o})}):(0,K.jsx)(G().L,{collectionContextStore:t,groupBy:s,groupByKey:a,groupsFormatKey:e,groupsDisplayState:o}):null}},840503:(e,t,a)=>{a.d(t,{I:()=>s});var r=()=>a(534177),o=()=>a(720665),n=()=>a(700397),i=()=>a(960110);function s({rowId:e,heightConfig:t,ignoreDragState:a=!1}){const s=!a&&e?i().s.maybeGetDraggingHeightForRow(e):void 0;return l=s??function(e){if(e)return"fixed"===e.type?e.heightPx:void(0,r().HB)(e.type)}(t),(0,o().qE)(l??n().PQ,n().I4,n().Ez);var l}}}]);