"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[63248],{139466:(e,t,o)=>{o.d(t,{d:()=>m});o(296540);var s=()=>o(590526),a=()=>o(401497),i=()=>o(69708),n=()=>o(100622),r=()=>o(534177),l=()=>o(895876),c=()=>o(305390),d=()=>o(128295),u=()=>o(115512),p=o(474848);function m({spaceStore:e,collectionStore:t,menuListItemProps:o}){const s=(0,a().IS)((()=>({caption:{color:n().Tj.text.tertiary,fontSize:u().Kw}})),[]);return(0,p.jsx)(c().A,{caption:(0,p.jsx)("div",{style:s.caption,children:(0,p.jsx)(g,{spaceStore:e,collectionStore:t})}),store:t,...o})}function g({spaceStore:e,collectionStore:t}){const o=(0,s().K8)((()=>function({spaceStore:e,collectionStore:t}){const o=(0,l().X0)({collectionStore:t});switch(o){case"team":return null;case"private":return(0,p.jsx)(i().sA,{id:"moveToHelpers.privatePageCaptionPrefix",defaultMessage:"Private"});case"shared":return(0,p.jsx)(i().sA,{id:"moveToHelpers.sharedPageCaptionPrefix",defaultMessage:"Shared"});default:(0,r().HB)(o)}}({spaceStore:e,collectionStore:t})),[e,t]),a=(0,s().K8)((()=>(0,d().a6)(t)),[t])&&(0,p.jsx)(d().Ay,{store:t,showFullPathInTooltip:!0});return a&&o?(0,p.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[o,(0,p.jsx)("div",{style:{paddingInlineStart:4,paddingInlineEnd:4},children:"/"}),a]}):a&&!o?a:(0,p.jsx)(p.Fragment,{children:o})}},276303:(e,t,o)=>{o.d(t,{wU:()=>ge,OC:()=>Se,wc:()=>ne,NA:()=>re,L2:()=>le,oG:()=>pe,N$:()=>ve,DZ:()=>ae,_B:()=>fe,R3:()=>ye,nG:()=>ce});o(16280),o(944114),o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(354520),o(430670),o(581454),o(296540);var s=()=>o(907258),a=()=>o(755531),i=()=>o(726637),n=()=>o(383036),r=()=>o(929219),l=()=>o(295633),c=()=>o(732810),d=()=>o(710515),u=()=>o(807449),p=()=>o(26697),m=()=>o(81068),g=()=>o(736847),v=()=>o(148307),S=()=>o(484392),h=()=>o(642557),y=()=>o(617668),f=()=>o(179034),M=()=>o(519831),T=()=>o(69708),A=()=>o(778078),x=()=>o(496603),I=()=>o(534177),b=()=>o(264879),j=()=>o(541199),w=()=>o(895876),k=()=>o(284487),P=()=>o(453697),C=()=>o(103448),B=()=>o(821093),D=()=>o(110154),N=()=>o(977863);var R=()=>o(381678),O=()=>o(957606),L=()=>o(106628),K=()=>o(547149),V=()=>o(797942),E=()=>o(996857),z=()=>o(922614),q=()=>o(540742),W=()=>o(302996),_=()=>o(723085),F=()=>o(96689),H=()=>o(854150),U=()=>o(16006),Q=()=>o(299545),$=()=>o(401497),G=()=>o(100622),Y=()=>o(305390),J=o(474848);function X(e){const{store:t,menuListItemProps:o,hidePath:s,isDisabled:a,disabledTooltip:i}=e,r=(0,$().IS)((()=>({disabledTooltip:{maxWidth:240},recordMenuItem:a?{color:G().Tj.text.secondary}:{}})),[a]);return(0,J.jsx)(p().m,{placement:"left",textWrap:!0,style:r.disabledTooltip,disableTooltip:!a,renderTooltip:()=>i,render:e=>(0,J.jsx)(Y().A,{...(0,n().A)(o,e),disabled:a,store:t,hidePath:s,style:r.recordMenuItem})})}var Z=()=>o(139466);function ee({spaceStore:e,value:t,showPath:o,isCreateIn:s,onAccept:a,showDataSources:i=!0,isMovingDataSource:n}){const r=function({spaceStore:e,value:t}){const{type:o}=t;switch(o){case"page":return l().B.createChildStore(e,{table:f().ev,id:t.id});case"collection":return c().m.createChildStore(e,{table:M().Vl,id:t.id});case"space":return W().SpaceStore.createChildStore(e,{table:F().NX,id:t.id});case"team":return _().h.createChildStore(e,{table:H().yK,id:t.id});case"space-private-pages":return;default:(0,I().HB)(o)}}({spaceStore:e,value:t});if(r){if((0,E().n6)()&&r instanceof c().m)return[{key:r.id,render:t=>(0,J.jsx)(Z().d,{spaceStore:e,collectionStore:r,menuListItemProps:t}),action:()=>a(t)}];{const e=function({destinationStore:e,isMovingDataSource:t}){if(e instanceof l().B&&!(0,E().qT)({destinationStore:e,isMovingDataSource:t}))return(0,J.jsx)(T().sA,{id:"moveBlockMenu.needEditAccess.tooltip",defaultMessage:"You need “Can edit” access to “{parentName}” to move this page",values:{parentName:(0,J.jsx)(U().A,{store:e,shouldWrap:!0})}});if((0,Q().$R)(e)&&!e.canAddOrRemoveTopLevelPages())return(0,J.jsx)(T().sA,{id:"moveBlockMenu.TeamSidebarLocked.tooltip",defaultMessage:"This teamspace has its sidebar locked. You must be a teamspace owner to move to this teamspace."})}({destinationStore:r,isMovingDataSource:n});return[{key:r.id,render:t=>(0,J.jsx)(X,{store:r,menuListItemProps:t,hidePath:!!s&&!o,isDisabled:Boolean(e),disabledTooltip:e}),action:()=>a(t)}]}}}var te=()=>o(478495),oe=()=>o(338087);const se=5,ae=(0,T().YK)({createSubpage:{id:"moveToOrCreateMenu.createSubpage.description",defaultMessage:"Create a new sub-page where your cursor is, inside the current block."},newPageIn:{id:"moveToOrCreateMenu.newPageIn.description",defaultMessage:"Create a new page inside any existing page, then link to it in one go."},privatePagesTitle:{defaultMessage:"Private Pages",id:"moveBlockMenu.privatePagesMenuTitle"},teamspacesTitle:{defaultMessage:"Teamspaces",id:"moveBlockMenu.teamsSection.title"},pagesTitle:{defaultMessage:"Pages",id:"moveBlockMenu.pagesSection.title"},suggestedTitle:{defaultMessage:"Suggested",id:"moveBlockMenu.suggestedSection.title"}});function ie(e,t,o,a,r,c,d){if(!c||!d)return;if(e.query)return;const g=s().default.state.mainEditorCurrentBlockStore;if(!g)return;const S=r?l().B.createChildStore(g,{table:f().ev,id:r}):void 0,h=b().D8(S);return h?{key:h.pageStore.id,render:e=>{const t=t=>(0,J.jsx)(m().A,{...(0,n().A)(t||{},e),icon:(0,J.jsx)(u().I,{icon:y().plusIcon}),title:o.length>1?(0,J.jsx)(T().sA,{id:"moveBlockMenu.currentPage.pluralAddTitle",defaultMessage:"New sub-pages"}):(0,J.jsx)(T().sA,{id:"moveBlockMenu.currentPage.singleAddTitle",defaultMessage:"New sub-page"})});return i().A.isMobile?t():(0,J.jsx)(p().m,{renderTooltip:()=>(0,J.jsx)(C().A,{imageURL:v().A.images.tooltips.pageMenu.newSubpagePng,imageWidth:140,imageHeight:100,caption:(0,J.jsx)(T().sA,{...ae.createSubpage})}),placement:"right",delayThreshold:0,render:e=>t(e)})},action:()=>a(h.createInValue)}:void 0}function ne(){return q().x.getChosenSpaceStore()??(0,a().S)()}function re(){return q().x.getChosenSpaceViewStore()??s().default.state.sidebarSpaceViewStore}function le(e){return e.isOpen?e.queryLimit:V().p1}function ce(e,t,o){t(e);const s=z().Ay.getDatabaseType();"collection"===e.type&&K().createAndCommit({userAction:"TypedMoveToMenu.handleClick",environment:o,canUndo:!0,perform:t=>{(0,j().e)({transaction:t,databaseType:s,collectionId:e.id,spaceId:e.spaceId})}})}function de(e,t,o,s,a,i){const{query:n,savedQuickAddParent:r}=e,l=ne();if(l)return t&&!n&&"space"===r.type||"page"===r.type?ee({spaceStore:l,value:r,showPath:!0,isCreateIn:o,onAccept:s,showDataSources:i,isMovingDataSource:a}):void 0}async function ue(e,t,o,s,a){if(!z().Ay.state.isOpen||"untyped"===z().Ay.state.variant||!k().c.state)throw new Error("Trying to render section when it's either not open, untyped, or typed but uninitialized (i.e. the typed databases are not fetched yet)");const i=z().Ay.getDatabaseType(),n=(0,w().$O)(i),{typedDatabases:r}=k().c.state,l=await async function(e,t,o,s,a){const{databaseType:i,query:n,searchSessionId:r}=e,l=ne();if(!l)return[];const c=await L().T.searchActions.load();return(await c.searchCollectionsWithRecents({environment:o,query:n,limit:20,databaseType:i,parentStore:l,spaceStore:l,collectionViewBlockStore:void 0,searchSessionId:r,peopleBlocksToInclude:"none"})).results.flatMap((e=>ee({spaceStore:l,value:{type:"collection",id:e,spaceId:l.id},showPath:!0,isCreateIn:s,onAccept:s?a:e=>ce(e,a,o),isMovingDataSource:t}))).filter(I().O9)}({query:e,databaseType:i?[i]:void 0,searchSessionId:z().Ay.state.flowId},a,t,o,s);return{typedSuggestedMenuSection:{key:"suggested",render:e=>(0,J.jsx)(g().A,{...e,title:(0,J.jsx)(T().sA,{defaultMessage:"{typedItemName} databases",id:"moveBlockMenu.typedSuggestedSection.title",values:{typedItemName:(0,S().A)(n)}}),right:(0,J.jsx)(oe().m,{typedItemName:n})}),items:l.slice(0,se)},typedSuggestedResults:r}}function pe(e,t,o,a,i,n,r){var l;const{query:c,chosenSpaceStore:d}=e,{sidebarSpaceStore:p}=s().default.state,g=ae.privatePagesTitle,v=o.formatMessage(g).replace(/<[^>]*>/g,""),S=c?null===(l=(0,A().It)(c,v))||void 0===l?void 0:l.score:void 0,y=c&&(S||0)>=A().sH;if((!c||y)&&n&&(!d||(0,te().VN)({itemsToMove:a,chosenSpaceStore:d,forceShowPrivatePageOption:r,sidebarSpaceStore:p})))return{key:"private",render:e=>(0,J.jsx)(m().A,{icon:(0,J.jsx)(P().A,{size:22,userStore:(0,R()._)(t)}),title:(0,J.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[(0,J.jsx)("span",{children:(0,J.jsx)(T().sA,{...g})}),(0,O().zI)({spaceStore:d})>0?(0,J.jsx)("div",{style:{marginInlineStart:10,display:"flex",alignItems:"center"},children:(0,J.jsx)(u().I,{icon:h().lockSmallIcon,size:"sm",colorVariant:"secondary"})}):void 0]}),...e}),action:()=>{i({type:"space-private-pages",spaceId:d.id})}}}function me(e,t,o,s,a){if(e&&!s)return[];const i=ne(),n=re();if(!i||!n)return[];let r=(0,d().r)(n);return e&&(r=(0,A().Ay)(e,r,(e=>e.getName()||""))),r.flatMap((e=>ee({spaceStore:i,value:{type:"team",id:e.id,spaceId:i.id},showPath:!1,isCreateIn:t,onAccept:o,isMovingDataSource:a}))).filter(I().O9)}function ge(e){const{allItemsToMoveAreNavigable:t,blockResults:o,chosenSpaceStore:s,environment:a,isAddTo:i,isCreateIn:n,isTurnIntoPage:r,showDataSources:l,onAccept:c,parentBlockId:d,query:u,recentPageResults:p,itemsToMove:m,templateResults:v,topLevelBlockResults:S}=e,h=[],y=new Set,f=e=>{if(!e)return!1;const{key:t}=e;return!y.has(t)&&(y.add(t),!0)},M=x().oE([ie({query:u},0,m,c,d,i,n)]);!M.length||Boolean(r)||Boolean(i)||h.push({key:"defaults",render:e=>(0,J.jsx)(g().A,{...e}),items:M});const A=x().oE([...p.slice(0,5).flatMap((({blockId:e})=>ee({spaceStore:s,value:{type:"page",id:e,spaceId:s.id},showPath:!Boolean(r)&&!Boolean(i),isCreateIn:n,showDataSources:l,onAccept:c,isMovingDataSource:(0,E().vN)(m)}))),...o.slice(0,10).flatMap((({blockId:e})=>ee({spaceStore:s,value:{type:"page",id:e,spaceId:s.id},showPath:!u,isCreateIn:n,showDataSources:l,onAccept:c,isMovingDataSource:(0,E().vN)(m)}))),...S.slice(0,10).flatMap((({blockId:e})=>ee({spaceStore:s,value:{type:"page",id:e,spaceId:s.id},showPath:!u,isCreateIn:n,showDataSources:l,onAccept:c,isMovingDataSource:(0,E().vN)(m)})))].slice(0,20).filter(f));A.length>0&&h.push({key:"blocks",render:e=>(0,J.jsx)(g().A,{...e,title:(0,J.jsx)(T().sA,{...ae.suggestedTitle}),topBorder:h.length>0&&!Boolean(r)&&!Boolean(i)}),items:A});const I=x().oE(me(u,n,c,t,(0,E().vN)(m)).filter(f));I.length>0&&h.push({key:"teams",render:e=>(0,J.jsx)(g().A,{...e,title:(0,J.jsx)(T().sA,{...ae.teamspacesTitle}),topBorder:h.length>0}),items:I});const b=x().oE(v.slice(0,5).flatMap((({blockId:e})=>ee({spaceStore:s,value:{type:"page",id:e,spaceId:s.id},showPath:!0,isCreateIn:n,showDataSources:l,onAccept:c,isMovingDataSource:(0,E().vN)(m)}))).filter(f));return b.length>0&&h.push({key:"templates",render:e=>(0,J.jsx)(g().A,{...e,title:i?(0,J.jsx)(T().sA,{defaultMessage:"Add from template",id:"moveBlockMenu.addFromTemplate.title"}):(0,J.jsx)(T().sA,{defaultMessage:"Move to template",id:"moveBlockMenu.moveToTemplate.title"}),topBorder:h.length>0}),items:b}),M.length&&(Boolean(r)||Boolean(i))&&h.push({key:"defaults",render:e=>(0,J.jsx)(g().A,{...e,topBorder:h.length>0}),items:M}),h}async function ve(e,t,o,s,a,i,n){const{chosenSpaceStore:r,savedQuickAddParent:l,query:c,blockResults:d,recentPageResults:u}=e,{typedSuggestedMenuSection:p,typedSuggestedResults:m}=await ue(c,t,o,s,(0,E().vN)(a));if(z().Ay.state.isOpen&&"aggregated_type"===z().Ay.state.moveToContext)return[p].filter((e=>e.items.length>0));let v=E().Pk({recentPageResults:u,blockResults:d,suggestedPages:m});const S=new Set(E().rD(a));S.size>0&&(v=v.filter((e=>!S.has(e.blockId))));const h=x().hS(x().qI(x().oE([de({query:c,savedQuickAddParent:l},i,o,s,(0,E().vN)(a)),...v.map((({blockId:e})=>ee({spaceStore:r,value:{type:"page",id:e,spaceId:r.id},showPath:!c,isCreateIn:o,onAccept:s,isMovingDataSource:(0,E().vN)(a)})))])),(e=>e.key)),y=x().oE(me(c,o,s,n,(0,E().vN)(a))).slice(0,se),f=p.items.length>0,M={key:"teams",render:e=>(0,J.jsx)(g().A,{...e,desktopStyle:{paddingTop:f?0:6,paddingBottom:6},title:(0,J.jsx)(T().sA,{...ae.teamspacesTitle})}),items:y},A=p.items.length>0&&0===M.items.length,I={key:"pages",render:e=>(0,J.jsx)(g().A,{...e,desktopStyle:{paddingTop:A?0:6,paddingBottom:6},title:(0,J.jsx)(T().sA,{...ae.pagesTitle})}),items:h};return[p,M,I].filter((e=>e.items.length>0))}function Se(e){const{allItemsToMoveAreNavigable:t,blockResults:o,chosenSpaceStore:s,environment:a,forceShowPrivatePageOption:i,intl:n,isAddTo:r,isCreateIn:l,showDataSources:c,onAccept:d,query:u,recentPageResults:p,savedQuickAddParent:m,itemsToMove:v}=e,S=function(e,t,o,s,a,i,n,r,l,c){const d=0===e.length&&t?(0,te().Fx)({spaceStore:t,itemsToMove:s}):[];return{key:"suggested",render:e=>(0,J.jsx)(g().A,{...e,title:(0,J.jsx)(T().sA,{...ae.suggestedTitle})}),items:x().oE([pe({query:e,chosenSpaceStore:t},o,a,s,i,r,l),...d.filter((e=>E().zO(e,s))).flatMap((e=>ee({spaceStore:t,value:{type:"page",id:e.id,spaceId:t.id},showPath:!1,isCreateIn:n,onAccept:i,showDataSources:c,isMovingDataSource:(0,E().vN)(s)})))])}}(u,s,a,v,n,d,l,t,i,c),h=le(z().Ay.state),y=[...p.slice(0,3),...o.slice(0,h)],f={key:"pages",render:e=>(0,J.jsx)(g().A,{...e,title:(0,J.jsx)(T().sA,{...ae.pagesTitle})}),items:x().hS(x().qI(x().oE([de({query:u,savedQuickAddParent:m},r,l,d,(0,E().vN)(v),c),...y.map((({blockId:e,collectionId:t})=>ee({spaceStore:s,value:t?{type:"collection",id:t,spaceId:s.id}:{type:"page",id:e,spaceId:s.id},showPath:!u,isCreateIn:l,showDataSources:c,onAccept:d,isMovingDataSource:(0,E().vN)(v)})))])),(e=>e.key))},M={key:"teams",render:e=>(0,J.jsx)(g().A,{...e,title:(0,J.jsx)(T().sA,{...ae.teamspacesTitle})}),items:x().oE(me(u,l,d,t,(0,E().vN)(v))).slice(0,10)};return[S,M,f].filter((e=>e.items.length>0))}function he(e,t){return!(e instanceof c().m)&&(!!t&&e.isTemplate())}function ye(){return r().A.state.online}function fe({chosenSpaceStore:e,chosenSpaceViewStore:t,environment:o,isCreateIn:a,query:i,recentPageIds:n,searchResults:r,itemsToMove:d}){const u=[],p=[],m=[];let g=[];if(i&&r)for(const s of r){const t=s.collectionId?c().m.createChildStore(e.getPagesStore(),{table:M().Vl,id:s.collectionId}):l().B.createChildStore(e.getPagesStore(),{table:f().ev,id:s.blockId});E().zO(t,d)&&(he(t,a)?m.push(s):u.push(s))}else if(n){g=n.map((t=>({blockId:l().B.createChildStore(e.getPagesStore(),{table:f().ev,id:t}).id}))),g=g.filter((({blockId:t})=>{const o=l().B.createChildStore(e.getPagesStore(),{table:f().ev,id:t});if(E().zO(o,d)){const e={blockId:o.id};return!he(o,a)||(m.push(e),!1)}}));const i=function(e){const{environment:t,spaceStore:o,spaceViewStore:a}=e,{currentUserSettingsStore:i}=s().default.state;return a&&o?x().KC((0,D().f)({environment:t,spaceStore:o}),(0,N().c)(t,a,i),(0,B().I)({environment:t,spaceViewStore:a})??[]).filter((e=>e.isNavigableBlock())):[]}({environment:o,spaceStore:e,spaceViewStore:t});for(const e of i)if(E().zO(e,d)){const t={blockId:e.id};he(e,a)?m.push(t):p.push(t)}}return{blockResults:u,topLevelBlockResults:p,templateResults:m,recentPageResults:g}}},284487:(e,t,o)=>{o.d(t,{D:()=>a,c:()=>s});const s=o(757695).Store.createValue(void 0,{name:"CachedTypedDatabasesStore"});function a(e){const t=s.state;t&&s.setState({...t,typedDatabases:[...t.typedDatabases,e]})}},338087:(e,t,o)=>{o.d(t,{C:()=>Q,m:()=>$});o(16280),o(898992),o(823215),o(581454);var s=o(296540),a=()=>o(907258),i=()=>o(726637),n=()=>o(484714),r=()=>o(590526),l=()=>o(401497),c=()=>o(710515),d=()=>o(807449),u=()=>o(695115),p=()=>o(26697),m=()=>o(81068),g=()=>o(663639),v=()=>o(736847),S=()=>o(484392),h=()=>o(406533),y=()=>o(721479),f=()=>o(69708),M=()=>o(100622),T=()=>o(496603),A=()=>o(534177),x=()=>o(895876),I=()=>o(358648),b=()=>o(298697),j=()=>o(635462),w=()=>o(162674),k=()=>o(610101),P=()=>o(79926),C=()=>o(732810),B=()=>o(187174),D=()=>o(519831),N=()=>o(271372),R=()=>o(284487),O=()=>o(922614),L=()=>o(106628),K=()=>o(361330);function V({environment:e,spaceStore:t,joinedTeamIds:o,parentStore:s,moveToTargets:a,overrideDatabaseType:i}){const n=(0,r().K8)((()=>{const e=null==t?void 0:t.id;if(e)return function(e){if(!R().c.state)return;if(e!==R().c.state.spaceId)return;return R().c.state.typedDatabases}(e)}),[null==t?void 0:t.id]),l=(0,P().fJ)(L().T.searchActions),[{value:c,status:d}]=(0,B().Yb)((async()=>{if(n)return n;if(!t||!s)return;const o=i??O().Ay.getDatabaseType();if(!o)return;if("resolved"!==l.status)return;const r=l.value;let c=[];const d=((await r.searchCollectionsWithRecents({environment:e,query:"",limit:20,databaseType:[o],spaceStore:t,parentStore:t,collectionViewBlockStore:void 0,searchSessionId:O().Ay.state.isOpen?O().Ay.state.flowId:void 0,peopleBlocksToInclude:"none"})).results||[]).map((e=>C().m.createChildStore(s,{table:D().Vl,id:e})));return c=(0,N().v)({typedDatabases:d,blocksToFilterParents:a}),R().c.setState({typedDatabases:c,spaceId:t.id}),O().Ay.update((e=>e.isOpen&&"untyped"===e.variant?{...e,variant:"typed"}:e)),c}),[n,t,s,i,l.status,l.value,e,a],{debounce:K().tu,throttle:K().tu});return n?{success:!0,typedDatabases:n}:"resolved"===d&&c?{success:!0,typedDatabases:c}:{success:!1,loading:"resolved"!==d}}var E=()=>o(376049),z=()=>o(996857),q=()=>o(276303),W=()=>o(478495),_=()=>o(139466),F=()=>o(873643),H=o(474848);const U=7;function Q(e){const{spaceStore:t,spaceViewStore:o,blocksToMove:u,menuListStore:p,onAccept:y,moveToPagesOnly:P,forceShowPrivatePageOption:C,maxMenuItems:B=U}=e,D=(0,n().v3)(),N=(0,f().tz)(),{isMyTasksFullPage:R,sidebarSpaceStore:L}=(0,r().K8)((()=>{const{sidebarSpaceStore:e,mainEditorCurrentBlockStore:t}=a().default.state;return{isMyTasksFullPage:Boolean(t&&(0,j().s)(t.id)),sidebarSpaceStore:e}}),[]),K=(0,r().K8)((()=>(0,c().r)(o).map((e=>e.id))),[o]),Q=(0,r().K8)((()=>O().Ay.getDatabaseType()),[]),G=(0,r().K8)((()=>z().Hc()),[]),Y=V({environment:D,spaceStore:t,parentStore:t,joinedTeamIds:K,moveToTargets:u}),J=(0,l().IS)((()=>({modal:{maxHeight:"70vh"},loadingShimmer:{padding:16},privateMenuItem:{marginInlineStart:4,marginInlineEnd:4,borderRadius:4},menuItemFooterButton:{color:M().Tj.text.secondary,fill:M().Tj.icon.secondary}})),[]),X=(0,s.useCallback)((e=>{const o={key:e.id,render:o=>(0,H.jsx)(_().d,{spaceStore:t,collectionStore:e,menuListItemProps:o}),action:()=>y({type:"collection",id:e.id,spaceId:t.id})};return o}),[t,y]),Z=(0,r().K8)((()=>Y.success?Y.typedDatabases.map((e=>X(e))):[]),[Y,X]);(0,s.useEffect)((()=>{const e=O().Ay.state;e.isOpen&&"typed"===e.variant&&(0!==Z.length||Y.success||Y.loading||O().Ay.setState({...e,variant:"untyped"}))}),[Z.length,Y]);const ee=(0,r().K8)((()=>(0,W().VN)({itemsToMove:u,chosenSpaceStore:t,forceShowPrivatePageOption:C,sidebarSpaceStore:L})),[C,t,u,L]),te=(0,r().K8)((()=>{if(i().A.isMobile){const e=u.every((e=>e.isNavigableBlock()));return(0,q().oG)({query:"",chosenSpaceStore:t},D,N,u,y,e,C)}return{key:"privateMenuItem",render:e=>(0,H.jsx)("div",{style:J.privateMenuItem,children:(0,H.jsx)(F().E,{spaceStore:t,spaceViewStore:o,store:void 0,depth:0,onAccept:y,itemsToMove:u,moveToChildrenOnly:P,menuListItemProps:e,from:"moveToModalTyped"})}),action:()=>{}}}),[D,C,N,P,y,t,o,J.privateMenuItem,u]),oe=R?"home_tasks":"home_tile_tasks",se=(0,s.useMemo)((()=>({key:"helpMenuItem",render:()=>(0,H.jsx)(m().A,{style:J.menuItemFooterButton,icon:(0,H.jsx)(d().I,{icon:h().questionMarkCircleIcon}),focused:!1,title:(0,H.jsx)(f().sA,{defaultMessage:"Don’t see your database?",id:"moveToModalTyped.helpMenuItem.title"}),onClick:()=>{k().A.setState({isOpen:!0,from:oe}),(0,w().bS)({environment:D,from:oe})}}),action:()=>{}})),[D,oe,J.menuItemFooterButton]),ae=(0,s.useMemo)((()=>({key:"createDatabaseItem",render:()=>(0,H.jsx)(I().F,{spaceStore:t,spaceViewStore:o,onDatabaseCreated:()=>{E().VN({environment:D,clearSelection:!0})}}),action:()=>{}})),[D,t,o]);if(!Y.success||0===Z.length)return(0,H.jsx)("div",{style:J.loadingShimmer,children:(0,H.jsx)(b().A,{paragraphs:[{lineHeight:18,lineMargin:4,sectionWidths:[100],repeat:1,sectionMargin:0},{lineHeight:14,lineMargin:4,sectionWidths:[100,40],repeat:1,sectionMargin:-2}]})});if(!Q)throw new Error("Trying to show typed moveTo modal when database type is not available.");const ie=(0,x().$O)(Q),ne=T().oE([{key:"suggested",render:e=>(0,H.jsx)(v().A,{...e,title:G?(0,H.jsx)(f().sA,{defaultMessage:"{typedItemName} databases",id:"moveToModalTyped.suggestedMenuSection.title",values:{typedItemName:(0,S().A)(ie)}}):(0,H.jsx)(f().sA,{defaultMessage:"Where would you like to create your {typedItemName}?",id:"moveToModalTyped.suggestedMenuSection.titleNew",values:{typedItemName:ie}}),right:G?(0,H.jsx)($,{typedItemName:ie}):null}),items:Z.slice(0,B)},ee&&(0,A().O9)(te)&&{key:"other",render:e=>(0,H.jsx)(v().A,{...e,title:(0,H.jsx)(f().sA,{defaultMessage:"Other",id:"moveToModalTyped.otherSection.title"})}),items:[te]},!G&&{key:"create-new-footer",render:e=>(0,H.jsx)(v().A,{...e,topBorder:!0}),items:[se,ae]}]);return(0,H.jsx)("div",{style:J.modal,children:(0,H.jsx)(g().A,{initialFocus:0,type:g().O.Vertical,sections:ne||[],store:p})})}function $(e){const{typedItemName:t}=e,o=(0,f().tz)(),s=(0,l().IS)((()=>({tooltip:{width:220},iconButton:{height:18,width:18,padding:0,marginTop:-4,marginBottom:-4,marginInlineEnd:-4}})),[]);return i().A.isMobile?null:(0,H.jsx)(p().m,{placement:"bottom",style:s.tooltip,textWrap:!0,renderTooltip:()=>(0,H.jsx)(f().sA,{defaultMessage:"{typedItemName} properties will be kept when moving to these locations",id:"moveTypedMenu.tooltip",values:{typedItemName:(0,S().A)(t)}}),render:e=>(0,H.jsx)(u().A,{ariaLabel:o.formatMessage({id:"moveToModalTyped.helpIcon.ariaLabel",defaultMessage:"Help icon for moving typed pages."}),icon:y().questionMarkCircleSmallIcon,colorVariant:"secondary",style:s.iconButton,...e})})}},358648:(e,t,o)=>{o.d(t,{F:()=>K});var s=o(296540),a=()=>o(484714),i=()=>o(401497),n=()=>o(584262),r=()=>o(97789),l=()=>o(833243),c=()=>o(617668),d=()=>o(201980),u=()=>o(69708),p=()=>o(100622),m=()=>o(44729),g=()=>o(384944),v=()=>o(857783),S=()=>o(812182),h=()=>o(845147),y=()=>o(284487),f=()=>o(106702),M=()=>o(590526),T=()=>o(394888),A=()=>o(89002),x=()=>o(31511),I=()=>o(687681),b=()=>o(241021),j=()=>o(838239),w=()=>o(227358);class k extends(()=>o(757695))().Store{getInitialState(){return!1}}const P=new k;var C=o(474848);const B=(0,u().YK)({title:{id:"tasksCreateNewDatabase.modal.title2",defaultMessage:"Name your private task database"},placeholder:{id:"tasksCreateNewDatabase.modal.placeholder",defaultMessage:"{username}’s to-do list"},create:{id:"tasksCreateNewDatabase.modal.create",defaultMessage:"Create database"}}),D=380;function N(e){const{handleCreateTaskDatabase:t}=e,o=(0,u().tz)(),a=(0,f().$)(),i=(0,M().K8)((()=>null==a?void 0:a.getDisplayName(o)),[a,o]),[n,r]=(0,s.useState)(""),l=(0,M().O$)(P),c=(0,s.useCallback)((()=>{n.trim()&&(t(n),P.setState(!1))}),[n,t]),d=(0,s.useCallback)((()=>{P.setState(!1)}),[]),p=(0,s.useCallback)((e=>{"Enter"===e.key&&c()}),[c]),m=(0,s.useCallback)((e=>{r(e.target.value)}),[r]);return(0,C.jsx)(T().s,{isOpen:l,onDismiss:d,areaConstraint:{height:{type:"unlimited",scroll:"allow"},width:{type:"fixed",length:D}},render:()=>(0,C.jsx)(A().t,{showDismissButton:!0,header:(0,C.jsx)(j().Y,{iconAndTitle:(0,C.jsx)(w().Z,{iconGroup:I().u,iconColorPalette:"gray",iconColorVariant:"tertiary",title:o.formatMessage(B.title)})}),footer:(0,C.jsx)(b().a,{layout:"vertical",primaryButtons:[{buttonType:"primary",label:o.formatMessage(B.create),onClick:c}],secondaryButtons:[{buttonType:"dismiss"}]}),children:(0,C.jsx)(x().A,{value:n,onChange:m,placeholder:o.formatMessage(B.placeholder,{username:i}),autoFocus:!0,onKeyDown:p})})})}var R=()=>o(295304),O=()=>o(547149),L=()=>o(497222);function K(e){const{spaceStore:t,spaceViewStore:o,onDatabaseCreated:f}=e,M=(0,a().v3)(),T=(0,u().tz)(),A=(0,i().IS)((()=>({icon:{fill:p().Tj.icon.secondary},title:{color:p().Tj.text.secondary}})),[]),x=(0,s.useCallback)((e=>{let s,a;O().createAndCommit({userAction:"createNewTaskDatabaseMenuItem.handleCreateTodoList",environment:M,canUndo:!0,perform(i){var c;s=g().Wv({environment:M,transaction:i,type:"collection_view",inMemoryRecordCache:M.defaultRecordCache.inMemoryRecordCache}),m().NI({childStore:s,parentStore:t,transaction:i});const u=h().initializeApp({environment:M,spaceViewStore:o,appUri:r().a6,presetUri:"notion://tasks_collection_typedDBpreset",appParentStore:t,temporaryContainerBlockStore:s,transaction:i,from:"my_tasks",skipNavigation:!0});a=null==u||null===(c=u[0])||void 0===c?void 0:c.getCollectionStoreIfSingleSource(),a&&R().R9({environment:M,store:a.getNameStore(),value:(0,d().x9d)(e),transaction:i}),S().HK({id:"database_creation_toast",title:T.formatMessage({id:"moveToModalTyped.databaseCreated.title",defaultMessage:"Database created"}),message:T.formatMessage({id:"moveToModalTyped.databaseCreated.message",defaultMessage:'"{name}" has been created'},{name:e}),presentationType:"persistent",icon:l().checkmarkCircleSmallIcon,iconColorPalette:"green",iconColorVariant:"accentPrimary",actions:{primary:{title:T.formatMessage({id:"moveToModalTyped.databaseCreated.openDatabase",defaultMessage:"Open database"}),onAction:()=>{v().uK({environment:M,store:null==u?void 0:u[0],pageVisitSource:n().y8.PersonalHomePage}),S().UW("database_creation_toast")}}}})}}),a&&((0,y().D)(a),f&&f(a.id))}),[M,T,f,t,o]);return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(N,{handleCreateTaskDatabase:x}),(0,C.jsx)(L().A,{showChevron:!1,icon:c().plusIcon,iconStyle:A.icon,title:(0,C.jsx)(u().sA,{defaultMessage:"New private task database",id:"moveToModalTyped.createDatabaseItem.title"}),textWrapperStyle:A.title,onClick:()=>{P.setState(!0)}})]})}},478495:(e,t,o)=>{o.d(t,{Cr:()=>y,Fx:()=>f,VN:()=>M});o(898992),o(823215),o(354520),o(581454),o(737550),o(296540);var s=()=>o(907258),a=()=>o(484714),i=()=>o(590526),n=()=>o(401497),r=()=>o(295633),l=()=>o(69708),c=()=>o(272509),d=()=>o(435761),u=()=>o(292664),p=()=>o(110154),m=()=>o(968172),g=()=>o(996857),v=()=>o(644434),S=()=>o(873643),h=o(474848);function y(e){const{spaceStore:t,spaceViewStore:o,itemsToMove:r,moveToPagesOnly:c,forceShowPrivatePageOption:u,onAccept:m}=e,y=(0,l().tz)(),T=(0,a().v3)(),A=(0,n().IS)((()=>({modal:{height:374,maxHeight:"70vh",paddingBottom:12},body:{width:"100%"}})),[]),{teams:x}=(0,d().LN)({spaceStore:t}),I=(0,i().K8)((()=>x.filter((e=>e.canAddOrRemoveTopLevelPages())).slice(0,7)),[x]),b=(0,i().K8)((()=>f({spaceStore:t,itemsToMove:r}).filter((e=>(0,g().zP)(e,r)))),[t,r]),j=(0,i().K8)((()=>(0,p().f)({environment:T,spaceStore:t}).filter((e=>(0,g().zP)(e,r)))),[T,t,r]),w=(0,i().O$)(s().AppStoreSidebarSpaceStore),k=(0,i().K8)((()=>{if(M({itemsToMove:r,chosenSpaceStore:t,forceShowPrivatePageOption:u,sidebarSpaceStore:w}))return(0,h.jsx)(S().E,{spaceStore:t,spaceViewStore:o,store:void 0,depth:0,onAccept:m,itemsToMove:r,moveToChildrenOnly:c},"MoveToModal private item")}),[m,r,t,o,c,u,w]);return t&&o?(0,h.jsx)("div",{style:A.modal,children:(0,h.jsx)("div",{style:A.body,children:(0,h.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[(0,h.jsx)(v().J,{spaceStore:t,spaceViewStore:o,itemStores:b,addedItems:[k],moveToPagesOnly:c,depth:0,title:y.formatMessage({defaultMessage:"Suggested",id:"moveToModal.suggestedSection.title"}),onAccept:e.onAccept,itemsToMove:e.itemsToMove}),I&&I.length>0?(0,h.jsx)(v().J,{spaceStore:t,spaceViewStore:o,itemStores:I,moveToPagesOnly:c,depth:0,title:y.formatMessage({defaultMessage:"Teamspaces",id:"moveToModal.teamsSection.title"}),onAccept:e.onAccept,itemsToMove:e.itemsToMove}):void 0,j.length>0?(0,h.jsx)(v().J,{spaceStore:t,spaceViewStore:o,itemStores:j,moveToPagesOnly:c,depth:0,title:y.formatMessage({defaultMessage:"Workspace",id:"moveToModal.workspaceSection.title"}),onAccept:e.onAccept,itemsToMove:e.itemsToMove}):void 0]})})}):null}function f({spaceStore:e,itemsToMove:t}){const o=(0,g().iH)(t),s=m().A.getWithoutSubscribing(e.id).map((({store:e})=>e)).filter((e=>(null==e?void 0:e.pathIsAccessibleAndAlive())&&!function(e,t){return t.some((t=>"block"===t.table&&t.id===e.id))}(e,t)&&e.id!==o));return s.slice(0,7)}function M({itemsToMove:e,chosenSpaceStore:t,forceShowPrivatePageOption:o,sidebarSpaceStore:s}){const a=(0,c().I)(t),i=e.every((e=>e instanceof r().B&&(0,u().K)(e))),n=s&&t.id!==s.id;return!a&&(o||n||!i)}},540742:(e,t,o)=>{o.d(t,{x:()=>i});o(898992),o(672577);var s=()=>o(907258);class a extends(()=>o(757695))().Store{getInitialState(){return{chosenSpaceId:void 0}}getChosenSpaceId(){const{chosenSpaceId:e}=this.state,{sidebarSpaceStore:t}=s().default.state;return e||(null==t?void 0:t.id)}getChosenSpaceStore(){var e;return null===(e=this.getChosenSpaceViewStore())||void 0===e?void 0:e.getSpaceStore()}getChosenSpaceViewStore(){const{chosenSpaceId:e}=this.state,{sidebarSpaceViewStore:t,currentUserRootStore:o}=s().default.state;if(!e&&t)return t;if(e&&o){return o.getSpaceViewStores().find((t=>t.getSpaceId()===e))}}}const i=new a},572748:(e,t,o)=>{o.d(t,{t:()=>u});o(581454);var s=()=>o(484714),a=()=>o(590526),i=()=>o(187174),n=()=>o(69708),r=()=>o(810703),l=()=>o(683236),c=()=>o(276303),d=()=>o(996857);function u({allItemsToMoveAreNavigable:e,forceShowPrivatePageOption:t,isAddTo:o,isCreateIn:u,isTurnIntoPage:p,showDataSources:m,onAccept:g,parentBlockId:v,query:S,searchResults:h,itemsToMove:y}){const f=(0,n().tz)(),M=(0,s().v3)(),T=(0,a().K8)((()=>(0,c().wc)()),[]),A=(0,a().K8)((()=>(0,c().NA)()),[]),[x]=(0,i().Yb)((async()=>T?await(0,r().pw)({spaceStore:T,currentUserId:M.currentUser.id}):void 0),[T,M.currentUser.id]),[I]=(0,i().Yb)((async()=>!S&&T?await l()._P(T,T.id):void 0),[S,T]),{blockResults:b,topLevelBlockResults:j,templateResults:w,recentPageResults:k}=(0,a().K8)((()=>{if(!T||!A)return{blockResults:[],topLevelBlockResults:[],templateResults:[],recentPageResults:[]};const e=h.results.map((e=>({blockId:e.id,collectionId:e.isSurrogateCollection?e.collectionId:void 0})));return(0,c()._B)({chosenSpaceStore:T,chosenSpaceViewStore:A,environment:M,isCreateIn:u,query:S,recentPageIds:I.value,searchResults:e,itemsToMove:y})}),[T,A,M,u,S,I.value,h.results,y],{useDeepEqual:!0}),P=(0,a().K8)((()=>d().n6()),[]),[C]=(0,i().Yb)((async()=>{if(P&&T&&x.value)return await(0,c().N$)({chosenSpaceStore:T,savedQuickAddParent:x.value,query:S,blockResults:b,recentPageResults:k},M,u,g,y,o,e)}),[P,T,x.value,S,b,k,M,u,g,y,o,e]);return(0,a().K8)((()=>P?C.value??[]:T&&x.value?u?(0,c().wU)({allItemsToMoveAreNavigable:e,blockResults:b,chosenSpaceStore:T,environment:M,isAddTo:o,isCreateIn:u,showDataSources:m,isTurnIntoPage:p,onAccept:g,parentBlockId:v,query:S,recentPageResults:k,itemsToMove:y,templateResults:w,topLevelBlockResults:j}):(0,c().OC)({allItemsToMoveAreNavigable:e,blockResults:b,chosenSpaceStore:T,environment:M,forceShowPrivatePageOption:t,intl:f,isAddTo:o,isCreateIn:u,showDataSources:m,onAccept:g,query:S,recentPageResults:k,savedQuickAddParent:x.value,itemsToMove:y}):[]),[e,b,T,M,t,f,o,u,p,g,v,S,k,x.value,P,y,w,j,C.value,m])}},587989:(e,t,o)=>{o.d(t,{c:()=>p});o(898992),o(672577);var s=o(296540),a=()=>o(449279),i=()=>o(663639),n=()=>o(736847),r=()=>o(69708),l=()=>o(284371),c=o(474848);function d({loading:e,menuListItemProps:t}){const s=(0,o(401497).IS)((()=>({button:{display:"flex",flexDirection:"row",alignItems:"center",gap:8,color:o(100622).Tj.text.tertiary,...o(726637).A.isMobile?{fontSize:l().J.UIRegular.mobile,lineHeight:l().K_.UIRegular.mobile,padding:4}:{fontSize:l().J.UIRegular.desktop,lineHeight:l().K_.UIRegular.desktop,margin:"0px 4px 4px",padding:4,borderRadius:4}}})),[]);return(0,c.jsxs)(o(718827).Ay,{style:s.button,...t,children:[(0,c.jsx)(o(807449).I,{icon:o(886358).arrowStraightDownFillSmallIcon,size:"sm",colorVariant:"tertiary"}),(0,c.jsx)(r().sA,{defaultMessage:"Load more",id:"moveToMenu.loadMoreButtonTitle"}),e?(0,c.jsx)(o(98126).A,{size:"sm"}):void 0]})}const u=s.memo(d);function p({sections:e,error:t,menuListStore:o,initialFocus:l,onLoadMore:d,canLoadMore:p,loading:m}){const g=(0,s.useMemo)((()=>p&&(null==e?void 0:e.find((e=>"pages"===e.key)))),[p,e]);if(t)return(0,c.jsx)(n().A,{children:(0,c.jsx)(a().u,{title:(0,c.jsx)(r().sA,{defaultMessage:"Something went wrong.",id:"moveBlockMenu.errorOnMove.label"})})});if(e&&0===e.length)return(0,c.jsx)(n().A,{children:(0,c.jsx)(a().u,{title:(0,c.jsx)(r().sA,{defaultMessage:"No results",id:"moveBlockMenu.noResults.label"})})});const v=[...e||[],...g?[{key:"moveTo load more section",render:e=>(0,c.jsx)(n().A,{disableDesktopPadding:!0,...e}),items:[{key:"moveTo load more button",render:e=>(0,c.jsx)(u,{menuListItemProps:e,loading:m}),action:d}]}]:[]];return(0,c.jsx)("div",{children:(0,c.jsx)(i().A,{type:i().O.Vertical,initialFocus:l,sections:v,store:o})})}},644434:(e,t,o)=>{o.d(t,{J:()=>v});o(898992),o(581454),o(737550),o(296540);var s=()=>o(717137),a=()=>o(590526),i=()=>o(401497),n=()=>o(295633),r=()=>o(302501),l=()=>o(700500),c=()=>o(100622),d=()=>o(496603),u=()=>o(284371),p=()=>o(996857),m=()=>o(873643),g=o(474848);function v(e){const{spaceStore:t,spaceViewStore:o,itemStores:v,depth:S,addedItems:h,moveToPagesOnly:y,itemsToMove:f,onAccept:M}=e,T=(0,a().K8)((()=>{const e=v?d().oE(v.map((e=>{if((0,p().zP)(e,f)){const s=e instanceof n().B&&e.getType()===l().xd.alias,a=s?e.getAliasTargetStore():void 0,i=a instanceof n().B?a:e,r=e instanceof n().B&&e.isCollectionView()&&e.hasMultipleOwnedCollections()&&f.some((e=>e instanceof n().B));return(0,g.jsx)(m().E,{spaceStore:t,spaceViewStore:o,store:i,depth:S,onAccept:M,itemsToMove:f,isAlias:s,moveToChildrenOnly:y&&!(i instanceof n().B)||r},e.id)}}))):[];return h?[...h,...e]:e}),[v,h,y,f,M,t,o,S]),A=(0,i().IS)((()=>({sectionHeader:{color:c().Tj.text.secondary,fontSize:12,fontWeight:u().Wy.medium,paddingTop:12,paddingInlineEnd:14,paddingBottom:4,paddingInlineStart:14}})),[]);return(0,g.jsxs)(s().A,{debugName:"MoveToOutliner",capture:!0,allowEsc:!0,allowLeft:!0,children:[e.title?(0,g.jsx)("div",{style:A.sectionHeader,children:(0,g.jsx)(r().A,{isSmall:!0,children:e.title})}):void 0,(0,g.jsx)("div",{children:T})]})}},873643:(e,t,o)=>{o.d(t,{E:()=>K});o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(354520);var s=o(296540),a=()=>o(484714),i=()=>o(590526),n=()=>o(401497),r=()=>o(295633),l=()=>o(732810),c=()=>o(723085),d=()=>o(718827),u=()=>o(807449),p=()=>o(700500),m=()=>o(642557),g=()=>o(854150),v=()=>o(69708),S=()=>o(100622),h=()=>o(95313),y=()=>o(187820),f=()=>o(16006),M=()=>o(453697),T=()=>o(205981),A=()=>o(606273),x=()=>o(381678),I=()=>o(396301),b=()=>o(821093),j=()=>o(381195),w=()=>o(898808),k=()=>o(996857),P=()=>o(922614),C=()=>o(644434),B=o(474848);const D=100,N=14,R=4;function O(e){return(e+1)*N}function L({depth:e,isSidebar:t}){const o=(0,n().IS)((()=>({container:{display:"flex",flexDirection:"row"},noChildrenLabelItem:{paddingInlineStart:O(e)+R,fontSize:14,paddingBottom:6,color:S().Tj.text.tertiary}})),[e]);return(0,B.jsxs)("div",{style:o.container,children:[(0,B.jsx)(A().h,{isSidebar:t}),(0,B.jsx)("div",{style:o.noChildrenLabelItem,children:(0,B.jsx)(v().sA,{defaultMessage:"No pages inside",id:"moveToMenu.outliner.noPagesInside.placeholder"})})]})}function K(e){const{store:t,spaceStore:o,spaceViewStore:N,depth:K,isAlias:V,menuListItemProps:E,from:z,itemsToMove:q}=e,W=(0,a().v3)(),[_,F]=s.useState(!1),H=(0,n().IS)((()=>({outlinerItem:{display:"flex",flexDirection:"row",fontSize:14,height:28,paddingInlineStart:"moveToModalTyped"===z?O(K)-R:O(K),color:S().Tj.text.primary,alignItems:"center"},icon:{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,flexGrow:0,width:22,height:18,marginInlineEnd:R,position:"relative"},button:{..."moveToModalTyped"===z?{borderRadius:4}:{}}})),[K,z]);function U(){const e=P().Ay.state,o=e.isOpen?e.flowId:void 0;F(!_),h().aM(W,{flowId:o,is_toggled:!_,destination_type:t?t.table:"private_pages"})}const Q=(0,i().K8)((()=>t?t instanceof c().h?(0,B.jsx)("div",{style:H.icon,children:(0,B.jsx)(w().x,{disabled:!0,store:t,size:18})}):(0,B.jsxs)("div",{style:H.icon,children:[(0,B.jsx)(y().B6,{icon:t.getIcon(),iconRecordCategory:(0,y().Te)(t),isEmptyPage:t instanceof r().B&&t.isEmptyPage(),size:18,disabled:!0}),V?(0,B.jsx)(T().H,{size:"xs"}):void 0]}):(0,B.jsx)(M().A,{size:16,userStore:(0,x()._)(W),style:{marginInlineStart:3}})),[t,H.icon,W,V]),$=(0,i().K8)((()=>t?t.table===g().yK?"private"!==t.getTeamAccessLevel()?(0,B.jsx)("div",{style:{maxWidth:"80%"},children:(0,B.jsx)(f().A,{store:t})}):(0,B.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",maxWidth:"80%",gap:R},children:[(0,B.jsx)(f().A,{store:t}),(0,B.jsx)(u().I,{icon:m().lockSmallIcon,size:"sm",colorVariant:"secondary"})]}):(0,B.jsx)("div",{style:{maxWidth:"80%"},children:(0,B.jsx)(f().A,{store:t})}):(0,B.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6,marginInlineStart:7},children:[(0,B.jsx)(v().sA,{defaultMessage:"Private pages",id:"outliner.addToPrivatePages"}),(0,B.jsx)(u().I,{icon:m().lockSmallIcon,size:"sm",colorVariant:"secondary"})]})),[t]),G=(0,i().K8)((()=>{const e=new Set([p().xd.page,p().xd.collectionViewPage,p().xd.collectionView,p().xd.alias]),o=new Set([p().xd.factory]);let s=[];return t?t instanceof c().h?s=(0,j().O)({teamStore:t}):t instanceof l().m?s=[]:t.isCollectionView()?s=t.hasSingleOwnedCollection()?[]:t.getCollectionStores()??[]:t instanceof r().B&&(s=(0,I().yD)({rootStore:t,shouldSkipItemTypes:o,shouldShowItemTypes:e})):s=(0,b().I)({environment:W,spaceViewStore:N})??[],s=s.filter((e=>(0,k().zP)(e,q))),s}),[t,N,W,q]),Y=(0,i().K8)((()=>!(t instanceof l().m)&&(!(t instanceof r().B&&t.isCollectionView())||G.length>0)),[t,G]);const J=!0,X=0!==G.length?(0,B.jsx)(C().J,{spaceStore:o,spaceViewStore:N,itemStores:G,depth:K+1,onAccept:e.onAccept,itemsToMove:q}):(0,B.jsx)(L,{depth:K,isSidebar:J});return(0,B.jsxs)("div",{...E,children:[(0,B.jsx)(d().Ay,{onClick:function(){e.moveToChildrenOnly&&Y?U():t?t instanceof r().B?e.onAccept({type:"page",id:t.id,spaceId:o.id}):t instanceof l().m?e.onAccept({type:"collection",id:t.id,spaceId:o.id}):e.onAccept({type:"team",id:t.id,spaceId:o.id}):e.onAccept({type:"space-private-pages",spaceId:o.id})},style:H.button,children:(0,B.jsxs)("div",{style:H.outlinerItem,children:[Y?(0,B.jsx)(A().f,{isSidebar:J,fill:!0,icon:"chevron",open:_,color:S().Tj.icon.secondary,onClick:U}):(0,B.jsx)(A().h,{isSidebar:J}),Q,$]})}),_&&K<D?X:void 0]})}},963248:(e,t,o)=>{o.d(t,{Xy:()=>oe,n5:()=>te,v8:()=>J});o(898992),o(823215),o(354520),o(581454);var s=o(296540),a=()=>o(907258),i=()=>o(755531),n=()=>o(717137),r=()=>o(782482),l=()=>o(726637),c=()=>o(484714),d=()=>o(590526),u=()=>o(401497),p=()=>o(991003),m=()=>o(574359),g=()=>o(404905),v=()=>o(388926),S=()=>o(807449),h=()=>o(552712),y=()=>o(98126),f=()=>o(546926),M=()=>o(631524),T=()=>o(302501),A=()=>o(890492),x=()=>o(81068),I=()=>o(736847),b=()=>o(452004),j=()=>o(803960),w=()=>o(765974),k=()=>o(344417),P=()=>o(245241),C=()=>o(69708),B=()=>o(100622),D=()=>o(496603),N=()=>o(284371),R=()=>o(895876),O=()=>o(284487),L=()=>o(419357),K=()=>o(187820),V=()=>o(933117),E=()=>o(232930),z=()=>o(272509),q=()=>o(135599),W=()=>o(996857),_=()=>o(572748),F=()=>o(922614),H=()=>o(540742),U=()=>o(587989),Q=()=>o(276303),$=()=>o(478495),G=()=>o(338087),Y=o(474848);function J(e){const{autocompleteQuery:t,blocksToMove:o,forceShowPrivatePageOption:s=!1,isAddTo:a,isCreateIn:i,isTurnIntoPage:n,onAccept:r,parentBlockId:l}=e,c=(0,d().uB)(void 0,b().$),u=(0,d().K8)((()=>(0,Q().wc)()),[]),p=(0,d().K8)((()=>(0,Q().L2)(F().Ay.state)),[]),m=(0,d().K8)((()=>(0,W().iH)(o)),[o]),g=(0,q().W)({type:P().Vz.BlocksInSpace,query:t,limit:p,source:"move_to_menu",filters:{requireEditPermissions:!1,excludeTemplates:!1},options:{disable:!1,overrideSpaceStore:u},excludedBlockIds:[m].filter((e=>void 0!==e)),peopleBlocksToInclude:"none"}),v=(0,d().K8)((()=>o.length>0&&o.every((e=>e.isNavigableBlock()))),[o]),S=(0,_().t)({allItemsToMoveAreNavigable:v,forceShowPrivatePageOption:s,isAddTo:a,isCreateIn:i,isTurnIntoPage:n,onAccept:r,parentBlockId:l,query:t,searchResults:g,itemsToMove:o});return(0,Y.jsx)(X,{...e,isLoading:g.isResultsLoading,allItemsToMoveAreNavigable:v,autocompleteComponent:(0,Y.jsx)(U().c,{sections:S,error:void 0,menuListStore:c,initialFocus:t?0:void 0,loading:g.isResultsLoading,canLoadMore:g.hasMoreResults,onLoadMore:()=>{var e;return null===(e=g.fetchAdditionalServerResultsOnChange)||void 0===e?void 0:e.call(g,p)}})})}function X(e){const{blocksToMove:t,isCreateIn:o,onAccept:a,isAddTo:i,isTurnIntoPage:c,autocompleteQuery:u,onAutocompleteQueryChange:p,onMouseEnter:m,onCancel:g,desktopWidth:v,forceShowPrivatePageOption:S=!1,isLoading:h,allItemsToMoveAreNavigable:y,autocompleteComponent:M}=e,T=(0,d().uB)(void 0,b().$),x=(0,d().K8)((()=>(0,Q().R3)()),[]),I=(0,d().K8)((()=>F().Ay.state.isOpen),[]),j=(0,d().K8)((()=>W().n6()),[]);if((0,s.useEffect)((()=>{H().x.reset()}),[I]),!i&&!o&&!I)return null;let w;w=l().A.isMobile?{onMouseEnter:m,menuType:f().gu.Modal,title:c?(0,Y.jsx)(C().sA,{defaultMessage:"Add to another page",id:"moveBlockMenu.mobileNewPageInj.label"}):i?(0,Y.jsx)(C().sA,{defaultMessage:"Add new page in",id:"moveBlockMenu.mobileAddTo.label"}):(0,Y.jsx)(C().sA,{defaultMessage:"Move to",id:"moveBlockMenu.mobileMoveTo.label"}),right:(0,Y.jsx)(C().sA,{defaultMessage:"Done",id:"moveBlockMenu.rightDoneButton.label"}),onClickRight:g,height:"100%"}:{onMouseEnter:m,menuType:f().gu.Popup,width:v};const k=!Boolean(u)&&!l().A.isMobile||j&&!Boolean(u);return(0,Y.jsxs)(n().A,{debugName:"MoveToOrCreateMenu",capture:!0,allowMenuList:!0,allowEsc:!0,allowLeft:!0,allowTabUntab:!1,allowUndo:!1,children:[(0,Y.jsx)(r().N,{debugName:"MoveToOrCreateMenu",capture:!0,onEsc:g}),(0,Y.jsxs)(A().A,{...w,onClick:e=>{e.stopPropagation()},footer:(0,Y.jsx)(te,{isCreateIn:o,isAddTo:i,allItemsToMoveAreNavigable:y}),children:[x?(0,Y.jsx)(oe,{autocompleteQuery:u,onAutocompleteQueryChange:p,isAddTo:i,isTurnIntoPage:c,menuListStore:T,isLoading:h}):void 0,k?(0,Y.jsx)(ee,{onAccept:a,blocksToMove:t,menuListStore:T,allItemsToMoveAreNavigable:y,forceShowPrivatePageOption:S}):M]})]})}function Z(){var e,t;return(null===(e=(0,Q().wc)())||void 0===e?void 0:e.id)!==(null===(t=(0,i().S)())||void 0===t?void 0:t.id)}function ee({onAccept:e,blocksToMove:t,menuListStore:o,allItemsToMoveAreNavigable:s,forceShowPrivatePageOption:a}){const i=(0,c().v3)(),n=(0,d().K8)((()=>(0,Q().wc)()),[]),r=(0,d().K8)((()=>(0,Q().NA)()),[]),l=(0,d().K8)((()=>W().n6()),[]),u=(0,d().K8)((()=>(0,z().I)(n)),[n]);if(!r||!n)return null;const p=!s||u;return l?(0,Y.jsx)(G().C,{spaceStore:n,spaceViewStore:r,onAccept:t=>(0,Q().nG)(t,e,i),blocksToMove:t,menuListStore:o,moveToPagesOnly:p,forceShowPrivatePageOption:a,maxMenuItems:5}):(0,Y.jsx)($().Cr,{spaceStore:n,spaceViewStore:r,onAccept:e,itemsToMove:t,moveToPagesOnly:p,forceShowPrivatePageOption:a})}function te({isCreateIn:e,isAddTo:t,allItemsToMoveAreNavigable:o}){const s=(0,C().tz)(),i=(0,c().v3)(),{currentUserRootStore:n,sidebarSpaceStore:r}=(0,d().K8)((()=>{const{currentUserRootStore:e,sidebarSpaceStore:t}=a().default.state;return{currentUserRootStore:e,sidebarSpaceStore:t}}),[]),u=(0,d().K8)((()=>(0,Q().wc)()),[]),p=(0,d().K8)((()=>o&&!(null!=r&&r.getDisableMoveToSpace())&&!e&&!t),[o,r,e,t]),h=(0,d().K8)((()=>null==n?void 0:n.getSpaceViewStores()),[n]),y=(0,d().K8)((()=>D().hS(D().oE(null==h?void 0:h.map((e=>{const t=e.getSpaceStore();return!(0,z().I)(t)&&t}))),(e=>e.id))),[h]);if(!n||!u||!r)return null;if(!p)return null;const f={menuTitle:s.formatMessage({defaultMessage:"Workspaces",id:"moveBlockMenu.spaceSwitcher.menuTitle"}),items:y,selectedItem:u,onSelect:e=>{H().x.setState({chosenSpaceId:e.id})},getKey:e=>e.id,renderItem:e=>(0,Y.jsx)(x().A,{...e,isChecked:e.value.id===u.id,title:(0,m().G)(i,e.value),icon:(0,Y.jsx)(K().B6,{icon:e.value.getIcon(),isEmptyPage:!1,size:20,disabled:!0,title:(0,m().G)(i,e.value)})}),renderOrigin:e=>(0,Y.jsxs)(M().p,{size:l().A.isMobile?"xl":"sm",style:{fontWeight:"normal",fontSize:l().A.isMobile?16:12,flexShrink:1},...e,children:[(0,Y.jsx)(K().B6,{disabled:!0,icon:u.getIcon(),iconRecordCategory:"workspace",isEmptyPage:!1,size:l().A.isMobile?22:16,title:u.getName(),style:{marginInlineEnd:l().A.isMobile?6:4}}),(0,Y.jsx)(g().j,{children:(0,m().G)(i,u)}),(0,Y.jsx)(S().I,{icon:j().arrowChevronSingleDownIcon,style:{width:l().A.isMobile?18:10,marginInlineStart:4,fill:B().Tj.icon.tertiary}})]}),width:150};return(0,Y.jsxs)("div",{children:[(0,Y.jsx)(v().A,{size:1}),(0,Y.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",padding:"4px"},children:(0,Y.jsx)(V().A,{...f},"space-switcher")})]})}function oe({isLoading:e,autocompleteQuery:t,onAutocompleteQueryChange:o,isDataSource:s,isAddTo:a,isTurnIntoPage:i,menuListStore:n}){const r=(0,C().tz)(),c=(0,d().K8)((()=>W().n6()&&F().Ay.state.isOpen&&"typed"===F().Ay.state.variant&&!O().c.state),[]),m=(0,d().K8)((()=>function({intl:e,isDataSource:t,isAddTo:o,isTurnIntoPage:s}){if(t)return e.formatMessage({defaultMessage:"Move data source to…",id:"moveToMenuRenderer.moveDataSourceTo.label"});if(Z())return e.formatMessage({defaultMessage:"Duplicate page…",id:"moveToMenuRenderer.duplicateToSpace.label"});if(W().n6()){const t=F().Ay.getDatabaseType();if(W().Hc()){const o=(0,R().$O)(t);return e.formatMessage({defaultMessage:"Move {typedItemName} to…",id:"moveToMenuRenderer.moveTo.typedLabel"},{typedItemName:o})}{const o=(0,R().$O)(t);return e.formatMessage({defaultMessage:"Search for a {typedItemName} database…",id:"moveToMenuRenderer.createIn.typedLabel"},{typedItemName:o})}}return s?e.formatMessage({defaultMessage:"Search page to add in…",id:"moveToMenuRenderer.addNewPageIn.label"}):o?e.formatMessage({defaultMessage:"Search page to add to…",id:"moveToMenuRenderer.addTo.label"}):e.formatMessage({defaultMessage:"Move page to…",id:"moveToMenuRenderer.moveTo.teamLabel"})}({intl:r,isDataSource:s,isAddTo:a,isTurnIntoPage:i})),[r,s,a,i]),g=(0,u().IS)((()=>({moveToAnotherSpaceMessage:{background:B().Tj.palette.gray[30],marginTop:l().A.isMobile?12:8,marginInlineStart:l().A.isMobile?16:12,marginInlineEnd:l().A.isMobile?16:12,padding:l().A.isMobile?12:8,borderRadius:6},moveToAnotherSpaceIcon:{fill:B().Tj.palette.orange[400],marginInlineEnd:4,alignSelf:"center",display:"inline-block",verticalAlign:"text-bottom"},moveToAnotherSpaceLink:{color:B().Tj.palette.gray[500],fontWeight:N().Wy.semibold,marginTop:4}})),[]),v=(0,d().K8)((()=>Z()),[]),f=(0,p().A)(e,400,0);return(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(I().A,{extraTopPadding:!l().A.isMobile,children:(0,Y.jsx)(L().Ay,{onCancel:()=>{F().Ay.state.isOpen&&F().Ay.setState({...F().Ay.state,isOpen:!1})},preventCaptureArrowShortcuts:!t,disabled:c,focus:!l().A.isMobile||void 0,focusAfterAnimation:!0,value:t,onChange:e=>{o(e.target.value),n.setState({...n.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})},placeholder:m,inputLeft:(0,Y.jsx)(L().Zf,{icon:k().magnifyingGlassSmallIcon}),inputRight:f&&(0,Y.jsx)(y().A,{style:{marginInlineEnd:2}}),style:{marginBottom:-2}})}),v?(0,Y.jsxs)(T().A,{isMultiline:!0,isSecondaryColor:!1,style:g.moveToAnotherSpaceMessage,children:[(0,Y.jsx)(S().I,{icon:w().exclamationMarkTriangleFillIcon,size:"xs",style:g.moveToAnotherSpaceIcon}),(0,Y.jsx)("span",{children:(0,Y.jsx)(C().sA,{id:"moveBlockMenu.duplicateToSpace.message",defaultMessage:"You can only duplicate pages into another workspace — not move them."})}),(0,Y.jsx)(h().N,{href:(0,E().x)("guides.duplicateToSpace"),style:g.moveToAnotherSpaceLink,children:(0,Y.jsx)(C().sA,{id:"moveBlockMenu.duplicateToSpace.learnMoreLink",defaultMessage:"Learn more"})})]}):void 0]})}}}]);