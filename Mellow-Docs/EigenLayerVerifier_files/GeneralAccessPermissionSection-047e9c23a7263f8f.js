"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[77651,77916],{1195:(e,i,s)=>{s.d(i,{A:()=>n});class t extends(()=>s(757695))().Store{getInitialState(){return{trustedDomainPointers:[],enabledTrustedEmailDomains:[],trustedDomains:[],lastEmitData:{value:-1,spaceId:void 0}}}getForSpace(e){if(!e)return;const{enabledTrustedEmailDomains:i,trustedDomainPointers:s,trustedDomains:t,lastEmitData:n}=this.state;return n.spaceId===e.id?{enabledTrustedEmailDomains:i,trustedDomainPointers:s,trustedDomains:t}:void 0}shouldRefetchTrustedDomains({currentSpaceId:e,emitValue:i}){const{spaceId:s,value:t}=this.state.lastEmitData;return e!==s||i!==t}}const n=t},6104:(e,i,s)=>{s.d(i,{S:()=>l});s(296540);var t=()=>s(792057),n=()=>s(69708),o=()=>s(931938),r=()=>s(418739),a=s(474848);async function l(e){const{environment:i,store:s,newPermissionItem:l}=e,c=s.getSpaceStore(),d=(0,o().k)({environment:i,spaceStore:c}),m=(0,r().j)({environment:i,store:s,newPermissionItem:l});if(void 0===d&&void 0===m)return{wasDuplicatable:d,willBeDuplicatable:m,confirmedChange:void 0};if(!d||m)return{wasDuplicatable:d,willBeDuplicatable:m,confirmedChange:void 0};const{accept:p}=await t().Gh({message:(0,a.jsx)(n().sA,{defaultMessage:"This is the custom landing page for this workspace.",id:"customGettingStarted.changePermissionConfirm.title"}),description:(0,a.jsx)(n().sA,{defaultMessage:"If other workspace members cannot view this page, they will have Notionâ€™s default landing page installed instead. Are you sure you want to change the page permissions?",id:"customGettingStarted.changePermissionConfirm.description"}),acceptLabel:(0,a.jsx)(n().sA,{defaultMessage:"Change permission",id:"customGettingStarted.changePermissionConfirm.button.text"})});return{wasDuplicatable:d,willBeDuplicatable:m,confirmedChange:p}}},31082:(e,i,s)=>{s.d(i,{Bw:()=>d,V0:()=>v});s(898992),s(354520),s(581454);var t=()=>s(564884),n=()=>s(848538),o=()=>s(534177),r=()=>s(134696),a=()=>s(579627),l=()=>s(680074),c=()=>s(159026);function d(e){const{environment:i,internalDomains:s,inviteResults:t,destination:d,metadata:v}=e;0!==t.length&&(function(e){var i;const{addedPermissions:s,environment:t,internalDomains:n,metadata:o,destination:a}=e;if(0===s.length)return;const c=s.map((e=>e.invite.inviteTarget)),d=s.map((e=>e.blockPermissionItem)),m=s.filter(g).filter((e=>void 0!==e.invite.internalDomain)).map((e=>e.inviteeUserId));r().Jg(t,{domainType:(0,l().FX)(),internal_domains:n??[],invite_flow_id:o.inviteFlowId,invite_message_length:(null===(i=o.inviteMessage)||void 0===i?void 0:i.length)??0,invite_origin:o.inviteOrigin,invite_targets:c,invitee_ids_with_internal_domain:m,invitee_ids_with_internal_domain_enforced:[],is_onboarding:!1,is_space:!1,permission_items:d,role:a.role,share_menu_session_id:o.shareMenuSessionId})}({addedPermissions:t.filter(h),environment:i,internalDomains:s,destination:d,metadata:v}),function(e){var i;const{createdMembers:s,environment:t,internalDomains:o,metadata:c,destination:d}=e;if(0===s.length)return;const m=s.map((e=>e.invite.inviteTarget)),p=s.map((e=>a().zV(e.spaceActor))),u=s.filter((e=>void 0!==e.invite.internalDomain)).map((e=>e.inviteeUserId)),g=s.filter((e=>e.wasInternalDomainEnforced)).map((e=>e.inviteeUserId));if(r().Jg(t,{domainType:(0,l().FX)(),internal_domains:o??[],invite_flow_id:c.inviteFlowId,invite_message_length:(null===(i=c.inviteMessage)||void 0===i?void 0:i.length)??0,invite_origin:c.inviteOrigin,invite_targets:m,invitee_ids_with_internal_domain:u,invitee_ids_with_internal_domain_enforced:g,is_onboarding:!1,is_space:!0,permission_items:p,role:(0,n().ps)(d.spaceMembershipType),share_menu_session_id:c.shareMenuSessionId}),g.length>0){const e=o?o.map((e=>e.url)):[];r().hp(t,{invite_flow_id:c.inviteFlowId,invite_origin:c.inviteOrigin,user_ids:g,internal_domains:e})}}({createdMembers:t.filter(b),environment:i,internalDomains:s,destination:d,metadata:v}),function(e){const{createdGuestRequests:i,environment:s,destination:t,metadata:a}=e;if(0===i.length)return;const l=i.filter((e=>void 0!==e.invite.internalDomain)).map((e=>{var i;return null===(i=e.invite.invitee)||void 0===i?void 0:i.email})).filter(o().O9);r().xF(s,{internal_guest_enforcement:!1,invite_flow_id:a.inviteFlowId,is_bot:!1,is_internal_domain:l.length>0,invitee_emails_with_internal_domain:l,invitee_emails_with_internal_domain_enforced:[],role:t.role,space_role:(0,n().ps)(t.spaceMembershipType),user_count:i.length})}({createdGuestRequests:t.filter(m),environment:i,destination:d,metadata:v}),function(e){const{createdRestrictedMemberRequests:i,environment:s,destination:t,metadata:a}=e;if(0===i.length)return;const l=i.filter((e=>void 0!==e.invite.internalDomain)).map((e=>{var i;return null===(i=e.invite.invitee)||void 0===i?void 0:i.email})).filter(o().O9);r().Ie(s,{invite_flow_id:a.inviteFlowId,is_internal_domain:l.length>0,role:t.role,space_role:(0,n().ps)(t.spaceMembershipType),user_count:i.length})}({createdRestrictedMemberRequests:t.filter(p),environment:i,destination:d,metadata:v}),function(e){const{createdMemberRequests:i,environment:s,destination:t,metadata:a}=e;if(0===i.length)return;const l=i.filter((e=>void 0!==e.invite.internalDomain)).map((e=>{var i;return null===(i=e.invite.invitee)||void 0===i?void 0:i.email})).filter(o().O9),d=i.filter((e=>e.wasInternalDomainEnforced)).map((e=>{var i;return null===(i=e.invite.invitee)||void 0===i?void 0:i.email})).filter(o().O9);r().RH(s,{from:"share_menu",invite_flow_id:a.inviteFlowId,invite_space_role_selection:c().NJ.workspace_member,is_bot:!1,is_internal_domain:l.length>0,internal_guest_enforcement:d.length>0,invitee_emails_with_internal_domain:l,invitee_emails_with_internal_domain_enforced:d,role:t.role,space_role:(0,n().ps)(t.spaceMembershipType),user_count:i.length})}({createdMemberRequests:t.filter(u),environment:i,destination:d,metadata:v}))}function m(e){return"createdGuestRequest"===e.type}function p(e){return"createdRestrictedMemberRequest"===e.type}function u(e){return"createdMemberRequest"===e.type}function g(e){return"addedUserPermission"===e.type}function h(e){return!(!g(e)&&!function(e){return"addedGroupPermission"===e.type}(e))}function b(e){return"createdMember"===e.type}function v({environment:e,spaceId:i,pageId:s,pageVisibility:n,hasTrustedDomainPermission:o,hasPublicShareLinkPermission:r,shareMenuSessionId:a}){(0,t().u)({environment:e,event:{eventName:"general_access_menu_open",eventProperties:{spaceId:i,pageId:s,pageVisibility:n,hasTrustedDomainPermission:o,hasPublicShareLinkPermission:r,shareMenuSessionId:a}}})}},51069:(e,i,s)=>{s.d(i,{A:()=>z});s(517642),s(658004),s(733853),s(845876),s(432475),s(515024),s(731698);var t=s(296540),n=()=>s(230711),o=()=>s(907258),r=()=>s(726637),a=()=>s(590526),l=()=>s(401497),c=()=>s(396896),d=()=>s(302501),m=()=>s(424400),p=()=>s(792071),u=()=>s(68263),g=()=>s(179034),h=()=>s(519831),b=()=>s(798880),v=()=>s(743246),f=()=>s(695608),y=()=>s(69708),I=()=>s(100622),S=()=>s(231704),x=()=>s(313171),P=()=>s(453697),j=()=>s(268153),_=()=>s(499764),A=()=>s(741615),w=()=>s(795523),k=()=>s(979340);var M=()=>s(466797),C=()=>s(484714),T=()=>s(295633),N=()=>s(493552),B=()=>s(992214),R=()=>s(201980),O=()=>s(347160),D=()=>s(678634),L=s(474848);function E(e){const{role:i,table:s,type:t,mostPermissivePermissions:n}=e,o=(0,C().v3)(),l=(0,y().tz)(),c=n&&n.length>0?n[0]:void 0,d=null==c?void 0:c.permissionItem,p=Boolean(d&&(0,u().i4)(d)&&d.can_create_pages_in_collection)||!1,{label:h}=(0,j().R)({type:t,role:i,table:s,isRemovable:!1,isNoneOverride:!1,canCreate:p}),b=null==c?void 0:c.permissionItem,v=null==c?void 0:c.from,f=(0,a().K8)((()=>{if(!b||"user_permission"!==b.type||(null==v?void 0:v.table)!==g().ev)return;const e=v.blockId,i=new(T().B)(o,{id:e,table:g().ev}).getTitleValue();return(0,R().q4_)(i)||(0,B().L)(l)}),[v,b,o,l]),I=b&&(0,u().PW)(b.role)?function(e){const{permissionItem:i,permissionFrom:s,pageName:t}=e;let n;return n="user_permission"===i.type?(0,L.jsx)(y().sA,{id:"searchTargetPermissionItem.userPermission",defaultMessage:"user access on {pageName}",values:{pageName:t}}):function(e){switch(e.type){case"space_permission":case"explicit_team_permission":case"team_permission":case"team_owner_permission":case"explicit_team_owner_permission":case"explicit_team_guest_permission":case"group_permission":case"collection_property_permission":return!0;default:return!1}}(i)?(0,L.jsx)(D()._,{permissionItem:i,from:s}):void 0,n?(0,L.jsx)(y().sA,{id:"PermissionRoleSelect.currentAccessSection.viaSource",defaultMessage:"via {permissionItemName}",values:{permissionItemName:(0,L.jsx)(N().D,{as:"span",styleKey:"captionSemibold",children:n})}}):null}({permissionItem:b,permissionFrom:v,pageName:f}):void 0;return(0,L.jsx)(m().Ay,{title:(0,L.jsx)(y().sA,{...h}),caption:I,shouldWrapCaption:!0,style:r().A.isMobile?O().$w:void 0})}var W=()=>s(810727);function K(e){const{userValue:i,isInvited:s}=e,t=(0,l().IS)((()=>({iconPlaceholder:{height:r().A.isMobile?M().Bj:M().Ev,width:r().A.isMobile?M().Bj:M().Ev,borderRadius:20},invitedIcon:{borderRadius:20,outlineColor:I().Tj.palette.gray[300]}})),[]);return i?(0,L.jsx)(P().A,{borderStyle:s?"dashed":void 0,iconStyle:s?t.invitedIcon:void 0,userValue:i,size:r().A.isMobile?M().Bj:M().Ev}):(0,L.jsx)(G,{style:t.iconPlaceholder})}function V(e){const{userValue:i,guestLabel:s}=e,t=(0,y().tz)(),r=(0,a().K8)((()=>{const{currentUserStore:e}=o().default.state;return!!e&&(!!i&&e.id===i.id)}),[i]),m=(0,l().eP)(),p=(0,l().IS)((()=>({titlePlaceholder:{height:8,width:81,borderRadius:4},titleYouIndicator:{color:"dark"===m?I().Tj.text.secondary:I().Tj.text.tertiary}})),[m]),u=(0,a().O$)(o().AppStoreSidebarSpaceStore),g="restricted_member"===(0,n().V_)({spaceStore:u,userId:null==i?void 0:i.id});if(!i)return(0,L.jsx)(G,{style:p.titlePlaceholder});const h=(0,f().c6)(t,i);return(0,L.jsxs)(c().fI,{gap:6,alignItems:"center",children:[(0,L.jsx)(d().A,{className:"notranslate",children:r?(0,L.jsx)(y().sA,{id:"cellMemberAvatar.displayName.title",defaultMessage:"{userFullDisplayName} <youIndicatorText>(You)</youIndicatorText>",values:{userFullDisplayName:h,youIndicatorText:e=>(0,L.jsx)("span",{style:p.titleYouIndicator,children:e})}}):h}),s?(0,L.jsx)(S().w,{labelType:s}):void 0,g?(0,L.jsx)(x().L,{}):void 0]})}function U(e){const{userValue:i,permissionRole:s}=e,t=(0,l().IS)((()=>({subtitlePlaceholder:{height:8,width:139,borderRadius:4,marginTop:10}})),[]);if(r().A.isMobile&&s){const e=(0,j().R)({type:"user_permission",role:s,table:"block",isRemovable:!1}).label;return(0,L.jsx)(d().A,{isSmall:!0,children:(0,L.jsx)(y().sA,{...e})})}return null!=i&&i.email?(0,L.jsx)(d().A,{isSmall:!0,children:i.email}):(0,L.jsx)(G,{style:t.subtitlePlaceholder})}function G(e){const i=(0,l().IS)((()=>({placeholder:{...e.style,background:I().Tj.background.tertiaryTranslucent}})),[e.style]);return(0,L.jsx)("div",{style:i.placeholder})}function F(e){const{userValue:i,permissionItem:s,store:t}=e,n=(0,y().tz)(),o=p().Bj6.fromValue(b().oo,i),r=null==o?void 0:o.getDisplayName(n),a=!(null!=i&&i.onboarding_completed||null!=i&&i.mobile_onboarding_completed),l=(0,W().z)({permissionItem:s,targetType:"user",targetName:r,store:t});return a?(0,L.jsx)(y().sA,{defaultMessage:"User has not yet created an account",id:"blockPermissionsSettings.notOnboarded.message"}):l||null}const z=function(e){const{store:i,userPermission:l,fromPermissionWrapper:c}=e,d=(0,a().K8)((()=>s(849255).L.createChildStore(i,{table:b().oo,id:l.permissionItem.user_id}).getValue()),[i,l.permissionItem.user_id]),p=function(){const e=(0,a().O$)(o().AppStoreSidebarSpaceStore),i=(0,A().lh)({spaceId:null==e?void 0:e.id});return(0,a().K8)((()=>{if(!e)return!1;const s=(0,w().AI)(i);return(0,k().dL)(s)||(0,k().Pg)(s)}),[e,i])}(),f=(0,a().K8)((()=>{const e=i.getSpaceStore(),s=(null==d?void 0:d.onboarding_completed)||(null==d?void 0:d.mobile_onboarding_completed);if(null!=d&&d.id&&(s||!p)){const s=(0,n().sE)(e,d.id);return(0,S().p)({spaceUserStore:s,userId:d.id,store:i})}if(null!=d&&d.id&&!s&&p)return"invited"}),[i,d,p]),I="invited"===f,x="on"===(0,s(477293).r)("improved_sharing_ui_highest_access_level")&&!I,P=(0,a().K8)((()=>{if(!x)return null;const t=l.permissionItem.user_id,n=(0,s(486674).a)();if(!n)return null;const o=(0,_().ex)({userId:t,store:n,userPermissionGroupIds:e.userPermissionGroupIds??new Set}),r=(null==o?void 0:o[0])??l,a=r.from,c=r.permissionItem,d=c.role,m=c.type,p=a.table===g().ev&&"blockId"in a&&a.blockId===i.id&&"user_permission"===m&&c.user_id===l.permissionItem.user_id;return{mostPermissiveRole:d,mostPermissiveRoleOnPage:o,table:i.table===v().C0?v().C0:i.table===h().Vl?h().Vl:g().ev,permissionType:l.permissionItem.type,isCurrentAccessFromThisUserPermission:p}}),[x,l,i,e.userPermissionGroupIds]),j=(0,t.useCallback)((()=>{if(!P)return null;const{mostPermissiveRole:e,mostPermissiveRoleOnPage:i,table:t,permissionType:n}=P;if(!e)return null;return{section:{key:"current_access_section",render:e=>(0,L.jsx)(s(736847).A,{...e,title:(0,L.jsx)(y().sA,{id:"PermissionRoleSelect.currentAccessSection.title",defaultMessage:"Current access"}),topBorder:!1}),items:[{key:"current_access_level_item",render:()=>(0,L.jsx)(E,{role:e,table:t,type:n,mostPermissivePermissions:i}),action:()=>{}}]},lowestSelectableRole:i?(0,_().Kz)(i):void 0}}),[P]),C=x&&P&&!P.isCurrentAccessFromThisUserPermission&&(0,u().PW)(P.mostPermissiveRole)?P.mostPermissiveRole:void 0;return(0,L.jsx)("div",{children:(0,L.jsx)(M().Ay,{store:i,permissionItem:l.permissionItem,from:l.from,ignoreLocalHoverState:e.ignoreLocalHoverState,icon:(0,L.jsx)(K,{userValue:d,isInvited:I}),title:(0,L.jsx)(V,{userValue:d,guestLabel:f}),subtitle:I?void 0:(0,L.jsx)(U,{userValue:d,permissionRole:l.permissionItem.role}),selectHeader:r().A.isMobile?(0,L.jsx)(m().Ay,{title:(0,L.jsx)(V,{userValue:d,guestLabel:f}),caption:(0,L.jsx)(U,{userValue:d}),icon:(0,L.jsx)(K,{userValue:d}),desktopIconStyle:{marginInlineStart:16},style:{background:"transparent",border:"none"}}):void 0,selectFooter:e.selectFooter,showInherited:e.showInherited,upgradeButtonName:"user_permission_item",isRemovableOverride:e.isRemovableOverride,fromPermissionWrapper:c,roleItemOverrides:e.roleItemOverrides,nonInheritedTooltip:e.tooltip?e.tooltip:(0,L.jsx)(F,{userValue:d,permissionItem:l.permissionItem,store:i}),menuListItemProps:e.menuListItemProps,style:e.style,renderCurrentAccessSection:j,displayRoleInButton:C,...e.permissionItemArgs})},l.permissionItem.user_id)}},64744:(e,i,s)=>{s.d(i,{v:()=>le,O:()=>ce});s(898992),s(354520),s(672577),s(737550);var t=s(296540),n=()=>s(907258),o=()=>s(59226),r=()=>s(726637),a=()=>s(590526),l=()=>s(401497),c=()=>s(118307),d=()=>s(807449),m=()=>s(695115),p=()=>s(552712),u=()=>s(736847),g=()=>s(406533),h=()=>s(68263),b=()=>s(179034),v=()=>s(519831),f=()=>s(69708),y=()=>s(100622),I=()=>s(147294),S=()=>s(453597),x=(s(944114),s(581454),()=>s(564884)),P=()=>s(300474),j=()=>s(135168),_=()=>s(484714),A=()=>s(770063),w=()=>s(250910),k=()=>s(546926),M=()=>s(631524),C=()=>s(160432),T=()=>s(890492),N=()=>s(81068),B=()=>s(663639),R=()=>s(302107),O=()=>s(852424),D=()=>s(922189),L=()=>s(340498),E=s(474848);const W={viewBox:"0 0 20 20",fittedViewBox:"1.59 1.59 16.81 16.81",svg:(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)("path",{d:"M10 5.875c.345 0 .625.28.625.625v2.875H13.5a.625.625 0 1 1 0 1.25h-2.875V13.5a.625.625 0 1 1-1.25 0v-2.875H6.5a.625.625 0 1 1 0-1.25h2.875V6.5c0-.345.28-.625.625-.625"}),(0,E.jsx)("path",{d:"M8.497 2.222c.83-.83 2.176-.83 3.005 0l6.276 6.275c.83.83.83 2.176 0 3.006l-6.275 6.275c-.83.83-2.176.83-3.006 0l-6.275-6.275a2.125 2.125 0 0 1 0-3.006zm2.122.884a.875.875 0 0 0-1.238 0L3.106 9.38a.875.875 0 0 0 0 1.238l6.275 6.275a.875.875 0 0 0 1.238 0l6.275-6.275a.875.875 0 0 0 0-1.238z"})]})},K=(0,L().wt)("plusDiamond",W,"default");var V=()=>s(347160),U=()=>s(528093),G=()=>s(704658),F=()=>s(547149),z=()=>s(437487),H=()=>s(99756);function q({store:e,collectionStore:i,disabled:s}){const n=(0,_().v3)(),o=(0,a().uB)(void 0,c().A),l=(0,t.useCallback)((e=>(0,E.jsx)(Y,{buttonPopupEvents:e,disabled:s,collectionStore:i})),[s,i]);return i?(0,E.jsx)(w().A,{popupType:r().A.isMobile?w().z.BottomSheet:w().z.Popup,forceInitialInbound:!0,buttonPopupStore:o,renderOrigin:l,originGap:r().A.isMobile?void 0:8,style:{},onClick:()=>{(0,x().u)({environment:n,event:{eventName:"click_add_db_row_permission_rule",eventProperties:{collection_view_block_id:e.id,collection_id:i.id,share_menu_session_id:z().Ay.state.sessionId}}})},render:s=>(0,E.jsx)($,{blockStore:e,collectionStore:i,onCreateRuleComplete:()=>s.close()}),onDismiss:()=>{},onClose:()=>{}}):null}function Y({buttonPopupEvents:e,disabled:i,collectionStore:s}){const t=(0,l().IS)((()=>({button:{height:"unset",...r().A.isMobile?{width:"100%",padding:"6px 0px"}:{padding:"6px 8px"}},textContainer:{display:"flex",flexDirection:"column",paddingInlineStart:r().A.isMobile?12:10},buttonSubtitle:{color:y().Tj.text.tertiary,fontSize:12},iconContainer:{background:y().Tj.blue.background.secondaryTranslucent},icon:{fill:y().Tj.blue.icon.accentPrimary}})),[]),n=(0,a().K8)((()=>s.getPropertyPermissionItems().validItems.length>0),[s]);return(0,E.jsxs)(M().p,{...e,style:t.button,disabled:i,disabledFeedback:i,children:[(0,E.jsx)(H().A,{type:"square",iconType:"function",iconFn:K,containerStyle:t.iconContainer,iconStyle:t.icon}),(0,E.jsxs)("div",{style:t.textContainer,children:[(0,E.jsx)("span",{children:(0,E.jsx)(f().sA,{id:"shareTab.collectionPropertyPermissions.addNewPropertyPermissionButton.title",defaultMessage:"Add a new rule"})}),n||r().A.isMobile?void 0:(0,E.jsx)("span",{style:t.buttonSubtitle,children:(0,E.jsx)(f().sA,{id:"shareTab.collectionPropertyPermissions.addNewPropertyPermissionButton.subtitle",defaultMessage:"Ex. Anyone selected in Assignees should have edit access"})})]})]})}function $({blockStore:e,collectionStore:i,onCreateRuleComplete:s}){const n=(0,_().v3)(),o=(0,a().K8)((()=>i.getSchema()),[i]),c=(0,a().K8)((()=>{const{validItems:e}=i.getPropertyPermissionItems();return e}),[i]),m=(0,t.useMemo)((()=>o?Object.entries(o).filter((([e,i])=>"person"===(null==i?void 0:i.type))).map((([e,i])=>e)):[]),[o]),p=r().A.isMobile?36:28,g=(0,l().IS)((()=>({roleSelectButton:{display:"flex",justifyContent:"space-between",background:y().Tj.background.secondary,border:`1px solid ${y().Tj.border.secondary}`,marginTop:12,marginBottom:10,height:p},createRuleButton:{width:"100%",height:p},noPropertiesAvailableMenuItem:{color:y().Tj.text.tertiary},disabled:{opacity:.3}})),[p]),h=(0,a().K8)((()=>(0,j().f)(i)),[i]),b=null==h?void 0:h.id,v=(0,U()._)({name:"collection_property_permissions",spaceId:b,userId:n.currentUser.id}),[I,S]=t.useState("read_and_write"),[w,M]=t.useState(void 0),W=(0,t.useCallback)((()=>{M({type:"page_creator"})}),[]),K=(0,t.useCallback)((e=>{M({type:"person",property_id:e}),"editor"===I&&S("read_and_write")}),[I]),H=function({existingPropertyPermissionItems:e,personPropertyIds:i,collectionSchema:s,selectedPropertyInfo:t,selectPersonProperty:n,selectPageCreatorProperty:o}){const r=(0,f().tz)(),c=(0,l().DP)(),m=(0,_().v3)(),p=(0,P().r)(),u=(0,U()._)({name:"collection_property_permissions",spaceId:p,userId:m.currentUser.id});return(0,a().K8)((()=>{const a=e.some((e=>"page_creator"===e.property_info.type)),l=!("unavailable"===(null==u?void 0:u.type)&&u.upsell);if(!l)return[];const m=[];for(const o of i){if(e.some((e=>"person"===e.property_info.type&&e.property_info.property_id===o)))continue;const i=null==s?void 0:s[o];i&&m.push({key:o,action:()=>{n(o)},render:e=>(0,E.jsx)(N().A,{...e,title:i.name,disabled:!l,icon:(0,E.jsx)(O().zB,{type:i.type,icon:i.icon,size:L().Ev.sm,theme:c,style:{fill:y().Tj.icon.secondary}}),isChecked:"person"===(null==t?void 0:t.type)&&(null==t?void 0:t.property_id)===o,focused:e.focused,buttonStyle:{padding:0}})})}return a||m.push({key:"page_creator",action:()=>{o()},render:e=>(0,E.jsx)(N().A,{...e,title:(0,R().mf)({intl:r,collectionSchema:s}),disabled:!l,icon:(0,E.jsx)(d().I,{icon:D().personCircleFillIcon}),desktopIconStyle:{fill:y().Tj.icon.secondary},isChecked:"page_creator"===(null==t?void 0:t.type),focused:e.focused,buttonStyle:{padding:0}})}),m}),[e,u,i,s,t,c,r,n,o])}({existingPropertyPermissionItems:c,personPropertyIds:m,collectionSchema:o,selectedPropertyInfo:w,selectPersonProperty:K,selectPageCreatorProperty:W});(0,t.useEffect)((()=>{if(1===H.length&&!w){const e=H[0];"page_creator"===e.key?W():"string"==typeof e.key&&K(e.key)}}),[H,w,W,K]);const q=(0,t.useCallback)((()=>{if(!i||!w)return;const t=(0,A().G_)(i,i.pointer,"permissions");s(),F().createAndCommit({userAction:"AddNewPropertyPermissionPopup.onCreateRule",environment:n,canUndo:!0,perform:e=>{F().applyOperation({store:t,operation:{pointer:t.pointer,command:"setPermissionItem",path:t.path,args:{type:"collection_property_permission",property_info:w,role:I}},transaction:e})}}),(0,x().u)({environment:n,event:{eventName:"create_db_row_permission_rule",eventProperties:{permission_property_info:w,permission_role:I,share_menu_session_id:z().Ay.state.sessionId,collection_id:i.id,collection_view_block_id:e.id}}})}),[i,n,w,I,s,e]),Y=(0,t.useMemo)((()=>[..."page_creator"===(null==w?void 0:w.type)?["editor"]:[],"read_and_write","comment_only","reader"]),[w]),$=(0,a().K8)((()=>{const e=[],i="unavailable"===(null==v?void 0:v.type)&&v.upsell,s=!i;if(i){const i={key:"upgrade_section",items:[{key:"upgrade_button",action:()=>{},render:()=>(0,E.jsx)(G().UpgradeButton,{source:"collection_property_permissions",display:"button",upsell:v.upsell,featureName:"collection_property_permissions",spaceStore:h})}],render:e=>(0,E.jsx)(u().A,{...e})};e.push(i)}let t;0===H.length&&(t={key:"no_available_properties",action:()=>{},render:e=>(0,E.jsx)(N().A,{...e,style:g.noPropertiesAvailableMenuItem,disabled:!0,title:(0,E.jsx)(f().sA,{id:"shareTab.collectionPropertyPermissions.addNewPropertyPermissionPopup.noPropertiesMessage",defaultMessage:"No available properties"})})});const n={key:"options_section",items:t?[t]:H,render:e=>(0,E.jsx)(u().A,{...e,style:{paddingBottom:8,...!s&&g.disabled},title:(0,E.jsx)(f().sA,{id:"shareTab.collectionPropertyPermissions.addNewPropertyPermissionPopup.title",defaultMessage:"Select person property"}),desktopTitleStyle:{fontSize:12,fontWeight:"medium",marginBottom:4,padding:"0px 6px"}})};e.push(n);const o={key:"buttons_section",items:[{key:"roleSelectButton",action:()=>{},render:e=>(0,E.jsx)(V().Ay,{spaceStore:h,table:"collection",type:"collection_property_permission",role:I,upgradeButtonName:"collection_property_permissions",onChange:e=>{S(e)},buttonStyle:g.roleSelectButton,availableRoleItems:Y.map((e=>({role:e}))),disabled:!s})},{key:"createRuleButton",action:()=>{},render:()=>(0,E.jsx)(C().A,{colorPalette:"blue",disabled:!w||!s,style:g.createRuleButton,onClick:q,children:(0,E.jsx)(f().sA,{id:"shareTab.collectionPropertyPermissions.addNewPropertyPermissionPopup.createButton",defaultMessage:"Create rule"})})}],render:e=>(0,E.jsx)(u().A,{...e,topBorder:!0,topBorderExtendToEdge:!0,style:{padding:r().A.isMobile?16:10,...!s&&g.disabled},title:(0,E.jsx)(f().sA,{id:"shareTab.collectionPropertyPermissions.addNewPropertyPermissionPopup.roleSectionTitle",defaultMessage:"Grant access to a particular page for anyone selected in this property"}),desktopTitleStyle:{fontSize:12,fontWeight:"medium",margin:"10px 0px 4px",padding:0,lineHeight:"16px"},noTextOverflow:!0,mobileTitleStyle:{padding:0}})};return e.push(o),e}),[H,Y,q,w,I,g.createRuleButton,g.noPropertiesAvailableMenuItem,g.roleSelectButton,g.disabled,v,h]);return(0,E.jsx)(T().A,{menuType:k().gu.Popup,maxWidth:r().A.isMobile?"100%":void 0,width:r().A.isMobile?"100%":320,children:(0,E.jsx)("div",{style:{padding:r().A.isMobile?8:6},children:(0,E.jsx)(B().A,{type:B().O.Vertical,initialFocus:void 0,sections:$})})})}var Q=()=>s(942715),X=()=>s(562969),J=()=>s(187820);function Z(e){const{collectionStores:i,selectedCollectionStore:s,onCollectionPickerSelection:t,buttonPopupStore:n}=e,o=(0,f().tz)(),c=(0,l().IS)((()=>({titleSpan:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:200,display:"flex",alignItems:"center",gap:2},collectionName:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:r().A.isMobile?void 0:200,fontSize:r().A.isMobile?15:12,color:y().Tj.text.secondary},sectionMenuItemContainer:{maxWidth:r().A.isMobile?void 0:250},selectButton:{height:20},innerButtonStyle:{paddingInlineStart:4,paddingInlineEnd:4},titleIcon:{marginInlineEnd:1}})),[]),d=(0,a().K8)((()=>[{key:"collections",items:i.map((e=>{const i=(0,E.jsx)(J().B6,{icon:e.getIcon(),iconRecordCategory:"collection",disabled:!0,isEmptyPage:!1,size:20,emojiSize:16}),n=(0,X().getCollectionNameOrDefault)({collectionStore:e,intl:o});return{key:e.id,render:o=>(0,E.jsx)(N().A,{...o,title:n,icon:i,onClick:()=>{t(e)},isChecked:e.id===s.id}),action:()=>{}}})),render:e=>(0,E.jsx)("div",{style:c.sectionMenuItemContainer,children:(0,E.jsx)(u().A,{...e,topBorder:!1,title:o.formatMessage({id:"collectionPropertyPermissionsSection.collectionPicker.title",defaultMessage:"Sources"})})})}]),[t,i,s.id,o,c.sectionMenuItemContainer]),m=(0,a().K8)((()=>{const e=(0,E.jsx)(J().B6,{icon:s.getIcon(),iconRecordCategory:"collection",disabled:!0,isEmptyPage:!1,size:16,style:c.titleIcon}),i=(0,X().getCollectionNameOrDefault)({collectionStore:s,intl:o});return(0,E.jsxs)("span",{style:c.titleSpan,children:[e,(0,E.jsx)("div",{style:c.collectionName,children:i})]})}),[s,o,c.titleSpan,c.collectionName,c.titleIcon]);return(0,E.jsx)(Q().A,{selectedTitle:m,buttonPopupStore:n,renderMenuSections:e=>d,alignmentToOrigin:"start",style:c.selectButton,innerButtonStyle:c.innerButtonStyle})}var ee=()=>s(302501);const ie={viewBox:"0 0 20 20",fittedViewBox:"1.59 1.59 16.81 16.81",svg:(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)("path",{d:"M9.834 13.113a.675.675 0 1 1 0 1.35.675.675 0 0 1 0-1.35m.142-6.874c1.408 0 2.792.934 2.792 2.361 0 .84-.509 1.527-1.176 1.933l-.769.524.001.001a.9.9 0 0 0-.406.723.625.625 0 0 1-1.25 0c0-.706.368-1.352.945-1.751l.003-.002.799-.546.027-.018c.394-.24.576-.566.576-.864 0-.493-.552-1.111-1.542-1.111-.84 0-1.401.477-1.513.925A.625.625 0 0 1 7.25 8.11c.287-1.15 1.478-1.872 2.726-1.872"}),(0,E.jsx)("path",{d:"M8.498 2.221c.83-.83 2.175-.83 3.005 0l6.275 6.277c.83.83.83 2.175 0 3.005l-6.275 6.275c-.83.83-2.175.83-3.005 0L2.22 11.503a2.125 2.125 0 0 1 0-3.005zm2.12.885a.875.875 0 0 0-1.236 0L3.106 9.381a.875.875 0 0 0 0 1.238l6.276 6.275a.875.875 0 0 0 1.237 0l6.275-6.275a.875.875 0 0 0 0-1.238z"})]})},se=(0,L().wt)("questionDiamond",ie,"default");var te=()=>s(534177),ne=()=>s(268153),oe=()=>s(466797);function re(e){const{collectionStore:i,disabled:s}=e,t=(0,a().K8)((()=>{const{validItems:e,invalidItems:s}=i.getPropertyPermissionItems();return[...e,...s]}),[i]);return 0===t.length?null:(0,E.jsx)(E.Fragment,{children:t.map(((e,t)=>(0,E.jsx)(ae,{collectionStore:i,permissionItem:e,disabled:s},t)))})}function ae({collectionStore:e,permissionItem:i,disabled:s}){const n=(0,f().tz)(),o=(0,a().K8)((()=>e.getSchema()),[e]),c=(0,l().IS)((()=>({errorText:{color:y().Tj.orange.text.secondary},errorStateIcon:{fill:y().Tj.orange.icon.accentPrimary},errorStateIconContainer:{background:y().Tj.orange.background.secondary}})),[]),d=i.property_info.type,m=(0,a().K8)((()=>(0,R().o7)({collectionSchema:o,permissionItem:i})),[o,i]),p=(0,l().DP)(),u=r().A.isMobile?26:18,g=(0,a().K8)((()=>{switch(d){case"page_creator":return(0,E.jsx)(H().A,{type:"square",iconType:"function",iconFn:D().personCircleFillIcon,iconStyle:{width:u,height:u}});case"person":const e=i.property_info.property_id,s=o[e];return"property_not_found"===m?(0,E.jsx)(H().A,{type:"square",iconType:"function",iconFn:D().personCircleFillIcon,iconStyle:c.errorStateIcon,containerStyle:c.errorStateIconContainer}):"incorrect_property_type"===m?(0,E.jsx)(H().A,{type:"square",iconType:"function",iconFn:se,iconStyle:c.errorStateIcon,containerStyle:c.errorStateIconContainer}):s?(0,E.jsx)(H().A,{type:"square",iconType:"element",element:(0,E.jsx)(O().zB,{type:s.type,icon:s.icon,size:u,theme:p}),iconSize:r().A.isMobile?oe().Bj:oe().Ev}):null}}),[d,c.errorStateIconContainer,c.errorStateIcon,i.property_info,o,m,p,u]),h=(0,t.useMemo)((()=>{switch(d){case"page_creator":return(0,R().mf)({intl:n,collectionSchema:o});case"person":const e=i.property_info.property_id,s=null==o?void 0:o[e];if("property_not_found"===m)return(0,E.jsx)("div",{style:c.errorText,children:(0,E.jsx)(f().sA,{defaultMessage:"Missing property",id:"propertyPermissionItem.person.missingProperty.label"})});if("incorrect_property_type"===m){const e=null==s?void 0:s.name;return(0,E.jsx)("div",{style:c.errorText,children:e?(0,E.jsx)(f().sA,{defaultMessage:"Incorrect property type for {propertyName}",id:"propertyPermissionItem.person.incorrectPropertyType.labelWithPropertyName",values:{propertyName:e}}):(0,E.jsx)(f().sA,{defaultMessage:"Incorrect property type",id:"propertyPermissionItem.person.incorrectPropertyType.label"})})}return(0,E.jsx)(f().sA,{defaultMessage:"Anyone in {propertyName}",id:"propertyPermissions.personProperty.label",values:{propertyName:(null==s?void 0:s.name)??""}});default:(0,te().HB)(d)}}),[d,i,o,m,c.errorText,n]),b=(0,t.useMemo)((()=>{if(!r().A.isMobile)return null;const e=(0,ne().R)({type:i.type,role:i.role,table:"block",isRemovable:!1}).label;return(0,E.jsx)(ee().A,{isSmall:!0,children:(0,E.jsx)(f().sA,{...e})})}),[i]);return(0,E.jsx)(oe().Ay,{store:e,permissionItem:i,from:{table:v().Vl,collectionId:e.id},icon:g,title:h,subtitle:b,upgradeButtonName:"collection_property_permissions",isRemovableOverride:!0,shouldDisable:s})}function le({blockStore:e,renderInfo:i,onCollectionChange:s}){const n=(0,f().tz)(),o=(0,a().uB)(void 0,c().A),h=(0,l().IS)((()=>({helpIcon:{width:r().A.isMobile?20:16,height:r().A.isMobile?20:16,marginInlineStart:r().A.isMobile?16:void 0},attributionHeader:{paddingTop:2},sectionMenuItem:{padding:"8px 4px",border:`1px solid ${y().Tj.border.secondary}`,borderRadius:8,marginInlineStart:12,marginInlineEnd:12},sectionMenuItemMobile:{padding:"8px 16px",border:`1px solid ${y().Tj.border.secondary}`,borderRadius:8},attributionHeaderContainer:{display:"flex",alignItems:"center",justifyContent:"space-between"},titleContainer:{display:"flex",alignItems:"center"},newBadgeWrapper:{marginInlineStart:4}})),[]),b=(0,t.useCallback)((e=>{s(e),o.setState({...o.state,open:!1})}),[s,o]);return(0,E.jsxs)(u().A,{disableMobilePadding:!0,disableMobileBorders:!0,style:h.sectionMenuItem,mobileStyle:h.sectionMenuItemMobile,children:[(0,E.jsxs)("div",{style:h.attributionHeaderContainer,children:[(0,E.jsxs)("div",{style:h.titleContainer,children:[(0,E.jsx)("span",{style:h.attributionHeader,children:(0,E.jsx)(S().E3,{collectionPickerPopupMenu:i.showCollectionPicker?(0,E.jsx)(Z,{collectionStores:i.collectionStores,selectedCollectionStore:i.selectedCollectionStore,onCollectionPickerSelection:b,buttonPopupStore:o}):void 0})}),"collection"===i.renderMode?(0,E.jsx)("span",{style:h.newBadgeWrapper,children:(0,E.jsx)(I().Ee,{newBadgeKey:"collection_property_permissions",didUserEngage:!1,keyType:"date"})}):void 0]}),(0,E.jsx)(p().N,{href:"https://www.notion.com/help/sharing-and-permissions#database-page-level-access",external:!0,children:(0,E.jsx)(m().A,{icon:()=>(0,E.jsx)(d().I,{icon:g().questionMarkCircleIcon,colorVariant:"tertiary",style:h.helpIcon}),ariaLabel:n.formatMessage({id:"collectionPropertyPermissionsSection.help",defaultMessage:"Help"})})})]}),(0,E.jsx)(re,{collectionStore:i.selectedCollectionStore,disabled:i.disableRuleEditing}),"collection"===i.renderMode?(0,E.jsx)(q,{store:e,collectionStore:i.selectedCollectionStore,disabled:i.disableRuleEditing}):void 0]})}function ce(e){const[i,s]=(0,t.useState)(void 0),r=(0,o().X)("collection_property_permissions"),l=(0,a().K8)((()=>n().default.state.currentCollectionViewStore),[]),c=(0,a().K8)((()=>{if(e.table===b().ev)return e}),[e]),{renderMode:d,collectionStores:m}=(0,a().K8)((()=>c?function(e){const i=e.getParentStore(),s=function(e){return e.getCollectionStores()??[]}(e);if((null==i?void 0:i.table)===v().Vl)return{renderMode:"page_in_collection",collectionStores:[i]};if(s.length>0)return{renderMode:"collection",collectionStores:s};return{renderMode:void 0,collectionStores:[]}}(c):{renderMode:void 0,collectionStores:[]}),[c]),p=(0,a().K8)((()=>!!c&&c.getPermissionItems().some(h().T6)),[c]),u=(0,a().K8)((()=>d?m.filter((e=>function(e,i,s){const t=i.getPropertyPermissionItems().validItems.length>0,n=i.isPageTreeCollection();if(n)return!1;if("page_in_collection"===e)return t&&!s;return!0}(d,e,p))):[]),[d,m,p]);(0,t.useEffect)((()=>{if(i)return;const e=null==l?void 0:l.getCollectionStore(),t=u.find((i=>i.id===(null==e?void 0:e.id)));t?s(t):u.length>0&&!i&&s(u[0])}),[u,i,l]);const g=(0,t.useCallback)((e=>{s(e)}),[s]),f=(0,a().K8)((()=>!i||!d||(!i.canAdmin()||"collection"!==d)),[i,d]),y=Boolean(c&&u.length>0&&i&&d);if(!(r&&y&&i&&d))return{shouldRender:!1};const I="collection"===d&&u.length>1;return{shouldRender:!0,renderInfo:{renderMode:d,collectionStores:m,selectedCollectionStore:i,disableRuleEditing:f,showCollectionPicker:I},onCollectionChange:g}}},117183:(e,i,s)=>{s.d(i,{A:()=>H});s(296540);var t=()=>s(726637),n=()=>s(401497),o=()=>s(179034),r=()=>s(100622),a=()=>s(314529),l=()=>s(692031),c=()=>s(212497),d=()=>s(242422),m=()=>s(484714),p=()=>s(807449),u=()=>s(406094),g=()=>s(160432),h=()=>s(26697),b=()=>s(302501),v=()=>s(584262),f=()=>s(742852),y=()=>s(68263),I=()=>s(69708),S=()=>s(502492),x=()=>s(284371),P=()=>s(544198),j=()=>s(492414),_=()=>s(300789),A=()=>s(448570),w=()=>s(146842),k=()=>s(928074),M=()=>s(590526),C=s(474848);function T(e){const{store:i}=e,r=(0,m().v3)(),{WindowSizeStore:a}=r,l=(0,M().K8)((()=>({left:a.getSafePaddingLeftCSS(8),right:a.getSafePaddingRightCSS(12)})),[a]),{collection_view_block_id:c,collection_view_id:d,collection_id:u}=(0,M().K8)((()=>{var e;return i&&i.table===o().ev&&i.isCollectionView()?{collection_view_block_id:i.id,collection_view_id:(0,s(998992).I)(i,r),collection_id:null===(e=i.getCollectionStoreIfSingleSource())||void 0===e?void 0:e.id}:{collection_view_block_id:void 0,collection_view_id:void 0,collection_id:void 0}}),[i,r]),g=(0,n().IS)((()=>({button:{display:"flex",alignItems:"center",width:t().A.isMobile?"100%":void 0,height:t().A.isMobile?44:32,paddingTop:t().A.isMobile?12:4,paddingBottom:t().A.isMobile?12:4,paddingInlineStart:l.left,paddingInlineEnd:l.right}})),[l]);return(0,C.jsx)(s(552712).N,{href:(0,s(232930).x)("guides.sharing"),onClick:()=>s(148024).FH(r,{from:"sharing",share_menu_session_id:s(437487).Ay.state.sessionId,collection_id:u,collection_view_block_id:c,collection_view_id:d}),style:{width:t().A.isMobile?"100%":void 0},external:!0,children:(0,C.jsxs)(s(631524).p,{size:"sm",style:{...g.button,...e.style},disabled:Boolean(e.disableHover),children:[(0,C.jsx)("div",{style:{marginInlineStart:t().A.isMobile?2:0,marginInlineEnd:t().A.isMobile?8:6},children:(0,C.jsx)(p().I,{icon:s(721479).questionMarkCircleSmallIcon,size:"sm",colorVariant:t().A.isMobile?"secondary":"tertiary"})}),(0,C.jsx)(b().A,{isSecondaryColor:!t().A.isMobile,children:(0,C.jsx)(I().sA,{defaultMessage:"Learn about sharing",id:"blockPermissionsSettings.learnAboutSharing.prompt"})})]})})}T.displayName="LearnAboutSharingLink";const N=T,B=new(s(29923).R)({key:"copy_link_no_permissions_tooltip_shown",namespace:s(553737).cd,important:!0,trackingType:"necessary"});function R(e){const{store:i,buttonPopupStore:s,events:o}=e,r=(0,m().v3)(),{device:a,mobileNative:l}=r,c=(0,n().IS)((()=>({button:{flex:1,height:36,minHeight:36,borderRadius:12,marginTop:12,...t().A.isMobile?{minHeight:48,fontSize:x().J.UIRegular.mobile}:{}}})),[]);return(0,C.jsx)(g().A,{colorPalette:"blue",onClick:()=>{a.isMobileNative?function(e){const{store:i,mobileNative:s}=e,n=(0,S().kb)({schemeUrl:(0,j().Ay)({store:i,pageVisitSource:v().y8.CopyLink}),baseUrl:t().A.domainBaseUrl});s&&s.share(n)}({store:i,mobileNative:l}):L({store:i,buttonPopupStore:s,environment:r});const{collectionId:e,ownedCollectionCount:n,linkedCollectionCount:o}=(0,P().P)(i,{skipPages:!0}),c=i.getParentCollectionIdUpToTwoLevels();W(r,{collection_id:e,owned_collection_count:n,linked_collection_count:o,parent_collection_id:c})},style:c.button,...o,children:a.isMobileNative?(0,C.jsx)(I().sA,{id:"pageShareMenu.shareLinkButton.label",defaultMessage:"Share link"}):(0,C.jsx)(I().sA,{id:"pageShareMenu.copyLinkButton.label",defaultMessage:"Copy link"})})}function O(e){const{store:i,buttonPopupStore:s,events:t,trustedDomainPermissionItem:o,calculatedPermissions:l}=e,c=(0,m().v3)(),g=(0,n().IS)((()=>({icon:{marginInlineStart:0,marginInlineEnd:6},label:{color:r().Tj.text.primary},button:{paddingInlineStart:10,paddingInlineEnd:12,paddingTop:6,paddingBottom:6,color:r().Tj.text.primary,justifyContent:"center",borderRadius:6}})),[]);return(0,C.jsxs)(u().A,{size:"lg",onClick:()=>{const e=(0,k().Jz)({calculatedPermissions:l,currentUserId:c.currentUser.id});L({store:i,buttonPopupStore:s,environment:c,keepPopupOpen:!0}),e&&setTimeout((async()=>{await A().S.copy_link_no_permissions_tooltip({mainEditorCurrentBlockStore:i})&&!B.state&&"on"===d().default.getEligibleGroup({experimentId:"copy_page_link_awtl_tooltip",defaultGroup:"control"})&&((0,a().DO_NOT_USE_trackLegacy)(c,"tooltip_action",{tooltip_type:"copy_link_no_permissions",action:"shown",space_id:i.getSpaceId()}),B.setState(!0),(0,_().UW)(c,w().COPY_LINK_NO_PERMISSIONS_TOOLTIP_ID))}),100);const{collectionId:t,ownedCollectionCount:n,linkedCollectionCount:r}=(0,P().P)(i,{skipPages:!0}),m=i.getParentCollectionIdUpToTwoLevels();W(c,{collection_id:t,owned_collection_count:n,linked_collection_count:r,parent_collection_id:m,trusted_domain_permission_role:o.role})},style:g.button,...t,children:[(0,C.jsx)(p().I,{icon:f().linkIcon,colorVariant:"secondary",style:g.icon}),(0,C.jsx)(b().A,{style:g.label,children:(0,C.jsx)(I().sA,{id:"blockPermissionsSettings.copyLinkButtonV2.label",defaultMessage:"Copy link"})})]})}function D(e){const{calculatedPermissions:i,spaceName:s}=e,t=i.mostPermissivePublicItem.permissionItem;if((0,y().Tt)(t.role))return(0,C.jsx)(I().sA,{defaultMessage:"This page has public link access, so anyone with the link will be able to view the page.",id:"blockPermissionsSettings.publicLinkInfo.tooltip"});const n=i.mostPermissiveSpaceItem.permissionItem;return(0,y().Tt)(n.role)?s?(0,C.jsx)(I().sA,{defaultMessage:"Anyone at {spaceName} can access with this link",id:"blockPermissionsSettings.workspacePermissions.tooltipV2",values:{spaceName:s}}):(0,C.jsx)(I().sA,{defaultMessage:"This page has workspace access, so anyone in the workspace will be able to view the link.",id:"blockPermissionsSettings.workspacePermissions.tooltip"}):i.permissionItemsCount>1?(0,C.jsx)(I().sA,{defaultMessage:"Only people invited to this page can access with this link",id:"blockPermissionsSettings.userPermissions.tooltipV2"}):(0,C.jsx)(I().sA,{defaultMessage:"Only you can access this page, so the link will only work for you.",id:"blockPermissionsSettings.privatePermissions.tooltip"})}async function L(e){const{store:i,buttonPopupStore:s,environment:t,keepPopupOpen:n}=e,o=(0,j().Ay)({store:i,pageVisitSource:v().y8.CopyLink}),[r,a]=await Promise.all([(0,l().r)(),(0,c().jd)()]);await a({environment:t,stringValue:o,copiedMessage:r.copiedLinkToClipboard}),s&&!n&&s.setState({open:!1})}const E=function(e){const{store:i,buttonPopupStore:o,calculatedPermissions:r}=e,a=(0,s(653953).X)(),l=(0,n().IS)((()=>({tooltip:{width:280}})),[]);return(0,C.jsxs)(C.Fragment,{children:[t().A.isMobile?void 0:(0,C.jsx)(N,{store:i}),(0,C.jsx)(h().m,{delayThreshold:500,placement:"bottom",renderTooltip:()=>(0,C.jsx)(D,{calculatedPermissions:r,spaceName:a}),textWrap:!0,style:l.tooltip,render:e=>t().A.isMobile?(0,C.jsx)(R,{store:i,buttonPopupStore:o,events:e}):(0,C.jsx)(O,{store:i,buttonPopupStore:o,events:e,trustedDomainPermissionItem:r.mostPermissiveTrustedDomainItem.permissionItem,calculatedPermissions:r})})]})};function W(e,i){(0,a().DO_NOT_USE_trackLegacy)(e,"copy_link_from_permissions_setting",i)}var K=()=>s(496703);function V(e){const{store:i,buttonPopupStore:s}=e,o=(0,n().IS)((()=>({tooltip:{width:280}})),[]);return(0,C.jsxs)(C.Fragment,{children:[t().A.isMobile?void 0:(0,C.jsx)(N,{}),(0,C.jsx)(h().m,{delayThreshold:500,placement:"bottom",renderTooltip:()=>(0,C.jsx)(F,{}),textWrap:!0,style:o.tooltip,render:e=>t().A.isMobile?(0,C.jsx)(U,{store:i,buttonPopupStore:s,events:e}):(0,C.jsx)(G,{store:i,buttonPopupStore:s,events:e})})]})}function U(e){const{store:i,buttonPopupStore:s,events:o}=e,r=(0,m().v3)(),a=(0,n().IS)((()=>({button:{flex:1,height:36,minHeight:36,borderRadius:12,marginTop:12,...t().A.isMobile?{minHeight:48,fontSize:x().J.UIRegular.mobile}:{}}})),[]);return(0,C.jsx)(g().A,{colorPalette:"blue",onClick:()=>{z({store:i,buttonPopupStore:s,environment:r})},style:a.button,...o,children:(0,C.jsx)(I().sA,{id:"workflowShareMenu.copyLinkButton.label",defaultMessage:"Copy link"})})}function G(e){const{store:i,buttonPopupStore:s,events:t}=e,o=(0,m().v3)(),a=(0,n().IS)((()=>({icon:{marginInlineStart:0,marginInlineEnd:6},label:{color:r().Tj.text.primary},button:{paddingInlineStart:10,paddingInlineEnd:12,paddingTop:6,paddingBottom:6,color:r().Tj.text.primary,justifyContent:"center",borderRadius:6}})),[]);return(0,C.jsxs)(u().A,{size:"lg",onClick:()=>{z({store:i,buttonPopupStore:s,environment:o,keepPopupOpen:!0})},style:a.button,...t,children:[(0,C.jsx)(p().I,{icon:f().linkIcon,colorVariant:"secondary",style:a.icon}),(0,C.jsx)(b().A,{style:a.label,children:(0,C.jsx)(I().sA,{id:"workflowShareMenu.copyLinkButtonV2.label",defaultMessage:"Copy link"})})]})}function F(){return(0,C.jsx)(I().sA,{defaultMessage:"Copy a link to share this agent with others",id:"workflowShareMenu.copyLinkInfo.tooltip"})}async function z(e){const{store:i,buttonPopupStore:s,environment:n,keepPopupOpen:o}=e,r=(0,K().L)({workflowId:i.id,params:{},pageVisitSource:v().y8.CopyLink,baseUrl:t().A.domainBaseUrl}),[a,d]=await Promise.all([(0,l().r)(),(0,c().jd)()]);await d({environment:n,stringValue:r,copiedMessage:a.copiedLinkToClipboard}),s&&!o&&s.setState({open:!1})}const H=function(e){const i=(0,n().IS)((()=>{const i=t().A.isMobile?`0.5px solid ${r().Tj.border.primary}`:`1px solid ${r().Tj.border.secondary}`;return{container:{display:"flex",alignItems:t().A.isMobile?"normal":"center",flexDirection:t().A.isMobile?"column":"row",justifyContent:"space-between",padding:t().A.isMobile?"16px 20px 20px":"12px 12px",...e.hasCollectionPropertyPermissionsSection?{}:{borderTop:i}}}}),[e.hasCollectionPropertyPermissionsSection]);return e.store.table!==o().ev?(0,C.jsx)("div",{style:i.container,children:(0,C.jsx)(V,{store:e.store,buttonPopupStore:e.buttonPopupStore})}):(0,C.jsx)("div",{style:i.container,children:t().A.isMobile?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(s(678250).GeneralAccessPermissionSection,{store:e.store,calculatedPermissions:e.calculatedPermissions,permissionItemArgs:e.permissionItemArgs}),(0,C.jsx)(E,{store:e.store,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:e.calculatedPermissions})]}):(0,C.jsx)(E,{store:e.store,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:e.calculatedPermissions})})}},146842:(e,i,s)=>{s.r(i),s.d(i,{COPY_LINK_NO_PERMISSIONS_TOOLTIP_ID:()=>v,CopyLinkNoPermissionsTooltip:()=>y,PUBLIC_SHARE_LINK_TOOLTIP_ID:()=>b,PublicShareLinkTutorialTooltip:()=>f});s(296540);var t=()=>s(314529),n=()=>s(404694),o=()=>s(484714),r=()=>s(590526),a=()=>s(734762),l=()=>s(148297),c=()=>s(249046),d=()=>s(807449),m=()=>s(12193),p=()=>s(69708),u=()=>s(300789),g=()=>s(131448),h=s(474848);const b="public_share_link_tooltip",v="copy_link_no_permissions_tooltip";function f(e){const{originRef:i,onPrimaryButtonClick:s}=e,t=(0,o().v3)(),v=(0,r().K8)((()=>g().default.isVisible(b)),[]),f=(0,n().V)();return(0,h.jsx)(a().B,{shouldShow:v,calloutId:b,inAppCalloutStore:f,children:(0,h.jsx)(l().k,{style:{width:260},pointerLength:25,pointerPosition:"50%",origin:i,placementToOrigin:"bottom",alignmentToOrigin:"start",numSteps:1,header:(0,h.jsxs)(c().wt,{gap:10,children:[(0,h.jsx)(d().I,{icon:m().globeIcon}),(0,h.jsx)(p().sA,{id:"generalAccessPermissions.publicShareLink.tutorialTooltip.header",defaultMessage:"Share your page with anyone"})]}),content:(0,h.jsx)(p().sA,{id:"generalAccessPermissions.publicShareLink.tutorialTooltip.content",defaultMessage:"You can now change your page settings to collaborate with anyone on the web with the link"}),finalButtonContent:(0,h.jsx)(p().sA,{id:"generalAccessPermissions.publicShareLink.tutorialTooltip.finalButtonContent",defaultMessage:"Try it out"}),onPrimaryButtonClick:()=>{(0,u().a)(t,b),s()},shouldDismissUponOutsideClick:!0,onCloseClick:()=>{(0,u().a)(t,b)}})})}function y(e){const{originRef:i,onPrimaryButtonClick:s}=e,b=(0,o().v3)(),f=(0,r().K8)((()=>g().default.isVisible(v)),[]),y=(0,n().V)();return(0,h.jsx)(a().B,{shouldShow:f,calloutId:v,inAppCalloutStore:y,children:(0,h.jsx)(l().k,{style:{width:260},pointerLength:25,pointerPosition:"50%",origin:i,placementToOrigin:"bottom",alignmentToOrigin:"start",numSteps:1,header:(0,h.jsxs)(c().wt,{gap:10,children:[(0,h.jsx)(d().I,{icon:m().globeIcon}),(0,h.jsx)(p().sA,{id:"shareMenu.copyLinkNoPermissions.tutorialTooltip.header",defaultMessage:"Ready to share?"})]}),content:(0,h.jsx)(p().sA,{id:"shareMenu.copyLinkNoPermissions.tutorialTooltip.content",defaultMessage:"This page is private. Update permissions to share with others."}),finalButtonContent:(0,h.jsx)(p().sA,{id:"shareMenu.copyLinkNoPermissions.tutorialTooltip.finalButtonContent",defaultMessage:"Add permissions"}),onPrimaryButtonClick:()=>{(0,t().DO_NOT_USE_trackLegacy)(b,"tooltip_action",{tooltip_type:"copy_link_no_permissions",action:"add_permissions_clicked"}),(0,u().a)(b,v),s()},shouldDismissUponOutsideClick:!0,onCloseClick:()=>{(0,t().DO_NOT_USE_trackLegacy)(b,"dismiss_tooltip",{tooltip_type:"copy_link_no_permissions"}),(0,u().a)(b,v)}})})}},180925:(e,i,s)=>{s.d(i,{A:()=>l});var t=s(296540),n=()=>s(401497),o=()=>s(340498),r=s(474848);function a({onClick:e,hovered:i,expanded:a,children:l}){const[c,d]=t.useState(!1),m=(0,t.useCallback)((()=>d(!0)),[]),p=(0,t.useCallback)((()=>d(!1)),[]),u=(0,n().eP)(),g=(0,n().IS)((()=>{const e=(0,s(623275).iM)({themeMode:u,size:26,useLargeBorderRadius:!0,useLightBackgroundColor:!0}),t={position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",top:"auto",insetInlineStart:"auto",opacity:i?1:0,visibility:i?"visible":"hidden",transition:"opacity 150ms ease, visibility 150ms ease, background 150ms ease",...e,width:24,height:24,borderRadius:4};return{container:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center"},chevronButton:{...t,background:"unset"},chevronContainerHovered:{...t,background:e.background},childrenContainer:{opacity:i?0:1,transition:"opacity 200ms"},chevronIconInnerContainer:{background:"unset",height:24,width:24,borderRadius:4},chevronIcon:{transform:`rotate(${a?90:0}deg)`,transition:"transform 150ms ease",width:o().Ev.default,height:o().Ev.default}}}),[a,i,u]);return s(726637).A.isMobile?(0,r.jsx)(r.Fragment,{children:l}):(0,r.jsxs)("div",{style:g.container,onMouseEnter:m,onMouseLeave:p,children:[(0,r.jsx)(s(718827).Ay,{disabled:!1,style:c?g.chevronContainerHovered:g.chevronButton,onClick:e,children:(0,r.jsx)(s(99756).A,{type:"square",iconType:"function",iconFn:s(222334).arrowChevronSingleRightIcon,containerStyle:g.chevronIconInnerContainer,iconStyle:g.chevronIcon})}),(0,r.jsx)("div",{style:g.childrenContainer,children:l})]})}const l=t.memo(a)},418739:(e,i,s)=>{s.d(i,{j:()=>l});var t=()=>s(295633),n=()=>s(68263),o=()=>s(185631),r=()=>s(499764),a=()=>s(620173);function l(e){const{environment:i,store:s,newPermissionItem:l}=e,c=s.getSpaceStore(),d=c?(0,o().i)(c):void 0;if(!d)return;if("block"!==s.table||s.id!==d){const e=new(t().B)(i,{table:"block",id:d});return(0,a().n)(e)}const m=(0,r().Jh)(s),p=(0,r().K1)(s);if(m&&p)return!0;const u="space_permission"===l.type&&"none"===l.role,g="public_permission"===l.type&&!(0,n().Tt)(l.role),h="public_permission"===l.type&&(0,n().W8)(l)&&!1===l.allow_duplicate;return!u&&!(g||h)}},439616:(e,i,s)=>{s.d(i,{A:()=>E});s(944114),s(581454);var t=s(296540),n=()=>s(664594),o=()=>s(59226),r=()=>s(726637),a=()=>s(484714),l=()=>s(590526),c=()=>s(401497),d=()=>s(609679),m=()=>s(250910),p=()=>s(807449),u=()=>s(546926),g=()=>s(302501),h=()=>s(890492),b=()=>s(81068),v=()=>s(663639),f=()=>s(736847),y=()=>s(869190),I=()=>s(68263),S=()=>s(84262),x=()=>s(69708),P=()=>s(100622),j=()=>s(720665),_=()=>s(662971),A=()=>s(573710),w=()=>s(180252),k=()=>s(118849),M=()=>s(528093),C=()=>s(134217),T=()=>s(408543),N=()=>s(704658),B=s(474848);function R(e,i){const{permissionItem:t,hideIcon:n,onChange:o,buttonStyle:a}=e,{spaceStore:l,...c}=e;return(0,B.jsx)(s(811979).A,{...c,popupType:r().A.isMobile?m().z.SlideUp:m().z.Popup,renderOrigin:e=>(0,B.jsx)(s(585293).a,{...(0,s(383036).A)(c,e),ref:i,title:(0,B.jsx)(x().sA,{defaultMessage:"Link expires",id:"publishSiteSettings.linkExpiration.settingTitle"}),icon:!n&&(0,B.jsx)(p().I,{icon:s(274570).clockIcon,colorVariant:"secondary"}),right:(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(O,{permissionItem:t}),(0,B.jsx)(p().I,{icon:s(324254).arrowChevronSingleDownSmallIcon,size:"sm",colorVariant:"tertiary"})]}),buttonStyle:a}),alignmentToOrigin:"end",placementToOrigin:"bottom",render:e=>(0,B.jsx)(D,{spaceStore:l,value:t.expiration_timestamp,onChange:o,onClose:()=>{e.close()}})})}function O(e){const{permissionItem:i}=e,s=(0,x().tz)(),t=(0,c().IS)((()=>({container:{color:P().Tj.text.secondary}})),[]);if(!i.expiration_timestamp||(0,I().OA)(i))return(0,B.jsx)(g().A,{style:t.container,children:(0,B.jsx)(x().sA,{defaultMessage:"Never",id:"publishSiteSettings.linkExpiration.never"})});const n=y().jE(i.expiration_timestamp,d().locale,s);return(0,B.jsx)(g().A,{style:t.container,children:n})}function D(e){const{value:i,onChange:s,onClose:m,spaceStore:p}=e,g=(0,a().v3)(),y=(0,o().X)("upgrade_system_sharing"),I=(0,l().K8)((()=>!C().qC()),[]),_=(0,l().K8)((()=>C().Si(g)),[g]),A=(0,t.useCallback)((e=>{void 0!==e&&e<=(new Date).getTime()||(s(e),m())}),[s,m]),w=(0,n().T)(),R=(0,M()._)({spaceId:null==p?void 0:p.id,userId:w,name:"link_expiration"}),{handleClick:O}=(0,T().C)({upsell:null==R?void 0:R.upsell,source:"public_permission_item_expiration",spaceStore:p}),D=(0,c().IS)((()=>({disabledContainer:{display:"flex",gap:6},disabledText:{color:P().Tj.text.tertiary}})),[]),E=function(){const e=Date.now(),i=e+j().pT,s=e+j().nD,t=e+7*j().nD;return[{key:"none",time:void 0,title:(0,B.jsx)(x().sA,{defaultMessage:"Never",id:"publishSiteSettings.linkExpiration.never"})},{key:"hour",time:i,title:(0,B.jsx)(x().sA,{defaultMessage:"In an hour",id:"publishSiteSettings.linkExpiration.oneHour"}),caption:new Intl.DateTimeFormat(d().locale,{hour:"numeric",minute:"numeric"}).format(i)},{key:"day",time:s,title:(0,B.jsx)(x().sA,{defaultMessage:"In a day",id:"publishSiteSettings.linkExpiration.oneDay"}),caption:new Intl.DateTimeFormat(d().locale,{day:"numeric",month:"long",hour:"numeric",minute:"numeric"}).format(s)},{key:"week",time:t,title:(0,B.jsx)(x().sA,{defaultMessage:"In a week",id:"publishSiteSettings.linkExpiration.oneWeek"}),caption:new Intl.DateTimeFormat(d().locale,{day:"numeric",month:"long",hour:"numeric",minute:"numeric"}).format(t)}]}().map((e=>({key:e.key,action:()=>{A(e.time)},render:i=>(0,B.jsx)(b().A,{...i,title:e.title,titleStyle:I?D.disabledText:{},caption:e.caption,captionStyle:I?D.disabledText:{},disabled:I})}))),W=[{key:"predefined-expiration",render:e=>(0,B.jsx)(f().A,{...e}),items:E},{key:"custom-expiration",render:e=>(0,B.jsx)(f().A,{...e,topBorder:!0}),items:[L(A,i,I,D.disabledText)]}];return _&&I&&!y&&W.push({key:"upgrade-for-expiration",render:e=>(0,B.jsx)(f().A,{...e,topBorder:!0}),items:[{key:"upsell",action:()=>O(),render:e=>(0,B.jsx)(b().A,{...e,focused:e.focused,title:(0,B.jsxs)("div",{style:D.disabledContainer,children:[(0,B.jsx)(x().sA,{defaultMessage:"Unlock link expiration",id:"publishSiteSettings.linkExpiration.upgrade"}),(0,B.jsx)(k().u,{spaceStore:p,subscriptionTier:_,analyticsName:"public_permission_item_expiration"})]})})}]}),(0,B.jsxs)(h().A,{menuType:r().A.isMobile?u().gu.ActionSheet:u().gu.Popup,width:271,children:[y&&I&&(0,S().wy)(null==R?void 0:R.upsell)?(0,B.jsx)("div",{style:{paddingTop:10,paddingInlineEnd:10,paddingBottom:4,paddingInlineStart:10},children:(0,B.jsx)(N().UpgradeButton,{source:"public_permission_item_expiration",display:"button",upsell:R.upsell,spaceStore:p})}):void 0,(0,B.jsx)(v().A,{type:v().O.Vertical,initialFocus:void 0,sections:W})]})}function L(e,i,s,t={}){return{key:"custom",action:()=>{window.parent.close()},render:(n,o)=>(0,B.jsx)(_().A,{...n,renderOrigin:e=>(0,B.jsx)(b().A,{...e,disabled:s,title:(0,B.jsx)(x().sA,{id:"publicPermissionItem.expiration.chooseDate",defaultMessage:"Choose date"}),titleStyle:s?t:{}}),onFocus:o.onFocus,disableDefaultClick:!0,renderExtension:(t,n)=>(0,B.jsx)("div",{style:{padding:"18px 14px 14px"},children:(0,B.jsx)(A().A,{...t,firstDayOfWeek:w().XX.state,value:i||Date.now(),onChange:i=>{e(i),n.close()},disabledDays:s||{before:new Date}})})})}}const E=t.forwardRef(R)},453597:(e,i,s)=>{s.d(i,{E3:()=>u,nc:()=>p});s(296540);var t=()=>s(726637),n=()=>s(484714),o=()=>s(590526),r=()=>s(401497),a=()=>s(302501),l=()=>s(69708),c=()=>s(100622),d=()=>s(284371),m=s(474848);function p(){return(0,m.jsx)(g,{children:(0,m.jsx)(l().sA,{id:"blockPermissionsSettings.permissionsList.generalAccessAttribution",defaultMessage:"General access"})})}function u({collectionPickerPopupMenu:e}){const i=e?(0,m.jsx)(l().sA,{id:"blockPermissionsSettings.permissionsList.collectionPropertyPermissionsAttribution.pageLevelAccessFor",defaultMessage:"Page-level access for {popupMenu}",values:{popupMenu:e}}):(0,m.jsx)(l().sA,{id:"blockPermissionsSettings.permissionsList.collectionPropertyPermissionsAttribution.pageLevelAccess",defaultMessage:"Page-level access"});return(0,m.jsx)(g,{children:(0,m.jsx)("span",{style:{display:"flex",alignItems:"center"},children:i})})}function g(e){const{children:i}=e,{WindowSizeStore:s}=(0,n().v3)(),{paddingLeft:l,paddingRight:p}=(0,o().K8)((()=>{const e=t().A.isMobile?0:8;return{paddingLeft:s.getSafePaddingLeftCSS(e),paddingRight:s.getSafePaddingRightCSS(e)}}),[s]),u=(0,r().IS)((()=>({label:{color:c().Tj.text.secondary,fontWeight:d().Wy.medium,paddingInlineStart:l,paddingInlineEnd:p,paddingTop:0,paddingBottom:4,overflow:"visible",textWrap:"wrap",...t().A.isMobile?{fontSize:15,paddingTop:2,color:c().Tj.text.secondary}:{}}})),[l,p]);return(0,m.jsx)(a().A,{isSmall:!0,style:u.label,children:i})}},585293:(e,i,s)=>{s.d(i,{a:()=>r});var t=s(296540),n=()=>s(100622),o=s(474848);const r=t.forwardRef(((e,i)=>{const t=(0,s(59226).X)("polish_publish_menu")&&!s(726637).A.isMobile,r=(0,s(401497).IS)((()=>({buttonStyle:{paddingInlineStart:t?2:8,paddingInlineEnd:t?2:8,paddingTop:2,paddingBottom:2,width:"100%",marginInlineStart:0,background:"transparent",...e.buttonStyle},menuItemStyle:{gap:6,background:"transparent",...e.style},innerContainer:{marginInlineStart:0,paddingInlineStart:0,minWidth:0,color:e.disabled?n().Tj.text.secondary:void 0,background:"transparent"},desktopIconStyle:{margin:0},rightStyle:{display:"flex",alignItems:"center",gap:6,color:n().Tj.text.secondary,margin:0,...e.rightStyle}})),[t,e.buttonStyle,e.style,e.disabled,e.rightStyle]);return(0,o.jsx)(s(81068).A,{role:"button",...e,ref:i,style:r.menuItemStyle,buttonStyle:r.buttonStyle,textWrapperStyle:r.innerContainer,desktopIconStyle:r.desktopIconStyle,rightStyle:r.rightStyle})}));r.displayName="SiteSettingButtonMenuItem"},629027:(e,i,s)=>{s.d(i,{P:()=>o});var t=()=>s(590526),n=()=>s(406450);function o({store:e}){return(0,t().K8)((()=>(0,n().C)({store:e})),[e])}},653953:(e,i,s)=>{s.d(i,{X:()=>l});var t=()=>s(907258),n=()=>s(484714),o=()=>s(590526),r=()=>s(574359),a=()=>s(69708);function l(){const e=(0,n().v3)(),i=(0,a().tz)();return(0,o().K8)((()=>{const{sidebarSpaceStore:s}=t().default.state;return s?(0,r().G)(e,s):i.formatMessage({defaultMessage:"Untitled workspace",id:"spaceHelpers.getSpaceName.untitledWorkspace.name"})}),[e,i])}},678250:(e,i,s)=>{s.r(i),s.d(i,{GeneralAccessPermissionSection:()=>Hs,InheritedPermissionsListV2:()=>zs,MOBILE_SHARE_MENU_HORIZONTAL_PADDING:()=>Us,default:()=>Qs});s(517642),s(658004),s(733853),s(845876),s(432475),s(515024),s(731698),s(898992),s(823215),s(354520),s(803949),s(581454);var t=()=>s(203066),n=()=>s(153321),o=s(296540),r=()=>s(230711),a=()=>s(135168),l=()=>s(59226),c=()=>s(726637),d=()=>s(484714),m=()=>s(590526),p=()=>s(401497),u=()=>s(611648),g=()=>s(150669),h=()=>s(457205),b=()=>s(849255),v=()=>s(350013),f=()=>s(699143),y=()=>s(324826),I=()=>s(493552),S=()=>s(736847),x=()=>s(187174),P=()=>s(525884),j=()=>s(68263),_=()=>s(179034),A=()=>s(824862),w=()=>s(798880),k=()=>s(743246),M=()=>s(695608),C=()=>s(69708),T=()=>s(100622),N=()=>s(496603),B=()=>s(701763),R=()=>s(769864),O=()=>s(376254),D=()=>s(47373),L=()=>s(499764),E=()=>s(698449),W=()=>s(141333),K=()=>s(169626),V=()=>s(484578),U=()=>s(928074),G=()=>s(623275),F=()=>s(437487),z=()=>s(312788),H=()=>s(26697),q=()=>s(302501),Y=()=>s(424400),$=()=>s(584262),Q=()=>s(496703),X=()=>s(993273),J=()=>s(622936),Z=()=>s(466797),ee=s(474848);function ie(e){const{store:i,workflowStore:s,workflowName:t,agentPermission:n,fromPermissionWrapper:r}=e,a=(0,d().v3)(),{navigate:p}=(0,o.useContext)(z().E),u=(0,m().K8)((()=>s.canEdit()),[s]),g=(0,l().X)("custom_agent_boot_from_share_menu"),h=(0,m().K8)((()=>{var e;return!(i.table!==_().ev||!i.isCollectionView())&&(null===(e=i.getFormat())||void 0===e||null===(e=e.database_agent_ids)||void 0===e?void 0:e.includes(s.id))}),[i,s.id]),b=(0,o.useCallback)((()=>{const e=(0,Q().L)({workflowId:s.id,params:{},pageVisitSource:$().y8.ShareMenu});p({environment:a,url:e})}),[s.id,a,p]);return h?null:(0,ee.jsx)("div",{children:(0,ee.jsx)(Z().Ay,{store:i,permissionItem:n.permissionItem,from:n.from,ignoreLocalHoverState:e.ignoreLocalHoverState,icon:(0,ee.jsx)(se,{workflowStore:s}),title:(0,ee.jsx)(te,{workflowName:t,workflowStore:s}),subtitle:(0,ee.jsx)(ne,{workflowStore:s}),shouldDisable:!g&&!u,isCollapsible:!0,onClick:b,selectHeader:c().A.isMobile?(0,ee.jsx)(Y().Ay,{title:(0,ee.jsx)(te,{workflowName:t,workflowStore:s}),caption:(0,ee.jsx)(ne,{workflowStore:s}),icon:(0,ee.jsx)(se,{workflowStore:s}),desktopIconStyle:{marginInlineStart:16},style:{background:"transparent",border:"none"}}):void 0,selectFooter:e.selectFooter,showInherited:e.showInherited,upgradeButtonName:"bot_permission_item",isRemovableOverride:e.isRemovableOverride,fromPermissionWrapper:r,roleItemOverrides:e.roleItemOverrides,menuListItemProps:e.menuListItemProps,tag:(0,ee.jsx)(X().Kg,{}),...e.permissionItemArgs})},n.permissionItem.bot_id)}function se(e){const{workflowStore:i}=e,s=(0,m().K8)((()=>i.getRawIcon()),[i]);return(0,ee.jsx)(J().AgentIcon,{agentIcon:s,workflowStore:i,size:c().A.isMobile?Z().Bj:Z().Ev,animated:!1})}function te(e){const{workflowName:i,workflowStore:s}=e,t=(0,C().tz)(),n=(0,m().K8)((()=>i??s.getNameWithDefault(t)),[i,t,s]);return(0,ee.jsx)("div",{style:{display:"flex",gap:4},children:(0,ee.jsx)(q().A,{className:"notranslate",children:n})})}function ne(e){const{workflowStore:i}=e,s=(0,p().IS)((()=>({subtitle:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}})),[]),t=(0,m().K8)((()=>i.getDescription()),[i]);return(0,m().K8)((()=>i.isReady()),[i])?(0,ee.jsx)(H().m,{renderTooltip:()=>(0,ee.jsx)("div",{children:t}),render:e=>(0,ee.jsx)("div",{...e,style:s.subtitle,children:t})}):(0,ee.jsx)(oe,{})}function oe(){const e=(0,p().IS)((()=>({placeholder:{height:8,width:139,borderRadius:4,marginTop:10,background:T().Tj.background.tertiaryTranslucent}})),[]);return(0,ee.jsx)("div",{style:e.placeholder})}var re=()=>s(913348),ae=()=>s(51069),le=()=>s(718827),ce=()=>s(807449),de=()=>s(340498);const me={viewBox:"0 0 20 20",fittedViewBox:"8.75 2.75 2.5 14.51",svg:(0,ee.jsx)("path",{d:"M10 14.75a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5m0-6a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5m0-6a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5"})},pe=(0,de().wt)("ellipsisVertical",me,"default");function ue({permissions:e}){const[i,s]=(0,o.useState)(!1),t=(0,p().IS)((()=>({button:{display:i?"none":"inline-flex",padding:8,alignItems:"center",...(0,G().CY)(),width:"calc(100% - 16px)",height:48},list:{display:i?"block":"none"},dotsIconContainer:{display:"flex",alignItems:"center",justifyContent:"center",width:32,marginInlineEnd:(0,G().qj)({isMobile:c().A.isMobile})}})),[i]);return(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsxs)(le().Ay,{onClick:()=>s(!0),style:t.button,children:[(0,ee.jsx)("div",{style:t.dotsIconContainer,children:(0,ee.jsx)(ce().I,{icon:pe,colorVariant:"tertiary"})}),(0,ee.jsx)(q().A,{isSmall:!1,isSecondaryColor:!0,children:(0,ee.jsx)(C().sA,{id:"blockPermissionsSettings.permissionsList.expandButtonV2",defaultMessage:"See {count} more",values:{count:e.length}})})]}),(0,ee.jsx)("div",{style:t.list,children:e})]})}var ge=()=>s(464192),he=()=>s(882722),be=()=>s(118307),ve=()=>s(12193),fe=()=>s(268153);function ye(e,i){const s=(e.table===_().ev?e.getPublicPermission():void 0)??{type:"public_permission",role:"none"},t=(0,N().o8)(s);t.role=i;const{is_site:n}=t;return"none"===i?n?{...t,role:"reader",is_public_share_link:!1}:{...t,is_public_share_link:!1}:{...t,is_public_share_link:!0}}var Ie=()=>s(439616),Se=()=>s(976721),xe=()=>s(127833),Pe=()=>s(250910),je=()=>s(631524),_e=()=>s(906380),Ae=()=>s(907258),we=()=>s(546926),ke=()=>s(890492),Me=()=>s(81068),Ce=()=>s(663639),Te=()=>s(534177),Ne=()=>s(284371);var Be=()=>s(792057);function Re(e){const{permission:i,includeHybrid:s}=e;return"none"===i.role?"private":s?"open_unlisted_hybrid":i.unlisted_timestamp?"unlisted":"open"}var Oe=()=>s(367049);var De=()=>s(382607),Le=()=>s(629027);function Ee(e){const{store:i,publicPermission:s,permissionItemArgs:t,menuListItemProps:n,onClose:r}=e,{permissionItem:a,from:l}=s,{sudoModeStore:m,location:u}=t,g=(0,d().v3)(),{isPhone:h}=(0,d().Y0)(),b=(0,ge().v)(s.permissionItem),v=(0,Le().P)({store:i}),f=v.disabled,y=(0,o.useCallback)((async()=>{const e=(0,j().Yi)(l),s=ye(i,"reader");await(0,Se().Hc)({oldPermissionItem:a,newPermissionItem:s,wasInherited:e!==i.id,environment:g,store:i,sudoModeStore:m,location:u}),r()}),[g,i,a,l,m,u,r]),I=(0,p().IS)((()=>({menuItemDesktopIconStyle:{...c().A.isMobile?{marginTop:5,marginBottom:4,marginInlineStart:13,marginInlineEnd:6}:{marginInlineStart:0},alignSelf:"center"},menuItemContainer:{minHeight:28,marginBottom:2,lineHeight:"unset",...h&&{paddingTop:De().T3,paddingBottom:De().T3},color:T().Tj.text.primary,...f&&{color:T().Tj.text.tertiary}}})),[h,f]);let S;return f&&"space"===v.disabledBy&&(S=(0,ee.jsx)(C().sA,{defaultMessage:"Workspace admin has disabled this sharing permission",id:"publicShareLinkItem.menuItemTooltip.publicSharingDisabledWorkspace"})),f&&"team"===v.disabledBy&&(S=(0,ee.jsx)(C().sA,{defaultMessage:"Teamspace admin has disabled this sharing permission",id:"publicShareLinkItem.menuItemTooltip.publicSharingDisabledTeamspace"})),(0,ee.jsx)(H().m,{renderTooltip:e=>S,placement:"bottom",disableTooltip:!f,render:e=>(0,ee.jsx)(Me().A,{...n,...e,title:(0,ee.jsx)(C().sA,{defaultMessage:"Anyone on the web with link",id:"publicShareLinkItem.menuItem.title"}),shouldWrapTitle:!0,shouldWrapCaption:!0,style:I.menuItemContainer,icon:(0,ee.jsx)(ce().I,{icon:ve().globeIcon,colorVariant:f?"tertiary":"secondary"}),desktopIconStyle:I.menuItemDesktopIconStyle,isChecked:b,disabled:f,onClick:y})})}var We=()=>s(471095),Ke=()=>s(898808);const Ve=de().Ev.default,Ue=[{key:"private",title:({type:e})=>"full"===e?(0,ee.jsx)(C().sA,{id:"linkSharingPill.visibilityTitle.inviteOnlyFullLength",defaultMessage:"Only people invited"}):(0,ee.jsx)(C().sA,{id:"linkSharingPill.visibilityTitle.inviteOnly",defaultMessage:"Invite only"}),caption:()=>(0,ee.jsx)(C().sA,{id:"linkSharingPill.visibilityCaption.inviteOnly",defaultMessage:"Only you and people invited can access"}),icon:({style:e})=>(0,ee.jsx)(ce().I,{icon:We().lockFillIcon,style:{...e,marginTop:1}})},{key:"unlisted",title:({spaceName:e})=>(0,ee.jsx)(C().sA,{id:"linkSharingPill.visibilityTitle.anyoneWithLinkRedesign",defaultMessage:"Anyone at {spaceName} with the link",values:{spaceName:e}}),caption:()=>(0,ee.jsx)(C().sA,{id:"linkSharingPill.visibilityCaption.anyoneWithLinkRedesign",defaultMessage:"Workspace members can access with the link"}),icon:({style:e})=>(0,ee.jsx)(ce().I,{icon:s(742852).linkIcon,style:{...e,marginTop:1}})},{key:"open",title:({spaceName:e})=>(0,ee.jsx)(C().sA,{id:"linkSharingPill.visibilityTitle.everyoneInWorkspace",defaultMessage:"Everyone at {spaceName}",values:{spaceName:e}}),caption:()=>(0,ee.jsx)(C().sA,{id:"linkSharingPill.visibilityCaption.everyoneInWorkspaceV2",defaultMessage:"Workspace members can access and discover in search"}),icon:({spaceStore:e,teamspaceIconSize:i})=>(0,ee.jsx)(Ke().x,{disabled:!0,store:e,size:i,style:{marginInlineStart:(Ve-i)/2,marginInlineEnd:(Ve-i)/2}})},{key:"open_unlisted_hybrid",title:({spaceName:e,visibility:i})=>"unlisted"===i?(0,ee.jsx)(C().sA,{id:"blockPermissionsSettings.permissionItem.workspaceAccessNew.unlisted",defaultMessage:"Everyone at {spaceName} with the link",values:{spaceName:e}}):(0,ee.jsx)(C().sA,{id:"linkSharingPill.visibilityTitle.everyoneInWorkspace",defaultMessage:"Everyone at {spaceName}",values:{spaceName:e}}),caption:()=>{},icon:({spaceStore:e,teamspaceIconSize:i})=>(0,ee.jsx)(Ke().x,{disabled:!0,store:e,size:i,style:{marginInlineStart:(Ve-i)/2,marginInlineEnd:(Ve-i)/2}})}];const Ge={key:"publicShareLink",title:()=>{},caption:()=>{},icon:()=>{}};function Fe(e){const{store:i,spacePermission:t,sudoModeStore:n,location:r,isRestricted:a,trustedDomainPermission:l,publicPermission:u,showPublicShareLinkPermission:g,parentCloseCallback:h,handleSpacePermissionChange:b,permissionItemArgs:v,onlyShowPrivateSpaceVisibility:f}=e,y=(0,d().v3)(),{isTablet:x}=(0,d().Y0)(),A=(0,m().O$)(Ae().AppStoreSidebarSpaceStore),w=Re({permission:t.permissionItem,includeHybrid:!0}),M=Re({permission:t.permissionItem,includeHybrid:!1}),N=t.from,B=(0,j().Yi)(N),R=!(N.table===i.table&&B===i.id),O=(0,m().K8)((()=>{const{sidebarSpaceStore:e}=Ae().default.state;return!(!e||i.table!==_().ev)&&i.isTopLevelWorkspacePage(e.id)}),[i]),D=(0,s(653953).X)(),L=(0,m().K8)((()=>{const e=U().QJ({store:i});return e?Re({permission:e,includeHybrid:!1}):"private"}),[i]),E=(0,j().Tt)((null==l?void 0:l.permissionItem.role)??"none"),W=function(e){const{onlyShowPrivateSpaceVisibility:i,hideOpenAndUnlistedOption:s}=e;return Ue.filter((({key:e})=>i||s?"private"===e:"private"===e||"open_unlisted_hybrid"===e))}({onlyShowPrivateSpaceVisibility:f,hideOpenAndUnlistedOption:(0,Oe().V)()});(0,o.useEffect)((()=>{null!=A&&A.id&&s(31082).V0({environment:y,spaceId:A.id,pageId:i.id,pageVisibility:M,hasTrustedDomainPermission:E,hasPublicShareLinkPermission:!(null==u||!u.permissionItem)&&(0,ge().v)(u.permissionItem),shareMenuSessionId:F().Ay.state.sessionId})}),[null==A?void 0:A.id,i.id,M,E,y,u]);const K=g?[...W,Ge]:W,V=(0,p().IS)((()=>({icon:{fill:c().A.isMobile?T().Tj.icon.primary:T().Tj.text.primary,width:Ve},iconContainer:{...c().A.isMobile?{marginInlineStart:13,marginTop:5,marginBottom:4}:{marginInlineStart:0},marginInlineEnd:0,alignSelf:"center"},selectedTitle:{},titleStyle:c().A.isMobile?{marginInlineStart:4}:{},mobileScroller:{background:T().Tj.background.secondary},mobileButton:{paddingTop:8,paddingBottom:8},mobileButtonDivider:{borderBottom:`1px solid ${T().Tj.border.secondaryTranslucent}`},sectionMenuItem:{...c().A.isMobile?{}:{paddingTop:4,paddingBottom:4},...c().A.isMobile?{overflow:"hidden",background:T().Tj.background.elevated,borderRadius:12,marginInlineStart:16,marginInlineEnd:16,marginBottom:16,borderWidth:1,borderStyle:"solid",borderColor:T().Tj.border.secondary,padding:void 0}:{}},menuList:{...c().A.isMobile?{width:"100%",margin:"0 auto"}:{}},header:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",background:T().Tj.background.secondary,paddingTop:12,paddingBottom:20},headerLabel:{fontSize:16,fontWeight:Ne().Wy.semibold}})),[]);if(!A)return null;const G=!!u&&(0,ge().v)(u.permissionItem);return(0,ee.jsx)(ke().A,{menuType:(c().A.isMobile,we().gu.Popup),disableScroller:!0,scrollerStyle:c().A.isMobile?V.mobileScroller:{},height:c().A.isMobile?x?"100%":"50vh":void 0,minWidth:c().A.isMobile?"100%":void 0,maxWidth:c().A.isMobile?"100%":void 0,maxHeight:c().A.isMobile?"100%":void 0,header:c().A.isMobile?(0,ee.jsx)("div",{style:V.header,children:(0,ee.jsx)(q().A,{style:V.headerLabel,children:(0,ee.jsx)(C().sA,{defaultMessage:"General access",id:"PermissionRoleSelect.Header.GeneralAccess"})})}):void 0,children:(0,ee.jsx)(Ce().A,{type:Ce().O.Vertical,initialFocus:void 0,style:c().A.isMobile?V.menuList:void 0,sections:[{key:"visibilityOptions",render:e=>(0,ee.jsx)(S().A,{...e,disableDesktopPadding:c().A.isMobile,style:V.sectionMenuItem}),items:K.map(((e,o)=>{const l=e.key;if("publicShareLink"===l){if(i.table!==_().ev)return;return u?{key:"public_share_link",action:()=>{},render:e=>(0,ee.jsx)(Ee,{store:i,publicPermission:u,permissionItemArgs:v,menuListItemProps:e,onClose:h})}:void 0}const d=function(e){const{oldVisibility:i,newVisibility:s,hasPublicShareLinkPublicPermission:t}=e;if(t)return!1;if(i===s)return!0;if("unlisted"===i&&"open"===s||"open"===i&&"unlisted"===s)return!0;return!1}({oldVisibility:w,newVisibility:l,hasPublicShareLinkPublicPermission:G}),m=o!==Ue.length-1,p={minHeight:28,...c().A.isMobile?V.mobileButton:{},...c().A.isMobile&&m?V.mobileButtonDivider:{},...m&&!c().A.isMobile&&{marginBottom:2}};return{key:l,render:i=>(0,ee.jsx)(Me().A,{title:(0,ee.jsx)(q().A,{isMultiline:!0,children:e.title({spaceName:D,type:"full",visibility:M})}),icon:e.icon({style:V.icon,spaceStore:A,teamspaceIconSize:20}),desktopIconStyle:V.iconContainer,titleStyle:{...V.titleStyle,...d&&!c().A.isMobile?V.selectedTitle:{}},isChecked:d,buttonStyle:{borderRadius:6},style:p,shouldWrapTitle:!0,...i}),action:async()=>{if(d)return;if(!(await async function(e){const{isAgent:i,oldVisibility:s,newVisibility:t}=e;if(!i)return!0;if("private"!==s||"private"===t)return!0;const{accept:n}=await Be().Gh({icon:(0,ee.jsx)(ce().I,{icon:P().infoCircleIcon,size:"xl"}),message:(0,ee.jsx)(I().D,{styleKey:"titleSmSemibold",children:(0,ee.jsx)(C().sA,{id:"shareMenu.generalAccess.agentWorkspaceWarning.confirmation.title",defaultMessage:"Make this agent available to everyone?"})}),description:(0,ee.jsx)(q().A,{isSmall:!0,isMultiline:!0,style:{marginTop:8},children:(0,ee.jsx)(C().sA,{id:"shareMenu.generalAccess.agentWorkspaceWarning.confirmation.description",defaultMessage:"This agentâ€™s sources and tools will be accessible to everyone in the workspace, even if they wouldnâ€™t have access otherwise."})}),acceptColor:"blue",acceptLabel:(0,ee.jsx)(C().sA,{id:"shareMenu.generalAccess.agentWorkspaceWarning.confirmation.accept",defaultMessage:"Continue"}),cancelLabel:(0,ee.jsx)(C().sA,{id:"shareMenu.generalAccess.agentWorkspaceWarning.confirmation.cancel",defaultMessage:"Cancel"})});return n}({isAgent:i.table===k().C0,oldVisibility:M,newVisibility:l})))return void h();const e=t.permissionItem,o={type:"space_permission",role:ze(e,M,l,i)};"unlisted"===l&&(o.unlisted_timestamp=Date.now());const c=function(e,i){if(e===i)return!1;switch(i){case"open":case"open_unlisted_hybrid":return!1;case"unlisted":return"open"===e;case"private":return!0;default:(0,Te().HB)(i)}}(L,l)&&!a&&!O;let m=!1,p=!1;if("block"===i.table){const e=await(0,s(6104).S)({environment:y,store:i,newPermissionItem:o});if(e.wasDuplicatable&&!e.willBeDuplicatable){if(!e.confirmedChange)return void h();m=!0}else!e.wasDuplicatable&&e.willBeDuplicatable&&(p=!0)}const g=await(0,Se().Hc)({oldPermissionItem:e,newPermissionItem:o,wasInherited:R,environment:y,store:i,sudoModeStore:n,location:r,restrictingVisibility:c});g&&b&&b({before:e,after:o}),g&&"private"===l&&u&&G&&function(e){const{environment:i,store:s,publicPermission:t,wasInherited:n,location:o,sudoModeStore:r}=e,a=t.permissionItem,l=ye(s,"none");(0,Se().Hc)({environment:i,store:s,oldPermissionItem:a,newPermissionItem:l,wasInherited:n,location:o,sudoModeStore:r})}({environment:y,store:i,publicPermission:u,wasInherited:R,location:r,sudoModeStore:n}),g&&m?s(258285).a({environment:y,spaceStore:A,pageId:void 0,from:"page_permissions"}):g&&p&&(0,s(392740).V)({environment:y,spaceStore:A,errors:[]}),h()}}})).filter(Te().O9)}]})})}function ze(e,i,s,t){return"private"===s?"none":t.table===k().C0&&"private"===i?"reader":"private"===i?"editor":e.role}const He=o.memo((function({store:e,spacePermission:i,trustedDomainPermission:t,publicPermission:n,showPublicShareLinkPermission:r,isRestricted:a,permissionItemArgs:l,hideHoverStyles:d,buttonPopupStore:u,isDisplayOnly:g,handleSpacePermissionChange:h,title:b,onlyShowPrivateSpaceVisibility:v}){const f=e.table===_().ev,y=(0,s(891078).i0)(f?e:void 0),I=(0,m().K8)((()=>e.canAdmin()),[e]),S=!I||g||y,x=(0,o.useCallback)((()=>u.setState({...u.state,open:!0})),[u]),P=(0,p().IS)((()=>({origin:{display:"flex",alignItems:"center",justifyContent:"center",paddingInlineStart:6,marginInlineStart:-6,height:void 0,paddingTop:4,paddingBottom:4,maxWidth:250,flexShrink:1},privacyMenu:{...!c().A.isMobile&&{width:330,borderRadius:10},...c().A.isMobile&&{maxWidth:"100%"}},title:{fontSize:14,whiteSpace:"normal"},mobileButton:{display:"flex",alignItems:"center",whiteSpace:"normal",gap:4,marginBottom:4,height:void 0}})),[]);return S?(0,ee.jsx)("div",{style:P.title,children:b}):(0,ee.jsx)(Pe().A,{renderOrigin:e=>c().A.isMobile?(0,ee.jsx)("div",{style:P.title,...e,children:(0,ee.jsxs)("div",{style:P.mobileButton,children:[b,(0,ee.jsx)(ce().I,{icon:_e().arrowChevronSingleRightSmallIcon,size:"sm",colorVariant:"secondary"})]})}):(0,ee.jsxs)(je().p,{style:P.origin,hoveredStyle:d?{background:"unset"}:void 0,pressedStyle:d?{background:"unset"}:void 0,disabled:S,...e,children:[(0,ee.jsx)(s(404905).j,{children:b}),I?(0,ee.jsx)(ce().I,{icon:s(324254).arrowChevronSingleDownSmallIcon,size:"sm",colorVariant:"secondary"}):null]}),disabled:S,onClick:x,buttonPopupStore:u,style:P.privacyMenu,alignmentToOrigin:"start",popupType:c().A.isMobile?xe().nl.BottomSheet:xe().nl.Popup,render:s=>i?(0,ee.jsx)(Fe,{store:e,spacePermission:i,parentCloseCallback:s.close,trustedDomainPermission:t,publicPermission:n,showPublicShareLinkPermission:r,isRestricted:a,sudoModeStore:l.sudoModeStore,location:l.location,permissionItemArgs:l,handleSpacePermissionChange:h,onlyShowPrivateSpaceVisibility:v}):null})}));var qe=()=>s(99756),Ye=()=>s(404694),$e=()=>s(734762),Qe=()=>s(148297),Xe=()=>s(914649),Je=()=>s(300789),Ze=()=>s(131448);function ei(e){const{originRef:i}=e,s=(0,d().v3)(),t=(0,m().K8)((()=>Ze().default.isVisible(Xe().dv)),[]),n=(0,Ye().V)();return(0,ee.jsx)($e().B,{shouldShow:t,calloutId:Xe().dv,inAppCalloutStore:n,children:(0,ee.jsx)(Qe().k,{style:{width:260},pointerLength:25,pointerPosition:"50%",origin:i,placementToOrigin:"left",alignmentToOrigin:"center",numSteps:1,header:(0,ee.jsx)(C().sA,{id:"meeting_notes_public_share_link_tooltip.header",defaultMessage:"Public link copied!"}),content:(0,ee.jsx)(C().sA,{id:"meeting_notes_public_share_link_tooltip.content",defaultMessage:"This page is now accessible to anyone on the web with the link and ready to share."}),finalButtonContent:null,onCloseClick:()=>{(0,Je().a)(s,Xe().dv)},shouldDismissUponOutsideClick:!0})})}const ii={type:"public_permission",role:"none",is_public_share_link:!1};function si(e){const{store:i,spacePermission:s,publicPermission:t,trustedDomainPermission:n,permissionItemArgs:r,fromPermissionWrapper:l,isRestricted:u}=e,{permissionItem:g,from:h}=t,{location:b,sudoModeStore:v}=r,f=(0,d().v3)(),y=(0,o.useRef)(null),I=(0,m().uB)(void 0,be().A),S=!f.currentUser.isLoggedIn(),x="none"!==s.permissionItem.role,P=(0,ge().v)(g)?g:{...g,...ii},_=(0,o.useCallback)((()=>{I.setState({open:!0})}),[I]),A=(0,o.useCallback)((async e=>{const s=(0,j().Yi)(h)!==i.id;if("string"!=typeof e||!(e in j().TE))return!1;const t=ye(i,e);return await(0,Se().Hc)({environment:f,store:i,oldPermissionItem:g,newPermissionItem:t,wasInherited:s,location:b,sudoModeStore:v})}),[f,i,g,h,b,v]),w=(0,o.useCallback)((async e=>{const s=(0,j().Yi)(h)!==i.id,t={...g,expiration_timestamp:e};return await(0,Se().Hc)({environment:f,store:i,oldPermissionItem:g,newPermissionItem:t,wasInherited:s,location:b,sudoModeStore:v})}),[f,i,g,h,b,v]),k=(0,p().IS)((()=>({container:{width:"100%"},linkExpirationContainer:c().A.isMobile?{minHeight:0}:{},linkExpirationButton:c().A.isMobile?{paddingInlineStart:16,paddingInlineEnd:16,paddingTop:12,paddingBottom:12,width:void 0,borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:T().Tj.border.secondary,background:T().Tj.background.elevated}:{padding:0}})),[]),M=(0,o.useMemo)((()=>[{role:"none",prefixItem:{key:"link-expiration",render:e=>(0,ee.jsx)("div",{...e,children:(0,ee.jsx)(Ie().A,{permissionItem:g,hideIcon:!0,onChange:w,focused:!1,buttonStyle:k.linkExpirationButton,style:k.linkExpirationContainer,spaceStore:(0,a().f)(i)})}),action:()=>{}}}]),[g,i,w,k.linkExpirationButton,k.linkExpirationContainer]);return(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsx)(ei,{originRef:y}),(0,ee.jsx)("div",{style:k.container,className:he().VRj,ref:y,children:(0,ee.jsx)(Z().Ay,{store:i,permissionItem:P,from:h,shouldDisable:S,fromPermissionWrapper:l,onClick:_,onChange:A,roleItemOverrides:M,icon:(0,ee.jsx)(ti,{}),title:(0,ee.jsx)(He,{store:i,spacePermission:s,trustedDomainPermission:n,publicPermission:t,showPublicShareLinkPermission:!0,isRestricted:u,permissionItemArgs:r,fromPermissionWrapper:l,buttonPopupStore:I,hideHoverStyles:!1,isDisplayOnly:r.shouldDisable??!1,title:(0,ee.jsx)(ni,{}),onlyShowPrivateSpaceVisibility:x}),subtitle:c().A.isMobile?(0,ee.jsx)(oi,{role:g.role}):void 0,upgradeButtonName:"public_share_link_item",isRemovableOverride:!0,renderTitleWithoutUILabelWrapper:!0,...r})})]})}function ti(){const e=(0,p().IS)((()=>({globeIcon:{width:c().A.isMobile?24:de().Ev.default,height:c().A.isMobile?24:de().Ev.default}})),[]);return(0,ee.jsx)(qe().A,{type:"square",iconType:"function",iconFn:ve().globeIcon,iconStyle:e.globeIcon})}function ni(){const e=(0,p().IS)((()=>({title:{fontSize:14,whiteSpace:"normal"}})),[]);return(0,ee.jsx)("div",{style:e.title,children:(0,ee.jsx)(C().sA,{defaultMessage:"Anyone on the web with link",id:"publicShareLinkItem.permissionItem.title"})})}function oi(e){const{role:i}=e;return c().A.isMobile?(0,ee.jsx)(C().sA,{...(0,fe().R)({type:"public_permission",role:i,table:"block",isRemovable:!1}).label}):null}var ri=()=>s(574359);function ai({store:e}){const i=(0,m().K8)((()=>{var i;return null===(i=e.getIcon())||void 0===i?void 0:i.icon}),[e]),s=(0,p().eP)(),t=(0,p().IS)((()=>({teamOrSpaceIcon:(0,G().iM)({themeMode:s,size:c().A.isMobile?Z().Bj:Z().Ev,useLargeBorderRadius:!0,useLightBackgroundColor:!0,icon:i}),iconBoxStyles:{color:T().Tj.icon.secondary}})),[i,s]),{innerEmojiOrFlatIconSize:n,innerInitialSize:o}=function({baseSize:e}){return{innerEmojiOrFlatIconSize:.65*e,innerInitialSize:.75*e}}({baseSize:c().A.isMobile?Z().Bj:Z().Ev});return(0,ee.jsx)(Ke().x,{disabled:!0,store:e,size:c().A.isMobile?Z().Bj:Z().Ev,iconContainerStyles:t.teamOrSpaceIcon,iconBoxStyles:t.iconBoxStyles,innerEmojiOrFlatIconSize:n,innerInitialSize:o})}const li=o.memo(ai);function ci({store:e,spaceOwnerPermission:i,permissionItemArgs:s,fromPermissionWrapper:t}){const n=(0,d().v3)(),o=(0,m().O$)(Ae().AppStoreSidebarSpaceStore),r=(0,m().K8)((()=>{if(o)return(0,ri().G)(n,o)}),[n,o]);return o?(0,ee.jsx)(Z().Ay,{store:e,permissionItem:i.permissionItem,from:i.from,icon:(0,ee.jsx)(li,{store:o}),title:(0,ee.jsx)(q().A,{isMultiline:!0,children:(0,ee.jsx)(C().sA,{id:"spaceOwnerPermissionItem.title",defaultMessage:"Owners of {spaceName}",values:{spaceName:r||(0,ee.jsx)(C().sA,{id:"generalAccessPermissionsList.getSpaceName.untitledWorkspace.name",defaultMessage:"Untitled workspace"})}})}),upgradeButtonName:"space_owner_permission_item",fromPermissionWrapper:t,isRemovableOverride:!1,hideRoleSelectButton:!1,renderTitleWithoutUILabelWrapper:!0,shouldDisable:!0,...s}):null}var di=()=>s(287188);function mi(e){const{permissionItem:i,onToggle:s,focused:t}=e,n=(0,C().tz)(),o=Boolean(i)&&!Boolean(i.unlisted_timestamp),r=(0,p().IS)((()=>({visibilityToggle:{display:"flex",alignItems:"start",justifyContent:"space-between",marginInlineStart:12,paddingInlineStart:4},buttonMenuItemStyleMobile:{backgroundColor:T().Tj.background.elevated,paddingTop:12,paddingBottom:12,marginInlineEnd:12,borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:T().Tj.border.secondary,width:"100%"}})),[]),a=n.formatMessage({id:"spacePermissionItem.visibilityPicker.unlistedToggle",defaultMessage:"Hide in search"});return(0,ee.jsx)("div",{children:(0,ee.jsx)(Me().A,{onClick:s,focused:t,style:c().A.isMobile?r.buttonMenuItemStyleMobile:{},title:a,shouldWrapTitle:!0,right:(0,ee.jsx)("div",{style:c().A.isMobile?{}:r.visibilityToggle,children:(0,ee.jsx)(di().A,{disabled:!1,on:!o,onClick:s})})})})}var pi=()=>s(79926);const ui=new(pi().O2)("PublicShareLinkTutorialTooltip",(()=>s.e(77916).then(s.bind(s,146842)))),gi=(0,pi()._h)(ui,(e=>e.PublicShareLinkTutorialTooltip));var hi=()=>s(146842);function bi({visibility:e,spaceStore:i}){const s=(0,d().v3)(),t=(0,m().K8)((()=>(0,ri().G)(s,i)),[s,i]);switch(e){case"private":return(0,ee.jsx)(C().sA,{id:"spacePermissionVisibilityPicker.private",defaultMessage:"Only people invited"});case"unlisted":return(0,ee.jsx)(C().sA,{id:"blockPermissionsSettings.permissionItem.workspaceAccessNew.unlisted",defaultMessage:"Everyone at {spaceName} with the link",values:{spaceName:t}});case"open":case"open_unlisted_hybrid":return(0,ee.jsx)(C().sA,{defaultMessage:"Everyone at {workspaceName}",id:"blockPermissionsSettings.permissionItem.workspaceAccessNew",values:{workspaceName:t}});default:(0,Te().HB)(e)}}const vi=new(s(29923).R)({key:"shareMenuRoleSelectCalloutCount",namespace:s(553737).Bq,important:!0,trackingType:"necessary"});function fi({visibility:e,spaceStore:i}){const s=(0,p().IS)((()=>({lockIcon:{width:c().A.isMobile?24:18,height:c().A.isMobile?24:18}})),[]);return"private"===e?(0,ee.jsx)(qe().A,{type:"square",iconType:"function",iconFn:We().lockFillIcon,iconStyle:s.lockIcon}):"unlisted"===e||"open"===e||"open_unlisted_hybrid"===e?(0,ee.jsx)(li,{store:i}):void(0,Te().HB)(e)}function yi({store:e,spacePermission:i,trustedDomainPermission:s,publicPermission:t,showPublicShareLinkPermission:n,isRestricted:o,permissionItemArgs:r,fromPermissionWrapper:a,buttonPopupStore:l,visibility:c,spaceStore:d,hideHoverStyles:m,isDisplayOnly:p,handleSpacePermissionChange:u}){return(0,ee.jsx)(He,{store:e,spacePermission:i,trustedDomainPermission:s,publicPermission:t,showPublicShareLinkPermission:n,isRestricted:o,permissionItemArgs:r,fromPermissionWrapper:a,buttonPopupStore:l,hideHoverStyles:m,isDisplayOnly:p,handleSpacePermissionChange:u,title:(0,ee.jsx)(bi,{visibility:c,spaceStore:d})})}const Ii=function({trustedDomainPermission:e,isRestricted:i,publicPermission:t,showPublicShareLinkPermission:n,shouldShowPublicShareLinkTooltip:r,...l}){const{store:u,spacePermission:g,fromPermissionWrapper:h}=l,b=(0,d().v3)(),v=(0,o.useRef)(null),f=(0,m().uB)(void 0,be().A);(0,o.useEffect)((()=>{r&&(0,Je().HH)(b,hi().PUBLIC_SHARE_LINK_TOOLTIP_ID)}),[b,r]);const y=j().Ni(g.permissionItem)&&"none"!==g.permissionItem.role,I=(0,V().QX)(g),S=(0,m().K8)((()=>(0,a().f)(u)),[u]),x=(0,m().K8)((()=>null==S||!S.isDefined()),[S]),P=(0,m().K8)((()=>!!S&&(0,s(272509).I)(S)),[S]),A=(0,m().K8)((()=>(0,U().WG)()),[]),w=(0,m().K8)((()=>s(242422).default.checkGate({gateName:"domain_link_sharing_redesign_override",disableExposureLogging:!0})),[]),M=(0,s(726360).H)(),T=(0,m().K8)((()=>{var e;return null==M||null===(e=M.getForSpace(S))||void 0===e?void 0:e.trustedDomains}),[M,S]),B=(0,m().K8)((()=>(0,s(965597).Hb)({space:null==S?void 0:S.getModel(),trustedDomains:T,enableTrustedDomainPermissionRedesign:w})),[S,T,w]),R=(0,m().K8)((()=>S&&u.table===_().ev?u.isTopLevelWorkspacePage(S.id):u.table===k().C0),[u,S]),O=(0,m().K8)((()=>{const e=(0,U().QJ)({store:u});return e?Re({permission:e,includeHybrid:!1}):"private"}),[u]),D=(0,m().K8)((()=>vi.getState()??0),[]),[L,E]=(0,o.useState)(!1),W=(0,o.useCallback)((({before:e,after:i})=>{let s=!1;const t=(0,V().QX)(e),n=(0,V().QX)(i);"private"===t&&"private"!==n&&D<3&&(s=!0,vi.setState(D+1)),E(s)}),[D]),K=(0,o.useCallback)((()=>{f.setState({open:!0})}),[f]),G=(0,o.useCallback)((async()=>{const e=g.permissionItem,s=(0,N().mg)(e);let t;"unlisted"===("open"===I?"unlisted":"open")?(s.unlisted_timestamp=Date.now(),t="open"===O):(delete s.unlisted_timestamp,t=!1);const n=g.from,o=(0,j().Yi)(n),r=!(n.table===u.table&&o===u.id);t=t&&!R&&!i,await(0,Se().Hc)({oldPermissionItem:e,newPermissionItem:s,wasInherited:r,environment:b,store:u,restrictingVisibility:t,sudoModeStore:l.permissionItemArgs.sudoModeStore,location:l.permissionItemArgs.location})}),[b,g,R,l.permissionItemArgs,I,u,i,O]),F=(0,p().IS)((()=>({container:{width:"100%"}})),[]),z=(0,o.useMemo)((()=>[{key:"can-find-in-search-toggle",render:e=>(0,ee.jsx)(H().m,{placement:"left",renderTooltip:()=>(0,ee.jsx)("div",{style:{width:250,whiteSpace:"normal"},children:(0,ee.jsx)(C().sA,{defaultMessage:"Hide this page in search results from users without the link or who havenâ€™t visited it before",id:"spacePermissionItem.unlistedToggle.tooltip"})}),render:i=>(0,ee.jsx)("div",{...e,...i,children:(0,ee.jsx)(mi,{permissionItem:g.permissionItem,onToggle:G,focused:e.focused})})}),action:()=>{}}]),[g,G]),q="private"===I;if(!S)return null;if(x)return P?(0,ee.jsx)("div",{style:F.container,className:y?void 0:he().VRj,children:(0,ee.jsx)(Z().Ay,{store:u,permissionItem:g.permissionItem,from:g.from,icon:(0,ee.jsx)(fi,{visibility:I,spaceStore:S}),iconStyle:void 0,title:(0,ee.jsx)(yi,{store:u,spaceStore:S,spacePermission:g,trustedDomainPermission:e,publicPermission:t,showPublicShareLinkPermission:n,isRestricted:!0,permissionItemArgs:l.permissionItemArgs,fromPermissionWrapper:h,buttonPopupStore:f,visibility:I,hideHoverStyles:q,isDisplayOnly:!0,handleSpacePermissionChange:W}),subtitle:c().A.isMobile&&!q?(0,ee.jsx)(C().sA,{...(0,fe().R)({type:"space_permission",role:g.permissionItem.role,table:"block",isRemovable:!1}).label}):void 0,upgradeButtonName:"space_permission_item",fromPermissionWrapper:h,isRemovableOverride:!0,hideRoleSelectButton:q,renderTitleWithoutUILabelWrapper:!0,...l.permissionItemArgs,shouldDisable:!0})}):null;const $=A&&(null==B?void 0:B.length)>0&&("open"===I||"unlisted"===I),Q=$?(0,ee.jsx)(C().sA,{defaultMessage:"Anyone with a {trustedDomain} email can also view this page",id:"blockPermissionsSettings.spacePermission.trustedDomainTooltip",values:{trustedDomain:B[0]}}):void 0;return(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsx)(gi,{originRef:v,onPrimaryButtonClick:K}),(0,ee.jsx)(hi().CopyLinkNoPermissionsTooltip,{originRef:v,onPrimaryButtonClick:K}),(0,ee.jsx)("div",{style:F.container,className:y?void 0:he().VRj,ref:v,children:(0,ee.jsx)(Z().Ay,{store:u,permissionItem:g.permissionItem,from:g.from,icon:(0,ee.jsx)(fi,{visibility:I,spaceStore:S}),iconStyle:void 0,title:(0,ee.jsx)(yi,{store:u,spaceStore:S,spacePermission:g,trustedDomainPermission:e,publicPermission:t,showPublicShareLinkPermission:n,isRestricted:i,permissionItemArgs:l.permissionItemArgs,fromPermissionWrapper:h,buttonPopupStore:f,visibility:I,hideHoverStyles:q,isDisplayOnly:l.permissionItemArgs.shouldDisable??!1,handleSpacePermissionChange:W}),selectHeader:c().A.isMobile?(0,ee.jsx)(Y().Ay,{title:(0,ee.jsx)(yi,{store:u,spaceStore:S,spacePermission:g,trustedDomainPermission:e,publicPermission:t,showPublicShareLinkPermission:n,isRestricted:i,permissionItemArgs:l.permissionItemArgs,fromPermissionWrapper:h,buttonPopupStore:f,visibility:I,hideHoverStyles:q,isDisplayOnly:!0,handleSpacePermissionChange:W}),icon:(0,ee.jsx)(fi,{visibility:I,spaceStore:S}),desktopIconStyle:{marginInlineStart:16}}):void 0,onClick:K,inheritedTooltip:$?Q:void 0,nonInheritedTooltip:Q,subtitle:c().A.isMobile&&!q?(0,ee.jsx)(C().sA,{...(0,fe().R)({type:"space_permission",role:g.permissionItem.role,table:"block",isRemovable:!1}).label}):void 0,upgradeButtonName:"space_permission_item",fromPermissionWrapper:h,isRemovableOverride:!0,hideRoleSelectButton:q,renderTitleWithoutUILabelWrapper:!0,additionalCapabilities:z,openRoleSelectMenuOnRender:L,...l.permissionItemArgs})})]})};function Si(e){const{store:i,spaceOwnerPermission:s,showSpaceOwnerPermission:t,spacePermission:n,showSpacePermission:o,trustedDomainPermission:r,publicPermission:a,showPublicShareLinkPermission:l,permissionItemArgs:c,isRestricted:d}=e,m=(0,ge().v)(a.permissionItem);return(0,ee.jsxs)(ee.Fragment,{children:[t?(0,ee.jsx)(ci,{store:i,spaceOwnerPermission:s,permissionItemArgs:c,fromPermissionWrapper:"permission_list"}):void 0,o&&xi(n,a,l)?l?(0,ee.jsx)(Ii,{store:i,spacePermission:n,publicPermission:a,showPublicShareLinkPermission:l&&!m,trustedDomainPermission:r,permissionItemArgs:c,fromPermissionWrapper:"permission_list",isRestricted:d,shouldShowPublicShareLinkTooltip:!m}):(0,ee.jsx)(Ii,{store:i,spacePermission:n,showPublicShareLinkPermission:!1,trustedDomainPermission:void 0,permissionItemArgs:c,fromPermissionWrapper:"permission_list",isRestricted:d}):void 0,l&&m?(0,ee.jsx)(si,{store:i,spacePermission:n,publicPermission:a,trustedDomainPermission:r,permissionItemArgs:c,fromPermissionWrapper:"permission_list",isRestricted:d}):void 0]})}function xi(e,i,s){return!s||("none"!==e.permissionItem.role||"none"===e.permissionItem.role&&!(0,ge().v)(i.permissionItem))}const Pi={viewBox:"0 0 20 20",fittedViewBox:"2.35 2.37 15.6 15.25",svg:(0,ee.jsx)("path",{d:"M8.674 11.629c2.7 0 5.101 1.315 6.12 3.306.361.705.2 1.42-.23 1.922-.412.48-1.06.768-1.74.768h-8.3c-.68 0-1.328-.288-1.74-.768-.43-.501-.591-1.217-.23-1.922 1.019-1.99 3.42-3.306 6.12-3.306m6.805.01a.675.675 0 1 1 0 1.35.675.675 0 0 1 0-1.35m.114-5.489c1.168 0 2.358.778 2.358 2.013 0 .714-.427 1.29-.974 1.634l-.636.434v.001a.59.59 0 0 0-.27.476.625.625 0 0 1-1.25 0c0-.609.317-1.163.81-1.504l.003-.002.64-.436.012-.01.015-.008c.287-.175.4-.401.4-.585 0-.301-.359-.764-1.108-.764-.632 0-1.018.358-1.09.646a.625.625 0 0 1-1.213-.304c.248-.99 1.263-1.592 2.303-1.592M8.674 2.375c1.137 0 2.055.469 2.675 1.241.608.758.9 1.766.9 2.824 0 1.059-.292 2.067-.9 2.825-.62.772-1.538 1.242-2.675 1.242s-2.055-.47-2.675-1.242c-.608-.758-.9-1.766-.9-2.825 0-1.058.292-2.066.9-2.824.62-.772 1.538-1.241 2.675-1.241"})},ji=(0,de().wt)("personQuestionFill",Pi,"fill");const _i=function(e){const{store:i}=e,s=(0,p().IS)((()=>({iconContainer:{backgroundColor:T().Tj.background.tertiaryTranslucent,borderRadius:32}})),[]),t={table:_().ev,blockId:i.id};return(0,ee.jsx)(Z().Ay,{icon:(0,ee.jsx)(ce().I,{icon:ji,size:17,colorVariant:"secondary"}),iconStyle:s.iconContainer,title:(0,ee.jsx)(C().sA,{defaultMessage:"More people may have access",id:"blockPermissionsSettings.permissionItem.hiddenAccess"}),nonInheritedTooltip:(0,ee.jsx)(C().sA,{defaultMessage:"This page may be shared with additional people through a parent page or teamspace that you donâ€™t have access to",id:"blockPermissionsSettings.hiddenAccess.tooltip"}),permissionRoleSelect:(0,ee.jsx)(ee.Fragment,{}),store:i,permissionItem:{type:"display_only_hidden_permission"},from:t,upgradeButtonName:"team_permission_item"})};var Ai=()=>s(453597),wi=()=>s(792485),ki=()=>s(574357),Mi=()=>s(77295),Ci=()=>s(267),Ti=()=>s(598101),Ni=()=>s(422155),Bi=()=>s(295633),Ri=()=>s(723085),Oi=()=>s(371722),Di=()=>s(834051),Li=()=>s(996332),Ei=()=>s(433847),Wi=()=>s(946141),Ki=()=>s(187820),Vi=()=>s(16006),Ui=()=>s(339425),Gi=()=>s(492414),Fi=()=>s(632709),zi=()=>s(465960),Hi=()=>s(613850),qi=()=>s(579627),Yi=()=>s(761652),$i=()=>s(247123),Qi=()=>s(547149);async function Xi(e){const{environment:i,useSudoMode:s,store:t,permissionChanges:n,from:o,shareMenuSessionId:r,parentStore:a}=e,l={type:"restore",permissionChanges:n};(!(l.permissionChanges.length>0)||(await Be().Gh({message:(0,$i().r6)(l),description:(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsx)(q().A,{isSmall:!0,isMultiline:!0,children:(0,ee.jsx)(C().sA,{id:"restrictedPermissionConfirmationModal.relink.caption",defaultMessage:"The following settings will be restored to match {parentName}",values:{parentName:(0,ee.jsx)(Yi().A,{store:a,style:{fontWeight:Ne().Wy.regular},useInvertedColors:!1,maxLength:45})}})}),(0,ee.jsx)($i().f2,{openState:l})]}),acceptColor:"blue",acceptLabel:(0,$i().QU)(l),icon:(0,ee.jsx)(ce().I,{icon:Hi().G,size:"xl"})})).accept)&&(t.getPermissionItemsStore().canAdmin()?Qi().createAndCommit({userAction:"PermissionsRestoreBanner.restoreRestrictedPermissions",environment:i,canUndo:!0,useSudoMode:s,perform:e=>{qi().P8({environment:i,store:t,transaction:e,from:o,shareMenuSessionId:r})}}):qi().YD({environment:i,store:t,from:o,shareMenuSessionId:r}))}function Ji(e){const{store:i,sudoModeStore:s}=e,t=(0,d().v3)(),n=(0,wi().S)(),r=(0,m().K8)((()=>function(e){const{store:i,environment:s,pageContext:t}=e,n=(0,ki().U)([Mi().K,(0,Ti().A)(Ui().o)]);if(i.table===_().ev)return n({environment:s,blocks:[i],publicEditMode:void 0,pageContext:t});return!1}({store:i,environment:t,pageContext:n})),[i,t,n]),a=(0,m().K8)((()=>i.table===_().ev&&i.isRestricted()),[i]),l=(0,m().K8)((()=>(0,Oi().f)(i,{includeTeamHomeFeed:!1,includeDataSources:!1})[1]),[i]),c=(0,m().K8)((()=>(0,Ei().wD)((0,Di().E)(l))),[l]),u=(0,o.useCallback)((async()=>{const e=!!s&&s.shouldSaveTransactionWithSudoMode(i);if(i.isDefined()&&l)if(a){if(i.table===_().ev){const s=i.getPermissionItems(),n=(0,Ei().Cd)(i.getModel(),s,c);await Xi({environment:t,useSudoMode:e,store:i,permissionChanges:n,from:"inheritance_banner",shareMenuSessionId:F().Ay.state.sessionId,parentStore:l})}}else await(0,Se().Dw)({environment:t,useSudoMode:e,store:i,permissionItem:void 0,fromPermissionWrapper:"inheritance_banner",shouldInherit:!1})}),[t,s,i,a,l,c]),g=(0,p().IS)((()=>({container:{...(0,G().kJ)(),paddingInlineStart:12,display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:8},labelContainer:{display:"flex",flexDirection:"row",justifyContent:"flex-start"},rightContainer:{flexShrink:0}})),[]);return!r&&a?null:l?c.length<2?null:(0,ee.jsxs)("div",{style:g.container,children:[(0,ee.jsx)("div",{style:g.labelContainer,children:(0,ee.jsx)(q().A,{isMultiline:!0,isSmall:!0,children:(0,ee.jsx)(Zi,{store:i,navigableParentStore:l,showToggle:r})})}),r?(0,ee.jsx)("div",{style:g.rightContainer,children:(0,ee.jsx)(di().A,{on:!a,onClick:u})}):void 0]}):null}function Zi({store:e,navigableParentStore:i,showToggle:s}){const t=(0,d().v3)(),n=(0,m().K8)((()=>{if(i instanceof Bi().B)return(0,Gi().Ay)({store:i,fullyQualified:!1,pageVisitSource:$().y8.ShareMenu})}),[i]),o=(0,m().K8)((()=>(0,Ki().Te)(i)),[i]),r=(0,m().K8)((()=>i.getIcon()),[i]),a=(0,p().IS)((()=>({recordContainer:{display:"inline",alignItems:"center"},title:{display:"inline"},recordIcon:{display:"inline-block",marginInlineEnd:2,verticalAlign:"text-bottom"}})),[]),l=(0,ee.jsxs)("div",{style:a.recordContainer,children:[(0,ee.jsx)(Ki().B6,{disabled:!0,icon:r,iconRecordCategory:o,size:14,isEmptyPage:!1,style:a.recordIcon}),(0,ee.jsx)(Li().Q,{inline:!0,underline:!0,onClick:()=>{i instanceof Ri().h&&(zi().F2({environment:t,teamId:i.id,tab:Fi().p.Members,from:"share_menu"}),Wi().ks(t,{store:i,option:"view",from:"share_menu"}))},href:n,style:a.recordContainer,children:(0,ee.jsx)(Vi().A,{shouldWrap:!0,store:i,style:a.title})})]});return s?(0,ee.jsx)(C().sA,{id:"pageShareMenu.inheritingFromParentPageBanner.switchLabel",defaultMessage:"Share with everyone who has access to {parentPageTitle}",values:{parentPageTitle:l}}):(0,ee.jsx)(C().sA,{id:"pageShareMenu.inheritingFromParentPageBanner.readOnlyLabel",defaultMessage:"Shared with everyone who has access to {parentPageTitle}",values:{parentPageTitle:l}})}var es=()=>s(695115),is=()=>s(243581),ss=()=>s(105239),ts=()=>s(126617),ns=()=>s(735790),os=()=>s(854150),rs=()=>s(115512);async function as(e){const{environment:i,useSudoMode:s,store:t}=e;if(t.table!==_().ev)return;const n={type:"restoreTeamPermissions",permissionChanges:[]},{accept:o}=await Be().Gh({message:(0,$i().r6)(n),acceptLabel:(0,$i().QU)(n),cancelLabel:(0,ee.jsx)(C().sA,{id:"restrictedPermissionConfirmationModal.actionButton.close",defaultMessage:"Close"})});o&&Qi().createAndCommit({userAction:"PermissionsRestoreBanner.restoreTeamPermissions",environment:i,canUndo:!0,useSudoMode:s,perform:e=>{qi().zE({environment:i,store:t,transaction:e})}})}function ls(e){const{showRestoreButton:i,store:s,type:t,sudoModeStore:n}=e,o=(0,m().K8)((()=>(0,Oi().f)(s,{includeTeamHomeFeed:!1,includeDataSources:!1})[1]),[s]),r=(0,m().K8)((()=>s.canAdmin()),[s]),a=(0,p().IS)((()=>({banner:{...(0,G().kJ)(),display:"flex",flexDirection:"row",alignItems:"flex-start",gap:8},content:{display:"flex",alignItems:"flex-start",gap:2,flex:"1 0 0"},label:{fontSize:rs().vQ,lineHeight:"20px",color:T().Tj.text.secondary,flex:"1 0 0",paddingInlineStart:4},iconContainer:{paddingTop:2,height:20,width:20,display:"flex",alignItems:"center",justifyContent:"center"}})),[]);return r?c().A.isMobile?(0,ee.jsxs)("div",{style:a.banner,children:[(0,ee.jsxs)("div",{style:a.content,children:["restricted"===t?(0,ee.jsx)("div",{style:a.iconContainer,children:(0,ee.jsx)(ce().I,{icon:is().arrowBranchIcon,colorVariant:"secondary"})}):void 0,(0,ee.jsx)(q().A,{style:a.label,isMultiline:!0,children:(0,ee.jsx)(cs,{type:t,navigableParentStore:o,showRestoreButton:i,store:s})})]}),i?(0,ee.jsx)(ds,{type:t,store:s,sudoModeStore:n}):void 0]}):(0,ee.jsxs)("div",{style:a.banner,children:[(0,ee.jsxs)("div",{style:a.content,children:["restricted"===t?(0,ee.jsx)("div",{style:a.iconContainer,children:(0,ee.jsx)(ce().I,{icon:is().arrowBranchIcon,colorVariant:"secondary"})}):void 0,(0,ee.jsx)(q().A,{style:a.label,isMultiline:!0,children:(0,ee.jsx)(cs,{store:s,type:t,navigableParentStore:o,showRestoreButton:i})})]}),i?(0,ee.jsx)(ds,{type:t,store:s,sudoModeStore:n}):void 0]}):null}function cs(e){const{store:i,type:s,navigableParentStore:t}=e,n=(0,d().v3)(),o=(0,m().K8)((()=>{if(t instanceof Bi().B)return(0,Gi().Ay)({store:t,fullyQualified:!1,pageVisitSource:$().y8.ShareMenu})}),[t]),r=(0,m().K8)((()=>t instanceof Ri().h),[t]),a=(0,m().K8)((()=>t.getIcon()),[t]),l=(0,m().K8)((()=>i.table===k().C0?"workflow":i.isCollectionView()?"database":"page"),[i]),c=(0,p().IS)((()=>({recordContainer:{display:"inline",alignItems:"center",gap:2,marginInlineStart:2},title:{display:"inline"},recordIcon:{display:"inline-block",marginInlineEnd:2,verticalAlign:"text-bottom"}})),[]),u=t instanceof Ri().h?(0,ee.jsx)(Li().Q,{inline:!0,underline:!0,onClick:()=>{zi().F2({environment:n,teamId:t.id,tab:Fi().p.Members,from:"permission_item"}),Wi().ks(n,{store:t,option:"view",from:"share_menu"})},children:(0,ee.jsx)(Vi().A,{shouldWrap:!0,maxLength:30,store:t,style:c.title})}):(0,ee.jsxs)("div",{style:c.recordContainer,children:[a?(0,ee.jsx)(Ki().B6,{disabled:!0,icon:a,iconRecordCategory:"database"===l?"collectionViewBlock":"pageBlock",size:14,isEmptyPage:!1,style:c.recordIcon}):void 0,(0,ee.jsx)(Li().Q,{inline:!0,href:o,style:c.recordContainer,children:(0,ee.jsx)(Vi().A,{shouldWrap:!1,maxLength:30,store:t,style:c.title,underline:!0})})]});switch(s){case"elevated":return r?"database"===l?(0,ee.jsx)(C().sA,{id:"pageShareMenu.restoreTeamspacePermissionsBannerDatabase.label",defaultMessage:"Share settings on this database differ from the {teamspaceTitle} teamspace default",values:{teamspaceTitle:u}}):(0,ee.jsx)(C().sA,{id:"pageShareMenu.restoreTeamspacePermissionsBanner.label",defaultMessage:"Share settings on this page differ from the {teamspaceTitle} teamspace default",values:{teamspaceTitle:u}}):"database"===l?(0,ee.jsx)(C().sA,{id:"pageShareMenu.restoreParentPagePermissionsBannerDatabase.label",defaultMessage:"Share settings on this database differ from the parent page {parentPageTitle}",values:{parentPageTitle:u}}):(0,ee.jsx)(C().sA,{id:"pageShareMenu.restoreParentPagePermissionsBanner.label",defaultMessage:"Share settings on this page differ from the parent page {parentPageTitle}",values:{parentPageTitle:u}});case"restricted":return r?"database"===l?(0,ee.jsx)(C().sA,{id:"pageShareMenu.restrictedAccessFromTeamspaceBannerDatabase.label",defaultMessage:"Share settings on this database are unlinked from the {teamspaceTitle} teamspace default",values:{teamspaceTitle:u}}):(0,ee.jsx)(C().sA,{id:"pageShareMenu.restrictedAccessFromTeamspaceBanner.label",defaultMessage:"Share settings on this page are unlinked from the {teamspaceTitle} teamspace default",values:{teamspaceTitle:u}}):"database"===l?(0,ee.jsx)(C().sA,{id:"pageShareMenu.restrictedAccessFromParentPageBannerDatabase.label",defaultMessage:"Share settings on this database are unlinked from the parent page {parentPageTitle}",values:{parentPageTitle:u}}):(0,ee.jsx)(C().sA,{id:"pageShareMenu.restrictedAccessFromParentPageBanner.label",defaultMessage:"Share settings on this page are unlinked from the parent page {parentPageTitle}",values:{parentPageTitle:u}});default:(0,Te().HB)(s)}}function ds(e){const{type:i,store:s,sudoModeStore:t}=e,n=(0,d().v3)(),o=(0,C().tz)(),r=(0,m().K8)((()=>!!t&&t.shouldSaveTransactionWithSudoMode(s)),[s,t]),a=(0,m().K8)((()=>(0,Oi().f)(s,{includeTeamHomeFeed:!1,includeDataSources:!1})[1]),[s]),l=a.table===os().yK,u=(0,m().K8)((()=>{if(a instanceof Bi().B)return(0,Gi().Ay)({store:a,fullyQualified:!1,pageVisitSource:$().y8.ShareMenu})}),[a]),g=(0,p().IS)((()=>({icon:{fill:T().Tj.icon.secondary,height:16,width:16},mobileRestoreButton:{fontSize:rs().vQ,fontWeight:Ne().Wy.medium,flexShrink:0,borderRadius:4,paddingInlineStart:4,paddingInlineEnd:4,color:T().Tj.blue.text.accentPrimary}})),[]),h=[l?{key:"showTeamSettings",render:e=>(0,ee.jsx)(Me().A,{...e,icon:(0,ee.jsx)(ce().I,{icon:ns().M}),title:(0,ee.jsx)(C().sA,{id:"pageShareMenu.restoreParentPagePermissionsBanner.viewDefaults.label",defaultMessage:"View defaults"})}),action:()=>{a.table===os().yK&&(zi().F2({environment:n,teamId:a.id,tab:Fi().p.Members,from:"permission_item"}),Wi().ks(n,{store:a,option:"view",from:"share_menu"}))}}:u?{key:"showParentPageSettings",render:e=>(0,ee.jsx)(Me().A,{...e,icon:(0,ee.jsx)(ce().I,{icon:ns().M}),title:(0,ee.jsx)(C().sA,{id:"pageShareMenu.restoreParentPagePermissionsBanner.viewDefaults.label",defaultMessage:"View defaults"}),href:u}),action:()=>{}}:void 0,{key:"restore",action:async()=>{if("elevated"===i)await as({environment:n,useSudoMode:r,store:s});else if("restricted"===i){if(!s.isDefined())return;if(s.table===k().C0)return;const e=s.getPermissionItems(),i=(0,Oi().f)(s,{includeTeamHomeFeed:!1,includeDataSources:!1})[1];if(!i)return;const t=(0,Ei().wD)((0,Di().E)(i)),o=(0,Ei().Cd)(s.getModel(),e,t);await Xi({environment:n,useSudoMode:r,store:s,permissionChanges:o,from:"unlinked_banner",shareMenuSessionId:F().Ay.state.sessionId,parentStore:i})}else(0,Te().HB)(i)},render:e=>(0,ee.jsx)(Me().A,{...e,title:(0,ee.jsx)(C().sA,{id:"pageShareMenu.restoreParentPagePermissionsBanner.restoreSettings.label",defaultMessage:"Restore settings"}),icon:(0,ee.jsx)(ce().I,{icon:ss().N})})}].filter(Te().O9),b=[{key:"all",render:e=>(0,ee.jsx)(S().A,{...e}),items:h}];return c().A.isMobile?(0,ee.jsx)(le().Ay,{style:g.mobileRestoreButton,onClick:async()=>{if("elevated"===i)await as({environment:n,useSudoMode:r,store:s});else if("restricted"===i){if(!s.isDefined())return;if(s.table===k().C0)return;const e=s.getPermissionItems(),i=(0,Oi().f)(s,{includeTeamHomeFeed:!1,includeDataSources:!1})[1];if(!i)return;const t=(0,Ei().wD)((0,Di().E)(i)),o=(0,Ei().Cd)(s.getModel(),e,t);await Xi({environment:n,useSudoMode:r,store:s,permissionChanges:o,from:"unlinked_banner",shareMenuSessionId:F().Ay.state.sessionId,parentStore:i})}else(0,Te().HB)(i)},children:(0,ee.jsx)(C().sA,{defaultMessage:"Restore",id:"pageShareMenu.restoreParentPagePermissionsBanner.restore.mobile.label"})}):(0,ee.jsx)(Pe().A,{render:()=>(0,ee.jsx)(ke().A,{menuType:we().gu.Popup,children:(0,ee.jsx)(Ce().A,{type:Ce().O.Vertical,sections:b,initialFocus:void 0})}),renderOrigin:e=>(0,ee.jsx)(es().A,{icon:ts().ellipsisSmallIcon,iconStyle:g.icon,ariaLabel:o.formatMessage({id:"pageShareMenu.restorePagePermissionsBanner.restoreOptionsButton.label",defaultMessage:"See restore permissions options"}),...e}),popupType:Pe().z.Popup,placementToOrigin:"bottom",alignmentToOrigin:"end"})}function ms(e){const{store:i}=e,s=(0,wi().S)(),t=(0,d().v3)(),n=(0,m().K8)((()=>function(e){const{store:i,environment:s,pageContext:t}=e,n=(0,Ni().or)([Mi().K,(0,ki().U)([Ci()._,(0,Ti().A)(Mi().K)])]);if(i.table!==_().ev)return!1;return n({environment:s,blocks:[i],publicEditMode:void 0,pageContext:t})}({store:i,environment:t,pageContext:s})),[i,t,s]);return(0,ee.jsx)(ls,{type:"restricted",showRestoreButton:n,store:i,sudoModeStore:e.sudoModeStore})}function ps(e){const{store:i}=e;return(0,m().K8)((()=>(0,U().le)({store:i})),[i])?(0,ee.jsx)(ls,{type:"elevated",showRestoreButton:!1,store:i,sudoModeStore:e.sudoModeStore}):null}const us=function(e){const{store:i,showRestrictedPermissionBanner:s,showPermissionInheritanceBanner:t}=e;return(0,m().K8)((()=>(0,U().iG)({store:i}).canAccessParent),[i])?t?(0,ee.jsx)(Ji,{store:i,sudoModeStore:e.sudoModeStore}):s?(0,ee.jsx)(ms,{store:i,sudoModeStore:e.sudoModeStore}):(0,ee.jsx)(ps,{store:i,sudoModeStore:e.sudoModeStore}):null};var gs=()=>s(74351),hs=()=>s(173783),bs=()=>s(957606);function vs(e){const{teamName:i,isCompact:s}=e;return s?(0,ee.jsx)(C().sA,{defaultMessage:"Teamspace guests",id:"blockPermissionsSettings.permissionItem.teamGuestAccess.compact"}):i?(0,ee.jsx)(C().sA,{defaultMessage:"Teamspace guests of {teamName}",id:"blockPermissionsSettings.permissionItem.teamGuestAccess",values:{teamName:i}}):(0,ee.jsx)(C().sA,{id:"blockPermissionsSettings.permissionItem.teamspaceGuestsTeamName.hidden",defaultMessage:"Teamspace guests of a private teamspace"})}function fs({teamGuestsCount:e,isCompact:i}){return 0===e?null:(0,ee.jsx)(C().sA,{defaultMessage:"{membersCount, plural, one {{membersCount} person} other {{membersCount} people}}",id:"blockPermissionsSettings.teamGuestPermission.subtitle",values:{membersCount:e}})}function ys(e){const{teamName:i}=e,s=(0,p().IS)((()=>({tooltip:{whiteSpace:"normal",maxWidth:240}})),[]);return i?(0,ee.jsx)("div",{style:s.tooltip,children:(0,ee.jsx)(C().sA,{defaultMessage:"Applies to all teamspace guests of {teamName}.",values:{teamName:i},id:"blockPermissionsSettings.teamGuestPermission.tooltip"})}):null}const Is=function({store:e,blockTeamGuestPermission:i,isExternalTeam:s,fromPermissionWrapper:t,teamGuestsCount:n,permissionItemArgs:o}){const{permissionItem:r}=i,a=(0,m().O$)(Ae().AppStoreSidebarSpaceStore),l=(0,m().K8)((()=>{var i;return j().un(r)?r.team_id:null===(i=(0,gs().U)(e))||void 0===i?void 0:i.id}),[r,e]),{teamStore:d,teamIsDefined:u,teamName:g}=(0,m().K8)((()=>{if(!a||!l)return{};const e=Ri().h.createChildStore(a,{table:os().yK,id:l,spaceId:a.id});return null!=e&&e.isDefined()?{teamStore:e,teamIsDefined:null==e?void 0:e.isDefined(),teamName:e.getName()}:{}}),[a,l]),h=(0,m().K8)((()=>{if(n)return n;if(void 0!==d){const e=(0,bs().PF)({teamStore:d});if(void 0!==e)return e.totalMembersAndGuestsCount-e.membersIncludingOwnersCount}}),[d,n]),b=!s,v=(0,p().IS)((()=>({container:{width:"100%"}})),[]);return d?(0,ee.jsx)("div",{style:v.container,className:he().rkF,children:(0,ee.jsx)(Z().Ay,{isCompact:b,store:e,permissionItem:r,icon:(0,ee.jsx)(hs().A,{size:c().A.isMobile?Z().Bj:Z().Ev}),title:(0,ee.jsx)(vs,{teamName:g,isCompact:b}),nonInheritedTooltip:(0,ee.jsx)(ys,{teamName:g}),from:i.from,subtitle:u&&(0,ee.jsx)(fs,{teamGuestsCount:h??0,isCompact:b}),upgradeButtonName:"team_permission_item",fromPermissionWrapper:t,...o})}):null};function Ss({teamName:e,isCompact:i}){return i?(0,ee.jsx)(C().sA,{defaultMessage:"Members",id:"blockPermissionsSettings.permissionItem.teamAccessV3"}):e?(0,ee.jsx)(C().sA,{defaultMessage:"Teamspace members",id:"blockPermissionsSettings.permissionItem.teamAccessV2"}):(0,ee.jsx)(C().sA,{id:"blockPermissionsSettings.permissionItem.membersTeamName.hidden",defaultMessage:"Members of a private teamspace"})}function xs({membersCount:e,permissionItem:i}){return 0===e?null:c().A.isMobile&&i?(0,ee.jsxs)("div",{children:[(0,ee.jsx)(C().sA,{defaultMessage:"{membersCount, plural, one {{membersCount} person} other {{membersCount} people}}",id:"blockPermissionsSettings.teamMembersPermission.subtitle",values:{membersCount:e}})," Â· ",(0,ee.jsx)(C().sA,{...(0,fe().R)({type:i.type,role:i.role,table:os().yK,isRemovable:!1}).label})]}):(0,ee.jsx)(C().sA,{defaultMessage:"{membersCount, plural, one {{membersCount} person} other {{membersCount} people}}",id:"blockPermissionsSettings.teamMembersPermission.subtitle",values:{membersCount:e}})}function Ps(e){const{teamName:i}=e,s=(0,p().IS)((()=>({tooltip:{whiteSpace:"normal",maxWidth:240}})),[]);return i?(0,ee.jsx)("div",{style:s.tooltip,children:(0,ee.jsx)(C().sA,{defaultMessage:"Applies to all owners and members of {teamName}.",values:{teamName:i},id:"blockPermissionsSettings.teamPermission.tooltip"})}):null}const js=function({store:e,blockTeamPermission:i,isExternalTeam:s,fromPermissionWrapper:t,teamMembersCount:n,permissionItemArgs:o}){const{permissionItem:r}=i,a=(0,m().O$)(Ae().AppStoreSidebarSpaceStore),l=(0,m().K8)((()=>{var i;return j().gl(r)?r.team_id:null===(i=(0,gs().U)(e))||void 0===i?void 0:i.id}),[r,e]),{teamStore:d,teamIsDefined:u,teamName:g}=(0,m().K8)((()=>{if(!a||!l)return{};const e=Ri().h.createChildStore(a,{table:os().yK,id:l,spaceId:a.id});return{teamStore:e,teamIsDefined:null==e?void 0:e.isDefined(),teamName:null==e?void 0:e.getName()}}),[a,l]),h=!s,b=(0,m().K8)((()=>{return n||(void 0!==d?null===(e=(0,bs().PF)({teamStore:d,spaceId:null==a?void 0:a.id}))||void 0===e?void 0:e.membersIncludingOwnersCount:void 0);var e}),[d,n,a]),v=(0,p().IS)((()=>({container:{width:"100%"}})),[]);return d?(0,ee.jsx)("div",{style:v.container,className:he().rkF,children:(0,ee.jsx)(Z().Ay,{isCompact:h,store:e,permissionItem:i.permissionItem,from:i.from,icon:(0,ee.jsx)(hs().A,{size:c().A.isMobile?Z().Bj:Z().Ev}),title:(0,ee.jsx)(Ss,{teamName:g,isCompact:h}),nonInheritedTooltip:(0,ee.jsx)(Ps,{teamName:(0,ee.jsx)(Yi().A,{store:d,useInvertedColors:!0})}),subtitle:u&&(0,ee.jsx)(xs,{membersCount:b??0,permissionItem:i.permissionItem}),upgradeButtonName:"team_permission_item",fromPermissionWrapper:t,...o})}):null};function _s({teamName:e,isCompact:i}){return i?(0,ee.jsx)(C().sA,{defaultMessage:"Owners",id:"blockPermissionsSettings.permissionItem.teamOwnerAccessV3"}):e?(0,ee.jsx)(C().sA,{defaultMessage:"Teamspace owners",id:"blockPermissionsSettings.permissionItem.teamOwnerAccessV2"}):(0,ee.jsx)(C().sA,{id:"blockPermissionsSettings.permissionItem.teamName.hidden",defaultMessage:"Owners of a private teamspace"})}function As({teamOwnersCount:e,isCompact:i,permissionItem:s}){return 0===e?null:c().A.isMobile&&s?(0,ee.jsxs)("div",{children:[(0,ee.jsx)(C().sA,{defaultMessage:"{teamOwnersCount, plural, one {{teamOwnersCount} person} other {{teamOwnersCount} people}}",id:"blockPermissionsSettings.teamOwnerPermission.subtitle",values:{teamOwnersCount:e}})," Â· ",(0,ee.jsx)(C().sA,{...(0,fe().R)({type:s.type,role:s.role,table:os().yK,isRemovable:!1}).label})]}):(0,ee.jsx)(C().sA,{defaultMessage:"{teamOwnersCount, plural, one {{teamOwnersCount} person} other {{teamOwnersCount} people}}",id:"blockPermissionsSettings.teamOwnerPermission.subtitle",values:{teamOwnersCount:e}})}function ws(e){const{teamName:i}=e,s=(0,p().IS)((()=>({tooltip:{whiteSpace:"normal",maxWidth:240}})),[]);return i?(0,ee.jsx)("div",{style:s.tooltip,children:(0,ee.jsx)(C().sA,{defaultMessage:"Applies to all owners of {teamName}",values:{teamName:i},id:"blockPermissionsSettings.teamOwnerPermission.tooltip"})}):null}const ks=function({store:e,blockTeamOwnerPermission:i,isExternalTeam:s,fromPermissionWrapper:t,teamOwnersCount:n,permissionItemArgs:o}){const{permissionItem:r}=i,a=(0,m().O$)(Ae().AppStoreSidebarSpaceStore),l=(0,m().K8)((()=>{var i;return j().nl(r)?r.team_id:null===(i=(0,gs().U)(e))||void 0===i?void 0:i.id}),[r,e]),{teamStore:d,teamName:u}=(0,m().K8)((()=>{if(!a||!l)return{undefined:void 0};const e=Ri().h.createChildStore(a,{table:os().yK,id:l,spaceId:a.id});return{teamStore:e,teamName:e.getName()}}),[a,l]),g=!s,h=(0,m().K8)((()=>{return n||(void 0!==d?null===(e=(0,bs().PF)({teamStore:d}))||void 0===e?void 0:e.ownersCount:void 0);var e}),[d,n]),b=(0,p().IS)((()=>({container:{width:"100%"}})),[]);return d?(0,ee.jsx)("div",{style:b.container,className:he().D3T,children:(0,ee.jsx)(Z().Ay,{isCompact:g,store:e,permissionItem:i.permissionItem,from:i.from,icon:(0,ee.jsx)(hs().A,{size:c().A.isMobile?Z().Bj:Z().Ev}),title:(0,ee.jsx)(_s,{teamName:u,isCompact:g}),nonInheritedTooltip:(0,ee.jsx)(ws,{teamName:(0,ee.jsx)(Yi().A,{store:d,useInvertedColors:!0})}),subtitle:(0,ee.jsx)(As,{teamOwnersCount:h??0,isCompact:g,permissionItem:i.permissionItem}),upgradeButtonName:"team_owner_permission_item",fromPermissionWrapper:t,...o})}):null};var Ms=()=>s(874832),Cs=()=>s(515187),Ts=()=>s(180925);function Ns({teamName:e}){return e?(0,ee.jsx)(C().sA,{defaultMessage:"People in {teamName}",id:"blockPermissionsSettings.permissionItem.teamspaceAccessV2",values:{teamName:e}}):(0,ee.jsx)(C().sA,{defaultMessage:"People in a private teamspace",id:"blockPermissionsSettings.permissionItem.teamspace.hiddenV2"})}function Bs({membersCount:e,teamPermissionItem:i}){const s=(0,p().IS)((()=>({container:{display:"flex",alignItems:"center",gap:2}})),[]),t=e?(0,ee.jsx)("div",{children:(0,ee.jsx)(C().sA,{defaultMessage:"{membersCount, plural, one {{membersCount} person} other {{membersCount} people}}",id:"blockPermissionsSettings.teamPermission.memberCount.subtitle",values:{membersCount:e}})}):(0,ee.jsxs)("div",{style:s.container,children:[(0,ee.jsx)(Ms().P,{style:{height:12,width:14,borderRadius:4,marginInlineEnd:2,marginInlineStart:2}}),(0,ee.jsx)(C().sA,{defaultMessage:"people",id:"blockPermissionsSettings.teamPermission.subtitle.people",values:{membersCount:e}})]});return c().A.isMobile?(0,ee.jsxs)("div",{style:s.container,children:[t,i?(0,ee.jsxs)(ee.Fragment,{children:[" Â· ",(0,ee.jsx)(C().sA,{...(0,fe().R)({type:i.type,role:i.role,table:"block",isRemovable:!1}).label})]}):void 0]}):(0,ee.jsxs)("div",{style:s.container,children:[(0,ee.jsx)(C().sA,{defaultMessage:"Teamspace",id:"blockPermissionsSettings.teamPermission.subtitle.teamspace"})," Â· ",t]})}const Rs=function({store:e,blockTeamMemberPermission:i,blockTeamOwnerPermission:t,blockTeamGuestPermission:n,permissionItemArgs:r}){const a=(0,d().v3)(),[l,u]=(0,o.useState)(!1),[g,h]=(0,o.useState)(!1),{permissionItem:b}=i,v=(0,m().O$)(Ae().AppStoreSidebarSpaceStore),f=(0,m().K8)((()=>{var i;return j().gl(b)?b.team_id:null===(i=(0,gs().U)(e))||void 0===i?void 0:i.id}),[b,e]),y=t.permissionItem.role,I=b.role,S={type:"display_only_overview_permission",role:y===I?I:"none"===I||"none"===y?"limited":"access"},{teamStore:x,teamIsDefined:P,teamName:A}=(0,m().K8)((()=>{if(!v||!f)return{undefined:void 0};const e=Ri().h.createChildStore(v,{table:os().yK,id:f,spaceId:v.id});return{teamStore:e,teamIsDefined:null==e?void 0:e.isDefined(),teamName:null==e?void 0:e.getName()}}),[v,f]),w=(0,m().K8)((()=>{if(void 0!==x)return(0,bs().PF)({teamStore:x,spaceId:null==v?void 0:v.id})}),[x,v]),{membersCount:k,totalMembersAndGuestsCount:M,ownersCount:N,teamGuestsCount:R}=void 0!==w?{membersCount:w.membersIncludingOwnersCount,totalMembersAndGuestsCount:w.totalMembersAndGuestsCount,ownersCount:w.ownersCount,teamGuestsCount:w.totalMembersAndGuestsCount-w.membersIncludingOwnersCount}:{membersCount:0,totalMembersAndGuestsCount:void 0,ownersCount:0,teamGuestsCount:0},O=(0,m().K8)((()=>{if(!v)return!1;return!v.getDisableTeamGuests()&&((null==x||!x.isDefault())&&(0,D().Qd)())}),[v,x]),L=(0,o.useCallback)((()=>u(!0)),[]),E=(0,o.useCallback)((()=>u(!1)),[]),W=(0,o.useCallback)((()=>{const e=!1===g;if(h(!g),e){if(!x)return;B().lD(a,{share_menu_session_id:F().Ay.state.sessionId,type:"team",team_id:x.id})}}),[a,g,h,x]),K=(0,p().IS)((()=>({teamPermissionsContainer:{paddingInlineStart:16,display:g?"block":"none"},roleButton:{color:T().Tj.text.secondary,fontSize:(0,G().kx)()},mobileTitleContainer:{display:"flex",alignItems:"center"},mobileTextContainer:{overflow:"hidden"},mobileChevronIcon:{marginInlineStart:4,fill:T().Tj.icon.secondary,transform:`rotate(${g?90:0}deg)`,transition:"transform 150ms ease"}})),[g]);if(!x)return null;const V=P?(0,ee.jsx)(li,{store:x}):(0,ee.jsx)(ce().I,{icon:s(566910).e}),U=(0,ee.jsx)(Ts().A,{expanded:g,hovered:l,onClick:W,children:V});return(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsx)(Z().Ay,{store:e,permissionItem:S,from:i.from,onMouseEnter:L,onMouseLeave:E,icon:U,title:c().A.isMobile?(0,ee.jsxs)("div",{style:K.mobileTitleContainer,children:[(0,ee.jsx)("div",{style:K.mobileTextContainer,children:(0,ee.jsx)(Ns,{teamName:A})}),(0,ee.jsx)("div",{style:K.mobileChevronIcon,children:(0,ee.jsx)(ce().I,{icon:_e().arrowChevronSingleRightSmallIcon,size:"sm"})})]}):(0,ee.jsx)(Ns,{teamName:A}),subtitle:P&&(0,ee.jsx)(Bs,{membersCount:M,teamPermissionItem:S}),nonInheritedTooltip:(0,ee.jsx)(C().sA,{id:"TeamPermissionItem.access",defaultMessage:"People in the {inlineIconAndName} teamspace",values:{inlineIconAndName:(0,ee.jsx)(Yi().A,{store:x,useInvertedColors:!0})}}),upgradeButtonName:"team_permission_item",onClick:W,permissionRoleSelect:!g&&(0,ee.jsx)(fe().Y,{type:S.type,role:S.role,icon:Cs().w,disabled:!0,buttonStyle:K.roleButton,table:_().ev,isCurrentUser:!1,from:"shareMenu"}),isCollapsible:!0,...r}),(0,ee.jsxs)("div",{style:K.teamPermissionsContainer,children:[t?(0,ee.jsx)(ks,{store:e,permissionItemArgs:r,blockTeamOwnerPermission:t,teamOwnersCount:N,fromPermissionWrapper:"expandable_permission"}):void 0,i?(0,ee.jsx)(js,{store:e,permissionItemArgs:r,blockTeamPermission:i,teamMembersCount:k,fromPermissionWrapper:"expandable_permission"}):void 0,O&&n?(0,ee.jsx)(Is,{store:e,permissionItemArgs:r,blockTeamGuestPermission:n,teamGuestsCount:R,fromPermissionWrapper:"expandable_permission"}):void 0]})]})};var Os=()=>s(64744);function Ds(e){const{store:i,isExpanded:s,numberOfPeopleInvited:t,inheritedPermissionRole:n,permissionItemArgs:r,onToggle:a}=e,l=(0,m().K8)((()=>(0,Oi().f)(i,{includeTeamHomeFeed:!1,includeDataSources:!1})[1]),[i]),[d,u]=o.useState(!1),g=(0,m().K8)((()=>{const e=(0,Oi().f)(i,{includeTeamHomeFeed:!1,includeDataSources:!1})[1];if(e instanceof Ri().h)return{icon:(0,ee.jsx)(Ke().x,{disabled:!0,store:e,size:c().A.isMobile?Z().Bj:Z().Ev}),title:e.getName()};if(e instanceof Bi().B){if("page"===e.getType()){const i=e.isEmptyPage();return{icon:(0,ee.jsx)(Ki().B6,{disabled:!0,icon:e.getIcon(),size:20,isEmptyPage:i,iconRecordCategory:(0,Ki().Te)(e)}),title:(0,ee.jsx)(Vi().A,{shouldWrap:!0,store:e}),fromTable:_().ev,fromId:e.id}}if("collection_view"===e.getType()||"collection_view_page"===e.getType())return{icon:(0,ee.jsx)(Ki().B6,{disabled:!0,icon:e.getIcon(),size:20,isEmptyPage:e.isDefined(),iconRecordCategory:(0,Ki().Te)(e)}),title:(0,ee.jsx)(Vi().A,{shouldWrap:!0,store:e}),fromTable:_().ev,fromId:e.id}}}),[i]),h=(0,o.useCallback)((()=>u(!0)),[]),b=(0,o.useCallback)((()=>u(!1)),[]),v=(0,p().IS)((()=>({mobileTitleContainer:{display:"flex",alignItems:"center"},mobileTextContainer:{overflow:"hidden"},mobileChevronIcon:{marginInlineStart:4,fill:T().Tj.icon.secondary,transform:`rotate(${s?90:0}deg)`,transition:"transform 150ms ease"},roleButton:{color:T().Tj.text.secondary,fontSize:(0,G().kx)()},selectContainer:{opacity:s?0:1},loadingSubtitleContainer:{display:"flex",alignItems:"center"},placeholderSubtitle:{height:12,width:14,borderRadius:4,marginInlineEnd:2}})),[s]),f={type:"display_only_inherited_permission",role:n??"access"};return g?(0,ee.jsx)(Z().Ay,{icon:g.icon&&(0,ee.jsx)(Ts().A,{onClick:a,expanded:s,hovered:d,children:(0,ee.jsx)(qe().A,{type:"circle",iconType:"element",element:g.icon})}),store:i,permissionItem:f,onMouseEnter:h,onMouseLeave:b,from:{table:_().ev,blockId:g.fromId?g.fromId:i.id},title:c().A.isMobile?(0,ee.jsxs)("div",{style:v.mobileTitleContainer,children:[(0,ee.jsx)("div",{style:v.mobileTextContainer,children:(0,ee.jsx)(C().sA,{id:"permissionsListV2.inheritedPermissions",defaultMessage:"People invited to {title}",values:{title:g.title}})}),(0,ee.jsx)("div",{style:v.mobileChevronIcon,children:(0,ee.jsx)(ce().I,{icon:_e().arrowChevronSingleRightSmallIcon,size:"sm"})})]}):(0,ee.jsx)(C().sA,{id:"permissionsListV2.inheritedPermissions",defaultMessage:"People invited to {title}",values:{title:g.title}}),subtitle:t?(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsx)(C().sA,{id:"inheritedPermissionItem.numberOfPeopleInvited",defaultMessage:"{numberOfPeopleInvited, plural, one {{numberOfPeopleInvited} person} other {{numberOfPeopleInvited} people}}",values:{numberOfPeopleInvited:t}}),c().A.isMobile?(0,ee.jsxs)(ee.Fragment,{children:[" Â· ",(0,ee.jsx)(C().sA,{...(0,fe().R)({type:f.type,role:f.role,table:"block",isRemovable:!1}).label})]}):void 0]}):(0,ee.jsxs)("div",{style:v.loadingSubtitleContainer,children:[(0,ee.jsx)(Ms().P,{style:v.placeholderSubtitle}),(0,ee.jsx)(C().sA,{id:"inheritedPermissionItem.subtitle.people",defaultMessage:"people",values:{numberOfPeopleInvited:t}}),c().A.isMobile?(0,ee.jsxs)(ee.Fragment,{children:[" Â· ",(0,ee.jsx)(C().sA,{...(0,fe().R)({type:f.type,role:f.role,table:"block",isRemovable:!1}).label})]}):void 0]}),inheritedTooltip:t&&t>0?(0,ee.jsx)(C().sA,{id:"inheritedPermissionItem.numberOfPeopleInvited.tooltip",defaultMessage:"{numberOfPeopleInvited, plural, one {{numberOfPeopleInvited} person has } other {{numberOfPeopleInvited} people have}} access through the parent page {inlineIconAndName}",values:{numberOfPeopleInvited:t,inlineIconAndName:(0,ee.jsx)(Yi().A,{store:l,useInvertedColors:!0})}}):null,upgradeButtonName:"team_permission_item",onClick:a,permissionRoleSelect:(0,ee.jsx)("div",{style:v.selectContainer,children:(0,ee.jsx)(fe().Y,{type:f.type,role:f.role,icon:Cs().w,disabled:!0,buttonStyle:v.roleButton,table:_().ev,isCurrentUser:!1,from:"shareMenu"})}),isCollapsible:!0,style:e.style,...r}):null}const Ls=o.memo(Ds);var Es=()=>s(801191),Ws=()=>s(852507);const Ks=(0,C().YK)({commenter:{id:"permissionsLevelBanner.commenter.labelV2",defaultMessage:"You can only comment on this page"},reader:{id:"permissionsLevelBanner.reader.labelV2",defaultMessage:"You can only view this page"}});function Vs({store:e}){const i=(0,d().v3)(),s=(0,m().K8)((()=>e.getRole()),[e]),[t,n]=(0,o.useState)("noRequest"),r=(0,l().X)("share_menu_inheritance_banner");(0,Ws().w)((()=>{B().VJ(i,{share_menu_session_id:F().Ay.state.sessionId,role:s})}));const a=(0,p().IS)((()=>({container:{...(0,G().kJ)(),display:"flex",alignItems:"center",justifyContent:"space-between"},bannerBodyContainer:{display:"flex",alignItems:"center"},bannerLabel:{display:"flex"},pendingAccessRequestLabel:{color:T().Tj.text.tertiary},accessRequestLabel:{color:T().Tj.blue.text.accentPrimary},accessRequestButton:{display:"flex",alignItems:"center",justifyContent:"center",fontWeight:Ne().Wy.medium,flexShrink:0,borderRadius:4,paddingInlineStart:6,paddingInlineEnd:6,margin:-4,height:24}})),[]),c=(0,o.useCallback)((async()=>{var t;if("reader"!==s&&"comment_only"!==s)return;const o=await R().callApi({eventName:"requestAccess",environment:i,data:{type:"current-actor-to-block",block:{id:e.id,spaceId:e.getSpaceId()},attributes:{origin_type:"share_menu",add_permissions_on_approval:!1,role:"read_and_write",existing_permissions:s},message:void 0}});"success"===o.type&&o.data.request?(n("requested"),B().T_(i,{request_access_type:"page",previous_access_level:s,requested_access_level:"read_and_write",requestId:o.data.requestId})):"failed"===o.type&&"UserRateLimitResponse"===(null===(t=o.body)||void 0===t?void 0:t.name)&&n("rateLimited")}),[i,s,e]),u=s?function(e){switch(e){case"comment_only":return Ks.commenter;case"reader":return Ks.reader;case"editor":case"read_and_write":case"none":case"membership_admin":case"content_only_editor":return null;default:(0,Te().HB)(e)}}(s):void 0;return u?(0,ee.jsxs)("div",{style:a.container,children:[(0,ee.jsx)("div",{style:a.bannerBodyContainer,children:(0,ee.jsx)(q().A,{style:a.bannerLabel,isMultiline:!0,isSmall:r,children:(0,ee.jsx)(C().sA,{...u})})}),(0,ee.jsx)(je().p,{colorPalette:"blue",style:a.accessRequestButton,onClick:c,disabled:"noRequest"!==t,children:(0,ee.jsx)(q().A,{isSmall:r,style:"noRequest"===t?a.accessRequestLabel:a.pendingAccessRequestLabel,children:"requested"===t?(0,ee.jsx)(C().sA,{defaultMessage:"Requested edit access",id:"permissionsLevelBanner.requestPermission.accessRequestedV2"}):"rateLimited"===t?(0,ee.jsx)(C().sA,{defaultMessage:"Try again later",id:"permissionsLevelBanner.requestPermission.rateLimited"}):(0,ee.jsx)(C().sA,{defaultMessage:"Request edit access",id:"permissionsLevelBanner.requestPermission.requestEdit"})})})]}):null}const Us=20;function Gs({dividerType:e,scrollerStore:i}){const s=(0,m().K8)((()=>(null==i?void 0:i.state.elementRef)??{current:null}),[i]),t=(0,W().CR)(s),n=(0,W().yE)(s),r=(0,W().o7)(s),a=(0,o.useMemo)((()=>{if("top"===e)return n>0;return Math.ceil(n+r+10)<Math.floor(t)}),[e,r,t,n]),l=(0,p().IS)((()=>({divider:{opacity:a?1:0,height:1,borderTop:`1px solid ${T().Tj.border.secondaryTranslucent}`,padding:"0px 16px",transition:"opacity 200ms",margin:"0px 16px"}})),[a]);return(0,ee.jsx)("div",{style:l.divider})}function Fs({store:e,calculatedPermissions:i,permissionItemArgs:s}){const{showTeamPermission:t,mostPermissiveAncestorTeamGuestItem:n,mostPermissiveAncestorTeamMemberItem:o,mostPermissiveAncestorTeamOwnerItem:r,pagePermissionUIModel:a}=i;return(0,ee.jsxs)(ee.Fragment,{children:[t&&r&&o?(0,ee.jsx)(Rs,{store:e,blockTeamOwnerPermission:r,blockTeamMemberPermission:o,blockTeamGuestPermission:n,permissionItemArgs:s}):void 0,Ys({store:e,mostPermissiveTeamPermissions:a.mostPermissiveTeamPermissions,permissionItemArgs:s})]})}function zs(e){const{store:i,permissionItemArgs:s,inheritedPagePermissions:t,hasInaccessiblePermissions:n}=e,l=(0,d().v3)(),[c,m]=o.useState(!1),{mostPermissiveGroupPermissions:u,mostPermissiveUserPermissions:g,mostPermissiveAgentPermissions:h}=t,b=function(e){var i,s;const{mostPermissiveGroupPermissions:t,mostPermissiveUserPermissions:n}=e;let o="access";const r=(null===(i=n[0])||void 0===i?void 0:i.permissionItem.role)||(null===(s=t[0])||void 0===s?void 0:s.permissionItem.role)||"access",a=!(n.length>0)||n.every((e=>e.permissionItem.role===r)),l=!(t.length>0)||t.every((e=>e.permissionItem.role===r));a&&l&&(o=r);return o}(t),[{value:v}]=(0,x().Yb)((async()=>{const e=(0,a().f)(i);return e?await async function({environment:e,mostPermissiveUserPermissions:i,mostPermissiveGroupPermissions:s,mostPermissiveAgentPermissions:t,spaceStore:n}){const o=new Set;for(const{permissionItem:r}of i)o.add(r.user_id);for(const{permissionItem:r}of t)o.add(r.bot_id);const a=new Set;for(const{permissionItem:r}of s)a.add(r.group_id);if(a.size>0){const i=await R().callApi({eventName:"getSpacePermissionGroupMembers",environment:e,data:{groupIds:Array.from(a),spaceId:n.id}});if("success"===i.type)for(const[,{userIds:e}]of Object.entries(i.data.groupUsersMap)){const i=e.filter((e=>{var i;return null===(i=(0,r().sE)(n,e))||void 0===i?void 0:i.isMember()}));for(const e of i)o.add(e)}}return o.size}({environment:l,mostPermissiveUserPermissions:g,mostPermissiveGroupPermissions:u,mostPermissiveAgentPermissions:h,spaceStore:e}):0}),[l,i,u,g,h]),f=$s(t),y=(0,p().IS)((()=>({inheritedPagePermissionsContainer:f?{paddingInlineStart:G().zr}:{}})),[f]);return(0,ee.jsxs)(ee.Fragment,{children:[f?(0,ee.jsx)(Ls,{store:i,isExpanded:c,onToggle:()=>{m((e=>!e)),B().lD(l,{share_menu_session_id:F().Ay.state.sessionId,type:"inherited_page"})},numberOfPeopleInvited:v??0,inheritedPermissionRole:b,permissionItemArgs:s,style:e.style}):void 0,c?(0,ee.jsx)("div",{style:y.inheritedPagePermissionsContainer,children:(0,ee.jsx)(qs,{store:i,pagePermissions:t,numberPermissionsAlreadyRendered:0,permissionItemArgs:s,forceExpanded:!0,hasInaccessiblePermissions:n,isInherited:!0})}):void 0]})}function Hs({store:e,calculatedPermissions:i,permissionItemArgs:s}){const{showSpaceOwnerPermission:o,mostPermissiveSpaceOwnerItem:r,showSpacePermission:a,mostPermissiveTrustedDomainItem:l,mostPermissiveSpaceItem:c,mostPermissivePublicItem:d,showPublicShareLinkPermission:m,showRestrictedPermissionBanner:u}=i,g=(0,p().IS)((()=>({agentWarningContainer:{overflow:"hidden"}})),[]),h=(0,V().QX)(c),b=e.table===k().C0&&a&&"private"!==h;return(0,ee.jsxs)(S().A,{disableMobilePadding:!0,disableMobileBorders:!0,style:{paddingTop:12,paddingInlineStart:8,paddingInlineEnd:8,paddingBottom:8},children:[(0,ee.jsx)(Ai().nc,{}),(0,ee.jsx)(Si,{store:e,spaceOwnerPermission:r,showSpaceOwnerPermission:o,spacePermission:c,showSpacePermission:a,publicPermission:d,showPublicShareLinkPermission:m,trustedDomainPermission:l,permissionItemArgs:s,fromPermissionWrapper:"permission_list",isRestricted:u}),(0,ee.jsx)(t().N,{children:b?(0,ee.jsx)(n().P.div,{style:g.agentWarningContainer,initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2,ease:"easeInOut"},children:(0,ee.jsx)(f().Y1,{padding:"8px 0",children:(0,ee.jsx)(y().l,{display:"inline",tint:"blue",staticIcon:P().infoCircleIcon,label:(0,ee.jsx)(I().D,{styleKey:"captionMedium",children:(0,ee.jsx)(C().sA,{id:"shareMenu.generalAccess.agentWorkspaceWarning.label",defaultMessage:"This agentâ€™s sources and tools are now accessible to everyone in the workspace, even if they wouldnâ€™t have access otherwise."})})})})}):null})]})}function qs(e){const{store:i,pagePermissions:s,numberPermissionsAlreadyRendered:t,permissionItemArgs:n,forceExpanded:o,isInherited:r,hasInaccessiblePermissions:c}=e,p=(0,C().tz)(),u=(0,m().K8)((()=>{const e=(0,a().f)(i);return null!=e&&e.isDefined()?e.id:""}),[i]),g=(0,d().v3)(),f=g.currentUser.id,{showUserPermissions:y,showAgentPermissions:I,mostPermissiveGroupPermissions:S,mostPermissiveAgentPermissions:P,mostPermissiveUserPermissions:j}=s,[{value:_}]=(0,x().Yb)((async()=>{const e=await R().callCellCompatibleApi({eventName:"getSpacePermissionGroupIdsContainingMembers",environment:g,data:{spaceId:u,userIds:j.map((e=>e.permissionItem.user_id))},cellNavigation:{cellId:void 0,spaceId:u}});return"success"===e.type?e.data.userToGroupMap:{}}),[g,u,j],{debugName:"userToPermissionGroupIds",debounce:300,throttle:1e3}),T=(0,m().K8)((()=>{const e=y?function(e){const{mostPermissiveUserPermissions:i,userToPermissionGroupIds:s,hasInaccessiblePermissions:t,currentUserId:n}=e,o={};return i.forEach((i=>{if(e.store.table===k().C0&&"none"===i.permissionItem.role)return;const r=(0,L().ex)({userId:i.permissionItem.user_id,store:e.store,userPermissionGroupIds:new Set((null==s?void 0:s[i.permissionItem.user_id])??[])}),a=b().L.createChildStore(e.store,{table:w().oo,id:i.permissionItem.user_id}),l=a.getModel();let c;a.isReady()&&l&&(c=(0,M().c6)(e.intl,l));const d=n&&i.permissionItem.user_id===n;o[i.permissionItem.user_id]=(0,ee.jsx)(ae().A,{store:e.store,userPermission:i,userPermissionGroupIds:new Set((null==s?void 0:s[i.permissionItem.user_id])??[]),selectFooter:(0,ee.jsx)(Es().n,{targetName:c,targetType:"user",mostPermissivePermissions:r,hasInaccessiblePermissions:t,isCurrentUser:Boolean(d)}),tooltip:t&&"editor"!==i.permissionItem.role?(0,ee.jsx)(C().sA,{defaultMessage:"This user may have higher permission access through a parent page or teamspace that you donâ€™t have access to",id:"blockPermissionsSettings.maybeHigherUserPermission.tooltip"}):void 0,showInherited:!1,permissionItemArgs:e.permissionItemArgs,fromPermissionWrapper:"permission_list"},i.permissionItem.user_id)})),o}({store:i,mostPermissiveUserPermissions:j,permissionItemArgs:n,userToPermissionGroupIds:_??{},intl:p,hasInaccessiblePermissions:c,currentUserId:f}):{};return N().oE(Object.keys(e).map((s=>{const t=b().L.createChildStore(i,{table:w().oo,id:s}),n=t.getModel();if(t.isReady()&&n)return{title:(0,M().c6)(p,n),isSelfPermission:Boolean(f)&&t.id===f,permissionItem:e[s]}})))}),[y,i,j,n,p,f,_,c]),B=(0,m().K8)((()=>{const e=u?function(e){const{spaceId:i,mostPermissiveGroupPermissions:s,isInherited:t}=e,n={};return s.forEach((s=>{if(e.store.table===k().C0&&"none"===s.permissionItem.role)return;const o=s.permissionItem.group_id;K().h.getGroup(o)&&(n[o]=(0,ee.jsx)(re().A,{store:e.store,groupPermission:s,spaceId:i,showInherited:!1,permissionItemArgs:e.permissionItemArgs,fromPermissionWrapper:"permission_list",disableExpansion:t,tooltip:e.hasInaccessiblePermissions&&"editor"!==s.permissionItem.role?(0,ee.jsx)(C().sA,{defaultMessage:"Some users in this group may have higher permission access through a parent page or teamspace that you donâ€™t have access to",id:"blockPermissionsSettings.maybeHigherGroupPermission.tooltip"}):void 0}))})),n}({store:i,spaceId:u,mostPermissiveGroupPermissions:S,permissionItemArgs:n,hasInaccessiblePermissions:c,isInherited:r}):{};return Object.keys(e).map((i=>{const s=K().h.getGroup(i);return{title:s?(0,E().Pf)({intl:p,groupName:s.name}):"",isSelfPermission:!1,permissionItem:e[i]}}))}),[c,p,r,S,n,u,i]);T.sort(((e,i)=>e.isSelfPermission?-1:i.isSelfPermission?1:e.title.localeCompare(i.title)));const O=(0,l().X)("agents_in_block_share_menu"),W=(0,D().ke)(),V=(0,m().K8)((()=>{const e=I&&W&&O?function(e){const{store:i,mostPermissiveAgentPermissions:s,permissionItemArgs:t,spaceId:n}=e,o={};return s.forEach((e=>{if(i.table===k().C0)return;const s=e.permissionItem.bot_id,r=h().v.createChildStore(i,{table:A().GP,id:s,spaceId:n});if(!r.isReady()||!r.isWorkflowBot()||!r.getAlive())return;const a=r.getWorkflowId();if(!a)return;const l=v().N.createChildStore(i,{table:k().C0,id:a,spaceId:n});o[s]=(0,ee.jsx)(ie,{store:i,workflowName:r.getName(),workflowStore:l,spaceId:n,agentPermission:e,showInherited:!1,permissionItemArgs:t,fromPermissionWrapper:"permission_list"},s)})),o}({store:i,permissionItemArgs:n,hasInaccessiblePermissions:c,spaceId:u,mostPermissiveAgentPermissions:P}):{};return N().oE(Object.keys(e).map((s=>{const t=h().v.createChildStore(i,{table:A().GP,id:s,spaceId:u}).getWorkflowId();if(!t)return;const n=v().N.createChildStore(i,{table:k().C0,id:t,spaceId:u});return n.isReady()?{title:n.getNameWithDefault(p),isSelfPermission:!1,permissionItem:e[s]}:void 0})))}),[I,i,O,W,n,P,p,c,u]);V.sort(((e,i)=>e.title.localeCompare(i.title))),B.sort(((e,i)=>e.title.localeCompare(i.title)));const U=[...T,...B,...V].map((({permissionItem:e})=>e)),G=U.length;if(0===G)return null;const F=Math.max(4,7-t);return!o&&G>F?(0,ee.jsxs)(ee.Fragment,{children:[U.slice(0,2),(0,ee.jsx)(ue,{permissions:U.slice(2)})]}):(0,ee.jsx)(ee.Fragment,{children:U})}function Ys(e){const{store:i,mostPermissiveTeamPermissions:s,permissionItemArgs:t}=e;return s.map((e=>j().nl(e.permissionItem)?(0,ee.jsx)(ks,{store:i,blockTeamOwnerPermission:e,isExternalTeam:!0,permissionItemArgs:t,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.owner`):j().un(e.permissionItem)?(0,ee.jsx)(Is,{store:i,blockTeamGuestPermission:e,isExternalTeam:!0,permissionItemArgs:t,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.teamGuest`):(0,ee.jsx)(js,{store:i,blockTeamPermission:e,isExternalTeam:!0,permissionItemArgs:t,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.member`)))}function $s(e){return e.mostPermissiveUserPermissions.length>0||e.mostPermissiveGroupPermissions.length>0||e.mostPermissiveAgentPermissions.length>0}const Qs=function(e){const i=(0,d().v3)(),{store:t,permissionItemArgs:n,calculatedPermissions:r,showPermissionInheritanceBanner:a}=e,{sudoModeStore:l}=n,h=(0,m().uB)(void 0,g().A),b=(0,m().uB)(void 0,g().A),v=(0,Os().O)(t),{pagePermissionUIModel:f,showRestrictedPermissionBanner:y,showSpacePermission:I,showTeamPermission:x}=r,{inheritedPermissions:P,pagePermissions:j}=(0,U().kT)({store:t,pagePermissionUIModel:f,currentUserId:i.currentUser.id}),A=$s(j),w=$s(P),k=(0,m().K8)((()=>!(0,U().Aj)({store:t})),[t]),M=c().A.isMobile?u().A.None:u().A.Y,C=(0,p().IS)((()=>({scroller:{paddingInlineStart:c().A.isMobile?Us:0,paddingInlineEnd:c().A.isMobile?Us:0}})),[]);(0,o.useEffect)((()=>{B().Fn({environment:i,calculatedPermissions:r})}),[]);const T=Number(I),N=(0,m().K8)((()=>(0,s(311337).y)(i)),[i]),R=T+Number(x)+Number(w),D=e.showFooter??!c().A.isMobile,L=(0,m().K8)((()=>t.getSpaceId()),[t]),E=(0,s(789586).P)({name:"block_read_and_write_role",spaceId:L,userId:i.currentUser.id}),W=(0,m().K8)((()=>t.table===_().ev&&(E&&void 0!==t.getRole()&&t.canRead()&&!t.canEdit()&&(0,s(90023).jH)(t.getSystemBlockTypeStore().getValue()))),[E,t]);return(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsx)(Gs,{dividerType:"top",scrollerStore:h}),(0,ee.jsxs)(O().H,{type:M,style:C.scroller,store:h,children:[W&&t.table===_().ev?(0,ee.jsx)(Vs,{store:t}):(0,ee.jsx)(us,{store:t,showRestrictedPermissionBanner:y,showPermissionInheritanceBanner:a,sudoModeStore:l}),N?void 0:(0,ee.jsxs)(S().A,{disableMobilePadding:!0,disableMobileBorders:!0,style:{padding:"0px 8px"},children:[A?(0,ee.jsx)(qs,{store:t,pagePermissions:j,numberPermissionsAlreadyRendered:R,permissionItemArgs:n,forceExpanded:!(w||r.showTeamPermission),hasInaccessiblePermissions:k}):void 0,w?(0,ee.jsx)(zs,{store:t,inheritedPagePermissions:P,permissionItemArgs:n,hasInaccessiblePermissions:k}):void 0,t.table===_().ev?(0,ee.jsx)(Fs,{store:t,calculatedPermissions:r,permissionItemArgs:n}):void 0,k?(0,ee.jsx)(_i,{store:t}):void 0]})]}),(0,ee.jsx)(Gs,{dividerType:"bottom",scrollerStore:h}),T>0&&!c().A.isMobile?(0,ee.jsx)(Hs,{store:t,calculatedPermissions:r,permissionItemArgs:n}):void 0,t.table===_().ev&&v.shouldRender?(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsx)(Gs,{dividerType:"top",scrollerStore:b}),(0,ee.jsx)(O().H,{type:M,style:C.scroller,store:b,children:(0,ee.jsx)(Os().v,{blockStore:t,renderInfo:v.renderInfo,onCollectionChange:v.onCollectionChange})})]}):void 0,D?(0,ee.jsx)(s(117183).A,{store:t,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:r,permissionItemArgs:n,hasCollectionPropertyPermissionsSection:v.shouldRender}):void 0]})}},678634:(e,i,s)=>{s.d(i,{_:()=>h});var t=s(296540),n=()=>s(907258),o=()=>s(484714),r=()=>s(590526),a=()=>s(732810),l=()=>s(723085),c=()=>s(519831),d=()=>s(854150),m=()=>s(69708),p=()=>s(335260),u=()=>s(169626),g=s(474848);function h({permissionItem:e,from:i}){const s=(0,o().v3)(),{organizationOwnerRecordCache:h}=(0,t.useContext)(p().N),b=(0,r().O$)(n().AppStoreSidebarSpaceStore),v=(0,r().K8)((()=>null==b?void 0:b.getName()),[b]),f=(0,r().K8)((()=>{var i;if("group_permission"!==e.type)return;const s=e.group_id;return null===(i=u().h.getGroup(s))||void 0===i?void 0:i.name}),[e]),y=(0,r().K8)((()=>{if("explicit_team_permission"!==e.type&&"explicit_team_owner_permission"!==e.type)return;const i=e.team_id;return new(l().h)(s,{id:i,table:d().yK},{inMemoryRecordCache:h}).getName()}),[e,s,h]),I=(0,r().K8)((()=>{if("collection_property_permission"!==e.type||(null==i?void 0:i.table)!==c().Vl)return;const t=i.collectionId;return new(a().m)(s,{id:t,table:c().Vl}).getName()}),[s,i,e.type]);switch(e.type){case"space_permission":return b?(0,g.jsx)(m().sA,{id:"searchTargetPermissionItem.spacePermission",defaultMessage:"{name} workspace",values:{name:v}}):null;case"space_owner_permission":case"user_permission":case"bot_permission":case"exclusive_user_permission":case"public_permission":case"deleted_permission":case"restricted_permission":case"trusted_domain_permission":default:return null;case"explicit_team_permission":case"team_permission":return(0,g.jsx)(m().sA,{id:"searchTargetPermissionItem.teamPermission",defaultMessage:"{name} teamspace",values:{name:y}});case"team_owner_permission":case"explicit_team_owner_permission":return(0,g.jsx)(m().sA,{id:"searchTargetPermissionItem.teamOwnersPermission",defaultMessage:"{name} teamspace",values:{name:y}});case"explicit_team_guest_permission":return(0,g.jsx)(m().sA,{id:"searchTargetPermissionItem.teamGuestsPermission",defaultMessage:"Team guests"});case"group_permission":return f?(0,g.jsx)(m().sA,{id:"searchTargetPermissionItem.groupPermission",defaultMessage:"{groupName} group",values:{groupName:f}}):(0,g.jsx)(m().sA,{id:"searchTargetPermissionItem.groupPermissionWithoutName",defaultMessage:"Group"});case"collection_property_permission":return I?(0,g.jsx)(m().sA,{id:"searchTargetPermissionItem.collectionPropertyPermission",defaultMessage:"permission rule on the {collectionName} database",values:{collectionName:I}}):(0,g.jsx)(m().sA,{id:"searchTargetPermissionItem.collectionPropertyPermissionWithoutName",defaultMessage:"permission rule on a database"})}}},726360:(e,i,s)=>{s.d(i,{H:()=>o,U:()=>n});var t=s(296540);const n=(0,t.createContext)(new(s(1195).A));function o(){return(0,t.useContext)(n)}n.displayName="TrustedDomainsContext"},801191:(e,i,s)=>{s.d(i,{n:()=>h});s(898992),s(354520),s(296540);var t=()=>s(401497),n=()=>s(675133),o=()=>s(388926),r=()=>s(302501),a=()=>s(433847),l=()=>s(109100),c=()=>s(68263),d=()=>s(69708),m=()=>s(477293),p=()=>s(678634),u=s(474848);const g={none:n().A.formatMessage(l().S.noAccessDescription),reader:n().A.formatMessage(l().S.canReadDescription),comment_only:n().A.formatMessage(l().S.canCommentDescription),content_only_editor:n().A.formatMessage(l().S.canEditContentDescription),read_and_write:n().A.formatMessage(l().S.canEditDescription),membership_admin:n().A.formatMessage(l().S.membershipAdminDescription),editor:n().A.formatMessage(l().S.fullAccessDescription)};function h({targetType:e,targetName:i,mostPermissivePermissions:s,hasInaccessiblePermissions:h,isCurrentUser:b}){const v="on"===(0,m().r)("improved_sharing_ui_highest_access_level"),f=(0,t().IS)((()=>({label:{marginInlineStart:12,marginInlineEnd:12,paddingTop:8,paddingBottom:8}})),[]);let y=function({targetType:e,targetName:i,mostPermissivePermissions:s}){var t;const o=null==s||null===(t=s.filter((i=>"user"===e?(0,a().bn)(i)||(0,c().tb)(i.permissionItem):(0,a().bn)(i))))||void 0===t?void 0:t[0];if(!o)return null;const r=(0,c().PW)(o.permissionItem.role)?o.permissionItem:void 0,m=(0,c().PW)(o.permissionItem.role)?o.from:void 0;if(!r||!r.role||"string"!=typeof r.role||"none"===r.role)return null;const h=g[r.role]||n().A.formatMessage(l().S.defaultAccessLabel);return(0,u.jsx)(d().sA,{id:"permissionsItem.generalAccess",defaultMessage:"{userName} will still have {accessLevel} from the {permissionItemName}",values:{permissionItemName:(0,u.jsx)(p()._,{permissionItem:r,from:m}),userName:i,accessLevel:h}})}({targetType:e,targetName:i,mostPermissivePermissions:s});return y||!h||b||(y=(0,u.jsx)(d().sA,{id:"permissionsItem.unknownInheritedAccess",defaultMessage:"{userName} may have a different access level from a parent page, group, or teamspace",values:{userName:i}})),y&&!v?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(o().A,{size:1,colorVariant:"secondary"}),(0,u.jsx)(r().A,{style:f.label,isSmall:!0,isMultiline:!0,children:y})]}):null}},810727:(e,i,s)=>{s.d(i,{z:()=>h});s(296540);var t=()=>s(590526),n=()=>s(401497),o=()=>s(723085),r=()=>s(74351),a=()=>s(854150),l=()=>s(69708),c=()=>s(284371),d=()=>s(16006),m=()=>s(169626),p=()=>s(898808),u=()=>s(678634),g=s(474848);function h({permissionItem:e,targetType:i,targetName:s,store:h}){const b=(0,n().IS)((()=>({groupOrTeamName:{fontWeight:c().Wy.bold}})),[]),v=(0,t().K8)((()=>{var i;if("group_permission"!==e.type)return;const s=null===(i=m().h.getGroup(e.group_id))||void 0===i?void 0:i.name;return s?(0,g.jsx)("span",{style:b.groupOrTeamName,children:s}):void 0}),[e,b.groupOrTeamName]),f=(0,t().K8)((()=>{var i;if("team_permission"!==e.type&&"explicit_team_permission"!==e.type&&"team_owner_permission"!==e.type&&"explicit_team_owner_permission"!==e.type&&"explicit_team_guest_permission"!==e.type)return;const s="team_permission"===e.type||"team_owner_permission"===e.type?null===(i=(0,r().U)(h))||void 0===i?void 0:i.id:e.team_id;if(!s)return;const t=o().h.createChildStore(h,{table:a().yK,id:s,spaceId:h.getSpaceId()});return(0,g.jsxs)("span",{style:{...b.groupOrTeamName,display:"inline-flex",gap:4},children:[(0,g.jsx)(p().x,{store:t,size:14,style:{margin:1}}),(0,g.jsx)(d().A,{store:t,shouldWrap:!0})]})}),[e,h,b.groupOrTeamName]);if("none"===e.role)return;const y=(0,g.jsx)(l().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.withoutUserName",defaultMessage:"Access is from the â€œ{permissionItemName}â€",values:{permissionItemName:(0,g.jsx)(u()._,{permissionItem:e})}});if("group"===i&&"group_permission"===e.type)return s?(0,g.jsx)(l().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.groupWithGroupName",defaultMessage:"The {targetGroupName} group has access to this page",values:{targetGroupName:s}}):(0,g.jsx)(l().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.groupWithoutGroupName",defaultMessage:"This group has access to this page"});if("user"===i&&("user_permission"===e.type||"exclusive_user_permission"===e.type))return s?(0,g.jsx)(l().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.userWithUserName",defaultMessage:"{targetUserName} has access to this page",values:{targetUserName:s}}):void 0;switch(e.type){case"space_permission":return s&&"user"===i?(0,g.jsx)(l().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.spaceWithUserName",defaultMessage:"{targetUserName} has access from the â€œ{permissionItemName}â€ setting on this page",values:{targetUserName:s,permissionItemName:(0,g.jsx)(u()._,{permissionItem:e})}}):s&&"group"===i?(0,g.jsx)(l().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.spaceWithGroupName",defaultMessage:"The {targetGroupName} group has access from the â€œ{permissionItemName}â€ setting on this page",values:{targetGroupName:s,permissionItemName:(0,g.jsx)(u()._,{permissionItem:e})}}):y;case"space_owner_permission":return y;case"team_permission":case"explicit_team_permission":return"user"===i&&s&&f?(0,g.jsx)(l().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.member.teamWithUserName",defaultMessage:"{targetUserName} has access as a member of the {teamspaceName} teamspace",values:{targetUserName:s,teamspaceName:f}}):"group"===i&&s&&f?(0,g.jsx)(l().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.group.teamWithUserName",defaultMessage:"The {targetGroupName} group has access from the {teamspaceName} teamspace",values:{targetGroupName:s,teamspaceName:f}}):y;case"team_owner_permission":case"explicit_team_owner_permission":return"user"===i&&s&&f?(0,g.jsx)(l().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.owner.teamWithUserName",defaultMessage:"{targetUserName} has access as an owner of the {teamspaceName} teamspace",values:{targetUserName:s,teamspaceName:f}}):"group"===i&&s&&f?(0,g.jsx)(l().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.group.teamWithUserName",defaultMessage:"The {targetGroupName} group has access from the {teamspaceName} teamspace",values:{targetGroupName:s,teamspaceName:f}}):y;case"explicit_team_guest_permission":return s&&f?(0,g.jsx)(l().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.guest.teamWithUserName",defaultMessage:"{targetUserName} has access as a guest of the {teamspaceName} teamspace",values:{targetUserName:s,teamspaceName:f}}):y;case"group_permission":return s&&v?(0,g.jsx)(l().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.groupWithUserName",defaultMessage:"{targetUserName} has access as a member of the {groupName} group",values:{targetUserName:s,groupName:v}}):y;case"user_permission":case"exclusive_user_permission":return s?(0,g.jsx)(l().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.userWithUserName",defaultMessage:"{targetUserName} has access to this page",values:{targetUserName:s}}):void 0;default:return}}},913348:(e,i,s)=>{s.d(i,{A:()=>y});s(581454);var t=s(296540),n=()=>s(907258),o=()=>s(726637),r=()=>s(484714),a=()=>s(590526),l=()=>s(401497),c=()=>s(187174),d=()=>s(69708),m=()=>s(453697),p=()=>s(698449),u=()=>s(466797),g=()=>s(946928),h=s(474848);function b(e){const{group:i,store:s,groupPermission:t}=e,o=(0,r().v3)(),d=(0,a().O$)(n().AppStoreSidebarSpaceStore),[{value:m}]=(0,c().Yb)((async()=>{const e=await o.api.callApi({eventName:"getSpacePermissionGroupMembers",environment:o,data:{groupIds:[i.group_id],spaceId:i.space_id}});if("success"===e.type){var s;const t=(null===(s=e.data.groupUsersMap[i.group_id])||void 0===s?void 0:s.userIds)??[],{limitedUserStores:n}=(0,p().gA)({userIds:t,limit:void 0,spaceStore:d});return n}}),[d,o,i.group_id,i.space_id]),u=(0,l().IS)((()=>({container:{paddingInlineStart:16}})),[]);return(0,h.jsx)("div",{style:u.container,children:null==m?void 0:m.map((e=>(0,h.jsx)("div",{children:(0,h.jsx)(v,{userStore:e,store:s,groupPermission:t})},e.id)))})}function v(e){const{userStore:i,store:s,groupPermission:t}=e,n=(0,d().tz)(),r=(0,a().K8)((()=>i.getDisplayName(n)),[n,i]),l=(0,a().K8)((()=>i.getEmail()),[i]);return(0,h.jsx)(u().Ay,{store:s,permissionItem:{type:"display_only_group_member_permission"},from:t.from,icon:(0,h.jsx)(m().A,{userStore:i,avatarShouldShowShadow:!1,size:o().A.isMobile?u().Bj:u().Ev,hasTooltip:!1}),title:r||l,subtitle:l,upgradeButtonName:"permission_groups"})}function f(e){const{group:i}=e,s=(0,d().tz)(),t=(0,p().Pf)({intl:s,groupName:i.name});return(0,h.jsx)(d().sA,{defaultMessage:"People in {groupName} have access to the page",values:{groupName:t},id:"blockPermissionsSettings.groupPermission.tooltipV2"})}const y=function(e){const{store:i,groupPermission:r,spaceId:c,fromPermissionWrapper:m,disableExpansion:v}=e,y=(0,d().tz)(),[I,S]=(0,t.useState)(!1),[x,P]=(0,t.useState)(!1),{group:j,memberCount:_,membershipTypes:A}=(0,a().K8)((()=>{const{sidebarSpaceStore:e}=n().default.state;if(!e)return{};return{...s(169626).h.getGroupData(r.permissionItem.group_id)}}),[r.permissionItem.group_id]),w=null==A?void 0:A.includes("restricted_member"),k=!v&&!(!j||!_||0===_),M=(0,t.useCallback)((()=>S(!0)),[]),C=(0,t.useCallback)((()=>S(!1)),[]),T=(0,t.useCallback)((()=>{k&&P(!x)}),[x,k]),N=(0,l().IS)((()=>({mobileChevronIcon:{marginInlineStart:4,fill:s(100622).Tj.icon.secondary,transform:`rotate(${x?90:0}deg)`,transition:"transform 150ms ease"},mobileTitleContainer:{display:"flex",alignItems:"center"}})),[x]);if(!j)return null;const B=(0,p().Pf)({intl:y,groupName:j.name}),R=k?(0,h.jsx)(s(180925).A,{expanded:x,hovered:I,onClick:T,children:(0,h.jsx)(g().A,{groupIcon:j.icon,spaceId:c})}):(0,h.jsx)(g().A,{groupIcon:j.icon,spaceId:c});return(0,h.jsxs)("div",{style:{fontWeight:400},className:s(882722).HlM,children:[(0,h.jsx)(u().Ay,{onMouseEnter:M,onMouseLeave:C,onClick:k?T:void 0,isCollapsible:k,store:i,permissionItem:r.permissionItem,from:r.from,icon:R,title:(0,h.jsxs)("div",{style:N.mobileTitleContainer,children:[(0,h.jsxs)(s(396896).fI,{gap:6,alignItems:"center",children:[B,w?(0,h.jsx)(s(313171).L,{}):void 0]}),k&&o().A.isMobile?(0,h.jsx)("div",{style:N.mobileChevronIcon,children:(0,h.jsx)(s(807449).I,{icon:s(158115).arrowChevronSingleRightFillSmallIcon,size:"xs"})}):void 0]}),ignoreLocalHoverState:e.ignoreLocalHoverState,showInherited:e.showInherited,nonInheritedTooltip:e.tooltip?e.tooltip:(0,h.jsx)(f,{group:j}),subtitle:o().A.isMobile?(0,h.jsxs)("div",{children:[(0,h.jsx)(d().sA,{defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} person} other {{numberOfGroupMembers} people}}",id:"blockPermissionsSettings.groupPermission.none",values:{numberOfGroupMembers:_}})," Â· ",(0,h.jsx)(d().sA,{...(0,s(268153).R)({type:"group_permission",role:r.permissionItem.role,table:"block",isRemovable:!1}).label})]}):(0,h.jsxs)("div",{children:[(0,h.jsx)(d().sA,{defaultMessage:"Group",id:"blockPermissionsSettings.groupPermission.label"})," Â· ",(0,h.jsx)(d().sA,{defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} person} other {{numberOfGroupMembers} people}}",id:"blockPermissionsSettings.groupPermission.none",values:{numberOfGroupMembers:_}})]}),upgradeButtonName:"group_permission_item",isRemovableOverride:e.isRemovableOverride,fromPermissionWrapper:m,roleItemOverrides:e.roleItemOverrides,menuListItemProps:e.menuListItemProps,style:e.style,...e.permissionItemArgs}),x?(0,h.jsx)(b,{group:j,store:i,groupPermission:r}):void 0]},j.id)}},931938:(e,i,s)=>{s.d(i,{k:()=>r});var t=()=>s(295633),n=()=>s(185631),o=()=>s(620173);function r(e){const{environment:i,spaceStore:s}=e,r=s&&(0,n().i)(s);if(!r)return;const a=new(t().B)(i,{table:"block",id:r});return(0,o().n)(a)}},946928:(e,i,s)=>{s.d(i,{A:()=>a});var t=s(296540),n=()=>s(99756),o=s(474848);function r({groupIcon:e,spaceId:i}){const t=(0,s(401497).IS)((()=>({icon:{fill:s(100622).Tj.icon.secondary}})),[]);return e&&i?(0,o.jsx)(n().A,{type:"circle",iconType:"recordIcon",icon:{icon:e,pointer:{table:s(96689).NX,id:i}}}):(0,o.jsx)(n().A,{type:"circle",iconType:"function",iconFn:s(888867).s,iconStyle:t.icon})}const a=t.memo(r)}}]);