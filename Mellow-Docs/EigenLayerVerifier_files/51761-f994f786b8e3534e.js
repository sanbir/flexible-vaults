"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[51761],{1330:(e,n,t)=>{t.d(n,{Hz:()=>z,rq:()=>P,w1:()=>N,k2:()=>D,F8:()=>W,qq:()=>q,Rv:()=>G,tD:()=>K,X6:()=>O,Kq:()=>B,X8:()=>j,vA:()=>F,NC:()=>X});t(898992),t(354520),t(672577),t(581454),t(737550);var a=()=>t(906745),o=()=>t(907258),i=()=>t(242422),r=()=>t(675133),c=()=>t(711339),d=()=>t(792057),s=()=>t(128933),l=()=>t(584262),u=()=>t(798880),m=()=>t(496603),v=()=>t(763824),f=()=>t(615234),_=()=>t(534177),p=()=>t(384944),g=()=>t(281948),I=()=>t(221592),b=()=>t(192359),S=()=>t(649021),y=()=>t(424641),C=()=>t(583238),h=()=>t(488776),w=()=>t(752860),A=()=>t(547149),V=()=>t(705295),M=()=>t(743444),k=()=>t(658082),x=()=>t(812109);t(517642),t(658004),t(733853),t(845876),t(432475),t(515024),t(731698);function R({oldState:e,newState:n,updatedCalendars:t,fetchTime:a,lastSeenReasonEnqueuedAt:o}){const i=!e||n.botId!==e.botId,r=(0,k().tQ)({calendarsThatWereUpdated:t.map(x().N),oldCalendarFetchedTimes:i||null==e?void 0:e.calendarsToLastFetchedTime,fetchTime:a}),c=e?function(e){const{previousLastSeenReasonEnqueuedAt:n,newLastSeenReasonEnqueuedAt:t}=e,a={},o=new Set([...Object.keys(n),...Object.keys(t)]);for(const i of o){const e=i;a[e]=Math.max(n[e]??0,t[e]??0)}return a}({previousLastSeenReasonEnqueuedAt:e.lastSeenReasonEnqueuedAt,newLastSeenReasonEnqueuedAt:o}):o;if(!e||i)return{...n,lastSeenReasonEnqueuedAt:c,calendarsToLastFetchedTime:r};const d={...e,calendarsToLastFetchedTime:r},s=[...(null==e?void 0:e.events)??[],...n.events??[]],l={};for(const u of s)if(u.attendees)for(const e of u.attendees)e.notionUserId&&e.email&&(l[e.email]=e.notionUserId);for(const u of s)if(u.attendees)for(const e of u.attendees)e.email&&l[e.email]&&!e.notionUserId&&(e.notionUserId=l[e.email]);for(const u of(0,_().WP)(n))switch(u[0]){case"accounts":d.accounts=m().Ul(m().hS([...n.accounts,...e.accounts],(({id:e})=>e)),(({id:e})=>e));break;case"events":d.events=(0,M().$z)({events:e.events,calendars:e.calendars,updatedCalendarAndAccountIds:t,newEvents:n.events});break;case"botId":d.botId=n.botId;break;case"timeMin":d.timeMin=Math.max(e.timeMin,n.timeMin);break;case"timeMax":d.timeMax=Math.min(e.timeMax,n.timeMax);break;case"calendars":d.calendars=m().Ul(m().hS([...n.calendars,...e.calendars],x().N),x().N);break;case"lastSeenReasonEnqueuedAt":d.lastSeenReasonEnqueuedAt=c;break;default:u[0]}return d}var T=()=>t(614016),U=()=>t(481887),E=()=>t(377515);function N({environment:e,timeRange:n,analyticsContext:t}){const{sidebarSpaceViewStore:a}=o().default.state;if(!a)return;const i=a.getHomeCalendarConfigStore().getKeyStore("time_range");A().createAndCommit({userAction:"homeCalendarActions.changeUpcomingEventsTimeRange",environment:e,canUndo:!0,perform:e=>{p().KY({transaction:e,store:i,value:n})}}),(0,U().rP)({environment:e,calendarPanelContext:(0,U().sp)(t),newValue:n})}function O({environment:e,filter:n,entrypoint:t,analyticsContext:a}){var i,r;const{sidebarSpaceViewStore:c}=o().default.state;if(!c)return;let d;switch(t){case"personal_home":d=null===(i=c.getHomeCalendarConfigStore())||void 0===i||null===(i=i.getKeyStore("event_filters"))||void 0===i?void 0:i.getKeyStore(n);break;case"upcoming_meetings":d=null===(r=c.getUpcomingMeetingsSettingsStore())||void 0===r||null===(r=r.getKeyStore("event_filters"))||void 0===r?void 0:r.getKeyStore(n);break;default:(0,_().HB)(t)}const s=!(0,V().En)(n,t);if(A().createAndCommit({userAction:"homeCalendarActions.toggleCalendarEventFilter",environment:e,canUndo:!0,perform:e=>{p().KY({transaction:e,store:d,value:s})}}),a){const t=(0,U().sp)(a);(0,U().jr)({environment:e,calendarPanelContext:t,filter:n,newValue:s})}}function P({environment:e,botId:n,shouldLog:t,analyticsContext:a}){const{sidebarSpaceViewStore:i}=o().default.state;if(!i)return;const r=i.getHomeCalendarConfigStore().getKeyStore("selected_calendar_bot_id");if(r.getValue()!==n&&(0,C().pH)().find((e=>e.id===n))&&(A().createAndCommit({userAction:"homeCalendarActions.changeSelectedCalendarBot",environment:e,canUndo:!0,perform:e=>{p().KY({transaction:e,store:r,value:n})}}),t)){const t=(0,U().sp)(a);(0,U()._w)({environment:e,botId:n,calendarPanelContext:t})}}function D({environment:e}){const{sidebarSpaceViewStore:n}=o().default.state;if(!n)return;const t=n.getHomeCalendarConfigStore().getKeyStore("selected_calendar_bot_id");t.getValue()&&A().createAndCommit({userAction:"homeCalendarActions.clearSelectedCalendarBot",environment:e,canUndo:!0,perform:e=>{p().KY({transaction:e,store:t,value:void 0})}})}async function q({environment:e,sidebarSpaceViewStore:n,botId:t,timeRange:r,calendarAndAccountIds:d,forceRefetch:s,updateMethod:l,reason:f}){if(!n||!n.isReady()||!n.canRead())return"failure";const _=Array.isArray(f)?f:[f];if(function(e){if(!i().default.checkGate({gateName:"get_calendar_events_versioned_reasons_fetch_guard"}))return!1;const n=(0,h().Y)().getHomeCalendarStateForSpaceView();if(!n)return!1;for(const{reason:t,enqueuedAt:a}of e){if(void 0===a)return!1;const e=n.lastSeenReasonEnqueuedAt[t];if(!e)return!1;if(e>=a)return!0}return!1}(_))return"skipped";if(!s){var g;let e=(0,h().Y)().getHomeCalendarStateForSpaceView();if(e||(await(0,v().nQ)(1e3,(0,h().Y)().waitUntilReady()),e=(0,h().Y)().getHomeCalendarStateForSpaceView()),(null===(g=e)||void 0===g?void 0:g.botId)===t)if(d){if((0,k().zn)(d))return"skipped"}else if((0,k().zn)((0,E().GF)({botId:t,sidebarSpaceViewStore:n})))return"skipped"}const y=(0,E().AU)({spaceViewStore:n,botId:t,specificCalendars:d,forcePrimaryAccountVisibility:!0}),C=c().default.DO_NOT_USE_markLegacy("home.calendar.get_calendar_events_all"),w=Object.fromEntries(_.map((e=>[e.reason,e.enqueuedAt])).filter((([e,n])=>Boolean(n)))),V=(0,M().gM)({environment:e,events:(0,h().Y)().getEvents()}),x=await e.api.callApi({eventName:"getCalendarEvents",environment:e,data:{botId:t,spaceId:n.getSpaceId(),timeMin:r.timeMin,timeMax:r.timeMax,orderBy:"startTime",calendars:d,calendarVisibilityOverrides:"mirrorWithCron"===y.type?void 0:y.calendarOverrides,userTimeZone:(0,I().s1)().timeZone,versionedReasons:w,reason:(0,m().sb)(_.map((e=>e.reason))).sort().join(","),unfurlGroups:i().default.checkGate({gateName:"calendar_event_group_unfurling"}),knownUserEmails:Array.from(V.keys())}});if("success"!==x.type)return"failure";d||c().default.DO_NOT_USE_measureLegacy(C,{environment:e});const{accounts:T,calendars:U,events:N,notionUsers:O,transcriptionBlockPointersByEventUId:P}=x.data,D=(0,k().MP)({calendarApiResponse:U,specificCalendarsFetched:d,calendarVisibilityOverrides:y}),q=function({environment:e,notionUsers:n,cachedEmailToUserId:t}){const a=e.defaultRecordCache.inMemoryRecordCache,o=e.currentUser.id,i=new Map(t);if(n)for(const{email:r,user:c}of n){if(null==c||!c.value)continue;const e={table:u().oo,id:c.value.id},n={pointer:e,userId:o};a.hasRecord(n)||(a.setRecord(n,c),a.emitRecord(e,[])),i.set(r,c.value.id)}return i.size>0?i:void 0}({environment:e,notionUsers:O,cachedEmailToUserId:V});return(0,h().Y)().update((e=>{let n;switch(l){case void 0:case"merge":n=e;break;case"replace":n=void 0}let c=R({oldState:n,newState:(0,M().IC)({botId:t,accounts:T,calendars:U,events:N,emailToUserId:q,transcriptionBlockPointersByEventUId:P,timeMin:r.timeMin,timeMax:r.timeMax}),updatedCalendars:D,fetchTime:a().DateTime.now(),lastSeenReasonEnqueuedAt:w});return c=function({now:e=a().DateTime.now(),state:n}){const{events:t}=n,{timeZone:r}=(0,I().s1)(),c=o().AppStoreSidebarSpaceStore.state,d=i().default.checkGate({gateName:"meeting_notes_past_calendar_events"})?e.minus({days:2}):e,s=c?(0,S().dh)({spaceStore:c,events:t}):{},l=t.filter((e=>{if((0,M().FC)(e,d,r)){var n;return((null===(n=s[e.id])||void 0===n?void 0:n.transcriptionBlockStores)??[]).some((e=>{const n=(0,b().by)(e).state;return"idle"!==n&&"paused"!==n&&"initial"!==n}))}return!0}));if(l.length===t.length)return{didChange:!1,newState:n};return{didChange:!0,newState:{...n,timeMin:d.toMillis(),events:l}}}({state:c}).newState,c})),function({environment:e,spaceViewStore:n,botId:t,calendarResponse:a}){const o=n.getHomeCalendarVisibilityConfig(t);if((0,E().Xg)({spaceViewStore:n,botId:t}))return;const i=(0,E().NU)({currentConfig:null==o?void 0:o.calendarVisibility,calendars:a});if("noChanges"===i.result)return;A().createAndCommit({userAction:"homeCalendarActions.populateCalendarConfigWithCalendarResponse",environment:e,canUndo:!0,perform:e=>{p().KY({transaction:e,store:n.getHomeCalendarConfigStore().getKeyStore("shownCalendars").getKeyStore(t).getKeyStore("calendarVisibility"),value:i.newConfig})}})}({environment:e,spaceViewStore:n,botId:t,calendarResponse:U}),"success"}const Y=(0,m().sg)(q,3e3,{leading:!1,trailing:!0});const L=3e3+3e3*Math.random(),H=Math.random()*f().Xb*20,K=function(){let e,n,t,o;let i=a().DateTime.now();return window.addEventListener("online",(()=>{i=a().DateTime.now()})),({version:r,...c})=>{let d=L;-1===r&&a().DateTime.now().diff(i).as("milliseconds")>=f().Xb&&(d=H);const s=Math.max(d,6e3);o=function(e,n){if(!n)return e;if(e.environment!==n.environment||e.sidebarSpaceViewStore!==n.sidebarSpaceViewStore||e.botId!==n.botId||e.timeRange.key!==n.timeRange.key)return;const t=(0,m().Bq)([e.reason,n.reason]),a={};for(const r of t){const e=a[r.reason]??0,n=r.enqueuedAt&&r.enqueuedAt>e?r.enqueuedAt:e;a[r.reason]=n}let o;const i={environment:e.environment,sidebarSpaceViewStore:e.sidebarSpaceViewStore,botId:e.botId,timeRange:{key:e.timeRange.key,timeMin:Math.max(e.timeRange.timeMin,n.timeRange.timeMin),timeMax:Math.max(e.timeRange.timeMax,n.timeRange.timeMax)},reason:Object.entries(a).map((([e,n])=>({reason:e,enqueuedAt:n}))),forceRefetch:e.forceRefetch||n.forceRefetch};return o=e.calendarAndAccountIds&&n.calendarAndAccountIds?{...i,calendarAndAccountIds:(0,m().hS)([...e.calendarAndAccountIds,...n.calendarAndAccountIds],x().N)}:{...i,updateMethod:"replace"===e.updateMethod||"replace"===n.updateMethod?"replace":"merge"},o}(c,o)??c;const l=a().DateTime.now(),u=l.plus({milliseconds:d}),v=l.plus({milliseconds:s});n=n?a().DateTime.min(n,v):v,e=a().DateTime.min(n,u),t&&clearTimeout(t);const _=o;t=setTimeout((()=>{q(_),n=void 0,e=void 0,o=void 0,t=void 0}),e.diff(l).as("milliseconds"))}}();function B({environment:e,botId:n,mirrorWithNotionCalendar:t,analyticsContext:a}){const{sidebarSpaceViewStore:i}=o().default.state;if(!i)return;const r=i.getHomeCalendarConfigStore().getKeyStore("shownCalendars").getKeyStore(n);A().createAndCommit({userAction:"homeCalendarActions.toggleCalendarMirroring",environment:e,canUndo:!0,perform:e=>{const n=t?void 0:(0,E().cL)((0,h().Y)().getCurrentCalendars()??[]);p().KY({transaction:e,store:r,value:{mirrorWithNotionCalendar:t,calendarVisibility:n}})}});const c=(0,U().sp)(a),d=t;(0,U().m3)({environment:e,calendarPanelContext:c,newValue:d}),Y({environment:e,sidebarSpaceViewStore:i,botId:n,timeRange:(0,T().M)(),forceRefetch:!1,reason:{reason:"toggle_mirroring"}})}function F({environment:e,botId:n,calendarId:t,accountId:a,newIsVisible:i,analyticsContext:r}){const{sidebarSpaceViewStore:c}=o().default.state;if(!c)return;const d=c.getCalendarVisibilityStore({botId:n,calendarId:t,accountId:a});A().createAndCommit({userAction:"homeCalendarActions.toggleCalendarVisibility",environment:e,canUndo:!0,perform:e=>{p().KY({transaction:e,store:d,value:i})}}),(0,U().J3)({environment:e,calendarPanelContext:(0,U().sp)(r),calendarId:t,accountId:a,newValue:i}),Y({environment:e,sidebarSpaceViewStore:c,botId:n,timeRange:(0,T().M)(),calendarAndAccountIds:[{calendarId:t,accountId:a}],forceRefetch:!1,reason:{reason:"toggle_calendar_visibility"}})}function j({environment:e,botId:n,calendarId:t,accountId:a,newIsVisible:i,enqueuedAt:r}){var c;const{sidebarSpaceViewStore:d}=o().default.state;if(!d)return;const s=(0,h().Y)().getCalendar({calendarId:t,accountId:a});if(!s||s.selected===i)return;(0,h().Y)().update((e=>{if(!e)return;const n=(0,m().mg)(e),o=n.calendars.find((e=>e.id===t&&e.accountId===a));return o&&o.selected!==i?(o.selected=i,n):e}));((null===(c=d.getHomeCalendarVisibilityConfig(n))||void 0===c?void 0:c.mirrorWithNotionCalendar)??!1)&&i&&K({sidebarSpaceViewStore:d,environment:e,botId:n,timeRange:(0,T().M)(),calendarAndAccountIds:[{calendarId:t,accountId:a}],forceRefetch:!1,reason:{reason:"calendar_visibility_change",enqueuedAt:r}})}function W(){const{sidebarSpaceViewStore:e}=o().default.state;e&&(0,h().Y)().setState(void 0)}async function X(e){const{environment:n,botId:t,event:a,meetingNote:o,from:i}=e,r=a.isAllDay?{uid:a.uid,title:a.summary??"",attendees:(a.attendees??[]).map((e=>({email:e.email??"",self:e.self}))),isAllDay:!0,start:{date:a.start.date},end:{date:a.end.date}}:{uid:a.uid,title:a.summary??"",attendees:(a.attendees??[]).map((e=>({email:e.email??"",self:e.self}))),isAllDay:!1,start:{dateTime:a.start.dateTime,timeZone:a.start.timeZone},end:{dateTime:a.end.dateTime,timeZone:a.end.timeZone}};return await n.api.callApi({eventName:"upsertCalendarMeetingNote",environment:n,data:{botId:t,from:i,platform:n.device.platform,event:r,location:null==o?void 0:o.location,share:Boolean(null==o?void 0:o.share)}})}async function G(e){const{environment:n,sidebarSpaceStore:t,meetingNoteUrl:a,openInNew:o,peekMode:i="center_peek"}=e,r=(0,y().xy)({environment:n,spaceStore:t,fileUrl:a});r&&!r.isReady()&&await r.waitUntil((()=>r.isReady())),null!=r&&r.isReady()?g().VU({environment:n,openInNew:o,store:r,pageVisitSource:l().y8.PersonalHomeCalendarAttachment,peekMode:i,resultsStore:void 0,collectionContextStore:void 0}):(0,w().L)({environment:n,url:a})}function Z(e){const{event:n,meetingNote:t}=e;(0,h().Y)().update((e=>{if(!e)return;const a=(0,m().mg)(e),o=a.events.find((e=>e.accountId===n.accountId&&e.calendarId===n.calendarId&&e.id===n.id));return o&&(o.meetingNote=t),a}))}async function z(e){const{environment:n,botId:t,event:a,data:o,sidebarSpaceStore:i}=e;o.location&&Z({event:a,meetingNote:{eventUid:a.uid,workspaceId:i.getSpaceId(),location:o.location,share:o.share}}),s().D6({label:r().A.getIntl().formatMessage({id:"homeCalendarActions.meetingNoteAdded",defaultMessage:"Added AI Meeting Note"})});const c=await n.api.callApi({eventName:"addEventMeetingNote",environment:n,data:{botId:t,...o}});return"failed"===c.type&&(Z({event:a,meetingNote:void 0}),d().Qg(c)),c}},122406:(e,n,t)=>{t.d(n,{e:()=>o});t(296540);const a={viewBox:"0 0 20 20",fittedViewBox:"1.68 2.37 17.01 15.26",svg:(0,t(474848).jsx)("path",{d:"M8 2.375c-1.137 0-2.054.47-2.674 1.242-.608.757-.9 1.765-.9 2.824s.292 2.066.9 2.824c.62.772 1.537 1.241 2.674 1.241s2.055-.469 2.675-1.241c.608-.758.9-1.766.9-2.824 0-1.059-.292-2.067-.9-2.824-.62-.773-1.538-1.242-2.675-1.242M5.676 6.441c0-.842.233-1.554.624-2.042.38-.473.937-.774 1.7-.774s1.32.301 1.7.774c.391.488.624 1.2.624 2.042s-.233 1.554-.624 2.041c-.38.473-.937.774-1.7.774s-1.32-.3-1.7-.774c-.391-.487-.624-1.2-.624-2.041M8 11.63c-2.7 0-5.101 1.315-6.12 3.305-.361.706-.199 1.421.23 1.923.412.48 1.06.767 1.74.767h8.3c.68 0 1.328-.287 1.74-.767.429-.502.591-1.217.23-1.923C13.1 12.945 10.7 11.63 8 11.63m-5.007 3.875c.761-1.488 2.672-2.626 5.007-2.626s4.246 1.138 5.007 2.626c.105.204.07.378-.067.54-.156.182-.448.33-.79.33h-8.3c-.342 0-.634-.148-.79-.33-.138-.162-.172-.336-.067-.54m15.493-8.568a.625.625 0 0 1 0 .884L16.807 9.5l1.68 1.68a.625.625 0 1 1-.884.883l-1.68-1.68-1.68 1.68a.625.625 0 0 1-.883-.884L15.04 9.5l-1.68-1.68a.625.625 0 1 1 .884-.883l1.68 1.68 1.678-1.68a.625.625 0 0 1 .884 0"})},o=(0,t(340498).wt)("personXmark",a,"default")},377515:(e,n,t)=>{t.d(n,{AU:()=>u,GF:()=>s,NU:()=>v,Pj:()=>l,Xg:()=>_,cL:()=>m});t(944114),t(898992),t(430670),t(737550);var a=()=>t(907258),o=()=>t(761940),i=()=>t(496603),r=()=>t(534177),c=()=>t(488776),d=()=>t(812109);function s(e){const n=function({botId:e,sidebarSpaceViewStore:n}){const t=(0,c().Y)().getCurrentCalendars()??[],a={};for(const o of t)a[(0,d().N)(o)]={calendarId:o.id,accountId:o.accountId,visible:l({spaceViewStore:n,botId:e,calendar:o})};return a}(e);return Object.values(n).flatMap((({calendarId:e,accountId:n,visible:t})=>t?[{calendarId:e,accountId:n}]:[]))}function l({spaceViewStore:e,botId:n,calendar:t}){return function({spaceViewStore:e,botId:n,calendarId:t,accountId:a}){var o;const i=null==e?void 0:e.getHomeCalendarVisibilityConfig(n);if(!i||_({spaceViewStore:e,botId:n}))return;return null===(o=i.calendarVisibility)||void 0===o||null===(o=o[a])||void 0===o?void 0:o[t]}({spaceViewStore:e,botId:n,calendarId:t.id,accountId:t.accountId})??t.selected}function u({spaceViewStore:e,botId:n,specificCalendars:t,forcePrimaryAccountVisibility:i=!1}){var d;const s=e.getHomeCalendarVisibilityConfig(n),l=[];if(!(!s||!(0,r().O9)(null==s?void 0:s.calendarVisibility)||_({spaceViewStore:e,botId:n})))for(const[a,o]of(0,r().WP)(s.calendarVisibility??{}))for(const[e,n]of(0,r().WP)(o??{}))!(0,r().O9)(n)||t&&!t.some((n=>n.accountId===a&&n.calendarId===e))||l.push({accountId:a,calendarId:e,visible:n});if(!i)return l.length>0?{type:"calendarOverrides",calendarOverrides:l}:{type:"mirrorWithCron"};const u=null===(d=a().default.state.currentUserStore)||void 0===d?void 0:d.getEmail(),{eligibleAccounts:m}=u?(0,o().RM)({currentUserEmail:u,calendars:(0,c().Y)().getCurrentCalendars()??[],accounts:(0,c().Y)().getCurrentAccounts()}):{eligibleAccounts:[]};for(const{account:a,calendars:o}of m)for(const e of o){if(t&&!t.some((n=>n.accountId===a.id&&n.calendarId===e.id)))continue;const n=l.findIndex((n=>n.accountId===a.id&&n.calendarId===e.id));n>=0?l[n].visible=!0:l.push({accountId:a.id,calendarId:e.id,visible:!0})}return l.length>0?{type:"calendarOverrides",calendarOverrides:l}:{type:"mirrorWithCron"}}function m(e){const n={};for(const{id:t,accountId:a,selected:o}of e)n[a]={...n[a],[t]:o};return n}function v({currentConfig:e,calendars:n}){const t=(0,i().mg)(e)??{};let a=!1;for(const{id:i,accountId:r,selected:c}of n){var o;void 0===(null===(o=t[r])||void 0===o?void 0:o[i])&&(t[r]={...t[r],[i]:c},a=!0)}return a?{result:"updated",newConfig:t}:{result:"noChanges"}}const f=!0;function _({spaceViewStore:e,botId:n}){if(!e||!n)return f;const t=e.getHomeCalendarVisibilityConfig(n);return(null==t?void 0:t.mirrorWithNotionCalendar)??f}},481887:(e,n,t)=>{t.d(n,{G7:()=>_,IU:()=>v,J3:()=>C,V0:()=>p,_w:()=>b,jr:()=>I,lv:()=>g,m3:()=>S,np:()=>f,qL:()=>w,rP:()=>y,sp:()=>m});t(898992),t(354520),t(581454);var a=()=>t(314529),o=()=>t(907258),i=()=>t(966509),r=()=>t(488776),c=()=>t(705295),d=()=>t(614016),s=()=>t(377515);function l({state:e,calendars:n,event_filters:t,mirror_calendars:a,time_range:o,bot_id:i,view:r}){return{state:e,calendars:n,event_filters:t&&{all_day_events:t.all_day_events,events_without_participants:t.events_without_participants,events_without_location:t.events_without_location},mirror_calendars:a,time_range:o,bot_id:i,view:r}}function u({event_id:e,calendar_id:n,account_id:t,is_all_day:a,has_participants:o,conferencing_type:i,index:r,num_days_in_future:c}){return{event_id:e,calendar_id:n,account_id:t,is_all_day:a,has_participants:o,conferencing_type:i,index:r,num_days_in_future:c}}function m(e){var n,t;const a=o().default.state.sidebarSpaceViewStore,i=null===(n=(0,r().Y)().getHomeCalendarStateForSpaceView())||void 0===n?void 0:n.botId;return{state:e.panelState,calendars:a&&i&&((0,r().Y)().getCurrentCalendars()??[]).map((e=>({type:e.provider,calendarId:e.id,accountId:e.accountId,isShown:(0,s().Pj)({spaceViewStore:a,botId:i,calendar:e})}))),mirror_calendars:(0,s().Xg)({botId:i,spaceViewStore:a}),event_filters:{all_day_events:(0,c().En)("all_day_events","personal_home"),events_without_participants:(0,c().En)("events_without_participants","personal_home"),events_without_location:(0,c().En)("events_without_location","personal_home")},time_range:(null==a||null===(t=a.getHomeCalendarConfigStore())||void 0===t?void 0:t.getKeyStore("time_range").getValue())??d().C0,bot_id:i,view:e.view}}function v({event:e,eventIndex:n,numDaysInFuture:t}){var a;return{event_id:e.id,calendar_id:e.calendarId,account_id:e.accountId,is_all_day:e.isAllDay,has_participants:e.hasParticipants,conferencing_type:null===(a=e.conferencing)||void 0===a?void 0:a.providerName,index:n,num_days_in_future:t}}function f({environment:e,target:n,eventContext:t,calendarPanelContext:o}){(0,a().DO_NOT_USE_trackLegacy)(e,"cal_event_click",{target:n,...l(o),...u(t)}),"conferencing"===n&&o.bot_id&&(0,i().R)({environment:e,data:{type:"track",payload:{event:"joinMeeting",eventId:t.event_id,calendarId:t.calendar_id,conferencingProvider:t.conferencing_type,method:o.view}},botId:o.bot_id})}function _({environment:e,eventContext:n,calendarPanelContext:t,attachmentType:o,notionBlockId:r,attachmentIndex:c}){(0,a().DO_NOT_USE_trackLegacy)(e,"cal_event_click",{target:"attachment",attachment_type:o,attachment_index:c,notion_block_id:r,...l(t),...u(n)}),t.bot_id&&(0,i().R)({environment:e,data:{type:"track",payload:{event:"eventAttachmentOpened",provider:o,location:t.view,method:t.view}},botId:t.bot_id})}function p(e){const{environment:n,calendarPanelContext:t,notionAnalyticsSessionId:o}=e;(0,a().DO_NOT_USE_trackLegacy)(n,"cal_create_event",{...l(t)}),t.bot_id&&(0,i().R)({environment:n,data:{type:"track",payload:{event:"createEventButtonClicked",notionAnalyticsSessionId:o,method:t.view}},botId:t.bot_id})}function g(e){(0,a().DO_NOT_USE_trackLegacy)(e.environment,"cal_settings_menu",{action:e.action,...l(e.calendarPanelContext)})}function I(e){h({environment:e.environment,calendarPanelContext:e.calendarPanelContext,action:`toggle_${e.filter}`,value:e.newValue})}function b(e){h({environment:e.environment,calendarPanelContext:e.calendarPanelContext,action:"change_calendar_bot",value:e.botId})}function S(e){h({environment:e.environment,calendarPanelContext:e.calendarPanelContext,action:"toggle_mirroring",value:e.newValue})}function y(e){h({environment:e.environment,calendarPanelContext:e.calendarPanelContext,action:"change_time_range",value:e.newValue})}function C(e){h({environment:e.environment,calendarPanelContext:e.calendarPanelContext,action:"toggle_calendar_visibility",calendarId:e.calendarId,accountId:e.accountId,value:e.newValue})}function h(e){(0,a().DO_NOT_USE_trackLegacy)(e.environment,"cal_configure_view",{...l(e.calendarPanelContext),action:e.action,value:e.value,..."calendarId"in e?{calendar_id:e.calendarId}:{},..."accountId"in e?{account_id:e.accountId}:{}})}function w(e){const{environment:n,calendarPanelContext:t}=e;(0,a().DO_NOT_USE_trackLegacy)(n,"cal_loaded",{...l(t)}),"connected_with_events"!==t.state&&"connected_no_events"!==t.state||!t.bot_id||(0,i().R)({environment:n,data:{type:"page",payload:{page:t.view,state:t.state}},botId:t.bot_id})}},614016:(e,n,t)=>{t.d(n,{B7:()=>u,C0:()=>d,M:()=>l,_I:()=>v,iI:()=>s,jv:()=>m});var a=()=>t(200979),o=()=>t(392998),i=()=>t(894074),r=()=>t(907258),c=()=>t(534177);const d="three_days";function s(){const e=v();return{key:e,...u(e)}}function l(){const e="two_days_before_one_week_after";return{key:e,...u(e)}}function u(e){if("two_days_before_one_week_after"===e)return{timeMin:(0,a().A)(Date.now(),2).getTime(),timeMax:(0,o().A)(Date.now(),7).getTime()};const n=Date.now();return{timeMin:n,timeMax:(0,o().A)((0,i().A)(n,{hours:23,minutes:59,seconds:59,milliseconds:999}),m(e)-1).getTime()}}function m(e){switch(e){case"one_day":return 1;case"two_days":return 2;case"three_days":return 3;case"one_week":case"two_days_before_one_week_after":return 7;default:(0,c().HB)(e)}}function v(){var e;const n=null===(e=r().default.state.sidebarSpaceViewStore)||void 0===e||null===(e=e.getHomeCalendarConfigStore())||void 0===e||null===(e=e.getKeyStore("time_range"))||void 0===e?void 0:e.getValue();switch(n){case"one_day":case"two_days":case"three_days":case"one_week":case"two_days_before_one_week_after":return n;default:return d}}},658082:(e,n,t)=>{t.d(n,{MP:()=>d,oM:()=>l,tQ:()=>s,zn:()=>c});t(517642),t(658004),t(733853),t(845876),t(432475),t(515024),t(731698),t(898992),t(823215),t(354520),t(581454);var a=()=>t(496603),o=()=>t(534177),i=()=>t(488776),r=()=>t(812109);function c(e){return e.every((({calendarId:e,accountId:n})=>(0,i().Y)().getCalendarFetchedTime({calendarId:e,accountId:n})))}function d({specificCalendarsFetched:e,calendarVisibilityOverrides:n,calendarApiResponse:t}){const i=new Set((e??[]).map(r().N)),c="calendarOverrides"===n.type?n.calendarOverrides:[],d=(0,a().pY)(c,r().N);return t.filter((n=>{const t=(0,r().N)(n);if(void 0!==e)return i.has(t);const a=d[t];return(0,o().O9)(a)?a.visible:n.selected})).map((({id:e,accountId:n})=>({calendarId:e,accountId:n})))}function s({calendarsThatWereUpdated:e,oldCalendarFetchedTimes:n,fetchTime:t}){const a={...n};for(const o of e)(!a[o]||a[o]<t.toMillis())&&(a[o]=t.toMillis());return a}function l(e){switch(e){case"events":return"connected_with_events";case"noEvents":return"connected_no_events";case"signedOut":return"disconnected";case"disconnectedAccount":case"missingScopes":return"connected_permissions_error";case"loadError":return"load_error";default:return}}},677169:(e,n,t)=>{t.d(n,{m:()=>i});var a=()=>t(590526),o=()=>t(110573);function i(){return(0,a().O$)(o().E)}}}]);