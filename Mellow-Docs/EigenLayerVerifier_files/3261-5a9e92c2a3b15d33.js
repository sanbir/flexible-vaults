"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[3261,99171],{3284:(e,t,o)=>{o.r(t),o.d(t,{arrowSquarePathUpDownIcon:()=>n,iconDefinition:()=>r});o(296540);const r={viewBox:"0 0 20 20",fittedViewBox:"0.64 3.12 18.71 13.76",svg:(0,o(474848).jsx)("path",{d:"M6.475 3.125a.625.625 0 1 0 0 1.25h7.975c.65 0 1.175.526 1.175 1.175v6.057l-1.408-1.408a.625.625 0 1 0-.884.884l2.475 2.475a.625.625 0 0 0 .884 0l2.475-2.475a.625.625 0 0 0-.884-.884l-1.408 1.408V5.55a2.425 2.425 0 0 0-2.425-2.425zM3.308 6.442a.625.625 0 0 1 .884 0l2.475 2.475a.625.625 0 1 1-.884.884L4.375 8.393v6.057c0 .649.526 1.175 1.175 1.175h7.975a.625.625 0 0 1 0 1.25H5.55a2.425 2.425 0 0 1-2.425-2.425V8.393L1.717 9.801a.625.625 0 1 1-.884-.884z"})},n=(0,o(340498).wt)("arrowSquarePathUpDown",r,"default")},24126:(e,t,o)=>{o.d(t,{c:()=>n});o(296540);const r={viewBox:"0 0 20 20",fittedViewBox:"3.9 2.75 12.18 14.49",svg:(0,o(474848).jsx)("path",{d:"M12.626 2.768a.625.625 0 0 1 0 1.224l-.126.013h-.125v4.794l3.366 5.159c.893 1.369-.03 3.17-1.623 3.281l-.156.006H6.039c-1.688 0-2.703-1.873-1.78-3.287l3.366-5.157V4.005H7.5a.625.625 0 0 1 0-1.25h5zM8.875 9.173l-.102.156-1.567 2.401h5.589l-1.569-2.403-.101-.156V4.005h-2.25z"})},n=(0,o(340498).wt)("beaker",r,"default")},55043:(e,t,o)=>{o.d(t,{A:()=>i});o(296540);var r=()=>o(69708),n=()=>o(314638),l=o(474848);const i=function(e){if(o(726637).A.isMobile)return e.propertySchema?(0,l.jsx)(n().G,{propertySchema:e.propertySchema,onClick:e.onClick,focused:!1,format:n().e.Name,showExtensionArrow:!e.disabled}):(0,l.jsx)(o(81068).A,{focused:!1,title:(0,l.jsx)(r().sA,{defaultMessage:"Property",id:"database.mobileFilterAndSortMenu.property.buttonMenuItem.label"})});{const t=e.propertySchema&&(0,l.jsx)(o(422164).mA,{propertySchema:e.propertySchema,showIcon:!0,style:{lineHeight:1.4}}),n=(0,l.jsx)(r().sA,{defaultMessage:"Property",id:"database.filterAndSortMenu.propertyButton.label"});return(0,l.jsx)(o(272630).A,{title:t,placeholder:n,onClick:e.onClick,disabled:e.disabled,disableMargins:e.disableMargins,desktopStyle:e.textWrapperStyle})}}},88661:(e,t,o)=>{o.d(t,{A:()=>Q,j:()=>J});o(898992),o(354520),o(581454);var r=o(296540),n=()=>o(726637),l=()=>o(484714),i=()=>o(590526),a=()=>o(401497),s=()=>o(732810),c=()=>o(250910),d=()=>o(420802),p=()=>o(546926),u=()=>o(81068),x=()=>o(764880),f=()=>o(754195);var h=()=>o(431955),g=()=>o(214388),m=()=>o(898244),y=()=>o(713998),v=()=>o(784892),S=()=>o(597777),j=()=>o(681873),C=()=>o(799829),M=()=>o(437607),b=()=>o(69708),A=()=>o(534177),w=()=>o(284371),V=()=>o(436696),T=()=>o(755022),F=()=>o(347302),I=()=>o(554548),_=()=>o(113105),P=()=>o(170356),k=()=>o(933117),O=()=>o(448693),R=()=>o(27356),z=()=>o(272630),D=()=>o(903400),B=()=>o(399762),G=()=>o(79877),U=()=>o(649746),L=()=>o(184979),H=()=>o(249947),E=()=>o(933922),K=()=>o(31511),W=()=>o(100622),$=()=>o(44935),N=()=>o(419357),q=o(474848);const X=(0,b().YK)({value:{defaultMessage:"Value",id:"database.filterAndSort.propertyValueInput.placeholder"}});function Z({value:e,onChange:t}){const o=(0,b().tz)(),l=(0,r.useRef)(null),[i,s]=(0,r.useState)(!1),c=(0,r.useCallback)((()=>s(!0)),[s]),d=(0,r.useCallback)((()=>s(!1)),[s]),p=(0,r.useCallback)((e=>{t(e.target.value)}),[t]),u=(0,r.useCallback)((()=>{if(l.current){var e;(null===(e=window)||void 0===e?void 0:e.document.activeElement)===l.current&&l.current.blur(),d()}}),[d]),x=(0,a().IS)((()=>({focused:{background:W().Tj.buttonHoveredBackground},unfocused:{background:"transparent"}})),[]),f=e||"";return(0,q.jsx)("div",{style:{display:"flex",margin:0,width:"100%",height:"100%",transition:"background 120ms ease-in"},onClick:c,children:n().A.isMobile?(0,q.jsx)(N().Ay,{value:f,onChange:p,placeholder:o.formatMessage(X.value),onBlur:d,rightMobileEditLabel:(0,q.jsx)(b().sA,{defaultMessage:"Edit",id:"database.filterAndSort.mobileEditButton.label"}),textWrapperStyle:{marginInlineStart:48}}):(0,q.jsx)($().H,{action:c,render:e=>(0,q.jsx)("div",{ref:e.ref,onMouseEnter:e.onMouseEnter,style:{...e.focused&&!i?x.focused:x.unfocused,margin:0,width:"100%",height:"100%",transition:"background 120ms ease-in"},children:(0,q.jsx)(E().A,{capture:i,render:e=>(0,q.jsx)("div",{...e,style:{margin:0,width:"100%",height:"100%",transition:"background 120ms ease-in"},children:(0,q.jsx)(K().A,{focus:i,ref:l,value:f,onChange:p,placeholder:o.formatMessage(X.value),onBlur:d,onCancel:u,style:{marginInlineEnd:8,paddingInlineStart:6,paddingInlineEnd:0,width:80,height:30,...{margin:0,width:"100%",height:"100%",transition:"background 120ms ease-in"},minWidth:L().G$}})})})})})})}const Y=(0,b().YK)({dateTitle:{defaultMessage:"Date",id:"database.filterMenu.mobileDateSelectMenu.title"},emptyPlaceholder:{defaultMessage:"Empty",id:"database.filterMenu.dateSelectMenu.emptyPlaceholder"}});function J(e){return e?(0,q.jsx)(b().sA,{defaultMessage:"Select one",id:"database.personPropertyValue.selectPersonOrGroup.searchPlaceholderWithLimit"}):(0,q.jsx)(b().sA,{defaultMessage:"Select as many as you like",id:"database.personPropertyValue.selectPersonOrGroup.searchPlaceholder"})}const Q=function({schema:e,property:t,parentStore:r,filter:l,collectionViewId:i,filterValueType:a,onChange:s,collectionContextStore:d,collectionViewType:p}){const u=(0,b().tz)(),x=(0,q.jsx)("span",{});if("date"===a)return(0,o(335452).n)(l)?(0,g().fZ)(l)?x:(0,g().Cw)(l)?(0,q.jsx)(se,{intl:u,parentStore:r,schema:e,collectionViewId:i,property:t,onChange:s,collectionContextStore:d,collectionViewType:p,filter:l}):(0,q.jsx)(ae,{intl:u,collectionViewId:i,property:t,schema:e,parentStore:r,onChange:s,collectionContextStore:d,collectionViewType:p,filter:l}):x;if("text"===a){if(!(0,o(662149).Y)(l))return x;const e=l;if((0,g().fZ)(e))return x;if("string_has_no_alphabet_prefix"===e.operator)return null;const t=e.value;return(0,q.jsx)(Z,{value:t.value,onChange:t=>{const o={type:"exact",value:t},r={...e,value:o};s(r)}})}if("number"===a){if(!(0,o(343462).M)(l))return x;const e=l;if((0,g().fZ)(e))return x;const t=e.value;return(0,q.jsx)(Z,{value:void 0===t.value?"":t.value.toString(),onChange:t=>{const r={type:"exact",value:(0,o(668766).q)(t,u)},n={...e,value:r};s(n)}})}if("checkbox"===a){if(!(0,g().Ui)(l)||!i)return x;const o=l,a=o.value;return(0,q.jsx)(c().A,{popupType:n().A.isMobile?c().z.SlideUp:c().z.Popup,renderOrigin:e=>(0,q.jsx)(oe,{operatorValue:a,events:e}),render:n=>(0,q.jsx)(H().td,{collectionViewId:i,propertyFilter:{property:t,filter:o},schema:e,onChange:e=>{s(e)},onClose:n.close,parentStore:r,context:H().mL.AdvancedFilter,allowRelativePersonFilter:!0,collectionContextStore:d})})}if("select"===a||"multi_select"===a||"status"===a){if(!((0,g().v0)(l)||(0,g().as)(l)||(0,g().H$)(l))||!i)return x;const o=l;if((0,g().fZ)(o))return x;const a=e[t];if(!a)return x;const p=(0,g().v0)(o)?(0,g().Zl)(o):(0,g().as)(o)?(0,g().SM)(o):(0,g().Wc)(a,(0,g().V6)(o));return(0,q.jsx)(c().A,{popupType:n().A.isMobile?c().z.SlideUp:c().z.Popup,renderOrigin:o=>(0,q.jsx)(ie,{schema:e,property:t,operatorValues:p,events:o}),render:n=>(0,q.jsx)(H().td,{collectionViewId:i,propertyFilter:{property:t,filter:o},schema:e,onChange:e=>{s(e)},onClose:n.close,parentStore:r,context:H().mL.AdvancedFilter,allowRelativePersonFilter:!0,collectionContextStore:d})})}if("location"===a){if(!(0,g().G)(l))return x;const o=l,a=(0,g().GK)(o);return(0,q.jsx)(c().A,{popupType:n().A.isMobile?c().z.SlideUp:c().z.Popup,renderOrigin:e=>(0,q.jsx)(ne,{parentStore:r,operatorValues:a,events:e}),render:n=>(0,q.jsx)(H().td,{collectionViewId:i,propertyFilter:{property:t,filter:o},schema:e,onChange:e=>{s(e)},onClose:n.close,parentStore:r,context:H().mL.AdvancedFilter,allowRelativePersonFilter:!0,collectionContextStore:d})})}if("relation"===a){if(!(0,g().Pq)(l)||!i)return x;const o=l;if((0,g().fZ)(o))return x;const a=(0,g().Rh)(o);return(0,q.jsx)(c().A,{popupType:n().A.isMobile?c().z.SlideUp:c().z.Popup,renderOrigin:o=>(0,q.jsx)(pe,{parentStore:r,operatorValues:a,events:o,schema:e,property:t}),render:n=>(0,q.jsx)(H().td,{collectionViewId:i,propertyFilter:{property:t,filter:o},schema:e,onChange:e=>{s(e)},onClose:n.close,parentStore:r,context:H().mL.AdvancedFilter,allowRelativePersonFilter:!0,collectionContextStore:d})})}if("person"===a){if(!(0,o(478367).I)(l)||!i)return x;const a=l;if((0,g().fZ)(a))return x;const p=(0,o(927826).W)(a);return(0,q.jsx)(c().A,{popupType:n().A.isMobile?c().z.SlideUp:c().z.Popup,renderOrigin:e=>(0,q.jsx)(de,{parentStore:r,operatorValues:p,events:e}),render:o=>(0,q.jsx)(H().td,{collectionViewId:i,propertyFilter:{property:t,filter:a},schema:e,onChange:e=>{s(e)},onClose:o.close,parentStore:r,context:H().mL.AdvancedFilter,allowRelativePersonFilter:!0,collectionContextStore:d})})}if("file"===a){if(!(0,g().B6)(l))return x;const e=l;if((0,g().fZ)(e))return x;(0,A().HB)(e)}if("verification"===a)return(0,g().uU)(l)?(0,q.jsx)(c().A,{popupType:n().A.isMobile?c().z.SlideUp:c().z.Popup,renderOrigin:e=>(0,q.jsx)(re,{operatorValues:(0,g().ms)(l),events:e}),render:o=>(0,q.jsx)(H().td,{collectionViewId:i,propertyFilter:{property:t,filter:l},schema:e,onChange:e=>{s(e)},onClose:o.close,parentStore:r,context:H().mL.AdvancedFilter,allowRelativePersonFilter:!1,collectionContextStore:d})}):x;if("place"===a){if(!(0,g().Ol)(l))return x;const e=l;if((0,g().fZ)(e))return x;(0,A().HB)(e)}(0,A().HB)(a)};function ee(){return{maxWidth:L().tv}}function te(e){return{paddingTop:e?6:void 0,overflow:"hidden"}}function oe({operatorValue:e,events:t}){const o=null==e?void 0:e.value;return(0,q.jsx)(z().A,{...t,disableMargins:!0,placeholder:(0,q.jsx)(b().sA,{defaultMessage:"Select a value",id:"database.filterOperatorValue.checkboxPlaceholder.title"}),title:"boolean"==typeof o&&(0,q.jsx)(d().S,{checked:o,size:16,disabled:!0})})}function re({operatorValues:e,events:t}){const o=e.filter((({value:e})=>Boolean(e))).map(U().w0);return(0,q.jsx)(z().A,{...t,disableMargins:!0,placeholder:(0,q.jsx)(b().sA,{defaultMessage:"Select an option",id:"CollectionFilterMenuFilterOperatorValue.verificationFilterSelect.placeholder"}),title:o.length&&(0,q.jsx)("span",{children:(0,j().G)(o,(e=>(0,q.jsx)("span",{style:{whiteSpace:"pre"},children:(0,q.jsx)(b().sA,{defaultMessage:", ",id:"CollectionFilterMenuFilterOperatorValue.verificationFilterSelect.commaSeparator"})},e)))})})}function ne({operatorValues:e,events:t,parentStore:o}){return(0,q.jsx)(z().A,{...t,disableMargins:!0,desktopStyle:ee(),innerStyle:te(e.length>0),placeholder:(0,q.jsx)(b().sA,{defaultMessage:"Select a location",id:"databaseLocationOperators.selectPlaceholder"}),title:e.length>0&&e.map((e=>e.value&&(0,q.jsx)("div",{style:{marginTop:0,marginInlineEnd:10,marginBottom:6,marginInlineStart:0},children:(0,q.jsx)(F().A,{collectionStore:s().m.createChildStore(o,{table:"collection",id:e.value})})},e.value)))})}function le({operatorValue:e,events:t,isRange:o,schema:r,property:n}){const l=r[n],i=l&&"date"===l.type?l.date_format:void 0;let a;if("exact"===e.type&&e.value)if((0,S().$P)(e.value))a=e.value;else if((0,S().jS)(e.value)){const t=(0,S().dq)(e.value);t&&(a=t.value)}return(0,q.jsx)(z().A,{...t,placeholder:o?(0,q.jsx)(b().sA,{defaultMessage:"Select a range",id:"database.filterAndSort.dateRangePropertyValue.placeholder"}):(0,q.jsx)(b().sA,{defaultMessage:"Select a date",id:"database.filterAndSort.datePropertyValue.placeholder"}),desktopStyle:{minWidth:165},title:a&&(0,q.jsx)("span",{style:{...w().RC},children:(0,q.jsx)(G().A,{value:a,dateFormat:i||S().vz})}),disableMargins:!0})}function ie({operatorValues:e,events:t,schema:o,property:r}){const l=o[r],i=l&&((0,m().lx)(l)||"status"===l.type)&&l.options||[];return(0,q.jsx)(z().A,{...t,disableMargins:!0,desktopStyle:ee(),innerStyle:te(e.length>0),placeholder:(0,q.jsx)(b().sA,{defaultMessage:"Select an option",id:"collections.operatorValueSelect.placeholder"}),title:e.length>0&&(0,q.jsx)(q.Fragment,{children:e.map((e=>{if(void 0===e.value)return null;const t=(0,y().jy)(i,e.value);return t?(0,q.jsx)(B().O,{format:n().A.isMobile?v().NY.Large:v().NY.Medium,isSingle:!1,value:t.value,color:t.color,showRemoveButton:!1},e.value):null}))})})}function ae({filter:e,intl:t,collectionViewId:o,property:r,schema:i,parentStore:a,onChange:s,collectionContextStore:d,collectionViewType:x}){const h=(0,l().v3)();if(!o)return null;const g={menuTitle:t.formatMessage(Y.dateTitle),items:f().ty,getKey:e=>"relative"===e.type?e.value:e.type,selectedItem:e.value,onSelect:t=>{const o={...e,value:t};s(o),d?(0,V().X)({environment:h,collectionContextStore:d,action:"set_filter_value_type"}):(0,T().D)(h,{view_type:x,action:"set_filter_value_type"})},renderItem:e=>(0,q.jsx)(u().A,{title:(0,U().RR)(e.value),...e}),renderOrigin:o=>(0,q.jsx)(z().A,{...o,disableMargins:!0,placeholder:t.formatMessage(Y.emptyPlaceholder),title:(0,U().RR)(e.value)})},m=e.value;if("exact"===m.type){const t=(0,q.jsx)(b().sA,{id:"collectionFilterMenuFilterOperatorValue.date.exact.order",defaultMessage:"{exact}{dateValue}",values:{exact:(0,q.jsx)(k().A,{...g,menuTypeOverride:(0,p().PK)()},"date-filter-value-type"),dateValue:(0,q.jsx)(c().A,{popupType:n().A.isMobile?c().z.SlideUp:c().z.Popup,renderOrigin:e=>(0,q.jsx)(le,{schema:i,property:r,operatorValue:m,events:e,isRange:!1}),render:t=>(0,q.jsx)(H().td,{collectionViewId:o,propertyFilter:{property:r,filter:e},schema:i,onChange:e=>{s(e)},onClose:t.close,parentStore:a,context:H().mL.AdvancedFilter,allowRelativePersonFilter:!0,collectionContextStore:d})})}}),l=h.device.isDesktop?{display:"grid",justifyContent:"stretch",gridTemplateColumns:"1fr 1fr",gridColumnGap:P().NS,width:"100%"}:void 0;return(0,q.jsx)("div",{style:l,children:t})}return(0,q.jsx)(k().A,{...g,menuTypeOverride:(0,p().PK)()},"date-filter-value-type")}function se({filter:e,intl:t,parentStore:o,schema:r,collectionViewId:i,property:a,onChange:s,collectionContextStore:d,collectionViewType:x}){const g=(0,l().v3)();if(!i)return null;const m={menuTitle:t.formatMessage(Y.dateTitle),items:f().py,getKey:e=>(0,h().q)(e),selectedItem:e.value,onSelect:t=>{const o={...e,value:t};s(o),d?(0,V().X)({environment:g,collectionContextStore:d,action:"set_filter_value_type"}):(0,T().D)(g,{view_type:x,action:"set_filter_value_type"})},renderItem:e=>(0,q.jsx)(u().A,{title:(0,U().kz)(e.value),...e}),renderOrigin:o=>(0,q.jsx)(z().A,{...o,disableMargins:!0,placeholder:t.formatMessage(Y.emptyPlaceholder),title:(0,U().kz)(e.value)})},y=e.value;if("exact"===y.type){const t=(0,q.jsx)(b().sA,{id:"collectionFilterMenuFilterOperatorValue.dateRange.exact.order",defaultMessage:"{dateValue}",values:{dateValue:(0,q.jsx)(c().A,{popupType:n().A.isMobile?c().z.SlideUp:c().z.Popup,renderOrigin:e=>(0,q.jsx)(le,{schema:r,property:a,operatorValue:y,events:e,isRange:!0}),render:t=>(0,q.jsx)(H().td,{collectionViewId:i,propertyFilter:{property:a,filter:e},schema:r,onChange:e=>{s(e)},onClose:t.close,parentStore:o,context:H().mL.AdvancedFilter,allowRelativePersonFilter:!0,collectionContextStore:d})})}}),l=g.device.isDesktop?{display:"grid",justifyContent:"stretch",gridTemplateColumns:"1fr 1fr",gridColumnGap:P().NS,width:"100%"}:void 0;return(0,q.jsx)("div",{style:l,children:t})}return"relative"!==y.type||"custom"!==y.value&&"surrounding"!==y.value?(0,q.jsx)(k().A,{...m,menuTypeOverride:(0,p().PK)()},"date-filter-value-type"):(0,q.jsx)(D().i,{renderAsQueryDropdown:n().A.isMobile,filter:y,onUpdate:t=>{const o={...e,value:t};s(o),d?(0,V().X)({environment:g,collectionContextStore:d,action:"set_filter_value_type"}):(0,T().D)(g,{view_type:x,action:"set_filter_value_type"})}})}function ce({operatorValue:e,parentStore:t}){var o;const r=(0,i().K8)((()=>e.value&&("relative"!==e.type||"me"!==e.value)&&(0,x().Pu)(e.value)?(0,x().xC)({pointer:e.value,getRecordValue:t.getRecordValue}):void 0),[e,t]);if(!e.value)return null;if("me"!==e.value&&e.value.table===M().n){const o=(0,M().S4)({spacePermissionGroupId:e.value.id,spaceId:e.value.spaceId});return(0,q.jsx)(R().UISpacePermissionGroupToken,{parentStore:t,groupPointer:o,isSingle:!1,shouldShrink:!1,format:n().A.isMobile?O().t_.Format.Large:O().t_.Format.Medium,showRemoveButton:!1},o.id)}return"relative"===e.type&&"me"===e.value?(0,q.jsx)("span",{style:{marginTop:1,marginInlineEnd:10,marginBottom:6},children:(0,q.jsx)(b().sA,{defaultMessage:"Me",id:"database.filterAndSort.firstPersonPropertyValue.title"},"relative")}):r?(0,q.jsx)(O().Ay,{actor:r,isSingle:!1,shouldShrink:!1,format:n().A.isMobile?O().t_.Format.Large:O().t_.Format.Medium,showRemoveButton:!1,hasPersonHoverCard:!1},null===(o=r.asActor)||void 0===o?void 0:o.id):null}function de({operatorValues:e,events:t,parentStore:o}){return(0,q.jsx)(z().A,{...t,placeholder:J(void 0),disableMargins:!0,desktopStyle:ee(),innerStyle:te(e.length>0),title:e.length>0&&e.map((e=>{var t;return(0,q.jsx)(ce,{operatorValue:e,parentStore:o},`${e.type}__${"me"===e.value?"me":null===(t=e.value)||void 0===t?void 0:t.id}`)}))})}function pe({operatorValues:e,events:t,parentStore:o,schema:r,property:l}){const s=(0,a().DP)(),c=r[l],d=(0,i().K8)((()=>{if(c&&(0,m().nC)(c))return(0,_().LQ)(c,o)}),[c,o]);return(0,q.jsx)(z().A,{...t,disableMargins:!0,desktopStyle:ee(),innerStyle:te(e.length>0),placeholder:(0,q.jsx)(b().sA,{defaultMessage:"Select a page",id:"databaseRelationOperators.selectPlaceholder"}),title:e.length>0&&e.map(((e,t)=>{if(!e.value)return null;const r=e.type,l={isSingle:!1,shouldShrink:!1,format:n().A.isMobile?v().NY.Large:v().NY.Medium};if("exact"===r)return(0,q.jsx)(I().A,{blockId:e.value,parentStore:o,...l},e.value);if("relative"===r){if("builtin"===e.value.type)return d?(0,q.jsx)(v().Ay,{value:(0,q.jsx)(b().sA,{...C().n$[d][e.value.variable].messageDescriptor}),backgroundColor:"transparent",theme:s,...l},t):null;if("current_page_in_related_collection"===e.value.type)return(0,q.jsx)(v().Ay,{value:(0,q.jsx)(b().sA,{defaultMessage:"This page",id:"database.filterAndSort.currentPagePropertyValue.title"}),backgroundColor:"transparent",theme:s,...l},t)}else(0,A().HB)(r)}))})}},170356:(e,t,o)=>{o.d(t,{NS:()=>u,Pq:()=>h,Z3:()=>p,sw:()=>x});o(296540);var r=()=>o(933922),n=()=>o(726637),l=()=>o(245720),i=()=>o(546926),a=()=>o(890492),s=()=>o(424400),c=()=>o(69708),d=o(474848);const p=8,u=8,x=32,f={height:x+p-2,paddingTop:p-2};function h({title:e,helpButton:t,onCancel:o,desktopMinWidth:s,desktopMaxWidth:p,desktopWidth:u,children:x}){return(0,d.jsx)(r().A,{capture:!0,allowEsc:!0,allowUndo:!0,render:r=>{let f;return f=n().A.isMobile?{menuType:i().gu.Modal,title:e,right:(0,d.jsx)(c().sA,{...l().W.done}),onClickRight:o,...r}:{menuType:i().gu.Popup,...s&&{minWidth:s},...p&&{maxWidth:p},...u&&{width:u},...r},(0,d.jsx)(a().A,{...f,header:e&&(0,d.jsx)(g,{title:e,helpButton:t}),children:x})}})}function g({title:e,helpButton:t}){return n().A.isMobile?null:(0,d.jsx)(s().Ay,{style:f,title:e,right:t})}},184979:(e,t,o)=>{o.d(t,{tY:()=>Z,tv:()=>X,G$:()=>q});o(944114),o(898992),o(354520),o(430670),o(581454);var r=o(296540),n=()=>o(726637),l=()=>o(484714),i=()=>o(401497),a=()=>o(245720),s=()=>o(30537),c=()=>o(250910),d=()=>o(118307),p=()=>o(807449),u=()=>o(695115),x=()=>o(546926),f=()=>o(302501),h=()=>o(890492),g=()=>o(81068),m=()=>o(663639),y=()=>o(736847),v=()=>o(214388),S=()=>o(324254),j=()=>o(3284),C=()=>o(764781),M=()=>o(589407),b=()=>o(617668),A=()=>o(904789),w=()=>o(236262),V=()=>o(69708),T=()=>o(100622),F=()=>o(496603),I=()=>o(534177),_=()=>o(436696),P=()=>o(755022),k=()=>o(170356),O=()=>o(274652),R=()=>o(44935),z=()=>o(790515),D=()=>o(649746),B=()=>o(360843),G=()=>o(108791),U=()=>o(933117),L=()=>o(272630),H=o(474848);const E=(0,V().YK)({operatorPlaceholder:{defaultMessage:"Operator",id:"database.filterMenu.operatorPlaceholder"}});function K(e){const{filterOperator:t,onChange:o,disableMargins:r}=e,n=(0,V().tz)(),l={width:"auto",menuTitle:n.formatMessage({defaultMessage:"Operator",id:"database.filterMenu.filterOperatorMenu.title"}),items:v().Ak,getKey:e=>e,selectedItem:t,onSelect:o,renderItem:e=>(0,H.jsx)(g().A,{title:(0,D().Az)(e.value,n),caption:(0,D().YL)(e.value,n),...e}),renderOrigin:e=>(0,H.jsx)(L().A,{...e,title:t&&(0,D().Az)(t,n),placeholder:n.formatMessage(E.operatorPlaceholder),disableMargins:r})};return(0,H.jsx)(U().A,{...l,menuTypeOverride:(0,x().PK)()},"operator")}const W=60,$=120,N=110,q=170,X=400;function Z(e){const{combinatorFilter:t,index:o,level:l,schema:i,onChange:a,parentStore:s,collectionContextStore:c,collectionViewType:d,collectionViewId:p}=e,u=(0,r.useRef)([]),x=(t.filters??[]).flatMap((e=>(0,v().LB)(e)?[]:[e]));return(0,H.jsxs)(H.Fragment,{children:[he(t,l)?void 0:(0,H.jsx)("div",{style:n().A.isMobile?void 0:{display:"grid",gridTemplateColumns:`\n             [boolean-start] ${W}px\n             [boolean-end property-start] minmax(min-content, ${$}px)\n             [property-end operator-start] ${N}px\n             [operator-end value-start] auto\n             [value-end menu-start] ${k().sw}px\n             [menu-end]\n        `,gridAutoRows:`minmax(${k().sw}px, auto)`,gridColumnGap:k().NS,gridRowGap:k().Z3,padding:`${k().Z3}px ${k().NS}px 0 ${k().NS}px`,justifyItems:"stretch",alignItems:"start"},children:x.map(((o,r)=>(0,H.jsx)(Y,{childFilter:o,newIndex:r,schema:i,level:l,combinatorFilter:t,onChange:a,index:e.index,collectionContextStore:c,collectionViewType:d,buttonPopupStores:u.current,parentStore:s,collectionViewId:p},r)))}),(0,H.jsx)(oe,{schema:i,level:l,combinatorFilter:t,onChange:a,index:o,buttonPopupStores:u.current,collectionContextStore:c,collectionViewType:d})]})}function Y(e){const{childFilter:t,newIndex:o,...r}=e;return(0,v().dU)(t)?n().A.isMobile?(0,H.jsx)(te,{childFilter:t,newIndex:o,...r}):(0,H.jsx)(ee,{childFilter:t,newIndex:o,...r}):(0,v().yX)(t)?n().A.isMobile?(0,H.jsx)(Q,{childFilter:t,newIndex:o,...r}):(0,H.jsx)(J,{childFilter:t,newIndex:o,...r}):null}function J(e){const{newIndex:t,childFilter:o}=e;return(0,H.jsxs)(r.Fragment,{children:[(0,H.jsx)(B().A,{index:t,propertyFilter:o,schema:e.schema,filterOperator:(0,H.jsx)(Se,{combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,newIndex:t}),parentStore:e.parentStore,onChange:(t,o)=>ye(t,o,e.combinatorFilter,e.onChange,e.index),collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,collectionViewId:e.collectionViewId},t),(0,H.jsx)(re,{filter:o,indexToChange:t,level:e.level,combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,buttonPopupStores:e.buttonPopupStores})]},t)}function Q(e){const{childFilter:t,newIndex:o}=e;return(0,H.jsxs)(r.Fragment,{children:[(0,H.jsx)(Se,{combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,newIndex:o}),(0,H.jsxs)(y().A,{title:(0,H.jsx)(V().sA,{defaultMessage:"Filter {index}",id:"database.filterMenu.filterIndex",values:{index:o+1}}),children:[(0,H.jsx)(B().A,{index:o,propertyFilter:t,schema:e.schema,filterOperator:null,parentStore:e.parentStore,onChange:(t,o)=>ye(t,o,e.combinatorFilter,e.onChange,e.index),collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,collectionViewId:e.collectionViewId},o),(0,H.jsx)(re,{filter:t,indexToChange:o,level:e.level,combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,buttonPopupStores:e.buttonPopupStores})]})]},o)}function ee(e){const{newIndex:t,childFilter:o}=e,n=(0,i().IS)((()=>({wrapperStyles:{gridColumn:"property-start / value-end",background:T().Tj.background.secondaryTranslucent,borderRadius:6,boxShadow:`0 0 0 1px ${T().Tj.border.secondaryTranslucent}`,margin:1,alignSelf:"stretch"}})),[]);return(0,H.jsxs)(r.Fragment,{children:[(0,H.jsx)(Se,{combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,newIndex:t}),(0,H.jsx)("div",{style:n.wrapperStyles,children:(0,H.jsx)(Z,{index:t,level:e.level+1,combinatorFilter:o,onChange:(t,o)=>ye(t,o,e.combinatorFilter,e.onChange,e.index),parentStore:e.parentStore,schema:e.schema,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,collectionViewId:e.collectionViewId})}),(0,H.jsx)(re,{filter:o,indexToChange:t,level:e.level,combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,buttonPopupStores:e.buttonPopupStores})]},t)}function te(e){const{childFilter:t,newIndex:o}=e,n=(t.filters||[]).length,l=(0,H.jsx)(V().sA,{defaultMessage:"Filter Group {index}",id:"database.filterMenu.filterGroupIndex",values:{index:o+1}});return(0,H.jsxs)(r.Fragment,{children:[(0,H.jsx)(Se,{combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,newIndex:o}),(0,H.jsxs)(y().A,{title:l,children:[(0,H.jsx)(c().A,{buttonPopupStore:se(o,e.buttonPopupStores),popupType:c().z.SlideUp,renderOrigin:o=>(0,H.jsx)(g().A,{focused:!1,...o,showExtensionArrow:!0,right:n.toString(),title:(0,D().Dz)({filter:t,schema:e.schema})}),render:r=>(0,H.jsx)(h().A,{menuType:x().gu.Modal,title:l,left:(0,H.jsx)(V().sA,{...a().W.back}),onClickLeft:r.close,children:(0,H.jsx)(Z,{index:o,level:e.level+1,combinatorFilter:t,onChange:(t,o)=>ye(t,o,e.combinatorFilter,e.onChange,e.index),parentStore:e.parentStore,schema:e.schema,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,collectionViewId:e.collectionViewId})})}),(0,H.jsx)(re,{filter:t,indexToChange:o,level:e.level,combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,buttonPopupStores:e.buttonPopupStores})]})]},o)}function oe(e){const t=(0,l().v3)(),{schema:o,level:r,combinatorFilter:a,onChange:d,index:u,buttonPopupStores:x,collectionContextStore:f,collectionViewType:h}=e,g=(0,i().IS)((()=>({buttonMenuItemStyles:{height:32}})),[]);return n().A.isMobile?(0,H.jsxs)(y().A,{topBorder:he(a,r),children:[(0,H.jsx)(ge,{props:{onClick:()=>ve(t,o,a,d,u,f,h)}}),ue(e.level)?(0,H.jsx)(me,{props:{onClick:()=>ie(t,o,a,d,u,f,h,x)}}):void 0]}):ue(r)?(0,H.jsx)(y().A,{topBorder:he(a,r),children:(0,H.jsx)(c().A,{alignmentToOrigin:"start",popupType:s().n.Popup,renderOrigin:e=>(0,H.jsx)(R().H,{action:()=>e.onClick(),render:t=>{const{focused:o,...r}=t;return(0,H.jsx)(O().o,{...e,...r,focused:o,color:"secondary",style:g.buttonMenuItemStyles,title:(0,H.jsxs)("div",{style:{display:"flex",gap:6,alignItems:"center"},children:[(0,H.jsx)(G().Kp,{}),(0,H.jsx)(p().I,{icon:S().arrowChevronSingleDownSmallIcon,size:"xs",colorVariant:"secondary"})]})})}}),render:e=>(0,H.jsx)(m().A,{type:m().O.Vertical,initialFocus:0,sections:[{key:"actions",render:e=>(0,H.jsx)(y().A,{...e}),items:[{key:"add_filter",render:e=>(0,H.jsx)(ge,{props:e}),action:r=>{e.close(),ve(t,o,a,d,u,f,h)}},{key:"add_filter_group",render:e=>(0,H.jsx)(me,{props:e}),action:r=>{e.close(),ie(t,o,a,d,u,f,h,x)}}]}]})})}):(0,H.jsx)(y().A,{topBorder:he(a,r),children:(0,H.jsx)(R().H,{action:()=>ve(t,e.schema,e.combinatorFilter,e.onChange,e.index,e.collectionContextStore,e.collectionViewType),render:e=>{const{focused:r,...n}=e;return(0,H.jsx)(O().o,{...n,focused:e.focused,color:"secondary",style:g.buttonMenuItemStyles,onClick:()=>ve(t,o,a,d,u,f,h),title:(0,H.jsx)(G().Kp,{})})}})})}function re(e){const t=(0,V().tz)();return n().A.isMobile?(0,H.jsx)(ne,{filter:e.filter,indexToChange:e.indexToChange,level:e.level,parent:void 0,combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,buttonPopupStores:e.buttonPopupStores,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType}):(0,H.jsx)(c().A,{popupType:s().n.Popup,renderOrigin:e=>(0,H.jsx)(R().H,{action:()=>e.onClick(),render:e=>(0,H.jsx)(u().A,{...e,hovered:e.focused,style:{width:"100%"},size:"lg",icon:M().ellipsisIcon,ariaLabel:t.formatMessage({id:"collections.CollectionFilterCombinatorGrid.RowActions.threeDotActionMenu",defaultMessage:"Edit filter actions"})})}),render:t=>(0,H.jsx)(ne,{filter:e.filter,indexToChange:e.indexToChange,level:e.level,parent:t,combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,buttonPopupStores:e.buttonPopupStores,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType})})}function ne(e){const{filter:t,indexToChange:o,parent:r}=e,i=(0,l().v3)(),a=(0,v().dU)(t),s=a?(0,H.jsx)(V().sA,{defaultMessage:"Remove",id:"database.filterMenu.removeFilterGroupMenuTitle"}):(0,H.jsx)(V().sA,{defaultMessage:"Remove",id:"database.filterMenu.removeFilterMenuTitle"}),c=a?(0,H.jsx)(V().sA,{defaultMessage:"Duplicate",id:"database.filterMenu.duplicateFilterGroupMenuTitle"}):(0,H.jsx)(V().sA,{defaultMessage:"Duplicate",id:"database.filterMenu.duplicateFilterMenuTitle"}),d=[{key:"delete",action:()=>{var t,n,l,i,a;r&&r.close(),t=o,n=e.buttonPopupStores,l=e.combinatorFilter,i=e.onChange,a=e.index,fe((e=>e.splice(t,1)),l,i,a),se(t,n).reset(),n.splice(t,1)},render:e=>(0,H.jsx)(g().A,{...e,icon:(0,H.jsx)(p().I,{icon:w().trashIcon}),isRedOnHover:!0,title:s})},{key:"duplicate",action:()=>{r&&r.close(),function(e,t,o,r,n,l,i){fe((t=>{const o=t[e];if(o){const r={...o};t.splice(e,0,r)}}),t,o,r),n?(0,_().X)({environment:i,collectionContextStore:n,action:"add_filter_group"}):(0,P().D)(i,{view_type:l,action:"duplicate_filter"})}(o,e.combinatorFilter,e.onChange,e.index,e.collectionContextStore,e.collectionViewType,i)},render:e=>(0,H.jsx)(g().A,{...e,icon:(0,H.jsx)(p().I,{icon:C().V}),title:c})}];if((0,v().yX)(t)&&ue(e.level)&&d.push({key:"turn_into_group",action:()=>{r&&r.close(),le(i,o,t,e.combinatorFilter,e.onChange,e.index,e.buttonPopupStores,e.collectionContextStore,e.collectionViewType)},render:e=>(0,H.jsx)(g().A,{...e,icon:(0,H.jsx)(p().I,{icon:j().arrowSquarePathUpDownIcon}),title:(0,H.jsx)(V().sA,{defaultMessage:"Turn into group",id:"database.filterMenu.turnIntoGroupMenuTitle"})})}),(0,v().dU)(t)&&t.filters&&1===t.filters.length){const n=(0,v().dU)(t.filters[0])?(0,H.jsx)(V().sA,{defaultMessage:"Unwrap group",id:"database.filterMenu.unwrapGroupMenuTitle"}):(0,H.jsx)(V().sA,{defaultMessage:"Turn into filter",id:"database.filterMenu.turnIntoFilterMenuTitle"});d.push({key:"turn_into_filter",action:()=>{r&&r.close(),function(e,t,o,r,n,l,i,a){const s=(t.filters||[])[0];s&&!(0,v().LB)(s)&&ye(e,s,r,n,l);i?(0,_().X)({environment:o,collectionContextStore:i,action:"turn_into_filter"}):(0,P().D)(o,{view_type:a,action:"turn_into_filter"})}(o,t,i,e.combinatorFilter,e.onChange,e.index,e.collectionContextStore,e.collectionViewType)},render:e=>(0,H.jsx)(g().A,{...e,icon:(0,H.jsx)(p().I,{icon:j().arrowSquarePathUpDownIcon}),title:n})})}const u=ce(t);return(0,v().dU)(t)&&e.level+u+1<3&&d.push({key:"wrap_in_group",action:()=>{r&&r.close(),le(i,o,t,e.combinatorFilter,e.onChange,e.index,e.buttonPopupStores,e.collectionContextStore,e.collectionViewType)},render:e=>(0,H.jsx)(g().A,{...e,icon:(0,H.jsx)(p().I,{icon:j().arrowSquarePathUpDownIcon}),title:(0,H.jsx)(V().sA,{defaultMessage:"Wrap in group",id:"database.filterMenu.wrapInGroupMenuTitle"}),caption:(0,H.jsx)(V().sA,{defaultMessage:"Create a filter group around this",id:"database.filterMenu.wrapInGroupMenuCaption"})})}),(0,H.jsx)(m().A,{initialFocus:n().A.isMobile?void 0:0,type:m().O.Vertical,sections:[{key:"actions",render:n().A.isMobile?e=>(0,H.jsx)("div",{...e}):e=>(0,H.jsx)(y().A,{...e}),items:d}]})}function le(e,t,o,r,n,l,i,a,s){ye(t,{operator:pe(r),filters:[o]},r,n,l),ae(t,i),a?(0,_().X)({environment:e,collectionContextStore:a,action:"turn_into_filter_group"}):(0,P().D)(e,{view_type:s,action:"turn_into_filter_group"})}function ie(e,t,o,r,n,l,i,a){const s=xe(t,o),c={operator:pe(o),filters:[s]};ae(fe((e=>e.push(c)),o,r,n)-1,a),l?(0,_().X)({environment:e,collectionContextStore:l,action:"add_filter_group"}):(0,P().D)(e,{view_type:i,action:"add_filter_group"})}function ae(e,t){se(e,t).setState({open:!0})}function se(e,t){for(;t.length<e+1;){const e=new(d().A);t.push(e)}return t[e]}function ce(e){if((0,v().dU)(e)){const t=(e.filters||[]).filter(v().dU);return 1+(F().T9(t.map(ce))||0)}return 0}function de(e){const{operator:t,lowercase:o}=e;return"or"===t?o?(0,H.jsx)(V().sA,{id:"collectionFilterCombinatorGrid.filterOperator.or.lowercase",defaultMessage:"or"}):(0,H.jsx)(V().sA,{id:"collectionFilterCombinatorGrid.filterOperator.or",defaultMessage:"Or"}):"and"===t?o?(0,H.jsx)(V().sA,{id:"collectionFilterCombinatorGrid.filterOperator.and.lowercase",defaultMessage:"and"}):(0,H.jsx)(V().sA,{id:"collectionFilterCombinatorGrid.filterOperator.and",defaultMessage:"And"}):(0,I().HB)(t)}function pe(e){return"or"===e.operator?"and":"or"}function ue(e){return e<2}function xe(e,t){const o=(t.filters||[]).filter(v().yX),r=o[o.length-1];return r?F().mg(r):(0,z().MI)(e)}function fe(e,t,o,r){const n=[...t.filters||[]],l=e(n);return o(r,{...t,filters:n}),l}function he(e,t){return(0,v().U0)(e)&&0===t}function ge({props:e}){const t=(0,H.jsx)(p().I,{icon:b().plusIcon});return(0,H.jsx)(g().A,{focused:!1,...e,icon:t,title:(0,H.jsx)(G().Kp,{})})}function me({props:e}){const t=(0,H.jsx)(p().I,{icon:A().squareOnSquarePlusIcon});return(0,H.jsx)(g().A,{focused:!1,...e,icon:t,title:(0,H.jsx)(V().sA,{defaultMessage:"Add filter group",id:"database.filterMenu.addFilterGroup2ButtonTitle"}),caption:(0,H.jsx)(V().sA,{defaultMessage:"A group to nest more filters",id:"database.filterMenu.addFilterGroupButtonCaption"})})}function ye(e,t,o,r,n){fe((o=>o.splice(e,1,t)),o,r,n)}function ve(e,t,o,r,n,l,i){const a=xe(t,o);fe((e=>e.push(a)),o,r,n),l?(0,_().X)({environment:e,collectionContextStore:l,action:"add_filter"}):(0,P().D)(e,{view_type:i,action:"add_filter"})}function Se({newIndex:e,combinatorFilter:t,onChange:o,index:r,collectionContextStore:i,collectionViewType:a}){const s=(0,l().v3)(),c=t.operator,d={justifySelf:"end"},p={...d,lineHeight:"32px",paddingInlineEnd:4};if(0===e)return n().A.isMobile?null:(0,H.jsx)(f().A,{style:p,children:(0,H.jsx)(V().sA,{defaultMessage:"Where",id:"database.filterMenu.where"})});if(1===e){const e=(0,H.jsx)(K,{disableMargins:!0,filterOperator:c,onChange:e=>function(e,t,o,r,n,l,i){r(n,{...o,operator:e}),l?(0,_().X)({environment:t,collectionContextStore:l,action:"set_filter_operator"}):(0,P().D)(t,{view_type:i,action:"set_filter_operator"})}(e,s,t,o,r,i,a)});return n().A.isMobile?(0,H.jsx)(y().A,{children:e}):(0,H.jsx)("div",{style:d,children:e})}return n().A.isMobile?null:(0,H.jsx)(f().A,{style:p,children:(0,H.jsx)(de,{operator:c})})}},314638:(e,t,o)=>{o.d(t,{G:()=>a,e:()=>i});var r=o(296540),n=()=>o(401497),l=o(474848);let i=function(e){return e[e.Name=0]="Name",e}({});const a=r.forwardRef((function(e,t){const{propertySchema:r,format:a}=e,{name:s,type:c,icon:d}=r,p=(0,n().IS)((()=>({propertyIcon:{fill:o(100622).Tj.icon.primary,marginInlineStart:6,marginInlineEnd:2}})),[]),u=(0,n().DP)(),x=a===i.Name?s:o(680288).dC[c];return(0,l.jsx)(o(81068).A,{title:x,icon:(0,l.jsx)(o(852424).zB,{icon:d,type:c,size:o(726637).A.isMobile?18:16,theme:u,style:p.propertyIcon}),...e})}))},360843:(e,t,o)=>{o.d(t,{A:()=>z});o(898992),o(354520),o(737550);var r=o(296540),n=()=>o(726637),l=()=>o(484714),i=()=>o(590526),a=()=>o(250910),s=()=>o(927826),c=()=>o(478367),d=()=>o(214388),p=()=>o(43864),u=()=>o(713998),x=()=>o(69708),f=()=>o(436696),h=()=>o(755022),g=()=>o(649746),m=()=>o(383036),y=()=>o(546926),v=()=>o(26697),S=()=>o(302501),j=()=>o(81068),C=()=>o(754195),M=()=>o(93745),b=()=>o(404070),A=()=>o(933117),w=()=>o(272630),V=o(474848);function T(e){const{filter:t}=e,o=(0,x().tz)(),r={width:190,menuTitle:o.formatMessage({defaultMessage:"Date Options",id:"database.filterMenu.mobileDateFilterModeMenu.title"}),items:C().$N,selectedItem:(0,M().C)(t),getKey:e=>e,onSelect:o=>{const r={...t,use_end:(0,b().Z)(o)};e.onChange(r)},renderItem:e=>(0,V.jsx)(v().m,{renderTooltip:()=>(0,g().WG)(e.value),render:t=>(0,V.jsx)(j().A,{title:(0,g().h0)(e.value),...(0,m().A)(e,t)}),placement:"right",textWrap:!0,style:{width:"260px"}}),renderOrigin:e=>(0,V.jsx)(w().A,{...e,placeholder:o.formatMessage({defaultMessage:"Date Options",id:"database.filterMenu.dateFilterModeMenu.label"}),title:(0,V.jsx)(S().A,{children:(0,g().h0)((0,M().C)(t))}),disableMargins:!0,desktopStyle:{width:"100px"}})};return(0,V.jsx)(A().A,{...r,menuTypeOverride:(0,y().PK)()},"date-filter-mode")}var F=()=>o(568063),I=()=>o(170356);function _(e){const t=(0,l().v3)(),o=(0,x().tz)(),{filterValueType:r,filter:n}=e,i=(0,d().U6)({filterValueType:r}),a={width:190,menuTitle:o.formatMessage({defaultMessage:"Comparator",id:"database.filterMenu.mobileComparatorValueMenu.title"}),items:i,selectedItem:n.operator,getKey:e=>e,onSelect:o=>{const l=(0,g().iI)(r,n,o,"combinator");e.onChange(l),e.collectionContextStore?(0,f().X)({environment:t,collectionContextStore:e.collectionContextStore,action:"set_filter_comparator"}):(0,h().D)(t,{view_type:e.collectionViewType,action:"set_filter_comparator"})},renderItem:e=>(0,V.jsx)(j().A,{title:(0,g().J)(e.value),...e}),renderOrigin:e=>(0,V.jsx)(w().A,{...e,placeholder:o.formatMessage({defaultMessage:"Comparator",id:"database.filterMenu.comparatorMenuDropdownButton.label"}),title:(0,V.jsx)(S().A,{children:(0,g().J)(n.operator)}),disableMargins:!0})};return(0,V.jsx)(A().A,{...a,menuTypeOverride:(0,y().PK)()},"comparator")}var P=()=>o(88661);const k=(0,x().YK)({setFilter:{defaultMessage:"Set filter",id:"database.filterMenu.rollupPropertyValue.mobileMenu.title"}});function O(e){const t=(0,x().tz)();if((0,d().s1)(e.filter))return(0,V.jsx)(R,{intl:t,onChange:e.onChange,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,property:e.property,schema:e.schema,parentStore:e.parentStore,collectionViewId:e.collectionViewId,filter:e.filter});const o=(0,d().HF)({schema:e.schema,property:e.property,getRecordModel:e.parentStore.getRecordModel});if(!(0,d().$S)(o,e.filter)){const t=(0,g().xt)(o);return(0,V.jsxs)(r.Fragment,{children:[(0,V.jsx)(_,{filterValueType:o,filter:t,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,onChange:e.onChange}),(0,V.jsx)(P().A,{filterValueType:o,filter:t,schema:e.schema,property:e.property,parentStore:e.parentStore,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,collectionViewId:e.collectionViewId,onChange:e.onChange})]})}const l=(0,V.jsx)(x().sA,{...g().Jk[o],values:{property:(0,V.jsx)(x().sA,{id:"collectionFilterMenuFilter.property.name",defaultMessage:"Property"}),operator:(0,V.jsx)(_,{filterValueType:o,filter:e.filter,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,onChange:e.onChange}),operatorValue:(0,V.jsx)(P().A,{filterValueType:o,filter:e.filter,schema:e.schema,property:e.property,parentStore:e.parentStore,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,collectionViewId:e.collectionViewId,onChange:e.onChange})}});return n().A.isMobile?l:(0,V.jsx)("div",{style:{alignItems:"center",display:"grid",gridAutoFlow:"column",gridAutoColumns:"1fr",gridColumnEnd:e.isArrayFilter?void 0:"span 2",gridColumnGap:`${I().NS}px`,gridTemplateRows:`${I().sw}px`,gridTemplateColumns:"[value-start] max-content auto [value-end operator-start] auto"},children:l})}function R({filter:e,intl:t,onChange:o,collectionContextStore:a,collectionViewType:s,property:c,schema:p,parentStore:u,collectionViewId:x}){const m=(0,l().v3)(),v={menuTitle:t.formatMessage(k.setFilter),items:d().$X,getKey:e=>e,selectedItem:e.operator,onSelect:t=>{const r={...e,operator:t};o(r),a?(0,f().X)({environment:m,collectionContextStore:a,action:"set_rollup_set_filter"}):(0,h().D)(m,{view_type:s,action:"set_rollup_set_filter"})},renderItem:e=>(0,V.jsx)(j().A,{title:(0,g().wE)(e.value,t),...e}),renderOrigin:o=>(0,V.jsx)(w().A,{...o,placeholder:t.formatMessage(k.setFilter),title:(0,g().wE)(e.operator,t),disableMargins:!0,desktopStyle:{minWidth:70}})},{targetProperty:S,targetCollectionSchema:C}=(0,i().K8)((()=>{var e;if("rollup"===(null==p||null===(e=p[c])||void 0===e?void 0:e.type)){var t;const e=null===(t=u.pointer)||void 0===t?void 0:t.spaceId;if(!e)return{targetProperty:void 0,targetCollectionSchema:void 0};const o=m.idCreator.getSpaceIdCreatorSync(e),r=(0,F().eY)({schema:p,property:c,getRecordModel:u.getRecordModel,spaceIdCreator:o});return"person"===(null==r?void 0:r.rollupType)?{targetProperty:void 0,targetCollectionSchema:void 0}:{targetProperty:null==r?void 0:r.targetProperty,targetCollectionSchema:null==r?void 0:r.targetCollectionSchema}}return{targetProperty:c,targetCollectionSchema:p}}),[c,p,u,m]);if(!S||!C)return(0,V.jsx)("div",{style:{gridColumnEnd:"span 2"}});const M=(0,V.jsxs)(r.Fragment,{children:[(0,V.jsx)(A().A,{...v,menuTypeOverride:(0,y().PK)()},"set_filter"),(0,V.jsx)(O,{collectionViewId:x,filter:e.subfilter,schema:C,property:S,parentStore:u,collectionContextStore:a,collectionViewType:s,onChange:t=>{const r={...e,subfilter:t};o(r)},isArrayFilter:!0})]});return n().A.isMobile?M:(0,V.jsx)("div",{style:{display:"grid",gridAutoFlow:"column",gridAutoColumns:"1fr",gridColumnEnd:"span 2",gridColumnGap:`${I().NS}px`,gridTemplateColumns:"max-content",gridTemplateRows:`${I().sw}px`},children:M})}const z=function({schema:e,propertyFilter:t,parentStore:m,index:y,collectionContextStore:v,collectionViewType:S,onChange:j,filterOperator:C,collectionViewId:M,disablePropertyChange:b=!1}){const A=(0,l().v3)(),w=(0,u()._g)({schema:e,property:t.property}),F=(0,i().K8)((()=>{const e=null==v?void 0:v.collectionViewStore();return null==e?void 0:e.getCollectionSource()}),[v]),I=(0,i().K8)((()=>(0,d().tn)(e,t.property,t.filter,m.getRecordModel)),[m,t,e]);if(!w)return null;if(!I)return null;const _=(0,o(335452).n)(t.filter)&&(0,d().gc)(t.filter)&&(0,o(359889).q)(w),P=_?{width:"120px",marginInlineEnd:"4px"}:{},k=(0,V.jsxs)(r.Fragment,{children:[(0,V.jsx)(a().A,{popupType:n().A.isMobile?a().z.SlideUp:a().z.Popup,renderOrigin:e=>(0,V.jsx)(o(55043).A,{...e,propertySchema:w,disableMargins:!0,disabled:b,textWrapperStyle:{width:"100%",...P}}),disabled:b,render:r=>(0,V.jsx)(o(787815).A,{isRelationProperty:!1,schema:e,onAccept:o=>function(e,t,o,r,n,l,i,a,u){const{property:x,filter:m}=r,y=o[x],v=o[e],S={property:e,filter:m},j=v&&(0,d().tn)(o,e,m,n.getRecordModel),C=v&&"relation"===v.type&&x!==e,M=y&&("created_by"===y.type||"last_edited_by"===y.type)&&v&&"person"===v.type,b=(0,c().I)(m)&&!(0,d().fZ)(m)&&(0,s().W)(m).some((e=>"exact"===e.type&&e.value&&"bot"===e.value.table));var A;(!j||C||M&&b||!(0,p().hs)(S,o))&&(S.filter=(0,g().SN)({schema:o,property:e,getRecordModel:n.getRecordModel,spaceIdCreator:t.idCreator.getSpaceIdCreatorSync((null===(A=n.pointer)||void 0===A?void 0:A.spaceId)??"")}));null==u||u(l,S),i?(0,f().X)({environment:t,collectionContextStore:i,action:"set_filter_property"}):(0,h().D)(t,{view_type:a,action:"set_filter_property"})}(o,A,e,t,m,y,v,S,j),onClose:r.close,allowProperty:e=>(0,u().ah)(e,F)})}),_?(0,V.jsx)(T,{filter:t.filter,onChange:e=>{const o={...t,filter:e};null==j||j(y,o)}}):void 0]});return(0,V.jsxs)(r.Fragment,{children:[C,n().A.isMobile?k:(0,V.jsx)("div",{style:{display:"flex"},children:k}),(0,V.jsx)(x().sA,{id:"collectionFilterMenuRow.propertyConjunction.label",defaultMessage:" "}),(0,V.jsx)(O,{filter:t.filter,schema:e,property:t.property,parentStore:m,collectionViewId:M,collectionContextStore:v,collectionViewType:S,onChange:e=>{const o={...t,filter:e};null==j||j(y,o)},isArrayFilter:!1})]})}},738508:(e,t,o)=>{o.r(t),o.d(t,{cursorIcon:()=>l,iconDefinition:()=>n});o(296540);var r=o(474848);const n={viewBox:"0 0 20 20",fittedViewBox:"1.25 0 17.5 20",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("g",{className:"logo-light-mode",children:[(0,r.jsxs)("g",{clipPath:"url(#clip0_16020_205)",children:[(0,r.jsx)("path",{fill:"#757575",d:"m9.995 9.987 8.658 4.999a.6.6 0 0 1-.226.226l-8.092 4.672a.68.68 0 0 1-.68 0l-8.092-4.672a.6.6 0 0 1-.226-.226z"}),(0,r.jsx)("path",{fill:"#525252",d:"M9.995 0v9.987l-8.658 4.999a.6.6 0 0 1-.082-.309v-9.38c0-.22.117-.424.308-.534L9.655.09a.7.7 0 0 1 .34-.09"}),(0,r.jsx)("path",{fill:"#404040",d:"M18.652 4.989a.6.6 0 0 0-.225-.226L10.334.09A.7.7 0 0 0 9.995 0v9.987l8.658 4.999a.6.6 0 0 0 .083-.309v-9.38c0-.11-.03-.216-.083-.308"}),(0,r.jsx)("path",{fill:"#D9D9D9",d:"M18.047 5.339a.29.29 0 0 1 0 .29l-7.859 13.61c-.053.093-.193.055-.193-.05v-8.97a.4.4 0 0 0-.054-.201z"}),(0,r.jsx)("path",{fill:"#fff",d:"m18.047 5.339-8.106 4.68a.4.4 0 0 0-.147-.147L2.027 5.387c-.092-.053-.054-.193.052-.193h15.717c.111 0 .202.06.25.145"})]}),(0,r.jsx)("defs",{children:(0,r.jsx)("clipPath",{id:"clip0_16020_205",children:(0,r.jsx)("path",{fill:"#fff",d:"M1.255 0h17.49v20H1.256z"})})})]}),(0,r.jsxs)("g",{className:"logo-dark-mode",children:[(0,r.jsxs)("g",{clipPath:"url(#clip0_16020_213)",children:[(0,r.jsx)("path",{fill:"#6E6E6E",d:"m9.995 9.987 8.658 4.999a.6.6 0 0 1-.226.226l-8.092 4.672a.68.68 0 0 1-.68 0l-8.092-4.672a.6.6 0 0 1-.226-.226z"}),(0,r.jsx)("path",{fill:"#4A4A4A",d:"M9.995 0v9.987l-8.658 4.999a.6.6 0 0 1-.082-.309v-9.38c0-.22.117-.424.308-.534L9.655.09a.7.7 0 0 1 .34-.09"}),(0,r.jsx)("path",{fill:"#383838",d:"M18.652 4.989a.6.6 0 0 0-.225-.226L10.334.09A.7.7 0 0 0 9.995 0v9.987l8.658 4.999a.6.6 0 0 0 .083-.309v-9.38c0-.11-.03-.216-.083-.308"}),(0,r.jsx)("path",{fill:"#C9C9C9",d:"M18.047 5.339a.29.29 0 0 1 0 .29l-7.859 13.61c-.053.093-.193.055-.193-.05v-8.97a.4.4 0 0 0-.054-.201z"}),(0,r.jsx)("path",{fill:"#fff",d:"m18.047 5.339-8.106 4.68a.4.4 0 0 0-.147-.147L2.027 5.387c-.092-.053-.054-.193.052-.193h15.717c.111 0 .202.06.25.145"})]}),(0,r.jsx)("defs",{children:(0,r.jsx)("clipPath",{id:"clip0_16020_213",children:(0,r.jsx)("path",{fill:"#fff",d:"M1.255 0h17.49v20H1.256z"})})})]})]})},l=(0,o(340498).wt)("cursor",n,"default")},787815:(e,t,o)=>{o.d(t,{A:()=>h});o(898992),o(354520),o(581454),o(737550);var r=o.n(o(844751)),n=o(296540),l=()=>o(726637),i=()=>o(546926),a=()=>o(663639),s=()=>o(736847),c=()=>o(898244),d=()=>o(713998),p=()=>o(69708),u=()=>o(496603),x=()=>o(314638),f=o(474848);const h=function({selectedProperty:e,onAccept:t,schema:h,onClose:g,allowProperty:m,isRelationProperty:y}){const v=(0,p().tz)(),[S,j]=(0,n.useState)("");let C=Object.keys(h);const M=C.some(o(443239).u);C=u().Ul(C,(e=>{const t=(0,d()._g)({schema:h,property:e});return t?t.name:""}));const b=M?c().Ho:c().rn;if(C=u().FF(C,b),C.unshift(b),m&&(C=C.filter((e=>{const t=(0,d()._g)({schema:h,property:e});return t&&m(t)}))),S){let e=C.map((e=>{const t=(0,d()._g)({schema:h,property:e});return t&&t.name}));e=r().filter(S,e).map((({original:e})=>e)),C=C.filter((t=>{const o=(0,d()._g)({schema:h,property:t});return o&&o.name&&e.includes(o.name)}))}const A=S||C.length>o(527438).R8,w=u().oE(C.map((o=>{const r=(0,d()._g)({schema:h,property:o});if(!r)return null;return{key:o,render:t=>(0,f.jsx)(x().G,{...t,propertySchema:r,format:x().e.Name,isChecked:o===e}),action:()=>t(o)}}))),V=[{key:0,render:e=>(0,f.jsx)(s().A,{...e}),items:w}],T=A?(0,f.jsx)(s().A,{isInput:!0,children:(0,f.jsx)(o(419357).Ay,{focus:!l().A.isMobile||void 0,focusAfterAnimation:!0,value:S,onChange:e=>j(e.target.value),placeholder:y?v.formatMessage({defaultMessage:"Search for a relation property…",id:"propertySelectMenu.searchForProperty.relation.placeholder"}):v.formatMessage({defaultMessage:"Search for a property…",id:"propertySelectMenu.searchForProperty.default.placeholder"})})}):null;let F;return F=l().A.isMobile?{menuType:i().gu.Modal,title:y?v.formatMessage({defaultMessage:"Relation property",id:"propertySelectMenu.mobileMenu.relationProperty.header"}):v.formatMessage({defaultMessage:"Property",id:"propertySelectMenu.mobileMenu.property.header"}),right:(0,f.jsx)(p().sA,{...o(245720).W.cancel}),onClickRight:g,header:T}:{menuType:i().gu.Popup,width:280,maxHeight:480,header:T},(0,f.jsx)(o(890492).A,{...F,children:0===w.length?(0,f.jsx)(s().A,{children:(0,f.jsx)(o(449279).u,{title:(0,f.jsx)(p().sA,{defaultMessage:"No results",id:"propertySelectMenu.search.noResults.title"})})}):(0,f.jsx)(a().A,{type:a().O.Vertical,sections:V,onAccept:g,initialFocus:S.length>0?0:void 0})})}},904789:(e,t,o)=>{o.r(t),o.d(t,{iconDefinition:()=>n,squareOnSquarePlusIcon:()=>l});o(296540);var r=o(474848);const n={viewBox:"0 0 20 20",fittedViewBox:"2.37 2.37 15.51 15.51",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{d:"M12 8.875c.345 0 .625.28.625.625v1.875H14.5a.625.625 0 1 1 0 1.25h-1.875V14.5a.625.625 0 1 1-1.25 0v-1.875H9.5a.625.625 0 1 1 0-1.25h1.875V9.5c0-.345.28-.625.625-.625"}),(0,r.jsx)("path",{d:"M4.5 2.375A2.125 2.125 0 0 0 2.375 4.5V12c0 1.174.951 2.125 2.125 2.125h1.625v1.625c0 1.174.951 2.125 2.125 2.125h7.5a2.125 2.125 0 0 0 2.125-2.125v-7.5a2.125 2.125 0 0 0-2.125-2.125h-1.625V4.5A2.125 2.125 0 0 0 12 2.375zm8.375 3.75H8.25A2.125 2.125 0 0 0 6.125 8.25v4.625H4.5A.875.875 0 0 1 3.625 12V4.5c0-.483.392-.875.875-.875H12c.483 0 .875.392.875.875zm-5.5 2.125c0-.483.392-.875.875-.875h7.5c.483 0 .875.392.875.875v7.5a.875.875 0 0 1-.875.875h-7.5a.875.875 0 0 1-.875-.875z"})]})},l=(0,o(340498).wt)("squareOnSquarePlus",n,"default")}}]);