"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[34974,63717],{260513:(e,t,n)=>{n.r(t),n.d(t,{collectMentionUserIds:()=>v,fetchExtendedUserProfile:()=>g,prefetchExtendedUserProfiles:()=>h,prefetchMentionedUserProfiles:()=>f});n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(354520),n(672577);var i=()=>n(230711),o=()=>n(929219),r=()=>n(351776),s=()=>n(848538),a=()=>n(798880),l=()=>n(201980),d=()=>n(496603),c=()=>n(498212);class u{constructor(e,t,n,i){this.pendingInvocations=new Map,this.fn=e,this.coalesce=t,this.waitMs=n,this.options=i}enqueue(e){for(const[n,i]of this.pendingInvocations){const t=this.coalesce(n,e);if(t)return this.pendingInvocations.delete(n),this.pendingInvocations.set(t,i),void i.dequeueDebounced(t)}const t=(0,d().sg)(this.dequeue.bind(this),this.waitMs,this.options);this.pendingInvocations.set(e,{dequeueDebounced:t}),t(e)}dequeue(e){this.pendingInvocations.delete(e),this.fn.apply(null,e)}}var p=()=>n(683e3);const m=10;async function g(e){const{viewedUserId:t,actorUserId:n,spaceStore:o,store:s,environment:a}=e;if(!s.isRefetchThrottleReady())return;const l=(0,i().dp)(o,t),c=(0,i().dp)(o,n);if(!(0,r().$)(l.getMembershipType())||!(0,r().n)(c.getMembershipType()))return;const u=await a.api.callCellCompatibleApi({eventName:"getExtendedUserProfiles",environment:a,data:{userIds:[t],spaceId:o.id,includePermissionGroupMemberCounts:!1},cellNavigation:{spaceId:o.id}});if("failed"===u.type)throw u.error;u.type;const m=(0,p().ed)(u.data).find((e=>e.userId===t));m&&((0,d().n4)(m,s.state)||s.setState(m))}const h=function(e,t,n,i){const o=new u(e,t,n,i);return(...e)=>o.enqueue(e)}((async function(e,t){const{spaceStore:i,actorUserId:o}=e,a=i.id,l=e.viewedUserIds.filter((e=>!(0,p().Of)({spaceId:a,actorUserId:o,viewedUserId:e})));if(0===l.length)return;const c=n(76549).VF.createChildStore(i,{id:(0,s().i1)({userId:o,spaceId:a}).id,table:s().aJ,spaceId:a});if(!(0,r().n)(c.getMembershipType()))return;const u=await t.api.callCellCompatibleApi({environment:t,eventName:"getExtendedUserProfiles",data:{spaceId:a,userIds:l,includePermissionGroupMemberCounts:!1},cellNavigation:{spaceId:a}});if("failed"===u.type)return;for(const n of(0,p().ed)(u.data)){const e=(0,p().e9)({spaceId:a,actorUserId:o,viewedUserId:n.userId});(0,d().n4)(n,e.state)||e.setState(n)}}),(([e,t],[i,o])=>{if(e.spaceStore.id!==i.spaceStore.id||e.actorUserId!==i.actorUserId||!Object.is(t,o))return!1;return[{...e,viewedUserIds:(0,n(806080).sb)([...e.viewedUserIds,...i.viewedUserIds]).slice(0,n(571595).sD)},o]}),1e3,{maxWait:3e3});function v(e,t){const n=new Set,i=[e];function o(e){c().w7.includes(e)||n.add(e)}function r(e){e.table===a().oo&&o(e.id)}let s=0;e:for(;i.length>0&&n.size<t&&s<100;){s+=1;const a=i.pop();if(!a.isDefined())continue;for(const e of(0,l().Fbh)(a.getTitleValue()))if(o(e),n.size>=t)break e;if(a===e){const e=a.getCreatedByPointer();if(e&&r(e),n.size>=t)break e;const i=a.getLastEditedByPointer();if(i&&r(i),n.size>=t)break e}const d=a.getProperties();for(const e of Object.keys(d)){const i=d[e];if(i)for(const e of(0,l().Fbh)(i))if(o(e),n.size>=t)break e}for(const e of a.getDiscussionStores())for(const i of e.getCommentStores()){const e=i.getCreatedByPointer();if(e&&r(e),n.size>=t)break e;for(const r of(0,l().Fbh)(i.getText()))if(o(r),n.size>=t)break e}const c=a.getRenderableContentStores();for(let e=c.length-1;e>=0;e--){const t=c[e];t.isNavigableBlock()||i.push(t)}}return Array.from(n)}function f(e,t){if(!o().e.state)return;const n=e.getSpaceStore();if(!n||!n.id||!n.userId)return;const i=v(e,m);0!==i.length&&h({spaceStore:n,actorUserId:n.userId,viewedUserIds:i},t)}},271808:(e,t,n)=>{n.r(t),n.d(t,{ExternalObjectInstanceBlockMenu:()=>w});n(944114),n(898992),n(672577);var i=n(296540),o=()=>n(484714),r=()=>n(792485),s=()=>n(590526),a=()=>n(929219),l=()=>n(365917),d=()=>n(546926),c=()=>n(890492),u=()=>n(663639),p=()=>n(736847),m=()=>n(617871),g=()=>n(775842),h=()=>n(3284),v=()=>n(824862),f=()=>n(69708),y=()=>n(534177),x=()=>n(863687),j=()=>n(231536),S=()=>n(575143),b=()=>n(547149),k=()=>n(964556),I=n(474848);function w(e){const{titleForReloadMenuOption:t,store:n,parentBlockStore:w,onAccept:A,onDismiss:C,extraSecondaryItemKey:T,token:B}=e,M=(0,o().v3)(),D=(0,r().S)(),R=(0,i.useCallback)((e=>{const t={blocks:[n],environment:M,publicEditMode:void 0,analyticsFrom:"external_object_instance_block_menu",pageContext:D};return e.lazyDependencyKeys&&(0,j().G)(...e.lazyDependencyKeys),{key:e.key,render:(n,i)=>e.render(n,t,{onAccept:A,onFocus:i.onFocus}),action:({event:n})=>e.action(t,n)}}),[n,M,A,D]),P=(0,s().K8)((()=>{const e=n.getFormat().bot_id,t=l().A.getBotsAsRecordMap();if(e&&!0===l().A.state.loaded){const n=t.getValue({table:v().GP,id:e});if(n&&n.integration_id&&n.integration_id===m().ob)return!1}if(e&&!0===l().A.state.loaded){if(!l().A.externalAuthentications.state.find((({id:t})=>e===t)))return!1}return!0}),[n]),E=[],O=!(0,s().O$)(a().e);P&&E.push({key:0,render:e=>(0,I.jsx)(p().A,{...e,style:{paddingTop:0,paddingBottom:0}}),items:[{key:"reload external instance object",render:e=>(0,I.jsx)(S().A,{...e,title:t,svg:g().a,disabled:O,style:O?{opacity:.4}:void 0,tooltipText:O?(0,I.jsx)(f().sA,{id:"externalObjectInstanceBlockMenu.reload.offlineTooltip",defaultMessage:"Unavailable while offline"}):void 0}),action:()=>{n&&(n.isExternalObjectInstanceBlockStore()||n.isExternalObjectInstancePageBlockStore())&&k().updateExternalObjectInstance({environment:M,from:"page_more_menu",store:n,spaceId:n.getSpaceId()})}}]});const U=(0,s().K8)((()=>{switch(T){case"preview_to_mention":return[R(x().oq)];case"mention_to_preview":if(!n.isExternalObjectInstanceBlockStore())return[];if(!w||!B)return[];const e={key:"turn preview into block",render:e=>(0,I.jsx)(S().A,{...e,title:(0,I.jsx)(f().sA,{id:"hoverPreviewOverlay.action.turnPreviewIntoPreview",defaultMessage:"Turn into preview"}),svg:h().arrowSquarePathUpDownIcon}),action:()=>{b().createAndCommit({userAction:"HoverPreviewOverlay.transformExternalObjectInstanceMentionIntoBlock",environment:M,canUndo:!0,perform:e=>{k().transformExternalObjectInstanceMentionIntoBlock({block:n,parentStore:w,transaction:e,token:B}),e.postSubmitCallbacks.push((e=>{e||null==C||C()}))}})}};return[e];default:(0,y().HB)(T)}}),[T,R,n,w,B,M,C]);return E.push({key:1,render:e=>(0,I.jsx)(p().A,{...e,style:{paddingTop:0,paddingBottom:0}}),items:[...U,R(x().tA)]}),(0,I.jsx)(c().A,{menuType:d().gu.Popup,children:(0,I.jsx)(u().A,{type:u().O.Vertical,initialFocus:void 0,onAccept:A,sections:E,style:{paddingTop:3,paddingBottom:3}})})}},464412:(e,t,n)=>{n.d(t,{X:()=>l});var i=()=>n(755531),o=()=>n(59226),r=()=>n(590526),s=()=>n(365917),a=()=>n(686070);function l(){const e=(0,r().O$)(s().X),t=(0,r().K8)((()=>{const e=(0,i().S)();return e&&(0,a().d)({spaceStore:e})}),[]),n=(0,o().X)("notion_calendar_launch_modal");return e||t||!n}},495408:(e,t,n)=>{n.d(t,{p:()=>j});var i=n(296540),o=()=>n(587682),r=()=>n(275144),s=()=>n(401497),a=()=>n(295633),l=()=>n(718827),d=()=>n(250910),c=()=>n(807449),u=()=>n(695115),p=()=>n(589407),m=()=>n(105819),g=()=>n(69708),h=()=>n(100622),v=()=>n(957690),f=()=>n(839010),y=()=>n(904694),x=n(474848);function j(e){const{height:t,padding:n,padding_top:j,iframe_url:S,hoverData:b,store:k,token:I,href:w,onDismiss:A}=e,C=(0,g().YK)({editLink:{defaultMessage:"Edit link",id:"hoverPreviewOverlay.editLink"}}),T=(0,g().tz)(),B=(0,i.useRef)(null),M=(0,s().IS)((()=>({content:{width:340,height:"100%",aspectRatio:"auto",position:"relative"},container:{width:340,maxHeight:420,flexDirection:"column",alignItems:"flex-start"},buttonStyle:{display:"flex",alignItems:"center",justifyContent:"center",width:24,height:24,borderRadius:4,fill:h().Tj.icon.tertiary,background:v().xA}})),[]),D=k&&k.recordStoreUIParentStore&&k.recordStoreUIParentStore instanceof a().B?k.recordStoreUIParentStore:k instanceof a().B?k:void 0;return(0,x.jsxs)("div",{style:M.container,children:[e.showEditButton?(0,x.jsx)(u().A,{onClick:e.handleEditClick,icon:m().pencilLineIcon,colorVariant:"primary",ariaLabel:T.formatMessage(C.editLink),hasBackground:!0,style:{position:"absolute",top:8,insetInlineEnd:8,zIndex:1}}):void 0,I&&D&&b?(0,x.jsx)("div",{style:{position:"absolute",top:8,insetInlineEnd:8,zIndex:2},children:(0,x.jsx)(d().A,{popupType:d().z.Popup,placementToOrigin:"right",alignmentToOrigin:"start",originGap:4,onClose:()=>{let e=!1;const t=B.current;t&&(e=(0,o().ux)(t.getBoundingClientRect(),r().$C.x,r().$C.y)),e||null==A||A()},renderOrigin:e=>(0,x.jsx)(l().Ay,{style:M.buttonStyle,...e,children:(0,x.jsx)(c().I,{icon:p().ellipsisIcon,colorVariant:"inversePrimary"})}),render:e=>(0,x.jsx)(y().A,{parentBlockStore:D,store:k,token:I,href:w,hoverData:b,onAccept:()=>e.close()})})}):void 0,(0,x.jsx)(f().A,{source:S,style:M.content,preserveScale:!!(t&&t<1||n),background:!1,height:t&&t>0?t:void 0,aspectRatio:n?n/100:.75,paddingTop:j||void 0})]})}},508398:(e,t,n)=>{n.d(t,{A:()=>r});n(296540);var i=()=>n(302501),o=n(474848);const r=function(e){const{type:t,emoji:r,customEmojiStore:s,text:a,deletedText:l,subText:d}=e,c=(0,n(590526).K8)((()=>"custom"===t&&s.isDefined()&&s.getAlive()),[s,t]),u=(0,n(401497).IS)((()=>({container:{alignItems:"center"},label:{color:n(100622).Tj.text.inversePrimary,fontWeight:n(284371).Wy.medium,textAlign:"center",overflowWrap:"anywhere"},emojiContainer:{background:"white",borderRadius:4,padding:4,display:"flex",lineHeight:1,marginTop:2}})),[]);return(0,o.jsxs)(n(249046).wt,{gap:4,style:u.container,children:["custom"===t&&c?(0,o.jsx)("div",{style:u.emojiContainer,children:(0,o.jsx)(n(448664).A,{emojiStore:s,size:40})}):"unicode"===t?(0,o.jsx)("div",{style:u.emojiContainer,children:(0,o.jsx)(n(56086).A,{size:40,char:r})}):null,(0,o.jsx)(i().A,{isSmall:!0,isMultiline:!0,style:u.label,children:"unicode"===t||c?a:l}),d?(0,o.jsx)(i().A,{isSmall:!0,isMultiline:!0,style:u.label,children:d}):void 0]})}},549169:(e,t,n)=>{n.d(t,{Z:()=>a});n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(354520),n(581454);var i=()=>n(230711),o=()=>n(590526),r=()=>n(435761),s=()=>n(981342);function a(e){const{environment:t,spaceStore:n,userId:a,userPermissionGroupIds:l}=e,d=(0,o().K8)((()=>null==n?void 0:n.isReady()),[n]),{spaceUserStore:c,isSpaceUserStoreReady:u}=(0,o().K8)((()=>{const e=(0,i().sE)(n,a);return{spaceUserStore:e,isSpaceUserStoreReady:null==e?void 0:e.isReady()}}),[n,a]),{teams:p,isLoading:m}=function({environment:e,spaceStore:t,spaceUserStore:n,userId:i,userPermissionGroupIds:a}){const{teams:l,isLoading:d}=(0,r().Qs)({spaceStore:t}),c=(0,r().gc)({spaceStore:t,teams:l}),u=(0,o().K8)((()=>{const e=c.filter((e=>e.store.isMemberOrGuest(i,a||new Set,null==n?void 0:n.getModel())));return(0,s().M9)(e).map((e=>e.store))}),[c,a,i,n]);return{teams:u,isLoading:d}}({environment:t,spaceStore:n,spaceUserStore:c,userId:a,userPermissionGroupIds:l});return{teams:p,isLoading:!d||!u||m}}},568317:(e,t,n)=>{n.d(t,{_:()=>r,p:()=>s});var i=()=>n(401497),o=()=>n(284371);function r(){return(0,i().IS)((()=>({listModule:{display:"flex",flexDirection:"column",gap:4},truncationButton:{display:"flex",gap:6,alignItems:"center",padding:4,marginInlineStart:-4,flexDirection:"row",flexGrow:0,alignSelf:"flex-start"},truncationLabel:{fontWeight:400},rowContainer:{display:"flex",gap:6,alignItems:"center",padding:4,marginInlineStart:-4,flexGrow:0,alignSelf:"flex-start",maxWidth:"100%"},rowLabel:{fontWeight:400},hoveredStyle:{borderRadius:"6px"},avatarAndName:{display:"flex",gap:6,alignItems:"center"}})),[])}function s(){return(0,i().IS)((()=>({card:{maxWidth:400,minWidth:280,padding:12},bio:{display:"flex",alignItems:"center",gap:12,overflow:"hidden"},bioLink:{overflow:"hidden"},bioRight:{overflow:"hidden",width:"100%"},actionButton:{width:"100%",height:28,fontWeight:o().Wy.medium},profileTitle:{fontWeight:o().Wy.semibold},profileSubtitle:{...o().RC},loadingShimmer:{height:16,borderRadius:6,animation:"500ms ease-in fadein"}})),[])}},683e3:(e,t,n)=>{n.d(t,{Of:()=>d,e9:()=>c,ed:()=>u});n(944114);var i=()=>n(759303);const o=100;class r extends(()=>n(757695))().Store{constructor(...e){super(...e),this.lastFetchTimestamp=void 0}getInitialState(){}isRefetchThrottleReady(){const e=Date.now();return!(void 0!==this.lastFetchTimestamp&&e-this.lastFetchTimestamp<1e4)&&(this.lastFetchTimestamp=e,!0)}}let s;function a(){return s??=new(i().q)({max:o})}function l(e){return`${e.spaceId}:${e.actorUserId}:${e.viewedUserId}`}function d(e){const t=a().peek(l(e));return Boolean(t&&void 0!==t.state)}function c(e){const t=a(),n=l(e),i=t.get(n);if(i)return i;const o=new r;return t.set(n,o),o}function u(e){const t=e.profiles,n=[];for(const i of Object.keys(t)){const e=t[i];n.push({userId:i,timeZone:e.timeZone,permissionGroups:e.permissionGroups})}return n}(0,n(852832).exposeDebugGetter)("extendedUserProfileCache",a)},755023:(e,t,n)=>{n.d(t,{x:()=>a});var i=()=>n(590526),o=()=>n(792071),r=()=>n(179034),s=()=>n(519831);function a(e){const{store:t,closestNonAliveAncestorStore:n,intl:o}=e;return(0,i().K8)((()=>{const e=t.table===s().Vl&&!t.getAlive()?t:n,i=e&&(e.table===r().ev||e.table===s().Vl)&&e.getMovedToTrashTime();if(i){const t=e.getMovedToTrashStore();return{trashAuthorStore:t,trashAuthorDisplayName:l(t,o),trashTimestamp:i,isMovedToTrashMetadata:!0}}if(t.table===r().ev){const e=t.getLastEditedByStore();return{trashAuthorStore:e,trashAuthorDisplayName:l(e,o),trashTimestamp:t.getLastEditedTime(),isMovedToTrashMetadata:!1}}return{trashAuthorStore:void 0,trashAuthorDisplayName:void 0,trashTimestamp:void 0,isMovedToTrashMetadata:!1}}),[t,n,o])}function l(e,t){return(null==e?void 0:e.getDisplayName(t))||t.formatMessage(o().Fvx.messages.anonymousPlaceholder)}},820635:(e,t,n)=>{n.d(t,{Q:()=>h});n(581454);var i=n(296540),o=()=>n(920198),r=()=>n(484714),s=()=>n(401497),a=()=>n(187174),l=()=>n(69708),d=()=>n(100622),c=()=>n(284371),u=()=>n(567141),p=()=>n(698449),m=()=>n(994006),g=n(474848);function h(e){const{group:t,limit:n,noMembersMessage:h,color:v,trackHover:f}=e,y=(0,s().IS)((()=>({container:{marginBottom:4,..."white_background"===v?{fontSize:c().J.UISmall.desktop,color:d().Tj.text.secondary,padding:"4px 8px"}:{}},userContainer:{display:"flex",alignContent:"flex-end",minWidth:140,width:"100%",marginTop:4},user:{flexGrow:1},moreMessage:{marginInlineStart:2,marginTop:4,..."white_background"===v?{fontSize:c().J.UISmall.desktop,color:d().Tj.text.secondary}:{color:d().Tj.text.inverseSecondary}}})),[v]),x=(0,r().v3)(),j=(0,o().L)();(0,i.useEffect)((()=>{f&&u().ZX(x,{group_id:t.group_id})}),[f,t,x]);const[{value:S}]=(0,a().Yb)((async()=>{if(!j)return;const e=await x.api.callApi({eventName:"getSpacePermissionGroupMembers",environment:x,data:{groupIds:[t.group_id],spaceId:j.id}});if("success"===e.type){var i;const o=(null===(i=e.data.groupUsersMap[t.group_id])||void 0===i?void 0:i.userIds)??[];return(0,p().gA)({userIds:o,limit:n,spaceStore:j})}}),[j,x,t,n]);return 0===(null==S?void 0:S.limitedUserStores.length)?void 0===h?null:(0,g.jsx)("span",{children:h}):(0,g.jsxs)("div",{style:y.container,children:[null==S?void 0:S.limitedUserStores.map((e=>(0,g.jsx)("div",{style:y.userContainer,children:(0,g.jsx)(m().A,{style:y.user,userStore:e,avatarSize:18,hasPersonHoverCard:!1})},e.id))),S&&S.countRemainingUsers>0?(0,g.jsx)("div",{style:y.moreMessage,children:(0,g.jsx)(l().sA,{id:"blockPermissionsSettings.groupPermissionUsers.tooltip",defaultMessage:"{countRemainingUsers} moreâ€¦",values:{countRemainingUsers:S.countRemainingUsers}})}):null]})}},834974:(e,t,n)=>{n.d(t,{zP:()=>In,nJ:()=>dn});n(898992),n(354520),n(672577),n(581454),n(737550);var i=n(296540),o=()=>n(907258),r=()=>n(726637),s=()=>n(755877),a=()=>n(587682),l=()=>n(578510),d=()=>n(484714),c=()=>n(951500),u=()=>n(275144),p=()=>n(590526),m=()=>n(401497),g=()=>n(929219),h=()=>n(295633),v=()=>n(732810),f=()=>n(241059),y=()=>n(718827),x=()=>n(249046),j=()=>n(127833),S=()=>n(30537),b=()=>n(250910),k=()=>n(807449),I=()=>n(493552),w=()=>n(869190),A=()=>n(157366),C=()=>n(561565),T=()=>n(617871),B=()=>n(187174),M=()=>n(589407),D=()=>n(381553),R=()=>n(681873),P=()=>n(179034),E=()=>n(519831),O=()=>n(343666),U=()=>n(201980),_=()=>n(173979),z=()=>n(506391),L=()=>n(69708),W=()=>n(100622),H=()=>n(496603),N=()=>n(534177),K=()=>n(284371),F=()=>n(347469),V=()=>n(271808),G=()=>n(488923),Y=()=>n(508398),$=()=>n(47373),Z=()=>n(87878),J=()=>n(493208),q=()=>n(106352),X=()=>n(693689),Q=()=>n(891078),ee=()=>n(369393),te=()=>n(510473),ne=()=>n(968913),ie=()=>n(495576),oe=()=>n(179266),re=()=>n(129522),se=()=>n(230062),ae=()=>n(16990),le=()=>n(141465),de=()=>n(854672),ce=()=>n(738471),ue=()=>n(187820),pe=()=>n(128295),me=()=>n(16006),ge=()=>n(619126),he=()=>n(820635),ve=()=>n(457205),fe=()=>n(824862),ye=()=>n(564884),xe=()=>n(884780),je=()=>n(701720),Se=()=>n(312788),be=()=>n(350013),ke=()=>n(406094),Ie=()=>n(302501),we=()=>n(584262),Ae=()=>n(107620),Ce=()=>n(735790),Te=()=>n(743246),Be=()=>n(496703),Me=()=>n(865342),De=()=>n(94522),Re=n(474848);const Pe=(0,L().YK)({chatButton:{id:"botHoverCard.chatButton",defaultMessage:"Chat"},configureButton:{id:"botHoverCard.settingsButton",defaultMessage:"Settings"}});function Ee(e){const{navigate:t}=(0,i.useContext)(Se().E),{botStore:n}=e,r=(0,d().v3)(),s=(0,L().tz)(),a=(0,p().O$)(o().AppStoreSidebarSpaceStore),l=(0,m().IS)((()=>({card:{maxWidth:400,minWidth:280,padding:12},bio:{display:"flex",alignItems:"center",gap:12,overflow:"hidden"},bioRight:{overflow:"hidden",width:"100%"},icon:{flexShrink:0},profileTitle:{fontWeight:K().Wy.semibold},profileSubtitle:{...K().RC},description:{...K().RC,display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",overflow:"hidden"},actionButton:{width:"100%",height:28,fontWeight:K().Wy.medium}})),[]),c=(0,p().K8)((()=>n.getModel()),[n]),u=(0,p().K8)((()=>(null==c?void 0:c.isWorkflowBot())??!1),[c]),g=(0,p().K8)((()=>{if(c&&u)return c.getWorkflowId()}),[c,u]),h=(0,p().K8)((()=>{if(g&&a)return be().N.createChildStore(a,{table:Te().C0,id:g,spaceId:a.id})}),[g,a]),v=(0,i.useCallback)((()=>{if(g){const e=(0,Be().L)({workflowId:g,params:{workflowViewType:"chat"},pageVisitSource:we().y8.MentionInPage});t({environment:r,url:e})}}),[g,r,t]),f=(0,i.useCallback)((()=>{if(g){const e=(0,Be().L)({workflowId:g,params:{workflowViewType:"settings"},pageVisitSource:we().y8.MentionInPage});t({environment:r,url:e})}}),[g,r,t]);(0,i.useEffect)((()=>{c&&a&&(0,ye().u)({environment:r,event:{eventName:"bot_hover_card_impression",eventProperties:{bot_id:n.id,workflow_id:g||void 0,space_id:a.id}}})}),[c,n.id,g,r,a]);const y=(0,p().K8)((()=>{if(h)return(0,De().dh)(h)}),[h]),j=(0,p().K8)((()=>(null==y?void 0:y.name)||(null==c?void 0:c.getName())||"Unnamed Agent"),[c,y]),S=(0,p().K8)((()=>null==y?void 0:y.description),[y]),b=(0,p().K8)((()=>null==y?void 0:y.icon),[y]),k=(0,p().K8)((()=>!!h&&h.canEdit()),[h]);return c?(0,Re.jsx)("div",{style:l.card,children:(0,Re.jsx)(xe().K,{from:"BotHoverCard",fallback:e=>(0,Re.jsx)(je().d,{...e}),children:(0,Re.jsxs)(x().wt,{gap:16,children:[(0,Re.jsx)(x().Ye,{children:(0,Re.jsxs)("div",{style:l.bio,children:[(0,Re.jsx)(Me().Z,{icon:b,size:56}),(0,Re.jsxs)(x().wt,{gap:3,style:l.bioRight,children:[(0,Re.jsx)(Ie().A,{style:l.profileTitle,children:j}),(0,Re.jsx)(Ie().A,{isSmall:!0,style:l.profileSubtitle,children:(0,Re.jsx)(L().sA,{id:"botHoverCard.agentLabel",defaultMessage:"Custom Agent"})}),S?(0,Re.jsx)(Ie().A,{isSmall:!0,isSecondaryColor:!0,style:l.description,children:S}):void 0]})]})}),u?(0,Re.jsxs)(x().Ye,{gap:12,children:[(0,Re.jsx)(ke().A,{onClick:v,size:"lg",style:l.actionButton,iconLeading:Ae().y,children:(0,Re.jsx)(Ie().A,{children:s.formatMessage(Pe.chatButton)})}),k?(0,Re.jsx)(ke().A,{onClick:f,size:"lg",style:l.actionButton,iconLeading:Ce().M,children:(0,Re.jsx)(Ie().A,{children:s.formatMessage(Pe.configureButton)})}):void 0]}):void 0]})})}):null}function Oe(e){const t=(0,p().O$)(o().AppStoreSidebarSpaceStore),n=(0,p().K8)((()=>{if(!t)return;const[n,i]=e.state.annotation;return ve().v.createChildStore(t,{id:i,table:fe().GP})}),[e.state,t]),i=(0,p().K8)((()=>!!n&&n.isDefined()),[n]);return n&&i&&t?(0,Re.jsx)(Ee,{botStore:n}):null}var Ue=n.n(n(32485)),_e=()=>n(609679),ze=()=>n(337819),Le=()=>n(26245),We=()=>n(643707),He=()=>n(358006),Ne=()=>n(618425),Ke=()=>n(871830);const Fe=(0,L().YK)({contentDeletedHeader:{defaultMessage:"Deleted",id:"HoverCitationPreviewOverlay.contentDeletedHeader"},contentMovedHeader:{defaultMessage:"No access",id:"HoverCitationPreviewOverlay.contentMovedHeader"},contentDeletedMessage:{defaultMessage:"Cited content was deleted.",id:"HoverCitationPreviewOverlay.contentDeletedMessage"},contentMovedMessage:{defaultMessage:"Cited content was moved to a location you do not have access to.",id:"HoverCitationPreviewOverlay.contentMovedMessage"}});function Ve(e){const{headerIcons:t,headerText:n,headerActions:i,content:o,hideOverflowFade:r=!1}=e,s=(0,m().eP)(),a=(0,m().IS)((()=>({container:{width:"max-content",maxWidth:275,maxHeight:275,padding:12,fontSize:12,display:"grid",gap:5,overflow:"hidden",position:"relative"},overflowFade:{position:"absolute",bottom:0,width:"100%",height:21.6,background:"dark"===s?"linear-gradient(to top, rgba(32,32,32, 1), transparent)":"linear-gradient(to top, rgba(255,255,255, 1), transparent)"},header:{flex:1,display:"grid",gap:5,gridTemplateColumns:"auto 1fr auto",gridTemplateRows:"1fr",gridTemplateAreas:'\n\t\t\t\t\t"icons text actions"\n\t\t\t\t'},headerIcons:{gridArea:"icons",display:"grid",placeItems:"center",gap:2},headerText:{color:W().Tj.text.primary,gridArea:"text",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontWeight:K().Wy.medium},headerActions:{gridArea:"actions"},content:{flex:1}})),[s]);return(0,Re.jsxs)("div",{style:{...a.container},children:[(0,Re.jsxs)("div",{style:{...a.header},children:[(0,Re.jsx)("div",{style:{...a.headerIcons},children:t}),(0,Re.jsx)("div",{style:{...a.headerText},children:n}),(0,Re.jsx)("div",{style:{...a.headerActions},children:i})]}),(0,Re.jsx)("div",{style:{...a.content},children:o}),r?void 0:(0,Re.jsx)("div",{style:{...a.overflowFade}})]})}function Ge(e){const t=(0,L().tz)(),n=(0,Ke().O)(),o=(0,m().IS)((()=>({deletedHeader:{color:W().Tj.palette.red[500],whiteSpace:"nowrap"},noAccessHeader:{color:W().Tj.palette.yellow[500],whiteSpace:"nowrap"},deletedMessage:{color:W().Tj.text.secondary},noAccessMessage:{color:W().Tj.text.secondary},rendererBlockStyle:{fontSize:12,color:W().Tj.text.secondary}})),[]),r=U().NpB(e.state.annotation),{navigablePageStore:s,citationNumber:a,citedBlockStore:l,citedBlockIsDeleted:d,citedBlockNoAccess:c}=(0,p().K8)((()=>{var t;if("block"!==r.type||!r.blockId||!r.spaceId||!r.citationNumber)return{navigablePageStore:void 0,citationNumber:void 0,citedBlockStore:void 0,citedBlockIsDeleted:!0,citedBlockNoAccess:!0};const n={id:r.blockId,spaceId:r.spaceId,table:P().ev},i=h().B.createChildStore(e.state.store,n),o=i.getPageStatus(),s=null===(t=i.getNavigableBlockStore())||void 0===t?void 0:t.pointer;return{navigablePageStore:s?h().B.createChildStore(e.state.store,s):void 0,citedBlockStore:i,citedBlockIsDeleted:"deleted_from_trash"===o||"in_trash"===o,citedBlockNoAccess:"none"===i.getRole(),citationNumber:r.citationNumber}}),[r,e.state.store]),u=(0,m().DP)(),g=(0,m().IS)((()=>(0,ze().D)({theme:u,isFocused:!1,isDeleted:d,hasNoAccess:c})),[d,c,u]),v=(0,m().IS)((()=>(0,Le().aS)({theme:u})),[u]),f=(0,p().K8)((()=>null==l?void 0:l.getCreatedTime()),[l]),y=Ue()(We().Co,We().te,"citation-annotation-anchor","notion-numbered-block-citation-token",{"notion-numbered-block-citation-token-deleted":d},{"notion-numbered-block-citation-token-no-access":c}),x=(0,i.useMemo)((()=>a?(0,Re.jsx)("div",{className:y,style:{...v.citationContainerStyles,...g.numberedBlockCitationStyles,cursor:"default",...a>99?{paddingLeft:5,paddingRight:5}:{}},children:a}):void 0),[a,y,g.numberedBlockCitationStyles,v.citationContainerStyles]);if(d)return(0,Re.jsx)(Ve,{headerIcons:x,headerText:(0,Re.jsx)("div",{style:{...o.deletedHeader},children:(0,Re.jsx)(L().sA,{...Fe.contentDeletedHeader})}),content:(0,Re.jsx)("div",{style:{...o.deletedMessage},children:(0,Re.jsx)(L().sA,{...Fe.contentDeletedMessage})}),hideOverflowFade:!0});if(c)return(0,Re.jsx)(Ve,{headerIcons:x,headerText:(0,Re.jsx)("div",{style:{...o.noAccessHeader},children:(0,Re.jsx)(L().sA,{...Fe.contentMovedHeader})}),content:(0,Re.jsx)("div",{style:{...o.noAccessMessage},children:(0,Re.jsx)(L().sA,{...Fe.contentMovedMessage})}),hideOverflowFade:!0});if("block"!==r.type||!l||!s)return null;const j=f?(0,w().AE)({date:f,locale:_e().locale,intl:t}):void 0;return(0,Re.jsx)(Ve,{headerIcons:x,headerText:j,content:(0,Re.jsx)(Ne().wJ,{surfaceName:"citation_preview",children:(0,Re.jsx)(He().z,{variant:"default",store:s,coverFormat:{type:"page_content"},allowVideoPlayback:!1,contentWrapStyle:{height:"auto"},coverContentFadedOverlay:!1,startBlockId:l.id===s.id?void 0:l.id,imageCoverWrapStyle:n.imageCoverWrap,emptyGalleryCoverStyle:n.contentCoverEmpty,loadingShimmerStyle:n.loadingShimmer,showLoadingShimmer:!0,showEmptyGalleryCover:!0,onLoadProxiedImage:()=>{},rendererBlockStyle:o.rendererBlockStyle,renderAdditionalBlocks:!0,style:{padding:0},exactBlockOnlyNoContentCover:!0})})})}var Ye=()=>n(567141),$e=()=>n(769864),Ze=()=>n(495408),Je=()=>n(881254);function qe(e){const{token:t,store:n,spaceStore:r}=e.state,{linkMentionAnnotationData:s}=e,a=e.onDismiss,l=(0,d().v3)(),[c,u]=(0,i.useState)(!0),{iframe_url:p,height:m,padding:g,href:h,padding_top:v}=s,f=s.hasOwnProperty("description"),y=H().Im(s),[{value:x}]=(0,B().Yb)((async()=>{var e;if(p)return Ye().wZ(l,{type:"iframe"}),{result:"iframePresent"};if(f)return u(!1),y?Ye().wZ(l,{type:"default"}):Ye().wZ(l,{type:"custom"}),{result:"linkMentionContainsDescription"};u(!0);const t=await $e().callApi({eventName:"getDataForLinkMention",environment:l,data:{url:h,spaceId:(null==r?void 0:r.getSpaceId())??(null===(e=o().default.state.mainEditorCurrentBlockStore)||void 0===e?void 0:e.getSpaceId()),source:"link_mention_hover"}});return"success"===t.type?"error"in t.data?(u(!1),{result:"apiFailed"}):(Ye().wZ(l,{type:"custom"}),u(!1),{result:"gotApiResponse",resultData:t.data}):"failed"===t.type?(u(!1),{result:"apiFailed"}):(u(!1),(0,N().HB)(t))}),[p,f,l,h,y,r]);let j;switch(null==x?void 0:x.result){case"linkMentionContainsDescription":j=s;break;case"gotApiResponse":j=x.resultData;break;case"apiFailed":case"iframePresent":case void 0:j=void 0;break;default:(0,N().HB)(x)}return j&&!p||!j&&!p?(0,Re.jsx)(Je().R,{hoverData:j,href:h,showEditButton:!1,store:n,token:t,onDismiss:a,loading:c}):p?(0,Re.jsx)(Ze().p,{hoverData:s,iframe_url:p,showEditButton:!1,height:m,padding:g,store:n,token:t,onDismiss:a,href:h,padding_top:v}):(0,Re.jsx)(Je().R,{hoverData:j,href:h,showEditButton:!1,store:n,token:t,onDismiss:a,loading:c})}var Xe=()=>n(692031),Qe=()=>n(212497),et=()=>n(908006),tt=()=>n(906536),nt=()=>n(631524),it=()=>n(921940),ot=()=>n(536583),rt=()=>n(101163),st=()=>n(777447),at=()=>n(651784),lt=()=>n(924703),dt=()=>n(607935),ct=()=>n(501666),ut=()=>n(712030),pt=()=>n(267419),mt=()=>n(781286);function gt(e){const{onDismiss:t,state:n}=e,{store:s}=n,a=(0,d().v3)(),l=(0,m().DP)(),[c,u]=(0,i.useState)(!0),g="token"===n.type?U().cQR(n.annotation):n.hyperlink,f=(0,st().lX)({url:g,baseUrl:r().A.domainBaseUrl,publicDomainName:r().A.publicDomainName}),y=(0,U().HZO)({url:g,baseUrl:r().A.domainBaseUrl,publicDomainName:r().A.publicDomainName}),j=(0,i.useCallback)((async()=>{switch(t(),n.type){case"token":!function(e){const{token:t,store:n,readOnly:i}=e;let o=0,r=0;if(t.textValue){let e=0;for(;e<t.tokenIndex;)o+=U().WWE(t.textValue[e]),e++;r=o+U().WWE(t.textValue[e])}(0,tt().t)({store:n,selection:{startIndex:o,endIndex:r},readOnly:i})}({token:n.token,store:n.store,readOnly:!1}),await et().default.afterNextFlush(),ct().fi({type:"focusOnly",focus:!0});break;case"block":mt().hv({store:n.store});break;default:(0,N().HB)(n)}}),[t,n]),S=(0,i.useCallback)((async()=>{t(),await et().default.afterNextFlush();const[e,n]=await Promise.all([(0,Xe().r)(),(0,Qe().jd)()]),i=e.copiedLinkToClipboard;let o=g;const l=(0,at().parseRoute)({url:g,baseUrl:r().A.domainBaseUrl,publicDomainName:r().A.publicDomainName,isMobile:r().A.isMobile,protocol:r().A.protocol,currentUrl:window.location.href});if("page"===l.name&&l.blockId){const e=h().B.createChildStore(s,{table:P().ev,id:l.blockId});o=(0,it().A)({pageId:l.blockId,pageModel:e.getModel(),baseUrl:r().A.domainBaseUrl,discussionId:l.discussionId,scrollToBlockId:l.scrollToBlockId,peekViewBlockId:l.peekViewBlockId,peekMode:l.peekMode,pageVisitSource:we().y8.CopyLink})}n({environment:a,stringValue:o,copiedMessage:i})}),[a,t,s,g]),b=(0,p().K8)((()=>(0,$().s8)()),[]),[{value:w}]=(0,B().Yb)((async()=>{var e,t;if(f||!b)return;u(!0);const i=await $e().callApi({eventName:"getDataForLinkMention",environment:a,data:{url:g,spaceId:(null===(e=n.spaceStore)||void 0===e?void 0:e.id)??(null===(t=o().default.state.mainEditorCurrentBlockStore)||void 0===t?void 0:t.getSpaceId()),source:"hyperlink_hover"}});if("success"===i.type)return"error"in i.data?void u(!1):(u(!1),i.data);if("failed"===i.type)throw void u(!1);return u(!1),(0,N().HB)(i)}),[a,g,f,b,n.spaceStore]),A=a.device.isSafari||a.device.isIOS,C=(0,m().IS)((()=>({wrapper:{fontSize:K().J.UISmall.desktop,flexDirection:"column"},destination:{paddingTop:4,paddingInlineEnd:0,paddingBottom:4,paddingInlineStart:6,alignItems:"center"},button:{marginInlineEnd:2},destinationText:{paddingInlineEnd:6,maxWidth:250,...K().RC},icon:{marginInlineEnd:A?"0.4em":"0.5em"},content:{width:340,height:"100%",aspectRatio:"auto"},title:{color:W().Tj.text.primary,fontWeight:K().Wy.semibold,whiteSpace:"normal",wordBreak:"break-word",fontSize:13,padding:"4px 0",maxWidth:300},author:{color:W().Tj.text.secondary,fontSize:K().J.UISmall.desktop},description:{wordBreak:"break-word",maxWidth:300,...K().RC,color:W().Tj.text.primary,fontSize:12,lineHeight:1.45,whiteSpace:"normal",flexDirection:"column"},text:{color:W().Tj.text.primary,fontSize:12,lineHeight:1.45},buttons:{fontWeight:K().Wy.medium}})),[A]),T=(0,L().tz)(),M=(0,L().YK)({copyLink:{defaultMessage:"Copy link",id:"hoverPreviewOverlay.copyLink"}}),D=(0,p().K8)((()=>{if(f){const e=h().B.createChildStore(s,{table:P().ev,id:f});return{icon:(0,lt().h6)({pageModel:e.getModel(),pageRole:e.getRole(),baseUrl:r().A.domainBaseUrl,getRecordModel:s.getRecordModel,emojiType:(0,ut().FN)(a),isSafariOrIOS:A,isClient:!0,currentUserId:a.currentUser.id,theme:l,emojiData:pt().A.state}),title:(0,Re.jsx)(me().A,{placeholder:`${window.location.protocol}//${window.location.host}${g}`,style:C.destinationText,store:e})}}if(y){const e=v().m.createChildStore(s,{table:E().Vl,id:y});return{icon:(0,dt().e)({collectionPointer:e.pointer,emojiType:(0,ut().FN)(a),getRecordModel:s.getRecordModel,getRecordRole:s.getRecordRole,baseUrl:r().A.domainBaseUrl,theme:l,isSafariOrIOS:A,isClient:!0,currentUserId:a.currentUser.id,emojiData:pt().A.state}),title:(0,Re.jsx)(me().A,{placeholder:`${window.location.protocol}//${window.location.host}${g}`,style:C.destinationText,store:e})}}return{icon:(0,Re.jsx)("span",{style:C.icon,children:(0,Re.jsx)(k().I,{icon:rt().globeSmallIcon,size:"sm",colorVariant:"secondary",fitToViewBox:"horizontal"})}),title:(0,Re.jsx)("div",{style:C.destinationText,children:g})}}),[a,s,f,y,C,l,A,g]),R=(0,p().K8)((()=>{if(!r().A.isMobile)return w?(w.hasOwnProperty("iframe")?Ye().Av(a,{type:"iframe"}):Ye().Av(a,{type:"custom"}),w):void 0}),[a,w]);if(b&&!f){if(R&&!R.iframe||!R)return(0,Re.jsx)(Je().R,{hoverData:R,href:g,handleEditClick:j,showEditButton:e.isHoveredTokenEditable,store:s,loading:c});if(R&&R.iframe)return(0,Re.jsx)(Ze().p,{hoverData:R,iframe_url:R.iframe,height:R.height,padding:R.padding,padding_top:R.padding_top,handleEditClick:j,store:s,href:g,onDismiss:t,showEditButton:e.isHoveredTokenEditable})}return(0,Re.jsx)(x().Ye,{style:C.wrapper,alignItems:"center",children:(0,Re.jsxs)(x().Ye,{style:C.destination,alignItems:"center",children:[D.icon,(0,Re.jsx)(I().D,{styleKey:"captionRegular",colorVariant:"secondary",children:D.title}),(0,Re.jsx)(nt().p,{size:"sm",onClick:S,iconLeading:{icon:ot().d,size:"sm"},ariaLabel:T.formatMessage(M.copyLink)}),e.isHoveredTokenEditable?(0,Re.jsx)("div",{style:C.button,children:(0,Re.jsx)(nt().p,{size:"sm",onClick:j,style:C.button,children:(0,Re.jsx)(I().D,{styleKey:"captionRegular",children:(0,Re.jsx)(L().sA,{defaultMessage:"Edit",id:"hoverPreviewOverlay.editButton.label"})})})}):void 0]})})}var ht=()=>n(26697),vt=()=>n(811879),ft=()=>n(755023);function yt(e){const{store:t,closestNonAliveAncestorStore:n,originRect:i}=e,o=(0,L().tz)(),r=(0,m().IS)((()=>({tooltipStyle:{fontSize:14},mentionPageInTrashTime:{fontWeight:K().Wy.regular,color:W().Tj.text.secondary,fontSize:14},avatarStyle:{margin:"0 6px"},placeholderStyle:{marginInlineEnd:6}})),[]),{trashAuthorStore:s,trashAuthorDisplayName:a,trashTimestamp:l,isMovedToTrashMetadata:d}=(0,ft().x)({store:t,closestNonAliveAncestorStore:n,intl:o});if(!l)return null;const c=(0,w().jE)(l,_e().locale,o),u=s&&(0,Re.jsx)(vt().E,{authorStore:s,avatarSize:18,avatarStyle:r.avatarStyle});return(0,Re.jsx)(ht().m,{forceVisibleState:!0,originRect:i,render:()=>{},renderTooltip:()=>(0,Re.jsxs)("div",{children:[(0,Re.jsxs)(x().Ye,{alignItems:"center",children:[d?(0,Re.jsx)(L().sA,{defaultMessage:"Moved to Trash by",id:"hoverPreviewOverlay.pageInTrash.message.movedToTrashBy"}):(0,Re.jsx)(L().sA,{defaultMessage:"Last edited by",id:"hoverPreviewOverlay.pageInTrash.message.lastEditedBy"}),u||(0,Re.jsx)("div",{style:r.placeholderStyle}),a]}),(0,Re.jsx)("div",{style:r.mentionPageInTrashTime,children:c})]}),placement:"bottom",alignment:"start",style:r.tooltipStyle})}var xt=()=>n(849255),jt=()=>n(798880),St=(n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),()=>n(664594)),bt=()=>n(230711),kt=()=>n(895549),It=()=>n(874832),wt=()=>n(996332),At=()=>n(913886),Ct=()=>n(402390),Tt=()=>n(936802),Bt=()=>n(231704),Mt=()=>n(313171),Dt=()=>n(453697),Rt=()=>n(300789),Pt=()=>n(645200),Et=()=>n(694498),Ot=()=>n(464412),Ut=()=>n(169626),_t=()=>n(404141),zt=()=>n(617711),Lt=()=>n(549169),Wt=()=>n(763824),Ht=()=>n(260513),Nt=()=>n(683e3);var Kt=()=>n(612740),Ft=()=>n(571595);var Vt=()=>n(568317),Gt=()=>n(742734),Yt=()=>n(396933);const $t=(0,L().YK)({personalPronoun:{id:"personHoverCard.personalPronoun",defaultMessage:"You"}});function Zt(e,t){return e?` (${t.formatMessage($t.personalPronoun)})`:""}function Jt({index:e}){return(0,Re.jsx)("span",{style:{whiteSpace:"pre"},children:(0,Re.jsx)(L().sA,{defaultMessage:", ",id:"personHoverCard.userInfo.groupSeparatorValue"})},e)}function qt(e){switch(e.membershipType){case"none":return(0,Re.jsx)(L().sA,{id:"personHoverCard.memberStatus.none",defaultMessage:"Deactivated"});case"page_guest":return(0,Re.jsx)(L().sA,{id:"personHoverCard.memberStatus.guest",defaultMessage:"Guest"});case"restricted_member":return(0,Re.jsx)(L().sA,{id:"personHoverCard.memberStatus.restricted_member",defaultMessage:"Restricted Member"});case"member":return(0,Re.jsx)(L().sA,{id:"personHoverCard.memberStatus.member",defaultMessage:"Member"});case"membership_admin":return(0,Re.jsx)(L().sA,{id:"personHoverCard.memberStatus.admin",defaultMessage:"Admin"});case"owner":return(0,Re.jsx)(L().sA,{id:"personHoverCard.memberStatus.owner",defaultMessage:"Workspace Owner"});default:(0,N().HB)(e.membershipType)}}function Xt(e){const{permissionGroupNames:t,membershipType:n,isExtendedUserProfileLoading:i,areTeamsLoading:o,teamspaceNames:r,scimTitle:s}=e,a=(0,Vt().p)();return i?(0,Re.jsx)(It().P,{style:a.loadingShimmer}):s?(0,Re.jsx)(Ie().A,{isSmall:!0,style:a.profileSubtitle,children:s}):t.length>0?(0,Re.jsx)(Ie().A,{isSmall:!0,style:a.profileSubtitle,children:(0,R().G)(t.slice(0,3),(e=>(0,Re.jsx)(Jt,{index:e},e)))}):o?(0,Re.jsx)(It().P,{style:a.loadingShimmer}):r.length>0?(0,Re.jsx)(Ie().A,{isSmall:!0,style:a.profileSubtitle,children:(0,R().G)(r.slice(0,3),(e=>(0,Re.jsx)(Jt,{index:e},e)))}):n?(0,Re.jsx)(Ie().A,{isSmall:!0,style:a.profileSubtitle,children:(0,Re.jsx)(qt,{membershipType:n})}):null}function Qt(e){const t=(0,L().tz)(),{isExtendedUserProfileLoading:n,timeZone:i}=e,o=(0,Vt().p)();return n?(0,Re.jsx)(It().P,{style:o.loadingShimmer}):i?(0,Re.jsx)(Ie().A,{isSmall:!0,isSecondaryColor:!0,style:o.profileSubtitle,children:(0,Re.jsx)(L().sA,{id:"personHoverCard.userInfo.timeZone",defaultMessage:"{time} local time",values:{time:(new Date).toLocaleTimeString((0,Ct().H)(t),{timeZone:i,hour:"2-digit",minute:"2-digit",hour12:!0})}})}):null}function en(e){const{groupIds:t,intl:n}=e;return t.sort(((e,t)=>{const n=Ut().h.getGroupData(e),i=Ut().h.getGroupData(t);return((null==n?void 0:n.memberCount)??0)-((null==i?void 0:i.memberCount)??0)})).map((e=>{const t=Ut().h.getGroupData(e);return null==t?void 0:t.group.getDisplayName(n)})).filter(N().O9)}const tn={timeZone:void 0,permissionGroups:[]};const nn=56;function on({userStore:e}){const t=(0,L().tz)(),n=(0,d().v3)(),r=(0,kt().h)("person_hover_card_loaded",{environment:n,allowMultipleFiresPerSession:!0}),s=(0,p().O$)(o().AppStoreSidebarSpaceStore),a=(0,p().K8)((()=>{var t;if(s)return null===(t=(0,bt().dp)(s,e.id))||void 0===t?void 0:t.getMembershipType()}),[s,e]),l=(0,p().K8)((()=>e.id),[e]),c=(0,St().T)()===l,{value:u,isLoading:m}=function({userId:e}){const t=(0,d().v3)(),n=(0,p().O$)(o().AppStoreSidebarSpaceStore),{store:i,refetch:r}=(0,p().K8)((()=>{if(!n||!n.userId)return{store:void 0,refetch:void 0};const i=n.userId,o=(0,Nt().e9)({spaceId:n.id,actorUserId:i,viewedUserId:e});return{store:o,refetch:async()=>{await(0,Ht().fetchExtendedUserProfile)({viewedUserId:e,actorUserId:i,spaceStore:n,store:o,environment:t})}}}),[n,t,e]),s=r??Wt().TA,[{status:a,error:l}]=(0,B().Yb)(s,[s]),c=(0,p().O$)(i);return void 0===n?{isLoading:!0,error:void 0,value:void 0}:{isLoading:!c&&"pending"===a,error:l,value:c}}({userId:l}),{timeZone:g,permissionGroupIds:v,sortedGroupNames:f}=(0,p().K8)((()=>{const{timeZone:e,permissionGroups:n}=u??tn;return{timeZone:e,permissionGroupIds:new Set(n),sortedGroupNames:en({groupIds:Array.from(n),intl:t})}}),[u,t]),{teams:y,isLoading:j}=(0,Lt().Z)({environment:n,spaceStore:s,userId:l,userPermissionGroupIds:v}),S=(0,p().K8)((()=>y?y.map((e=>e.getName())).filter((e=>void 0!==e)):[]),[y]),{name:b,email:k}=(0,p().K8)((()=>({name:e.getFullName(t),email:e.getEmail()})),[e,t]),I=(0,p().K8)((()=>e.isDefined()),[e]),w=(0,p().K8)((()=>{if(!s)return;const e=n.idCreator.getSpaceIdCreatorSync(s.id);return(0,zt().o4)({userId:l,spaceIdCreator:e,pageVisitSource:we().y8.PersonHoverCard})}),[l,s,n]),A=(0,Gt().E)({spaceStore:s,viewedUserId:e.id}),C="show"===(0,Yt().$)({spaceStore:s,viewedUserId:e.id}),T=(0,Ot().X)(),M=(0,i.useCallback)((()=>{k&&(T?(0,Pt().YQ)({environment:n,email:k,from:"peopleHoverCard"}):(Et().A.setState({signupCtaAttribution:"peopleHoverCard"}),Rt().UW(n,"notion_calendar_launch_promo")))}),[T,n,k]),R=(0,i.useCallback)((e=>{e.metaKey||_t().Ay.setState({..._t().Ay.state,open:!1})}),[]),P=(0,N().O9)(k)&&I&&A,E=m||j;(0,i.useEffect)((()=>{P&&!E&&r()}),[P,E,r]),function({environment:e,shouldRender:t,viewedUserId:n,from:o}){const r=(0,i.useRef)(!1);(0,i.useEffect)((()=>{t&&!r.current&&(r.current=!0,(0,ye().u)({environment:e,event:{eventName:"person_hover_card_impression",eventProperties:{viewed_user_id:n,from:o}}}))}),[t,e,n,o])}({environment:n,shouldRender:P,viewedUserId:l,from:"unknown"});const O=function(e){const{spaceStore:t,environment:n,hoveredUserId:i,propertyId:o}=e;return(0,p().K8)((()=>{if(!t)return;const e=n.idCreator.getSpaceIdCreatorSync(t.id),r=(0,Ft().rf)({userId:i,spaceIdCreator:e});return h().B.createChildStore(t,(0,Kt().iL)({blockId:r,spaceId:t.id})).getProperties()[o]}),[t,n,i,o])}({spaceStore:s,environment:n,hoveredUserId:l,propertyId:Tt().Ab.title.id}),U=(0,Vt().p)();if(!P)return null;const _=b||k,z=(0,Re.jsx)(Ie().A,{style:U.profileTitle,children:_+Zt(c,t)});return(0,Re.jsx)("div",{style:U.card,children:(0,Re.jsx)(xe().K,{from:"PersonHoverCard",fallback:e=>(0,Re.jsx)(je().d,{...e}),children:(0,Re.jsxs)(x().wt,{gap:16,children:[(0,Re.jsx)(x().Ye,{children:(0,Re.jsxs)("div",{style:U.bio,children:[w&&C?(0,Re.jsx)(wt().Q,{href:w,onClick:R,ignoreLocalHoverState:!0,children:(0,Re.jsx)(Dt().A,{userStore:e,size:nn})}):(0,Re.jsx)(Dt().A,{userStore:e,size:nn}),(0,Re.jsxs)(x().wt,{gap:3,style:U.bioRight,children:[(0,Re.jsxs)(x().Ye,{gap:4,alignItems:"center",children:[w&&C?(0,Re.jsx)(wt().Q,{href:w,onClick:R,ignoreLocalHoverState:!0,style:U.bioLink,children:z}):z,"restricted_member"===a?(0,Re.jsx)(Mt().L,{}):"page_guest"===a?(0,Re.jsx)(Bt().w,{labelType:"page_guest"}):null]}),(0,Re.jsx)(Xt,{isExtendedUserProfileLoading:m,scimTitle:O,permissionGroupNames:f,areTeamsLoading:j,teamspaceNames:S,membershipType:a}),(0,Re.jsx)(Qt,{isExtendedUserProfileLoading:m,timeZone:g})]})]})}),c?null:(0,Re.jsxs)(x().Ye,{gap:12,children:[(0,Re.jsx)(ke().A,{size:"lg",style:U.actionButton,onClick:()=>{window.open(`mailto:${k}`,"_blank")},iconLeading:{icon:At().D,size:"sm"},children:(0,Re.jsx)(Ie().A,{children:(0,Re.jsx)(L().sA,{id:"personHoverCard.actionButtons.email",defaultMessage:"Email"})})}),(0,Re.jsx)(ke().A,{size:"lg",style:U.actionButton,onClick:M,iconLeading:{icon:D().Y,size:"sm"},children:(0,Re.jsx)(L().sA,{id:"personHoverCard.actionButtons.schedule",defaultMessage:"Schedule"})})]})]})})})}function rn(e){const t=(0,p().O$)(o().AppStoreSidebarSpaceStore),n=(0,p().K8)((()=>{if(!t)return;if("user"===e.state.type)return e.state.store;const n=e.state.annotation;return xt().L.createChildStore(t,{id:n[1],table:jt().oo})}),[e.state,t]),i=(0,p().K8)((()=>!!n&&n.isDefined()),[n]);return n&&i&&t?(0,Re.jsx)(on,{userStore:n}):null}var sn=()=>n(877349),an=()=>n(490242);function ln(e,t){if(Object.is(e,t))return!0;if(void 0===e||void 0===t||e.type!==t.type)return!1;switch(e.type){case"token":return t.type===e.type&&e.store.id===t.store.id&&Object.is(e.annotations,t.annotations);case"block":case"user":return t.type===e.type&&e.store.id===t.store.id;case"tab":return t.type===e.type&&e.tabId===t.tabId;case"deletionMarker":return t.type===e.type&&e.deletedText===t.deletedText&&e.store.id===t.store.id;default:return!1}}function dn(e){const t=(0,d().v3)(),{state:n,pinPopup:o,unpinPopup:r,hasBeenHovering:a,isPinned:u,dismissPopup:m}=function(){const[e]=(0,p().$y)(le().A),t=(0,c().l)(e,ln);return(0,ee().v)({immediateState:t,isEqual:ln})}(),g=function(e){const t=(0,d().v3)();return(0,p().K8)((()=>!!e&&(0,X().k)(t,e.store,e.spaceStore)),[e,t])}(n),h=(0,i.useMemo)((()=>Boolean(n&&function(e,t){switch(e.type){case"token":return e.annotations.some(U().sh$)||t&&e.annotations.some(U().N53)||e.annotations.some(U().rie)||e.annotations.some(U().XkZ)||e.annotations.some(U().ik2)||e.annotations.some(U().n5B);case"block":return Boolean(e.hyperlink);case"user":case"deletionMarker":return!0;case"tab":return!1;default:(0,N().HB)(e)}}(n,g))),[n,g]),v=(0,i.useMemo)((()=>n&&function(e){switch(e.type){case"token":return e.token.node.getBoundingClientRect();case"block":return re().K.getRect(e.store);case"user":case"tab":case"deletionMarker":return e.domRect;default:(0,N().HB)(e)}}(n)),[n]),f=v&&0===v.width&&0===v.height&&0===v.left&&0===v.top,y=(0,p().K8)((()=>{const e=se().A.state;return h?!f:Boolean(!e&&a&&!f)}),[h,f,a]),[,x]=(0,p().$y)(ae().A);(0,i.useEffect)((()=>(x({isPinned:u}),()=>x({isPinned:!1}))),[u,x]);const b=(0,i.useMemo)((()=>"token"===(null==n?void 0:n.type)&&(null==n?void 0:n.annotations.some(U().n5B))),[n]),k=!("token"!==(null==n?void 0:n.type)||null!=n&&n.annotations.some(U().N53)||null!=n&&n.annotations.some(U().jIt)||b),I=(0,i.useMemo)((()=>"token"===(null==n?void 0:n.type)&&(null==n?void 0:n.annotations.some(U().nNl))),[n]),w=(0,i.useMemo)((()=>("token"===(null==n?void 0:n.type)?null==n?void 0:n.annotations.some(U().rie):"user"===(null==n?void 0:n.type))??!1),[n]),A=(0,i.useMemo)((()=>"token"===(null==n?void 0:n.type)&&(null==n?void 0:n.annotations.some(U().XkZ))),[n]),C=(0,i.useCallback)((()=>w||A?"end":I?"center":"start"),[w,A,I]),T=(0,i.useCallback)((()=>w||A||b?"top":"bottom"),[w,A,b]),B=(0,p().O$)(t.RouterStore);return(0,i.useEffect)((()=>{m()}),[B,m]),(0,i.useEffect)((()=>{const e=H().nF((()=>{ae().A.state.isPinned||(F().co(),m())}),200,{leading:!0});return(0,s().P)(window,"scroll",e,!0),()=>(0,l().O)(window,"scroll",e,!0)}),[m]),(0,Re.jsx)(j().zD,{disableMouseCapture:!0,preventCaptureEsc:!0,preventPointerEvents:y&&!h,preventScaleTransition:!0,preventOpacityTransition:!0,popupType:S().n.Popup,open:y,originRect:v,originGap:6,alignmentToOrigin:C(),placementToOrigin:T(),lightBoxShadow:k,render:()=>n&&(0,Re.jsx)("div",{onMouseOver:o,onMouseLeave:r,children:(0,Re.jsx)(cn,{state:n,isHoveredTokenEditable:g,onDismiss:r,originRect:v})}),...I?{borderRadius:6}:{}})}function cn(e){const t=e.state.spaceStore,n=(0,m().IS)((()=>({noMembersInGroupStyle:{fontSize:K().J.UISmall.desktop,color:W().Tj.text.secondary,padding:"4px 8px"}})),[]),i="token"===e.state.type?e.state.annotations:void 0,o=null==i?void 0:i.find(U().ik2),s=(0,p().K8)((()=>{if((0,$().YE)()&&o)return U().q1R(o)}),[o]),a=null==i?void 0:i.find(U().sh$),l=null==i?void 0:i.find(U().qsB),d=null==i?void 0:i.find(U().RaC),c=null==i?void 0:i.find(U().go0),u=i?U().MzR(i):void 0,g=null==i?void 0:i.find(U().jIt),h=null==i?void 0:i.find(U().bZo),v=null==i?void 0:i.find(U().muW),f=null==i?void 0:i.find(U().rie),y=null==i?void 0:i.find(U().XkZ),j=null==i?void 0:i.find(U().nNl),S=null==i?void 0:i.find(U().n5B),b=(0,p().K8)((()=>{if(!d)return;const e=U().FHi(d);if(!e)return;return t?(0,te().E)({groupId:null==e?void 0:e.groupId,spaceStore:t}).getModel():void 0}),[t,d]);if(null==i?void 0:i.some((e=>{if(U().JCc(e)){const t=U().FLg(e);return t&&"everyone"!==t.mentionType}return!1})))return null;if("user"===e.state.type&&!r().A.isMobile)return(0,Re.jsx)(rn,{...e,state:e.state,onDismiss:e.onDismiss});if("tab"===e.state.type){const t=e.state;return(0,Re.jsx)(wn,{...e,state:t,onDismiss:e.onDismiss})}if("deletionMarker"===e.state.type)return(0,Re.jsx)(mn,{state:e.state});if("token"!==e.state.type)return null;if(a&&e.state.store.table!==O().SN)return(0,Re.jsx)(gt,{...e,state:{...e.state,annotation:a}});if(l)return(0,Re.jsx)(pn,{...e,state:{...e.state,annotation:l}});if(d){if(U().FHi(d)&&b)return(0,Re.jsx)(he().Q,{group:b,limit:10,color:"white_background",trackHover:!0,noMembersMessage:(0,Re.jsx)(x().Ye,{style:n.noMembersInGroupStyle,children:(0,Re.jsx)("div",{style:K().RC,children:(0,Re.jsx)(L().sA,{id:"groupPreview.noUsers",defaultMessage:"No users in this group"})})})})}else if(s&&!r().A.isMobile)return(0,Re.jsx)(qe,{state:e.state,isHoveredTokenEditable:e.isHoveredTokenEditable,linkMentionAnnotationData:s,onDismiss:e.onDismiss});return j?(0,Re.jsx)(un,{...e,state:{...e.state,annotation:j},currentSpaceStore:t}):c?(0,Re.jsx)(gn,{...e,state:{...e.state,annotation:c}}):u&&!r().A.isMobile?(0,Re.jsx)(In,{...e,state:{...e.state,annotation:u},onDismiss:e.onDismiss}):h&&"block"===h[1].type&&void 0!==h[1].citationNumber&&!r().A.isMobile?(0,Re.jsx)(Ge,{...e,state:{...e.state,annotation:h},onDismiss:e.onDismiss}):g&&!r().A.isMobile?U().vqC(g)?null:(0,Re.jsx)(wn,{...e,state:{...e.state,annotation:g},onDismiss:e.onDismiss}):v&&!r().A.isMobile?(0,Re.jsx)(An,{...e,state:{...e.state,annotation:v},onDismiss:e.onDismiss}):f?(0,Re.jsx)(rn,{...e,state:{...e.state,annotation:f},onDismiss:e.onDismiss}):y&&!r().A.isMobile?(0,Re.jsx)(Oe,{...e,state:{...e.state,annotation:y},onDismiss:e.onDismiss}):S?(0,Re.jsx)(G().YY,{store:e.state.store,annotation:S,onDismiss:e.onDismiss}):null}function un(e){var t,n;const{store:i,annotation:o}=e.state,r=U().qS0(o),s=r&&f().P.createChildStore(i,r),a=(0,p().K8)((()=>{if(null!=s&&s.isDefined())return null==s?void 0:s.getModel().getRenderTitle()}),[s]),l=(0,p().K8)((()=>(0,Z().wA)({spaceStore:e.currentSpaceStore})),[e.currentSpaceStore]),d=(0,m().IS)((()=>({container:{backgroundColor:W().Tj.background.accentPrimary,padding:"4px 8px",maxWidth:250,width:"max-content"},text:{color:W().Tj.text.inverseSecondary}})),[]);return s?(0,Re.jsx)("div",{style:d.container,children:(0,Re.jsx)(Y().A,{type:"custom",customEmojiStore:s,text:(0,Re.jsx)("span",{className:"notranslate",children:a}),deletedText:(0,Re.jsx)(L().sA,{defaultMessage:"{name} <medium>(deleted)</medium>",id:"HoverPreviewOverlay.customEmojiDeleted",values:{name:(0,Re.jsx)("span",{className:"notranslate",children:a}),medium:e=>(0,Re.jsx)("span",{style:d.text,children:e})}}),subText:null!==(t=e.currentSpaceStore)&&void 0!==t&&t.id&&r.spaceId!==(null===(n=e.currentSpaceStore)||void 0===n?void 0:n.id)&&l?(0,Re.jsx)("span",{style:d.text,children:(0,Re.jsx)(L().sA,{id:"HoverPreviewOverlay.customEmojiUpload",defaultMessage:"Right-click to add to your workspace"})}):void 0})}):null}function pn(e){const{annotation:t}=e.state,n=U().K7D(t),i=(0,m().IS)((()=>({container:{fontSize:K().J.UISmall.desktop,color:W().Tj.text.secondary,padding:"4px 8px"},icon:{height:"1em",width:"1em",marginInlineEnd:"0.25em"}})),[]),o=(0,L().tz)(),r="relative"===n.date_format?"ll":"relative",s=(0,w().ZF)({value:n,date_format:r,time_format:"h:mm A",allowRelativeDates:!0,intl:o});return s===(0,w().ZF)({value:n,date_format:n.date_format,time_format:n.time_format,allowRelativeDates:!0,intl:o})?null:(0,Re.jsxs)(x().Ye,{style:i.container,alignItems:"center",children:[(0,Re.jsx)(k().I,{icon:D().Y,colorVariant:"secondary",style:i.icon}),(0,Re.jsx)("div",{style:K().RC,children:s})]})}function mn(e){const{deletedText:t}=e.state,n=(0,m().eP)(),o=(0,i.useRef)(null),[r,s]=(0,i.useState)(!1);(0,i.useEffect)((()=>{const e=o.current;e&&s(e.scrollHeight>e.clientHeight)}),[t]);const a=(0,m().IS)((()=>({container:{padding:"8px 12px",minWidth:100,width:"max-content",maxWidth:"min(400px, 90vw)",position:"relative"},header:{display:"flex",alignItems:"center",gap:4,marginBottom:4,color:W().Tj.red.text.secondary,flexShrink:0},textContainer:{maxHeight:"min(300px, 50vh)",overflowY:"auto",whiteSpace:"pre-wrap",wordBreak:"break-word",scrollbarWidth:"thin",paddingBottom:r?12:0},text:{color:W().Tj.text.primary},overflowFade:{position:"absolute",bottom:0,insetInlineStart:0,insetInlineEnd:0,height:24,background:"dark"===n?"linear-gradient(to top, rgba(32,32,32, 1), transparent)":"linear-gradient(to top, rgba(255,255,255, 1), transparent)",pointerEvents:"none",borderStartStartRadius:0,borderStartEndRadius:0,borderEndEndRadius:4,borderEndStartRadius:4}})),[n,r]);return(0,Re.jsxs)("div",{style:a.container,children:[(0,Re.jsxs)("div",{style:a.header,children:[(0,Re.jsx)(A().G,{stroke:W().Tj.red.text.secondary}),(0,Re.jsx)(I().D,{styleKey:"bodySmMedium",children:(0,Re.jsx)(L().sA,{id:"HoverPreviewOverlay.deletedHeader",defaultMessage:"Deleted"})})]}),(0,Re.jsx)("div",{ref:o,style:a.textContainer,children:(0,Re.jsx)("span",{style:a.text,children:t})}),r?(0,Re.jsx)("div",{style:a.overflowFade}):null]})}function gn(e){const{annotation:t}=e.state,n=U().y0Y(t),i=(0,L().tz)(),o=(0,_().EC)(n.type,i),r=(0,m().IS)((()=>({container:{fontSize:K().J.UISmall.desktop,color:W().Tj.text.secondary,padding:"4px 8px"}})),[]);return(0,Re.jsx)(x().Ye,{style:r.container,alignItems:"center",children:(0,Re.jsx)("div",{style:K().RC,children:o})})}function hn(e){var t,n;const{renderConfig:i,store:o}=e,r=(0,d().v3)(),s=(0,m().IS)((()=>({title:{color:W().Tj.text.primary,fontWeight:K().Wy.semibold,whiteSpace:"initial",fontSize:13,padding:"4px 0",width:"100%"},header:{color:W().Tj.text.secondary,fontSize:K().J.UISmall.desktop},dictionaryKey:{color:W().Tj.text.tertiary,fontWeight:K().Wy.regular,fontSize:K().J.UISmall.desktop},dictionaryValue:{color:W().Tj.text.secondary,fontSize:K().J.UISmall.desktop,whiteSpace:"normal",wordBreak:"break-word"}})),[]),a=null===(t=i.previewImageAttribute)||void 0===t?void 0:t.values[0],l=o.pointer,[c]=(0,B().Yb)((async()=>{if(!a)return;const e={isAuthenticated:!0,url:a,permissionRecord:l};return(0,oe().L)(e,r)}),[r,a,l]);return(0,Re.jsxs)(Re.Fragment,{children:[i.title?(0,Re.jsx)(x().Ye,{children:(0,Re.jsx)(q().Ic,{...i.title,store:o,style:s.title})}):void 0,i.headerAttributes&&i.headerAttributes.length>0?(0,Re.jsx)(x().Ye,{alignItems:"center",style:{...s.header,marginBottom:8},children:(0,R().G)(i.headerAttributes.map(((e,t)=>(0,Re.jsx)(q().Ic,{...e,store:o,style:{...s.header,...K().RC}},`attribute-${t}`)))||[],(e=>(0,Re.jsxs)("span",{children:["Â ","Â·","Â "]},`dot-${e}`)))}):void 0,i.dictionaryAttributes&&i.dictionaryAttributes.length>0?(0,Re.jsx)(x().wt,{children:i.dictionaryAttributes.map((({key:e,value:t},n)=>{var r;return(0,Re.jsxs)(x().Ye,{style:{marginBottom:n!==((null===(r=i.dictionaryAttributes)||void 0===r?void 0:r.length)??0)-1?4:8},children:[(0,Re.jsx)("div",{style:{marginInlineEnd:8,width:"30%",display:"flex",alignItems:"center"},children:(0,Re.jsx)("span",{style:s.dictionaryKey,children:(0,Re.jsx)(L().sA,{...e.formatter,values:{value:t.attribute.name}})})}),(0,Re.jsxs)("div",{style:{width:"70%",display:"flex",alignItems:"center"},children:[t.icon&&(0,z().nN)(t.icon)?(0,Re.jsx)(de().A,{type:"image_url",imageURL:t.icon.values[0],size:16,style:{marginInlineEnd:6}}):void 0,(0,Re.jsx)(q().Ic,{...t,store:o,style:s.dictionaryValue,avatarStyle:{marginInlineEnd:6}})]})]},n)}))}):void 0,i.bodyAttribute&&!(0,z().Q7)(i.bodyAttribute)?(0,Re.jsx)(x().Ye,{style:((null===(n=i.dictionaryAttributes)||void 0===n?void 0:n.length)??0)>0?{marginTop:3}:{},children:(0,Re.jsx)(q().xq,{attribute:i.bodyAttribute,store:o})}):void 0,null!=c&&c.value?(0,Re.jsx)("div",{style:{marginTop:i.dictionaryAttributes?6:0,marginBottom:4,display:"flex",justifyContent:"center"},children:(0,Re.jsx)("div",{children:(0,Re.jsx)(ce().A,{src:c.value,style:{width:"100%",maxHeight:200}})})}):void 0]})}function vn(e,t){if(!e)return null;const n=e.find((e=>e.key.formatter.id===t));return n?n.value:null}function fn(e,t){if(!e)return null;return e.filter((e=>e.attribute&&t.includes(e.attribute.id)))}function yn(e,t){if(!e)return null;const n=e.find((e=>e.value.attribute.id===t));return n?n.value:null}function xn(e){var t;const{renderConfig:n,store:i,integration:o,haveInstanceAction:r,containerDivRef:s,token:l,parentBlockStore:d,onDismiss:c}=e,p=(0,m().IS)((()=>({title:{color:W().Tj.text.primary,fontWeight:K().Wy.medium,whiteSpace:"initial",fontSize:14,padding:"4px 0",width:"100%"},header:{color:W().Tj.text.secondary,fontSize:K().J.UISmall.desktop,paddingInlineStart:8,flexGrow:1,fontWeight:K().Wy.regular},dictionaryValue:{color:W().Tj.text.primary,fontSize:K().J.UISmall.desktop,whiteSpace:"normal",wordBreak:"break-word"},buttonOrigin:{display:"flex",alignItems:"center",justifyContent:"center",width:24,height:24,borderRadius:4,fill:W().Tj.icon.tertiary},innerBox:{width:"fit-content",display:"flex",alignItems:"center",gap:4}})),[]),g=null===(t=vn(n.dictionaryAttributes,"unfurling.github.pullRequest"))||void 0===t?void 0:t.attribute.values[0],h=vn(n.dictionaryAttributes,"unfurling.generic.status"),v=vn(n.dictionaryAttributes,"unfurling.generic.author"),f=function(e,t){if(!e)return null;return e.find((e=>e.formatter&&t.includes(e.formatter.id)))||null}(n.headerAttributes,["unfurling.github.githubPullMerged","unfurling.github.githubPullClosed","unfurling.github.githubPullOpened"]);return(0,Re.jsxs)("div",{style:{display:"flex",flexDirection:"column",width:295},children:[(0,Re.jsxs)(x().Ye,{alignItems:"center",style:{fontSize:12},children:[(0,Re.jsxs)(Re.Fragment,{children:[(0,Re.jsx)(de().A,{type:"image_url",imageURL:o.icon,size:16,style:{marginInlineEnd:4}}),(0,Re.jsx)("div",{style:{fontWeight:K().Wy.medium},children:"GitHub"})]}),g?(0,Re.jsx)("div",{style:p.header,children:(0,Re.jsx)(L().sA,{id:"unfurling.github.pullRequestNo",defaultMessage:"PR {prNumber}",values:{prNumber:g}})}):void 0,r?void 0:(0,Re.jsx)("div",{style:{position:"relative"},children:(0,Re.jsx)(b().A,{popupType:b().z.Popup,placementToOrigin:"right",alignmentToOrigin:"start",originGap:4,onClose:()=>{let e=!1;const t=s.current;t&&(e=(0,a().ux)(t.getBoundingClientRect(),u().$C.x,u().$C.y)),e||null==c||c()},renderOrigin:e=>(0,Re.jsx)(y().Ay,{style:p.buttonOrigin,...e,children:(0,Re.jsx)(k().I,{icon:M().ellipsisIcon})}),render:e=>(0,Re.jsx)(V().ExternalObjectInstanceBlockMenu,{titleForReloadMenuOption:(0,Re.jsx)(L().sA,{id:"linkMention.reload",defaultMessage:"Reload mention"}),parentBlockStore:d,store:i,token:l,onAccept:()=>e.close(),extraSecondaryItemKey:"mention_to_preview"})})})]}),n.title?(0,Re.jsx)(x().Ye,{children:(0,Re.jsx)(q().Ic,{...n.title,store:i,style:p.title})}):void 0,(0,Re.jsxs)(x().Ye,{style:{gap:4,alignSelf:"stretch",alignItems:"center"},children:[h?(0,Re.jsxs)("div",{style:{width:"fit-content",display:"flex",alignItems:"center"},children:[h.icon&&(0,z().nN)(h.icon)?(0,Re.jsx)(de().A,{type:"image_url",imageURL:h.icon.values[0],size:14}):void 0,(0,Re.jsx)(q().Ic,{...h,store:i,style:p.dictionaryValue,avatarStyle:{marginInlineEnd:6}})]}):void 0,(0,Re.jsxs)("div",{style:{lineHeight:"16px",display:"flex",gap:4},children:[f?(0,Re.jsx)("div",{style:p.innerBox,children:(0,Re.jsx)(q().Ic,{attribute:f.attribute,store:i,style:p.dictionaryValue})}):void 0,v?(0,Re.jsxs)("div",{style:p.innerBox,children:[(0,Re.jsx)("div",{style:p.dictionaryValue,children:(0,Re.jsx)(L().sA,{id:"unfurling.generic.by",defaultMessage:"by"})}),v.icon&&(0,z().nN)(v.icon)?(0,Re.jsx)(de().A,{type:"image_url",imageURL:v.icon.values[0],size:16,style:{marginInlineStart:4}}):void 0,(0,Re.jsx)(q().Ic,{...v,store:i,style:p.dictionaryValue})]}):void 0]})]})]})}function jn(e){const{renderConfig:t,store:n,integration:i,haveInstanceAction:o,containerDivRef:r,token:s,parentBlockStore:l,onDismiss:d}=e,c=(0,m().IS)((()=>({dictionaryValue:{color:W().Tj.text.primary,fontSize:K().J.UISmall.desktop,whiteSpace:"normal",wordBreak:"break-word"},buttonOrigin:{display:"flex",alignItems:"center",justifyContent:"center",width:24,height:24,borderRadius:4,fill:W().Tj.icon.tertiary},actionButton:{position:"absolute",top:10,insetInlineEnd:10,zIndex:2}})),[]),p=vn(t.dictionaryAttributes,"unfurling.generic.lastModifiedBy"),g=vn(t.dictionaryAttributes,"unfurling.generic.lastModifiedAt");return(0,Re.jsxs)("div",{style:{display:"flex",flexDirection:"column",width:295},children:[(0,Re.jsx)(x().Ye,{alignItems:"center",style:{fontSize:12},children:(0,Re.jsxs)(Re.Fragment,{children:[(0,Re.jsx)(de().A,{type:"image_url",imageURL:i.icon,size:16,style:{marginInlineEnd:4}}),(0,Re.jsx)("div",{style:{fontWeight:K().Wy.medium},children:"Figma"})]})}),(0,Re.jsxs)(x().Ye,{style:{gap:4,alignSelf:"stretch",alignItems:"center"},children:[g?(0,Re.jsxs)("div",{style:{width:"fit-content",display:"flex",alignItems:"center",gap:4},children:[(0,Re.jsx)("div",{style:c.dictionaryValue,children:(0,Re.jsx)(L().sA,{id:"unfurling.generic.editor",defaultMessage:"Edited"})}),(0,Re.jsx)(q().Ic,{...g,store:n,style:c.dictionaryValue})]}):void 0,p?(0,Re.jsxs)("div",{style:{width:"fit-content",display:"flex",alignItems:"center",gap:4},children:[(0,Re.jsx)("div",{style:c.dictionaryValue,children:(0,Re.jsx)(L().sA,{id:"unfurling.generic.from",defaultMessage:"by"})}),p.icon&&(0,z().nN)(p.icon)?(0,Re.jsx)(de().A,{type:"image_url",imageURL:p.icon.values[0],size:16,style:{marginInlineStart:4}}):void 0,(0,Re.jsx)(q().Ic,{...p,store:n,style:c.dictionaryValue})]}):void 0]}),t.previewImageAttribute?(0,Re.jsx)("div",{style:{marginTop:t.dictionaryAttributes?6:0,marginBottom:4,display:"flex",justifyContent:"center"},children:(0,Re.jsx)("div",{children:(0,Re.jsx)(ce().A,{src:t.previewImageAttribute.values[0],style:{width:"100%",maxHeight:200}})})}):void 0,o?void 0:(0,Re.jsx)("div",{style:c.actionButton,children:(0,Re.jsx)(b().A,{popupType:b().z.Popup,placementToOrigin:"right",alignmentToOrigin:"start",originGap:4,onClose:()=>{let e=!1;const t=r.current;t&&(e=(0,a().ux)(t.getBoundingClientRect(),u().$C.x,u().$C.y)),e||null==d||d()},renderOrigin:e=>(0,Re.jsx)(y().Ay,{style:c.buttonOrigin,...e,children:(0,Re.jsx)(k().I,{icon:M().ellipsisIcon})}),render:e=>(0,Re.jsx)(V().ExternalObjectInstanceBlockMenu,{titleForReloadMenuOption:(0,Re.jsx)(L().sA,{id:"linkMention.reload",defaultMessage:"Reload mention"}),parentBlockStore:l,store:n,token:s,onAccept:()=>e.close(),extraSecondaryItemKey:"mention_to_preview"})})})]})}function Sn(e){var t;const{renderConfig:n,store:i,integration:o,haveInstanceAction:r,containerDivRef:s,token:l,parentBlockStore:d,onDismiss:c}=e,p=(0,m().IS)((()=>({dictionaryValue:{color:W().Tj.text.primary,fontSize:K().J.UISmall.desktop,whiteSpace:"normal",wordBreak:"break-word"},channelValue:{color:W().Tj.text.secondary,fontSize:K().J.UISmall.desktop,whiteSpace:"normal",wordBreak:"break-word"},buttonOrigin:{display:"flex",alignItems:"center",justifyContent:"center",width:24,height:24,borderRadius:4,fill:W().Tj.icon.tertiary},author:{paddingTop:8,alignSelf:"stretch",alignItems:"center"},actionButton:{position:"absolute",top:10,insetInlineEnd:10,zIndex:2}})),[]),g=vn(n.dictionaryAttributes,"unfurling.generic.author"),h=function(e,t){if(!e)return null;return e.find((e=>e.key.formatter.id===t))||null}(n.dictionaryAttributes,"unfurling.slack.slackReplyCount"),v=fn(n.headerAttributes,["title","name"]),f=fn(n.headerAttributes,["sent_at"]),j=H().hS(n.icons||[],(e=>`${e.type}:${e.values[0].toString()}`)),S=j.length>5?5:j.length;return(0,Re.jsxs)("div",{style:{display:"flex",flexDirection:"column",width:295},children:[(0,Re.jsxs)(x().Ye,{alignItems:"center",style:{fontSize:12},children:[(0,Re.jsxs)(Re.Fragment,{children:[(0,Re.jsx)(de().A,{type:"image_url",imageURL:o.icon,size:16,style:{padding:2}}),(0,Re.jsx)("div",{style:{fontWeight:K().Wy.medium,marginInlineEnd:8},children:"Slack"})]}),v&&v.length>0?(0,Re.jsx)(q().Ic,{attribute:v[0].attribute,store:i,style:p.channelValue,avatarStyle:{marginInlineEnd:6}}):void 0]}),(0,Re.jsxs)(x().Ye,{style:p.author,children:[g?(0,Re.jsx)("div",{style:{width:"fit-content",display:"flex",alignItems:"center"},children:(0,Re.jsx)(q().Ic,{...g,store:i,style:p.dictionaryValue})}):void 0,f?(0,Re.jsx)("div",{style:{marginInlineStart:8},children:(0,Re.jsx)(q().Ic,{...f[0],store:i,style:p.channelValue})}):void 0]}),(0,Re.jsxs)(x().wt,{style:{gap:8},children:[n.bodyAttribute&&!(0,z().Q7)(n.bodyAttribute)?(0,Re.jsx)(x().Ye,{style:((null===(t=n.dictionaryAttributes)||void 0===t?void 0:t.length)??0)>0?{marginTop:3}:{},children:(0,Re.jsx)(q().xq,{attribute:n.bodyAttribute,store:i})}):void 0,(0,Re.jsxs)(x().Ye,{style:{alignSelf:"stretch",alignItems:"center"},children:[n.icons&&h?(0,Re.jsx)(kn,{renderConfig:n}):void 0,h?(0,Re.jsx)(q().Ic,{formatter:h.key.formatter,attribute:h.value.attribute,store:i,style:{...p.channelValue,transform:`translateX(-${3*(S-1)}px)`},avatarStyle:{marginInlineEnd:6}}):void 0]})]}),r?void 0:(0,Re.jsx)("div",{style:p.actionButton,children:(0,Re.jsx)(b().A,{popupType:b().z.Popup,placementToOrigin:"right",alignmentToOrigin:"start",originGap:4,onClose:()=>{let e=!1;const t=s.current;t&&(e=(0,a().ux)(t.getBoundingClientRect(),u().$C.x,u().$C.y)),e||null==c||c()},renderOrigin:e=>(0,Re.jsx)(y().Ay,{style:p.buttonOrigin,...e,children:(0,Re.jsx)(k().I,{icon:M().ellipsisIcon})}),render:e=>(0,Re.jsx)(V().ExternalObjectInstanceBlockMenu,{titleForReloadMenuOption:(0,Re.jsx)(L().sA,{id:"linkMention.reload",defaultMessage:"Reload mention"}),parentBlockStore:d,store:i,token:l,onAccept:()=>e.close(),extraSecondaryItemKey:"mention_to_preview"})})})]})}function bn(e){const{renderConfig:t,store:n,integration:i,haveInstanceAction:o,containerDivRef:r,token:s,parentBlockStore:l,onDismiss:d,fileType:c}=e,p=(0,m().IS)((()=>({dictionaryValue:{color:W().Tj.text.primary,fontSize:K().J.UISmall.desktop,whiteSpace:"normal",wordBreak:"break-word"},buttonOrigin:{display:"flex",alignItems:"center",justifyContent:"center",width:24,height:24,borderRadius:4,fill:W().Tj.icon.tertiary},actionButton:{position:"absolute",top:10,insetInlineEnd:10,zIndex:2},imageBackground:{marginTop:t.dictionaryAttributes?6:0,marginBottom:4,display:"flex",justifyContent:"center",padding:"docs"===c?"14px 54px":"14px 34px",borderRadius:6,background:"doc"===c?"#4285F4":"sheet"===c?"#34A853":"#F8CB4A"}})),[c,t.dictionaryAttributes]),g=yn(t.dictionaryAttributes,"username"),h=yn(t.dictionaryAttributes,"updated_at"),v="doc"===c?"Google Docs":"sheet"===c?"Google Sheets":"Google Slides";return(0,Re.jsxs)("div",{style:{display:"flex",flexDirection:"column",width:288},children:[(0,Re.jsx)(x().Ye,{alignItems:"center",style:{fontSize:12},children:(0,Re.jsxs)(Re.Fragment,{children:[(0,Re.jsx)(de().A,{type:"image_url",imageURL:i.icon,size:16,style:{marginInlineEnd:4}}),(0,Re.jsx)("div",{style:{fontWeight:K().Wy.medium},children:v})]})}),(0,Re.jsxs)(x().Ye,{style:{gap:4,alignSelf:"stretch",alignItems:"center"},children:[h?(0,Re.jsxs)("div",{style:{width:"fit-content",display:"flex",alignItems:"center",gap:4},children:[(0,Re.jsx)("div",{style:p.dictionaryValue,children:(0,Re.jsx)(L().sA,{id:"unfurling.generic.editor",defaultMessage:"Edited"})}),(0,Re.jsx)(q().Ic,{...h,store:n,style:p.dictionaryValue})]}):void 0,g?(0,Re.jsxs)("div",{style:{width:"fit-content",display:"flex",alignItems:"center",gap:4},children:[(0,Re.jsx)("div",{style:p.dictionaryValue,children:(0,Re.jsx)(L().sA,{id:"unfurling.generic.from",defaultMessage:"by"})}),(0,Re.jsx)(q().Ic,{...g,store:n,style:p.dictionaryValue})]}):void 0]}),t.previewImageAttribute?(0,Re.jsx)("div",{style:p.imageBackground,children:(0,Re.jsx)("div",{children:(0,Re.jsx)(ce().A,{src:t.previewImageAttribute.values[0],style:{width:"100%",maxHeight:200}})})}):void 0,o?void 0:(0,Re.jsx)("div",{style:p.actionButton,children:(0,Re.jsx)(b().A,{popupType:b().z.Popup,placementToOrigin:"right",alignmentToOrigin:"start",originGap:4,onClose:()=>{let e=!1;const t=r.current;t&&(e=(0,a().ux)(t.getBoundingClientRect(),u().$C.x,u().$C.y)),e||null==d||d()},renderOrigin:e=>(0,Re.jsx)(y().Ay,{style:p.buttonOrigin,...e,children:(0,Re.jsx)(k().I,{icon:M().ellipsisIcon})}),render:e=>(0,Re.jsx)(V().ExternalObjectInstanceBlockMenu,{titleForReloadMenuOption:(0,Re.jsx)(L().sA,{id:"linkMention.reload",defaultMessage:"Reload mention"}),parentBlockStore:l,store:n,token:s,onAccept:()=>e.close(),extraSecondaryItemKey:"mention_to_preview"})})})]})}function kn({renderConfig:e}){const t=H().hS(e.icons||[],(e=>`${e.type}:${e.values[0].toString()}`));return t.length>=2?(0,Re.jsx)(x().Ye,{style:{height:16,gap:-5.333,justifyContent:"flex-end"},children:t.slice(0,5).map(((e,t)=>(0,Re.jsx)(q().Tr,{attribute:e,isSmall:!0,isUltraSmall:!0,style:{zIndex:10-t,transform:`translateX(${-5*t}px)`,position:"relative"}},t)))}):1===t.length?(0,Re.jsx)("div",{style:{paddingInlineEnd:4},children:(0,Re.jsx)(q().Tr,{attribute:t[0],isSmall:!0,isUltraSmall:!0})}):null}function In(e){const{state:{annotation:t,store:n,token:o},onDismiss:r}=e,s=U().T$c(t),l=(0,d().v3)(),c=(0,m().eP)(),v=(0,i.useRef)(null),[f,j]=(0,i.useState)(!1),[S,I]=(0,i.useState)(!1),w=(0,p().K8)((()=>{const t=h().B.createChildStore(n,{table:P().ev,id:s,spaceId:n.pointer.spaceId}),i=t.canEdit(),d=(0,$().yO)(),p=(0,J().Su)({store:t,isInDarkMode:"dark"===c,canEdit:i,currentUserId:l.currentUser.id,getRenderFn:e=>t=>{var n,i;return(null===(n=e.hover)||void 0===n?void 0:n.call(e,t))||(null===(i=C().u.hover)||void 0===i?void 0:i.call(C().u,t))},showAction:void 0});if(!p)return;if(!g().A.state.online)return;const{renderConfig:m,integration:f}=p,S=Boolean(p.action),w=e.isHoveredTokenEditable,A=n.recordStoreUIParentStore&&n.recordStoreUIParentStore instanceof h().B?n.recordStoreUIParentStore:void 0,B=f.id===T().Hd&&"error"===(null==p?void 0:p.action)&&428===(null==p?void 0:p.status_code),D=f.id===T().Hd&&"update"===(null==p?void 0:p.action);if(j(B),I(D),d){if(f.id===T().bh||f.id===T().ZY)return(0,Re.jsx)(xn,{store:t,integration:f,renderConfig:m,haveInstanceAction:S,containerDivRef:v,token:o,parentBlockStore:A,onDismiss:r});if(f.id===T().e1)return(0,Re.jsx)(jn,{store:t,integration:f,renderConfig:m,haveInstanceAction:S,containerDivRef:v,token:o,parentBlockStore:A,onDismiss:r});if(f.id===T().zG)return(0,Re.jsx)(Sn,{store:t,integration:f,renderConfig:m,haveInstanceAction:S,containerDivRef:v,token:o,parentBlockStore:A,onDismiss:r});if(f.id===T().Hd){const e=t.getFormat().uri;let n="drive";if(e&&(n=e.includes("spreadsheets")?"sheet":e.includes("document")?"doc":e.includes("presentation")?"slide":"drive"),"drive"!==n)return(0,Re.jsx)(bn,{store:t,integration:f,renderConfig:m,haveInstanceAction:S,containerDivRef:v,token:o,parentBlockStore:A,onDismiss:r,fileType:n})}}return(0,Re.jsxs)("div",{style:{display:"flex",flexDirection:"column"},ref:v,children:[B?void 0:(0,Re.jsxs)(x().Ye,{alignItems:"center",style:{fontSize:12},children:[D?null:(0,Re.jsxs)(Re.Fragment,{children:[(0,Re.jsx)(de().A,{type:"image_url",imageURL:f.icon,size:16,style:{margin:4}}),(0,Re.jsx)("div",{style:{flexGrow:1,fontWeight:K().Wy.medium},children:f.name})]}),o&&!S&&w?(0,Re.jsx)("div",{children:(0,Re.jsx)(b().A,{popupType:b().z.Popup,placementToOrigin:"right",alignmentToOrigin:"start",originGap:4,onClose:()=>{let e=!1;const t=v.current;t&&(e=(0,a().ux)(t.getBoundingClientRect(),u().$C.x,u().$C.y)),e||null==r||r()},renderOrigin:e=>(0,Re.jsx)(y().Ay,{style:{display:"flex",alignItems:"center",justifyContent:"center",width:24,height:24,borderRadius:4,fill:W().Tj.icon.tertiary},...e,children:(0,Re.jsx)(k().I,{icon:M().ellipsisIcon})}),render:e=>(0,Re.jsx)(V().ExternalObjectInstanceBlockMenu,{titleForReloadMenuOption:(0,Re.jsx)(L().sA,{id:"linkMention.reload",defaultMessage:"Reload mention"}),parentBlockStore:A,store:t,token:o,onAccept:()=>e.close(),extraSecondaryItemKey:"mention_to_preview"})})}):void 0]}),S&&w?(0,Re.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",margin:"6px 0"},children:(0,Re.jsx)(ge().A,{canEdit:i,store:t,isHoverPreview:!0,postActionCallback:r})}):(0,Re.jsx)(hn,{renderConfig:m,store:t})]})}),[s,n,l,c,o,r,e.isHoveredTokenEditable,v]);return w?(0,Re.jsx)("div",{style:{padding:S?"0px 4px":f?"0px 15px":"12px 16px",minWidth:260,maxWidth:450},children:w}):null}function wn(e){const t=(0,d().v3)(),{store:n,contentBlockStart:i}=(0,p().K8)((()=>{const t=e.state.store;if(!t)return{store:void 0,contentBlockStart:void 0};const n="token"===e.state.type?e.state.annotation[1]:e.state.store.pointer.id,i=h().B.createChildStore(t,{id:n,table:"block"});if(!i.isNavigableBlock()){var o;const e=null===(o=i.getNavigableBlockStore())||void 0===o?void 0:o.pointer;return{store:e?h().B.createChildStore(t,e):void 0,contentBlockStart:i}}return i.isDefined()?{store:i}:{store:void 0,contentBlockStart:void 0}}),[e.state]),o=(0,p().K8)((()=>!!n&&(0,ne().Wi)(t,n.id)),[n,t]),r=(0,Q().ME)(n);return o?null:n&&r&&e.originRect?(0,Re.jsx)(yt,{store:n,closestNonAliveAncestorStore:r,originRect:e.originRect}):(0,Re.jsx)(sn().y,{store:n,contentBlocks:i&&[i]})}function An(e){const t=(0,d().v3)(),{collectionStore:n,parentCollectionViewBlockStore:i}=(0,p().K8)((()=>{var t;const n=(null==e?void 0:e.state.spaceStore)??(null===(t=o().default.state.mainEditorCurrentBlockStore)||void 0===t?void 0:t.getSpaceStore());if(!n)return{collectionStore:void 0,parentCollectionViewBlockStore:void 0};const i=e.state.annotation[1],r=v().m.createChildStore(n,{id:i,table:E().Vl});return{collectionStore:r,parentCollectionViewBlockStore:r.getParentCollectionViewBlockStore()}}),[e.state.annotation,e.state.spaceStore]),r=(0,Q().ME)(i),s=(0,p().K8)((()=>!(null!=n&&n.getAlive())||Boolean(r)),[n,r]),a=(0,p().K8)((()=>!!i&&(0,ne().Wi)(t,i.id)),[i,t]);return n&&i&&!a?s&&e.originRect?(0,Re.jsx)(yt,{store:n,closestNonAliveAncestorStore:r,originRect:e.originRect}):(0,Re.jsx)(Cn,{collectionStore:n,parentCollectionViewBlockStore:i}):null}function Cn(e){const{collectionStore:t,parentCollectionViewBlockStore:n,events:i,size:o="regular"}=e,r=(0,Ke().d)(),s=(0,p().K8)((()=>null==t?void 0:t.getIcon()),[t]);return t&&n?(0,Re.jsxs)("div",{style:r.wrapper,...i,children:[(0,Re.jsx)("div",{style:r.coverContainer,children:(0,Re.jsx)(ie().d,{store:n,disabled:!0,paddingLeft:0,paddingRight:0,height:36,proxyWidth:260})}),(0,Re.jsx)(ue().B6,{disabled:!0,icon:s,iconRecordCategory:"collection",isEmptyPage:!1,isLarge:!0,disableShrinking:!0,size:26,emojiSize:26,largeIcon:!0,style:r.pageTitleIcon}),(0,Re.jsxs)(x().wt,{gap:4,style:r.content,children:[(0,Re.jsxs)(x().wt,{gap:2,children:[(0,Re.jsx)(pe().Ay,{store:t,style:r.breadcrumb}),(0,Re.jsx)("div",{style:r.pageTitleContainer,children:(0,Re.jsx)(me().A,{shouldWrap:!0,maxLines:2,store:t,style:r.pageTitle})})]}),(0,Re.jsx)(an().f,{store:n,size:o})]})]}):null}},881254:(e,t,n)=>{n.d(t,{R:()=>D});var i=n(296540),o=()=>n(692031),r=()=>n(212497),s=()=>n(587682),a=()=>n(908006),l=()=>n(484714),d=()=>n(275144),c=()=>n(401497),u=()=>n(295633),p=()=>n(874832),m=()=>n(718827),g=()=>n(249046),h=()=>n(250910),v=()=>n(807449),f=()=>n(695115),y=()=>n(951105),x=()=>n(126617),j=()=>n(703778),S=()=>n(523389),b=()=>n(69708),k=()=>n(100622),I=()=>n(284371),w=()=>n(957690),A=()=>n(115512),C=()=>n(854672),T=()=>n(738471),B=()=>n(904694),M=n(474848);function D(e){const t=(0,l().v3)(),{hoverData:n,href:D,handleEditClick:R,showEditButton:P,loading:E,store:O,token:U,onDismiss:_}=e,z=(0,c().eP)(),L=(0,c().IS)((()=>({newWrapper:{width:280,flexDirection:"column",alignItems:"flex-start"},coverContainer:{width:280,height:120},contentNew:{display:"flex",flexDirection:"column",alignItems:"flex-start",padding:"12px 16px",gap:12,width:280},titleAndDescription:{display:"flex",flexDirection:"column",alignItems:"flex-start",padding:0,gap:2,width:248},linkTitle:{...(0,A().pA)(2),fontStyle:"normal",fontWeight:I().Wy.semibold,fontSize:14,lineHeight:"143%",fontFeatureSettings:"'case' on",textOverflow:"ellipsis",color:k().Tj.text.primary},newDescription:{display:"flex",flexDirection:"column",alignItems:"flex-start",padding:0,...(0,A().pA)(3),textOverflow:"ellipsis",width:248},newText:{fontSize:12,fontWeight:400,whiteSpace:"normal",wordBreak:"break-word",color:k().Tj.text.primary},buttonStyle:{display:"flex",alignItems:"center",justifyContent:"center",width:24,height:24,borderRadius:4,fill:k().Tj.icon.tertiary,background:n?w().xA:"dark"===z?k().Tj.palette.gray[100]:k().Tj.background.elevated,border:n?void 0:"1px solid rgba(227, 226, 224, 0.5)"},iconBoxImageStyle:{margin:1}})),[n,z]),W=(0,b().tz)(),H=(0,i.useRef)(null),N=(0,b().YK)({copyLink:{defaultMessage:"Copy link",id:"hoverPreviewOverlay.copyLink"},editLink:{defaultMessage:"Edit link",id:"hoverPreviewOverlay.editLink"}}),K=(0,i.useCallback)((async()=>{await a().default.afterNextFlush();const[e,n]=await Promise.all([(0,o().r)(),(0,r().jd)()]),i=e.copiedLinkToClipboard;n({environment:t,stringValue:D,copiedMessage:i})}),[t,D]),F=O&&O.recordStoreUIParentStore&&O.recordStoreUIParentStore instanceof u().B?O.recordStoreUIParentStore:O instanceof u().B?O:void 0,V=(null==n?void 0:n.thumbnail_url)??((null==n?void 0:n.images)&&n.images.length>0&&n.images[0].url);return(0,M.jsxs)(g().wt,{style:L.newWrapper,children:[P?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(f().A,{onClick:K,icon:y().k,colorVariant:"primary",ariaLabel:W.formatMessage(N.copyLink),hasBackground:!0,style:{position:"absolute",top:8,insetInlineEnd:8}}),(0,M.jsx)(f().A,{onClick:R,icon:S().pencilLineSmallIcon,colorVariant:"primary",ariaLabel:W.formatMessage(N.editLink),hasBackground:!0,style:{position:"absolute",top:8,insetInlineEnd:35}})]}):void 0,U&&F&&!P?(0,M.jsx)("div",{style:{position:"absolute",top:8,insetInlineEnd:8,zIndex:1},children:(0,M.jsx)(h().A,{popupType:h().z.Popup,placementToOrigin:"right",alignmentToOrigin:"start",originGap:4,onClose:()=>{let e=!1;const t=H.current;t&&(e=(0,s().ux)(t.getBoundingClientRect(),d().$C.x,d().$C.y)),e||null==_||_()},renderOrigin:e=>(0,M.jsx)(m().Ay,{style:L.buttonStyle,...e,children:(0,M.jsx)(v().I,{icon:x().ellipsisSmallIcon,size:"sm",style:{fill:n?k().oZ.white:k().oZ.uiGray}})}),render:e=>(0,M.jsx)(B().A,{parentBlockStore:F,store:O,token:U,href:D,hoverData:n,onAccept:()=>e.close()})})}):void 0,V?(0,M.jsx)(g().Ye,{style:L.coverContainer,children:(0,M.jsx)(T().A,{src:V,style:{width:"100%",height:"100%",insetInlineStart:0,top:"calc(50% - 280px/2)"}})}):void 0,(0,M.jsxs)(g().wt,{style:L.contentNew,children:[null!=n&&n.title||null!=n&&n.description?(0,M.jsxs)(g().wt,{style:L.titleAndDescription,children:[null!=n&&n.title?(0,M.jsx)(g().Ye,{gap:2,children:(0,M.jsx)("div",{style:L.linkTitle,children:null==n?void 0:n.title})}):void 0,null!=n&&n.description?(0,M.jsx)(g().Ye,{gap:2,children:(0,M.jsx)("div",{style:L.newDescription,children:(0,M.jsx)("div",{spellCheck:!1,style:L.newText,children:(0,M.jsx)("div",{children:null==n?void 0:n.description})})})}):void 0]}):void 0,E?(0,M.jsx)(p().P,{style:{width:200,height:16}}):(0,M.jsxs)(g().Ye,{alignItems:"left",style:{display:"flex",flexDirection:"row",alignItems:"center",padding:0,gap:4,width:205,height:16},children:[null!=n&&n.favicon_url?(0,M.jsx)(C().A,{type:"image_url",imageURL:null==n?void 0:n.favicon_url,size:16,style:L.iconBoxImageStyle}):null!=n&&n.icon_url?(0,M.jsx)(C().A,{type:"image_url",imageURL:null==n?void 0:n.icon_url,size:16,style:L.iconBoxImageStyle}):(0,M.jsx)(v().I,{icon:j().linkSmallIcon,size:"sm",colorVariant:"secondary"}),(0,M.jsx)("div",{style:{flexGrow:0,fontWeight:I().Wy.medium,color:"#787774",fontSize:12,...I().RC},children:(null==n?void 0:n.provider_name)||(null==n?void 0:n.link_provider)||D})]})]})]})}},895549:(e,t,n)=>{n.d(t,{h:()=>s,l:()=>l});n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698);var i=n(296540),o=()=>n(711339);const r=new Set;function s(e,t){const n=(0,i.useMemo)((()=>o().default.DO_NOT_USE_markLegacy(e)),[e]),s=(0,i.useRef)(t);(0,i.useEffect)((()=>{s.current=t}),[t]);return(0,i.useCallback)((()=>{r.has(e)&&!t.allowMultipleFiresPerSession||(r.add(e),o().default.DO_NOT_USE_measureLegacy(n,s.current))}),[n,e,t.allowMultipleFiresPerSession])}const a=new Set;function l(e,t){const n=(0,i.useRef)(t);(0,i.useEffect)((()=>{n.current=t}),[t]);return(0,i.useCallback)((()=>{a.has(e)||(a.add(e),o().default.DO_NOT_USE_measureFromPageOriginLegacy(e,n.current))}),[e])}},904694:(e,t,n)=>{n.d(t,{A:()=>j});n(944114),n(296540);var i=()=>n(692031),o=()=>n(212497),r=()=>n(484714),s=()=>n(546926),a=()=>n(890492),l=()=>n(663639),d=()=>n(736847),c=()=>n(700500),u=()=>n(775842),p=()=>n(742852),m=()=>n(201980),g=()=>n(69708),h=()=>n(443120),v=()=>n(384944),f=()=>n(547149),y=()=>n(575143),x=n(474848);function j(e){const{store:t,parentBlockStore:n,onAccept:j,token:S,href:b,hoverData:k}=e,I=(0,r().v3)(),w=[];return w.push({key:0,render:e=>(0,x.jsx)(d().A,{...e,style:{paddingTop:0,paddingBottom:0}}),items:[{key:"copy link",render:e=>(0,x.jsx)(y().A,{...e,title:(0,x.jsx)(g().sA,{id:"linkMention.copyLink",defaultMessage:"Copy link"}),svg:p().linkIcon}),action:async()=>{if(!t)return;if(!S)return;const[e,n]=await Promise.all([(0,i().r)(),(0,o().jd)()]),r=e.copiedLinkToClipboard;n({environment:I,stringValue:b,copiedMessage:r})}}]}),w.push({key:1,render:e=>(0,x.jsx)(d().A,{...e,style:{paddingTop:0,paddingBottom:0}}),items:[{key:"convert to bookmark",render:e=>(0,x.jsx)(y().A,{...e,title:(0,x.jsx)(g().sA,{id:"linkMention.convertToBookmark",defaultMessage:"Turn into preview"}),svg:u().a}),action:()=>{t&&S&&f().createAndCommit({userAction:"LinkMentionMenu.convertToBookmark",environment:I,canUndo:!0,perform:e=>{if(k){const i=v().Wv({environment:I,type:c().xd.bookmark,inMemoryRecordCache:t.inMemoryRecordCache,properties:{title:k&&k.title?m().x9d(k.title):m().x9d(b),link:m().x9d(b),description:k&&k.description?m().x9d(k.description):void 0},format:{bookmark_cover:k.thumbnail_url,bookmark_icon:k.favicon_url?k.favicon_url:k.icon_url},transaction:e,spaceId:t.pointer.spaceId});h().ed({environment:I,parentBlockStore:n,blockStore:i,token:S,transaction:e})}else{const i=v().Wv({environment:I,type:c().xd.bookmark,inMemoryRecordCache:t.inMemoryRecordCache,properties:{title:m().x9d(b),link:m().x9d(b)},transaction:e,spaceId:t.pointer.spaceId});h().ed({environment:I,parentBlockStore:n,blockStore:i,token:S,transaction:e})}}})}}]}),(0,x.jsx)(a().A,{menuType:s().gu.Popup,children:(0,x.jsx)(l().A,{type:l().O.Vertical,initialFocus:void 0,onAccept:j,sections:w,style:{paddingTop:3,paddingBottom:3}})})}},913886:(e,t,n)=>{n.d(t,{D:()=>o});n(296540);const i={viewBox:"0 0 16 16",fittedViewBox:"2.12 3.37 11.75 9.25",svg:(0,n(474848).jsx)("path",{d:"M4 3.375c-1.036 0-1.875.84-1.875 1.875v5.5c0 1.036.84 1.875 1.875 1.875h8c1.036 0 1.875-.84 1.875-1.875v-5.5c0-1.036-.84-1.875-1.875-1.875zm4 4.991L4.26 4.625h7.482zm-4.625 2.122v-4.98l2.49 2.49zm9.25 0-2.49-2.49 2.49-2.489zm-8.37.887 2.493-2.493.81.81c.244.244.64.244.884 0l.81-.81 2.492 2.493z"})},o=(0,n(340498).wt)("envelopeSmall",i,"small")}}]);