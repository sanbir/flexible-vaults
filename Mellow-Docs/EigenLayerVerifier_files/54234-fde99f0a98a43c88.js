"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[54234],{99756:(e,t,n)=>{n.d(t,{A:()=>c});var o=n(296540),i=()=>n(401497),r=()=>n(100622),s=()=>n(466797),a=n(474848);function l({type:e,containerStyle:t,iconSize:o,...r}){const l=o??20,c=(0,i().eP)(),m=(0,i().IS)((()=>({container:{display:"flex",alignItems:"center",justifyContent:"center",...(0,n(623275).iM)({themeMode:c,size:o??(n(726637).A.isMobile?s().Bj:s().Ev),useLargeBorderRadius:!0,useLightBackgroundColor:!0}),..."circle"===e&&{borderRadius:"100%"},...t}})),[t,e,o,c]);return(0,a.jsx)("div",{style:m.container,children:"function"===r.iconType?(0,a.jsx)(d,{iconFn:r.iconFn,iconStyle:r.iconStyle,innerIconSize:l}):"emoji"===r.iconType?(0,a.jsx)(n(56086).A,{char:r.emoji,size:l}):"recordIcon"===r.iconType?(0,a.jsx)(n(187820).B6,{icon:r.icon,disabled:!0,isEmptyPage:!1,size:l,defaultIcon:(0,a.jsx)(n(807449).I,{icon:n(888867).s,size:l})}):r.element})}function d({iconFn:e,iconStyle:t,innerIconSize:n}){return e((0,i().IS)((()=>({icon:{width:n,height:n,fill:r().Tj.icon.secondary,...t}})),[t,n]).icon)}const c=o.memo(l)},110584:(e,t,n)=>{n.r(t),n.d(t,{iconDefinition:()=>o,personKeyIcon:()=>i});n(296540);const o={viewBox:"0 0 20 20",fittedViewBox:"3.68 2.37 15.23 17.3",svg:(0,n(474848).jsx)("path",{d:"M10 2.375c-1.137 0-2.054.47-2.674 1.242-.608.757-.9 1.765-.9 2.824s.292 2.066.9 2.824c.62.772 1.537 1.241 2.674 1.241s2.055-.469 2.675-1.241c.608-.758.9-1.766.9-2.824 0-1.059-.292-2.067-.9-2.824-.62-.773-1.538-1.242-2.675-1.242M7.676 6.441c0-.842.233-1.554.624-2.042.38-.473.937-.774 1.7-.774s1.32.301 1.7.774c.391.488.624 1.2.624 2.042s-.233 1.554-.624 2.041c-.38.473-.937.774-1.7.774s-1.32-.3-1.7-.774c-.391-.487-.624-1.2-.624-2.041M10 11.63c-2.7 0-5.101 1.315-6.12 3.305-.361.706-.199 1.421.23 1.923.412.48 1.06.767 1.74.767h7.88v-1.25H5.85c-.342 0-.634-.148-.79-.33-.138-.162-.172-.336-.067-.54.761-1.488 2.672-2.626 5.007-2.626a6.7 6.7 0 0 1 2.255.381 4 4 0 0 1 .036-1.301 8 8 0 0 0-2.291-.33m7.396 4.866v-1.34a2.719 2.719 0 1 0-2.417 0v3.454l1.209 1.058 1.208-1.058-.906-1.057zm-1.907-4.38a.698.698 0 1 1 1.396 0 .698.698 0 0 1-1.396 0"})},i=(0,n(340498).wt)("personKey",o,"default")},122406:(e,t,n)=>{n.d(t,{e:()=>i});n(296540);const o={viewBox:"0 0 20 20",fittedViewBox:"1.68 2.37 17.01 15.26",svg:(0,n(474848).jsx)("path",{d:"M8 2.375c-1.137 0-2.054.47-2.674 1.242-.608.757-.9 1.765-.9 2.824s.292 2.066.9 2.824c.62.772 1.537 1.241 2.674 1.241s2.055-.469 2.675-1.241c.608-.758.9-1.766.9-2.824 0-1.059-.292-2.067-.9-2.824-.62-.773-1.538-1.242-2.675-1.242M5.676 6.441c0-.842.233-1.554.624-2.042.38-.473.937-.774 1.7-.774s1.32.301 1.7.774c.391.488.624 1.2.624 2.042s-.233 1.554-.624 2.041c-.38.473-.937.774-1.7.774s-1.32-.3-1.7-.774c-.391-.487-.624-1.2-.624-2.041M8 11.63c-2.7 0-5.101 1.315-6.12 3.305-.361.706-.199 1.421.23 1.923.412.48 1.06.767 1.74.767h8.3c.68 0 1.328-.287 1.74-.767.429-.502.591-1.217.23-1.923C13.1 12.945 10.7 11.63 8 11.63m-5.007 3.875c.761-1.488 2.672-2.626 5.007-2.626s4.246 1.138 5.007 2.626c.105.204.07.378-.067.54-.156.182-.448.33-.79.33h-8.3c-.342 0-.634-.148-.79-.33-.138-.162-.172-.336-.067-.54m15.493-8.568a.625.625 0 0 1 0 .884L16.807 9.5l1.68 1.68a.625.625 0 1 1-.884.883l-1.68-1.68-1.68 1.68a.625.625 0 0 1-.883-.884L15.04 9.5l-1.68-1.68a.625.625 0 1 1 .884-.883l1.68 1.68 1.678-1.68a.625.625 0 0 1 .884 0"})},i=(0,n(340498).wt)("personXmark",o,"default")},228974:(e,t,n)=>{n.d(t,{D:()=>I});n(581454);var o=n(296540),i=()=>n(59226),r=()=>n(484714),s=()=>n(590526),a=()=>n(401497),l=()=>n(295633),d=()=>n(807449),c=()=>n(292250),m=()=>n(287188),p=()=>n(26697),u=()=>n(532940),g=()=>n(68263),h=()=>n(69708),f=()=>n(100622),v=()=>n(268153),y=()=>n(908615),C=()=>n(928074),b=n(474848);function I({permissionType:e,blockType:t,blockRole:n,blockTable:I,canCreatePagesInCollection:x,handleCanCreatePagesInCollectionChange:S,store:_,isInvite:P,isInherited:j}){const w=(0,r().v3)(),A=(0,g().p2)(n),k=(0,a().IS)((()=>({toggleContainer:{opacity:A?.3:1,gap:8,display:"flex",marginTop:5,marginBottom:2},toggleLabel:{color:f().Tj.text.secondary,fontSize:12,textOverflow:"ellipsis",overflow:"hidden"},label:{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},labelContainer:{display:"flex",alignItems:"center",gap:4},link:{color:f().Tj.text.secondary},tooltipContent:{display:"flex",flexDirection:"column",gap:4},emptyBodyContent:{marginTop:-4}})),[A]),M=(0,i().X)("can_create_pages_in_collection_permission"),T=(0,s().K8)((()=>M&&(0,g().HM)(e)&&("collection_view"===t||"collection_view_page"===t)&&_ instanceof l().B&&_.getOwnedCollectionStores().length>0),[e,t,_,M]),B=Boolean(A||x&&!j),W=(0,s().K8)((()=>{if(!(_ instanceof l().B)||P)return!1;const e=(0,C().rx)(_);return B&&"none"===e&&!(0,g().p2)(n)}),[B,_,P,n]),R=(0,o.useCallback)((()=>{(0,y().pm)({environment:w,store:_,role:"read_and_write"})}),[w,_]);if(!T)return{};const L=(0,b.jsxs)("div",{style:k.toggleContainer,children:[(0,b.jsx)(m().A,{on:B,disabled:A,onClick:S}),(0,b.jsx)("span",{style:k.toggleLabel,children:(0,b.jsx)(h().sA,{id:"PermissionRoleSelect.canCreatePagesCheckbox.label",defaultMessage:"Can also create pages"})})]});return{showNoneRoleWithOtherRolesOverride:!0,roleItemOverrides:["comment_only","reader","none"].map((e=>({role:e,bodyContent:n===e?L:(0,b.jsx)("div",{style:k.emptyBodyContent})}))),buttonContents:(0,b.jsxs)("span",{className:"notranslate",style:k.labelContainer,children:[W?(0,b.jsx)(p().m,{delayThreshold:300,placement:"top",closeDelay:2e3,allowHover:!0,renderTooltip:()=>(0,b.jsxs)("div",{style:k.tooltipContent,children:[(0,b.jsx)("div",{children:(0,b.jsx)(h().sA,{id:"PermissionRoleSelect.canCreatePagesWarning.tooltip",defaultMessage:"People won’t have access to the pages they create"})}),(0,b.jsx)(c().N,{style:k.link,onClick:R,children:(0,b.jsx)(h().sA,{id:"PermissionRoleSelect.canCreatePagesWarning.helpMeFix",defaultMessage:"Help me fix"})})]}),render:e=>(0,b.jsx)("span",{...e,children:(0,b.jsx)(d().I,{icon:u().exclamationMarkTriangleIcon,size:"sm"})})}):null,(0,b.jsx)("span",{style:k.label,children:(0,b.jsx)(h().sA,{...(0,v().R)({type:e,role:n,table:I,isRemovable:!1,canCreate:B}).label})})]})}}},247123:(e,t,n)=>{n.d(t,{QU:()=>g,f2:()=>u,r6:()=>h});n(581454),n(296540);var o=()=>n(907258),i=()=>n(590526),r=()=>n(401497),s=()=>n(611648),a=()=>n(69708),l=()=>n(100622),d=()=>n(534177),c=()=>n(805181),m=()=>n(376254),p=n(474848);function u(e){const{openState:t}=e,{mainEditorCurrentBlockStore:n,currentSpaceStore:a}=(0,i().K8)((()=>{const{mainEditorCurrentBlockStore:e,sidebarSpaceStore:t}=o().default.state;return{mainEditorCurrentBlockStore:e,currentSpaceStore:t}}),[]),d=(0,r().IS)((()=>({scroller:{display:"flex",flexDirection:"column",maxHeight:290,border:`1px solid ${l().Tj.border.secondaryTranslucent}`,borderRadius:6,paddingTop:8,paddingInlineStart:12,paddingInlineEnd:12,paddingBottom:12,marginTop:15,marginBottom:5,marginInlineStart:-12,marginInlineEnd:-12},editContainer:{marginTop:2,marginBottom:2,color:l().Tj.text.primary}})),[]);if(!n||!a)return null;const u=Date.now();return(0,p.jsx)(m().H,{type:s().A.Y,style:d.scroller,children:t.permissionChanges.map((([e,t],o)=>{const i={timestamp:u,space_id:a.id,type:"permission-changed",permission_data:{before:e,after:t}};return(0,p.jsx)("div",{style:d.editContainer,children:(0,p.jsx)(c().A,{rootStore:n,edit:i})},`${e.type}-${o}`)}))})}function g(e){return["remove","restrict"].includes(e.type)?(0,p.jsx)(a().sA,{id:"restrictedPermissionConfirmationModal.actionButton.restrictAccessV2",defaultMessage:"Change and unlink"}):(0,p.jsx)(a().sA,{id:"restrictedPermissionConfirmationModal.actionButton.relink",defaultMessage:"Relink"})}function h(e){switch(e.type){case"remove":case"restrict":return(0,p.jsx)(a().sA,{id:"restrictedPermissionConfirmationModal.remove.descriptionV2",defaultMessage:"Change access and unlink share settings from parent page?"});case"restore":case"restoreTeamPermissions":return(0,p.jsx)(a().sA,{id:"restrictedPermissionConfirmationModal.relink.description",defaultMessage:"Relink share settings?"});default:throw d().HB(e)}}},254234:(e,t,n)=>{n.d(t,{h:()=>p});n(296540);var o=()=>n(401497),i=()=>n(26697),r=()=>n(278238),s=()=>n(69708),a=()=>n(100622),l=()=>n(453697),d=()=>n(899707),c=()=>n(345521),m=n(474848);function p({permissionGroup:e,hasTooltip:t,type:n="avatar"}){const{group:p,memberCount:u}=e,g=p.name,h=p.space_id,f=p.icon,{tooltipTextStyle:v,tooltipAvatarContainer:y,tooltipContainer:C,tooltipUserInfoContainer:b}=(0,l().n)(),I=(0,o().eP)(),x=(0,o().IS)((()=>({iconContainer:{position:"relative"},iconBackground:{position:"absolute",top:0,bottom:0,insetInlineStart:0,insetInlineEnd:0,background:a().Tj.background.primary,zIndex:1,borderRadius:"100%"},icon:{position:"relative",zIndex:2,height:c().tR,width:c().tR,background:f&&(0,r().T8)(f)?(0,r().ez)({icon:f,mode:I,useLightGrayColor:!1}):a().Tj.palette.gray[75]}})),[f,I]),S=e=>(0,m.jsxs)("div",{style:x.iconContainer,...e,children:[(0,m.jsx)(d().e,{icon:f,spaceId:h,size:c().Gz,containerStyles:x.icon}),(0,m.jsx)("div",{style:x.iconBackground})]}),_=e=>(0,m.jsxs)("div",{style:C,children:[(0,m.jsx)("div",{style:y,children:S()}),(0,m.jsxs)("div",{style:b,children:[g,e?void 0:(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("br",{}),(0,m.jsx)("span",{style:v,children:(0,m.jsx)(s().sA,{id:"organization.workspace.teamspaces.groupAvatar.memberCount",defaultMessage:"{memberCount, plural, one {# member} other {# members}}",values:{memberCount:u}})})]})]})]});return t?(0,m.jsx)(i().m,{renderTooltip:()=>_("avatar-name"===n),placement:"bottom",alignment:"start",render:e=>S(e)}):"avatar-name"===n||"avatar-name-count"===n?_("avatar-name"===n):(0,m.jsx)("div",{children:S()})}},345521:(e,t,n)=>{n.d(t,{Gz:()=>f,Qp:()=>y,iP:()=>g,tR:()=>h});n(581454);var o=n(296540),i=()=>n(401497),r=()=>n(611648),s=()=>n(874832),a=()=>n(493552),l=()=>n(26697),d=()=>n(591779),c=()=>n(69708),m=()=>n(376254),p=()=>n(364354),u=n(474848);const g=4,h=24,f=18,v=10;function y(e){const{avatars:t,totalCount:n,avatarLimit:h,renderOverflowTooltip:f,isLightBackground:y,avatarStyles:C,isLoading:b}=e,I=(0,p().Z)(),x=(0,i().IS)((()=>({bottom:{display:"flex"},userAvatarContainer:{display:"flex",flexDirection:"row",isolation:"isolate",alignItems:"center",cursor:"default"},hiddenAvatarCount:{display:"flex",marginInlineStart:12,alignItems:"center"},scroller:{maxWidth:250,maxHeight:300,padding:0}})),[]),{pinTooltip:S,unpinTooltip:_,setImmediateState:P,isHovering:j}=function(){const[e,t]=(0,o.useState)(!1),n=(0,d().lW)(e,400,Object.is),[i,r]=(0,o.useState)(void 0),s=i||n,a=(0,o.useCallback)((()=>r(s)),[s]),l=(0,o.useCallback)((()=>{r(void 0)}),[]);return{pinTooltip:a,unpinTooltip:l,setImmediateState:t,isHovering:!1===e&&!0===s}}(),w=(0,o.useMemo)((()=>{let e=t;t.length>(h||g)&&(e=t.slice(0,h||g));for(const t of e)if(!t.renderAvatar)return[];return e}),[h,t]),A=(0,o.useCallback)((e=>({marginInlineEnd:e+1===w.length?0:-v,...C})),[C,w.length]);if(b)return(0,u.jsxs)("div",{style:x.bottom,children:[(0,u.jsx)("div",{style:x.userAvatarContainer,children:new Array(g).fill(null).map(((e,t)=>(0,u.jsx)(s().P,{style:{...I.avatarShimmer,...A(t)}},t)))}),(0,u.jsx)("div",{style:x.hiddenAvatarCount,children:(0,u.jsx)(s().P,{style:I.shortShimmer})})]});const k=h||g,M=(n||t.length)-k;return(0,u.jsxs)("div",{style:x.bottom,children:[(0,u.jsx)("div",{style:x.userAvatarContainer,children:w.map(((e,t)=>(0,u.jsx)(l().m,{isLightBackground:y,disableTooltip:!e.renderTooltip,delayThreshold:0,renderTooltip:e.renderTooltip??(()=>{}),placement:"bottom",alignment:"start",render:n=>(0,u.jsx)("div",{style:{zIndex:k-t,...A(t)},...n,children:e.renderAvatar()})},`avatar-${t}`)))}),M>0?(0,u.jsx)(l().m,{disableTooltip:!f,placement:"bottom",alignment:"start",style:{paddingInlineEnd:0},forceVisibleState:j||void 0,delayThreshold:0,renderTooltip:e=>f?(0,u.jsx)(m().H,{...e,onMouseEnter:S,onMouseLeave:_,type:r().A.Y,style:x.scroller,children:f(e)}):void 0,allowHover:!0,render:e=>(0,u.jsx)("div",{style:x.hiddenAvatarCount,...e,onMouseEnter:t=>{var n;P(!0),null===(n=e.onMouseEnter)||void 0===n||n.call(e,t)},onMouseLeave:t=>{var n;P(!1),null===(n=e.onMouseLeave)||void 0===n||n.call(e,t)},children:(0,u.jsx)(a().D,{styleKey:"captionRegular",colorVariant:"secondary",children:(0,u.jsx)(c().sA,{defaultMessage:"+{numHiddenAvatars}",id:"settingsConsole.general.numHiddenAvatars",values:{numHiddenAvatars:M.toLocaleString()}})})}),isLightBackground:y}):void 0]})}},364354:(e,t,n)=>{n.d(t,{Z:()=>i});var o=()=>n(401497);function i(){const e=(0,o().eP)();return(0,o().IS)((()=>({longShimmer:{borderRadius:4,height:14,width:185},longTallShimmer:{borderRadius:4,height:25,width:185},shortShimmer:{borderRadius:4,height:14,width:70},avatarShimmer:{borderRadius:"100%",height:24,width:24,background:"light"===e?"rgb(243 243 243)":"rgb(38 38 38)"}})),[e])}},466797:(e,t,n)=>{n.d(t,{Ev:()=>N,Bj:()=>V,Ay:()=>q});n(944114),n(581454);var o=n(296540),i=()=>n(135168),r=()=>n(59226),s=()=>n(726637),a=()=>n(484714),l=()=>n(590526),d=()=>n(401497),c=()=>n(457205),m=()=>n(996332),p=()=>n(404905),u=()=>n(302501),g=()=>n(584262),h=()=>n(302107),f=()=>n(142748),v=()=>n(273900),y=()=>n(68263),C=()=>n(179034),b=()=>n(519831),I=()=>n(854150),x=()=>n(743246),S=()=>n(496703),_=()=>n(69708),P=()=>n(100622),j=()=>n(534177),w=()=>n(761652),A=()=>n(347160),k=()=>n(492414),M=()=>n(299545),T=()=>n(350824),B=()=>n(976721),W=()=>n(321172),R=()=>n(632709),L=()=>n(528093),K=()=>n(704658),D=()=>n(465960),z=()=>n(908615);var E=()=>n(623275),H=()=>n(228974),O=n(474848);const U=function(e){const{store:t,isDisabled:n,isCurrentUserPermission:o}=e;return n?o?(0,O.jsx)(_().sA,{defaultMessage:"Your access is based on {inlineIconAndName}",id:"blockPermissionsSettings.restrictedPermissionsCurrentUser.tooltip",values:{inlineIconAndName:(0,O.jsx)(w().A,{store:t,useInvertedColors:!0})}}):(0,O.jsx)(_().sA,{defaultMessage:"This access is based on {inlineIconAndName}",id:"blockPermissionsSettings.restrictedPermissions.tooltip",values:{inlineIconAndName:(0,O.jsx)(w().A,{store:t,useInvertedColors:!0})}}):o?(0,O.jsx)(_().sA,{defaultMessage:"Your access is based on {inlineIconAndName}. Changing your access will restrict permissions of this page.",id:"blockPermissionsSettings.restrictedPermissionsCurrentUser.canEdit.tooltip",values:{inlineIconAndName:(0,O.jsx)(w().A,{store:t,useInvertedColors:!0,maxLength:26})}}):(0,O.jsx)(_().sA,{defaultMessage:"This access is based on {inlineIconAndName}. Changing this access will restrict permissions of this page.",id:"blockPermissionsSettings.restrictedPermissions.canEdit.tooltip",values:{inlineIconAndName:(0,O.jsx)(w().A,{store:t,useInvertedColors:!0,maxLength:26})}})},N=32,V=40,F=(0,_().YK)({fromLinkBox:{defaultMessage:"From {linkBoxWithPageTitle}",id:"pagePermissionItem.fromInheritedRecordPermissions.setting"}});function Y(e){const{from:t,store:i,onClick:r,permissionItem:s,ignoreLocalHoverState:c,nonInheritedTooltip:m,inheritedTooltip:p,shouldDisable:u,isCollapsible:g,openRoleSelectMenuOnRender:h}=e,f=(0,a().v3)(),v=(0,l().uB)(void 0,n(118307).A),y=(0,l().K8)((()=>{const e=t.table;if(e===C().ev)return n(295633).B.createChildStore(i,{table:C().ev,id:t.blockId});if(e===I().yK)return n(723085).h.createChildStore(i,{table:I().yK,id:t.teamId});if(e===b().Vl)return n(732810).m.createChildStore(i,{table:b().Vl,id:t.collectionId});if(e===x().C0){const e=i.getSpaceId();if(!e)return;return n(350013).N.createChildStore(i,{table:x().C0,id:t.workflowId,spaceId:e})}e!==n(234459).To&&(0,j().HB)(e)}),[t,i]),[S,_]=(0,o.useState)(!1),w=(0,o.useCallback)((()=>{v.setState({...v.state,open:!0}),_(!0)}),[v]),A=(0,o.useCallback)((()=>{_(!1)}),[]);(0,o.useEffect)((()=>{h&&!v.state.open&&requestAnimationFrame((()=>{w()}))}),[h,w,v]);const k=S,M=(0,l().K8)((()=>u||(0,n(484578).dK)({permissionItem:s,store:i})),[u,s,i]),T=(0,l().K8)((()=>!!y&&y.id!==i.id),[y,i]),B=(0,o.useCallback)((e=>{r?r(e):M||v.setState({...v.state,open:!0})}),[v,r,M]),W=(0,l().K8)((()=>{const e=f.currentUser.id;return"user_permission"===s.type&&s.user_id===e}),[f,s]),R=(0,l().K8)((()=>k?null:T&&y?p||(0,O.jsx)(U,{store:y,isDisabled:M,isCurrentUserPermission:W}):m),[T,m,p,y,M,W,k]),L=(0,d().IS)((()=>({button:{...(0,E().CY)(),...e.menuListItemProps?{width:"unset"}:{}},pressedButton:{background:P().Tj.buttonPressedBackgroundLight},tooltip:{maxWidth:240}})),[e.menuListItemProps]);return(0,O.jsx)(n(26697).m,{delayThreshold:0,renderTooltip:()=>R,textWrap:!0,disableTooltip:!Boolean(R)||k,forceRenderTooltipPopupComponent:Boolean(R),style:L.tooltip,render:t=>{const o=(0,n(383036).A)(t,{onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave});return e.menuListItemProps?(0,O.jsx)(n(81068).A,{...e.menuListItemProps,onClick:B,disabled:M,ignoreLocalHoverState:c,pressed:!1,buttonStyle:L.button,textWrapperStyle:{marginInlineStart:0,marginInlineEnd:0},style:{padding:0},title:y&&(0,O.jsx)($,{...e,isDisabled:M,fromStore:y,buttonPopupStore:v,isInherited:T,onOpenMenu:w,onClose:A}),...o}):(0,O.jsx)(n(718827).Ay,{disabled:M&&!g,ignoreLocalHoverState:c,style:L.button,pressedStyle:L.pressedButton,onClick:B,...o,children:y?(0,O.jsx)($,{...e,isDisabled:M,fromStore:y,buttonPopupStore:v,isInherited:T,onOpenMenu:w,onClose:A}):void 0})},placement:"left"})}function $(e){const{permissionItem:t,fromStore:n,isCompact:i,iconStyle:r,icon:c,title:m,tag:g,subtitle:h,showInherited:f,isInherited:v,permissionRoleSelect:y,hideRoleSelectButton:I,renderTitleWithoutUILabelWrapper:S,onClose:_,style:P}=e,w=(0,a().v3)(),A=(0,l().K8)((()=>function(e){return"user_permission"===e.type}(t)),[t]),{paddingLeft:k,paddingRight:M}=(0,l().K8)((()=>({paddingLeft:w.WindowSizeStore.getSafePaddingLeftCSS(s().A.isMobile?0:8),paddingRight:w.WindowSizeStore.getSafePaddingRightCSS(s().A.isMobile?0:8)})),[w.WindowSizeStore]),T=(0,d().IS)((()=>({container:{display:"flex",alignItems:"center",minHeight:i?44:void 0,height:s().A.isMobile?void 0:E().CJ,paddingTop:s().A.isMobile?12:8,paddingBottom:s().A.isMobile?12:8,paddingInlineStart:k,paddingInlineEnd:M,...P},icon:{flexShrink:0,display:"flex",alignItems:"center",justifyContent:"center",width:s().A.isMobile?40:32,height:s().A.isMobile?40:32,marginInlineEnd:(0,E().qj)({isMobile:s().A.isMobile}),...r},title:{marginInlineEnd:"auto",minWidth:0},labelWrapper:{display:"flex",flexDirection:"row"},label:{fontWeight:400},tag:{marginInlineStart:4},roleSelect:{display:"flex",alignItems:"center",flexShrink:0,marginInlineStart:8}})),[i,k,M,r,P]),B=(0,o.useMemo)((()=>I?null:function(e){return"display_only_overview_permission"===e.type||"display_only_hidden_permission"===e.type||"display_only_inherited_permission"===e.type||"display_only_group_member_permission"===e.type}(t)?y:e.store.table===C().ev||e.store.table===x().C0?(0,O.jsx)(G,{...e,onClose:_,permissionItem:t}):e.store.table===b().Vl?(0,O.jsx)(Q,{...e,store:e.store,onClose:_,permissionItem:t}):void(0,j().HB)(e.store)),[I,t,e,y,_]);return(0,O.jsxs)("div",{className:"notranslate",style:T.container,children:[(0,O.jsx)("div",{style:T.icon,children:c}),(0,O.jsxs)("div",{style:T.title,children:[(0,O.jsxs)("div",{style:T.labelWrapper,children:[S?m:(0,O.jsx)(u().A,{style:A?void 0:T.label,children:(0,O.jsx)(p().j,{children:m})}),g?(0,O.jsx)("div",{style:T.tag,children:g}):void 0]}),h?(0,O.jsx)(u().A,{style:e.subtitleStyle,isSmall:!0,children:h}):void 0,f&&v?(0,O.jsx)(X,{store:n}):void 0]}),B?(0,O.jsx)("div",{style:T.roleSelect,children:B}):null]})}function G(e){const{isInherited:t,permissionItem:n,store:r,from:s,isDisabled:m,sudoModeStore:p,location:u,fromPermissionWrapper:g,onUpgradeButtonClick:h,onChange:b,onClose:I,onOpenMenu:S,upgradeButtonName:_,buttonPopupStore:j,isRemovableOverride:w,onChangeSuccess:k,additionalCapabilities:M}=e,T=(0,a().v3)(),R=(0,l().K8)((()=>(0,i().f)(r)),[r]),L=(0,l().K8)((()=>{var e;const t=r.getModel(),o=null===(e=r.getParentStore())||void 0===e?void 0:e.getModel();return(0,v().tp)({record:t,parent:o,from:s,permissionItem:n})?(0,v().SK)({ancestors:f().Yn(r.pointer,r.getRecordModel),from:s}):n.role}),[s,n,r]),K=(0,l().K8)((()=>r.table===C().ev?r.getType():void 0),[r]),D=r.table===x().C0?x().C0:C().ev,U=n.type,N=(0,l().K8)((()=>{const e=T.currentUser.id;return y().B2(n)&&n.user_id===e}),[T,n]),V=(0,l().K8)((()=>{if("bot_permission"!==n.type)return;const e=c().v.createChildStore(r,{table:"bot",id:n.bot_id,spaceId:n.parent_id});return e.isWorkflowBot()?e.getWorkflowId():void 0}),[n,r]),F=(0,o.useCallback)((async(e,o)=>{let i=!1;const s={...n};if(s.role=L,o&&y().i4(s)&&(s.can_create_pages_in_collection=void 0),i=b?await b(e):await(0,B().o5)({oldPermissionItem:s,newRole:e,wasInherited:t,environment:T,store:r,sudoModeStore:p,location:u,fromPermissionWrapper:g}),i&&(null==k||k(e),r.table===x().C0&&N&&"none"===e)){j.reset(),W().XP({environment:T,store:r});const e=T.defaultRecordCache.inMemoryRecordCache;e.setModelAndRole({pointer:r.pointer,userId:T.currentUser.id},r.getModel(),"none"),e.emitRecord(r.pointer,[])}}),[n,L,t,T,r,p,u,g,b,k,j,N]),Y=!!y().i4(n)&&(n.can_create_pages_in_collection??!1),$=(0,o.useCallback)((async()=>{await(0,z().iK)({permissionItem:n,environment:T,store:r,isInherited:t})}),[n,T,r,t]),G=(0,d().IS)((()=>({button:{color:P().Tj.text.secondary,fontSize:(0,E().kx)()}})),[]),Q=(0,H().D)({permissionType:n.type,blockType:K,blockRole:L,blockTable:D,canCreatePagesInCollection:Y,handleCanCreatePagesInCollectionChange:$,store:r,isInherited:t});return(0,O.jsx)(A().Ay,{role:L,table:D,spaceStore:R,blockType:K,type:U,disabled:m,isUserPermission:N,renderCurrentAccessSection:e.renderCurrentAccessSection,onChange:F,onClick:S,onClose:I,onUpgradeButtonClick:h,upgradeButtonName:_,buttonPopupStore:j,buttonStyle:G.button,showPermissionOverrideWarning:t&&!e.selectFooter,isRemovableOverride:w,workflowId:V,footer:e.selectFooter,roleItemOverrides:e.roleItemOverrides,from:"shareMenu",header:e.selectHeader,additionalCapabilities:M,displayRoleInButton:e.displayRoleInButton,...Q})}function Q(e){const{isInherited:t,permissionItem:n,store:s,from:c,isDisabled:m,sudoModeStore:p,location:u,fromPermissionWrapper:g,onUpgradeButtonClick:C,onChange:I,onClose:x,onOpenMenu:S,upgradeButtonName:_,buttonPopupStore:j,isRemovableOverride:w,onChangeSuccess:k}=e,M=(0,a().v3)(),W=(0,l().K8)((()=>(0,i().f)(s)),[s]),R=null==W?void 0:W.id,D=(0,L()._)({name:"collection_property_permissions",spaceId:R,userId:M.currentUser.id}),H=(0,l().K8)((()=>{var e;const t=s.getModel(),o=null===(e=s.getParentStore())||void 0===e?void 0:e.getModel();return(0,v().tp)({record:t,parent:o,from:c,permissionItem:n})?(0,v().SK)({ancestors:f().Yn(s.pointer,s.getRecordModel),from:c}):n.role}),[c,n,s]),U=(0,l().K8)((()=>{const e=M.currentUser.id;return y().B2(n)&&n.user_id===e}),[M,n]),N=(0,r().X)("can_create_pages_in_collection_permission"),V=(0,o.useCallback)((async e=>{if(N&&y().tb(n)&&"page_creator"===n.property_info.type){const t=function(e){const t=e.getParentBlockStore();if(!t)return!1;const n=t.getType();if("collection_view"!==n&&"collection_view_page"!==n)return!1;const o=t.getPermissionItems();for(const i of o)if((0,y().i4)(i)&&!0===i.can_create_pages_in_collection)return!0;return!1}(s),n=y().p2(H)&&!y().p2(e);if(t&&("none"===e||n)){if(!(await(0,z()._D)(e)))return}}let o=!1;const i={...n};i.role=H,o=I?await I(e):await(0,B().o5)({oldPermissionItem:i,newRole:e,wasInherited:t,environment:M,store:s,sudoModeStore:p,location:u,fromPermissionWrapper:g}),o&&(null==k||k(e))}),[N,n,H,t,M,s,p,u,g,I,k]),F=(0,l().K8)((()=>{if("collection_property_permission"!==n.type)return;const e=s.getSchema();if(!(0,h().sq)({collectionSchema:e,permissionItem:n}))return T().vx;const t=[..."page_creator"===n.property_info.type?["editor"]:[],"read_and_write","comment_only","reader"],o="collection_property_permission"===n.type&&"unavailable"===(null==D?void 0:D.type)&&D.upsell,i=t.map((e=>({role:e,...o&&{disabledInfo:{isDisabled:!0}}})));return o&&(i[0].prefixItem={key:"upgrade_button",action:()=>{},render:()=>(0,O.jsx)("div",{style:{padding:7},children:(0,O.jsx)(K().UpgradeButton,{source:"collection_property_permissions",display:"button",upsell:D.upsell,featureName:"collection_property_permissions",spaceStore:W})})}),i.push(T().EL),i}),[n,s,D,W]),Y=(0,d().IS)((()=>({button:{color:P().Tj.text.secondary,fontSize:(0,E().kx)()}})),[]);return(0,O.jsx)(A().Ay,{spaceStore:W,role:H,table:b().Vl,blockType:void 0,type:n.type,disabled:m,isUserPermission:U,onChange:V,onClick:S,onClose:x,onUpgradeButtonClick:C,upgradeButtonName:_,buttonPopupStore:j,buttonStyle:Y.button,showPermissionOverrideWarning:t&&!e.selectFooter,isRemovableOverride:w,footer:e.selectFooter,roleItemOverrides:e.roleItemOverrides,from:"shareMenu",header:e.selectHeader,availableRoleItems:F})}function X(e){const{store:t}=e,n=(0,a().v3)(),i=(0,_().tz)(),r=(0,l().K8)((()=>t.table===C().ev?(0,k().Ay)({store:t,fullyQualified:!1,pageVisitSource:g().y8.LinkInPage}):t.table===x().C0?(0,S().L)({workflowId:t.id,params:{},pageVisitSource:g().y8.LinkInPage}):void 0),[t]),s=(0,l().K8)((()=>(0,M().$R)(t)),[t]),c=(0,o.useCallback)((()=>{D().F2({environment:n,teamId:t.id,tab:R().p.Members,from:"permission_item"})}),[t.id,n]),p=(0,d().IS)((()=>({label:{lineHeight:1.4},linkBox:{display:"inline-flex",alignItems:"center",borderBottom:`0.5px solid ${P().oZ.mediumTextColor}`}})),[]);return(0,O.jsx)(u().A,{isSmall:!0,style:p.label,children:i.formatMessage(F.fromLinkBox,{linkBoxWithPageTitle:(0,O.jsx)(m().Q,{inline:!0,href:r,onClick:s?c:void 0,innerStyle:p.linkBox,children:(0,O.jsx)(w().A,{store:t,useInvertedColors:!1})})})})}const q=o.memo(Y)},484578:(e,t,n)=>{n.d(t,{QX:()=>c,dK:()=>d});var o=()=>n(68263),i=()=>n(179034),r=()=>n(519831),s=()=>n(743246),a=()=>n(534177),l=()=>n(715142);function d({permissionItem:e,store:t}){return"display_only_inherited_permission"!==e.type&&(t.table===r().Vl?"collection_property_permission"===e.type?t.pathIsDead()||!t.canAdmin():t.pathIsDead():t.table===i().ev?t.pathIsDead()||!function(e){return"display_only_overview_permission"===e.type}(e)&&!t.canAdmin()||(0,l().dL)(t):t.table===s().C0?!t.canAdmin():void(0,a().HB)(t))}function c(e){const t=e&&"from"in e?e.permissionItem:e;if(!t||!(0,o().Tt)(t.role))return"private";return(0,o().Ni)(t)&&"none"!==t.role?"unlisted":"open"}},899707:(e,t,n)=>{n.d(t,{e:()=>d});n(296540);var o=()=>n(401497),i=()=>n(922189),r=()=>n(96689),s=()=>n(100622),a=()=>n(99756),l=n(474848);function d(e){const{icon:t,spaceId:n,size:d,containerStyles:c}=e,m=(0,o().IS)((()=>({icon:{fill:s().Tj.icon.secondary}})),[]);return t&&n?(0,l.jsx)(a().A,{iconSize:d,type:"circle",iconType:"recordIcon",icon:{icon:t,pointer:{table:r().NX,id:n}},containerStyle:{background:"transparent",...c}}):(0,l.jsx)(a().A,{iconSize:d,type:"circle",iconType:"function",iconFn:i().personCircleFillIcon,iconStyle:m.icon,containerStyle:{background:"transparent",...c}})}},908615:(e,t,n)=>{n.d(t,{Me:()=>_,_D:()=>S,iK:()=>C,pm:()=>I});n(296540);var o=()=>n(401497),i=()=>n(792057),r=()=>n(770063),s=()=>n(295633),a=()=>n(807449),l=()=>n(110584),d=()=>n(122406),c=()=>n(273900),m=()=>n(68263),p=()=>n(69708),u=()=>n(719849),g=()=>n(547149),h=()=>n(928074),f=()=>n(976721),v=n(474848);const y=(0,p().YK)({deletePageCreatorPermissionWarning:{id:"deletePageCreatorPermissionWarning.title",defaultMessage:"Delete page-level access for creators?"},lowerPageCreatorPermissionWarning:{id:"lowerPageCreatorPermissionWarning.title",defaultMessage:"Lower page-level access for creators?"},deletePageCreatorPermissionWarningDescription:{id:"deletePageCreatorPermissionWarning.description",defaultMessage:"Without this rule, users with Can Create access can still create pages but won’t be able to view or edit them."},lowerPageCreatorPermissionWarningDescription:{id:"lowerPageCreatorPermissionWarning.description",defaultMessage:"If access for this rule is lowered, users with Can Create access will be able to create pages but won’t be able to edit them."},deletePageCreatorPermissionWarningConfirmButton:{id:"deletePageCreatorPermissionWarning.confirmButton",defaultMessage:"Delete permission rule"},lowerPageCreatorPermissionWarningConfirmButton:{id:"lowerPageCreatorPermissionWarning.confirmButton",defaultMessage:"Lower permission rule access"}});async function C(e){const{permissionItem:t,environment:n,store:o,isInherited:i}=e;if(!(o instanceof s().B&&(0,m().i4)(t)))return;const r={...t};r.can_create_pages_in_collection=!!i||!t.can_create_pages_in_collection;if(!(await(0,f().Hc)({oldPermissionItem:t,newPermissionItem:r,wasInherited:i,environment:n,store:o}))||!r.can_create_pages_in_collection)return;const a=await _(o);a&&I({environment:n,store:o,role:a})}function b(e){const{collectionStore:t,environment:n,role:o}=e,i=(0,r().G_)(t,t.pointer,"permissions");g().createAndCommit({userAction:"toggleCanCreatePagesInCollection.onCreateRule",environment:n,canUndo:!0,perform:e=>{g().applyOperation({store:i,operation:{pointer:i.pointer,command:"setPermissionItem",path:i.path,args:{type:"collection_property_permission",property_info:{type:"page_creator"},role:o}},transaction:e})}})}function I(e){const{environment:t,store:n,role:o}=e;if(!(n instanceof s().B&&n.isCollectionView()))return;if(o===(0,h().rx)(n)||!(0,m().PW)(o))return;const i=n.getOwnedCollectionStores();for(const r of i)b({collectionStore:r,environment:t,role:o})}function x({role:e}){const t=(0,o().IS)((()=>({description:{fontSize:14}})),[]),n="none"===e?y.deletePageCreatorPermissionWarningDescription:y.lowerPageCreatorPermissionWarningDescription;return(0,v.jsx)("span",{style:t.description,children:(0,v.jsx)(p().sA,{...n})})}function S(e){const t="none"===e?y.deletePageCreatorPermissionWarning:y.lowerPageCreatorPermissionWarning,n="none"===e?y.deletePageCreatorPermissionWarningConfirmButton:y.lowerPageCreatorPermissionWarningConfirmButton;return new Promise((o=>{i().ui({message:(0,v.jsx)(p().sA,{...t}),description:(0,v.jsx)(x,{role:e}),showCancel:!1,showCloseButton:!0,keepFocus:!1,mode:"wide",innerStyle:{textAlign:"center"},icon:(0,v.jsx)(a().I,{icon:d().e,size:"xl"}),onDismiss:()=>{o(!1)},handleCancel:()=>{o(!1)},items:[{label:(0,v.jsx)(p().sA,{...n}),color:"red",onAccept:()=>{o(!0)}}]})}))}async function _(e){const t=(0,h().rx)(e);if(!(0,m().PW)(t)||!(0,c().q_)(t,"read_and_write"))return u().f({icon:l().personKeyIcon,radioButtonStyle:"blue",confirmTextStyle:"blue",hideCancelButton:!0,title:(0,v.jsx)(p().sA,{id:"toggleCanCreatePagesInCollection.modal.title",defaultMessage:"What access level should the creators have?"}),confirmText:(0,v.jsx)(p().sA,{id:"toggleCanCreatePagesInCollection.modal.confirmText",defaultMessage:"Create permission rule"}),radioOptions:[{key:"read_and_write",title:(0,v.jsx)(p().sA,{id:"toggleCanCreatePagesInCollection.modal.editAccess.title",defaultMessage:"Can edit the pages they create"}),subtitle:(0,v.jsx)(p().sA,{id:"toggleCanCreatePagesInCollection.modal.editAccess.subtitle",defaultMessage:"Edit, suggest, and comment"})},{key:"editor",title:(0,v.jsx)(p().sA,{id:"toggleCanCreatePagesInCollection.modal.fullAccess.title",defaultMessage:"Have full access to the pages they create"}),subtitle:(0,v.jsx)(p().sA,{id:"toggleCanCreatePagesInCollection.modal.fullAccess.subtitle",defaultMessage:"Edit, suggest, comment, and share"})}]})}},976721:(e,t,n)=>{n.d(t,{Dw:()=>P,Hc:()=>_,o5:()=>S});n(16280),n(296540);var o=()=>n(564884),i=()=>n(711339),r=()=>n(792057),s=()=>n(807449),a=()=>n(302501),l=()=>n(165358),d=()=>n(243581),c=()=>n(273900),m=()=>n(68263),p=()=>n(179034),u=()=>n(519831),g=()=>n(161479),h=()=>n(69708),f=()=>n(496603),v=()=>n(701763),y=()=>n(579627),C=()=>n(247123),b=()=>n(547149),I=()=>n(437487),x=n(474848);async function S({newRole:e,...t}){const n=t.oldPermissionItem,o=(0,f().o8)(n);return o.role=e,await _({newPermissionItem:o,...t})}async function _(e){const{oldPermissionItem:t,newPermissionItem:n,wasInherited:r,environment:s,store:a,sudoModeStore:d,restrictingVisibility:h,fromPermissionWrapper:f}=e;if(!(0,c().nK)(t,n))throw new Error("Permission type mismatch.");const C=!!d&&d.shouldSaveTransactionWithSudoMode(a),x=(0,c().$q)(t.role,n.role);if(r&&x!==n.role||h){return await P({environment:s,useSudoMode:C,store:a,permissionItem:n,fromPermissionWrapper:f,shouldInherit:!0})}a.table===p().ev&&!a.isTopLevel()&&t.role!==n.role&&x!==t.role&&v().MR(s),b().createAndCommit({userAction:"PermissionItem.handlePermissionItemChange",environment:s,canUndo:!0,useSudoMode:C,perform:t=>{const o=i().default.DO_NOT_USE_markLegacy("share_menu.update_page_permission_lag");y().wd({environment:s,store:a,permissionItems:[n],transaction:t,pagePermissionChangeLocation:e.location,metric:o,fromPermissionWrapper:f})}}),"trusted_domain_permission"===n.type&&l().log({level:"warning",from:"shareMenu.handlePermissionItemChange",type:"TrustedDomainPermissionChange",spaceId:(0,g().e)(a.pointer.spaceId),data:{miscDataToConvertToString:{message:"shareMenu.handlePermissionItemChange updating trusted domain permission",blockId:a.id,oldPermissionItem:t,newPermissionItem:n}}});if((0,m().tb)(t)&&(0,m().tb)(n)&&a.table===u().Vl){var S;const e=null===(S=a.getParentBlockStore())||void 0===S?void 0:S.id,i="none"===n.role&&"none"!==t.role,r="none"!==t.role&&"none"!==n.role&&t.role!==n.role;i?(0,o().u)({environment:s,event:{eventName:"delete_db_row_permission_rule",eventProperties:{permission_property_info:t.property_info,permission_role:t.role,share_menu_session_id:I().Ay.state.sessionId,collection_id:a.id,collection_view_block_id:e}}}):r&&(0,o().u)({environment:s,event:{eventName:"update_db_row_permission_rule",eventProperties:{permission_property_info:n.property_info,old_permission_role:t.role,new_permission_role:n.role,share_menu_session_id:I().Ay.state.sessionId,collection_id:a.id,collection_view_block_id:e}}})}return!0}async function P(e){const{environment:t,useSudoMode:n,store:o,permissionItem:i,fromPermissionWrapper:l,shouldInherit:c}=e,m="none"===(null==i?void 0:i.role)?{type:"remove",permissionItem:i}:{type:"restrict"};return!!("user_permission"===(null==i?void 0:i.type)&&(null==i?void 0:i.user_id)===t.currentUser.id||(await r().Gh({message:(0,C().r6)(m),description:(0,x.jsx)(a().A,{isSmall:!0,isMultiline:!0,children:(0,x.jsx)(h().sA,{id:"restrictedPermissionConfirmationModal.footer.whisperTextV2",defaultMessage:"Changing this will unlink this page from its parent, so it will no longer inherit share settings. Admins can still restore settings on unlinked pages."})}),acceptLabel:(0,C().QU)(m),icon:(0,x.jsx)(s().I,{icon:d().arrowBranchIcon,size:"xl"})})).accept)&&(b().createAndCommit({userAction:"PermissionItem.onAccept",environment:t,canUndo:!0,useSudoMode:n,perform:e=>{y().wW({environment:t,store:o,permissionItem:i,shouldInherit:c,transaction:e,fromPermissionWrapper:l})}}),!0)}}}]);