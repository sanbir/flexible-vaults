"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[5140,11235,25700,75681,87017],{267:(e,t,n)=>{n.d(t,{_:()=>o});var i=()=>n(230711),s=()=>n(907258);function o(e){var t;const{sidebarSpaceStore:n}=s().default.state,{currentUser:o}=e.environment;return void 0!==o.id&&Boolean(null===(t=(0,i().sE)(n,o.id))||void 0===t?void 0:t.isWorkspaceOwner())}},5580:(e,t,n)=>{n.d(t,{n:()=>a});var i=()=>n(907258),s=()=>n(590526),o=()=>n(209199);function a(){return(0,s().K8)((()=>{var e;const t=(null===(e=i().default.state.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.preferred_locale)??o().q;return(0,o().o_)(t)}),[])}},6027:(e,t,n)=>{n.d(t,{F:()=>Y});var i=()=>n(726637),s=()=>n(675133),o=()=>n(609679),a=()=>n(834051),r=()=>n(825237),l=()=>n(945778),d=()=>n(142748),c=()=>n(201980),u=()=>n(751735),p=()=>n(209199),g=()=>n(806080),m=()=>n(284371),f=()=>n(715142),h=()=>n(613735),y=()=>n(547149),v=()=>n(896628),b=()=>n(892632);const S=630,x=1200,M=(0,n(100622).O4)({theme:"light"}),A=240,j="white",w=200,I=96,k=150,T=184,C=100,_=145,P=23,B=347,R=24,D=100,L=100,E=100,O="black",N=96,F=68,U=M.text.tertiary,z=40,K=(0,n(69708).YK)({builtWithNotion:{id:"socialMediaPreview.madeWithNotion",defaultMessage:"Made with Notion"}}),V='"Apple Color Emoji","Segoe UI Emoji",NotoColorEmoji,"Noto Color Emoji","Segoe UI Symbol","Android Emoji",EmojiSymbols';function q(e){return new Promise(((t,n)=>{const i=new Image;i.onload=()=>t(i),i.onerror=n,i.crossOrigin="anonymous",i.src=e}))}function W(e,t){return`${m().Wy.bold} ${t}px ${m().xf({pageFont:e,locale:o().locale})}`}function G(e){const t=m().Wy.medium,n=m().xf({pageFont:e,locale:o().locale});return`${t} ${z}px ${n}`}function H({context:e,text:t,font:n,color:i,x:s,y:o,direction:a}){e.font=n,e.textAlign="ltr"===a?"left":"right",e.textBaseline="top",e.direction=a,e.fillStyle=i,e.fillText(t,"ltr"===a?s:x-s,o)}async function Y({store:e,environment:t}){var n;if(e.pathIsDead()||!(0,d().ot)((0,a().E)(e))||(0,f().dL)(e)||e.inMemoryRecordCache.recordHasOverride({pointer:e.pointer,userId:t.currentUser.id}))return;const o=c().q4_(e.getTitleValue())||"",m=null===(n=e.getIcon())||void 0===n?void 0:n.icon,z=function(e,t){var n;const s=null===(n=t.getCover())||void 0===n?void 0:n.cover;if(s)return r().wY({url:s,width:x,permissionRecord:t.pointer,stripGoogleIconQuery:!0,baseUrl:i().A.domainBaseUrl,fullyQualified:!1,userId:e.currentUser.id})}(t,e),Y=e.getFormat(),$=new OffscreenCanvas(x,S),Q=$.getContext("2d"),{title:Z,fontSize:X,direction:J}=function(e,t){const n=document.createElement("div");n.dir="auto",n.style.direction="auto",n.style.width="auto",n.style.position="absolute",n.style.whiteSpace="nowrap",n.style.font=W(t,N),n.style.top="110vh",n.innerText=e;const i=x-D-L,s=document.body;s.appendChild(n);const o="rtl"===window.getComputedStyle(n).direction?"rtl":"ltr";if(n.clientWidth<i)return s.removeChild(n),{title:e,fontSize:N,direction:o};if(n.style.font=W(t,F),n.clientWidth<i)return s.removeChild(n),{title:e,fontSize:F,direction:o};let a=e;for(;n.clientWidth>i;)a=a.substring(0,a.length-1),n.innerText=`${a}…`;return s.removeChild(n),{title:`${a}…`,fontSize:F,direction:o}}(o,Y.page_font),ee=W(Y.page_font,X),te=B+(m?P:0),ne=te+R+X;if(Q){!function(e){e.fillStyle=j,e.fillRect(0,0,x,S)}(Q),await async function({context:e,coverImageUrl:t,icon:n,coverPosition:i=.5}){if(t){const n=await q(t),s=n.width*(A/x),o=((0,g().Et)(i)?1-i:.5)*(n.height-s);e.drawImage(n,0,o,n.width,s,0,0,x,A)}else{const t=(0,h().b)({icon:n,themeMode:M.mode}),i=t?(0,u().X4)(t,.1):M.home.cards.coverPhoto.base;e.fillStyle=i,e.fillRect(0,0,x,A),e.fillStyle="rgb(0,0,0,1)"}}({context:Q,coverImageUrl:z,icon:m,coverPosition:Y.page_cover_position}),await async function({context:e,store:t,icon:n}){if(n)if((0,l().A)(n))e.font=`${w}px ${V}`,e.textAlign=(0,p().A1)()?"right":"left",e.textBaseline="top",e.fillText(n,(0,p().A1)()?x-I:I,k);else{const s=r().wY({url:n,baseUrl:i().A.domainBaseUrl,fullyQualified:!0,permissionRecord:t.pointer,width:T,userId:void 0}),o=await q(s);e.drawImage(o,(0,p().A1)()?x-C:C,_,T,T)}}({context:Q,store:e,icon:m}),H({context:Q,text:Z,font:ee,color:O,x:D,y:te,direction:J}),H({context:Q,text:s().A.formatMessage(K.builtWithNotion),font:G(Y.page_font),color:U,x:E,y:ne,direction:(0,p().A1)()?"rtl":"ltr"});const n=await $.convertToBlob();!function({store:e,file:t,environment:n}){b().QM({environment:n,file:t,bucket:"secure",record:e.pointer,isFileBlock:!1,onComplete:t=>{y().createAndCommit({userAction:"SocialMediaPreviewImageUploadStore.updateSocialMediaPreviewImage",environment:n,canUndo:!1,perform:n=>{v().lm({store:e,url:t,transaction:n})}})},retryWhenOffline:!0})}({store:e,environment:t,file:new File([n],"SocialMediaPreviewImage.png",{type:"image/png"})})}}},12314:(e,t,n)=>{n.d(t,{rD:()=>u,tl:()=>p,qo:()=>h,x2:()=>g,QB:()=>f,gE:()=>m,sf:()=>c,pO:()=>d,vP:()=>l});var i=()=>n(79926),s=()=>n(590526),o=()=>n(131448),a=()=>n(717250),r=()=>n(481411);function l(){return(0,s().K8)((()=>o().default.isVisible(a().l)&&"topbar_more_button"===r().k.state.currentStep),[])}function d(){return(0,s().K8)((()=>o().default.isVisible(a().l)&&"available_offline_item"===r().k.state.currentStep),[])}const c=new(i().O2)("offlineOnboarding",(()=>Promise.all([n.e(75134),n.e(44711),n.e(53321),n.e(38293),n.e(15499)]).then(n.bind(n,674730)))),u=(0,i()._h)(c,(e=>e.MaybeOfflineModeLaunchModal)),p=(0,i()._h)(c,(e=>e.OfflineModeLaunchModal)),g=(0,i()._h)(c,(e=>e.OfflineModeSidebarCallout)),m=(0,i()._h)(c,(e=>e.OfflinePagesListener)),f=(0,i()._h)(c,(e=>e.OfflineModeTopbarTooltip)),h=(0,i()._h)(c,(e=>e.OfflineModeMenuItemTooltip))},14517:(e,t,n)=>{n.r(t),n.d(t,{PageLayoutEditor:()=>ci});var i=n(296540),s=()=>n(756117),o=()=>n(402014),a=()=>n(484714),r=()=>n(590526),l=()=>n(401497),d=()=>n(611648),c=()=>n(249046),u=()=>n(695115),p=()=>n(26697),g=()=>n(387964),m=()=>n(22634),f=()=>n(69708),h=()=>n(100622),y=()=>n(534177),v=()=>n(376254),b=()=>n(852302),S=()=>n(479062),x=()=>n(524165),M=()=>n(812412),A=()=>n(542371),j=()=>n(263711),w=()=>n(79926),I=()=>n(807449),k=()=>n(287188),T=()=>n(424400),C=()=>n(148307),_=()=>n(651124),P=()=>n(390066),B=()=>n(395546),R=()=>n(800065),D=()=>n(284371),L=()=>n(334261),E=()=>n(896628),O=()=>n(115552),N=()=>n(757754),F=()=>n(867159),U=()=>n(547149);const z={switchFromSimpleToTabbedLayoutActions:new(w().O2)("switchFromSimpleToTabbedLayoutActions",(async()=>n.e(63990).then(n.bind(n,288143)))),switchFromTabbedToSimpleLayoutActions:new(w().O2)("switchFromTabbedToSimpleLayoutActions",(async()=>n.e(61362).then(n.bind(n,434867)))),createRelationViewsModuleActions:new(w().O2)("createRelationViewsModuleActinos",(async()=>n.e(84455).then(n.bind(n,957568)))),deleteViewsModuleDependenciesActions:new(w().O2)("deleteViewsModuleDependenciesActions",(async()=>Promise.resolve().then(n.bind(n,658616))))};n(944114),n(581454);var K=()=>n(81068),V=()=>n(663639),q=()=>n(736847),W=()=>n(898244),G=()=>n(852424),H=()=>n(344417),Y=()=>n(908201),$=()=>n(680288),Q=()=>n(419357),Z=()=>n(937199),X=()=>n(369186),J=()=>n(183558),ee=()=>n(978846);function te(e){const{propertyId:t,propertyType:n,environment:i,transaction:s,layoutStore:o,collectionStore:a,currentModuleSelection:r,sessionId:l,isPropertyCreation:d}=e,c=o.getModel(),u=a.getModel();if(!c||!u||"new_module"!==(null==r?void 0:r.type))return;const p={id:(0,J().Ay)(),type:"property",propertyId:t,style:"expanded"};if("person"===n||"created_by"===n||"last_edited_by"===n?p.config={property_person:{style:"compact"}}:"number"===n&&(p.config={property_number:{style:"large"}}),"form_conditional_modules"===r.area)return;const g=(0,X().dI)({collectionModel:u,module:p});return(0,ee().UQ)({environment:i,transaction:s,layoutStore:o,position:"views_main_tab_modules"===r.area?{type:"area_relative",area:r.area,viewId:r.viewsMainTabId,location:"end_moveable"}:{type:"area_relative",area:r.area,location:"end_moveable"},module:g,sessionId:l,isPropertyCreation:d}),p}function ne(){const e=(0,a().v3)(),{layoutStore:t,currentModuleSelection:s,setModuleSelection:o,sessionId:r}=(0,Z().LH)(),{collectionStore:l}=(0,Z().bi)();return(0,i.useCallback)((({propertyType:i,isPropertyCreation:a})=>{const{performResult:d}=U().createAndCommit({userAction:"AddPageLayoutModuleEditorSidebar.handleCreateNewStandardProperty",environment:e,canUndo:!0,perform:o=>{const d=t.getModel(),c=l.getModel();if(!d||!c||"new_module"!==(null==s?void 0:s.type))return;return te({propertyId:(0,n(155269).createProperty)({environment:e,collectionStore:l,collectionViewArgs:void 0,propertyName:$().dC[i],propertyType:i,transaction:o}),propertyType:i,environment:e,transaction:o,layoutStore:t,collectionStore:l,currentModuleSelection:s,sessionId:r,isPropertyCreation:a})}});d&&o({type:"existing_module",moduleId:d.id,isDragging:!1})}),[e,o,t,l,s,r])}function ie(){const e=(0,a().v3)(),{layoutStore:t,currentModuleSelection:n,setModuleSelection:s,sessionId:o}=(0,Z().LH)(),{collectionStore:r}=(0,Z().bi)();return(0,i.useCallback)((i=>{const{propertyId:a,propertyType:l}=i,{performResult:d}=U().createAndCommit({userAction:"AddPageLayoutModuleEditorSidebar.AddPropertyAsNewModule",environment:e,canUndo:!0,perform:i=>te({propertyId:a,propertyType:l,environment:e,transaction:i,layoutStore:t,collectionStore:r,currentModuleSelection:n,sessionId:o,isPropertyCreation:!1})});return d?(s({type:"existing_module",moduleId:d.id,isDragging:!1}),d):null}),[e,s,t,r,n,o])}n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(354520);var se=()=>n(713998),oe=()=>n(778781),ae=n(474848);function re(e){return void 0!==e[1]}function le({propertySortPriority:e,defaultCount:t,moreButtonStyle:s,moreButtonTitleStyle:o,isSearching:a}){const{layoutStore:l}=(0,Z().LH)(),{collectionStore:d}=(0,Z().bi)(),c=(0,n(248064).h)(),u=(0,r().K8)((()=>{const e=l.getModules();return new Set((0,n(36682).Q)(e).filter(oe().gx).map((e=>e.propertyId)))}),[l]),[p,g]=i.useState(!1);return(0,r().K8)((()=>{const i=d.getSchema();if(!l.getModel())return[];const r=(0,y().WP)(i).filter(re).sort(((t,n)=>{const i=t[1],s=n[1];return(e[i.type]??1/0)-(e[s.type]??1/0)})).map((([e,t])=>{if(e!==W().rn&&!u.has(e))return(0,n(381283).J)(t)?{id:(0,J().Ay)(),type:`property_${t.type}`,propertyId:e,style:"compact"}:(0,n(341136).A)(t)?{id:(0,J().Ay)(),type:`property_${t.type}`,propertyId:e,style:"large"}:"formula"===t.type?{id:(0,J().Ay)(),type:`property_${t.type}`,propertyId:e,style:(0,n(708685).isNumberFormulaPropertySchema)(t)?"large":"small"}:"file"===t.type?{id:(0,J().Ay)(),type:`property_${t.type}`,propertyId:e,style:"landscape"}:"place"===t.type?{id:(0,J().Ay)(),type:`property_${t.type}`,propertyId:e,style:"map"}:{id:(0,J().Ay)(),type:`property_${t.type}`,propertyId:e}})).filter(y().O9).map((e=>{const t=(0,se()._g)({schema:i,property:e.propertyId});if(t)return{key:e.id,keywords:[t.name,$().dC[t.type]],render:({ref:t,...i})=>(0,ae.jsx)(n(63667).k,{...i,propertyId:e.propertyId}),action:()=>{c({layoutModule:e})}}})).filter(y().O9),m={keywords:[],key:"use-existing-property-show-more",render:e=>(0,ae.jsx)(K().A,{...e,buttonStyle:s,desktopTitleStyle:o,title:p?(0,ae.jsx)(f().sA,{defaultMessage:"Less",id:"layoutBuilderProperties.less.buttonTitle"}):(0,ae.jsx)(f().sA,{defaultMessage:"More",id:"layoutBuilderProperties.more.buttonTitle"})}),action:()=>g((e=>!e))};return r.length>t&&!a?[...p?r:r.slice(0,t),m]:r}),[c,d,l,u,e,t,p,s,o,a])}const de=(0,f().YK)({addToPage:{id:"AddPageLayoutModuleEditorSidebar.addToPage",defaultMessage:"Add to page"},addToPanel:{id:"AddPageLayoutModuleEditorSidebar.addToPanel",defaultMessage:"Add to panel"},suggestedModulesSectionTitle:{defaultMessage:"Suggested",id:"AddPageLayoutModuleEditorSidebar.suggestedModulesSectionTitle"},existingPropertiesSectionTitle:{defaultMessage:"Use an existing property",id:"AddPageLayoutModuleEditorSidebar.existingPropertiesSectionTitle"},createNewPropertyModuleSectionTitle:{defaultMessage:"Create new property",id:"AddPageLayoutModuleEditorSidebar.createNewPropertyModuleSectionTitle"},closeAddModulesMenu:{defaultMessage:"Close add modules menu",id:"AddPageLayoutModuleEditorSidebar.closeAddModulesMenu"},searchInputPlaceholder:{defaultMessage:"Search...",id:"AddPageLayoutModuleEditorSidebar.searchInputPlaceholder"},searchInputNotFound:{defaultMessage:"Not found",id:"AddPageLayoutModuleEditorSidebar.searchInputNotFound"},propertyFileCaption:{id:"AddPageLayoutModuleButton.tooltip.files.caption",defaultMessage:"Add images, videos, or files"},propertyAiSummaryCaption:{id:"AddPageLayoutModuleButton.tooltip.aiSummary.caption",defaultMessage:"Use AI to summarize the page"},propertyPersonCaption:{id:"AddPageLayoutModuleButton.tooltip.person.caption",defaultMessage:"Add anyone in your workspace"},propertyTextCaption:{id:"AddPageLayoutModuleButton.tooltip.text.caption",defaultMessage:"Just start writing with plain text"},propertyNumberCaption:{id:"AddPageLayoutModuleButton.tooltip.number.caption",defaultMessage:"Display numbers with rings or bars"}}),ce={file:{icon:C().A.images.layouts.configuration.propertyFilesMediaPreviewJpg,tooltip:{image:C().A.images.layouts.configuration.propertyFilesMediaPreviewLargePng,caption:de.propertyFileCaption}},ai_summary:{icon:C().A.images.layouts.configuration.propertyAiSummaryPreviewPng,tooltip:{image:C().A.images.layouts.configuration.propertyAiSummaryPreviewLargePng,caption:de.propertyAiSummaryCaption}},person:{icon:C().A.images.layouts.configuration.propertyPersonPreviewPng,tooltip:{image:C().A.images.layouts.configuration.propertyPersonPreviewLargePng,caption:de.propertyPersonCaption}},text:{icon:n(435644).a,tooltip:{image:C().A.images.tooltips.blocks.textPng,caption:de.propertyTextCaption}},number:{icon:C().A.images.layouts.configuration.propertyNumberPreviewPng,tooltip:{image:C().A.images.layouts.configuration.propertyNumberPreviewLargePng,caption:de.propertyNumberCaption}}},ue={file:1,ai_summary:2,number:3,text:4,person:5},pe=i.memo((function(){const e=(0,a().v3)(),t=(0,l().DP)(),s=(0,l().eP)(),o=(0,f().tz)(),{currentModuleSelection:d,isPropertyTypeSearchInputDirtyStore:u}=(0,Z().LH)(),p=(0,Y().ET)(),g="new_module"===(null==d?void 0:d.type)&&"page_details"===d.area,m=(0,r().K8)((()=>[...(0,$().xm)({collectionContextStore:p,environment:e}),"ai_summary"].sort(((e,t)=>(ue[e]??1/0)-(ue[t]??1/0)))),[p,e]),[y,v]=(0,i.useState)(!1),[b,S]=(0,i.useState)(),x=(0,i.useCallback)((e=>{u.setState(!0),S(e.target.value)}),[u]);i.useEffect((()=>()=>{u.setState(!1)}),[u]);const M=ne(),A=ie(),j=(0,i.useMemo)((()=>({actionHandler:e=>M({propertyType:e,isPropertyCreation:!0}),tooltip:e=>{const t=ce[e];return null==t?void 0:t.tooltip},renderIcon:e=>{const n=ce[e],i="dark"===s&&null!=n&&n.darkModeIcon?null==n?void 0:n.darkModeIcon:null==n?void 0:n.icon;return i&&"string"!=typeof i?i({width:20,fill:"light"===s?"rgba(79, 79, 79, 1)":(0,G().P0)({theme:t,willShowOnTooltip:!1})}):(0,ae.jsx)(G().zB,{size:i?36:16,theme:t,type:e,icon:i,style:{fill:(0,W().hN)(e)?h().Tj.purple.icon.accentPrimary:void 0}})},propertySettingsPopupProps:e=>"relation"!==e?null:{settingsViewToOpen:{property:void 0,type:"selectRelationSource",formatKey:"page_view_properties"},isPropertyEditComplete:e=>Boolean((0,W().nC)(e)&&e.collection_id),onPropertyEditComplete:t=>{A({propertyId:t,propertyType:e})},rollbackIfEditIncomplete:!0}})),[M,t,s,A]),w=(0,n(959733).g)(j),k=(0,l().IS)((()=>({sidebarHeading:{fontSize:16,lineHeight:"24px",fontWeight:D().Wy.medium,marginInlineStart:8,paddingBottom:2},searchInputContainer:{marginTop:8,marginBottom:14,marginInlineStart:6},searchInput:{background:h().Tj.background.primary},searchNotFound:{fontSize:".8rem",color:h().Tj.text.tertiary,userSelect:"none",cursor:"default",flexShrink:0,marginInlineEnd:4},moreButton:{marginInlineStart:0},moreButtonTitle:{margin:0,color:h().Tj.text.tertiary,fontSize:12,paddingTop:0,paddingInlineEnd:0,paddingBottom:0,paddingInlineStart:6},sectionTitle:{paddingTop:0,paddingInlineEnd:0,paddingBottom:0,paddingInlineStart:6}})),[]),T=(0,r().K8)((()=>{const e=b||y,t={keywords:[],key:"create-new-property-more",render:e=>(0,ae.jsx)(K().A,{...e,buttonStyle:k.moreButton,desktopTitleStyle:k.moreButtonTitle,title:y?(0,ae.jsx)(f().sA,{defaultMessage:"Less",id:"layoutBuilderProperties.less.buttonTitle"}):(0,ae.jsx)(f().sA,{defaultMessage:"More",id:"layoutBuilderProperties.more.buttonTitle"})}),action:()=>v((e=>!e))};return[...m.slice(0,e?void 0:5).map(w),...b?[]:[t]]}),[m,y,w,b,k.moreButton,k.moreButtonTitle]),C=le({propertySortPriority:ue,defaultCount:4,moreButtonStyle:k.moreButton,moreButtonTitleStyle:k.moreButtonTitle,isSearching:Boolean(b)}),_=(0,i.useMemo)((()=>{const e=[];return C.length>0&&e.push({key:"existing-properties",render:e=>(0,ae.jsx)(q().A,{title:o.formatMessage(de.existingPropertiesSectionTitle),desktopTitleStyle:k.sectionTitle,...e}),items:C}),e.push({key:"create-new-properties",render:e=>(0,ae.jsx)(q().A,{title:o.formatMessage(de.createNewPropertyModuleSectionTitle),desktopTitleStyle:k.sectionTitle,...e}),items:T}),e}),[T,C,o,k.sectionTitle]),P=(0,n(608346).m)({sections:_,filterQuery:b}),B=i.useMemo((()=>{if(!(""===b||P.length>0))return(0,ae.jsx)(c().Ye,{alignItems:"center",gap:8,children:(0,ae.jsx)("div",{children:o.formatMessage(de.searchInputNotFound)})})}),[P,b,o]);return(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsx)(c().Ye,{style:k.sidebarHeading,alignItems:"center",children:(0,ae.jsx)(f().sA,{...g?de.addToPanel:de.addToPage})}),(0,ae.jsx)(Q().Ay,{focusInitial:!0,onChange:x,placeholder:o.formatMessage(de.searchInputPlaceholder),showClearButton:!0,value:b||"",style:k.searchInputContainer,inputOuterStyle:k.searchInput,inputLeft:(0,ae.jsx)(I().I,{icon:H().magnifyingGlassSmallIcon,size:"xxs",colorVariant:"secondary"}),itemMarginLeft:0,inputRight:B,inputRightStyle:k.searchNotFound}),(0,ae.jsx)(V().A,{initialFocus:0,type:V().O.Vertical,sections:P})]})}));var ge=()=>n(435930),me=(n(803949),()=>n(259985)),fe=()=>n(124672),he=()=>n(623186),ye=()=>n(171018),ve=(n(430670),n.n(n(844751))),be=()=>n(757695),Se=()=>n(418493),xe=()=>n(103725),Me=()=>n(591779),Ae=()=>n(643707);function je(e){const{propertyGroups:t,propertyIdsToExclude:n,mergedPropertiesMap:s,scrollerContext:o}=e,l=i.useMemo((()=>be().Store.createValue("")),[]),[d,c]=i.useState([]),[u,p]=i.useState({}),[g,m]=i.useState(null),f=i.useMemo((()=>{let e=t?t.flatMap((e=>e.propertyIds||[])):Object.keys(s);return n&&(e=e.filter((e=>!n.has(e)))),e}),[s,t,n]),h=(0,r().O$)(l),y=(0,Me().lW)(h,100,((e,t)=>e===t));i.useEffect((()=>{const e=[],t={};if(""!==y)for(const n of f){const i=s[n];i&&null!==ve().match(y,i.name)&&(e.push(n),t[n]=e.length-1)}(d.length!==e.length||e.some(((e,t)=>e!==d[t])))&&(c(e),p(t))}),[f,d,y,s]),i.useEffect((()=>{if(0===d.length)return void m(null);const e=null!==g?d[g]:null;e&&void 0!==u[e]?m(u[e]):m(0)}),[g,d,u]);const v=(0,a().v3)(),b=null!==g?d[g]:null;return i.useEffect((()=>{const e=document.getElementsByClassName(Ae().wT).item(0);e&&!(0,Se().E)({element:e})&&(0,xe().h)({element:e,environment:v,scrollerContext:o,vertical:{reveal:"closest"},horizontal:{reveal:"closest"}})}),[v,b,o]),{searchInputValueStore:l,searchMatchesMap:u,searchMatches:d,activeSearchMatchIndex:g,moveToNextSearchMatch:()=>{if(null===g||d.length<=1)return;const e=g+1;m(e<=d.length-1?e:0)},moveToPreviousSearchMatch:()=>{if(null===g||d.length<=1)return;const e=g-1;m(e>=0?e:d.length-1)}}}var we=()=>n(157260);function Ie({propertyGroupId:e,pagePropertiesStore:t}){const{collectionStore:n}=(0,Z().bi)(),i=(0,l().IS)((()=>({button:{color:h().Tj.text.secondary,paddingInlineStart:8,height:34},buttonIcon:{fill:h().Tj.icon.secondary,marginInlineEnd:2}})),[]);return(0,ae.jsx)(we().X,{style:i.button,iconStyle:i.buttonIcon,collectionStore:n,isInPeekRenderer:!1,propertyGroupId:e,pagePropertiesStore:t})}const ke=i.memo(Ie);n(16280);var Te=()=>n(717137),Ce=()=>n(148860),_e=()=>n(127833),Pe=()=>n(250910),Be=()=>n(118307),Re=()=>n(31511),De=()=>n(546926),Le=()=>n(631524),Ee=()=>n(160432),Oe=()=>n(890492),Ne=()=>n(655923),Fe=()=>n(112282),Ue=()=>n(105819),ze=()=>n(236262),Ke=()=>n(201980),Ve=()=>n(496603),qe=()=>n(395963);class We extends be().Store{getInitialState(){return{}}isRenameInputForcedOpenForGroup(e){var t;return(null===(t=this.getState())||void 0===t?void 0:t.forceOpenRenameInputForGroupId)===e}resetForceRenameInputOpen(){const e=this.getState();return this.setState({...e,forceOpenRenameInputForGroupId:void 0})}}const Ge=new We;function He(e){const{title:t,propertyGroupId:n,isFirstPropertyGroup:s,isLastPropertyGroup:o,styles:d}=e,c=(0,r().uB)(void 0,Be().A),u=(0,r().K8)((()=>Ge.isRenameInputForcedOpenForGroup(n)),[n]),[p,g]=(0,i.useState)(u);(0,i.useEffect)((()=>{c.setState({...c.state,open:u})}),[c,u]);const m=(0,i.useCallback)((()=>{g(!1),Ge.resetForceRenameInputOpen()}),[]),y=function(){const{collectionStore:e}=(0,Z().bi)(),t=(0,a().v3)();return(0,i.useCallback)((n=>{U().createAndCommit({environment:t,perform(t){(0,qe().Px)({collectionStore:e,groupId:n,transaction:t})},canUndo:!0,userAction:"ConfigurePropertyGroupModuleGroupHeading.deleteCollectionPropertyGroup"})}),[e,t])}(),v=function(){const{collectionStore:e}=(0,Z().bi)(),t=(0,a().v3)();return(0,i.useCallback)((n=>{U().createAndCommit({environment:t,perform(t){(0,qe().Tk)({collectionStore:e,groupId:n,transaction:t})},canUndo:!0,userAction:"ConfigurePropertyGroupModuleGroupHeading.deleteCollectionPropertyGroup"})}),[e,t])}(),b=function(){const{collectionStore:e}=(0,Z().bi)(),t=(0,a().v3)();return(0,i.useCallback)((n=>{U().createAndCommit({environment:t,perform(t){(0,qe().QI)({collectionStore:e,groupId:n,transaction:t})},canUndo:!0,userAction:"ConfigurePropertyGroupModuleGroupHeading.deleteCollectionPropertyGroup"})}),[e,t])}(),S=(0,l().IS)((()=>({container:{display:"flex",alignItems:"center",padding:"0 2px",...(null==d?void 0:d.container)||{}},titleContainer:{display:"flex",alignItems:"center",marginInlineEnd:"auto",paddingInlineStart:5,borderRadius:4,height:"auto",width:"100%"},label:{fontSize:"12px",lineHeight:"24px",color:h().Tj.text.secondary,fontWeight:500,paddingTop:0,paddingInlineEnd:8,paddingBottom:0,paddingInlineStart:5,display:"block",...D().RC}})),[d]);return(0,ae.jsx)("div",{style:S.container,children:(0,ae.jsx)(Pe().A,{style:{width:268},onClose:m,popupType:_e().nl.Popup,renderOrigin:e=>(0,ae.jsxs)(Le().p,{...e,style:S.titleContainer,children:[(0,ae.jsx)(Ce().t,{}),(0,ae.jsx)("div",{style:S.label,children:t})]}),buttonPopupStore:c,alignmentToOrigin:"start",render:e=>{return p?(0,ae.jsx)(Ye,{propertyGroupId:n,value:t||"",afterSubmit:e.close}):(0,ae.jsx)(Oe().A,{menuType:De().gu.Popup,children:(0,ae.jsx)(V().A,{type:V().O.Vertical,initialFocus:0,sections:[{key:0,render:e=>(0,ae.jsx)(q().A,{...e}),items:(i=e.close,(0,Ve().oE)([{key:"rename",render:e=>(0,ae.jsx)(K().A,{...e,icon:(0,ae.jsx)(I().I,{icon:Ue().pencilLineIcon}),title:(0,ae.jsx)(f().sA,{defaultMessage:"Rename",id:"ConfigurePropertyGroupModuleGroupHeading.rename"})}),action:()=>{g(!0)}},!s&&{key:"move-up",render:e=>(0,ae.jsx)(K().A,{...e,icon:(0,ae.jsx)(I().I,{icon:Fe().arrowStraightUpIcon}),title:(0,ae.jsx)(f().sA,{defaultMessage:"Move up",id:"ConfigurePropertyGroupModuleGroupHeading.moveUp"})}),action:()=>{v(n),i()}},!o&&{key:"move-down",render:e=>(0,ae.jsx)(K().A,{...e,icon:(0,ae.jsx)(I().I,{icon:Ne().arrowStraightDownIcon}),title:(0,ae.jsx)(f().sA,{defaultMessage:"Move down",id:"ConfigurePropertyGroupModuleGroupHeading.moveDown"})}),action:()=>{b(n),i()}},{key:"delete",render:e=>(0,ae.jsx)(K().A,{...e,icon:(0,ae.jsx)(I().I,{icon:ze().trashIcon}),title:(0,ae.jsx)(f().sA,{defaultMessage:"Delete",id:"ConfigurePropertyGroupModuleGroupHeading.delete"}),caption:(0,ae.jsx)(f().sA,{defaultMessage:"No properties will be deleted",id:"ConfigurePropertyGroupModuleGroupHeading.deleteCaption"})}),action:()=>{y(n),i()}}]))}]})});var i}})})}function Ye({propertyGroupId:e,afterSubmit:t,value:n}){const[s,o]=(0,i.useState)(n),r=(0,l().IS)((()=>({container:{display:"flex",padding:"6px"},input:{marginInlineEnd:4,flexGrow:1},button:{}})),[]),d=function(){const{collectionStore:e}=(0,Z().bi)(),t=(0,a().v3)();return(0,i.useCallback)(((n,i)=>{const s=e.getNormalizedPropertyGroups();if(void 0===s)throw new Error("Error renaming property group. Collection Does not have property groups.");const o=s.map((e=>e.id===n?{...e,title:i}:e));U().createAndCommit({environment:t,perform(t){E().zA({stores:[e],update:{property_groups:o},transaction:t})},canUndo:!0,userAction:"ConfigurePropertyExplorerModule.renameCollectionPropertyGroup"})}),[e,t])}(),c=(0,i.useCallback)((()=>{const n=(0,Ke().xV3)(s).trim();0!==n.length&&(d(e,n),t())}),[t,d,s,e]),u=(0,i.useCallback)((e=>{o(e.target.value)}),[]);return(0,ae.jsx)(Te().A,{debugName:"ConfigurePropertyGroupHeader",capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!0,children:(0,ae.jsxs)("div",{style:r.container,children:[(0,ae.jsx)(Re().A,{style:r.input,onSubmit:c,selectAll:!0,value:s,onChange:u,focusInitial:!0}),(0,ae.jsx)(Ee().A,{colorPalette:"blue",style:r.button,onClick:c,children:(0,ae.jsx)(f().sA,{id:"ConfigurePropertyGroupModuleGroupHeading.updatePropertyGroupTitle",defaultMessage:"Done"})})]})})}var $e=()=>n(387358),Qe=(n(18107),()=>n(271205));function Ze({sections:e,onDrop:t,renderKey:n,getInvalidDropIndices:s,direction:o}){const[a,r]=i.useState({type:"notDragging"}),d=(0,i.useMemo)((()=>{const t={};for(const n of e)t[et(n.key)]=n;return t}),[e]),c=(0,i.useCallback)((e=>(0,y().O9)(d[et(e)])),[d]),u=(0,i.useMemo)((()=>e.flatMap((e=>[e.key,...e.items]))),[e]),p=(0,i.useMemo)((()=>u.map(et)),[u]),g=(0,i.useMemo)((()=>{const e={};for(const t of u)e[et(t)]=t;return e}),[u]),m=i.useCallback(((n,{key:i})=>{c(i)?t({newSections:Je({orderedSectionKeys:n.filter(c),originalSections:e}),droppedKey:i,isSection:!0}):t({newSections:Xe({flattenedKeys:n.map((e=>g[e])),getIsSection:c}),droppedKey:i,isSection:!1})}),[c,t,e,g]),f=i.useCallback((e=>{c(e)?r({type:"draggingSection",key:e}):r({type:"draggingItem",key:e})}),[c]),h=i.useCallback((()=>r({type:"notDragging"})),[]),v=(0,i.useCallback)((e=>{let t;t=c(e)?new Set(u.flatMap(((e,t)=>c(e)?[]:[t]))):new Set([0]);const n=null==s?void 0:s({flattenedKeys:p,...c(e)?{isSection:!0,key:e}:{isSection:!1,key:e}});return n?new Set([...t,...n]):t}),[s,c,u,p]),b=(0,l().IS)((()=>{const e={opacity:1,transition:"opacity 0.2s ease"},t={...e,opacity:.7};return{container:{},undraggedSection:e,draggedSection:t,undraggedItem:{...e,width:"100%"},draggedItem:{...t,width:"100%"},itemInDraggedSection:{...e,opacity:0,width:"100%"}}}),[]),S=(0,i.useMemo)((()=>{const t="draggingSection"===a.type?a.key:void 0,i="draggingItem"===a.type?a.key:void 0,s={};return e.forEach(((e,i)=>{const o=et(e.key),a=t===o;s[o]=(0,ae.jsx)("div",{style:a?b.draggedSection:b.undraggedSection,children:n({key:o,isDraggable:tt(e.key),isSection:!0,sectionIndex:i,sectionLength:e.items.length})})})),e.forEach(((e,o)=>{const a=t===et(e.key);return e.items.forEach(((t,r)=>{const l=i===et(t),d=e.items.length,c=et(t);s[c]=(0,ae.jsx)("div",{style:l?b.draggedItem:a?b.itemInDraggedSection:b.undraggedItem,children:n({key:et(t),isDraggable:tt(t),isSection:!1,sectionIndex:o,itemIndex:r,sectionLength:d})})}))})),s}),[a,n,e,b.draggedItem,b.draggedSection,b.itemInDraggedSection,b.undraggedItem,b.undraggedSection]);return(0,ae.jsx)(Qe().Ay,{style:b.container,direction:o,keys:u,renderKey:e=>S[e],onDraggingKeyChanged:f,onDragEnd:h,onDrop:m,getInvalidDropIndices:v})}function Xe({flattenedKeys:e,getIsSection:t}){const n=function({orderedList:e,getIsSection:t}){const n=e.findIndex((e=>t(e)));if(-1===n||0===n)return e;return[e[n],...e.slice(0,n),...e.slice(n+1)]}({orderedList:e,getIsSection:t}),i=[];for(const s of n)if(t(s))i.push({key:s,items:[]});else{const e=s,t=i.at(-1);t&&t.items.push(e)}return i}function Je({orderedSectionKeys:e,originalSections:t}){const n={};for(const i of t)n[et(i.key)]={key:i.key,items:i.items};return e.flatMap((e=>n[e]?[n[e]]:[]))}function et(e){return"string"==typeof e?e:e.key}function tt(e){return"string"==typeof e||(e.draggable??!0)}const nt=i.memo(Ze);function it(e){const{collectionFormat:t,mergedProperties:n,renderPropertyRow:s}=e,{collectionStore:o}=(0,Z().bi)(),a=(0,i.useMemo)((()=>null==n?void 0:n.map((e=>e.property))),[n]),r=(0,i.useCallback)(((e,t)=>s({propertyId:e,rowIndex:t})),[s]),l=(0,he().Od)({collectionStore:o,format:t});return a?(0,ae.jsx)(Qe().Ay,{keys:a,onDrop:l,direction:"vertical",renderKey:r}):null}function st(e){const{renderPropertyRow:t,renderPropertyGroupRow:n,renderAddPropertyButton:s}=e,o=(0,a().v3)(),{collectionStore:l}=(0,Z().bi)(),d=(0,r().K8)((()=>l.getNormalizedPropertyGroups()??[]),[l]),c=(0,i.useMemo)((()=>Object.fromEntries(d.map((e=>[e.id,e])))),[d]),u=(0,r().K8)((()=>d.map((e=>{var t;return{key:{key:e.id,draggable:!0},items:[...(null===(t=e.propertyIds)||void 0===t?void 0:t.map((e=>({key:e,draggable:!0}))))??[],(0,$e().Op)(e.id)]}}))),[d]),p=(0,i.useCallback)((({flattenedKeys:e,isSection:t})=>t?new Set(e.flatMap(((e,t)=>(0,y().O9)(c[e])?[]:[t]))):new Set(e.flatMap(((e,t)=>(0,$e().k9)(e)?[t+1]:[])))),[c]),g=(0,i.useCallback)((e=>{var i;return e.isSection?n({groupId:e.key,groupTitle:null===(i=c[e.key])||void 0===i?void 0:i.title,rowIndex:e.sectionIndex}):(0,$e().k9)(e.key)?s((0,$e().qB)(e.key)):t({propertyId:e.key,rowIndex:e.sectionIndex})}),[c,s,n,t]),m=(0,i.useCallback)((e=>{const t=e.newSections.map((e=>{var t;const n=e.items.map((e=>"string"==typeof e?e:e.key)).filter((e=>!(0,$e().k9)(e))),i="string"==typeof e.key?e.key:e.key.key;return{id:i,title:null===(t=c[i])||void 0===t?void 0:t.title,propertyIds:n}}));U().createAndCommit({environment:o,perform(e){(0,qe().Yf)({collectionStore:l,newGroups:t,transaction:e})},canUndo:!0,userAction:"ConfigurePropertyExplorerModule.onDrop"})}),[l,o,c]);return(0,ae.jsx)(nt,{direction:"vertical",sections:u,renderKey:g,onDrop:m,getInvalidDropIndices:p})}var ot=()=>n(187881),at=()=>n(514608),rt=()=>n(340498);const lt={viewBox:"0 0 20 20",fittedViewBox:"1.38 7.08 17.23 7.69",svg:(0,ae.jsx)("path",{d:"M17.29 7.334a.626.626 0 0 1 1.032.707 9.3 9.3 0 0 1-1.469 1.665l1.596 1.733a.625.625 0 0 1-.92.847l-1.662-1.807c-.795.545-1.68.98-2.63 1.286l.522 2.253a.626.626 0 0 1-1.218.283l-.514-2.227q-.984.192-2.027.194l-.326-.005a10.6 10.6 0 0 1-1.7-.189l-.516 2.227a.625.625 0 0 1-1.217-.283l.521-2.254a10.1 10.1 0 0 1-2.63-1.285l-1.66 1.807a.625.625 0 0 1-.92-.847l1.595-1.734A9.3 9.3 0 0 1 1.679 8.04a.626.626 0 0 1 1.031-.707c1.512 2.203 4.203 3.684 7.29 3.684 3.088 0 5.779-1.482 7.29-3.684"})},dt=(0,rt().wt)("eyeClosed",lt,"default"),ct={viewBox:"0 0 16 16",fittedViewBox:"0.98 5.5 14.02 6.45",svg:(0,ae.jsx)("path",{d:"M13.73 5.797a.625.625 0 1 1 1.03.707c-.316.46-.688.883-1.102 1.266l1.193 1.296a.626.626 0 0 1-.92.847l-1.258-1.367a8.2 8.2 0 0 1-1.936.945l.392 1.696a.626.626 0 0 1-1.218.28l-.384-1.662A8.7 8.7 0 0 1 8 9.94l-.264-.003a9 9 0 0 1-1.263-.132l-.385 1.663a.625.625 0 1 1-1.218-.281l.392-1.696a8.2 8.2 0 0 1-1.937-.945L2.07 9.913a.625.625 0 1 1-.92-.847L2.342 7.77a7.6 7.6 0 0 1-1.101-1.266.625.625 0 0 1 1.03-.707C3.456 7.524 5.57 8.69 8 8.69s4.544-1.166 5.729-2.893"})},ut=(0,rt().wt)("eyeClosedSmall",ct,"small");var pt=()=>n(566910),gt=()=>n(725900),mt=()=>n(68350),ft=()=>n(457419);function ht({collectionStore:e,pageStore:t,layoutModule:n,pagePropertiesStore:s,propertyId:o,draggable:a,rightButton:d,searchHighlighted:c}){const u=(0,r().K8)((()=>(0,ft().S)(t)),[t]),{collectionSchema:p,collectionFormat:g,canEditCollection:m}=(0,r().K8)((()=>({collectionSchema:e.getSchema(),collectionFormat:e.getFormat(),canEditCollection:e.canEdit()})),[e]),f=(0,l().IS)((()=>({propertyRowContainer:{width:"100%",minWidth:"100%",display:"grid",alignItems:"center",gridTemplateColumns:"1fr auto",gap:2,paddingInlineStart:2}})),[]),h=(0,i.useMemo)((()=>({color:"primary",size:"medium",fontWeight:"regular",width:{variant:"fixed",widthDesktop:"100%",widthMobile:"100%"}})),[]),y=Boolean(c),v=Boolean(c&&c.active);return(0,ae.jsxs)("div",{style:f.propertyRowContainer,children:[(0,ae.jsx)(mt().I,{schema:p,styleVariants:h,format:g,property:o,collectionStore:e,disabled:!1,locked:u,canConfigureCollection:m,isInPeekRenderer:!1,hideDragHandle:!a,showDragHandleAsIcon:!0,dragHandleStyle:{width:16,marginInlineEnd:2},blockStore:t,pagePropertiesStore:s,layoutModule:n,forceHighlight:y,forceFocusedHighlight:v}),d?d():null]})}function yt(e){const{propertyId:t,propertyFormat:n,pagePropertiesStore:s,collectionStore:o,pageStore:l,searchHighlighted:d}=e,c=(0,f().tz)(),p=(0,a().v3)(),g=(0,r().K8)((()=>o.getSchema()),[o]),m=(0,r().K8)((()=>(0,P().L)(o.getFormat(),g,void 0,_().jf.Collection)),[o,g]),h=g[t],y=(0,i.useCallback)((e=>{U().createAndCommit({environment:p,userAction:"LayoutBuilder.propertiesConfiguration.toggleVisibility",canUndo:!0,perform:n=>{L().D7({property:t,visibility:e,store:o,format:m,transaction:n})}})}),[m,o,p,t]),v="show"===(null==n?void 0:n.visibility)?at().eyeFillSmallIcon:"hide_if_empty"===(null==n?void 0:n.visibility)?gt().V:ut,b="show"===(null==n?void 0:n.visibility)||"hide_if_empty"===(null==n?void 0:n.visibility);if(!h)return null;return(0,ae.jsx)(ht,{pageStore:l,collectionStore:o,propertyId:t,pagePropertiesStore:s,draggable:!0,rightButton:()=>(0,ae.jsx)(Pe().A,{popupType:_e().nl.Popup,renderOrigin:e=>(0,ae.jsx)(u().A,{ariaLabel:c.formatMessage(bt.visibilityToggleIconAriaLabel,{propertyName:h.name}),icon:v,colorVariant:b?"primary":"secondary",...e}),alignmentToOrigin:"start",render:e=>(0,ae.jsx)(vt,{parentClose:e.close,setVisibilityOfProperty:y})}),searchHighlighted:d,layoutModule:e.layoutModule})}function vt(e){const{setVisibilityOfProperty:t,parentClose:n}=e,s=(0,i.useMemo)((()=>[{key:0,render:e=>(0,ae.jsx)(q().A,{...e}),items:[{key:"always_show",render:e=>(0,ae.jsx)(K().A,{...e,icon:(0,ae.jsx)(I().I,{icon:ot().eyeFillIcon}),title:(0,ae.jsx)(f().sA,{defaultMessage:"Always show",id:"ConfigurePropertiesPropertyRow.visibility.alwaysShow"})}),action:()=>{t("show"),n()}},{key:"hide_if_empty",render:e=>(0,ae.jsx)(K().A,{...e,icon:(0,ae.jsx)(I().I,{icon:pt().e}),title:(0,ae.jsx)(f().sA,{defaultMessage:"Hide when empty",id:"ConfigurePropertiesPropertyRow.visibility.hide_when_empty"})}),action:()=>{t("hide_if_empty"),n()}},{key:"hide",render:e=>(0,ae.jsx)(K().A,{...e,icon:(0,ae.jsx)(I().I,{icon:dt}),title:(0,ae.jsx)(f().sA,{defaultMessage:"Always hide",id:"ConfigurePropertiesPropertyRow.visibility.alwaysHide"})}),action:()=>{t("hide"),n()}}]}]),[n,t]);return(0,ae.jsx)(Oe().A,{menuType:De().gu.Popup,children:(0,ae.jsx)(V().A,{type:V().O.Vertical,initialFocus:0,sections:s})})}const bt=(0,f().YK)({visibilityToggleIconAriaLabel:{id:"pageLayout.configureProperties.visibilityToggleIconAriaLabel",defaultMessage:"Toggle the visibility {propertyName}"}});var St=()=>n(886358),xt=()=>n(107023);const Mt=(0,f().YK)({filterPropertiesInputPlaceholder:{id:"layouts.configurePropertiesModule.filterProperties.input.placeholder",defaultMessage:"Search..."},notFound:{id:"layouts.configurePropertiesModule.filterProperties.input.notFound",defaultMessage:"Not found"},arrowButtonDownAriaLabel:{id:"layouts.configurePropertiesModule.filterProperties.input.arrowButtonDown.ariaLabel",defaultMessage:"Button to navigate to the next result"},arrowButtonUpAriaLabel:{id:"layouts.configurePropertiesModule.filterProperties.input.arrowButtonUp.ariaLabel",defaultMessage:"Button to navigate to the previous result"}});function At(e){const{searchInputValueStore:t,activeSearchMatchIndex:n,searchMatches:s,moveToNextSearchMatch:o,moveToPreviousSearchMatch:a}=e,d=(0,r().O$)(t),p=(0,f().tz)(),g=i.useCallback((e=>{"Enter"===e.key?(e.preventDefault(),o()):"ArrowUp"===e.key?a():"ArrowDown"===e.key&&o()}),[o,a]),m=(0,l().IS)((()=>({searchMatchCount:{fontSize:".8rem",color:h().Tj.text.tertiary,userSelect:"none",cursor:"default",flexShrink:0,marginInlineEnd:4},searchMatchArrowButton:{padding:3,width:void 0,height:void 0,cursor:"pointer"},searchMatchArrowIcon:{width:12,height:12,color:h().Tj.icon.secondary,strokeWidth:.4,stroke:"currentcolor"},searchInputOuter:{background:h().Tj.white}})),[]),y=i.useMemo((()=>{if(""!==d)return(0,ae.jsxs)(c().Ye,{alignItems:"center",gap:8,children:[(0,ae.jsx)("div",{children:null!==n?`${n+1} of ${s.length}`:p.formatMessage(Mt.notFound)}),null!==n?(0,ae.jsxs)(c().Ye,{gap:0,alignItems:"center",children:[(0,ae.jsx)(u().A,{icon:St().arrowStraightDownFillSmallIcon,iconStyle:m.searchMatchArrowIcon,style:m.searchMatchArrowButton,ariaLabel:p.formatMessage(Mt.arrowButtonDownAriaLabel),onClick:o}),(0,ae.jsx)(u().A,{icon:xt().arrowStraightUpFillSmallIcon,iconStyle:m.searchMatchArrowIcon,style:m.searchMatchArrowButton,ariaLabel:p.formatMessage(Mt.arrowButtonUpAriaLabel),onClick:a})]}):void 0]})}),[d,n,s.length,p,m,o,a]);return(0,ae.jsx)(Q().Ay,{focusInitial:!0,itemMarginLeft:0,itemMarginRight:0,onChange:e=>{t.setState(e.target.value.trim())},onKeyDown:g,placeholder:p.formatMessage(Mt.filterPropertiesInputPlaceholder),showClearButton:!0,value:d,inputLeft:(0,ae.jsx)(I().I,{icon:H().magnifyingGlassSmallIcon,size:"xxs",colorVariant:"secondary"}),inputOuterStyle:m.searchInputOuter,inputRightStyle:m.searchMatchCount,inputRight:y})}function jt(e){const{module:t}=e,{layoutStore:n}=(0,Z().LH)(),{collectionStore:s,pageStore:o}=(0,Z().bi)(),a=(0,me().$)(),u=(0,r().K8)((()=>n.getModules()),[n]),p=(0,r().K8)((()=>s.getSchema()),[s]),g=(0,r().K8)((()=>(0,P().L)(s.getFormat(),p,void 0,_().jf.Collection)),[s,p]),m=(0,i.useMemo)((()=>new Set((0,fe().q)({modulesByArea:u,collectionSchema:p,collectionFormat:g}))),[g,u,p]),f=(0,i.useMemo)((()=>new(ye().YB)),[]),h=(0,r().K8)((()=>s.getNormalizedPropertyGroups()),[s]),b=(0,i.useMemo)((()=>{const e={};return null==h||h.forEach(((t,n)=>{e[t.id]=n})),e}),[h]),S=(0,he().z7)({store:o,format:g,schema:p,collectionStore:s}),x=(0,i.useMemo)((()=>{const e={};return S.forEach((t=>e[t.property]=t)),e}),[S]),{searchInputValueStore:M,searchMatches:A,searchMatchesMap:j,activeSearchMatchIndex:w,moveToNextSearchMatch:I,moveToPreviousSearchMatch:k}=je({mergedPropertiesMap:x,propertyGroups:h,propertyIdsToExclude:m,scrollerContext:a}),T=(0,i.useCallback)((({propertyId:e})=>{if(m.has(e))return null;const n=void 0!==j[e]&&null!==w?{active:e===A[w]}:void 0;return(0,ae.jsx)(yt,{propertyId:e,propertyFormat:x[e],collectionStore:s,pagePropertiesStore:f,pageStore:o,searchHighlighted:n,layoutModule:t})}),[w,s,x,t,f,o,m,A,j]),C=(0,i.useCallback)((({groupId:e,groupTitle:t})=>{const n=b[e],i=0===n,s=(0,y().O9)(h)&&n===h.length-1,o={container:i?void 0:{marginTop:20}};return(0,ae.jsx)(He,{title:t,propertyGroupId:e,isFirstPropertyGroup:i,isLastPropertyGroup:s,styles:o})}),[b,h]),B=(0,i.useCallback)((e=>(0,ae.jsx)(ke,{propertyGroupId:e,pagePropertiesStore:f})),[f]),R=Boolean(S.length&&S.length>m.size),D=(0,l().IS)((()=>({addPropertyButtonContainer:{marginInlineStart:2,paddingBottom:8},container:{marginTop:R?4:8,height:"100%",overflow:"visible hidden",marginInlineStart:-rn,width:`calc(100% + ${2*rn}px)`},searchInputContainer:{marginInlineEnd:rn,marginInlineStart:rn,flexShrink:0,paddingTop:2,overflow:"visible",marginBottom:14,paddingInlineStart:6,paddingInlineEnd:6},listContainer:{padding:`0 ${rn}px 56px`}})),[R]);return(0,ae.jsxs)(c().wt,{style:D.container,children:[R?(0,ae.jsx)("div",{style:D.searchInputContainer,children:(0,ae.jsx)(At,{searchInputValueStore:M,activeSearchMatchIndex:w,searchMatches:A,moveToNextSearchMatch:I,moveToPreviousSearchMatch:k})}):void 0,(0,ae.jsx)(v().H,{type:d().A.Y,style:D.listContainer,children:Boolean(h)?(0,ae.jsx)(st,{renderPropertyRow:T,renderPropertyGroupRow:C,renderAddPropertyButton:B}):(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsx)(it,{collectionFormat:g,mergedProperties:S,renderPropertyRow:T}),(0,ae.jsx)("div",{style:D.addPropertyButtonContainer,children:(0,ae.jsx)(ke,{pagePropertiesStore:f})})]})})]})}var wt=()=>n(621837),It=()=>n(115512);const kt=(0,f().YK)({addSection:{id:"NewCollectionPropertyGroupButton.label",defaultMessage:"Add section"},newSection:{id:"NewCollectionPropertyGroupButton.newItemName",defaultMessage:"New section"}});function Tt(){const{collectionStore:e}=(0,Z().bi)(),t=(0,a().v3)(),n=(0,f().tz)(),s=(0,l().IS)((()=>({button:{fontSize:It().Kw,padding:8,fontWeight:D().Wy.medium}})),[]),o=(0,i.useCallback)((()=>{const i=n.formatMessage(kt.newSection),{performResult:s}=U().createAndCommit({environment:t,perform:t=>(0,qe().PA)({collectionStore:e,newGroupTitle:i,transaction:t}),canUndo:!0,userAction:"ConfigurePropertyExplorerModule.onDrop"});s&&Ge.setState({forceOpenRenameInputForGroupId:s})}),[e,t,n]);return(0,ae.jsx)(Le().p,{colorPalette:"gray",iconLeading:{icon:wt().plusFillSmallIcon,size:"xs"},onClick:o,style:s.button,children:(0,ae.jsx)(f().sA,{...kt.addSection})})}function Ct(e){const{title:t}=e;return(0,ae.jsxs)(c().Ye,{justifyContent:"space-between",children:[t,(0,ae.jsx)(Tt,{})]})}var _t=()=>n(59400),Pt=()=>n(339798),Bt=()=>n(447453),Rt=()=>n(527438);function Dt(e){return(0,ae.jsx)("div",{style:{marginInlineStart:-8,marginInlineEnd:-8},children:e.children})}function Lt({module:e}){const{collectionStore:t}=(0,Z().bi)(),n=(0,Y().ET)(),s=(0,r().K8)((()=>t.getSchema()),[t]),o=(0,r().K8)((()=>{if((0,oe().gx)(e))return e}),[e]),a=(0,r().K8)((()=>o&&s[o.propertyId]),[o,s]);if((0,i.useEffect)((()=>{if(o)return(0,Bt().O)({collectionContextStore:n,collectionSettingsStore:n.settingsStore,closeOnEscape:!1}),Pt().dP({collectionSettingsStore:n.settingsStore,item:{type:"property",property:o.propertyId,formatKey:void 0}}),()=>{Pt().os({collectionSettingsStore:n.settingsStore})}}),[n,o]),!a||!o)return null;const l=(0,ae.jsx)("span",{style:{fontSize:16,lineHeight:"24px",fontWeight:D().Wy.medium},children:$().dC[a.type]});return(0,ae.jsx)(Dt,{children:(0,ae.jsx)(_t().m$,{collectionContextStore:n,collectionSettingsStore:n.settingsStore,context:Rt().Bd.ViewSettings,collectionSettingsPropertyTitleOverride:l,fullHeight:!0})})}n(672577);var Et=()=>n(487929);function Ot({module:e}){const{collectionStore:t,pageStore:n}=(0,Z().bi)(),i=(0,l().IS)((()=>({configureContainer:{display:"flex",flexDirection:"column",justifyContent:"flex-start",gap:12,marginTop:16},configureDescription:{fontSize:D().J.UISmall.desktop,fontWeight:D().Wy.regular,color:h().Tj.text.secondary,marginInlineStart:8}})),[]);return(0,ae.jsxs)("div",{style:i.configureContainer,children:[(0,ae.jsx)("div",{style:i.configureDescription,children:(0,ae.jsx)(f().sA,{defaultMessage:"Relations can be shown as either minimal or responsive page sections",id:"pageLayout.ConfigureRelationsGroupModule.moduleDescription"})}),(0,ae.jsx)(Nt,{layoutModule:e,pageStore:n,collectionStore:t})]})}function Nt({collectionStore:e,pageStore:t,layoutModule:n}){const s=(0,a().v3)(),o=(0,i.useMemo)((()=>new(ye().YB)),[]),l=(0,r().K8)((()=>{const t=e.getSchema(),n=e.getFormat();return(0,Et().T)({format:n,schema:t,visibilityLevels:["inline","minimal"]})}),[e]),d=l.map((e=>e.section)),c=(0,i.useCallback)((t=>{if(!l)return;const n=t.map((e=>{const t=l.find((t=>t.section===e));if(!t)throw Error("collection does not have a section corresponding to one of the dropped keys");return t}));U().createAndCommit({userAction:"ConfigureRelationsGroupModule.onDraggablePageSectionsDrop",environment:s,canUndo:!0,perform:t=>{L().LK({environment:s,pageSectionFormats:n,store:e,transaction:t})}})}),[l,e,s]);return l.length?(0,ae.jsx)(Qe().Ay,{direction:"vertical",keys:d,renderKey:i=>(0,ae.jsx)(ht,{pageStore:t,collectionStore:e,propertyId:i,pagePropertiesStore:o,layoutModule:n,draggable:!0}),onDrop:e=>c(e)}):null}var Ft=()=>n(230979),Ut=()=>n(68207),zt=()=>n(410730),Kt=()=>n(447934),Vt=()=>n(33218);function qt(e){const{environment:t,layoutModule:n,collectionStore:i,layoutStore:s,propertyId:o}=e,a=i.getSchema(),r=s.getModel(),l=null==r?void 0:r.getPageModuleAreaById(n.id);if(!l||!r||"normalizedTitleWithIcon"!==n.type)return;const{pinnedPropertyIds:d}=function(e,t,n){let i,s=[...t??[]];return s.includes(e)?(s=s.filter((t=>t!==e)),i=!1):(s.push(e),s.length>zt().U&&(s=(0,se().Vl)(s,n)),i=!0),{isNowPinned:i,pinnedPropertyIds:s}}(o,n.propertyIds,a),c={...n,propertyIds:d};U().createAndCommit({environment:t,perform(e){(0,Kt().HD)({environment:t,transaction:e,property:o,layoutStore:s}),(0,Vt().UQ)({environment:t,transaction:e,layoutStore:s,position:{area:l,moduleId:n.id},updatedModule:c})},canUndo:!0,userAction:"titleWithIconActions.togglePinnedProperty"})}var Wt=()=>n(557198);function Gt({module:e}){const{collectionStore:t,pageStore:n}=(0,Z().bi)(),s=(0,a().v3)(),{layoutStore:o}=(0,Z().LH)(),d=(0,me().$)(),u=(0,r().K8)((()=>t.getSchema()),[t]),g=(0,r().K8)((()=>(0,P().L)(t.getFormat(),u,void 0,_().jf.Collection)),[t,u]),m=(0,i.useMemo)((()=>new(ye().YB)),[]),v=(0,i.useMemo)((()=>"normalizedTitleWithIcon"!==e.type?[]:(0,se().Vl)(e.propertyIds,u)),[e,u]),b=(0,i.useMemo)((()=>new Set(v)),[v]),S=(0,r().K8)((()=>{var e;return null===(e=g.property_visibility||[])||void 0===e?void 0:e.map((e=>e.property)).filter((e=>!(0,W().NM)(e)&&!b.has(e)))}),[g.property_visibility,b]),x=(0,y().uv)(u),M=(0,he().z7)({store:n,format:g,schema:u,collectionStore:t,propertyIds:x}),A=(0,i.useMemo)((()=>{const e={};for(const t of M)e[t.property]=t;return e}),[M]),{searchInputValueStore:j,searchMatches:w,activeSearchMatchIndex:I,moveToNextSearchMatch:C,moveToPreviousSearchMatch:B,searchMatchesMap:R}=je({mergedPropertiesMap:A,propertyGroups:void 0,propertyIdsToExclude:void 0,scrollerContext:d}),L=function(e){const t=(0,a().v3)(),{layoutStore:n}=(0,Z().LH)();return(0,i.useCallback)((i=>{const s=n.getModel(),o=null==s?void 0:s.getPageModuleAreaById(e.id);if(!o||!s)return;const a={...e,propertyIds:i};U().createAndCommit({environment:t,perform(i){(0,Vt().UQ)({environment:t,transaction:i,layoutStore:n,position:{area:o,moduleId:e.id},updatedModule:a})},canUndo:!0,userAction:"ConfigureTitleAndIconModule.handlePinnedPropertyReorderDrop"})}),[t,e,n])}(e),E=(0,l().IS)((()=>{const e={fontSize:D().J.UISmall.desktop,lineHeight:"24px",color:h().Tj.text.secondary,fontWeight:500};return{container:{height:"100%",overflow:"visible hidden",gap:14,marginInlineStart:-rn,width:`calc(100% + ${2*rn}px)`},propertySearchInputContainer:{flexShrink:0,margin:`10px ${rn+6}px 0`},scrollableContainer:{padding:`0 ${rn}px 56px`,flexGrow:1,overflow:"hidden auto"},pinnedPropertiesLabel:{...e,marginInlineStart:8},optionsContainer:{marginTop:24},optionsLabel:{...e,marginInlineStart:6,marginBottom:6},switcherButton:{marginInlineEnd:0},addPropertyButton:{color:h().Tj.text.secondary,height:34},addPropertyButtonIcon:{color:h().Tj.text.secondary}}}),[]),O=v.length?(0,ae.jsx)(Qe().Ay,{keys:v,onDrop:L,direction:"vertical",renderKey:t=>(0,ae.jsx)(Yt,{layoutModule:e,propertyId:t,isPinned:!0,draggable:!0,pinButtonDisabled:!1,pagePropertiesStore:m,searchHighlighted:null!==I&&void 0!==R[t]?{active:t===w[I]}:void 0})}):null,N=v.length>=zt().U,z=S.map((t=>(0,ae.jsx)(Yt,{layoutModule:e,propertyId:t,isPinned:!1,draggable:!1,pinButtonDisabled:N,pagePropertiesStore:m,searchHighlighted:null!==I&&void 0!==R[t]?{active:t===w[I]}:void 0},t))),K=Ht(e),V=(e={})=>(0,ae.jsx)(we().X,{...e,style:E.addPropertyButton,iconStyle:E.addPropertyButtonIcon,collectionStore:t,isInPeekRenderer:!1,pagePropertiesStore:m,onPropertyAdded:K,disabled:N}),{backlinksVisibility:q,updateBacklinksVisibility:G}=(0,Wt().Ap)({store:t,format:g}),H=(0,f().tz)(),Y=(0,i.useCallback)((()=>{const t="show"===e.propertyLabels||!e.propertyLabels;U().createAndCommit({environment:s,perform(n){var i;const a=null===(i=o.getModel())||void 0===i?void 0:i.getPageModuleAreaById(e.id);a&&(0,Vt().UQ)({environment:s,transaction:n,layoutStore:o,position:{area:a,moduleId:e.id},updatedModule:{...e,propertyLabels:t?"hide":"show"}})},canUndo:!0,userAction:"ConfigureTitleAndIconModule.handleShowPropertyLabels"})}),[e,s,o]),$=(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsx)("div",{style:{...E.pinnedPropertiesLabel},children:(0,ae.jsx)(f().sA,{...$t.pinnedPropertiesLabel})}),O,(0,ae.jsx)("div",{style:{marginInlineStart:2},children:N?(0,ae.jsx)(p().m,{placement:"left",render:e=>V(e),renderTooltip:()=>H.formatMessage($t.maxPinnedPropertiesAddPropertyTooltip,{br:(0,ae.jsx)("br",{})})}):V()}),z.length>0?(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsx)("div",{style:{...E.pinnedPropertiesLabel,marginTop:24},children:(0,ae.jsx)(f().sA,{...$t.unpinnedPropertiesLabel})}),z]}):void 0]});return(0,ae.jsxs)(c().wt,{style:E.container,children:[(0,ae.jsx)("div",{style:E.propertySearchInputContainer,children:(0,ae.jsx)(At,{activeSearchMatchIndex:I,searchMatches:w,moveToNextSearchMatch:C,moveToPreviousSearchMatch:B,searchInputValueStore:j})}),(0,ae.jsxs)("div",{style:E.scrollableContainer,children:[$,(0,ae.jsxs)("div",{style:E.optionsContainer,children:[(0,ae.jsx)("div",{style:E.optionsLabel,children:(0,ae.jsx)(f().sA,{...$t.optionsLabel})}),(0,ae.jsx)(T().Ay,{title:(0,ae.jsx)(f().sA,{id:"PageLayoutConfigurationSidebar.showPropertyLabels",defaultMessage:"Property labels"}),onClick:Y,right:(0,ae.jsx)(k().A,{on:"show"===e.propertyLabels||void 0===e.propertyLabels}),rightStyle:E.switcherButton}),(0,ae.jsx)(T().Ay,{right:(0,ae.jsx)(F().p7,{currentVisibility:q,onSelect:G}),rightStyle:E.switcherButton,title:(0,ae.jsx)(f().sA,{...$t.showBacklinksOption})})]})]})]})}function Ht(e){const{layoutStore:t}=(0,Z().LH)(),{collectionStore:n}=(0,Z().bi)(),s=(0,a().v3)();return(0,i.useCallback)((i=>{qt({environment:s,layoutModule:e,collectionStore:n,layoutStore:t,propertyId:i})}),[s,e,n,t])}function Yt({layoutModule:e,propertyId:t,isPinned:n,pinButtonDisabled:i,...s}){const o=(0,f().tz)(),{collectionStore:a,pageStore:l}=(0,Z().bi)(),d=(0,r().K8)((()=>a.getSchema()),[a])[t],c=Ht(e);if(!d)return null;const g=(e={})=>(0,ae.jsx)(u().A,{...e,disabled:i,ariaLabel:n?o.formatMessage($t.toggleUnpinnedAriaLabel,{propertyName:d.name}):o.formatMessage($t.togglePinnedAriaLabel,{propertyName:d.name}),icon:n?Ut().S:Ft().N,iconStyle:{fill:h().Tj.icon.primary},onClick:()=>c(t)});return(0,ae.jsx)(ht,{pageStore:l,collectionStore:a,propertyId:t,layoutModule:e,rightButton:()=>i?(0,ae.jsx)(p().m,{placement:"left",render:e=>g(e),renderTooltip:()=>o.formatMessage($t.maxPinnedPropertiesTooltip,{br:(0,ae.jsx)("br",{})})}):g(),...s})}const $t=(0,f().YK)({togglePinnedAriaLabel:{id:"pageLayout.configurePinnedProperties.togglePinnedAriaLabel",defaultMessage:"Show {propertyName} as pinned"},toggleUnpinnedAriaLabel:{id:"pageLayout.configurePinnedProperties.toggleUnpinnedAriaLabel",defaultMessage:"Do not show {propertyName} as pinned"},pinnedPropertiesLabel:{id:"pageLayout.configurePinnedProperties.pinnedPropertiesLabel",defaultMessage:"Pinned properties"},unpinnedPropertiesLabel:{id:"pageLayout.configurePinnedProperties.unpinnedPropertiesLabel",defaultMessage:"Unpinned properties"},maxPinnedPropertiesTooltip:{id:"pageLayout.configurePinnedProperties.maxPinnedPropertiesTooltip",defaultMessage:"Maximum number of pinned properties reached. {br} Unpin a property to pin another."},maxPinnedPropertiesAddPropertyTooltip:{id:"pageLayout.configurePinnedProperties.maxPinnedPropertiesAddPropertyTooltip",defaultMessage:"Maximum number of pinned properties reached. {br} Unpin a property to create a new pinned property."},optionsLabel:{id:"pageLayout.configurePinnedProperties.optionsLabel",defaultMessage:"Options"},showBacklinksOption:{id:"pageLayout.configurePinnedProperties.showBacklinksOption",defaultMessage:"Backlinks"}});var Qt=()=>n(180762);const Zt=i.memo((function({module:e}){const{moduleStateByIdStore:t}=(0,Z().bi)(),i=(0,r().K8)((()=>{var n;return null===(n=t.get(e.id))||void 0===n?void 0:n.collectionContextStore}),[t,e.id]),s=(0,r().K8)((()=>{var e;return null==i||null===(e=i.collectionViewStore())||void 0===e?void 0:e.id}),[i]),o=(0,r().K8)((()=>null==i?void 0:i.settingsStore),[i]),a=(0,l().IS)((()=>({titleWrapper:{...nn,marginBottom:6,display:"flex"},viewsContainer:{marginTop:8,width:"100%",display:"flex",flexDirection:"column"}})),[]),d=(0,r().K8)((()=>{var e;return null==i||null===(e=i.settingsStore)||void 0===e?void 0:e.getState().open}),[i]);return"viewsMain"===e.type&&i&&o&&d?(0,ae.jsx)(Dt,{children:(0,ae.jsx)(Y().p2.Provider,{value:i,children:(0,ae.jsx)(_t().m$,{collectionContextStore:i,collectionSettingsStore:o,context:Rt().Bd.ViewSettings})})}):(0,ae.jsxs)("div",{children:[(0,ae.jsx)("div",{style:a.titleWrapper,children:(0,ae.jsx)(f().sA,{...ge().s.viewsMain})}),(0,ae.jsxs)("div",{style:a.viewsContainer,children:[(0,ae.jsx)(Xt,{collectionContextStore:i,currentViewId:s,module:e}),"viewsMain"===e.type?(0,ae.jsx)(n(965731).ConfigureViewsMainModuleAddViewButton,{renderOrigin:e=>(0,ae.jsx)(Le().p,{iconLeading:n(617668).plusIcon,colorPalette:"gray",...e,children:(0,ae.jsx)(f().sA,{defaultMessage:"New view",id:"database.viewSettings.createViewTab.newView"})})}):void 0]})]})}));function Xt({collectionContextStore:e,currentViewId:t,module:i}){const s=(0,a().v3)(),o=(0,r().K8)((()=>{if(!e)return[];const t=e.collectionViewBlockStore(),n=null==t?void 0:t.getCollectionViewStores();return null==n?void 0:n.map((e=>{var t;return{id:e.id,icon:null===(t=e.getFormat())||void 0===t?void 0:t.collection_view_icon,type:e.getType(),name:e.getName(),pointer:e.pointer}}))}),[e]);return"editor"===i.type?(0,ae.jsx)(Le().p,{children:(0,ae.jsx)("div",{style:{fontWeight:600},children:(0,ae.jsx)(f().sA,{...ge().s.editor})})},"editor"):o&&e?(0,ae.jsx)(ae.Fragment,{children:o.map((i=>(0,ae.jsxs)(Le().p,{onClick:()=>{(0,Qt().t)({environment:s,collectionContextStore:e,collectionViewId:i.id,isFullScreen:!1,isRootChild:!1,isInPeekRenderer:!1}),(0,Bt().O)({collectionContextStore:e,collectionSettingsStore:e.settingsStore})},children:[(0,ae.jsx)(n(745266).h,{viewIcon:i.icon,viewType:i.type,color:"regular",style:{width:14,height:14,marginInlineEnd:6}}),(0,ae.jsx)("div",{style:{fontWeight:i.id===t?600:void 0},children:void 0!==i.type?(0,n(999140).OO)({collectionViewName:i.name,collectionViewType:i.type}):(0,ae.jsx)(f().sA,{...Jt.newView})})]},i.id)))}):null}const Jt=(0,f().YK)({newView:{defaultMessage:"New view",id:"database.viewSettings.createViewTab.newView"}});function en({module:e}){const{moduleStateByIdStore:t}=(0,Z().bi)(),n=(0,r().K8)((()=>{var n;return null===(n=t.get(e.id))||void 0===n?void 0:n.collectionContextStore}),[t,e.id]),i=(0,r().K8)((()=>null==n?void 0:n.settingsStore),[n]);return e&&n&&i?(0,ae.jsx)(Dt,{children:(0,ae.jsx)(Y().p2.Provider,{value:n,children:(0,ae.jsx)(_t().m$,{collectionContextStore:n,collectionSettingsStore:i,context:Rt().Bd.ViewSettings})})}):null}function tn({moduleId:e}){const{layoutStore:t}=(0,Z().LH)(),n=(0,r().K8)((()=>t.getModuleById(e)),[t,e]),i=(0,l().IS)((()=>({container:{display:"flex",flexDirection:"column",..."properties"!==(null==n?void 0:n.type)&&"normalizedTitleWithIcon"!==(null==n?void 0:n.type)?{paddingBottom:80}:{height:"100%"}}})),[null==n?void 0:n.type]);return n?(0,ae.jsxs)("div",{style:i.container,children:[(s=n,"viewsMain"===s.type||"editor"===s.type||(0,oe().gx)(s)?void 0:(0,ae.jsx)(sn,{module:n})),(0,ae.jsx)(on,{module:n})]}):null;var s}const nn={fontWeight:D().Wy.medium,marginBottom:0,marginInlineStart:6,fontSize:16,lineHeight:"24px"};function sn(e){const{module:t}=e,n=(0,ae.jsx)("div",{style:nn,children:(0,ae.jsx)(f().sA,{...ge().s[t.type]})});return"properties"===t.type?(0,ae.jsx)(Ct,{title:n}):n}function on(e){const{module:t}=e;if((0,oe().gx)(t))return(0,ae.jsx)(Lt,{module:t});const{type:n}=t;switch(n){case"properties":return(0,ae.jsx)(jt,{module:t});case"normalizedTitleWithIcon":return(0,ae.jsx)(Gt,{module:t});case"relationsGroup":return(0,ae.jsx)(Ot,{module:t});case"views":return(0,ae.jsx)(en,{module:t});case"viewsMain":case"editor":return(0,ae.jsx)(Zt,{module:t});case"deleted_property":case"cover":case"inlinePageSections":case"expandedBacklinks":case"discussions":case"bottomControls":case"transcript":case"formQuestion":case"formTitle":case"formSubmit":case"placeholder":case"recentActivity":case"collaborators":case"teamspaces":case"theirPages":case"row":case"view":return null;default:(0,y().HB)(n)}return null}const an=290,rn=16;function ln(){const{currentModuleSelection:e,layoutStore:t,sessionId:n}=(0,Z().LH)(),{collectionStore:i,pageStore:s}=(0,Z().bi)(),o=(0,r().K8)((()=>{const e=i.getFormat(),t=i.getSchema();return(0,P().L)(e,t,void 0,_().jf.Collection)}),[i]),a=(0,l().IS)((()=>({container:{padding:`8px ${rn}px ${"existing_module"===(null==e?void 0:e.type)?"0":"24px"}`,minWidth:an,width:an,maxWidth:an},title:{fontSize:16,lineHeight:"24px",fontWeight:D().Wy.medium,marginTop:0,marginInlineEnd:8,marginBottom:0,marginInlineStart:8},label:{fontSize:D().J.UISmall.desktop,fontWeight:D().Wy.medium,marginTop:24,marginInlineEnd:8,marginBottom:6,marginInlineStart:8,color:h().Tj.text.secondary},switcherButton:{marginInlineEnd:0}})),[e]),c=(0,r().K8)((()=>Boolean(i.getFormat().external_object_id)),[i]),u=(0,r().K8)((()=>{var n;if(e&&"existing_module"===e.type)return null===(n=t.getModuleById(e.moduleId))||void 0===n?void 0:n.type}),[e,t]),p=void 0!==u&&R().PF.includes(u);return!e||p?(0,ae.jsxs)("div",{style:a.container,children:[(0,ae.jsx)("div",{style:a.title,children:(0,ae.jsx)(f().sA,{id:"PageLayoutConfigurationSidebar.title",defaultMessage:"Page settings"})}),(0,ae.jsx)(dn,{collectionStore:i,layoutStore:t,sessionId:n,styles:a}),(0,ae.jsx)("div",{style:a.label,children:(0,ae.jsx)(f().sA,{id:"PageLayoutConfigurationSidebar.options",defaultMessage:"Options"})}),(0,ae.jsx)(cn,{disabled:c,collectionStore:i,normalizedCollectionFormat:o,styles:a}),(0,ae.jsx)(N().q8,{locked:c,store:i,format:o,shouldShowIconAndMargin:!1}),(0,ae.jsx)(un,{layoutStore:t,styles:a}),(0,ae.jsx)(pn,{pageStore:s,layoutStore:t,styles:a})]}):(0,ae.jsxs)(v().H,{type:d().A.Y,style:a.container,children:["existing_module"===e.type?(0,ae.jsx)(tn,{moduleId:e.moduleId}):void 0,"new_module"===e.type?(0,ae.jsx)(pe,{}):void 0]})}function dn(e){const{collectionStore:t,layoutStore:n,sessionId:s,styles:o}=e,l=(0,a().v3)(),d=(0,r().K8)((()=>n.isTabbedPageLayout()),[n]),{value:c}=(0,w().fJ)(z.switchFromSimpleToTabbedLayoutActions),{value:u}=(0,w().fJ)(z.switchFromTabbedToSimpleLayoutActions),p=!c||!u,g=d?"tabbed":"simple",m=(0,i.useMemo)((()=>({available:["simple","tabbed"],appearance:{simple:{label:(0,ae.jsx)(f().sA,{id:"PageLayoutConfigurationSidebar.structure.simple",defaultMessage:"Simple"}),image:{src:C().A.images.layouts.configuration.simplePageLayoutStructurePng,width:112,height:80}},tabbed:{label:(0,ae.jsx)(f().sA,{id:"PageLayoutConfigurationSidebar.structure.tabbed",defaultMessage:"Tabbed"}),image:{src:C().A.images.layouts.configuration.tabbedPageLayoutStructurePng,width:112,height:80}}}})),[]),h=(0,i.useCallback)((async e=>{c&&u&&("simple"===e?u.switchFromTabbedToSimpleLayout({environment:l,layoutStore:n}):"tabbed"===e?await c.switchFromSimpleToTabbedLayout({environment:l,layoutStore:n}):(0,y().HB)(e),(0,S().GF)({environment:l,layoutId:n.id,collectionId:t.id,sessionId:s,structure:e}))}),[c,u,l,n,t.id,s]);return(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsx)("div",{style:o.label,children:(0,ae.jsx)(f().sA,{id:"PageLayoutConfigurationSidebar.structure",defaultMessage:"Structure"})}),(0,ae.jsx)(O().A,{disabled:p,options:m,selectedOption:g,onOptionSelected:h,height:"tall"})]})}function cn(e){var t;const n=(0,a().v3)(),{disabled:s,collectionStore:o,normalizedCollectionFormat:r,styles:l}=e,d="minimal"===(null===(t=r.page_section_visibility)||void 0===t?void 0:t.margin_comments)?"minimal":"inline",c=(0,i.useCallback)((e=>{const t=o.getFormat(),i=o.getSchema(),s=(0,P().L)(t,i,void 0,_().jf.Collection);L().OD({environment:n,pageSection:"margin_comments",visibility:e,store:o,format:s})}),[o,n]);return(0,ae.jsx)(T().Ay,{title:(0,ae.jsx)(f().sA,{id:"PageLayoutConfigurationSidebar.inlineComments",defaultMessage:"Inline comments"}),right:(0,ae.jsx)(F().J8,{disabled:s,currentVisibility:d,onSelect:c}),rightStyle:l.switcherButton})}function un(e){const{layoutStore:t,styles:n}=e,s=(0,a().v3)(),o=(0,r().K8)((()=>{var e;return"show"===((null===(e=t.getFormat())||void 0===e?void 0:e.property_icons_visibility)??"show")}),[t]),l=(0,i.useCallback)((()=>{U().createAndCommit({environment:s,userAction:"pageLayoutActions.handleShowPropertyIcons",canUndo:!0,perform:e=>{var n;E().zA({stores:[t],update:{property_icons_visibility:"hide"===(null===(n=t.getFormat())||void 0===n?void 0:n.property_icons_visibility)?"show":"hide"},transaction:e})}})}),[t,s]);return(0,ae.jsx)(T().Ay,{title:(0,ae.jsx)("label",{htmlFor:"show-property-icons-toggle",style:{cursor:"pointer"},children:(0,ae.jsx)(f().sA,{id:"PageLayoutConfigurationSidebar.showPropertyIcons",defaultMessage:"Property icons"})}),right:(0,ae.jsx)(k().A,{on:o,onClick:l,inputId:"show-property-icons-toggle"}),rightStyle:n.switcherButton})}function pn(e){const{pageStore:t,layoutStore:n,styles:s}=e,o=(0,a().v3)(),d=(0,r().K8)((()=>{var e;return null===(e=n.getFormat())||void 0===e?void 0:e.page_full_width}),[n]),c=(0,i.useCallback)((()=>{U().createAndCommit({environment:o,userAction:"pageLayoutActions.handleShowFullWidth",canUndo:!0,perform:e=>{var i;const s=!(null!==(i=n.getFormat())&&void 0!==i&&i.page_full_width);E().zA({stores:[n],update:{page_full_width:s},transaction:e}),void 0!==t.getFormatStore().getKeyValue("page_full_width")&&E().zA({stores:[t],update:{page_full_width:void 0},transaction:e})}})}),[n,o,t]),u=(0,l().IS)((()=>({title:{display:"flex",alignItems:"center",gap:"4px",cursor:"pointer"},tooltip:{maxWidth:240,width:"max-content",overflowWrap:"break-word",textWrap:"wrap"}})),[]);return(0,ae.jsx)(T().Ay,{title:(0,ae.jsxs)("label",{style:u.title,htmlFor:"page-full-width-toggle",children:[(0,ae.jsx)(f().sA,{id:"PageLayoutConfigurationSidebar.showFullWidth",defaultMessage:"Full width"}),(0,ae.jsx)(p().m,{placement:"bottom",renderTooltip:()=>(0,ae.jsx)(f().sA,{id:"PageLayoutConfigurationSidebar.showFullWidth.tooltip",defaultMessage:"Page width can be overwritten on individual pages."}),render:e=>(0,ae.jsx)(I().I,{...e,icon:B().infoCircleSmallIcon,size:"sm",colorVariant:"secondary"}),style:u.tooltip})]}),right:(0,ae.jsx)(k().A,{on:Boolean(d),onClick:c,inputId:"page-full-width-toggle"}),rightStyle:s.switcherButton})}var gn=()=>n(460713),mn=()=>n(607810),fn=()=>n(817942),hn=()=>n(852832),yn=()=>n(475140),vn=()=>n(179034),bn=()=>n(507807),Sn=()=>n(295633);var xn=()=>n(792071),Mn=()=>n(763824),An=()=>n(414360);async function jn(e){const{environment:t,layoutStore:n,blockPointer:i}=e,s=Sn().B.createChildStore(n,i);if(await s.load(),!s.isCollectionView())return;const o=s.getCollectionViewStores();await(0,Mn().lX)(o,25,(e=>e.load()));const a=o.filter((e=>"page"===e.getType()));if(a.length<=1)return;const r=n.getModules(),l=(0,yn().JO)(r,oe().gp);if(!l||"views_main_tab_modules"!==l.area)return;const d=l.viewId,c=a.find((e=>{var t;const n=null===(t=e.getFormat())||void 0===t?void 0:t.page_layout_pointer;return!!n&&n.views_main_tab_id===d}));if(!c)return;const u=a.filter((e=>e!==c));0!==u.length&&U().createAndCommit({environment:t,userAction:"cleanupDuplicateContentTabsInTabbedCollectionViewBlock",canUndo:!1,perform:e=>{for(const o of u){var t,i;const a=null===(t=o.getFormat())||void 0===t||null===(t=t.page_layout_pointer)||void 0===t?void 0:t.views_main_tab_id;if((0,An().T)({collectionViewBlockStore:s,collectionViewStore:o,transaction:e}),!a)continue;const r=(null===(i=n.getRawModules())||void 0===i||null===(i=i.views_main_tab_modules)||void 0===i?void 0:i[a])||[];for(const t of r.reverse())U().applyOperation({store:n,transaction:e,operation:xn().N4X.putModuleBeforeOrAfter({pointer:n.pointer,area:"views_main_tab_modules",viewId:d,module:t,direction:"before",beforeOrAfterId:void 0})});U().applyOperation({store:n,transaction:e,operation:xn().N4X.deleteViewTabModulesTab({pointer:n.pointer,viewId:a})})}}})}async function wn(e){const{environment:t,layoutStore:i}=e;await async function(e){const{environment:t,layoutStore:n}=e;if(!n.isTabbedPageLayout())return;const i=n.getBlockChildrenPointers();for(const o of i){var s;null!==(s=n.getModel())&&void 0!==s&&s.isTabbedLayoutCollectionViewBlockPointer(o)&&await jn({environment:t,layoutStore:n,blockPointer:o})}}({environment:t,layoutStore:i}),(0,n(210748).O)({environment:t,layoutStore:i})}const In=i.memo((function({children:e,collectionStore:t,pageStore:s,sessionId:o,layoutBuilderModuleSelectionStore:l}){const d=(0,a().v3)(),c=(0,r().K8)((()=>{var e;return null===(e=n(907258).default.state.currentUserStore)||void 0===e?void 0:e.userId}),[]),u=(0,r().K8)((()=>t.getSpaceId()),[t]),p=(0,i.useMemo)((()=>(null==s?void 0:s.id)??(0,n(594794).Z1)({environment:d,table:vn().ev,spaceId:u})),[d,null==s?void 0:s.id,u]),g=(0,i.useCallback)((e=>{var t;if(e.operation.pointer.id===p)return!1;if((null===(t=e.operation)||void 0===t||null===(t=t.args)||void 0===t?void 0:t.parent_id)===p)throw new Error("Unexpected operation on temporary page.");return!0}),[p]),m=(0,bn().S)(n(342).oB,{canUndo:!1,shouldPersistOperation:s?void 0:g}),f=(0,r().K8)((()=>{if(s)return s.clone(m.cache);return U().createAndCommit({environment:d,perform(e){const i=n(384944).Wv({environment:d,type:"page",id:p,inMemoryRecordCache:m.cache,transaction:e});return U().applyOperation({store:i,operation:n(134025).op.update({pointer:{id:i.pointer.id,table:vn().ev,spaceId:i.pointer.spaceId},path:[],args:{parent_id:t.id,parent_table:t.table,alive:!0}}),transaction:e}),i},userAction:"PageLayoutEditorContext.createEmptyPageStore",canUndo:!1}).performResult}),[t,m.cache,d,s,p]),h=function(e,t){const s=(0,a().v3)(),o=(0,i.useMemo)((()=>new(n(512039).B)(s)),[s]),l=(0,bn().f)(e,t),d=(0,r().K8)((()=>null==t?void 0:t.getParentBlockStore()),[t]);return(0,i.useEffect)((()=>{o.setContext({type:"collectionPage",collectionViewBlockStore:d,collectionStore:l})}),[o,l,d]),o}(m,t),{unpersistedCollectionStore:v,unpersistedLayoutStore:b,modulesByArea:S}=(0,r().K8)((()=>{const e=h.collectionStore(),t=null==e?void 0:e.getLayoutStore();return{unpersistedCollectionStore:e,unpersistedLayoutStore:t,modulesByArea:null==t?void 0:t.getModules()}}),[h]),[x,M]=(0,i.useState)(void 0);(0,n(543906).A)((()=>{M((0,Ve().mg)(S))}),Boolean(S));const A=(0,r().uB)(void 0,n(731120).A),j=i.useRef(!1);(0,r().K8)((()=>!(!c||!v||b&&(!b.isReady()||b.isDefined()))&&(U().createAndCommit({environment:d,perform:e=>Kt().$L({environment:d,transaction:e,collectionStore:v,userId:c}),userAction:"PageLayoutEditorContext.initCollectionLayout",canUndo:!1}),j.current=!0,!0)),[d,v,b,c]);const w=(0,i.useCallback)((async()=>{if(c&&b)return await wn({environment:d,layoutStore:b}),m.persist("PageLayoutEditorContext.updateLayout")}),[m,d,b,c]),I=(0,i.useCallback)((()=>{m.reset();const e=t.getLayoutStore();return!!e&&(U().createAndCommit({environment:d,perform(n){Vt().gL({environment:d,transaction:n,layoutStore:e,collectionStore:t})},userAction:"PageLayoutEditorContext.resetLayoutToDefault",canUndo:!1}),!0)}),[t,m,d]),k=(0,r().O$)(l),T=(0,r().K8)((()=>f.isReady()&&(null==b?void 0:b.isReady())),[b,f]),[C,_]=(0,i.useState)([]),P=(0,i.useMemo)((()=>new(n(265515).G)),[]),B=(0,i.useCallback)((e=>{if(l.setState(e),b&&e&&"existing_module"===e.type&&e.moduleId){const t=null==b?void 0:b.getModules();if(!t)return;const n=(0,yn().EX)(t,(t=>t.id===e.moduleId));n&&"views_main_tab_modules"===n.position.area&&function(e){var t;const{layoutStore:n,tabToFocus:i,moduleStateByIdStore:s,environment:o}=e,a=n.pointer,r=n.getModules(),l=(0,yn().EX)(r,(e=>"viewsMain"===e.type));if(!l||!(0,oe().y6)(l.module))return;const{module:d}=l,c=null==s||null===(t=s.get(d.id))||void 0===t?void 0:t.collectionContextStore;if(!c)return;const u=Sn().B.createChildStore(n,d.collection_view_block_pointer).getCollectionViewStores();let p;"viewId"===(null==i?void 0:i.type)?p=null==u?void 0:u.find((e=>{var t;return(null===(t=e.getFormat().page_layout_pointer)||void 0===t?void 0:t.views_main_tab_id)===i.viewId})):"contentTab"===(null==i?void 0:i.type)?p=null==u?void 0:u.find((e=>{var t;return"page"===e.getType()&&(null===(t=e.getFormat().page_layout_pointer)||void 0===t?void 0:t.id)===a.id})):(0,y().HB)(i),p&&(0,Qt().t)({environment:o,collectionContextStore:c,collectionViewId:p.id,isFullScreen:!1,isRootChild:!1,isInPeekRenderer:!1})}({tabToFocus:{type:"contentTab"},layoutStore:b,moduleStateByIdStore:P,environment:d})}}),[d,l,P,b]),R=be().Store.createValue(!1),D=(0,i.useMemo)((()=>b&&{layoutStore:b,collectionStore:v,currentModuleSelection:k,setModuleSelection:B,sessionId:o,addModuleHoverMenuStore:A,canEditLayout:!0,isPropertyTypeSearchInputDirtyStore:R,layoutBuilderModuleSelectionStore:l}),[b,v,k,B,o,A,R,l]),L=(0,i.useMemo)((()=>v&&{pageStore:f,hasUnsavedChanges:m.hasChanges,saveChanges:w,moduleIdsMovedFromSidebar:C,setModuleIdsMovedFromSidebar:_,isNewLayout:j.current,initialLayoutModulesByArea:x,resetLayoutToDefault:I,moduleStateByIdStore:P,collectionContextStore:h,collectionStore:v}),[v,f,m.hasChanges,w,C,x,I,P,h]);return T&&b&&D&&L?(0,ae.jsx)(Y().RI,{value:h,children:(0,ae.jsx)(Z().Op.Provider,{value:D,children:(0,ae.jsxs)(Z().sf.Provider,{value:L,children:[(0,hn().isConsoleEnabled)()?(0,ae.jsx)(kn,{}):void 0,e]})})}):null}));function kn(){return(0,i.useEffect)((()=>()=>{(0,hn().exposeDebugValue)("baseLayoutEditorContext",void 0),(0,hn().exposeDebugValue)("pageLayoutEditorContext",void 0)}),[]),(0,hn().exposeDebugValue)("baseLayoutEditorContext",(0,Z().LH)()),(0,hn().exposeDebugValue)("pageLayoutEditorContext",(0,Z().bi)()),null}var Tn=n.n(n(32485)),Cn=()=>n(75435),_n=()=>n(882722),Pn=()=>n(995847),Bn=()=>n(175947),Rn=()=>n(187820),Dn=()=>n(16006),Ln=()=>n(615244),En=()=>n(383036),On=()=>n(98126),Nn=()=>n(449279),Fn=()=>n(324254),Un=()=>n(245241),zn=()=>n(305390),Kn=()=>n(135599);function Vn({collectionStore:e}){const t=(0,f().tz)(),n=(0,i.useRef)(null),[s,o]=i.useState(""),{pageStore:a}=(0,Z().bi)(),{results:l,isResultsLoading:d}=(0,Kn().W)({query:s,type:Un().Vz.BlocksInCollection,source:"layout_builder_page_selector",limit:10,collectionId:e.id,options:{disable:!1},peopleBlocksToInclude:"none"}),c=(0,r().K8)((()=>d?[{key:"loading",action:()=>{},render:e=>(0,ae.jsx)(Nn().u,{...e,title:(0,ae.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,ae.jsx)(On().k,{})})})}]:0===l.length?[{key:"no_results",action:()=>{},render:e=>(0,ae.jsx)(Nn().u,{...e,title:(0,ae.jsx)(f().sA,{id:"pageLayoutEditor.pagePicker.noResults",defaultMessage:"No results."})})}]:l.map((e=>{const t=(null==a?void 0:a.id)===e.id;return{key:e.id,render:n=>(0,ae.jsx)(zn().A,{...n,store:e.store,hidePath:!0,isChecked:t}),action:()=>{if(t)return;if(!j().g.state.isOpen||"layout-editor"!==j().g.state.mode)throw new Error("Expected page layout editor to be open.");const n={isOpen:j().g.state.isOpen,mode:"layout-editor",pageStore:e.store,sessionId:j().g.state.sessionId,collectionStore:j().g.state.collectionStore};j().g.setState(n)}}}))),[null==a?void 0:a.id,d,l]),u=(0,ae.jsx)(q().A,{isInput:!0,style:{paddingBottom:0},desktopTitleStyle:{paddingBottom:0,marginBottom:0},children:(0,ae.jsx)(Q().Ay,{ref:n,value:s,placeholder:t.formatMessage(Wn.searchPlaceholder),focusAfterAnimation:!0,showClearButton:!0,style:{marginBottom:10},onChange:e=>{o(e.target.value)},focusInitial:l.length>0||void 0})}),p=(0,ae.jsx)(Oe().A,{menuType:De().gu.Popup,header:u,width:300,children:(0,ae.jsx)(V().A,{type:V().O.Vertical,style:{marginBottom:0},sections:[{key:"results",items:c,render:e=>(0,ae.jsx)(q().A,{...e})}],initialFocus:l.length>0?0:void 0})});return(0,ae.jsx)(Pe().A,{popupType:Pe().z.Popup,renderOrigin:e=>(0,ae.jsx)(qn,{...e,pageStore:a}),originGap:2,render:()=>p,onClose:()=>o("")})}function qn(e){const{pageStore:t,...n}=e,i=(0,l().IS)((()=>({previewButton:{color:h().Tj.text.secondary,fontWeight:D().Wy.medium,display:"flex",gap:6,alignItems:"center",justifyContent:"center",padding:"3px 6px",height:void 0,fontSize:12,overflow:"hidden",maxWidth:"100%"},recordTitle:{...D().RC,flexGrow:1},previewLabelContainer:{display:"flex",gap:3,minWidth:0},previewLabel:{flexShrink:0}})),[]);return(0,ae.jsx)(p().m,{placement:"right",renderTooltip:()=>(0,ae.jsx)(f().sA,{defaultMessage:"Choose page to preview",id:"PageLayoutEditorHeader.pagePicker.title"}),render:e=>(0,ae.jsxs)(Le().p,{...(0,En().A)(e,n),style:i.previewButton,children:[(0,ae.jsxs)("div",{style:i.previewLabelContainer,children:[(0,ae.jsx)("div",{style:i.previewLabel,children:(0,ae.jsx)(f().sA,{defaultMessage:"Preview:",id:"PageLayoutEditorHeader.pagePicker.titlePrefix"})}),(0,ae.jsx)(Dn().A,{store:t,style:i.recordTitle})]}),(0,ae.jsx)(I().I,{icon:Fn().arrowChevronSingleDownSmallIcon,size:"xs"})]})})}const Wn=(0,f().YK)({searchPlaceholder:{id:"pageLayoutEditor.pagePicker.searchPlaceholder",defaultMessage:"Search pages..."}});const Gn=function(){const e=(0,f().tz)(),t=(0,a().v3)(),{setModuleSelection:s,currentModuleSelection:o,layoutStore:r,sessionId:d}=(0,Z().LH)(),c=void 0===o,u=(0,i.useCallback)((()=>{var e;null==s||s(void 0),(0,S().L3)({environment:t,layoutId:r.id,collectionId:null===(e=r.getCollectionModel())||void 0===e?void 0:e.id,sessionId:d,from:"page_settings_button_click"})}),[s,t,r,d]),p=(0,l().IS)((()=>({button:{...c&&{background:h().Tj.state.hover}}})),[c]);return s?(0,ae.jsx)(Le().p,{"aria-label":e.formatMessage({id:"pageLayoutEditorPageSettingsButton.ariaLabel",defaultMessage:"Page settings"}),iconLeading:n(735790).M,onClick:u,style:p.button,size:"lg",children:(0,ae.jsx)(f().sA,{id:"pageLayoutEditorPageSettingsButton.label",defaultMessage:"Page settings"})}):null};var Hn=()=>n(792057),Yn=()=>n(394888),$n=()=>n(30537),Qn=()=>n(89002);const Zn=(0,rt().xh)("arrowUTurnUpLeft",{default:{loader:()=>n.e(75152).then(n.bind(n,454503))},small:{loader:()=>n.e(75152).then(n.bind(n,613601))},fill:{loader:()=>n.e(75152).then(n.bind(n,357715))},fillSmall:{loader:()=>n.e(75152).then(n.bind(n,139274))}},["uturn","left","reverse","direction","turn","undo","back"]);var Xn=()=>n(454503),Jn=()=>n(349679),ei=()=>n(241021),ti=()=>n(838239),ni=()=>n(227358),ii=()=>n(430102),si=()=>n(826905);const oi=(0,f().YK)({mainPage:{id:"pageLayoutAreas.page_main",defaultMessage:"main page"},sidebar:{id:"pageLayoutAreas.page_details",defaultMessage:"sidebar"},viewsMainTabModules:{id:"pageLayoutAreas.views_main_tab_modules",defaultMessage:"views main tab"},form:{id:"pageLayoutAreas.form_layout_schema",defaultMessage:"form"},personProfilePageMain:{id:"pageLayoutAreas.person_profile_page_main",defaultMessage:"person profile main column"},personProfilePageDetails:{id:"pageLayoutAreas.person_profile_page_details",defaultMessage:"person profile details column"},dashboardLayout:{id:"pageLayoutAreas.dashboard_layout_schema",defaultMessage:"dashboard"},generic:{id:"pageLayoutEditor.generic",defaultMessage:"area"}}),ai=(0,f().YK)({page_main:oi.mainPage,page_layout_schema:oi.mainPage,page_details:oi.sidebar,page_info_layout_schema:oi.sidebar,form_layout_schema:oi.form,form_conditional_modules:oi.form,views_main_tab_modules:oi.viewsMainTabModules,person_profile_page_main:oi.personProfilePageMain,person_profile_page_details:oi.personProfilePageDetails,dashboard_layout_schema:oi.dashboardLayout,generic:oi.generic});function ri(){const{collectionStore:e,hasUnsavedChanges:t,saveChanges:n,isNewLayout:s,initialLayoutModulesByArea:o,resetLayoutToDefault:d}=(0,Z().bi)(),{sessionId:u,layoutStore:p}=(0,Z().LH)(),g=(0,a().v3)(),m=(0,f().tz)(),[y,v]=(0,i.useState)(!1),b=(0,r().K8)((()=>p.getModules()),[p]),x=(0,l().IS)((()=>({saveButton:{height:32},saveButtonCheckMarkIcon:{width:rt().Ev.sm,height:rt().Ev.sm},saveButtonInner:{lineHeight:1.2,fontSize:14,fontWeight:D().Wy.medium},saveButtonRevertItemTitle:{fontSize:D().J.UIRegular.desktop,lineHeight:"20px",color:h().Tj.text.primary},saveButtonRevertItem:{margin:"4px",padding:"0 4px 4px"},saveButtonSectionMenuItem:{minWidth:254,padding:0}})),[]),M=(0,i.useCallback)((t=>{Kt().Fv({environment:g}),S().do({environment:g,sessionId:u,collectionId:e.id,existingLayoutId:s?void 0:p.id,layoutSaved:t,context:"layout",initialLayoutModulesByArea:o,finalModulesByArea:b,layoutStore:p})}),[e.id,g,o,s,p,u,b]),A=(0,i.useCallback)((async()=>{if(t){v(!0);try{await n(),M(!0)}catch(e){if(v(!1),!(e instanceof si().rS))throw e;{const t=e.clientData;if("cannot_move_unmoveable_module"===(null==t?void 0:t.type))Hn().f1(m.formatMessage({id:"layoutBuilder.saveButton.error.moduleCannotBeMoved",defaultMessage:"The {moduleType} module cannot be moved."},{moduleType:m.formatMessage(ge().s[t.moduleType]).toLowerCase()}));else if("cannot_remove_undeletable_module"===(null==t?void 0:t.type))Hn().f1(m.formatMessage({id:"layoutBuilder.saveButton.error.moduleCannotBeDeleted",defaultMessage:"The {moduleType} module cannot be removed."},{moduleType:m.formatMessage(ge().s[t.moduleType]).toLowerCase()}));else if("unallowed_module_in_area"===(null==t?void 0:t.type)){const e={moduleType:m.formatMessage(ge().s[t.moduleType]).toLowerCase(),area:"page_layout_schema"===t.area?m.formatMessage(ai.page_main):"page_info_layout_schema"===t.area?m.formatMessage(ai.page_details):m.formatMessage(ai.generic)};Hn().f1(m.formatMessage({id:"layoutBuilder.saveButton.error.unallowedModuleInArea",defaultMessage:"The {moduleType} module is not allowed in {area}."},e))}else if("multiple_views_main_content_tabs"===(null==t?void 0:t.type))Hn().f1(m.formatMessage({id:"layoutBuilder.saveButton.error.multipleViewsMainContentTabs",defaultMessage:"Tabbed layouts may not have multiple content tabs. Please reset your layout to remove the duplicate tab."}));else{const e=m.formatMessage({id:"layoutBuilder.saveButton.error.fallback",defaultMessage:"Something went wrong while saving layout."});Hn().f1(e)}}}}else M(!1)}),[M,t,m,n]),j=(0,i.useCallback)((()=>{d(),S().kA({environment:g,context:"layout",sessionId:u,collectionId:e.id,layoutId:s?void 0:p.id}),k(!1),M(!0)}),[M,e.id,g,s,p.id,d,u]),[w,k]=i.useState(!1);return(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsx)(Pe().A,{popupType:$n().n.Popup,alignmentToOrigin:"end",originGap:4,render:e=>(0,ae.jsx)(q().A,{style:x.saveButtonSectionMenuItem,children:(0,ae.jsx)(K().A,{onClick:()=>{k(!0),e.close()},focused:!1,itemMarginLeft:0,itemMarginRight:0,style:x.saveButtonRevertItem,icon:(0,ae.jsx)(I().I,{icon:Xn().arrowUTurnUpLeftIcon,colorVariant:"primary"}),body:(0,ae.jsxs)(c().wt,{children:[(0,ae.jsx)("div",{style:x.saveButtonRevertItemTitle,children:(0,ae.jsx)(f().sA,{id:"pageLayoutEditor.revertToOriginalLayout",defaultMessage:"Reset to original page layout"})}),(0,ae.jsx)("div",{children:(0,ae.jsx)(f().sA,{id:"pageLayoutEditor.revertToOriginalLayoutSubtitle",defaultMessage:"No properties will be deleted"})})]})})}),renderOrigin:e=>(0,ae.jsx)(ii().I,{style:x.saveButton,mainButtonStyle:x.saveButtonInner,title:(0,ae.jsx)(f().sA,{id:"pageLayoutEditor.saveAndClose",defaultMessage:"Apply to all pages"}),color:"blue",onClick:A,disableDropdown:!1,iconLeading:Jn().checkmarkSmallIcon,iconStyle:x.saveButtonCheckMarkIcon,onDropdownClick:e.onClick,isLoading:y,dropdownAriaLabel:m.formatMessage({id:"pageLayoutEditor.saveButton.dropdownAriaLabel",defaultMessage:"More save options"})})}),w?(0,ae.jsx)(Yn().s,{isOpen:!0,showCloseIcon:!0,allowDismissByEscape:!0,onDismiss:()=>k(!1),areaConstraint:{width:{type:"min",length:300}},render:({sizeRange:e})=>(0,ae.jsx)(Qn().t,{header:(0,ae.jsx)(ti().Y,{iconAndTitle:(0,ae.jsx)(ni().Z,{iconGroup:Zn,title:(0,ae.jsx)(f().sA,{id:"pageLayoutEditor.revertToOriginalLayout.modal.title",defaultMessage:"Reset to original page layout?"})}),description:(0,ae.jsx)(f().sA,{id:"pageLayoutEditor.revertToOriginalLayout.modal.subtitle",defaultMessage:"No properties will be deleted."})}),footer:(0,ae.jsx)(ei().a,{layout:"vertical",primaryButtons:[{buttonType:"destructive",label:(0,ae.jsx)(f().sA,{id:"pageLayoutEditor.revertToOriginalLayout.modal.revertButton",defaultMessage:"Reset"}),onClick:j}],secondaryButtons:[{buttonType:"dismiss",label:(0,ae.jsx)(f().sA,{id:"pageLayoutEditor.revertToOriginalLayout.modal.cancelButton",defaultMessage:"Cancel"})}]}),sizeRange:e})}):void 0]})}function li(){const e=(0,a().v3)(),{device:t}=e,{isElectron:n,isElectronMac:s}=t,{sessionId:o,layoutStore:d}=(0,Z().LH)(),{collectionStore:u,hasUnsavedChanges:p,isNewLayout:g,initialLayoutModulesByArea:m}=(0,Z().bi)(),y=(0,r().K8)((()=>d.getModules()),[d]),v=(0,r().O$)(Cn().b),b=n&&!v,x=(0,r().K8)((()=>(0,Bn().ek)(s)),[s]),M=(0,i.useCallback)((async()=>{S().do({environment:e,sessionId:o,collectionId:u.id,existingLayoutId:g?void 0:d.id,layoutSaved:!1,context:"layout",initialLayoutModulesByArea:m,finalModulesByArea:y,layoutStore:d});const t=()=>Kt().Fv({environment:e});if(!p)return void t();await(0,Ln().$)()&&t()}),[e,o,u.id,g,d,m,y,p]),A=(0,l().IS)((()=>{const e={pointerEvents:"auto"};return{header:{zIndex:1},headerContent:{display:"flex",position:"relative",marginTop:8,marginInlineEnd:16,marginBottom:8,marginInlineStart:16},topbarPlaceholder:{minHeight:x,background:h().Tj.background.secondary,borderBottom:`1px solid ${h().Tj.border.primary}`},sideButtonsContainer:{display:"flex",justifyContent:"space-between",width:"100%",height:"100%",gap:"6px",position:"absolute",insetInlineStart:0,top:0,pointerEvents:"none"},rightButtons:{...e},pageSettingsButtonContainer:{display:"flex",...e},titlePreviewContainer:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",flexGrow:1,position:"relative",...D().RC},titlePreviewElementContainer:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",maxWidth:400,overflow:"hidden"}}}),[x]);return(0,ae.jsxs)("header",{style:A.header,children:[b?(0,ae.jsx)("div",{style:A.topbarPlaceholder,className:Tn()({[_n().N_7]:!0,[_n().sbV]:!0})}):null,(0,ae.jsxs)("div",{style:A.headerContent,children:[(0,ae.jsx)("div",{style:A.titlePreviewContainer,children:(0,ae.jsxs)("div",{style:A.titlePreviewElementContainer,children:[(0,ae.jsx)(di,{collectionStore:u}),(0,ae.jsx)(Vn,{collectionStore:u})]})}),(0,ae.jsxs)(c().Ye,{style:A.sideButtonsContainer,alignItems:"center",justifyContent:"space-between",children:[(0,ae.jsx)("div",{style:A.pageSettingsButtonContainer,children:(0,ae.jsx)(Gn,{})}),(0,ae.jsxs)(c().Ye,{gap:8,alignItems:"center",style:A.rightButtons,children:[(0,ae.jsx)(Le().p,{onClick:M,iconLeading:{icon:Pn().xMarkSmallIcon,size:"sm"},size:"lg",children:(0,ae.jsx)(f().sA,{id:"pageLayoutEditor.close",defaultMessage:"Cancel"})}),(0,ae.jsx)(ri,{})]})]})]})]})}function di({collectionStore:e}){const t=(0,l().IS)((()=>({container:{display:"flex",alignItems:"center",justifyContent:"center",gap:4,color:h().Tj.text.primary,fontWeight:D().Wy.medium,width:"100%",...D().RC}})),[]),n=(0,r().K8)((()=>e.getIcon()),[e]);return(0,ae.jsxs)("div",{style:t.container,children:[(0,ae.jsx)(Rn().B6,{icon:n,size:20,iconRecordCategory:"collection",isEmptyPage:!1,disabled:!0}),(0,ae.jsx)(Dn().A,{store:e})]})}function ci(e){const t=(0,l().IS)((()=>({container:{width:"100%",backgroundColor:h().Tj.background.secondary,cursor:"default"},innerContainer:{overflowY:"auto",paddingTop:20,paddingInlineEnd:0,paddingBottom:0,paddingInlineStart:24,height:"100%",marginTop:-20,minWidth:M().ok,zIndex:0,position:"relative"}})),[]),n=(0,r().O$)(j().g),o=n.isOpen&&"layout-editor"===n.mode?n.initialSelectedModuleId:void 0,a=(0,r().uB)(e.layoutBuilderModuleSelectionStore,A().A),d=n.isOpen&&"layout-editor"===n.mode;return(0,i.useEffect)((()=>{d&&a.setState(o?{type:"existing_module",moduleId:o,isDragging:!1}:void 0)}),[o,d,a]),n.isOpen&&"layout-editor"===n.mode?(0,ae.jsxs)(In,{...n,layoutBuilderModuleSelectionStore:a,children:[e.debugChildForTestsOnly,(0,ae.jsxs)(s().A,{tag:c().wt,initial:{translateY:5,opacity:0},animate:{translateY:0,opacity:1},config:{duration:650,timingFunction:"ease-in-out"},style:t.container,children:[(0,ae.jsx)(li,{}),(0,ae.jsxs)(c().Ye,{style:t.innerContainer,children:[(0,ae.jsx)(ui,{}),(0,ae.jsx)(ln,{})]})]})]}):null}function ui(){const{pageStore:e}=(0,Z().bi)(),{setModuleSelection:t,layoutBuilderModuleSelectionStore:n,layoutStore:c,sessionId:u}=(0,Z().LH)(),p=(0,a().v3)(),g=(0,r().K8)((()=>{var e;return Boolean(null===(e=n.state)||void 0===e?void 0:e.isDragging)}),[n]),m=(0,r().K8)((()=>(0,M().dV)(p)),[p]),f=(0,r().K8)((()=>{switch(m){case"xxSmall":case"xSmall":case"small":return"layout-editor-narrow";case"medium":case"large":case"xLarge":return e.isFullWidth()?"layout-editor-wide":"layout-editor";default:(0,y().HB)(m)}}),[m,e]),A=(()=>{switch(m){case"xxSmall":case"xSmall":return!0;case"small":case"medium":case"large":case"xLarge":return!1;default:return(0,y().HB)(m)}})(),j=(0,r().K8)((()=>(0,x().oQ)(p).totalWidth),[p]),w=(0,r().K8)((()=>Boolean(e.getCover())),[e]);(0,i.useEffect)((()=>T(!A)),[A]);const I=(0,l().IS)((()=>({container:{height:"100%",background:h().Tj.background.primary,flexGrow:3,borderStartStartRadius:12,borderStartEndRadius:12,borderEndEndRadius:0,borderEndStartRadius:0,boxShadow:"0px 9px 12px 0px rgba(15, 15, 15, 0.1)",borderColor:h().Tj.palette.gray[75],borderWidth:1,overflowY:"auto",display:"flex",...g?{cursor:"grabbing"}:{},...A?{position:"relative"}:{}},mainPage:{flex:3,paddingTop:w?void 0:28},sidebarContainer:{background:h().Tj.background.primary,height:"100%",...A?{position:"absolute",insetInlineEnd:0,height:"100%",boxShadow:h().Tj.shadow.base.diffuse}:void 0},sidebarScroller:{borderInlineStart:`solid 1px ${h().Tj.outlineBlueButtonPressedBackground}`,height:"100%"},mainPageContainer:{flex:1,height:"100%"},mainPageScrollContainer:{height:"100%"},sidebar:{padding:`${x().MH}px ${x().uZ}px`,marginBottom:100,flex:1,minWidth:j,maxWidth:j,width:j,transition:"width 0.1s, min-width 0.1s, max-width 0.1s"},dismissSidebarOverlay:{position:"absolute",top:0,bottom:0,insetInlineStart:0,insetInlineEnd:0}})),[g,w,A,j]),[k,T]=(0,i.useState)(!A);return(0,ae.jsxs)("div",{role:"presentation",style:I.container,onClick:e=>{(0,o().SQ)(e,o().y$.Click,(()=>{var e;t(void 0),(0,S().L3)({environment:p,layoutId:c.id,collectionId:null===(e=c.getCollectionModel())||void 0===e?void 0:e.id,sessionId:u,from:"background_click"})}))},children:[(0,ae.jsx)(mn().s,{area:"page_main",style:I.mainPageContainer,children:(0,ae.jsx)(b().l,{children:(0,ae.jsx)(v().H,{type:d().A.Y,style:I.mainPageScrollContainer,children:(0,ae.jsx)("div",{style:I.mainPage,children:(0,ae.jsx)(fn().Mx,{type:f,children:(0,ae.jsx)(gn().J,{area:"page_main"})})})})})}),A&&k?(0,ae.jsx)("div",{role:"none",style:I.dismissSidebarOverlay,onClick:e=>(0,o().SQ)(e,o().y$.Click,(()=>{T(!1)}))}):void 0,(0,ae.jsx)(s().A,{visible:k,initial:{translateX:j},animate:{translateX:0},exit:{translateX:j},config:{duration:250,timingFunction:"ease-in-out"},children:(0,ae.jsx)(mn().s,{area:"page_details",style:I.sidebarContainer,children:(0,ae.jsxs)(v().H,{type:d().A.Y,style:I.sidebarScroller,children:[(0,ae.jsx)(pi,{isSidebarOpen:!0,setIsSidebarOpen:T}),(0,ae.jsx)("div",{style:I.sidebar,children:(0,ae.jsx)(gn().J,{area:"page_details"})})]})})}),k?void 0:(0,ae.jsx)(pi,{isSidebarOpen:!1,setIsSidebarOpen:T})]})}function pi({isSidebarOpen:e,setIsSidebarOpen:t}){const n=(0,f().tz)(),s=(0,l().IS)((()=>({container:{position:"relative",height:0,zIndex:1},button:{position:"absolute",insetInlineEnd:e?void 0:4,insetInlineStart:e?4:void 0,top:4}})),[e]),o=(0,i.useCallback)((()=>{t((e=>!e))}),[t]);return(0,ae.jsx)("div",{style:s.container,children:(0,ae.jsx)(p().m,{renderTooltip:()=>e?(0,ae.jsx)(f().sA,{...gi.hideSidebar}):(0,ae.jsx)(f().sA,{...gi.showSidebar}),placement:"top",render:t=>(0,ae.jsx)(u().A,{icon:e?m().O:g().S,...t,onClick:o,style:s.button,ariaLabel:e?n.formatMessage(gi.hideSidebar):n.formatMessage(gi.showSidebar)})})})}const gi=(0,f().YK)({hideSidebar:{defaultMessage:"Hide sidebar",id:"pageLayout.builder.hideSidebar"},showSidebar:{defaultMessage:"Show sidebar",id:"pageLayout.builder.showSidebar"}})},15785:(e,t,n)=>{n.d(t,{u:()=>i});const i=(0,n(340498).xh)("arrowStraightDown",{default:{loader:()=>n.e(67678).then(n.bind(n,655923))},small:{loader:()=>n.e(67678).then(n.bind(n,403733))},fill:{loader:()=>n.e(67678).then(n.bind(n,378815))},fillSmall:{loader:()=>n.e(67678).then(n.bind(n,886358))}},["arrow","right","direction","next","forward"])},19780:(e,t,n)=>{n.r(t),n.d(t,{default:()=>y});n(296540);var i=()=>n(726637),s=()=>n(484714),o=()=>n(590526),a=()=>n(394888),r=()=>n(89002),l=()=>n(493552),d=()=>n(69708),c=()=>n(209660),u=()=>n(241021),p=()=>n(838239),g=()=>n(227358),m=()=>n(339907),f=()=>n(927377),h=n(474848);function y(){const e=(0,s().Y0)(),t=(0,o().K8)((()=>f().A.state.open),[]),n=()=>{f().A.state.open&&f().A.state.onDecline&&f().A.state.onDecline(),f().A.setState({open:!1})},y=()=>{f().A.state.open&&f().A.state.onConfirm(),f().A.setState({open:!1})},v=()=>{n(),c().Ow({currentTab:"connected_apps"})};return(0,h.jsx)(a().s,{areaConstraint:{width:{type:"range",min:300,max:400},height:{type:"unlimited",scroll:"allow"}},isOpen:t,onDismiss:n,animateSizeTransition:!0,render:()=>(0,h.jsx)(r().t,{header:(0,h.jsx)(p().Y,{iconAndTitle:(0,h.jsx)(g().Z,{iconGroup:m().sK,title:(0,h.jsx)(d().sA,{defaultMessage:"Notion cannot access the Google Drive file you are trying to embed.",id:"googleAuthPromptModal.noAccessFile.errorMessage"})})}),footer:(0,h.jsx)(u().a,{layout:"vertical",primaryButtons:e.isMobileNative?[]:[{buttonType:"primary",label:(0,h.jsx)(d().sA,{defaultMessage:"Connect to Google",id:"googleAuthPromptModal.connectToGoogleButton.label"}),onClick:y}],secondaryButtons:i().A.isMobile?[]:[{buttonType:"outline",label:(0,h.jsx)(d().sA,{defaultMessage:"See my connected accounts",id:"googleAuthPromptModal.seeConnectedAccountsButton.label"}),onClick:v}]}),children:e.isMobileNative?(0,h.jsx)(l().D,{styleKey:"bodyMedium",colorVariant:"secondary",style:{textAlign:"center"},children:(0,h.jsx)(d().sA,{defaultMessage:"Please use Notion on desktop to connect a new account.",id:"googleAuthPromptModal.mobileUseDesktopPrompt.errorMessage"})}):null})})}},22634:(e,t,n)=>{n.d(t,{O:()=>o});n(296540);var i=n(474848);const s={viewBox:"0 0 20 20",fittedViewBox:"4.42 3.97 12.16 12.06",directional:!0,svg:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{d:"m5.492 4.158 5.4 5.4a.625.625 0 0 1 0 .884l-5.4 5.4a.625.625 0 1 1-.884-.884L9.566 10 4.608 5.042a.625.625 0 1 1 .884-.884"}),(0,i.jsx)("path",{d:"m16.392 10.442-5.4 5.4a.625.625 0 0 1-.884-.884L15.066 10l-4.958-4.958a.625.625 0 0 1 .884-.884l5.4 5.4a.625.625 0 0 1 0 .884"})]})},o=(0,n(340498).wt)("arrowChevronDoubleForward",s,"default")},25500:(e,t,n)=>{n.d(t,{A:()=>s});n(296540);var i=n(474848);function s(e){return(0,i.jsx)("div",{style:{width:"100%",position:"relative",paddingBottom:100*e.ratio+"%"},children:e.children})}},26517:(e,t,n)=>{n.d(t,{Wf:()=>h,YB:()=>m,aj:()=>f,f3:()=>y});n(898992),n(354520),n(581454),n(296540);var i=()=>n(726637),s=()=>n(546926),o=()=>n(890492),a=()=>n(81068),r=()=>n(663639),l=()=>n(736847),d=()=>n(651124),c=()=>n(69708),u=()=>n(449195),p=()=>n(74263),g=n(474848);function m(e){const{currentVisibility:t,propertySchema:n,onSelect:s,onClose:o}=e;let a=[...d().vj];a=a.filter((e=>"section"!==e)),(0,u()._f)({propertySchema:n})||(a=a.filter((e=>"hide_if_empty"!==e)));const r=a.map((e=>({visibility:e,label:(0,g.jsx)(c().sA,{...p().gY[e]})})));return(0,g.jsx)(v,{currentVisibility:t,visibilityLevelsWithLabels:r,onSelect:s,onClose:o,menuTitle:i().A.isMobile?(0,g.jsx)(c().sA,{...p().vb}):void 0})}function f(e){const{currentVisibility:t,onSelect:n,onClose:i}=e,s=(0,u().SB)(t),o=["always_show","section_collapsed","section_hide"].map((e=>({visibility:e,label:(0,g.jsx)(c().sA,{...p().vG[e]})})));return(0,g.jsx)(v,{currentVisibility:s,visibilityLevelsWithLabels:o,onSelect:n,onClose:i})}function h(e){const{currentVisibility:t,onSelect:n,onClose:i}=e,s=d().OA.filter((e=>"section_hide"!==e)).map((e=>({visibility:e,label:(0,g.jsx)(c().sA,{...p().wV[e]})}))),o="section_hide"===t?void 0:t;return(0,g.jsx)(v,{currentVisibility:o,visibilityLevelsWithLabels:s,onSelect:n,onClose:i})}function y(e){const{currentVisibility:t,onSelect:n,onClose:i}=e,s=d().RL.map((e=>({visibility:e,label:(0,g.jsx)(c().sA,{...p().PP[e]})})));return(0,g.jsx)(v,{currentVisibility:t,visibilityLevelsWithLabels:s,onSelect:n,onClose:i})}function v(e){const{currentVisibility:t,visibilityLevelsWithLabels:n,onSelect:a,menuTitle:d,onClose:c}=e,u=n.map((({visibility:e,label:n})=>({key:e,render:i=>(0,g.jsx)(b,{buttonMenuItemProps:i,isChecked:e===t,label:n}),action:()=>{a(e),c&&c()}}))),p=[{key:"visibilityLevels",render:e=>(0,g.jsx)(l().A,{...e,topBorder:0!==e.index}),items:u}],m={menuType:i().A.isMobile?s().gu.Modal:s().gu.Popup,width:"auto",maxWidth:360,...i().A.isMobile&&{enableMobileRefresh:!0,title:d}};return(0,g.jsx)(o().A,{...m,children:(0,g.jsx)(r().A,{type:r().O.Vertical,initialFocus:void 0,sections:p})})}function b(e){const{buttonMenuItemProps:t,label:n,isChecked:i}=e;return(0,g.jsx)(a().A,{...t,title:n,isChecked:i})}},31902:(e,t,n)=>{n.d(t,{A:()=>o});n(296540);var i=()=>n(69708),s=n(474848);const o=function({collectionViewName:e,collectionViewType:t}){return(0,n(59226).X)("allow_empty_view_name")&&""===e?null:e?(0,s.jsx)(n(288722).A,{children:e}):"page"===t?(0,s.jsx)(i().sA,{id:"database.collectionView.untitledName.untitled",defaultMessage:"Untitled"}):(0,s.jsx)(i().sA,{...n(403905).X[t]})}},32231:(e,t,n)=>{n.d(t,{P:()=>a});n(296540);var i=()=>n(690495),s=()=>n(766676),o=n(474848);function a(e){const{messageKey:t}=e,n={id:"",key:t,type:"static",category:i().lU[t].category,props:{}};return(0,o.jsx)(s().C,{...e,message:n})}},33047:(e,t,n)=>{n.r(t),n.d(t,{MobilePageBacklinksMenuRenderer:()=>p});n(296540);var i=()=>n(907258),s=()=>n(590526),o=()=>n(127833),a=()=>n(546926),r=()=>n(890492),l=()=>n(69708),d=()=>n(352759),c=()=>n(592968),u=n(474848);function p(e){const t=(0,s().O$)(c().F);return(0,u.jsx)(o().zD,{popupType:o().nl.BottomSheet,bottomSheetInitialState:"half",trapFocus:!0,open:t.isOpen,render:()=>(0,u.jsx)(g,{menuState:t}),onDismiss:()=>{c().F.setState({isOpen:!1})}})}function g(e){const t=(0,s().O$)(i().AppStoreMainEditorCurrentBlockStore);if(!e.menuState.isOpen)return null;if(t){const e={menuType:a().gu.Modal,title:(0,u.jsx)(l().sA,{defaultMessage:"Linked to this page",id:"page.expandedBacklinks.label"})};return(0,u.jsx)(r().A,{...e,children:(0,u.jsx)(d().t,{store:t})})}return null}},33050:(e,t,n)=>{n.d(t,{P:()=>o});var i=()=>n(79926);const s=new(i().O2)("topbarMoreMenu",(async()=>await Promise.all([n.e(75134),n.e(35530),n.e(9773),n.e(36556),n.e(55373),n.e(36192),n.e(40537),n.e(71562),n.e(96346),n.e(44711),n.e(53321),n.e(51220),n.e(16471),n.e(37353),n.e(37571),n.e(29151),n.e(40118),n.e(50397),n.e(62475),n.e(3151),n.e(98629),n.e(22926),n.e(22900),n.e(42838),n.e(85128),n.e(49889),n.e(20108),n.e(46174),n.e(27992),n.e(63452),n.e(66249),n.e(92845),n.e(87249),n.e(79022),n.e(44854),n.e(34877),n.e(46414),n.e(11676),n.e(61165),n.e(47668),n.e(94522),n.e(44584),n.e(24587),n.e(67494),n.e(3651),n.e(38293),n.e(40992),n.e(88455),n.e(64556),n.e(33893),n.e(91793),n.e(55162),n.e(71003),n.e(32370),n.e(26264),n.e(36437),n.e(50363),n.e(42660),n.e(44590),n.e(55113),n.e(85071),n.e(7914),n.e(25588),n.e(68637),n.e(23640),n.e(72252),n.e(93134),n.e(12452),n.e(52871),n.e(29351),n.e(18825),n.e(71853),n.e(93049),n.e(22582),n.e(18636),n.e(87289),n.e(16060),n.e(34281),n.e(48376),n.e(35279),n.e(80229),n.e(77754),n.e(71309),n.e(74562),n.e(39986),n.e(47431),n.e(47160),n.e(76677),n.e(68609),n.e(37384),n.e(15553),n.e(77345),n.e(67720),n.e(37759),n.e(41423),n.e(13955),n.e(42056),n.e(14699),n.e(57924),n.e(5181),n.e(3261),n.e(19456),n.e(17729),n.e(45147),n.e(65375),n.e(32116),n.e(94995),n.e(98339),n.e(51240),n.e(82641),n.e(20029),n.e(68395),n.e(81803),n.e(96654),n.e(68643),n.e(32625),n.e(63687),n.e(95885),n.e(27083),n.e(78999),n.e(11424),n.e(40119),n.e(54742),n.e(38946),n.e(90880),n.e(49175),n.e(8852),n.e(5331),n.e(92924),n.e(71381),n.e(1947),n.e(96385),n.e(80326),n.e(53352),n.e(2373),n.e(5315),n.e(995),n.e(76690),n.e(60713),n.e(31106),n.e(63248),n.e(54719),n.e(48570),n.e(78862),n.e(54234),n.e(85160),n.e(15381),n.e(50525),n.e(15922),n.e(77651),n.e(51204),n.e(34974),n.e(58672),n.e(95103),n.e(58071),n.e(75681)]).then(n.bind(n,379648)))),o=(0,i()._h)(s,(e=>e.TopbarMoreMenu))},35889:(e,t,n)=>{n.d(t,{aL:()=>S,T7:()=>b,Hi:()=>x,$4:()=>v});n(296540);var i=()=>n(564884),s=()=>n(792057),o=()=>n(584262),a=()=>n(427704),r=()=>n(69708),l=()=>n(329458),d=()=>n(314529);var c=()=>n(687633),u=()=>n(729283),p=()=>n(486674),g=()=>n(492414),m=()=>n(171598),f=()=>n(619206),h=()=>n(968877),y=n(474848);async function v(e){(0,l().L)(e,{variant:"open_notion"}),(0,c().u)(e,{target:"open_notion"}),await u().VE(e,{utmContent:"topbar_cta",nextRoute:a().JZ.root})}function b(e,t){const{RouterStore:n}=e,i=n.state.route,l=(0,p().a)();if(function(e){(0,d().DO_NOT_USE_trackLegacy)(e,"public_page_topbar_edit_click",{},{dontWait:!0})}(e),"page"===i.name&&i.requestedOnPublicDomain&&l){const t=(0,g().Ay)({store:l,preferPublicLink:!1,pageVisitSource:o().y8.EditPublicPage,disableSlug:!0,embedded:!1});(0,m().navigateOnBaseUrl)({environment:e,url:t,openInNewTab:i.embedded})}else e.currentUser.isLoggedIn()?s().ui({showCancel:!0,keepFocus:!1,message:(0,y.jsx)(r().sA,{defaultMessage:"When you start editing, your name, email and photo may become visible to anyone who can view the page.",id:"action.startPublicEditDialog.message"}),items:[{label:(0,y.jsx)(r().sA,{defaultMessage:"Continue",id:"action.startPublicEditDialog.continueLabel"}),color:"blue",onAccept(){f().A.setState({editing:!0,commenting:!0})}}]}):(h().iZ({currentUserId:e.currentUser.id,blockId:t}),(0,m().navigateOnBaseUrl)({environment:e,url:a().JZ.login}))}function S(e,t){const{RouterStore:n}=e,i=n.state.route,s=(0,p().a)();if(function(e){(0,d().DO_NOT_USE_trackLegacy)(e,"public_page_topbar_comment_click",{},{dontWait:!0})}(e),"page"===i.name&&i.requestedOnPublicDomain&&s){const t=(0,g().Ay)({store:s,preferPublicLink:!1,pageVisitSource:o().y8.CommentPublicPage,disableSlug:!0,embedded:!1});(0,m().navigateOnBaseUrl)({environment:e,url:t,openInNewTab:i.embedded})}else h().iZ({currentUserId:e.currentUser.id,blockId:t}),(0,m().navigateOnBaseUrl)({environment:e,url:a().JZ.login})}function x(e,t){(0,i().u)({environment:e,event:{eventName:"report_form_clicked",eventProperties:{form_id:t}}}),(0,m().navigateOnBaseUrl)({environment:e,url:a().JZ.reportInappropriateForm})}},37824:(e,t,n)=>{n.d(t,{A:()=>o});var i=()=>n(821062);class s extends(()=>n(757695))().Store{getInitialState(){return{automationActionStore:void 0,automationStore:void 0,contextType:void 0,typecheckResult:void 0}}blur(e){void 0!==this.state.automationStore&&(void 0===e||(0,i().A)(this.state,e))&&this.setState({automationActionStore:void 0,automationStore:void 0,contextType:void 0,typecheckResult:void 0})}focus(e){(0,i().A)(this.instanceState,e)||this.setState(e)}}const o=new s;(0,n(852832).exposeDebugValue)("AutomationFocusStore",s)},58180:(e,t,n)=>{n.d(t,{E:()=>s});var i=()=>n(310526);function s(e,t){var n;if(!t)return!1;if(!(0,i().U)(t))return!1;const s=null===(n=e.getTopLevelAncestorBlockStore())||void 0===n?void 0:n.id;return!!s&&!!t.getPrivatePageIds().includes(s)}},62088:(e,t,n)=>{n.d(t,{oY:()=>T,uE:()=>k});n(944114),n(898992),n(430670);var i=n(296540),s=()=>n(106702),o=()=>n(920198),a=()=>n(907258),r=()=>n(484714),l=()=>n(590526),d=()=>n(79926),c=()=>n(187174),u=()=>n(68263),p=()=>n(69708),g=()=>n(778078),m=()=>n(496603),f=()=>n(381678),h=()=>n(47373),y=()=>n(499764),v=()=>n(673477),b=()=>n(106628),S=()=>n(534619),x=()=>n(977870),M=()=>n(271084),A=()=>n(233692);const j=75,w=75,I=4;function k(e){const{query:t,useMentionMenuStore:n}=e,s=(0,l().K8)((()=>!(!e.disabled&&!n)&&!v().Ay.state.mentionTypes.user),[e.disabled,n]),{results:o,isLoading:h}=function(e){const{query:t,disabled:n,useMentionMenuStore:s,open:o}=e,h=(0,p().tz)(),A=(0,r().v3)(),w=(0,l().K8)((()=>s?v().Ay.state.open:o),[o,s]),I=(0,l().O$)(a().AppStoreSidebarSpaceStore),k=!n&&t.length>0&&I&&w,T=(0,l().K8)((()=>{var e;const t=M().k.getSortedUserIds(),n=null===(e=(0,f()._)(A))||void 0===e?void 0:e.id;return[...(0,m().oE)([n]),...t]}),[A]),C=(0,l().K8)((()=>{const e=a().default.state.mainEditorCurrentBlockStore;return e?(0,y().i0)(e).flatMap((({permissionItem:e})=>(0,u().B2)(e)?[e.user_id]:[])):[]}),[]),_=(0,d().fJ)(b().T.searchActions),[{value:P=[],status:B}]=(0,c().Yb)((async()=>{if(!k||"resolved"!==_.status)return[];const e=(0,m().sb)([...T,...C]),n=_.value;return(await n.searchUsers({environment:A,parentStore:I,query:t,userIds:e,minFuzzyScore:g().XR,placeSelfFirst:n.isPersonalPronoun(t,h.locale)})).slice(0,3)}),[k,_.status,_.value,T,C,A,I,t,h.locale]),R=(0,l().K8)((()=>I&&x().c.state.wasGetVisibleUsersCalled[I.id]),[I]),[{value:D=[],status:L}]=(0,c().Yb)((async()=>k&&R?(0,S().searchSpaceUsers)({environment:A,query:t,membersOnly:!1,limit:20,minFuzzyScore:g().XR}):[]),[k,A,t,R],{debounce:j}),E=(0,i.useMemo)((()=>{const e=[...P,...D];return(0,m().hS)(e,(e=>e.id))}),[P,D]),O="pending"===L||"pending"===B;return{results:E,isLoading:O}}({query:t,disabled:s,...n?{useMentionMenuStore:!0}:{useMentionMenuStore:!1,open:!0}}),A=(0,l().K8)((()=>v().Ay.state.emptyQueryUserRequestStore.state.result??[]),[]);return{results:0===t.length?A.slice(0,I):o.slice(0,20),isLoading:h}}function T(e){const{query:t,environment:n,useMentionMenuStore:i,open:a}=e,r=(0,l().K8)((()=>i?v().Ay.state.open:a),[a,i]),d=(0,h().ke)(),u=(0,o().L)(),p=(0,s().$)(),g=!(0,l().K8)((()=>!(!e.disabled&&!i)&&!v().Ay.state.mentionTypes.bot),[e.disabled,i])&&d&&r&&Boolean(u)&&Boolean(p),[{value:m=[],status:f}]=(0,c().Yb)((async()=>{if(!g)return[];try{if(!u||!p)return[];const e=await b().T.customAgentSearchService.load(),{workflowStores:i}=await e.getCustomAgents({environment:n,spaceStore:u,userStore:p}),s=e.searchWorkflowStores({query:t,workflowStores:i,limit:5}),o=[];for(const t of s){const e=(0,A().m)(t);o.push({workflowStore:t,name:e.name,icon:e.icon})}return o}catch{return[]}}),[g,u,p,t,n],{debounce:w});return{results:m,isLoading:"pending"===f}}},64901:(e,t,n)=>{n.d(t,{A:()=>s});n(296540);var i=n(474848);const s=function(e){const t=(0,n(484714).v3)();return(0,i.jsx)(n(552712).N,{style:{display:"flex",alignSelf:"stretch",width:36},external:!0,href:e.href,onClick:()=>n(148024).FH(t,{from:e.analyticsFrom}),children:(0,i.jsx)(n(718827).Ay,{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:(0,i.jsx)(n(807449).I,{icon:n(406533).questionMarkCircleIcon,colorVariant:"tertiary"})})})}},70463:(e,t,n)=>{n.r(t),n.d(t,{default:()=>M});n(898992),n(941795);var i=n(296540),s=()=>n(484714),o=()=>n(590526),a=()=>n(807449),r=()=>n(416783),l=()=>n(31511),d=()=>n(160432),c=()=>n(721479),u=()=>n(427704),p=()=>n(69708),g=()=>n(100622),m=()=>n(284371),f=()=>n(769864),h=()=>n(381678),y=()=>n(404141),v=()=>n(446242),b=n(474848);const S={padding:"24px 36px 24px",minWidth:300,maxWidth:400},x=n(757695).Store.createClass(void 0,{name:"PromoErrorStore"});const M=function(){const e=(0,o().K8)((()=>v().A.state.open),[]);return(0,b.jsx)(n(107975).a,{open:e,innerStyle:S,preventHideChildrenWhileOpening:!0,render:()=>(0,b.jsx)(T,{}),onDismiss:j})};function A(){return(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",color:g().Tj.text.tertiary,borderTop:`1px solid ${g().Tj.border.secondaryTranslucent}`,paddingTop:14,gap:6},children:[(0,b.jsx)(a().I,{icon:c().questionMarkCircleSmallIcon,size:"sm",colorVariant:"tertiary"}),(0,b.jsx)("div",{children:(0,b.jsx)(p().sA,{defaultMessage:"Have questions about this? <inlinelink>More info & FAQs</inlinelink>.",id:"studentNotEligibleModal.contactUsSection.message",values:{inlinelink:e=>(0,b.jsx)(r().V,{href:"https://www.notion.so/Notion-for-students-teachers-adc631df15ee4ab9a7a33dd50f4c16fe",external:!0,children:e})}})})]})}function j(){v().A.setState({open:!1})}function w(){j(),y().Ay.setState({open:!0,openedFrom:"student_not_eligible_modal",currentTab:"profile",defaultSubtab:void 0,highlightedSetting:void 0})}function I(){const e=(0,s().v3)(),t=(0,o().K8)((()=>(0,h()._)(e)),[e]),n=(0,o().K8)((()=>null==t?void 0:t.getEmail()),[t]);return(0,b.jsxs)("div",{style:{display:"flex",marginTop:16},children:[(0,b.jsx)("div",{style:{width:18,flexShrink:0,color:g().Tj.text.secondary},children:(0,b.jsx)(p().sA,{defaultMessage:"1.",id:"studentNotEligibleModal.numberedList.firstItem"})}),(0,b.jsxs)("div",{style:{flexGrow:1},children:[(0,b.jsx)("div",{style:{color:g().Tj.text.secondary},children:(0,b.jsx)(p().sA,{defaultMessage:"Your current email is:",id:"studentNotEligibleModal.numberedList.changeEmailItem.message"})}),(0,b.jsx)("div",{style:{fontWeight:m().Wy.medium,marginTop:0},children:n}),(0,b.jsx)("div",{style:{color:g().Tj.text.secondary,marginTop:4},children:(0,b.jsx)(p().sA,{defaultMessage:"Thousands of university, college, and post-secondary school domains are already eligible, not just .edu emails!",id:"studentNotEligibleModal.numberedList.changeEmailItem.message2"})}),(0,b.jsx)(d().A,{colorPalette:"blue",style:{marginTop:12},onClick:w,size:"lg",children:(0,b.jsx)(p().sA,{defaultMessage:"Change email",id:"studentNotEligibleModal.numberedList.changeEmailItem.button.label"})})]})]})}function k(){const e=(0,p().tz)(),t=(0,s().v3)(),n=(0,o().uB)(void 0,x),[a,r]=(0,i.useState)(""),c=(0,i.useCallback)((()=>async function(e,t,n,i){if(n){const s=await f().callApi({eventName:"getPromoCode",environment:e,data:{code:n}});"failed"!==s.type&&s.data.promo?v().A.state.open&&(await v().A.state.handlePromoCode(n),j()):i.setState(t.formatMessage({defaultMessage:"Promo code {code} does not exist",id:"studentNotEligibleModal.numberedList.item2.promocode.errorMessage"},{code:n}))}}(t,e,a,n)),[t,e,a,n]),u=(0,i.useCallback)((e=>function(e,t,n){t(e.target.value.toUpperCase()),n.setState(void 0)}(e,r,n)),[r,n]),m=(0,o().O$)(n),h=e.formatMessage({defaultMessage:"Enter code…",id:"studentNotEligibleModal.numberedList.item2.promocodePlaceholder"});return(0,b.jsxs)("div",{style:{display:"flex",marginTop:16},children:[(0,b.jsx)("div",{style:{width:18,flexShrink:0,color:g().Tj.text.secondary},children:(0,b.jsx)(p().sA,{defaultMessage:"2.",id:"studentNotEligibleModal.numberedList.secondItem"})}),(0,b.jsxs)("div",{style:{flexGrow:1},children:[(0,b.jsx)("div",{style:{color:g().Tj.text.secondary},children:(0,b.jsx)(p().sA,{defaultMessage:"Have a student promo code?",id:"studentNotEligibleModal.numberedList.promoCodeItem.message"})}),(0,b.jsxs)("div",{style:{display:"flex",marginTop:12},children:[(0,b.jsx)(l().A,{style:{marginInlineEnd:8,height:32},value:a,onChange:u,onSubmit:c,placeholder:h}),(0,b.jsx)(d().A,{colorPalette:"blue",onClick:c,disabled:!a,size:"lg",children:(0,b.jsx)(p().sA,{defaultMessage:"Submit",id:"studentNotEligibleModal.numberedList.promoCodeItem.submitButton"})})]}),(0,b.jsx)("div",{style:{color:g().oZ.red,fontSize:12,marginTop:4,marginInlineStart:8,height:20},children:m})]})]})}function T(){return(0,b.jsxs)("div",{style:{fontSize:14},children:[(0,b.jsx)("div",{children:(0,b.jsx)(p().sA,{defaultMessage:"<p>Unfortunately you are not eligible for a free Education plan if you use this email address.</p><p>K-12 students, K-12 educators, and personal email addresses such as Gmail and Outlook are not eligible to receive the <pricinglink>Education Plan</pricinglink> for free, but anyone is welcome to use the <pricinglink>Free Plan</pricinglink> for free with unlimited storage.</p>",id:"studentNotEligibleModal.header",values:{br:(0,b.jsx)("br",{}),p:e=>(0,b.jsx)("p",{style:{marginTop:0,marginBottom:8},children:1===e.length?e[0]:i.Children.toArray(e)}),pricinglink:e=>(0,b.jsx)(r().V,{external:!0,href:u().eR.pricing,children:e})}})}),(0,b.jsx)(I,{}),(0,b.jsx)(k,{}),(0,b.jsx)(A,{})]})}},72897:(e,t,n)=>{n.r(t),n.d(t,{clearCoEditingOverride:()=>c,setCoEditingOverride:()=>d,setCoEditingSetting:()=>l});var i=()=>n(564884),s=()=>n(488923),o=()=>n(680977),a=()=>n(547149),r=()=>n(642046);async function l(e){var t,n;const{environment:r,userSettingsStore:l,spaceId:d,active:c}=e,u=(null===(t=l.getSettings())||void 0===t?void 0:t.beta_ai_co_editing_settings)??{};if(((null===(n=u[d])||void 0===n?void 0:n.autocorrect)??!1)===c)return;a().createAndCommit({userAction:"AiCoEditingSettings.onToggleOption",environment:r,canUndo:!0,perform:e=>{(0,o().m)({userSettingsStore:l,data:{beta_ai_co_editing_settings:{...u,[d]:{autocorrect:c}}},transaction:e})}});const p=await(0,s().uZ)();c&&p.resetSessionId(),(0,i().u)({environment:r,event:{eventName:"co_editing_toggled",eventProperties:{toggle_status:c?"on":"off",session_id:p.getSessionId()}}}),c||p.resetSessionId()}async function d(e){const{environment:t,pageId:n,active:o}=e;r().t.setOverride(n,{autocorrect:o});const a=await(0,s().uZ)();(0,i().u)({environment:t,event:{eventName:"co_editing_override_updated",eventProperties:{new_state:o?"on":"off",session_id:a.getSessionId(),page_id:n}}})}async function c(e){const{environment:t,pageId:n}=e;r().t.clearOverride(n);const o=await(0,s().uZ)();(0,i().u)({environment:t,event:{eventName:"co_editing_override_updated",eventProperties:{new_state:"cleared",session_id:o.getSessionId(),page_id:n}}})}},73926:(e,t,n)=>{n.d(t,{H:()=>r});n(296540);var i=()=>n(69708),s=()=>n(100622);n(18107),n(967357);var o=n(474848);const a=(0,i().YK)({reportPageName:{id:"action.reportPage.name",defaultMessage:"Report page"}}),r=(0,n(267271).Ls)({key:"action report page",displayName:a.reportPageName,analyticsName:a.reportPageName.defaultMessage,validators:[n(946561).s,n(622311).E,function({blocks:e}){var t;return(null===(t=e.at(0))||void 0===t?void 0:t.getSpaceId())!==n(96689).Zz},(0,n(598101).A)(n(59411).k)],closeParentMenu:!0,render:e=>(0,o.jsx)(n(575143).A,{...e,style:{color:s().oZ.red},svg:n(748054).M,svgStyle:{fill:s().oZ.red},title:(0,o.jsx)(i().sA,{...a.reportPageName})}),action:({blocks:e,environment:t})=>{n(201170).HX()}})},74263:(e,t,n)=>{n.d(t,{PP:()=>o,gY:()=>p,vG:()=>r,vb:()=>u,wV:()=>d});var i=()=>n(69708);const s=(0,i().YK)({default:{id:"customizePageMenuVisibilitySelect.default.label",defaultMessage:"Default"},minimal:{id:"customizePageMenuVisibilitySelect.minimal.label",defaultMessage:"Minimal"}}),o={inline:s.default,minimal:s.minimal},a=(0,i().YK)({showOnHover:{id:"visibilityLevelMessages.backlinksPageSection.showOnHover",defaultMessage:"Show on hover"},alwaysShow:{id:"visibilityLevelMessages.backlinksPageSection.alwaysShow",defaultMessage:"Always show"},off:{id:"customizePageMenuVisibilitySelect.off.label",defaultMessage:"Off"}}),r={always_show:a.alwaysShow,section_show:a.showOnHover,section_collapsed:a.showOnHover,section_hide:a.off,inline:a.off,minimal:a.off},l=(0,i().YK)({asPageSection:{id:"customizePageMenuVisibilitySelect.section.label",defaultMessage:"As page section"},minimal:{id:"visibilityLevelMessages.propertyPageSection.minimal",defaultMessage:"Minimal"}}),d={inline:l.asPageSection,minimal:l.minimal},c=(0,i().YK)({alwaysShow:{id:"customizePageMenuVisibilitySelect.show.label",defaultMessage:"Always show"},alwaysHide:{id:"customizePageMenuVisibilitySelect.hide.label",defaultMessage:"Always hide"},hideWhenEmpty:{id:"customizePageMenuVisibilitySelect.hideIfEmpty.label",defaultMessage:"Hide when empty"},asPageSection:{id:"customizePageMenuVisibilitySelect.section.label",defaultMessage:"As page section"}}),u=(0,i().YK)({propertyVisibilityTitle:{id:"visibilityLevelMessages.propertyVisibility.title",defaultMessage:"Property visibility"}}).propertyVisibilityTitle,p={show:c.alwaysShow,hide:c.alwaysHide,hide_if_empty:c.hideWhenEmpty,section:c.asPageSection}},74464:(e,t,n)=>{n.d(t,{i:()=>o});n(296540);var i=()=>n(416783),s=n(474848);function o(e,t){return(0,s.jsx)(i().V,{href:e,children:t})}},87017:(e,t,n)=>{n.r(t),n.d(t,{duplicateBlocks:()=>k,duplicateBlocksWithMaybeConfirmation:()=>I,insertBlockAbove:()=>C,insertBlockAndEdit:()=>_,insertBlockBelow:()=>T,insertTextAbove:()=>B,insertTextBelow:()=>P});n(18107),n(944114),n(967357);var i=()=>n(135168),s=()=>n(908006),o=()=>n(905073),a=()=>n(206267),r=()=>n(496603),l=()=>n(855801),d=()=>n(669548),c=()=>n(822934),u=()=>n(391214),p=()=>n(838256),g=()=>n(962910),m=()=>n(807700),f=()=>n(920836),h=()=>n(3700),y=()=>n(799832),v=()=>n(516430),b=()=>n(471083),S=()=>n(518489),x=()=>n(836724),M=()=>n(206051),A=()=>n(77246),j=()=>n(957763),w=()=>n(547149);async function I(e){const{environment:t,blocks:n,duplicateOnlyCollectionSchema:o,callback:a,from:r}=e;if(!(0,j().E)(t,(0,i().f)(n[0])))return;const d=await l().VI.duplicateActions.load();let u=n;if(1===n.length){const e=await g().rW({environment:t,block:n[0],action:"duplicate"});if("user_canceled"===e)return void(null==a||a());u=e}const p=u.at(0);if(!p)return;const m=(0,y().U)(p);if(m&&(0,h().ls)(p,m))await f().un({blocks:u,environment:t,analyticsFrom:"subitem_duplication",callback:a,collectionContextStore:m});else{const{serverCommitResult:e}=w().createAndCommit({userAction:"actionRegistry.duplicateToSelection",environment:t,canUndo:!0,perform:e=>{k({environment:t,blocks:u,transaction:e,executionTarget:"local",duplicateOnlyCollectionSchema:o,duplicateActions:d,from:r})},transactionTooBigFallback:e=>{k({environment:t,blocks:u,transaction:e,executionTarget:"server",duplicateOnlyCollectionSchema:o,duplicateActions:d,from:r})}});e.then(a)}s().default.afterNextFlush((()=>{(0,c().B)({environment:t})}))}function k(e){const{environment:t,blocks:n,transaction:i,executionTarget:s,lastTopLevelBlockStore:o,preventSetSelection:a,duplicateOnlyCollectionSchema:l,duplicateActions:d,from:c}=e,p=r().$z(n,(e=>e.getFormat().app_id??e.id)),g=[];return r().jJ(p,(e=>{const n=e[0],{blockStores:o}=d.duplicateBlock({environment:t,stores:e,transaction:i,targetSpaceId:n.getSpaceId(),executionTarget:s,from:c,options:{addCopyName:!0,allowRedundancy:!1,deepCopyTransclusionContainers:!n.isTransclusionType(),resolveTemplateVariables:!(0,m().l)(n),duplicateOnlyCollectionSchema:l},skipUserFacingMessages:!1});g.push(...o)})),u().LE({blocksToInsert:g,target:o?[o]:n,environment:t,transaction:i,replaceEmptyTextBlock:!1,preventSetSelection:a}),g}function T(e){const{environment:t,createBlockItem:n,selection:s,transaction:o,analyticsFrom:a,preventSetSelection:r}=e,l=M().default.getCurrentRecordCache(),c=new(p().UF)({environment:t,userFlow:"page"===(null==n?void 0:n.blockType)?"user_flow_create_page":"user_flow_create_block",from:a,succeedOnEnqueue:!0});let g;if((0,j().E)(t,(0,i().f)(s[0]))&&n&&l){const e=d().w({environment:t,createBlockItem:n,transaction:o,inMemoryRecordCache:l,from:a,selection:s});c.track(e.pointer,o),g=u().LE({environment:t,blocksToInsert:[e],target:s,transaction:o,replaceEmptyTextBlock:!1,preventSetSelection:r})[0]}else c.fail("invalid_state");return g}function C(e){const{environment:t,createBlockItem:n,selection:s,transaction:o,analyticsFrom:a,preventSetSelection:r}=e,l=M().default.getCurrentRecordCache();let c;if((0,j().E)(t,(0,i().f)(s[0]))&&n&&l){const e=d().w({environment:t,createBlockItem:n,transaction:o,inMemoryRecordCache:l,from:a,selection:s});c=u().t1({environment:t,blocks:[e],selection:s,transaction:o,preventSetSelection:r})[0]}return c}function _(e){const{environment:t,selection:n,transaction:i}=e,s=T({...e,preventSetSelection:!0});if(s){var o;u().x5({environment:t,insertedStores:[s],isCreated:!0});const e=A().Uv.getMode(s);if("suggest"===e){const e=v().RR(t,i,s);v().tM(i,s,{id:a().JW(),type:"insert",discussionId:e.id}),v().c3({environment:t,transaction:i,discussionStore:e,addModifiedBlockIdsAfter:[s.id]})}"suggest"===e&&null!==(o=s.getNavigableBlockStore({skipCurrent:!0}))&&void 0!==o&&o.isCommentOnly()||u().um({transaction:i,blocks:n})}return s}function P(e){const{blocks:t,transaction:n,environment:i,skipAnalytics:a}=e,r=a?void 0:"text_insert_below",l=T({environment:i,selection:t,createBlockItem:b().ry.text,analyticsFrom:r,transaction:n});return l&&s().default.afterNextFlush((()=>{(0,o().z)({environment:i,blockStore:l,insertedTextBlockLocation:"below",editSelection:S().h,getRectFromStore:x().T.getRectFromStore.bind(x().T)})})),l}function B(e){const{blocks:t,transaction:n,environment:i,skipAnalytics:a}=e,r=a?void 0:"text_insert_below",l=C({environment:i,selection:t,createBlockItem:b().ry.text,analyticsFrom:r,transaction:n});return l&&s().default.afterNextFlush((()=>{(0,o().z)({environment:i,blockStore:l,insertedTextBlockLocation:"above",editSelection:S().h,getRectFromStore:x().T.getRectFromStore.bind(x().T)})})),l}},91669:(e,t,n)=>{n.d(t,{z:()=>s});class i extends(()=>n(757695))().Store{getInitialState(){return{isOpen:!1}}}const s=new i},94871:(e,t,n)=>{n.r(t),n.d(t,{initializeComplianceIntegrationStore:()=>m,refreshComplianceIntegrationStore:()=>g});n(898992),n(354520),n(581454);var i=()=>n(907258),s=()=>n(165358),o=()=>n(388821),a=()=>n(332393),r=()=>n(606219),l=()=>n(496603),d=()=>n(229833),c=()=>n(769864),u=()=>n(461232),p=()=>n(888526);async function g(e){const{sidebarSpaceStore:t}=i().default.state;t&&await m({environment:e.environment,spaceId:t.id,force:!0})}async function m(e){const{environment:t,spaceId:n,force:g}=e;if(!t.currentUser.id)return;await i().default.waitUntilRendered();const m=p().A.state;if(!m.loaded&&!m.loading||m.loaded&&n!==m.spaceId||g){p().A.setState({...p().A.state,loading:!0});const e=async()=>{const e=await c().callApi({eventName:"searchIntegrations",environment:t,data:{query:"",type:"compliance",spaceId:n}});return"success"!==e.type?(s().log({level:"error",from:"complianceIntegrationActions",type:"searchIntegrationsError",error:(0,d().convertErrorToLog)(e.error)}),{status:"rejected",error:e.error}):{status:"resolved",value:e}},i=async()=>{try{return{status:"resolved",value:await u().C({environment:t,spaceId:n})}}catch(e){return s().log({level:"error",from:"complianceIntegrationActions",type:"fetchWebhookSubscriptionsError",error:(0,d().convertErrorToLog)(e)}),{status:"rejected",error:e}}},[g,m]=await Promise.all([e(),i()]);if("rejected"===g.status||"rejected"===m.status)return;const{value:f}=g,{value:h}=m,y=o().RecordMapWithRole.create(f.data.recordMap),v=o().RecordMapWithRole.create(h.recordMap);p().A.setState({loaded:!0,loading:!1,spaceId:n,integrations:l().Ul(l().oE(f.data.integrationIds.map((e=>y.getModel({table:a().Li,id:e})))).filter(a().kC),(({created_at:e})=>e)),webhookSubscriptions:l().oE(h.webhookSubscriptionIds.map((e=>v.getModel({table:r().TF,id:e,spaceId:n}))))})}}},94985:(e,t,n)=>{n.d(t,{u5:()=>T});var i=n(296540),s=()=>n(401497),o=()=>n(699143),a=()=>n(718827),r=()=>n(807449),l=()=>n(265060),d=()=>n(493552),c=()=>n(26697),u=()=>n(842599),p=()=>n(568999),g=()=>n(835470),m=()=>n(822423),f=()=>n(888867),h=()=>n(120251),y=()=>n(792071),v=()=>n(798880),b=()=>n(69708),S=()=>n(100622),x=()=>n(534177),M=()=>n(453697),A=()=>n(698449),j=()=>n(308227),w=()=>n(717162),I=n(474848);const k=(0,b().YK)({autojoinMember:{defaultMessage:"{email} will automatically be added to the workspace since @{domain} is an allowed email domain",id:"inviteTargetToken.autojoinMember.tooltip"},guestsDisabledMember:{defaultMessage:"Since guests are disabled, {email} will automatically be added to the workspace as a member",id:"inviteTargetToken.guestsDisabledMember.tooltip"},guestV2:{defaultMessage:"Invite {email} as a guest",id:"inviteTargetToken.guest.tooltipV2"},guestRequest:{id:"inviteTargetToken.guestRequest.tooltip",defaultMessage:"This guest must be approved by a workspace owner first"},restrictedMemberRequest:{id:"inviteTargetToken.restrictedMemberRequest.tooltip",defaultMessage:"This restricted member must be approved by a workspace owner first"},invalidUser:{defaultMessage:"{text} is not a valid email",id:"inviteTargetToken.invalidUser.tooltip"},overInternalGuestLimit:{id:"inviteTargetToken.overInternalGuestLimit.tooltip",defaultMessage:"This workspace has reached its internal guest limit"},disabledByAdmins:{id:"inviteTargetToken.disabledByAdmins.tooltip",defaultMessage:"Inviting users has been disabled by admins for this page"},restrictedMembersdisabledByAdmins:{id:"inviteTargetToken.restrictedMembersdisabledByAdmins.tooltip",defaultMessage:"Inviting restricted members has been disabled by admins for this page"},restrictedMemberInsufficientRole:{id:"inviteTargetToken.restrictedMemberInsufficientRole.tooltip",defaultMessage:"You do not have permission to add restricted members to this page"},noRestrictedMembersForWorkflows:{id:"inviteTargetToken.noRestrictedMembersForWorkflows.tooltip",defaultMessage:"Restricted members cannot be invited to custom agents"},notAuthorizedDomain:{id:"inviteTargetToken.notAuthorizedDomain.tooltip",defaultMessage:"{email} does not belong to an allowed email domain"}});function T(e){const{inviteTarget:t,defaultAddability:n,onClickRemove:s}=e,r=function(e,t){if("invalidUser"===e.type)return"red";if(void 0===t)return"red";if("member"===t.type)return"autojoin_domain"===t.reason||"guests_disabled"===t.reason?"green":"over_internal_guest_limit"===t.reason?"yellow":(0,x().HB)(t.reason);if("group"===t.type)return"gray";if("member_request"===t.type)return"red";if("member_page_add"===t.type)return"gray";if("guest"===t.type)return"yellow";if("guest_request"===t.type)return"yellow";if("guest_page_add"===t.type)return"yellow";if("restricted_member_request"===t.type)return"yellow";if("none"===t.type){if("must_upgrade"===t.reason)return"yellow";if("over_internal_guest_limit"===t.reason)return"red";if("over_general_guest_limit"===t.reason)return"red";if("disabled_by_admins"===t.reason)return"red";if("restricted_members_disabled_by_admins"===t.reason)return"red";if("restricted_member_insufficient_role"===t.reason)return"red";if("no_restricted_members_for_workflows"===t.reason)return"red";if("not_authorized_domain"===t.reason)return"red";if("invalid_email"===t.reason)return"red";if("other"===t.reason)return"red";(0,x().HB)(t.reason)}else(0,x().HB)(t)}(t,n),p=(0,b().tz)(),g=_(r),m=(0,i.useCallback)((()=>{s(t)}),[t,s]),f=function(e){const{inviteTarget:t,defaultAddability:n,intl:i}=e,s=(0,w().K0)(t),o=t.type;if("invalidUser"===o)return i.formatMessage(k.invalidUser,{text:t.value.text});if(!s&&"group"!==o)return;if(void 0===n)return;if("none"===n.type){if("must_upgrade"===n.reason)return;if("other"===n.reason)return;if("over_internal_guest_limit"===n.reason)return i.formatMessage(k.overInternalGuestLimit);if("over_general_guest_limit"===n.reason)return i.formatMessage(k.overInternalGuestLimit);if("disabled_by_admins"===n.reason)return i.formatMessage(k.disabledByAdmins);if("restricted_members_disabled_by_admins"===n.reason)return i.formatMessage(k.restrictedMembersdisabledByAdmins);if("restricted_member_insufficient_role"===n.reason)return i.formatMessage(k.restrictedMemberInsufficientRole);if("no_restricted_members_for_workflows"===n.reason)return i.formatMessage(k.noRestrictedMembersForWorkflows);if("not_authorized_domain"===n.reason)return i.formatMessage(k.notAuthorizedDomain,{email:s});if("invalid_email"===n.reason)return i.formatMessage(k.invalidUser,{text:"unknown"});(0,x().HB)(n.reason)}if("member"===n.type)return"autojoin_domain"===n.reason?i.formatMessage(k.autojoinMember,{email:s,domain:(0,u().zN)(s)}):"guests_disabled"===n.reason?i.formatMessage(k.guestsDisabledMember,{email:s}):"over_internal_guest_limit"===n.reason?s:(0,x().HB)(n.reason);if("group"===n.type)return;if("member_request"===n.type)return i.formatMessage(k.disabledByAdmins);if("member_page_add"===n.type)return s;if("guest"===n.type)return i.formatMessage(k.guestV2,{email:s});if("guest_request"===n.type)return i.formatMessage(k.guestRequest);if("guest_page_add"===n.type)return i.formatMessage(k.guestV2,{email:s});if("restricted_member_request"===n.type)return i.formatMessage(k.restrictedMemberRequest);(0,x().HB)(n)}({inviteTarget:t,defaultAddability:n,intl:p});return(0,I.jsx)(c().m,{placement:"top",renderTooltip:()=>f,disableTooltip:!f,render:e=>(0,I.jsx)("div",{style:{maxWidth:"100%"},...e,children:(0,I.jsxs)(o().Y1,{gap:2,style:g.token,borderRadius:4,padding:"2px 4px",width:"hug",children:[(0,I.jsxs)(o().Y1,{align:"center-left",borderRadius:3,direction:"horizontal",gap:4,width:"hug",children:[(0,I.jsx)(C,{inviteTarget:t,tokenColor:r}),(0,I.jsx)(d().D,{colorPalette:r,colorVariant:"primary",styleKey:"bodyRegular",style:g.label,children:D(t,p)}),(0,I.jsx)(a().Ay,{hoveredStyle:g.removeButtonHovered,pressedStyle:g.removeButtonPressed,onClick:m,children:(0,I.jsx)(l().Q,{iconGroup:h().k,colorVariant:"secondary",variantName:"small"})})]}),(0,I.jsx)(j().A,{featureGateId:"guest_limit_debug_ui",whenEnabled:(0,I.jsx)("div",{style:{marginInlineStart:24,paddingBottom:2},children:(0,I.jsx)(d().D,{colorVariant:"secondary",styleKey:"captionMedium",children:null==n?void 0:n.type})}),whenDisabled:null})]})})})}function C(e){const{inviteTarget:t,tokenColor:n}=e,i=_(n);switch(n){case"green":return(0,I.jsx)(l().Q,{iconGroup:p().g,colorPalette:"green",colorVariant:"accentPrimary",variantName:"small"});case"yellow":return(0,I.jsx)(l().Q,{iconGroup:m().u,colorPalette:"yellow",colorVariant:"accentPrimary",variantName:"small"});case"red":return(0,I.jsx)(l().Q,{iconGroup:g().F,colorPalette:"red",colorVariant:"accentPrimary",variantName:"small"});case"gray":return"existingUser"===t.type?(0,I.jsx)(o().Y1,{align:"center",width:20,height:20,children:(0,I.jsx)(M().A,{userValue:t.value,size:16})}):(0,I.jsx)("div",{style:i.iconCircle,children:(0,I.jsx)(r().I,{icon:f().s,size:"xxs",colorVariant:"secondary"})});default:(0,x().HB)(n)}}function _(e){return(0,s().IS)((()=>({token:P(e),iconCircle:{alignItems:"center",backgroundColor:S().Tj.white,borderRadius:"50%",display:"flex",height:16,justifyContent:"center",width:16},label:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},removeButtonHovered:{background:"transparent",opacity:.8},removeButtonPressed:{background:"transparent",opacity:.6}})),[e])}function P(e){return{background:B(e),border:R(e)}}function B(e){switch(e){case"green":return S().Tj.green.background.secondary;case"yellow":return S().Tj.yellow.background.secondary;case"red":return S().Tj.red.background.secondary;case"gray":return S().Tj.legacyDefaultSelectColor;default:(0,x().HB)(e)}}function R(e){switch(e){case"red":return`1px dashed ${S().Tj.red.border.strong}`;case"green":case"yellow":case"gray":return;default:(0,x().HB)(e)}}function D(e,t){const{type:n}=e;switch(n){case"newUser":return e.value.email.trim();case"invalidUser":return e.value.text.trim();case"existingUser":return y().Bj6.fromValue(v().oo,e.value).getDisplayName(t);case"group":return(0,A().Pf)({intl:t,groupName:e.value.name});default:(0,x().HB)(n)}}},95001:(e,t,n)=>{n.d(t,{aR:()=>O,oq:()=>V,zM:()=>F});var i=n(296540),s=()=>n(59226),o=()=>n(726637),a=()=>n(484714),r=()=>n(590526),l=()=>n(401497),d=()=>n(882722),c=()=>n(807449),u=()=>n(695115),p=()=>n(265060),g=()=>n(463438),m=()=>n(302501),f=()=>n(473119),h=()=>n(879765),y=()=>n(995847),v=()=>n(206267),b=()=>n(187859),S=()=>n(350527),x=()=>n(703888),M=()=>n(68263),A=()=>n(179034),j=()=>n(69708),w=()=>n(100622),I=()=>n(534177),k=()=>n(284371),T=()=>n(703875),C=()=>n(115512),_=()=>n(477293),P=()=>n(676870),B=()=>n(525700),R=()=>n(380682),D=()=>n(437487),L=n(474848);const E=(0,j().YK)({seo:{defaultMessage:"Search engine indexing",id:"publishSiteSettings.SEO.title"},seoDiscoverableOnWeb:{defaultMessage:"Discoverable on the web",id:"publishSiteSettings.SEO.title.v2"},embed:{defaultMessage:"Embed this page",id:"embedSiteSettings.title"},shareOnSocial:{defaultMessage:"Share via social",id:"shareMenu.shareOnSocial"}});function O({store:e,inviteTargetsStore:t,mostPermissivePublicItem:n}){const{display:i,source:o}=(0,r().K8)((()=>{const{display:e}=D().Ay.state;if(e===D().pP.Invite){const{source:t}=D().Ay.state;return{display:e,source:t}}return{display:e,source:void 0}}),[]),a=(0,s().X)("marketplace_custom_agent_submission");switch(i){case D().pP.MainShareMenu:case D().pP.Publish:return e.table===A().ev||a?(0,L.jsx)(F,{store:e,mostPermissivePublicItem:n}):null;case D().pP.Invite:if("notion"===o)return(0,L.jsx)(U,{inviteTargetsStore:t});if("slack"===o||"google"===o||"microsoft"===o)return(0,L.jsx)(z,{source:o});throw(0,I().HB)(o);default:(0,I().HB)(i)}}const N=[D().QC.Share,D().QC.Publish];function F({store:e,mostPermissivePublicItem:t}){const n=(0,a().v3)(),u=i.useRef(null),p=(0,r().K8)((()=>(0,M().W8)(t.permissionItem)),[t.permissionItem]),m=(0,s().X)("polish_publish_menu")&&!o().A.isMobile;(0,i.useEffect)((()=>{const e=D().Ay.state,t=e.tab===D().QC.Share&&e.display===D().pP.MainShareMenu?e.source:void 0;p&&t!==D().mc.InviteBackButton&&(D().Ay.setState({tab:D().QC.Publish,display:D().pP.Publish,sessionId:v().JW(),isInitialized:!0}),(0,P().EN)(n,{source:"share_button"}))}),[n,p]);const h=(0,r().K8)((()=>D().Ay.state.tab),[]),y=(0,l().IS)((()=>({tabStyle:{color:w().Tj.text.tertiary,...o().A.isMobile&&{width:"50%",textAlign:"center"}},selectedTabStyle:{},tabTitleStyle:{color:"inherit",fontSize:C().vQ,fontWeight:k().Wy.medium},style:o().A.isMobile?{marginBottom:8,justifyContent:"space-between"}:{marginBottom:16,paddingInlineStart:m?12:16},tabBorderStyle:{insetInlineStart:0,insetInlineEnd:0}})),[m]),b=(0,l().eP)(),S=(0,l().IS)((()=>({tabStyle:{width:"50%",textAlign:"center",borderRadius:10,color:w().Tj.text.secondary,fontWeight:k().Wy.regular,paddingTop:2,paddingBottom:2},tabBorderStyle:{borderBottom:"none"},selectedTabStyle:{borderRadius:8,background:"dark"===b?w().Tj.background.tertiaryTranslucent:w().Tj.background.elevated},tabTitleStyle:{color:"inherit",fontSize:C().vQ,fontWeight:k().Wy.regular},selectedTabTitleStyle:{fontWeight:k().Wy.medium},style:{justifyContent:"space-between",padding:2,background:w().Tj.background.tertiaryTranslucent,borderRadius:10,marginBottom:0,height:34}})),[b]),x=(0,l().IS)((()=>({publishTabContainer:{display:"flex",alignItems:"center",gap:4},publishIcon:{opacity:h===D().QC.Publish?1:.5},tabBarContainer:{paddingInlineStart:20,paddingInlineEnd:20,paddingTop:8,paddingBottom:16,backgroundColor:o().A.isMobile?w().Tj.background.secondary:w().Tj.background.primary}})),[h]),A=(0,i.useCallback)((e=>{const t=N[e];t!==h&&(T().N(n,{tab:t}),t===D().QC.Share&&D().Ay.setState({...D().Ay.state,display:D().pP.MainShareMenu,tab:D().QC.Share,source:D().mc.ShareTab}),t===D().QC.Publish&&(D().Ay.setState({...D().Ay.state,display:D().pP.Publish,tab:D().QC.Publish}),(0,P().EN)(n,{source:"share_tab_click"})))}),[h,n]),I=[(0,L.jsx)(i.Fragment,{children:(0,L.jsx)(j().sA,{defaultMessage:"Share",id:"shareMenu.shareTab.title"},"share")},"title"),(0,L.jsxs)("div",{ref:u,style:x.publishTabContainer,className:d().hKK,children:[(0,L.jsx)(j().sA,{defaultMessage:"Publish",id:"shareMenu.publishTab.title"},"publish"),p?(0,L.jsx)(c().I,{icon:f().c,size:"sm",colorPalette:"blue",colorVariant:"accentPrimary",type:"animated",animationState:"animate",style:x.publishIcon}):void 0]},"publishTab")],_=(0,r().K8)((()=>R().A.state.siteSettingContentType),[]);return"seo"===_?(0,L.jsx)(q,{}):"embed"===_?(0,L.jsx)(W,{handleBackButtonClick:()=>{B().Bp("initial")}}):"social"===_?(0,L.jsx)(G,{handleBackButtonClick:()=>{B().Bp("initial")}}):o().A.isMobile?(0,L.jsx)("div",{style:x.tabBarContainer,children:(0,L.jsx)(g().LZ,{...S,tabs:I,selectedIndex:N.indexOf(h),onChange:A,hideTabBorder:!0})}):(0,L.jsx)(g().LZ,{...y,tabs:I,selectedIndex:N.indexOf(h),onChange:A})}function U({inviteTargetsStore:e}){const t=(0,l().IS)((()=>({container:{display:"flex",paddingInlineStart:12,paddingInlineEnd:12,marginBottom:16,height:40,boxShadow:`inset 0 -1px 0 ${w().Tj.border.secondaryTranslucent}`}})),[]),n=(0,i.useCallback)((()=>{e.reset(),D().Ay.setState({...D().Ay.state,display:D().pP.MainShareMenu,tab:D().QC.Share,source:D().mc.InviteBackButton})}),[e]);return(0,L.jsx)("div",{style:t.container,children:(0,L.jsx)(V,{onClick:n,titleMessage:(0,L.jsx)(j().sA,{id:"shareMenu.sendInvite.labelV2",defaultMessage:"Invite"})})})}function z(e){const{source:t}=e,n=(0,j().tz)(),s=(0,l().IS)((()=>({container:{display:"flex",justifyContent:"space-between",margin:"0 12px",height:48,alignItems:"center"},titleLabel:{display:"flex",fontSize:12,alignItems:"center",fontWeight:k().Wy.semibold}})),[]),o=(0,i.useCallback)((()=>{D().Ay.setState({...D().Ay.state,tab:D().QC.Share,display:D().pP.Invite,source:D().NL.Notion,focus:D().yZ.Search,emailMessage:""})}),[]);return(0,L.jsxs)("div",{style:s.container,children:[(0,L.jsx)(m().A,{style:s.titleLabel,children:(0,L.jsx)(j().sA,{id:"shareMenu.addFromSlack.label",defaultMessage:"Add people from {integrationNameWithLogo}",values:{integrationNameWithLogo:(0,L.jsx)(K,{source:t})}})}),(0,L.jsx)(u().A,{ariaLabel:n.formatMessage({id:"shareMenuHeader.goBackToInviteFromNotionMenu.iconButton",defaultMessage:"Close external integration and go back to the main invite flow."}),icon:y().xMarkSmallIcon,style:{borderRadius:"100%"},onClick:o})]})}function K({source:e}){const t=(0,l().IS)((()=>({imageStyle:{marginInlineStart:4,marginInlineEnd:4}})),[]),n="control"!==(0,_().r)("microsoft_contacts_import");return e===D().NL.Slack?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(p().Q,{iconGroup:x().j,variantName:"default",overrideSize:()=>16,style:t.imageStyle}),(0,L.jsx)(j().sA,{defaultMessage:"Slack",id:"shareMenu.slackIntegrationName.label"})]}):e===D().NL.Google?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(p().Q,{iconGroup:b().m,variantName:"default",overrideSize:()=>16,style:t.imageStyle}),(0,L.jsx)(j().sA,{defaultMessage:"Google",id:"shareMenu.googleContactsIntegrationName.label"})]}):e===D().NL.Microsoft?n?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(p().Q,{iconGroup:S().g,variantName:"default",overrideSize:()=>16,style:t.imageStyle}),(0,L.jsx)(j().sA,{defaultMessage:"Microsoft",id:"shareMenu.microsoftContactsIntegrationName.label"})]}):null:void(0,I().HB)(e)}function V(e){const{onClick:t,titleMessage:n}=e,i=(0,j().tz)(),s=(0,l().IS)((()=>({topContainer:{display:"flex",alignItems:"center",width:"max-content"},iconButton:{marginInlineEnd:6,height:24,width:24},arrowIcon:{height:20,width:20,strokeWidth:k().Wy.semibold},sendInviteLabel:{fontWeight:k().Wy.medium,fontSize:C().vQ}})),[]);return(0,L.jsxs)("div",{style:s.topContainer,children:[(0,L.jsx)(u().A,{icon:h().$,iconStyle:s.arrowIcon,style:s.iconButton,onClick:t,ariaLabel:i.formatMessage({id:"shareMenu.backButton.iconButton",defaultMessage:"Go back to main share menu."})}),(0,L.jsx)(m().A,{style:s.sendInviteLabel,children:n})]})}function q(){const e=(0,l().IS)((()=>({container:{display:"flex",paddingTop:0,paddingInlineEnd:12,paddingBottom:0,paddingInlineStart:8,height:40,borderBottom:`1px solid ${w().Tj.border.secondary}`}})),[]),t="on"===(0,_().r)("turn_on_seo_indexing_setting_on_sites_v2"),n=(0,i.useCallback)((()=>{B().Bp("initial")}),[]);return(0,L.jsx)("div",{style:e.container,children:(0,L.jsx)(V,{onClick:n,titleMessage:(0,L.jsx)(j().sA,{...t?E.seoDiscoverableOnWeb:E.seo})})})}function W(e){const t=(0,l().IS)((()=>({container:{display:"flex",paddingTop:0,paddingInlineEnd:12,paddingBottom:0,paddingInlineStart:8,height:40,borderBottom:`1px solid ${w().Tj.border.secondary}`}})),[]);return(0,L.jsx)("div",{style:t.container,children:(0,L.jsx)(V,{onClick:e.handleBackButtonClick,titleMessage:(0,L.jsx)(j().sA,{...E.embed})})})}function G(e){const t=(0,l().IS)((()=>({container:{display:"flex",paddingTop:0,paddingInlineEnd:12,paddingBottom:0,paddingInlineStart:8,height:40,borderBottom:`1px solid ${w().Tj.border.secondary}`}})),[]);return(0,L.jsx)("div",{style:t.container,children:(0,L.jsx)(V,{onClick:e.handleBackButtonClick,titleMessage:(0,L.jsx)(j().sA,{...E.shareOnSocial})})})}},102727:(e,t,n)=>{n.d(t,{A:()=>i});const i=new(n(118307).A)},103674:(e,t,n)=>{n.d(t,{A:()=>s});class i extends(()=>n(757695))().Store{getInitialState(){return{permissionsInviteStore:(0,n(406999)._P)(),contextualInviteStore:new(n(159026).Ay)}}get stageFromStoreState(){return this.state.contextualInviteStore.state.inviteStage}}const s=i},104115:(e,t,n)=>{n.d(t,{Ox:()=>k,ei:()=>j,gO:()=>A,jw:()=>T,s:()=>M});n(296540);var i=()=>n(564884),s=()=>n(484714),o=()=>n(401497),a=()=>n(160432),r=()=>n(493552),l=()=>n(148307),d=()=>n(8741),c=()=>n(90907),u=()=>n(835607),p=()=>n(737693),g=()=>n(340498),m=()=>n(734459),f=()=>n(713996),h=()=>n(69708),y=()=>n(100622),v=()=>n(534177),b=()=>n(246766),S=()=>n(298506),x=n(474848);function M({organizationOnboardingInfo:e}){const t=(0,s().v3)(),n=k(),i=(0,h().tz)();if(!e||"ineligible"===e.onboardingStatus)return null;const{buttonLabel:o,onClick:c}=A({environment:t,organizationOnboardingInfo:e});return(0,x.jsxs)("div",{style:n.bannerContainer,children:[(0,x.jsxs)("div",{style:n.title,children:[(0,x.jsx)("img",{src:l().A.images.onboarding.planTypeForWorkSplitIntentDarkmodePng,style:{height:77,width:77},alt:"Organization onboarding icon"}),(0,x.jsx)(r().D,{styleKey:"titleLgSemibold",children:i.formatMessage(T.title)}),(0,x.jsx)(r().D,{styleKey:"bodyRegular",colorVariant:"secondary",children:i.formatMessage(T.byline)})]}),(0,x.jsx)(j,{}),(0,x.jsx)(a().A,{colorPalette:"blue",size:"lg",style:n.button,onClick:c,iconTrailing:{icon:d().arrowDiagonalUpRightSmallIcon,size:"sm"},children:o})]})}function A({environment:e,organizationOnboardingInfo:t}){switch(t.onboardingStatus){case"not_started":return{buttonLabel:(0,x.jsx)(h().sA,{id:"workspaceSettingsModal.organizationsBanner.startSetUpButton",defaultMessage:"Set up organization"}),onClick:()=>{(0,i().u)({environment:e,event:{eventName:"org_console_onboarding_navigate",eventProperties:{spaceId:t.spaceId,route:f()._P.name,from:"settings-modal-banner"}}}),(0,b().navigate)({environment:e,openInNew:"tab",makeTabActive:!0,url:(0,m().re)({organizationId:m().Zf,tabRoute:f()._P,queryParams:{[S().g]:t.spaceId}})})}};case"domain_verified":case"domain_verification_skipped":return{buttonLabel:(0,x.jsx)(h().sA,{id:"workspaceSettingsModal.organizationsBanner.finishSetUpButton",defaultMessage:"Finish set up"}),onClick:()=>{(0,i().u)({environment:e,event:{eventName:"org_console_onboarding_navigate",eventProperties:{organizationId:t.organizationId,route:f()._P.name,from:"settings-modal-banner"}}}),(0,b().navigate)({environment:e,openInNew:"tab",makeTabActive:!0,url:(0,m().re)({organizationId:t.organizationId,tabRoute:f()._P})})}};case"completed":return{buttonLabel:(0,x.jsx)(h().sA,{id:"workspaceSettingsModal.organizationsBanner.orgSettingsButton",defaultMessage:"Go to organization console"}),onClick:()=>{(0,b().navigate)({environment:e,openInNew:"tab",makeTabActive:!0,url:(0,m().re)({organizationId:t.organizationId,tabRoute:f().Vo})})}};default:(0,v().HB)(t)}}function j(){const e=k();return(0,x.jsxs)("div",{style:e.features,children:[(0,x.jsx)(I,{icon:c().lockIcon,description:(0,x.jsx)(h().sA,{id:"workspaceSettingsModal.organizationsBanner.owner.item.organizationOwnerRole",defaultMessage:"<blue>A new organization owner role</blue> manages all workspace settings and owner permissions.",values:{blue:(...e)=>(0,x.jsx)(w,{chunks:e})}})}),(0,x.jsx)(I,{icon:p().V,description:(0,x.jsx)(h().sA,{id:"workspaceSettingsModal.organizationsBanner.owner.item.organizationWideVisibility",defaultMessage:"<blue>Organization-wide visibility</blue> of people, sharing and security settings, and audit logs all in one place.",values:{blue:(...e)=>(0,x.jsx)(w,{chunks:e})}})}),(0,x.jsx)(I,{icon:u().F,description:(0,x.jsx)(h().sA,{id:"workspaceSettingsModal.organizationsBanner.owner.item.simplifiedSettingsManagement",defaultMessage:"<blue>Simplified settings management</blue> across organization, workspace, and teamspace levels.",values:{blue:(...e)=>(0,x.jsx)(w,{chunks:e})}})})]})}function w(e){return(0,x.jsx)(r().D,{styleKey:"bodyMedium",colorPalette:"blue",colorVariant:"accentPrimary",as:"span",children:e.chunks})}function I(e){const t=(0,o().IS)((()=>({container:{display:"flex",alignItems:"flex-start",justifyContent:"center",flexDirection:"row",gap:8},icon:{fill:y().Tj.blue.icon.accentPrimary,height:g().Ev.default,width:g().Ev.default}})),[]);return(0,x.jsxs)("div",{style:t.container,children:[e.icon(t.icon),(0,x.jsx)(r().D,{styleKey:"bodyRegular",colorVariant:"secondary",children:e.description})]})}function k(){const e=(0,o().eP)();return(0,o().IS)((()=>({bannerContainer:{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"flex-start",gap:20,padding:24,borderRadius:12,marginBlock:12,background:"dark"===e?y().Tj.background.secondaryTranslucent:"#F0F6FD"},title:{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"flex-start",gap:6,width:"100%"},features:{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"center",gap:10,width:"100%"},icon:{height:16,width:16,fill:y().Tj.icon.secondary},button:{display:"flex",alignItems:"center",justifyContent:"center",gap:4}})),[e])}const T=(0,h().YK)({title:{id:"organization.onboarding.modal.title",defaultMessage:"Get more from your Enterprise plan"},titleLimited:{id:"organization.onboarding.modal.title.limited",defaultMessage:"Get more from your Enterprise Limited plan"},byline:{id:"organization.onboarding.modal.byline",defaultMessage:"Get a bird’s-eye view of members, guests, and security settings across all your workspaces."}})},105062:(e,t,n)=>{n.r(t),n.d(t,{checkmarkShieldSmallIcon:()=>o,iconDefinition:()=>s});n(296540);var i=n(474848);const s={viewBox:"0 0 16 16",fittedViewBox:"2.78 2.12 10.44 11.75",svg:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{d:"M10.172 5.564a.625.625 0 0 0-.858.214L7.36 9.035 6.325 7.827a.625.625 0 1 0-.95.813l1.6 1.867a.625.625 0 0 0 1.01-.085l2.4-4a.625.625 0 0 0-.213-.858"}),(0,i.jsx)("path",{d:"M8.28 2.191a.63.63 0 0 0-.56 0l-.962.481a7.25 7.25 0 0 1-3.242.765h-.11a.625.625 0 0 0-.625.626v4.333a5 5 0 0 0 3.03 4.596l1.943.832a.63.63 0 0 0 .492 0l1.942-.832a5 5 0 0 0 3.03-4.596V4.062a.625.625 0 0 0-.624-.625h-.11a7.25 7.25 0 0 1-3.242-.765zm-.963 1.6L8 3.448l.683.341a8.5 8.5 0 0 0 3.286.882v3.724a3.75 3.75 0 0 1-2.273 3.447L8 12.57l-1.696-.727a3.75 3.75 0 0 1-2.273-3.447V4.672a8.5 8.5 0 0 0 3.286-.882"})]})},o=(0,n(340498).wt)("checkmarkShieldSmall",s,"small")},105855:(e,t,n)=>{n.d(t,{e:()=>a});var i=()=>n(907258),s=()=>n(547149),o=()=>n(680977);function a(e){const{currentUserSettingsStore:t}=i().default.state;if(!t)return;const{environment:n,dismissed:a}=e;s().createAndCommit({environment:n,userAction:"userSettingsActions.setDismissedSuggestModeTooltip",canUndo:!0,cellTarget:"main",perform:e=>{(0,o().m)({userSettingsStore:t,transaction:e,data:{dismissed_suggest_mode_tooltip:a}})}})}},110573:(e,t,n)=>{n.d(t,{E:()=>s});n(898992),n(354520),n(737550);var i=()=>n(365917);const s=new(n(140934).ComputedStore)((()=>{var e;const{sidebarSpaceViewStore:t}=n(907258).default.state;if(!t||!t.isReady())return{loading:!0,botId:void 0,botSpaceId:void 0,botUserId:void 0};const s=t.getSelectedCalendarBotId();if(s&&!i().A.state.loaded)return{loading:!1,botId:s,botSpaceId:t.getSpaceId(),botUserId:t.getUserId()};const{spaceId:o,userId:a}=i().A.state.loaded?i().A.state:{spaceId:void 0,userId:void 0},r=i().A.bots.state.filter((e=>e.integration_id===n(617871).io)),l=null===(e=r[0])||void 0===e?void 0:e.id,d=s&&r.some((e=>e.id===s))?s:l;return{loading:!i().A.state.loaded||i().A.state.loading,botId:d,botSpaceId:o,botUserId:a}}),{debugName:"CalendarBotIdStore"})},122001:(e,t,n)=>{n.d(t,{f:()=>r});var i=()=>n(611648),s=()=>n(494305),o=()=>n(712505),a=()=>n(747100);function r(e){const{environment:t,store:n}=e;return n.isCollectionView()?(0,s().z)(t)?i().A.All:i().A.Y:!a().cq(n)&&o().default.isSidePeekOpen()?i().A.All:i().A.Y}},136805:(e,t,n)=>{n.r(t),n.d(t,{TopbarShareButton:()=>B,messages:()=>k});var i=n(296540),s=()=>n(726637),o=()=>n(383036),a=()=>n(590526),r=()=>n(401497),l=()=>n(929219),d=()=>n(882722),c=()=>n(250910),u=()=>n(807449),p=()=>n(631524),g=()=>n(26697),m=()=>n(12193),f=()=>n(864896),h=()=>n(69708),y=()=>n(100622),v=()=>n(904671),b=()=>n(321172),S=()=>n(623275),x=()=>n(437487),M=()=>n(326589),A=()=>n(35392),j=()=>n(978578),w=()=>n(863059),I=n(474848);const k=(0,h().YK)({share:{defaultMessage:"Share",id:"topbar.share"}});function T({store:e,buttonPopupStore:t}){const o=(0,n(484714).v3)(),l=(0,a().K8)((()=>o.device.isTablet),[o]),d=(0,a().uB)(void 0,n(103674).A),u=(0,a().uB)(void 0,n(114871).Ay),p=(0,a().uB)(void 0,n(454354).A),g=(0,a().K8)((()=>function(e,t){if(t.shouldUserHaveAccessToPrivatePageBlock()&&t.state.changePermissionsEnabled&&t.state.privatePageStore&&t.state.privatePageStore.id===e.id)return t.state.privatePageStore;return e}(e,p)),[e,p]),m=(0,a().K8)((()=>e.canAdmin()),[e]),f=(0,a().K8)((()=>!s().A.isMobile&&function(e,t){const{permissionsInviteStore:n}=e.state;return n.state.inviteTargets.length>0||t.state.inviteTargets.length>0}(d,u)),[u,d]),h=(0,a().K8)((()=>{var e;return null===(e=p.state.privatePageStore)||void 0===e?void 0:e.id}),[p]),A=(0,a().K8)((()=>(0,n(135168).f)(e)),[e]);(0,i.useEffect)((()=>{!function({environment:e,store:t,sudoModeStore:n,canAdmin:i,currentSpaceStore:s}){var o;null!==(o=n.state.privatePageStore)&&void 0!==o&&o.id&&n.state.privatePageStore.id!==t.id&&n.reset();i||v().BX({environment:e,sudoModeStore:n,pageBlockId:t.id,sidebarSpaceStore:s})}({environment:o,sudoModeStore:p,store:e,canAdmin:m,currentSpaceStore:A})}),[m,o,e,p,h,A]),(0,i.useEffect)((()=>{x().Ay.setState({...x().Ay.state,isInitialized:!0})}));const j=(0,i.useCallback)((()=>{t.reset()}),[t]),w=(0,i.useCallback)((()=>{P({buttonPopupStore:t,universalMemberInviteStore:d,inviteTargetsStore:u}),(0,n(440024).I)({environment:o}),b().Tk({environment:o,store:e}),(0,M().g)()||n(224701).x(o)}),[t,d,u,o,e]),k=(0,a().K8)((()=>{const t=e.getPublicPermission();if(!t||!(0,n(68263).W8)(t))return!1;const i=e.getSpaceStore();return!!i&&i.getSettings().hide_sites_banner}),[e]),T=(0,i.useCallback)((e=>(0,I.jsx)(C,{buttonPopupEvents:e,handleClick:w,shouldShowGlobeIcon:k})),[w,k]),_=(0,i.useCallback)((async()=>{if(u.state.inviteTargets.length>0){return void(await b().T({environment:o,inviteTargetsStore:u})&&(b().XP({environment:o,store:e}),P({buttonPopupStore:t,universalMemberInviteStore:d,inviteTargetsStore:u})))}const{permissionsInviteStore:i}=d.state;"invitee"===i.state.inputFocus&&i.setState({...i.state,inputFocus:"none"});await(0,n(743260).iQ)({environment:o,permissionsInviteStoreState:i.state,from:"share_menu",spaceStore:A})||(b().XP({environment:o,store:e}),P({buttonPopupStore:t,universalMemberInviteStore:d,inviteTargetsStore:u}))}),[t,o,u,d,e,A]),B=(0,r().IS)((()=>({buttonPopup:{...s().A.isMobile?{width:"100%"}:l?{width:460}:{width:S().$D,overflow:"hidden",borderRadius:S().Sg,boxShadow:y().Tj.shadowMD}}})),[l]);return(0,I.jsx)(c().A,{popupType:s().A.isMobile?c().z.SlideUp:c().z.Popup,forceInitialInbound:!0,buttonPopupStore:t,renderOrigin:T,originGap:s().A.isMobile?void 0:8,alignmentToOrigin:"end",style:B.buttonPopup,onClick:w,render:()=>(0,I.jsx)(n(482707).k,{buttonPopupStore:t,sudoModeStore:p,store:g,inviteTargetsStore:u,universalMemberInviteStore:d,onUpgradeButtonClick:j,location:s().A.isMobile?"topbar_mobile":"topbar_share_button",onClose:_}),persistOnClose:f,onDismiss:_,onClose:_})}function C({buttonPopupEvents:e,handleClick:t,shouldShowGlobeIcon:n,disabled:d}){const c=!(0,a().O$)(l().e),u=(0,a().K8)((()=>(0,M().g)()),[]),p=(0,r().IS)((()=>({shortcut:{color:y().Tj.text.inverseSecondary}})),[]),m=d||c,f=(0,i.useCallback)((()=>{const e=c?(0,I.jsx)(h().sA,{defaultMessage:"Unavailable while offline",id:"topbar.shareButton.offlineTooltip"}):(0,I.jsx)(h().sA,{defaultMessage:"Create or join a workspace to share",id:"topbar.shareButton.createOrJoinWorkspaceTooltip"});return m?e:(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)("div",{children:u?(0,I.jsx)(h().sA,{defaultMessage:"Share",id:"topbar.shareButton.tooltipAWTL"}):(0,I.jsx)(h().sA,{defaultMessage:"Share or publish to the web",id:"topbar.shareButton.tooltip"})}),(0,I.jsx)(A().A,{style:p.shortcut,name:"openShareMenu"})]})}),[u,p.shortcut,m,c]);return(0,I.jsx)(g().m,{disableTooltip:s().A.isMobile,renderTooltip:f,placement:"bottom",delayThreshold:400,render:i=>(0,I.jsx)(_,{events:(0,o().A)(i,e),handleClick:t,disabled:m,shouldShowGlobeIcon:n})})}function _({events:e,handleClick:t,disabled:n,shouldShowGlobeIcon:i}){const o=(0,h().tz)(),a=(0,r().IS)((()=>{const e=(0,j().aD)(),t=(0,w().Hh)();return{mobileIconStyle:e.iconStyle,shareButton:{...s().A.isMobile?e.iconContainer:{marginInlineEnd:t.iconButton.marginInlineEnd,marginInlineStart:6}}}}),[]);const l=s().A.isMobile?(0,I.jsx)(u().I,{icon:f().Y,style:a.mobileIconStyle}):(0,I.jsx)(h().sA,{defaultMessage:"Share",id:"topbar.shareButton.title"});return(0,I.jsx)(p().p,{id:void 0,className:d().voG,...e,style:a.shareButton,"aria-label":o.formatMessage(k.share),disabled:n,disabledFeedback:n,onClick:t,iconLeading:i?{icon:m().globeIcon,colorPalette:"blue",colorVariant:"accentPrimary"}:void 0,children:l})}function P({buttonPopupStore:e,universalMemberInviteStore:t,inviteTargetsStore:n}){e.reset(),t.reset(),n.reset()}const B=i.memo(T)},141945:(e,t,n)=>{n.d(t,{A:()=>s});class i extends(()=>n(757695))().Store{getInitialState(){return{open:!1}}}const s=new i},142015:(e,t,n)=>{n.d(t,{D:()=>s});n(296540);const i={viewBox:"0 0 20 20",fittedViewBox:"4.42 4.41 11.16 11.16",directional:!0,svg:(0,n(474848).jsx)("path",{d:"M15.417 5.467c.23-.23.219-.615-.025-.859s-.629-.255-.86-.025l-8.857 8.858V7.313a.625.625 0 0 0-1.25 0v7.637c0 .345.28.625.625.625h7.637a.625.625 0 1 0 0-1.25H6.559z"})},s=(0,n(340498).wt)("arrowDiagonalDownLeft",i,"default")},146594:(e,t,n)=>{n.d(t,{H:()=>o});var i=()=>n(79926);const s=new(i().O2)("UpdateSidebarTabInfo",(async()=>await n.e(21377).then(n.bind(n,722143)))),o=(0,i()._h)(s,(e=>e.UpdateSidebarTabInfo))},146633:(e,t,n)=>{n.r(t),n.d(t,{iconDefinition:()=>s,pageSmallIcon:()=>o});n(296540);var i=n(474848);const s={viewBox:"0 0 16 16",fittedViewBox:"3.37 2.12 9.25 11.75",svg:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{d:"M5.75 8.675a.575.575 0 1 0 0 1.15h4.5a.575.575 0 1 0 0-1.15zm0 2a.575.575 0 0 0 0 1.15h4.5a.575.575 0 1 0 0-1.15z"}),(0,i.jsx)("path",{d:"M5.125 2.125a1.75 1.75 0 0 0-1.75 1.75v8.25c0 .966.784 1.75 1.75 1.75h5.75a1.75 1.75 0 0 0 1.75-1.75V6.591c0-.464-.184-.91-.513-1.237L9.396 2.638a1.75 1.75 0 0 0-1.237-.513zm-.5 1.75a.5.5 0 0 1 .5-.5h2.604v1.831c0 .98.794 1.775 1.775 1.775h1.871v5.144a.5.5 0 0 1-.5.5h-5.75a.5.5 0 0 1-.5-.5zm4.254 1.331V3.888l1.944 1.943h-1.32a.625.625 0 0 1-.624-.625"})]})},o=(0,n(340498).wt)("pageSmall",s,"small")},148134:(e,t,n)=>{n.d(t,{Y:()=>s});class i extends(()=>n(757695))().Store{getInitialState(){return{open:!1,rect:n(587682).v_}}}const s=new i;(0,n(852832).exposeDebugValue)("ImageEditMenuStore",s)},152077:(e,t,n)=>{n.d(t,{Vs:()=>d,WA:()=>l,YU:()=>c,bO:()=>a,lU:()=>r});var i=n(296540),s=n(474848);const o=i.createContext(void 0);function a(e){return(0,s.jsx)(o.Provider,{value:e.surface,children:e.children})}function r(){return i.useContext(o)}function l(){const e=r();return"TeamHome"===e||"PersonalHome"===e}function d(){return void 0===r()}function c(){return d()?12:0}o.displayName="PostFeedSurfaceContext"},160803:(e,t,n)=>{n.r(t),n.d(t,{ImportIntoNewPageModal:()=>M,default:()=>A});var i=n(296540),s=()=>n(907258),o=()=>n(484714),a=()=>n(590526),r=()=>n(394888),l=()=>n(89002);const d=(0,n(340498).xh)("docBadgePlus",{default:{loader:()=>n.e(94802).then(n.bind(n,758105))},small:{loader:()=>n.e(94802).then(n.bind(n,424451))},fill:{loader:()=>n.e(94802).then(n.bind(n,528265))},fillSmall:{loader:()=>n.e(94802).then(n.bind(n,301136))}},["IPR","initial page render","recent document","recent page","recents","page history"]);var c=()=>n(69708),u=()=>n(559926),p=()=>n(799832),g=()=>n(241021),m=()=>n(838239),f=()=>n(227358),h=()=>n(404141),y=()=>n(181015),v=()=>n(141945),b=()=>n(191227),S=n(474848);function x(){v().A.setState({open:!1})}function M(){const e=(0,o().v3)(),t=(0,a().K8)((()=>v().A.state.open),[]),n=(0,a().O$)(s().AppStoreMainEditorCurrentBlockStore),M=(0,i.useCallback)((()=>{if(!n)return void x();const t=(0,p().U)(n),i=null==t?void 0:t.collectionViewBlockStore(),s=null==t?void 0:t.collectionViewStore(),o=null==s?void 0:s.getCollectionStore(),a=b().A.getOrCreateFlowId();u().fJ(e,{import_source:"csv",from:"topbar",data_source_session_id:void 0,data_source_from:void 0,import_type:"file",flowId:a,userId:e.currentUser.id,spaceId:n.getSpaceId()}),y().Z({importType:"merge",spaceId:n.getSpaceId(),importLocation:null==o?void 0:o.id,parentId:n.id,parentTable:"block",collectionViewBlockStore:i,analyticsFrom:"topbar"}),x()}),[e,n]);return(0,S.jsx)(r().s,{isOpen:t,onDismiss:x,onClosed:x,areaConstraint:{width:{type:"fixed",length:300}},render:()=>(0,S.jsx)(l().t,{header:(0,S.jsx)(m().Y,{iconAndTitle:(0,S.jsx)(f().Z,{iconGroup:d,title:(0,S.jsx)(c().sA,{defaultMessage:"Import into new page?",id:"importIntoNewPageModal.title"})}),description:(0,S.jsx)(c().sA,{id:"importIntoNewPageModal.description",defaultMessage:"Since this page already has content, we’ll need to create a new page for you and import contents there."})}),footer:(0,S.jsx)(g().a,{layout:"vertical",primaryButtons:[{buttonType:"primary",label:(0,S.jsx)(c().sA,{defaultMessage:"Yes, continue",id:"importIntoNewPageModal.importButton"}),onClick:()=>{h().Ay.setState({open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0,openedFrom:"collection"}),u().kY(e,{from:"topbar",flowId:b().A.createFlowId()}),x()}}],secondaryButtons:[{buttonType:"secondary",label:(0,S.jsx)(c().sA,{defaultMessage:"No, import here",id:"importIntoNewPageModal.importHereButton"}),onClick:M}]})})})}const A=M},171510:(e,t,n)=>{n.d(t,{Q:()=>v});n(898992),n(354520);var i=n(296540),s=()=>n(726637),o=()=>n(484714),a=()=>n(590526),r=()=>n(849255);const l="initial_handshake";var d=()=>n(798880),c=()=>n(69708),u=()=>n(496603),p=()=>n(763824),g=()=>n(498212),m=()=>n(179534),f=()=>n(214006),h=n(474848);const y=1;function v(){const e=(0,o().v3)(),t=(0,c().tz)(),n=`${s().A.identity.domainBaseUrl}/authSync`,v=e.currentUser.isLoggedIn(),[b,S]=(0,i.useState)(null),[x,M]=(0,i.useState)({value:!1,count:0}),A=(0,a().K8)((()=>m().A.getTotalUnreadMentionsCount()),[]),j=(0,a().K8)((()=>f().A.getAllSpaceViewStores(e)),[e]);(0,i.useEffect)((()=>{const e=t=>{const n=s().A.identity.domainBaseUrl;t.origin===n&&t.ports&&t.ports[0]&&(S(t.ports[0]),window.removeEventListener("message",e))};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}}),[]),(0,i.useEffect)((()=>{v&&(x.value||0===x.count||null==b||b.postMessage({version:y,name:"unreadCount",source:"notion",unreadCount:A}))}),[v,x.count,x.value,b,A]);const w=(0,i.useCallback)((async()=>{const e=u().hS(j,"userId"),n=await(0,p().lX)(e,10,(async e=>{if(!e.userId)return;const n=r().L.createChildStore(e,{table:d().oo,id:e.userId});await n.load();const i=n.getEmail()??"",s=n.getDisplayName(t)??"",o=n.getProfilePhoto()??"";return{id:e.userId,displayName:s,emailAddress:i,profilePicture:o}}));null==b||b.postMessage({version:y,name:"accountSwitcher",source:"notion",accounts:n.filter((e=>void 0!==e)),persistCookie:!0})}),[t,b,j]);(0,i.useEffect)((()=>{v&&b&&(x.value||0===x.count)&&w()}),[v,w,x.count,x.value,b]),(0,i.useEffect)((()=>{e.currentUser.id&&!(0,g().uj)(e.currentUser.id)||null==b||b.postMessage({version:y,name:"setNotionUserID",source:"notion",notionUserID:e.currentUser.id?e.currentUser.id:"",type:"mutation"})}),[e.currentUser.id,b]),(0,i.useEffect)((()=>{v||(null==b||b.postMessage({version:y,name:"setNotionUserID",source:"notion",notionUserID:"",type:"mutation"}),null==b||b.postMessage({version:y,name:"accountSwitcher",source:"notion",accounts:[],persistCookie:!0}))}),[v,b]);const I=(0,i.useCallback)((e=>{if(e.data.version!==y)return;const{source:t}=e.data;if("notion"!==t&&"mailLoaded"===e.data.name)M((e=>({value:!0,count:e.count+1})))}),[]);return(0,i.useEffect)((()=>(S((e=>(e&&(e.onmessage=I),e))),()=>{S((e=>(e&&(e.onmessage=null),e)))})),[I,b]),(0,h.jsx)("iframe",{src:n,style:{display:"none"},onLoad:e=>function(e){const t=e.currentTarget;setTimeout((()=>{var e;null===(e=t.contentWindow)||void 0===e||e.postMessage(l,s().A.identity.domainBaseUrl)}),50)}(e),title:"Notion Identity"})}},178534:(e,t,n)=>{n.d(t,{A:()=>s});class i extends(()=>n(757695))().Store{getInitialState(){return{open:!1}}}const s=new i},189158:(e,t,n)=>{n.d(t,{f:()=>a});var i=()=>n(564884),s=()=>n(371722),o=()=>n(457717);function a(e,t){const n=(0,s().f)(t,{includeTeamHomeFeed:!1,includeDataSources:!1});(0,i().u)({environment:e,event:{eventName:"topbar_breadcrumb_menu_click",eventProperties:{has_parent_pages:n.length>1}}}),o().F.setState({open:!0})}},201170:(e,t,n)=>{n.d(t,{HX:()=>o,Hi:()=>s().Hi,lR:()=>a});var i=()=>n(736026),s=()=>n(35889);function o(){i().A.setState({open:!0,submitted:!1,error:void 0})}function a(){i().A.setState({open:!1})}},210748:(e,t,n)=>{n.d(t,{O:()=>r});var i=()=>n(165358),s=()=>n(134025),o=()=>n(534177),a=()=>n(547149);function r(e){var t;const{environment:n,layoutStore:r}=e,d=r.getPreviousViewsMainCollectionViewBlockPointer(),c=null===(t=r.getModuleByType("viewsMain"))||void 0===t?void 0:t.collection_view_block_pointer;if(!r.getModel()||!r.canEdit())return;const u=r.getBlockChildren(),{blocksToRemoveFromChildArray:p,clearPreviousPointer:g}=function({previousViewsMainBlockId:e,currentViewsMainBlockId:t,currentBlocksArray:n}){if(n.length>1)return l;const i=1===n.length?n[0]:void 0;if((0,o().O9)(t))return(0,o().O9)(e)?{clearPreviousPointer:!0,blocksToRemoveFromChildArray:i===e&&t!==i?[e]:[]}:l;if((0,o().O9)(e)){return i===e?l:{clearPreviousPointer:!0,blocksToRemoveFromChildArray:i?[i]:[]}}return{clearPreviousPointer:!1,blocksToRemoveFromChildArray:[]}}({previousViewsMainBlockId:null==d?void 0:d.id,currentViewsMainBlockId:null==c?void 0:c.id,currentBlocksArray:u});if(!g&&0===p.length)return;const m=g?null:d;(0,i().log)({level:"info",from:"cleanupInvalidCollectionViewBlocks",type:"resetInvalidBlockChildrenArray",data:{layoutPointer:r.pointer,expectedPreviousPointer:m,actualPreviousPointer:c??null,actualChildIds:u}}),a().createAndCommit({environment:n,userAction:"cleanupInvalidCollectionViewBlocks.fixEmptyBlockChildren",canUndo:!1,perform:e=>{if(g&&a().applyOperation({store:r,transaction:e,operation:s().op.update({pointer:r.pointer,path:["format"],args:{previousViewsMainCollectionViewBlockPointer:null}})}),p.length>0)for(const t of p)a().applyOperation({store:r,transaction:e,operation:s().op.removeChild({pointer:r.pointer,path:["blocks"],args:{id:t}})})}})}const l={clearPreviousPointer:!1,blocksToRemoveFromChildArray:[]}},218429:(e,t,n)=>{n.d(t,{l:()=>S});var i=n(296540),s=()=>n(933922),o=()=>n(484714),a=()=>n(590526),r=()=>n(401497),l=()=>n(543906),d=()=>n(110750),c=()=>n(107975),u=()=>n(172489),p=()=>n(379887),g=()=>n(100622),m=()=>n(754002),f=()=>n(993130),h=()=>n(404141),y=()=>n(51367),v=()=>n(131448),b=n(474848);function S(e){const{messageKey:t,desktopRenderInner:n,desktopInnerStyle:i,desktopOnDismiss:u,phoneRenderInner:p,phoneInnerStyle:m,phoneOnly:S,calloutMetadata:M}=e,A=(0,o().v3)(),j=(0,o().Y0)(),w=(0,r().IS)((()=>({modalStyle:{background:g().Tj.background.secondary,borderRadius:12,...i}})),[i]),I=(0,a().K8)((()=>{var e;const t=(0,d().Xz)(A.TabbedRouterStore.state);return"web"===t.type&&((null===(e=t.redirectedTo)||void 0===e?void 0:e.route)||t.route)}),[A.TabbedRouterStore]),k=(0,a().K8)((()=>!(j.isPhone&&(0,f().A)(A)&&(!I||"page"!==I.name))&&!h().Ay.state.open),[j.isPhone,A,I]),T=(0,a().K8)((()=>v().default.isVisible(t)),[t])&&k;return(0,l().A)((()=>{y().DL(A,{callout_key:t,is_forced:v().default.isForced(t),placement_key:"Modal",callout_metadata:M})}),T),T?j.isPhone?(0,b.jsx)(x,{messageKey:t,renderInner:p,innerStyle:m}):S&&!j.isPhone?null:(0,b.jsx)(c().a,{open:!0,preventHideChildrenWhileOpening:!0,onDismiss:u,innerStyle:w.modalStyle,render:()=>(0,b.jsx)(s().A,{capture:!0,allowEsc:!0,render:n})}):null}function x(e){const{renderInner:t,innerStyle:n,messageKey:s}=e,a=(0,o().v3)(),{clearSelection:r}=(0,p().g)(),l=(0,i.useCallback)((()=>{y().Sq(a,{callout_key:s,dismiss_type:"modal_background_clicked",placement_key:"Modal"})}),[a,s]),d=(0,i.useCallback)((()=>{y().Sq(a,{callout_key:s,dismiss_type:"modal_dismiss_clicked",placement_key:"Modal"})}),[a,s]);return(0,i.useEffect)((()=>{r(),(0,u().k)()}),[r]),(0,b.jsx)(m()._,{renderInner:t,innerStyle:n,onDismiss:l,onClosed:d})}},226916:(e,t,n)=>{n.d(t,{c:()=>S,t:()=>x});n(16280);var i=()=>n(907258),s=()=>n(755531),o=()=>n(242422),a=()=>n(908006),r=()=>n(675133),l=()=>n(165358),d=()=>n(388821),c=()=>n(201980),u=()=>n(62287),p=()=>n(37450),g=()=>n(644854),m=()=>n(389658),f=()=>n(645266),h=()=>n(129522),y=()=>n(295304),v=()=>n(547149);const b=(0,n(69708).YK)({formDatabaseTitle:{id:"newBlock.databaseInline.formDatabaseTitle",defaultMessage:"New form"}});function S(e){var t,n;const{environment:s,store:r,viewType:v,transaction:b}=e,S=null===(t=r.getBlockTitleStore())||void 0===t?void 0:t.getValue();o().default.checkGate({gateName:"mobile_keep_template_gallery_open"})&&f().A.state.open&&f().A.setState({open:!1});const x=r.getSpaceId()??(null===(n=i().default.state.mainEditorCurrentBlockStore)||void 0===n?void 0:n.getSpaceId()),M=x?s.idCreator.getSpaceIdCreatorSync(x):void 0;(0,g().initializeTemplate)({environment:s,sourceBlockId:"root",targetBlockPointer:r.pointer,sourceBlockSubtree:(0,d().partialRecordMapToRecordMap)((0,m().qP)({isInline:!1,viewType:v,name:(0,c().w9s)(S)?void 0:S})),targetRecordCache:r.inMemoryRecordCache,transaction:b,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,spaceIdCreator:M}),u().pd({environment:s,block:r,blockType:"collection_view_page",transaction:b}),S&&y().R9({environment:s,store:r.getBlockTitleStore(),value:S,transaction:b}),a().default.afterNextFlush((()=>{const e=h().K.findCollectionViewBlockFromStore(r);var t;e&&"handleCreated"in e&&(null===(t=e.handleCreated)||void 0===t||t.call(e))}));const A=r.getCollectionStoreIfSingleSource();A?p().vH(s,{from:"template_picker",type:"collection_view_page",creating_block_id:r.id,is_full_screen:!0,view_type:v,collection_id:A.id}):(l().log({level:"info",from:"initializeViewActions",type:"track_create_block_missing_collection_id",data:{miscDataToConvertToString:{creating_block_id:r.id,is_full_screen:!0,view_type:v}}}),p().vH(s,{from:"template_picker",type:"collection_view_page",creating_block_id:r.id,is_full_screen:!0,view_type:v,collection_id:""}))}async function x(e){var t,o,a;const{environment:l,store:f}=e,h=null===(t=f.getBlockTitleStore())||void 0===t?void 0:t.getValue(),{formsEditorDependency:y}=await Promise.resolve().then(n.bind(n,339034)),{formEditorActions:S}=await y.load(),x=f.getSpaceId()??(null===(o=i().default.state.mainEditorCurrentBlockStore)||void 0===o?void 0:o.getSpaceId())??(null===(a=(0,s().S)())||void 0===a?void 0:a.id),M=x?l.idCreator.getSpaceIdCreatorSync(x):void 0;v().createAndCommit({userAction:"HorizontalTemplatePicker.createForm",environment:l,canUndo:!0,perform:e=>{var t;(0,g().initializeTemplate)({environment:l,sourceBlockId:"root",targetBlockPointer:f.pointer,sourceBlockSubtree:(0,d().partialRecordMapToRecordMap)((0,m().mT)({isInline:!1,name:(0,c().w9s)(h)?(0,c().x9d)(r().A.formatMessage(b.formDatabaseTitle)):h})),targetRecordCache:f.inMemoryRecordCache,transaction:e,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,spaceIdCreator:M}),u().pd({environment:l,block:f,blockType:"collection_view_page",transaction:e});const n=f.getCollectionStoreIfSingleSource();if(!n)throw new Error("Collection store not found");const i=null==n||null===(t=n.getModel())||void 0===t?void 0:t.getNormalizedSchema();if(!i)throw new Error("Schema not found");const s=f,o=S.createCollectionFormEditorView({environment:l,transaction:e,collectionViewBlockStore:s,collectionId:n.id,schema:i,initializeWithAllDefaultQuestions:!0});S.createResponsesCollectionView({environment:l,transaction:e,collectionViewBlockStore:s,collectionStore:n,schema:i}),p().vH(l,{from:"template_picker",type:"form",creating_block_id:f.pointer.id,form_id:null==o?void 0:o.formId,view_id:s.id})}})}},228049:(e,t,n)=>{n.r(t),n.d(t,{PublicTopbarMoreMenu:()=>C});n(898992),n(823215),n(354520),n(581454),n(908872);var i=n(296540),s=()=>n(907258),o=()=>n(726637),a=()=>n(312788),r=()=>n(484714),l=()=>n(792485),d=()=>n(590526),c=()=>n(295633),u=()=>n(546926),p=()=>n(890492),g=()=>n(736847),m=()=>n(584262),f=()=>n(700500),h=()=>n(179034),y=()=>n(636714),v=()=>n(278634),b=()=>n(709906),S=()=>n(575143),x=()=>n(187820),M=()=>n(16006),A=()=>n(544198),j=()=>n(492414),w=()=>n(619206),I=()=>n(311337),k=()=>n(578872),T=n(474848);function C({blockStore:e,onDismiss:t,isPublicShareLink:n}){const{navigate:C}=(0,i.useContext)(a().E),_=(0,r().v3)(),P=(0,d().K8)((()=>w().A.getMode(_,e,e.getSpaceStore())),[_,e]),B=(0,l().S)(),R=(0,d().K8)((()=>e.isFormBlock()),[e]),[D,L]=(0,i.useState)(o().A.isMobile&&!R?"initialActions":"more"),E=(0,i.useMemo)((()=>({environment:_,blocks:[e],publicEditMode:P,analyticsFrom:"topbar_more_menu",pageContext:B})),[_,e,P,B]);let O;O=o().A.isMobile?{menuType:u().gu.ActionSheet}:{menuType:u().gu.Popup,width:210,maxHeight:"80vh"};const N=(0,i.useCallback)((e=>{const{mainEditorCurrentBlockStore:n}=s().default.state;if(n){const t=n.getType();if(t){const{collectionId:i,ownedCollectionCount:s,linkedCollectionCount:o}=(0,A().P)(n,{skipPages:!0});(0,v().N)(_,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"public_topbar_more_menu",block_id:n.id,block_type:t,is_toggleable:(0,f().Yt)(t,n.getFormat()),collection_id:i,owned_collection_count:s,linked_collection_count:o,parent_collection_id:n.getParentCollectionIdUpToTwoLevels()})}}e.closeParentMenu&&t()}),[_,t]),F=(0,d().K8)((()=>{var t;if(!o().A.isMobile)return;const n=e.getSpaceStore();if(!n)return;const i=k().GN(e),s=null==i||null===(t=i.getSiteStore())||void 0===t||null===(t=t.getHeader())||void 0===t?void 0:t.customItems;if(!s)return;return{key:"custom nav",render:e=>(0,T.jsx)(g().A,{...e}),actions:s.filter((e=>"block"===e.type)).map((t=>{const i=c().B.createChildStore(n,{table:h().ev,id:t.blockId}),s=i.getIcon(),o=(0,j().Ay)({store:i,preferPublicLink:!0,pageVisitSource:m().y8.SiteCustomHeader});return{key:t.blockId,analyticsName:t.blockId,displayName:t.blockId,searchName:t.blockId,render:t=>(0,T.jsx)(S().A,{...t,left:s&&(0,T.jsx)(x().B6,{icon:s,store:e,disabled:!0,isEmptyPage:i.isEmptyPage(),size:18,emojiSize:18,disableShrinking:!0}),title:(0,T.jsx)(M().A,{store:i,maxLength:30})}),action:()=>{C({environment:_,url:o})},closeParentMenu:!0}}))}}),[_,e,C]),U=(0,b().B2)((()=>{L("more")})),z=(0,b().pJ)((()=>{L("more")})),K=(0,d().K8)((()=>(0,I().y)(_)),[_]),V=(0,i.useMemo)((()=>K?[z]:F?[F,U]:[U]),[K,z,F,U]),q=(0,d().K8)((()=>1===V.reduce(((e,t)=>e+t.actions.filter((e=>!e.validators||e.validators.every((e=>e(E))))).length),0)),[V,E]);return"initialActions"!==D||q?(0,T.jsx)(p().A,{...O,children:(0,T.jsx)(y().A,{sections:n?b().Sg:b()._4,context:E})}):(0,T.jsx)(p().A,{...O,children:(0,T.jsx)(y().A,{sections:V,onAccept:N,context:E})})}},231039:(e,t,n)=>{n.d(t,{N:()=>d});n(296540);var i=()=>n(401497),s=()=>n(265060),o=()=>n(568999),a=()=>n(69708),r=()=>n(100622),l=n(474848);function d({inviteTarget:e}){const t=(0,i().IS)((()=>({notionMemberLine:{display:"flex",alignItems:"center",gap:2},notionMemberIcon:{display:"flex",alignItems:"center",justifyContent:"center",color:r().Tj.blue.icon.accentPrimary}})),[]);return(0,l.jsxs)("div",{style:t.notionMemberLine,children:[(0,l.jsxs)("div",{style:t.notionMemberIcon,children:[(0,l.jsx)(s().Q,{variantName:"fillSmall",iconGroup:o().g}),(0,l.jsx)(a().sA,{id:"invite.google_imports.notion_member.title",defaultMessage:"Notion Member"})]}),(0,l.jsx)("span",{children:"•"}),(0,l.jsx)("div",{children:e.value.email})]})}},232461:(e,t,n)=>{n.d(t,{J:()=>d});var i=()=>n(664594),s=()=>n(920198),o=()=>n(726637),a=()=>n(590526),r=()=>n(789586),l=()=>n(787766);function d(){const e=(0,s().L)(),t=(0,i().T)(),n=(0,r().P)({name:"contacts_imports_invite",spaceId:null==e?void 0:e.id,userId:t}),d=(0,a().K8)((()=>(null==e?void 0:e.canEditMembership())??!1),[e]);return(0,l().vC)({canEditPermission:d,isMobile:o().A.isMobile,isEnterprise:n??!1})}},258467:(e,t,n)=>{n.d(t,{Ft:()=>h,Hq:()=>p,Mb:()=>u,ZF:()=>f,k7:()=>m,sR:()=>c});n(16280);var i=()=>n(675133),s=()=>n(278729),o=()=>n(402390),a=()=>n(848538),r=()=>n(769864),l=()=>n(579627),d=()=>n(475355);async function c(e){const{environment:t,email:n}=e,s=await r().callApi({eventName:"findUser",environment:t,data:{email:n}});if("success"===s.type){const e=s.data;if(e.value)return e.value.value.id}return await async function(e){const{environment:t,email:n}=e,s=await r().callApi({eventName:"createEmailUser",environment:t,data:{email:n,preferredLocaleOrigin:"inferred_from_inviter",preferredLocale:(0,o().H)(i().A.getIntl())}});if("failed"===s.type)throw s.error;return s.data.userId}({environment:t,email:n})}async function u(e){const{block:t,blockRole:n,environment:i,inviteeUserId:s,inviteMessage:o}=e;await g({environment:i,block:t,blockRole:n,inviteeUserId:s,inviteMessage:o,type:"guest-invite-request"})}async function p(e){const{block:t,blockRole:n,environment:i,inviteeUserId:s,inviteMessage:o}=e;await g({environment:i,block:t,blockRole:n,inviteeUserId:s,inviteMessage:o,type:"restricted-member-invite-request"})}async function g(e){const{environment:t,block:n,blockRole:i,inviteeUserId:s,inviteMessage:o,type:a}=e,l=await r().callApi({eventName:"requestAccess",environment:t,data:{type:a,block:n,forActorId:s,message:void 0,attributes:{role:i,inviteMessage:o}}});if("failed"===l.type)throw l.error}async function m(e){const{environment:t,spaceStore:n,inviteeUserId:i,inviteMessage:s}=e;if(n.canAdmin())throw new Error("This operation is not valid for workspace owners, because member requests are immediately approved when created by a workspace owner. Use createMember instead.");const o=await r().callApi({eventName:"requestAccess",environment:t,data:{type:"actor-to-space",forActorId:i,spaceId:n.id,message:s}});if("failed"===o.type)throw o.error}async function f(e){const{blockPermissionItem:t,blockStore:n,environment:i,inviteOrigin:o,spaceActor:r,spaceStore:c,sudoModeStore:u,shareMenuSessionId:p}=e;if(t.user_id!==r.userId)throw new Error("User IDs for block and space permission items must match");if(!(!0===s().V.createChildStore(c,(0,a().i1)({userId:r.userId,spaceId:c.id})).isMember())){if(!c.isTeamsEnabled()){if(!(await d().oH({environment:i,flowId:"",trackCreateTeamComplete:!1})))throw new Error("Failed to enable teams before creating member.")}await l().dz({environment:i,spaceStore:c,actors:[r],invite:{inviteOrigin:o}})}await l().J4({environment:i,store:n,sudoModeStore:u,permissionItems:[t],skipGuestLimitValidation:!0,invite:{inviteOrigin:o},shareMenuSessionId:p})}async function h(e){const{blockPermissionItem:t,blockStore:n,environment:i,metadata:s,sudoModeStore:o,shareMenuSessionId:a}=e;await l().J4({environment:i,store:n,sudoModeStore:o,permissionItems:[t],invite:s,skipGuestLimitValidation:!0,shareMenuSessionId:a})}},263470:(e,t,n)=>{n.d(t,{$:()=>i,H:()=>s});const i="notion_sites_banner_click",s="notion_sites_banner_dismiss"},263814:(e,t,n)=>{n.r(t),n.d(t,{GenerateSocialMediaPreviewImageWrapper:()=>u});var i=n(296540),s=()=>n(242422),o=()=>n(484714),a=()=>n(590526),r=()=>n(232615),l=()=>n(201980),d=()=>n(496603),c=()=>n(6027);function u(e){const{store:t}=e;return function(e){const t=(0,o().v3)(),[n,u]=(0,i.useState)("uninitialized"),[p,g,m,f,h]=(0,a().K8)((()=>{var n,i;return e.pathIsDead()||"on"!==s().default.getEligibleGroup({experimentId:"dynamic_social_preview_image",defaultGroup:"unassigned"})||e.inMemoryRecordCache.recordHasOverride({pointer:e.pointer,userId:t.currentUser.id})?[!1]:[e.isReady(),l().q4_(e.getTitleValue()),null===(n=e.getIcon())||void 0===n?void 0:n.icon,null===(i=e.getCover())||void 0===i?void 0:i.cover,e.getFormat().page_font]}),[t.currentUser.id,e]);(0,i.useEffect)((()=>{"storeReady"===n?u("generateImage"):p&&u("storeReady")}),[p,g,m,f,h]);const y=(0,i.useMemo)((()=>(0,d().sg)((()=>{u("storeReady"),c().F({environment:t,store:e})}),5e3)),[t,e]);(0,a().K8)((()=>{"generateImage"===n&&(r().default.state,y())}),[n,y])}(t),null}},264699:(e,t,n)=>{n.d(t,{_:()=>a});var i=()=>n(675133);const s=(0,n(69708).YK)({table:{defaultMessage:"Table",id:"templatePickerHelpers.databaseTemplateNames.table"},board:{defaultMessage:"Board",id:"templatePickerHelpers.databaseTemplateNames.board"},list:{defaultMessage:"List",id:"templatePickerHelpers.databaseTemplateNames.list"},calendar:{defaultMessage:"Calendar",id:"templatePickerHelpers.databaseTemplateNames.calendar"},gallery:{defaultMessage:"Gallery",id:"templatePickerHelpers.databaseTemplateNames.gallery"},timeline:{defaultMessage:"Timeline",id:"templatePickerHelpers.databaseTemplateNames.timeline"}});function o(e){const{environment:t,store:i,viewType:s}=e;n(547149).createAndCommit({userAction:"templatePickerHelpers.handleClickForViewType",environment:t,canUndo:!0,perform:e=>{(0,n(226916).c)({environment:t,store:i,viewType:s,transaction:e}),n(857783).uK({environment:t,store:i,pageVisitSource:n(584262).y8.LinkInPage});const o=i.getCollectionViewStores()[0];o&&(0,n(306499).F)(o.id,{viewType:s})}})}const a=[{name:i().A.formatMessage(s.table),type:"table",iconFn:n(421559).T,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>o({environment:e,store:t,viewType:"table"})},{name:i().A.formatMessage(s.board),type:"board",iconFn:n(969523).q,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>o({environment:e,store:t,viewType:"board"})},{name:i().A.formatMessage(s.list),type:"list",iconFn:n(202017).n,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>o({environment:e,store:t,viewType:"list"})},{name:i().A.formatMessage(s.timeline),type:"timeline",iconFn:n(397414).u,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>o({environment:e,store:t,viewType:"timeline"})},{name:i().A.formatMessage(s.calendar),type:"calendar",iconFn:n(42583).D,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>o({environment:e,store:t,viewType:"calendar"})},{name:i().A.formatMessage(s.gallery),type:"gallery",iconFn:n(858141).squareGrid2X2Icon,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>o({environment:e,store:t,viewType:"gallery"})}]},271459:(e,t,n)=>{n.r(t),n.d(t,{TopbarStopSuggestModeButton:()=>w});var i=n(296540),s=()=>n(907258),o=()=>n(484714),a=()=>n(590526),r=()=>n(401497),l=()=>n(79926),d=()=>n(75435),c=()=>n(148297),u=()=>n(718827),p=()=>n(680474),g=()=>n(807449),m=()=>n(209416),f=()=>n(995847),h=()=>n(69708),y=()=>n(100622),v=()=>n(473227),b=()=>n(105855),S=()=>n(130119),x=()=>n(737230),M=n(474848);const A=(0,h().YK)({stopSuggestRole:{defaultMessage:"Turn off suggesting",id:"topbar.stopsuggestmodel."},tooltip:{defaultMessage:"You’re suggesting",id:"topbarStopSuggestModeButton.tooltip"},tooltipCommentOnlyContent:{defaultMessage:"Suggest edits or add comments",id:"topbarStopSuggestModeButton.tooltipCommentOnlyContent"}});function j({store:e,isVisible:t,compact:n,framerMotion:s}){const l=(0,o().v3)(),c=(0,h().tz)(),p=(0,a().O$)(d().b),b=(0,a().K8)((()=>x().Ay.state.expanded),[]),j=(0,r().IS)((()=>({button:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:256,color:y().Tj.blue.text.accentPrimary,gap:6,padding:"0 10px",height:28,background:y().Tj.palette.uiBlue[100],...(0,S().g)({noDrag:l.device.isElectron&&!p})},hoveredButton:{background:y().Tj.palette.uiBlue[200]},pressedButton:{background:y().Tj.palette.uiBlue[300]},text:{fontSize:14,lineHeight:1.428}})),[l.device.isElectron,p]),w=(0,i.useCallback)((()=>{v().PD({environment:l,navigableBlockStore:e,mode:"default",location:"stop_suggest_pill"})}),[l,e]),k=(0,i.useRef)(null),{AnimatePresence:T,motion:C}=s;return(0,M.jsx)(T,{children:t?(0,M.jsxs)(C.div,{ref:k,initial:{opacity:0,x:30},animate:{opacity:1,x:0},transition:{duration:.1},children:[(0,M.jsxs)(u().Ay,{style:j.button,hoveredStyle:j.hoveredButton,pressedStyle:j.pressedButton,onClick:w,ariaLabel:c.formatMessage(A.stopSuggestRole),children:[(0,M.jsx)(g().I,{icon:m().a}),(0,M.jsx)(T,{initial:b,children:n||b?void 0:(0,M.jsx)(C.div,{initial:{width:0},exit:{width:0},animate:{width:"auto"},transition:{duration:.1},style:j.text,children:(0,M.jsx)(h().sA,{id:"topbar.stopsuggestmodel.label",defaultMessage:"Suggesting"})})}),(0,M.jsx)(g().I,{icon:f().xMarkSmallIcon,size:"sm",colorPalette:"blue",colorVariant:"tertiary"})]},"button"),n||b?void 0:(0,M.jsx)(I,{store:e,origin:k})]}):void 0})}function w(e){const{value:t}=(0,l().fJ)(p().fM);return t?(0,M.jsx)(j,{...e,framerMotion:t}):null}function I(e){const{store:t,origin:n}=e,r=(0,h().tz)(),l=(0,o().v3)(),d=(0,a().K8)((()=>t.isCommentOnly()),[t]),u=(0,a().K8)((()=>{var e;return null===(e=s().default.state.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.dismissed_suggest_mode_tooltip}),[]),p=d||!u,[g,m]=(0,i.useState)(p);return g?(0,M.jsx)(c().k,{origin:n,alignmentToOrigin:"center",placementToOrigin:"bottom",header:(0,M.jsx)(M.Fragment,{children:r.formatMessage(A.tooltip)}),content:d?r.formatMessage(A.tooltipCommentOnlyContent):null,headerStyle:{marginBottom:-2,width:"max-content",maxWidth:240},contentStyle:{width:"max-content",maxWidth:240},hideCloseButton:!0,shouldDismissUponOutsideClick:!0,onCloseClick:()=>{m(!1),(0,b().e)({environment:l,dismissed:!0})},pointerPosition:"50%",pointerLength:24}):null}},271930:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Fe});n(296540);var i=()=>n(782482),s=()=>n(726637),o=()=>n(484714),a=()=>n(792485),r=()=>n(590526),l=()=>n(723085),d=()=>n(245720),c=()=>n(127833),u=()=>n(30537),p=()=>n(546926),g=()=>n(890492),m=()=>n(791177),f=()=>n(736847),h=()=>n(700500),y=()=>n(854150),v=()=>n(69708),b=()=>n(496603),S=()=>n(534177),x=()=>n(636714),M=()=>n(278634),A=()=>n(863687),j=n(474848);const w=[{key:"block in comment menu primary",render:e=>(0,j.jsx)(f().A,{...e}),actions:[n(410767).z,A().b2,A().qI]}];var I=()=>n(804643),k=()=>n(599364);const T=[{key:"page mention context menu primary",render:e=>(0,j.jsx)(f().A,{...e}),actions:[...n(426928).YO,k().o,k().k]}];var C=()=>n(901265),_=()=>n(390650),P=()=>n(635462),B=()=>n(232930),R=()=>n(691298),D=()=>n(696746),L=()=>n(206051),E=(n(581454),()=>n(675133)),O=()=>n(933152),N=()=>n(764781);const F={viewBox:"0 0 20 20",fittedViewBox:"2.37 4.12 15.25 11.75",svg:(0,j.jsx)("path",{d:"M2.375 6.25c0-1.174.951-2.125 2.125-2.125h11c1.174 0 2.125.951 2.125 2.125v7.5a2.125 2.125 0 0 1-2.125 2.125h-11a2.125 2.125 0 0 1-2.125-2.125zm14 2.625H8.292v2.25h8.083zm0 3.5H8.292v2.25H15.5a.875.875 0 0 0 .875-.875zm0-4.75V6.25a.875.875 0 0 0-.875-.875H8.292v2.25z"})},U=(0,n(340498).wt)("tableHeaderColumn",F,"default");var z=()=>n(236262),K=()=>n(637433),V=()=>n(100622),q=()=>n(12956),W=()=>n(267271),G=()=>n(896628),H=()=>n(491073),Y=()=>n(575143),$=()=>n(158658),Q=()=>n(404715),Z=()=>n(709219);function X(e){const t=Z().A.state;if(!t.isActive)return!1;const{simpleTableStore:n,selection:i}=t,s=0===i.start.row&&i.end.row===(0,Q().yv)(n)-1,o=0<=i.start.col&&i.start.col<=i.end.col&&i.start.col<=(0,Q().MW)(n)-1;return"column"===i.type&&o&&s}function J(e){const t=Z().A.state;if(!t.isActive)return!1;const{simpleTableStore:n,selection:i}=t,s=0===i.start.col&&i.end.col===Q().MW(n)-1,o=0<=i.start.row&&i.start.row<=i.end.row&&i.start.row<=Q().yv(n)-1;return"row"===i.type&&o&&s}n(18107),n(967357);function ee(e){const t=Z().A.state;return t.isActive&&1===e.blocks.length&&e.blocks.at(0)===t.simpleTableStore}var te=()=>n(964179),ne=()=>n(375308),ie=()=>n(598101),se=()=>n(27178),oe=()=>n(547149),ae=()=>n(919878),re=()=>n(875827),le=()=>n(934260),de=()=>n(857048);const ce=(0,v().YK)({simpleTableHeaderColumn:{id:"action.rowHeader.title",defaultMessage:"Header column"},simpleTableHeaderRow:{id:"action.columnHeader.title",defaultMessage:"Header row"},simpleTableInsertColumnLeft:{id:"action.insertColumnLeft.title",defaultMessage:"Insert left"},simpleTableInsertColumnRight:{id:"action.insertColumnRight.title",defaultMessage:"Insert right"},simpleTableClearContents:{id:"action.clearContents.title",defaultMessage:"Clear contents"},simpleTableInsertRowAbove:{id:"action.insertRowAbove.title",defaultMessage:"Insert above"},simpleTableInsertRowBelow:{id:"action.insertRowBelow.title",defaultMessage:"Insert below"},textColorSection:{id:"action.section.textColor",defaultMessage:"Text color"},backgroundColorSection:{id:"action.section.backgroundColor",defaultMessage:"Background color"}}),ue=(0,W().fi)({key:"simple table header column",displayName:ce.simpleTableHeaderColumn,label:E().A.formatMessage(ce.simpleTableHeaderColumn),getSvgIcon:()=>U,validators:[$().p,(0,ie().A)(te().w),ee,function(e){const t=Z().A.state;if(!t.isActive)return!1;const{simpleTableStore:n,selection:i}=t,s=0===i.start.row&&i.end.row===(0,Q().yv)(n)-1,o=0===i.start.col&&0===i.end.col;return"column"===i.type&&o&&s}],isChecked:e=>Boolean(e.getFormat().table_block_row_header),action:(e,t,n)=>G().zA({stores:[t],update:{table_block_row_header:!t.getFormat().table_block_row_header},transaction:n})}),pe=(0,W().fi)({key:"simple table header row",displayName:ce.simpleTableHeaderRow,label:E().A.formatMessage(ce.simpleTableHeaderRow),getSvgIcon:()=>n(464291).p,validators:[$().p,(0,ie().A)(te().w),function(e){const t=Z().A.state;if(!t.isActive)return!1;const{simpleTableStore:n,selection:i}=t,s=0===i.start.col&&i.end.col===(0,Q().MW)(n)-1,o=0===i.start.row&&0===i.end.row;return"row"===i.type&&o&&s}],isChecked:e=>{const t=e.getParentBlockStore();return!(null==t||!t.isType("table"))&&Boolean(t.getFormat().table_block_column_header)},action:(e,t,n)=>{const i=t.getParentBlockStore();null!=i&&i.isType("table")&&G().zA({stores:[i],update:{table_block_column_header:!i.getFormat().table_block_column_header},transaction:n})}}),ge=(0,W().Ls)({key:"insert column left",displayName:ce.simpleTableInsertColumnLeft,analyticsName:ce.simpleTableInsertColumnLeft.defaultMessage,svg:n(526278).arrowStraightLeftIcon,validators:[$().p,(0,ie().A)(ne().v),ee,X],closeParentMenu:!0,action:({environment:e})=>{oe().createAndCommit({userAction:"actionRegistry.insertColumnLeft",environment:e,canUndo:!0,perform:t=>{ae().T4({environment:e,transaction:t})}})}}),me=(0,W().Ls)({key:"insert column right",displayName:ce.simpleTableInsertColumnRight,analyticsName:ce.simpleTableInsertColumnRight.defaultMessage,svg:n(940563).arrowStraightRightIcon,validators:[$().p,(0,ie().A)(ne().v),ee,X],closeParentMenu:!0,action:({environment:e})=>{oe().createAndCommit({userAction:"actionRegistry.insertColumnRight",environment:e,canUndo:!0,perform:t=>{ae().sf({environment:e,transaction:t})}})}}),fe=(0,W().Fw)({key:"duplicate columns",displayName:W().AY.duplicateName,analyticsName:W().AY.duplicateName.defaultMessage,svg:N().V,validators:[$().p,(0,ie().A)(ne().v),ee,X],shortcuts:["duplicate"],closeParentMenu:!0,action:({environment:e})=>{oe().createAndCommit({userAction:"actionRegistry.duplicateColumns",environment:e,canUndo:!0,perform:e=>{ae().V0({transaction:e})}})}}),he=(0,W().Fw)({key:"delete columns",displayName:W().AY.deleteName,analyticsName:W().AY.deleteName.defaultMessage,svg:z().trashIcon,validators:[$().p,(0,ie().A)(ne().v),ee,function(e){const t=Z().A.state;if(!t.isActive)return!1;const{simpleTableStore:n}=t;return(0,Q().MW)(n)>1},X],shortcuts:["delete","backspace"],closeParentMenu:!0,render:e=>(0,j.jsx)(Y().A,{...e,isRed:!0,svg:z().trashIcon,title:(0,j.jsx)(v().sA,{...W().AY.deleteName})}),action:({environment:e})=>{oe().createAndCommit({userAction:"actionRegistry.deleteColumns",environment:e,canUndo:!0,perform:t=>{le().LL({environment:e,transaction:t})}})}}),ye=(0,W().Ls)({key:"clear column contents",displayName:ce.simpleTableClearContents,analyticsName:ce.simpleTableClearContents.defaultMessage,svg:K().xMarkCircleFillIcon,validators:[$().p,(0,ie().A)(ne().v),ee,X],closeParentMenu:!0,action:({environment:e})=>{oe().createAndCommit({userAction:"actionRegistry.clearColumnContents",environment:e,canUndo:!0,perform:t=>{re()._({environment:e,transaction:t})}}),de().wr()}}),ve=(0,W().Ls)({key:"insert row above",displayName:ce.simpleTableInsertRowAbove,analyticsName:ce.simpleTableInsertRowAbove.defaultMessage,svg:n(112282).arrowStraightUpIcon,validators:[$().p,(0,ie().A)(ne().v),J],closeParentMenu:!0,action:({environment:e})=>{oe().createAndCommit({userAction:"actionRegistry.insertRowAbove",environment:e,canUndo:!0,perform:t=>{ae().pW({environment:e,transaction:t})}})}}),be=(0,W().Ls)({key:"insert row below",displayName:ce.simpleTableInsertRowBelow,analyticsName:ce.simpleTableInsertRowBelow.defaultMessage,svg:n(655923).arrowStraightDownIcon,validators:[$().p,(0,ie().A)(ne().v),J],closeParentMenu:!0,action:({environment:e})=>{oe().createAndCommit({userAction:"actionRegistry.insertRowBelow",environment:e,canUndo:!0,perform:t=>{ae().pc({environment:e,transaction:t})}})}}),Se=(0,W().Fw)({key:"duplicate rows",displayName:W().AY.duplicateName,analyticsName:W().AY.duplicateName.defaultMessage,svg:N().V,validators:[$().p,(0,ie().A)(ne().v),J],shortcuts:["duplicate"],closeParentMenu:!0,action:({environment:e})=>{ae().n2({environment:e})}}),xe=(0,W().Fw)({key:"delete rows",displayName:W().AY.deleteName,analyticsName:W().AY.deleteName.defaultMessage,svg:z().trashIcon,validators:[$().p,(0,ie().A)(ne().v),function(e){const t=Z().A.state;if(!t.isActive)return!1;const{simpleTableStore:n}=t;return(0,Q().yv)(n)>1},J],shortcuts:["delete","backspace"],closeParentMenu:!0,render:e=>(0,j.jsx)(Y().A,{...e,isRed:!0,svg:z().trashIcon,title:(0,j.jsx)(v().sA,{...W().AY.deleteName})}),action:({environment:e})=>{oe().createAndCommit({userAction:"actionRegistry.deleteRows",environment:e,canUndo:!0,perform:t=>{le().pf({environment:e,transaction:t})}})}}),Me=(0,W().Ls)({key:"clear row contents",displayName:ce.simpleTableClearContents,analyticsName:ce.simpleTableClearContents.defaultMessage,svg:K().xMarkCircleFillIcon,validators:[$().p,(0,ie().A)(ne().v),J],closeParentMenu:!0,action:({environment:e})=>{oe().createAndCommit({userAction:"actionRegistry.clearRowContents",environment:e,canUndo:!0,perform:t=>{re()._({environment:e,transaction:t})}}),de().wr()}}),Ae=[$().p,(0,ie().A)(ne().v),ee,X],je=[$().p,(0,ie().A)(ne().v),J],we=[$().p,(0,ie().A)(ne().v),ee,function(e){const t=Z().A.state;if(!t.isActive)return!1;const{selection:n}=t;return"cell"===n.type}],Ie=(0,W().Ls)({key:"clear cell contents",displayName:ce.simpleTableClearContents,analyticsName:ce.simpleTableClearContents.defaultMessage,svg:n(378409).xMarkCircleIcon,validators:we,closeParentMenu:!0,action:({environment:e})=>{oe().createAndCommit({userAction:"actionRegistry.clearCellContents",environment:e,canUndo:!0,perform:t=>{re()._({environment:e,transaction:t})}}),de().wr()}});function ke(e){return"column"===e?Ae:"row"===e?je:"cell"===e?we:void(0,S().HB)(e)}function Te(e){const{textColorActions:t,backgroundColorActions:n}=function(e){return{textColorActions:(0,W().gy)({key:`simple table ${e} text color actions`,title:W().AY.colorSection,overrideSearchTitle:W().AY.colorSection,render:e=>(0,j.jsx)(f().A,{...e}),actions:[...V().N.map((t=>Ce(t,e)))]}),backgroundColorActions:(0,W().gy)({key:`simple table ${e} background color actions`,title:W().AY.backgroundSection,overrideSearchTitle:W().AY.backgroundSectionKeywords,render:e=>(0,j.jsx)(f().A,{...e}),actions:[...V().AQ.map((t=>Ce(t,e)))]})}}(e);return[(0,W().gy)({key:"text-color-section",title:ce.textColorSection,render:e=>(0,j.jsx)(f().A,{...e}),actions:t.actions}),(0,W().gy)({key:"background-color-section",title:ce.backgroundColorSection,render:e=>(0,j.jsx)(f().A,{...e}),actions:n.actions})]}function Ce(e,t,n,i){const s=i||(0,se().qo)(e),o=(0,W().Ls)({key:`color ${n||e}`,displayName:s,analyticsName:s.defaultMessage,fuzzySearchKeywords:(0,W().Mf)(e),validators:ke(t),action:({blocks:t,environment:n})=>{oe().createAndCommit({userAction:"actionRegistry.createSimpleTableColorAction",environment:n,canUndo:!0,perform:t=>{ae().wW(n,e,t)}})},closeParentMenu:!0,render:t=>(0,j.jsx)(H().Ay,{...t,color:e,overrideDisplayName:o.displayName}),nativeImageReference:({environment:t})=>(0,W().Kg)(t,e,n)});return o}const _e=(0,q().u)({key:"set column color",displayName:W().AY.colorName,analyticsName:W().AY.colorName.defaultMessage,svg:O().M,validators:ke("column"),subActions:()=>Te("column")}),Pe=(0,q().u)({key:"set row color",displayName:W().AY.colorName,analyticsName:W().AY.colorName.defaultMessage,svg:O().M,validators:ke("row"),subActions:()=>Te("row")}),Be=(0,q().u)({key:"set cell color",displayName:W().AY.colorName,analyticsName:W().AY.colorName.defaultMessage,svg:O().M,validators:ke("cell"),subActions:()=>Te("cell")}),Re=[(0,W().gy)({key:"cell section",render:e=>(0,j.jsx)(f().A,{...e}),actions:[Be,Ie]}),(0,W().gy)({key:"column section",render:e=>(0,j.jsx)(f().A,{...e}),actions:[ue,_e,ge,me,fe,ye,he]}),(0,W().gy)({key:"row section",render:e=>(0,j.jsx)(f().A,{...e}),actions:[pe,Pe,ve,be,Se,Me,xe]})];var De=()=>n(407054),Le=()=>n(817148),Ee=()=>n(381684),Oe=()=>n(419357),Ne=()=>n(962036);function Fe(){const e=(0,o().Y0)();return e.isMobileNative&&e.isIOS&&e.isPhone?(0,j.jsx)(Ue,{}):(0,j.jsx)(ze,{})}function Ue(){const e=(0,r().O$)(De().A);return(0,R().A)({shouldPreserveTextSelection:e.isActive,shouldPreserveBlockSelection:!1,shouldRestoreSelection:!0}),(0,j.jsx)(ze,{})}function ze(){const e=(0,o().Y0)(),t=(0,r().O$)(De().A);return(0,j.jsx)(c().zD,{popupType:e.isPhone?u().n.BottomSheet:u().n.Popup,bottomSheetInitialState:t.isActive?t.bottomSheetInitialState:void 0,open:t.isActive,originRect:t.isActive?t.originBlockRect:void 0,onDismiss:Ge,placementToOrigin:"bottom",alignmentToOrigin:"start",originGap:0,preventScaleTransition:!0,render:()=>(0,j.jsx)(Ke,{}),preventBlockRenderQueueOnEnter:s().A.isMobile,trapFocus:!0})}function Ke(){var e;const t=(0,o().v3)(),n=(0,o().WS)(),s=(0,p().Tf)(),c=(0,r().O$)(De().A),u=null===(e=c.stores)||void 0===e?void 0:e[0],f=(0,r().K8)((()=>null==u?void 0:u.isCollectionView()),[u]),k=(0,r().K8)((()=>c.isActive?function(e){switch(e){case"default":return(0,A().A2)();case"simple_table":case"simple_table_cell":return Re;case"page_mention":return T;case"sidebar_outliner":return I().LV;case"comment_media":return w;case"block_in_collection_timeline_view":return A().bH;case"block_in_collection":return A().SH;case"library":return A().xD;default:(0,S().HB)(e)}}(null==c?void 0:c.actionSectionGroupKey):[]),[c]),P=c.isActive&&!c.hideTitle,[B,R]=(0,m().$)(),D=(0,a().S)();if(!c.isActive||!u)return null;const{originBlockRect:E,inputValue:O,publicEditMode:N}=c||{},F={environment:t,blocks:c.stores,originRect:E,publicEditMode:N,analyticsFrom:c.analyticsFrom,pageContext:D},U=c.showInput&&(0,j.jsx)(We,{inputComboboxProps:B}),z=n?{menuType:p().gu.Modal,title:(0,j.jsx)(v().sA,{defaultMessage:"Actions",id:"blockMenu.actionButton.label"}),right:s?void 0:(0,j.jsx)(v().sA,{...d().W.done}),onClickRight:s?void 0:Ge,header:U}:{menuType:p().gu.Popup,width:265,header:U};return(0,j.jsx)(i().N,{debugName:"BlockMenu",capture:!0,onBackspace:b().D_,children:(0,j.jsxs)(g().A,{...z,children:[(0,j.jsx)(x().A,{filter:O,context:F,sections:k,onAccept:e=>function(e,t){const n=De().A.state;if(!n.isActive)return;const{stores:i}=L().default.state,{analyticsFrom:s,collectionContextStore:o}=n,a=i[0];if(a){const n=a.getParentTable(),i=a.getType();if(i&&n){let r;if(n===y().yK){const e=a.getParentId(),t=a.getSpaceStore();t&&void 0!==e&&(r=l().h.createChildStore(t,{table:y().yK,id:e}))}const d=(0,_().sl)(o)||{};(0,M().N)(t,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:s,block_id:a.id,block_type:i,parentTeamStore:r,is_toggleable:(0,h().Yt)(i,a.getFormat()),parent_collection_id:a.getParentCollectionIdUpToTwoLevels(),...d})}}e.closeParentMenu&&C().VN()}(e,t),initialFocus:O?0:void 0,comboboxProps:c.showInput?R:void 0,shouldShowBlockTypeTitle:P}),O||c.hideMetadata?void 0:(0,j.jsx)(qe,{}),O?void 0:(0,j.jsx)(Le().A,{store:u}),!O&&f?(0,j.jsx)(Ve,{}):void 0]})})}function Ve(){const[e,t]=(0,r().K8)((()=>{const e=De().A.state;if(!e.isActive)return[!1,!1];const t=e.stores[0];return[!0,(0,P().s)(t.id)]}),[]);return e?t?(0,j.jsx)(f().A,{topBorder:!0,children:(0,j.jsx)(Ne().g,{title:(0,j.jsx)(v().sA,{defaultMessage:"Learn about tasks",id:"myTasks.helpTooltip.title"}),href:D().hI,analyticsFrom:"block_menu"})}):(0,j.jsx)(f().A,{topBorder:!0,children:(0,j.jsx)(Ne().g,{title:(0,j.jsx)(v().sA,{defaultMessage:"Learn about databases",id:"blocks.blockMenu.collectionHelpButton"}),href:(0,B().x)("guides.database"),analyticsFrom:"block_menu"})}):null}function qe(){const e=(0,o().v3)().currentUser.isLoggedIn(),t=(0,r().K8)((()=>{if(!De().A.state.isActive)return;if(1!==De().A.state.stores.length)return;const e=De().A.state.stores[0];return!(0,P().s)(e.id)&&e.canEdit()?e:void 0}),[]);return e&&t?(0,j.jsx)(Ee().g,{store:t}):null}function We(e){const t=(0,v().tz)(),n=(0,o().WS)(),i=(0,r().O$)(De().A);if(!i.isActive||n)return null;const{inputValue:s}=i;return(0,j.jsx)(f().A,{isInput:!0,children:(0,j.jsx)(Oe().Ay,{value:s,onChange:He,focus:!0,focusAfterAnimation:!0,placeholder:t.formatMessage({defaultMessage:"Search actions…",id:"blockMenu.filterForActions.placeholder"}),preventCaptureDeleteWhenEmpty:!0,preventCaptureSpacebarWhenEmpty:!0,...e.inputComboboxProps})})}function Ge(){C().VN()}function He(e){De().A.state.isActive&&De().A.setState({...De().A.state,inputValue:e.target.value})}},273321:(e,t,n)=>{n.d(t,{A:()=>B});var i=n(296540),s=()=>n(907258),o=()=>n(726637),a=()=>n(790748),r=()=>n(590526),l=()=>n(401497),d=()=>n(128933),c=()=>n(302501),u=()=>n(424400),p=()=>n(713998),g=()=>n(797809),m=()=>n(69708),f=()=>n(100622),h=()=>n(284371),y=()=>n(710648),v=()=>n(862292),b=()=>n(381678),S=()=>n(480289),x=()=>n(737230),M=()=>n(441467),A=()=>n(848565),j=()=>n(473975),w=()=>n(555776),I=()=>n(116008),k=()=>n(811879),T=()=>n(846583),C=()=>n(686350),_=()=>n(105157),P=n(474848);function B(e){const t=(0,m().tz)(),{environment:n,menuListItemProps:B,shouldShowTopDividerLine:R,shouldShowBottomDividerLine:D,shouldExpandDiscussionWidth:L,noBackgroundColors:E,onMouseEnter:O,onMouseLeave:N,onFocus:F,onBlur:U,onMobileClose:z}=e,K=(0,r().O$)(s().AppStoreMainEditorCurrentBlockStore),V=(0,r().K8)((()=>(0,b()._)(n)),[n]),q=A().eQ,W=(0,r().K8)((()=>w().A.state.isActivelyComposing),[]),G=(0,r().K8)((()=>w().A.state.isHovered),[]),H=(0,i.useCallback)((()=>{null==O||O()}),[O]),Y=(0,i.useCallback)((()=>{null==N||N()}),[N]),$=(0,i.useCallback)((()=>{null==F||F()}),[F]),Q=(0,i.useCallback)((()=>{I().A.hasContent()?w().A.resetAllActiveSources():(I().A.reset(),w().A.reset()),null==U||U()}),[U]),Z=(0,i.useRef)(null);(0,a().b)(S().A,(()=>({getNode:()=>Z.current})),[]);const X=(0,l().IS)((()=>({menuDiscussionItem:{marginInlineStart:-14,marginInlineEnd:-14,width:"calc(100% + 28px)"},discussionContainer:{paddingTop:o().A.isMobile?4:6,borderTop:!o().A.isMobile&&R?`1px solid ${f().Tj.border.secondaryTranslucent}`:void 0,borderBottom:!o().A.isMobile&&D?`1px solid ${f().Tj.border.secondaryTranslucent}`:void 0,transition:"background 300ms ease",background:E?void 0:W?f().Tj.focusDiscussionBackground:G?f().Tj.hoveredDiscussionBackground:void 0},comment:{position:"relative",fontSize:o().A.isMobile?16:14},commentElementsBelowUserRow:{paddingInlineStart:A().FB},avatar:{marginTop:0,marginInlineEnd:o().A.isMobile?4:8,userSelect:"none",WebkitUserSelect:"none"},userRow:{display:"flex",flexDirection:"row",alignItems:"center",userSelect:"none",WebkitUserSelect:"none"},placeholder:{height:8,width:81,borderRadius:6,background:f().Tj.background.tertiaryTranslucent},draftLabel:{margin:"0 6px",flexBasis:140,whiteSpace:"normal",flexGrow:void 0,display:"inline",color:f().Tj.text.tertiary},container:{paddingTop:A().e4,paddingInlineEnd:16,paddingBottom:A().Wv,paddingInlineStart:16},noOverflow:{overflow:"hidden"},commentContext:{display:"flex",width:"100%",marginTop:6,marginBottom:22,fontSize:13,color:f().Tj.text.secondary},displayName:{fontWeight:h().Wy.medium,whiteSpace:"normal"},fullWidthFlex:{display:"flex",width:"100%"},smallTopPadding:{marginTop:1}})),[G,W,E,D,R]),J=(0,i.useCallback)((async()=>{const e=await v().T.formulas.load();M().i5({environment:n,allowActionsWhileCommenting:!0,formulasModule:e});const i=x().Ay.state.hasActiveDraftComment;o().A.isMobile&&i&&(d().D6({label:t.formatMessage({id:"draftComment.submitted.snackbar",defaultMessage:"Comment added"}),position:"bottom",style:{justifyContent:"center",textAlign:"center"}}),null==z||z())}),[n,t,z]),ee=(0,r().K8)((()=>!I().A.state.open||"reaction"===I().A.state.content),[]),te=(0,r().K8)((()=>{var e;return I().A.getBlockStore()??(null===(e=I().A.getClosestBlockStore())||void 0===e?void 0:e.parentBlockStore)}),[]),ne=(0,r().K8)((()=>I().A.getPropertyId()),[]),ie=(0,r().K8)((()=>{if(ne){var e;const t=null===(e=I().A.getBlockStore())||void 0===e?void 0:e.getAssociatedCollectionStore();if(!t||"collection"!==t.table)return;const n=t.getSchema();return(0,p()._g)({schema:n,property:ne})}}),[ne]),se=(0,r().K8)((()=>(0,g().RX)(t).title),[t]),oe=(0,r().O$)(I().f),ae=(0,r().K8)((()=>null==V?void 0:V.getDisplayName(t)),[V,t]),re=(0,r().K8)((()=>null==te?void 0:te.getSpaceId()),[te]),le=(0,r().K8)((()=>M().Ek({environment:n})),[n]),de=(0,r().K8)((()=>I().A.getType()),[]),ce=(0,r().K8)((()=>null==te?void 0:te.getValue()),[te]);if(ee||!se||!V||!te||!K||!oe||!re||!ce&&"block"===de||!le&&"inline"===de)return null;const ue="inline"===de||ne,pe="block"===de&&!ne?(0,P.jsx)(y().Ay,{blockValue:ce,rootStore:te,blockPreviewLocation:"comments_sidebar"}):ue?(0,P.jsx)(y().vY,{value:{value:(null==le?void 0:le.context)??[],spaceId:re},propertySchema:se,labeled:!1,rootStore:te,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableDateStyleAnnotations:!0}):null;return(0,P.jsx)("div",{style:X.discussionContainer,ref:Z,onClick:null==B?void 0:B.onClick,onMouseEnter:H,onMouseLeave:Y,children:(0,P.jsx)(u().Ay,{allowTextSelection:!0,style:X.menuDiscussionItem,title:(0,P.jsx)("div",{style:X.container,children:(0,P.jsxs)("div",{style:X.comment,children:[(0,P.jsxs)("div",{style:X.userRow,children:[(0,P.jsx)(k().E,{authorStore:V,avatarSize:q,avatarStyle:X.avatar}),(0,P.jsxs)("div",{style:X.noOverflow,children:[(0,P.jsx)("span",{style:X.displayName,children:ae||(0,P.jsx)("span",{style:X.placeholder})}),(0,P.jsx)(c().A,{isSmall:!o().A.isMobile,isSecondaryColor:!0,isMultiline:!0,style:X.draftLabel,children:(0,P.jsx)(m().sA,{defaultMessage:"Draft",id:"DraftCommentInputWithContext.draftLabel"})})]})]}),(0,P.jsxs)("div",{style:X.commentElementsBelowUserRow,children:[(0,P.jsx)("div",{style:X.commentContext,children:(0,P.jsxs)("div",{style:X.fullWidthFlex,children:[(0,P.jsx)(T().T,{}),ie?(0,P.jsx)(_().A,{propertySchema:ie}):void 0,(0,P.jsx)("div",{style:X.smallTopPadding,children:pe})]})}),(0,P.jsx)(C().V,{showAvatar:!1,parentStore:K,blockStore:te,onSubmit:J,discussionInputStore:oe,isNewComment:!0,isEditingExistingComment:!1,isMobileSlideUpMenu:!0,shouldSaveUnsentComments:!1,discussionFormat:j().DiscussionFormat.Sidebar,canDrop:!0,disableFocusRing:!0,adjustWidthForDraftDiscussions:L,dontMoveCursorToInputEndOnFocus:!0,onBlur:Q,onFocus:$},"draft-comment-sidebar")]})]})})})},"draft-comment-discussion-updates")}},274041:(e,t,n)=>{n.d(t,{$O:()=>a,cN:()=>r,fh:()=>o,h5:()=>l});var i=()=>n(79926);const s={PublicPagesSection:new(i().O2)("PublicPagesSection",(()=>Promise.all([n.e(25700),n.e(91325)]).then(n.bind(n,692536)))),DomainsSection:new(i().O2)("DomainsSection",(()=>Promise.all([n.e(29743),n.e(27229),n.e(56859)]).then(n.bind(n,275721)))),GeneralAccessPermissionSection:new(i().O2)("PublishedSiteSettings",(()=>Promise.all([n.e(48570),n.e(77651)]).then(n.bind(n,678250)))),FormShareMenu:new(i().O2)("FormShareMenu",(()=>Promise.all([n.e(25700),n.e(40456),n.e(51859)]).then(n.bind(n,532847))))},o=(0,i()._h)(s.PublicPagesSection,(e=>e.PublicPagesSection)),a=(0,i()._h)(s.DomainsSection,(e=>e.DomainsSection)),r=(0,i()._h)(s.GeneralAccessPermissionSection,(e=>e.GeneralAccessPermissionSection)),l=(0,i()._h)(s.FormShareMenu,(e=>e.FormShareMenu))},292395:(e,t,n)=>{function i(e){const{currentUsage:t,limit:n,periodStart:i}=e,s=new Date,o=new Date(i);o.setMonth(o.getMonth()+1);const a=o.getTime()-i.getTime(),r=(s.getTime()-i.getTime())/a,l=r>0?n*(t/n/r):0;return Math.ceil(l)}n.d(t,{A5:()=>i,SK:()=>s,gY:()=>o,kg:()=>a,wZ:()=>r});const s=.8;function o(e){if(!e||void 0===e.usage||void 0===e.limits)return;const t=(e.usage.currentServicePeriod.spaceUsage??0)/(e.limits.purchased.totalLimit??0);return Number.isNaN(t)||t===1/0?void 0:t}function a(e){return l({...e,checkThreshold:e=>e<1&&e>=s})}function r(e){return l({...e,checkThreshold:e=>e>=1})}async function l(e){const{environment:t,sidebarSpaceStore:n,experimentStore:i,aiUsageEligibilityStoreV2:s,checkThreshold:a}=e;if(!i.checkGate({gateName:"usage_based_pricing_pfa_checks_purchased_credits_enabled"}))return Promise.resolve(!1);const r=o(await s.awaitData(t,{spaceId:n.getSpaceId()}));return void 0===r?Promise.resolve(!1):Promise.resolve(a(r))}},295434:(e,t,n)=>{n.r(t),n.d(t,{iconDefinition:()=>s,zendeskIcon:()=>o});n(296540);var i=n(474848);const s={viewBox:"0 0 20 20",fittedViewBox:"1 3.14 18.01 13.71",svg:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("g",{className:"logo-light-mode",children:(0,i.jsx)("path",{fill:"#000",d:"M9.298 6.778v10.073H1zm0-3.633a4.16 4.16 0 0 1-4.17 4.17C2.817 7.315 1 5.457 1 3.145zm1.363 13.665a4.16 4.16 0 0 1 4.17-4.17A4.16 4.16 0 0 1 19 16.81zm0-3.592V3.145H19z"})}),(0,i.jsx)("g",{className:"logo-dark-mode",children:(0,i.jsx)("path",{fill:"#fff",d:"M9.298 6.778v10.073H1zm0-3.633a4.16 4.16 0 0 1-4.17 4.17C2.817 7.315 1 5.457 1 3.145zm1.363 13.665a4.16 4.16 0 0 1 4.17-4.17A4.16 4.16 0 0 1 19 16.81zm0-3.592V3.145H19z"})})]})},o=(0,n(340498).wt)("zendesk",s,"default")},296431:(e,t,n)=>{n.r(t),n.d(t,{CreateTeamFromPageConfirmModal:()=>b});n(296540);var i=()=>n(484714),s=()=>n(590526),o=()=>n(401497),a=()=>n(560729),r=()=>n(249046),l=()=>n(807449),d=()=>n(406094),c=()=>n(160432),u=()=>n(3284),p=()=>n(69708),g=()=>n(100622),m=()=>n(284371),f=()=>n(475355),h=()=>n(108414),y=()=>n(812941),v=n(474848);function b(){const e=(0,i().v3)(),t=(0,p().tz)(),n=(0,o().IS)((()=>({modal:{maxWidth:350,padding:24},title:{marginTop:16,marginBottom:12,color:g().Tj.text.primary,fontWeight:m().Wy.semibold,fontSize:18},description:{color:g().Tj.darkTextColor,textAlign:"center",fontSize:14,marginBottom:18},confirmButton:{width:"100%",marginBottom:8},cancelButton:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:14}})),[]),b=(0,s().K8)((()=>h().A.state.open),[]);return(0,v.jsx)(a().A,{onDismiss:()=>{h().A.setState({open:!1})},render:()=>(0,v.jsx)("div",{style:n.modal,children:(0,v.jsxs)(r().Ye,{flexDirection:"column",justifyContent:"center",alignItems:"center",children:[(0,v.jsx)(l().I,{icon:u().arrowSquarePathUpDownIcon,size:"xl",colorVariant:"accentPrimary"}),(0,v.jsx)("div",{style:n.title,children:(0,v.jsx)(p().sA,{id:"createTeamFromPage.confirmModal.title",defaultMessage:"Turn into teamspace?"})}),(0,v.jsx)("div",{style:n.description,children:(0,v.jsx)(p().sA,{id:"createTeamFromPage.confirmModal.description",defaultMessage:"This will move this page into a newly created teamspace along with people who already have access to this page."})}),(0,v.jsx)(c().A,{colorPalette:"blue",size:"lg",style:n.confirmButton,onClick:()=>{if(h().A.state.open){const{pageStore:n,flowId:i}=h().A.state;f().v4({environment:e,intl:t,page:n,flowId:i}),h().A.setState({open:!1})}},children:(0,v.jsx)(p().sA,{id:"createTeamFromPage.confirmModal.confirmButton",defaultMessage:"Create teamspace"})}),(0,v.jsx)(d().A,{size:"lg",style:n.cancelButton,onClick:()=>h().A.setState({open:!1}),children:(0,v.jsx)(p().sA,{id:"createTeamFromPage.confirmModal.cancelButton",defaultMessage:"Cancel"})}),(0,v.jsx)(y().A,{message:(0,v.jsx)(p().sA,{id:"createTeamFromPage.confirmModal.learnMore",defaultMessage:"Learn more about teamspaces"}),analyticsFrom:"teams_learn_more_turn_page_into_team",helpCenterLocation:"bestPractices"})]})}),isOpen:b})}},300451:(e,t,n)=>{n.d(t,{A:()=>s});class i extends(()=>n(757695))().Store{getInitialState(){return{settingOpen:"initial",permissionItem:void 0,from:void 0,sudoModeStore:void 0,location:"",faviconUrl:null,previewImageUrl:null,hideBreadcrumbs:!1,hideLikeButton:!1,hideSearch:!1,hideWatermark:!1,enableDuplicateAsTemplate:!1,hideShare:!1,customHeaderBlockIds:[],googleAnalyticsId:void 0,theme:void 0,hideUpsellBanner:!1}}}const s=new i},303893:(e,t,n)=>{n.r(t),n.d(t,{ShareMenuContainer:()=>ms});var i=n(296540),s=()=>n(230711),o=()=>n(717137),a=()=>n(726637),r=()=>n(484714),l=()=>n(590526),d=()=>n(401497),c=()=>n(79926),u=()=>n(882722),p=()=>n(755125),g=()=>n(245720),m=()=>n(546926),f=()=>n(302501),h=()=>n(890492),y=()=>n(179034),v=()=>n(69708),b=()=>n(100622),S=()=>n(64901),x=()=>n(232930),M=()=>n(131448),A=()=>n(440024),j=()=>n(146842),w=()=>n(118307),I=()=>n(463438),k=()=>n(284371),T=()=>n(115512),C=()=>n(117183),_=()=>n(678250),P=n(474848);function B(e){const{store:t,calculatedPermissions:n,permissionItemArgs:i,onClose:s}=e,r=(0,d().IS)((()=>({title:{fontSize:16},topbarStyle:{paddingTop:15,paddingBottom:15,height:"auto",background:a().A.isMobile?b().Tj.background.primary:void 0}})),[]),c=(0,l().uB)(void 0,w().A),p=a().A.isMobile?{menuType:m().gu.Modal,disableHeaderShadow:!0,title:(0,P.jsx)(f().A,{style:r.title,children:(0,P.jsx)(v().sA,{defaultMessage:"Share",id:"loggedOutShareMenu.title"})}),topbarStyle:r.topbarStyle,right:(0,P.jsx)(v().sA,{...g().W.done}),onClickRight:s,whiteBackground:!0}:{menuType:m().gu.Popup,maxHeight:"90vh"};return(0,P.jsx)(h().A,{...p,className:u().NXe,children:(0,P.jsx)(o().A,{debugName:"LoggedOutShareMenuContainer",capture:!0,allowEsc:!0,children:(0,P.jsx)(R,{store:t,calculatedPermissions:n,permissionItemArgs:i,buttonPopupStore:c})})})}function R({store:e,calculatedPermissions:t,permissionItemArgs:n,buttonPopupStore:s}){const o=(0,r().v3)(),l=(0,d().IS)((()=>({tabStyle:{color:b().Tj.text.tertiary,...a().A.isMobile&&{width:"50%",textAlign:"center"}},selectedTabStyle:{fontWeight:k().Wy.medium},tabTitleStyle:{color:"inherit",fontSize:T().vQ,fontWeight:k().Wy.medium},style:a().A.isMobile?{marginBottom:8,justifyContent:"space-between"}:{marginBottom:16,paddingInlineStart:16},tabBorderStyle:{insetInlineStart:0,insetInlineEnd:0}})),[]),c=[(0,P.jsx)(i.Fragment,{children:(0,P.jsx)(v().sA,{defaultMessage:"Share",id:"shareMenu.shareTab.title"},"share")},"title")];return(0,i.useEffect)((()=>{(0,A().I)({environment:o}),(0,p().clear)({environment:o})}),[o]),(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(I().LZ,{...l,tabs:c,selectedIndex:0,onChange:()=>{}}),(0,P.jsx)(_().GeneralAccessPermissionSection,{store:e,calculatedPermissions:t,permissionItemArgs:n}),(0,P.jsx)(C().A,{store:e,buttonPopupStore:s,calculatedPermissions:t,permissionItemArgs:n})]})}var D=()=>n(326589),L=()=>n(315841),E=()=>n(159026),O=()=>n(103674),N=()=>n(726360),F=()=>n(928074),U=()=>n(437487),z=()=>n(134696),K=()=>n(495867),V=()=>n(534177),q=()=>n(475355);async function W(e,t,n,i,s){if(s.state.inviteStage===E().d5.closed||s.state.inviteStage===E().d5.share_page)return;const{selection:o}=s.state;switch(o){case E().NJ.request_workspace_member:z().RH(e,{...K().nE(e,s),from:"share_menu"}),await K().xi({environment:e,spaceStore:t,originId:n.id,originType:"share_menu",reasonMessage:void 0,contextualInviteStore:s,intl:i});break;case E().NJ.workspace_member:z()._u(e,K().nE(e,s));const a=s.state.invitedUsers.length>0;if(!t.isTeamsEnabled()&&a){s.setState({...s.state,inviteStage:E().d5.closed});if(!(await q().oH({environment:e,flowId:s.state.flowId??"",trackCreateTeamComplete:!1})))return}await K().Lg({environment:e,spaceStore:t,contextualInviteStore:s,from:"page_contextual_invite",intl:i});break;case E().NJ.page_guest:case E().NJ.unselected:case E().NJ.closed:z().l8(e,K().nE(e,s)),s.reset();break;default:(0,V().HB)(o)}}n(581454);var G=()=>n(699143),H=()=>n(577914),Y=()=>n(807449),$=()=>n(406094),Q=()=>n(493552),Z=()=>n(575157),X=()=>n(90907),J=()=>n(835607),ee=()=>n(792071),te=()=>n(798880),ne=()=>n(694894),ie=()=>n(453697);function se({users:e}){const t=(0,d().IS)((()=>({avatarsContainer:{marginInlineStart:"16px",display:"flex"},avatarWrapper:{marginInlineStart:"-16px"},upgradeWrapper:{alignSelf:"end",marginInlineStart:"-14px",borderRadius:"50%",background:b().Tj.background.secondary}})),[]);return(0,P.jsxs)("div",{style:t.avatarsContainer,children:[e.slice(0,10).map(((e,n)=>(0,P.jsx)("div",{style:t.avatarWrapper,children:(0,P.jsx)(ie().A,{userValue:e,size:40})},n))),(0,P.jsx)("div",{style:t.upgradeWrapper,children:(0,P.jsx)(Y().I,{icon:ne().arrowInCircleUpFillSmallIcon,size:"sm",colorPalette:"blue",colorVariant:"accentPrimary",fitToViewBox:"all"})})]})}function oe(e){const{guestEmails:t,spaceStore:n,contextualInviteStore:i,blockStore:s,paysPerSeat:o}=e,a=(0,r().v3)(),c=(0,v().tz)(),p=(0,l().K8)((()=>i.state.inviteStage===E().d5.request_workspace),[i]),g=(0,l().K8)((()=>t.map((e=>{const t=i.state.invitedEmailToUserIdMap[e];return ee().Bj6.fromValue(te().oo,{id:t,email:e,version:1})}))),[i,t]),m=(0,d().IS)((()=>({cta:{flex:1},facepileContainer:{display:"flex",justifyContent:"center"}})),[]);return(0,P.jsxs)("div",{className:u().NXe,children:[(0,P.jsx)(H().R,{onClick:()=>i.reset()}),(0,P.jsxs)(G().Y1,{padding:"24px 22px 18px 22px",gap:24,children:[(0,P.jsxs)(G().Y1,{gap:20,children:[(0,P.jsx)("div",{style:m.facepileContainer,children:(0,P.jsx)(se,{users:g})}),(0,P.jsxs)(G().Y1,{gap:8,children:[(0,P.jsx)(Q().D,{styleKey:"titleSmSemibold",children:(0,P.jsx)(v().sA,{id:"ContextualInvite.variantD.header",defaultMessage:"{inviteCount, plural, one {Upgrade guest to member?} other {Upgrade {inviteCount} guests to members?}}",values:{inviteCount:t.length}})}),(0,P.jsxs)(G().Y1,{gap:20,children:[(0,P.jsx)(Q().D,{styleKey:"bodyRegular",colorVariant:"secondary",children:o?p?(0,P.jsx)(v().sA,{id:"ContextualInvite.variantD.description.request",defaultMessage:"{otherInviteCount, plural, =0 {{firstGuest} will have access to these features.} one {{firstGuest} and 1 other will have access to these features.} other {{firstGuest} and {otherInviteCount} others will have access to these features.}} A workspace admin will review your request.",values:{firstGuest:t[0],otherInviteCount:t.length-1}}):(0,P.jsx)(v().sA,{id:"ContextualInvite.variantD.description",defaultMessage:"{otherInviteCount, plural, =0 {{firstGuest} will have access to these features} one {{firstGuest} and 1 other will have access to these features} other {{firstGuest} and {otherInviteCount} others will have access to these features}} and {totalInviteCount, plural, one {this workspace will be billed for 1 member} other {this workspace will be billed for {totalInviteCount} members}}",values:{firstGuest:t[0],totalInviteCount:t.length,otherInviteCount:t.length-1}}):(0,P.jsx)(v().sA,{id:"ContextualInvite.variantD.description.free",defaultMessage:"{otherInviteCount, plural, =0 {{firstGuest} will have access to these features} one {{firstGuest} and 1 other will have access to these features} other {{firstGuest} and {otherInviteCount} others will have access to these features}}",values:{firstGuest:t[0],otherInviteCount:t.length-1}})}),(0,P.jsxs)(G().Y1,{gap:14,children:[(0,P.jsxs)(G().Y1,{gap:8,direction:"horizontal",align:"center-left",children:[(0,P.jsx)(Y().I,{icon:X().lockIcon,colorVariant:"secondary"}),(0,P.jsx)(Q().D,{styleKey:"bodyRegular",children:(0,P.jsx)(v().sA,{id:"ContextualInvite.variantD.memberBenefits.private",defaultMessage:"Create private pages and drafts"})})]}),(0,P.jsxs)(G().Y1,{gap:8,direction:"horizontal",align:"center-left",children:[(0,P.jsx)(Y().I,{icon:Z().D,colorVariant:"secondary"}),(0,P.jsx)(Q().D,{styleKey:"bodyRegular",children:(0,P.jsx)(v().sA,{id:"ContextualInvite.variantD.memberBenefits.public",defaultMessage:"Access all public pages in the workspace"})})]}),(0,P.jsxs)(G().Y1,{gap:8,direction:"horizontal",align:"center-left",children:[(0,P.jsx)(Y().I,{icon:J().F,colorVariant:"secondary"}),(0,P.jsx)(Q().D,{styleKey:"bodyRegular",children:(0,P.jsx)(v().sA,{id:"ContextualInvite.variantD.memberBenefits.collaboration",defaultMessage:"Unlimited collaboration with others"})})]})]})]})]})]}),(0,P.jsxs)(G().Y1,{direction:"horizontal",gap:10,children:[(0,P.jsx)($().A,{size:"lg",style:m.cta,onClick:async()=>{!function(e){e.setState({...e.state,selection:E().NJ.page_guest})}(i),await W(a,n,s,c,i)},children:(0,P.jsx)(v().sA,{id:"contextualInvite.skip.button",defaultMessage:"Skip for now"})}),(0,P.jsx)($().A,{size:"lg",style:m.cta,onClick:async()=>{i.state.inviteStage===E().d5.share_workspace&&function(e){e.setState({...e.state,selection:E().NJ.workspace_member})}(i),i.state.inviteStage===E().d5.request_workspace&&function(e){e.setState({...e.state,selection:E().NJ.request_workspace_member})}(i),await W(a,n,s,c,i)},children:p?(0,P.jsx)(v().sA,{id:"ContextualInvite.variantD.request",defaultMessage:"Request upgrade"}):(0,P.jsx)(v().sA,{id:"ContextualInvite.variantD.upgrade",defaultMessage:"Upgrade to member"})})]})]})]})}function ae(e){const{spaceStore:t,blockStore:i}=e,s=(0,r().v3)(),o=(0,n(741615).lh)({spaceId:t.id}),a=(0,l().K8)((()=>(0,n(957606).L3)(o)),[o]),d=(0,l().uB)(e.contextualInviteStore,E().Ay),c=n(795523).OK(o),u=(0,l().K8)((()=>d.getGuestEmails()),[d]),p=(0,l().K8)((()=>(0,n(78846).h)(t)),[t]);return(0,n(852507).l)((()=>{!function(e,t){t&&e.setState({...e.state,selection:E().NJ.page_guest})}(d,a),z().bT(s,K().nE(s,d))})),u.length?(0,P.jsx)(oe,{contextualInviteStore:d,spaceStore:t,blockStore:i,useZeroTeamsExperience:a,paysPerSeat:c,guestEmails:u,useGuestInviteRequestExperience:p}):null}const re=i.memo(ae);var le=()=>n(59226),de=()=>n(340498);const ce={viewBox:"0 0 20 20",fittedViewBox:"1.94 3.32 16.21 13.33",svg:(0,P.jsx)("path",{d:"M10.064 14.15a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5M4.607 3.458a.55.55 0 0 1 .776.06l.23.267.004.007 8.769 10.23a.55.55 0 0 1-.839.712l-2.63-3.067a3.82 3.82 0 0 0-3.561 1.026.626.626 0 0 1-.885-.885 5.07 5.07 0 0 1 3.299-1.48L8.385 8.712a6.9 6.9 0 0 0-3.194 1.816.626.626 0 0 1-.885-.885 8.16 8.16 0 0 1 3.188-1.97L6.237 6.206A10 10 0 0 0 2.987 8.4a.626.626 0 0 1-.888-.879 11.3 11.3 0 0 1 3.29-2.305l-.842-.982a.55.55 0 0 1 .06-.776m5.456 3.797c2.246 0 4.283.915 5.756 2.388a.626.626 0 0 1-.883.885 6.9 6.9 0 0 0-3.748-1.93l-1.152-1.343zm0-3.063c3.09 0 5.894 1.258 7.922 3.286a.626.626 0 0 1-.884.884 9.93 9.93 0 0 0-8.523-2.808l-.94-1.095a11 11 0 0 1 2.425-.267"})},ue=(0,de().wt)("wifiSlash",ce,"default");var pe=()=>n(114871),ge=()=>n(95001),me=()=>n(249046),fe=()=>n(388926),he=()=>n(160432),ye=()=>n(558687),ve=()=>n(187820),be=()=>n(342990);function Se(e){const{store:t}=e,n=(0,d().IS)((()=>({button:{alignSelf:"stretch"}})),[]);return(0,P.jsxs)(G().Y1,{direction:"vertical",align:"center",gap:12,children:[(0,P.jsxs)(G().Y1,{direction:"vertical",align:"center",gap:2,children:[(0,P.jsx)(Q().D,{styleKey:"titleSmSemibold",children:(0,P.jsx)(v().sA,{id:"shareMenu.publishAgentTab.title",defaultMessage:"Publish agent"})}),(0,P.jsx)(Q().D,{styleKey:"bodyRegular",colorVariant:"secondary",children:(0,P.jsx)(v().sA,{id:"shareMenu.publishAgentTab.description",defaultMessage:"Share your page as an agent template"})})]}),(0,P.jsx)(xe,{store:t}),(0,P.jsx)(G().Y1,{padding:18,direction:"vertical",align:"center",children:(0,P.jsx)(he().A,{colorPalette:"blue",size:"lg",style:n.button,children:(0,P.jsx)(v().sA,{id:"shareMenu.publishAgentTab.publish",defaultMessage:"Publish"})})})]})}function xe(e){const{store:t,overlayWidth:n="100%"}=e,i=(0,d().IS)((()=>({container:{display:"flex",alignSelf:"stretch",flexDirection:"column",width:"92%",marginInlineStart:"auto",marginInlineEnd:"auto",borderStartEndRadius:6,borderStartStartRadius:6,boxShadow:b().Tj.shadowSM}})),[]);return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsxs)("div",{style:i.container,children:[(0,P.jsx)(be().A,{size:"small",location:"publish_preview"}),(0,P.jsx)(fe().A,{size:1}),(0,P.jsx)(Me,{store:t}),(0,P.jsx)(fe().A,{size:1}),(0,P.jsx)(Ae,{store:t})]}),(0,P.jsx)(we,{width:n})]})}function Me(e){const{store:t}=e,n=(0,l().K8)((()=>t.getIcon()),[t]),i=(0,l().K8)((()=>t.getName()),[t]),s=(0,d().IS)((()=>({container:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingTop:6,paddingBottom:6,paddingInlineStart:8,paddingInlineEnd:12},leftContainer:{display:"flex",alignItems:"center",gap:4}})),[]);return(0,P.jsxs)("div",{style:s.container,children:[(0,P.jsxs)("div",{style:s.leftContainer,children:[n?(0,P.jsx)(ve().B6,{disabled:!0,icon:n,isEmptyPage:!1,disableShrinking:!0,size:12,emojiSize:12,style:{marginInlineEnd:4}}):void 0,(0,P.jsx)(Q().D,{styleKey:"captionRegular",colorVariant:"secondary",children:i})]}),(0,P.jsx)(je,{})]})}function Ae(e){const{store:t}=e,n=(0,l().K8)((()=>t.getIcon()),[t]),i=(0,l().K8)((()=>t.getName()),[t]),s=(0,d().IS)((()=>({container:{paddingTop:24,display:"flex",flexDirection:"column",gap:8},pageIcon:{marginInlineStart:48},contentContainer:{marginTop:n?0:8,marginInlineStart:32,marginInlineEnd:32,paddingInlineStart:16,paddingInlineEnd:16},pageTitleContainer:{...k().RC}})),[n]);return(0,P.jsxs)("div",{style:s.container,children:[n?(0,P.jsx)(ve().B6,{disabled:!0,icon:n,isEmptyPage:!1,isLarge:!0,disableShrinking:!0,size:42,emojiSize:42,largeIcon:!0,style:s.pageIcon}):void 0,(0,P.jsx)(me().wt,{gap:8,style:s.contentContainer,children:(0,P.jsx)("div",{style:s.pageTitleContainer,children:(0,P.jsx)(Q().D,{styleKey:"titleLgSemibold",children:i})})})]})}function je(){const e=(0,d().IS)((()=>({container:{border:`1px solid ${b().Tj.border.primaryTranslucent}`,borderRadius:4,flexShrink:0,display:"flex",flexDirection:"row",alignItems:"center",gap:4,padding:"2px 6px"}})),[]);return(0,P.jsxs)("div",{style:e.container,children:[(0,P.jsx)(Q().D,{styleKey:"captionMedium",children:(0,P.jsx)(v().sA,{defaultMessage:"Made with",id:"publishSiteSettings.topbar.madeWithPreview"})}),(0,P.jsx)(Y().I,{icon:ye().notionIcon,size:"xxs",fitToViewBox:"horizontal"})]})}function we(e){const{width:t="100%"}=e,n=(0,d().IS)((()=>({container:{position:"relative",width:t},overlay:{width:"100%",position:"absolute",background:`linear-gradient(to bottom, transparent, ${b().Tj.background.elevated} 100%)`,height:58,insetInlineStart:0,bottom:0}})),[t]);return(0,P.jsx)("div",{style:n.container,children:(0,P.jsx)("div",{style:n.overlay})})}var Ie=()=>n(962277);function ke(e){const{store:t,mostPermissivePublicItem:n,permissionItemArgs:i}=e,{permissionItem:s}=n;return(0,l().K8)((()=>(0,Ie().W)(s)),[s])?(0,P.jsx)(L().d,{store:t,mostPermissivePublicItem:n,sudoModeStore:i.sudoModeStore,location:i.location,showManageAllDomains:!0,showAllPublishedSites:!0,shouldAskForConfirmationOnPublish:!1}):(0,P.jsx)(L().Js,{store:t,mostPermissivePublicItem:n,sudoModeStore:i.sudoModeStore,location:i.location})}n(898992),n(354520);var Te=()=>n(907258),Ce=()=>n(242422),_e=()=>n(782482),Pe=()=>n(74351),Be=()=>n(452004),Re=()=>n(842599),De=()=>n(529601),Le=()=>n(196131),Ee=()=>n(84262),Oe=()=>n(366858),Ne=()=>n(743260),Fe=()=>n(519735),Ue=()=>n(789180),ze=()=>n(308227),Ke=()=>n(789586),Ve=()=>n(528093),qe=()=>n(616092),We=()=>n(717162),Ge=()=>n(623275);var He=()=>n(532940);function Ye(){const e=(0,d().IS)((()=>({banner:{...(0,Ge().kJ)(),display:"flex",flexDirection:"row",alignItems:"flex-start",gap:8,backgroundColor:b().Tj.red.background.secondary},content:{display:"flex",alignItems:"flex-start",gap:2,flex:"1 0 0"},label:{fontSize:T().vQ,lineHeight:"20px",color:b().Tj.red.text.secondary,flex:"1 0 0",paddingInlineStart:4},iconContainer:{paddingTop:2,height:20,width:20,display:"flex",alignItems:"center",justifyContent:"center"},icon:{fill:b().Tj.red.icon.secondary}})),[]);return(0,P.jsx)("div",{style:e.banner,children:(0,P.jsxs)("div",{style:e.content,children:[(0,P.jsx)("div",{style:e.iconContainer,children:(0,P.jsx)(Y().I,{icon:He().exclamationMarkTriangleIcon,style:e.icon})}),(0,P.jsx)(f().A,{style:e.label,isMultiline:!0,children:(0,P.jsx)(v().sA,{id:"agentProfileShareWarning.description",defaultMessage:"When you share access to this page, others can update this profile and influence your Notion AI’s behavior"})})]})})}var $e=()=>n(983610),Qe=()=>n(265060),Ze=()=>n(124092),Xe=()=>n(568999),Je=()=>n(622963),et=()=>n(751735),tt=()=>n(940241),nt=()=>n(404141),it=()=>n(408095);function st(e){const{spaceId:t,userId:n,spaceModel:i,spaceUserModel:s,teamModel:o,domains:a,blockStore:r}=e,c=(0,v().tz)(),u=(0,Ve()._)({name:"internal_guests",spaceId:t,userId:n,amount:1}),p=(0,tt().o)({store:r}),g=(0,Ke().P)({name:"non_admin_members",spaceId:t,userId:n}),m=(0,d().IS)((()=>{const e=u&&!(0,Ee().e2)(u),t=e?20:5,n=e?b().Tj.palette.orange[100]:"transparent",i=e?b().Tj.palette.orange[400]:b().Tj.blue.background.accentPrimary;return{container:{borderImage:`repeating-linear-gradient(-45deg, ${n}, ${n} ${t}px, ${i} ${t}px, ${i} ${2*t}px) 5 0`,borderTopWidth:4,borderInlineEndWidth:0,borderBottomWidth:0,borderInlineStartWidth:0,borderStyle:"solid",background:e?(0,et().X4)(b().Tj.palette.orange[400],.15):(0,et().X4)(b().Tj.blue.background.accentPrimary,.15),position:"relative",padding:10,zIndex:5},fill:{background:b().Tj.background.elevated,border:`1px solid ${b().Tj.border.secondary}`},button:{height:"auto",width:"calc(100% + 16px)",padding:8,margin:-8}}}),[u]),f=(0,l().K8)((()=>{var e;const t=(0,Je()._y)((null===(e=$e().subscriptionDataStoreInstance.state)||void 0===e?void 0:e.subscriptionTier)??"free");return it().qY[t].label}),[]),h=(0,l().K8)((()=>null==s?void 0:s.isWorkspaceOwner()),[s]),y=(0,l().K8)((()=>null==s?void 0:s.isMember()),[s]);let S;S=h?"You are a workspace owner":y?"You are a member":"You are a guest";const x=(0,l().K8)((()=>[{label:"Allow members to invite guests to pages",isEnabled:!!i&&i.getDisableGuests()},{label:"Allow members to request adding guests",isEnabled:(null==i?void 0:i.getSettings().enable_guest_invite_requests)??!1},{label:"Allow members to request adding other members",isEnabled:!(null!=i&&i.getSettings().disable_membership_requests)}]),[i]),M=(0,l().K8)((()=>[{label:"Disable guests",isEnabled:(null==o?void 0:o.getSettings().disable_guests)??!1}]),[o]),A=(0,l().K8)((()=>{if(!i||!a||!s)return;const{autojoinDomains:e}=(0,De().SJ)({space:i,spaceUser:s,domains:a});return e}),[i,s,a]),j=(0,l().K8)((()=>{if(!i||!s)return;const{type:e}=(0,De().yQ)({space:i,spaceUser:s,team:o,publicPageDataGuestSetting:p});switch(e){case"can_add":return"You can add guests.";case"can_request":return"You can request to add guests.";case"cannot_add":return"You can't add or request to add guests.";default:(0,V().HB)(e)}}),[i,s,o,p]),w=(0,l().K8)((()=>{if(!i||!a||!s)return;const{type:e}=(0,De().SJ)({space:i,spaceUser:s,domains:a});switch(e){case"can_add":return"You can add members.";case"can_request":return"You can request to add members.";case"cannot_add":return"You can't add or request to add members.";default:(0,V().HB)(e)}}),[i,s,a]),I=(0,l().K8)((()=>{if(!i||!s||!a)return!1;return"can_add"===(0,De().SJ)({space:i,spaceUser:s,domains:a}).type}),[i,s,a]),k=(0,l().K8)((()=>{if(!u)return;const e=u.type;switch(e){case"available":return"You can add an internal guest.";case"unavailable":return I?g?"Internal guests will be added to the space with member access.":"Internal guests will be added to the space with workspace owner access.":"You can't add internal guests.";default:(0,V().HB)(e)}}),[u,g,I]),T=(0,l().K8)((()=>{if(!u)return"Guest limit data is unavailable";if("cumulative"===u.limit.type){const{current:e,total:t}=u.limit;return"unlimited"===t?"No guest limit":`Space has ${e} of ${t} guests`}}),[u]),C=e=>{nt().Ay.setState({open:!0,openedFrom:"misc",currentTab:e,defaultSubtab:void 0,highlightedSetting:void 0})};return(0,P.jsxs)(G().Y1,{gap:10,style:m.container,children:[(0,P.jsxs)(G().Y1,{gap:12,borderRadius:6,padding:10,style:m.fill,children:[(0,P.jsx)(Ze().p,{onClick:()=>C("security"),style:m.button,children:(0,P.jsxs)(G().Y1,{gap:4,children:[(0,P.jsx)(Q().D,{styleKey:"captionMedium",children:"Space security settings"}),x.map(((e,t)=>(0,P.jsxs)(G().Y1,{direction:"horizontal",gap:4,align:"center-left",children:[(0,P.jsx)(ot,{isEnabled:e.isEnabled}),(0,P.jsx)(Q().D,{colorVariant:e.isEnabled?"secondary":"tertiary",styleKey:"captionRegular",children:e.label})]},t)))]})}),(0,P.jsxs)(G().Y1,{gap:4,children:[(0,P.jsx)(Q().D,{styleKey:"captionMedium",children:"Team security settings"}),M.map(((e,t)=>(0,P.jsxs)(G().Y1,{direction:"horizontal",gap:4,align:"center-left",children:[(0,P.jsx)(ot,{isEnabled:e.isEnabled}),(0,P.jsx)(Q().D,{colorVariant:e.isEnabled?"secondary":"tertiary",styleKey:"captionRegular",children:e.label})]},t)))]}),(0,P.jsx)(Ze().p,{onClick:()=>C("billing"),style:m.button,children:(0,P.jsxs)(G().Y1,{gap:4,children:[(0,P.jsx)(Q().D,{styleKey:"captionMedium",children:"Subscription"}),(0,P.jsx)(Q().D,{styleKey:"captionRegular",colorVariant:"secondary",children:`${c.formatMessage(f)} plan`}),(0,P.jsx)(Q().D,{colorVariant:"secondary",styleKey:"captionRegular",children:T})]})}),(0,P.jsx)(Ze().p,{onClick:()=>C("settings"),style:m.button,children:(0,P.jsxs)(G().Y1,{gap:4,children:[(0,P.jsx)(Q().D,{styleKey:"captionMedium",children:"Allowed email domains"}),null==A?void 0:A.map((e=>(0,P.jsx)(Q().D,{styleKey:"captionRegular",colorVariant:"secondary",children:e},e))),0===(null==A?void 0:A.length)?(0,P.jsx)(Q().D,{styleKey:"captionRegular",colorVariant:"secondary",children:"None"}):void 0]})})]}),(0,P.jsxs)(G().Y1,{gap:4,borderRadius:6,padding:10,style:m.fill,children:[(0,P.jsx)(Q().D,{styleKey:"captionMedium",children:S}),(0,P.jsx)(Q().D,{styleKey:"captionRegular",colorVariant:"secondary",children:w}),(0,P.jsx)(Q().D,{styleKey:"captionRegular",colorVariant:"secondary",children:j}),(0,P.jsx)(Q().D,{styleKey:"captionRegular",colorVariant:"secondary",children:k})]})]})}function ot(e){const{isEnabled:t}=e,n=(0,d().IS)((()=>({circle:{width:10,height:10,borderRadius:"50%",border:`1px solid ${b().Tj.gray.border.primaryTranslucent}`}})),[]);return t?(0,P.jsx)(Qe().Q,{iconGroup:Xe().g,variantName:"fillSmall",size:"xs",colorVariant:"secondary"}):(0,P.jsx)(G().Y1,{width:14,height:14,align:"center",children:(0,P.jsx)("div",{style:n.circle})})}var at=()=>n(611648),rt=()=>n(365917),lt=()=>n(617871),dt=()=>n(376254),ct=()=>n(549200),ut=()=>n(321172),pt=()=>n(31511),gt=()=>n(456328);function mt(e){const{shouldShowLengthWarning:t,shouldShowLinkWarning:n,value:i,maxLength:s}=e,o=(0,d().IS)((()=>({container:{position:"absolute",top:0,display:"flex",justifyContent:"center",fontSize:12,color:b().Tj.text.tertiary,width:"100%"},warning:{display:"flex",justifyContent:"center",width:"calc(100% - 36px)",backgroundColor:b().Tj.background.elevated,marginTop:1}})),[]);return(0,P.jsx)("div",{style:o.container,children:(0,P.jsxs)("div",{style:o.warning,children:[t?(0,P.jsx)(v().sA,{defaultMessage:"{characters} / {maxCharacters} characters",id:"ContextualInvite.permissions_invites.messageLengthWarning",values:{characters:i.length,maxCharacters:s}}):void 0,t&&n?" · ":void 0,n?(0,P.jsx)(v().sA,{defaultMessage:"Links will be omitted from your message",id:"ContextualInvite.permissions_invites.removeLinkWarning"}):void 0]})})}const ft=100;function ht(e){const{open:t,focus:n,value:i,maxLength:s,onFocus:o,onChange:a,onCancel:r}=e,l=(0,v().tz)(),c=i.length/s>=.8,u=(0,gt().BS)(i),p=c||u,g=(0,d().IS)((()=>({container:{maxHeight:t?ft:0,position:"absolute",bottom:0,width:"100%",backgroundColor:b().Tj.background.elevated,pointerEvents:t?"all":"none",transitionProperty:"max-height",transitionDuration:"0.3s",boxShadow:"0px -4px 4px rgba(0, 0, 0, 0.03)",overflow:"hidden",zIndex:1},input:{maxHeight:t?100:0,borderTop:1,borderTopStyle:"solid",borderTopColor:b().Tj.border.secondaryTranslucent,padding:18,fontSize:14,transitionProperty:"max-height",transitionDuration:"0.3s"}})),[t]),m=l.formatMessage({id:"shareMenu.emailMessageInput.placeholder",defaultMessage:"Add a message to your invite..."});return(0,P.jsxs)("div",{style:g.container,children:[p?(0,P.jsx)(mt,{value:i,maxLength:s,shouldShowLengthWarning:c,shouldShowLinkWarning:u}):void 0,(0,P.jsx)(pt().A,{textarea:!0,focusInitial:!1,format:"transparent",placeholder:m,maxlength:s,focus:n,value:i,onFocus:o,onChange:a,inputStyle:g.input,onCancel:r})]})}n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(672577),n(803949),n(737550);var yt=()=>n(203066),vt=()=>n(153321),bt=()=>n(792485),St=()=>n(483226),xt=()=>n(127833),Mt=()=>n(324826),At=()=>n(250910),jt=()=>n(373009),wt=()=>n(26697),It=()=>n(81068),kt=()=>n(449279),Tt=()=>n(663639),Ct=()=>n(736847),_t=()=>n(187174);const Pt={viewBox:"0 0 16 16",fittedViewBox:"3.66 3.66 8.68 8.68",directional:!0,svg:(0,P.jsx)("path",{d:"M4.288 3.663a.625.625 0 0 0-.625.625v6.109a.625.625 0 1 0 1.25 0v-4.6l6.368 6.368c.24.24.63.232.873-.01a.62.62 0 0 0 .01-.874L5.797 4.913h4.601a.625.625 0 1 0 0-1.25z"})},Bt=(0,de().wt)("arrowDiagonalUpLeftSmall",Pt,"small");var Rt=()=>n(525884),Dt=()=>n(97835),Lt=()=>n(565711),Et=()=>n(68263),Ot=()=>n(743246),Nt=()=>n(778078),Ft=()=>n(980427),Ut=()=>n(542056),zt=()=>n(339907),Kt=()=>n(423657),Vt=()=>n(477293),qt=()=>n(17281),Wt=()=>n(618841),Gt=()=>n(787766),Ht=()=>n(423817),Yt=()=>n(813323),$t=()=>n(405331),Qt=()=>n(769864);var Zt=()=>n(913348),Xt=()=>n(30537),Jt=()=>n(631524),en=()=>n(264154);function tn(e){const{emailMessage:t,inviteTargetsStore:n,flowId:i,totalContactsCount:s=0}=e,o=(0,r().v3)(),a=(0,d().IS)((()=>({importContactsButton:{width:"100%",paddingTop:15,paddingBottom:15,paddingInlineStart:9,gap:4,color:b().Tj.text.secondary,borderRadius:"6px"},importContactsButtonV2:{width:"100%",paddingTop:15,paddingBottom:15,paddingInlineStart:9,gap:8,fill:b().Tj.text.primary},icon:{color:b().Tj.icon.tertiary}})),[]),l=(0,Gt().Hc)(),c=(0,Wt().C)({onClickAuthenticated:e=>{U().Ay.setState({...U().Ay.state,tab:U().QC.Share,display:U().pP.Invite,focus:U().yZ.Search,source:e,emailMessage:t}),n.setState({...n.state,tokenQuery:""})},hideChevronIcon:!0,containerStyle:l.importListButtonContainer,buttonStyle:l.importListButton,flowId:i});return(0,P.jsx)(At().A,{popupType:Xt().n.Popup,alignmentToOrigin:"center",placementToOrigin:"bottom",render:()=>(0,P.jsx)($t().A,{importListItems:c}),originGap:12,renderOrigin:e=>(0,P.jsxs)(Jt().p,{style:{...a.importContactsButton},onClick:()=>{e.onClick(),Ft().V(o,{source:"share_menu_inline_dropdown"})},children:[s>0?(0,P.jsx)(v().sA,{id:"shareMenuSearchRequest.importContactsInlineDropdown.numContacts",defaultMessage:"{numContacts} contacts",values:{numContacts:s}}):(0,P.jsx)(v().sA,{id:"shareMenuSearchRequest.importContactsInlineDropdown.noContacts",defaultMessage:"None"}),(0,P.jsx)(Qe().Q,{iconGroup:en().l,variantName:"fillSmall",style:a.icon})]})})}var nn=()=>n(12193);function sn(e){const{publicPermission:t}=e,n=(0,d().IS)((()=>({banner:{...(0,Ge().kJ)(),display:"flex",flexDirection:"row",alignItems:"center",gap:8},content:{display:"flex",alignItems:"flex-start",gap:2,flex:"1 0 0"},label:{fontSize:14,lineHeight:"20px",color:b().Tj.text.secondary,flex:"1 0 0",paddingInlineStart:4},iconContainer:{height:20,width:20,display:"flex",alignItems:"center",justifyContent:"center"},manageButton:{color:b().Tj.blue.text.accentPrimary,fontWeight:k().Wy.medium}})),[]),i=t.permissionItem.role;if(!Et().Tt(i))return null;const s=(0,Et().W8)(t.permissionItem);return(0,P.jsxs)("div",{style:n.banner,children:[(0,P.jsxs)("div",{style:n.content,children:[(0,P.jsx)("div",{style:n.iconContainer,children:(0,P.jsx)(Y().I,{icon:nn().globeIcon,colorVariant:"secondary"})}),(0,P.jsx)(f().A,{style:n.label,isMultiline:!0,children:(0,P.jsx)(on,{role:i,hasSitePublicPermission:s})})]}),(0,P.jsx)(Jt().p,{size:"sm",style:n.manageButton,onClick:()=>{s?U().Ay.setState({...U().Ay.state,display:U().pP.Publish,tab:U().QC.Publish}):U().Ay.setState({...U().Ay.state,display:U().pP.MainShareMenu,tab:U().QC.Share,source:U().mc.PublicPermissionLevelBanner})},children:(0,P.jsx)(v().sA,{id:"shareMenu.managePublishSettingsButton.label",defaultMessage:"Settings"})})]})}function on(e){const{role:t,hasSitePublicPermission:n}=e;switch(t){case"read_and_write":return(0,P.jsx)(v().sA,{id:"shareMenu.publicPermissionBanner.canEdit",defaultMessage:"This page allows edits from anyone on the web"});case"comment_only":return(0,P.jsx)(v().sA,{id:"shareMenu.publicPermissionBanner.canComment",defaultMessage:"This page allows comments from anyone on the web"});case"reader":return n?(0,P.jsx)(v().sA,{id:"shareMenu.publicPermissionBanner.canReadSite",defaultMessage:"This site can be viewed by anyone on the web"}):(0,P.jsx)(v().sA,{id:"shareMenu.publicPermissionBanner.canRead",defaultMessage:"This page can be viewed by anyone on the web"});case"editor":case"membership_admin":case"content_only_editor":case"none":return null;default:(0,V().HB)(t)}}var an=()=>n(849255),rn=()=>n(187859),ln=()=>n(350527),dn=()=>n(703888),cn=()=>n(231704),un=()=>n(231039),pn=()=>n(735230),gn=()=>n(698449);function mn({inviteTarget:e,captionOverride:t}){const i=(0,v().tz)(),s=(0,l().O$)(Te().AppStoreSidebarSpaceStore),o=(0,l().K8)((()=>(0,Ne().dV)(e)),[e]),a=(0,l().K8)((()=>(0,gn().Pf)({groupName:e.value.name,intl:i})),[e,i]),r=(0,l().K8)((()=>{if(s&&e.value.icon)return{pointer:{table:s.table,id:s.id},icon:e.value.icon}}),[s,e]),c=(0,l().K8)((()=>(0,gn().xQ)({groupId:e.value.group_id})),[e]),u=(0,d().IS)((()=>({titleContainer:{display:"flex",alignItems:"center",paddingTop:void 0,paddingBottom:void 0,marginInlineStart:void 0,minHeight:36},groupInfoContainer:{display:"flex",flexDirection:"column"},groupNameLabel:{marginInlineStart:10},groupMembersLabel:{marginInlineStart:10}})),[]);return(0,P.jsxs)("div",{style:u.titleContainer,children:[(0,P.jsx)(n(946928).A,{groupIcon:null==r?void 0:r.icon,spaceId:e.value.space_id}),(0,P.jsxs)("div",{style:u.groupInfoContainer,children:[(0,P.jsxs)(n(396896).fI,{gap:6,alignItems:"center",children:[(0,P.jsx)(f().A,{style:u.groupNameLabel,children:a}),o?(0,P.jsx)(n(313171).L,{}):void 0]}),(0,P.jsx)(f().A,{isSmall:!0,style:u.groupMembersLabel,children:t||(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(v().sA,{defaultMessage:"Group",id:"blockPermissionsSettings.groupPermission.label"})," · ",(0,P.jsx)(v().sA,{defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} person} other {{numberOfGroupMembers} people}}",id:"blockPermissionsSettings.groupPermission.none",values:{numberOfGroupMembers:c}})]})})]})]})}const fn=i.memo(mn);function hn({store:e,isInvited:t,disabled:i,inviteTarget:s,id:o,focused:a,onClick:r,onAuxClick:l,onMouseEnter:c,role:u,disallowTabbing:p,ignoreLocalHoverState:g},m){const f=(0,d().IS)((()=>({container:(0,Ge().sH)()})),[]);return(0,P.jsx)(It().A,{ref:m,buttonStyle:f.container,title:"group"===s.type?(0,P.jsx)(fn,{inviteTarget:s}):(0,P.jsx)(yn,{store:e,inviteTarget:s}),disabled:i,right:i?void 0:(0,P.jsx)(n(420802).S,{onClick:r,checked:t,size:16,round:!0}),id:o,focused:a,onClick:r,onAuxClick:l,onMouseEnter:c,role:u,disallowTabbing:p,ignoreLocalHoverState:g})}function yn({store:e,inviteTarget:t}){const n=(0,l().K8)((()=>{if("existingUser"!==t.type)return;const n=e.getSpaceStore(),i=(0,s().sE)(n,t.value.id);return(0,cn().p)({spaceUserStore:i,userId:t.value.id,store:e})}),[t,e]),o=(0,i.useMemo)((()=>"existingUser"===t.type?{actorStore:an().L.createChildStore(e,{table:te().oo,id:t.value.id}),avatar:void 0}:"newUser"===t.type?{actorStore:void 0,avatar:{email:t.value.email,..."slack"===t.source||"google"===t.source||"microsoft"===t.source?{name:t.value.name,avatarUrl:t.value.avatar_url}:{name:void 0,avatarUrl:void 0}}}:void(0,V().HB)(t)),[t,e]),a=(0,d().IS)((()=>({iconBoxImage:{position:"absolute",bottom:-3,insetInlineEnd:-3,background:"white",padding:2,borderRadius:"100%"}})),[]),r="newUser"===t.type&&("google"===t.source||"slack"===t.source||"microsoft"===t.source)&&t.value.user_id;return(0,P.jsx)(pn().A,{isLarge:!0,...o,avatarBadge:(()=>{const e=(()=>{if("newUser"!==t.type)return null;switch(t.source){case"slack":return dn().j;case"google":return rn().m;case"microsoft":return ln().g;default:return null}})();return e?(0,P.jsx)(Qe().Q,{iconGroup:e,variantName:"default",overrideSize:()=>"newUser"===t.type&&"microsoft"===t.source?18:16,style:a.iconBoxImage}):null})(),spaceRole:n,caption:r&&(0,P.jsx)(un().N,{inviteTarget:t})})}const vn=i.memo(i.forwardRef(hn));var bn=()=>n(300474),Sn=()=>n(273900),xn=()=>n(433847),Mn=()=>n(51069),An=()=>n(678634),jn=()=>n(801191),wn=()=>n(810727);function In({blockStore:e,permissionItem:t,inviteTarget:n,mostPermissivePermissions:i,permissionItemArgs:s,...o}){return"group"===n.type?(0,P.jsx)(Tn,{inviteTarget:n,blockStore:e,permissionItem:t,mostPermissivePermissions:i,permissionItemArgs:s,menuListItemProps:o}):"existingUser"===n.type?(0,P.jsx)(kn,{inviteTarget:n,blockStore:e,permissionItem:t,mostPermissivePermissions:i,permissionItemArgs:s,menuListItemProps:o}):null}function kn({inviteTarget:e,blockStore:t,permissionItem:n,mostPermissivePermissions:i,permissionItemArgs:s,menuListItemProps:o}){const a=(0,v().tz)(),d=(0,l().K8)((()=>an().L.createChildStore(t,{table:te().oo,id:e.value.id}).getDisplayName(a)||void 0),[t,a,e]),c=(0,wn().z)({permissionItem:n,targetType:"user",targetName:d,store:t}),u="user_permission"===(null==i?void 0:i[0].permissionItem.type)?i[0]:{from:{table:y().ev,blockId:t.id},permissionItem:{role:n.role,type:"user_permission",user_id:e.value.id}},p=(0,r().v3)().currentUser.id,g=p&&u.permissionItem.user_id===p;return(0,P.jsx)(Mn().A,{store:t,userPermission:u,showInherited:!1,selectFooter:(0,P.jsx)(jn().n,{targetName:d,targetType:"user",mostPermissivePermissions:i,hasInaccessiblePermissions:!1,isCurrentUser:Boolean(g)}),permissionItemArgs:s,tooltip:c,menuListItemProps:o})}function Tn({inviteTarget:e,blockStore:t,permissionItem:n,mostPermissivePermissions:i,permissionItemArgs:s,menuListItemProps:o}){const a=(0,bn().r)(),r=e.value.name,d=(0,wn().z)({permissionItem:n,targetType:"group",targetName:r,store:t}),c=(0,l().K8)((()=>function({targetType:e,targetName:t,mostPermissivePermissions:n}){var i;const s=null==n||null===(i=n.filter("user"===e?xn().bn:_n))||void 0===i?void 0:i[0];if(!s)return[];const o=(0,Et().PW)(s.permissionItem.role)?s.permissionItem.role:"none";if("none"===o)return[];return Cn.map((n=>{if((0,Sn().sO)(n,o))return;return{role:n,disabledInfo:{isDisabled:!0,disabledMessage:(0,P.jsx)(Pn,{targetType:e,permissionItem:s.permissionItem,targetName:t})}}})).filter(V().O9)}({targetType:"group",targetName:r,mostPermissivePermissions:i})),[i,r]),u="group_permission"===(null==i?void 0:i[0].permissionItem.type)?i[0]:{from:{table:y().ev,blockId:t.id},permissionItem:{role:n.role,type:"group_permission",group_id:e.value.group_id}};return a?(0,P.jsx)(Zt().A,{store:t,groupPermission:u,spaceId:a,showInherited:!1,isRemovableOverride:!0,permissionItemArgs:s,tooltip:d,roleItemOverrides:c,menuListItemProps:o}):null}const Cn=["none","reader","comment_only","content_only_editor","read_and_write","membership_admin","editor"];function _n(e){switch(e.permissionItem.type){case"space_permission":case"space_owner_permission":case"team_permission":case"team_owner_permission":case"explicit_team_permission":case"explicit_team_owner_permission":case"explicit_team_guest_permission":return!0;case"group_permission":case"bot_permission":case"deleted_permission":case"exclusive_user_permission":case"public_permission":case"restricted_permission":case"trusted_domain_permission":case"user_permission":case"collection_property_permission":return!1;default:return e.permissionItem,!1}}function Pn({permissionItem:e,targetType:t,targetName:n}){return n&&"user"===t?(0,P.jsx)(v().sA,{id:"searchTargetPermissionItem.disabledMessage",defaultMessage:"To restrict {targetUserName}’s access, modify the “{permissionItemName}” setting on this page",values:{targetUserName:n,permissionItemName:(0,P.jsx)(An()._,{permissionItem:e})}}):n&&"group"===t?(0,P.jsx)(v().sA,{id:"searchTargetPermissionItem.disabledMessageForGroup",defaultMessage:"To restrict the {targetGroupName} group’s access, modify the “{permissionItemName}” setting on this page",values:{targetGroupName:n,permissionItemName:(0,P.jsx)(An()._,{permissionItem:e})}}):(0,P.jsx)(v().sA,{id:"searchTargetPermissionItem.disabledMessageWithoutName",defaultMessage:"To restrict access, modify the “{permissionItemName}” setting on this page",values:{permissionItemName:(0,P.jsx)(An()._,{permissionItem:e})}})}const Bn=i.memo(In);function Rn(e){var t,n;const{store:i,shouldShowSlackOnly:o,shouldShowGoogleOnly:a,shouldShowMicrosoftOnly:c,calculatedPermissions:u,permissionItemArgs:p,tokenQuery:g,showShimmer:m,error:h,ready:y,result:S}=e,x=(0,r().v3)(),M=(0,v().tz)(),A=(0,l().uB)(e.inviteTargetsStore,pe().Ay),j=(0,l().K8)((()=>U().Ay.state.display===U().pP.Invite&&U().Ay.state.focus&&"message"===U().Ay.state.focus),[]),w=(0,l().uB)(e.menuListStore,Be().$),I=(0,d().IS)((()=>({googleSlackIcons:{position:"relative",width:32,height:32},icons:{width:16,height:16,borderRadius:"50%",padding:1,border:`1px solid ${b().Tj.border.secondary}`,backgroundColor:b().Tj.palette.gray[0],position:"absolute"},microsoftIcon:{width:16,height:16,borderRadius:"50%",padding:2,border:`1px solid ${b().Tj.border.secondary}`,backgroundColor:b().Tj.palette.gray[0],position:"absolute"},sectionMenuItem:{display:"flex",flexDirection:"column",paddingTop:0,paddingInlineStart:8,paddingInlineEnd:8,paddingBottom:8},bannerSectionMenuItem:{paddingTop:0,paddingBottom:8,paddingInlineStart:16,paddingInlineEnd:16},keepTypingMessage:{paddingInlineStart:Ge().rL,paddingInlineEnd:Ge().rL,marginTop:6,marginBottom:8,fontWeight:500},zeroState:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",textAlign:"center",gap:12,color:b().Tj.text.secondary,fontSize:14,position:"relative",pointerEvents:"auto",paddingTop:10,marginTop:40,marginBottom:40},zeroStateText:{width:"70%",alignSelf:"center"}})),[]),{spaceId:k}=e,T=function(e,t){const n=(0,r().v3)(),i=(0,l().K8)((()=>{if(0!==t.length)return{spaceId:e,userIds:t}}),[e,t],{useDeepEqual:!0}),[{value:s}]=(0,_t().Yb)((async()=>{if(void 0===i)return{};const t=await Qt().callCellCompatibleApi({eventName:"getSpacePermissionGroupIdsContainingMembers",environment:n,data:i,cellNavigation:{cellId:void 0,spaceId:e}});return"success"===t.type?t.data.userToGroupMap:{}}),[n,i,e],{debugName:"userToPermissionGroupIds",debounce:300,throttle:1e3});return s}(k,S?S.inviteUsers.map((e=>e.value.id)).filter((e=>void 0!==e)):[]),C=u.pagePermissionUIModel,{inPageTargets:_,notInPageTargets:B,filteredImportedContacts:R,totalContactsCount:D}=(0,l().K8)((()=>{const{inviteUsers:e,inviteGroups:t,importedContacts:n=[],totalContactsCount:o}=S??{inviteUsers:[],inviteGroups:[],importedContacts:[],totalContactsCount:0},{sidebarSpaceStore:a}=Te().default.state,r=[...e,...t],l=[],d=[],c=new Set;r.forEach((e=>{"group"!==e.type&&c.add(e.value.email.toLowerCase());const t=Boolean(Ne().wF({store:i,target:e}));if("existingUser"===e.type&&!Boolean(e.membershipType)){const t=(0,s().sE)(a,e.value.id),n=(null==t?void 0:t.getMembershipType())??"none";e.membershipType=n}const n=(0,F().NV)({inviteTarget:e,store:i,calculatedPermissions:u,userToGroupMap:T});void 0!==n&&(t||Et().Tt(n.permissionItem.role??"none"))&&"newUser"!==e.type?n&&l.push({inviteTarget:e,...n}):"newUser"!==e.type&&d.push({inviteTarget:e,...n})}));const p=n.filter((e=>!c.has(e.value.email.toLowerCase())));return{inPageTargets:l,notInPageTargets:d,filteredImportedContacts:p,totalContactsCount:o}}),[S,i,u,T]),{isValidEmail:L,isEmailInTargets:E}=(0,l().K8)((()=>{const e=(0,Re().qh)(g);return{isValidEmail:(0,Re().DT)(e),isEmailInTargets:[..._.map((({inviteTarget:e})=>e)),...B.map((({inviteTarget:e})=>e))].some((t=>"group"!==t.type&&t.value.email===e))}}),[g,_,B]),O=(0,l().K8)((()=>A.state.inviteTargets.length>0),[A]),N=!(o||a||c),z=L&&!E,K=u.showRestrictedPermissionBanner,q=e.store.table===Ot().C0&&O,W=!o&&!a&&!c&&B.length>0&&(0===g.length||0===(null==S?void 0:S.tokenQuery.length)),G=!o&&!a&&!c&&g.length>0&&Boolean(null==S||null===(t=S.tokenQuery)||void 0===t?void 0:t.length)&&_.length>0,H=!o&&!a&&B.length>0&&g.length>0&&Boolean(null==S||null===(n=S.tokenQuery)||void 0===n?void 0:n.length),Y=R.filter((e=>"slack"===e.source)),$=R.filter((e=>"google"===e.source)),Z=R.filter((e=>"microsoft"===e.source)),X=Y.length>0&&!N,J=$.length>0&&!N,ee=Z.length>0&&!N,te=N&&(Y.length>0||$.length>0||Z.length>0),ne={key:"imported slack contacts",render:e=>(0,P.jsx)(Ct().A,{...e,style:I.sectionMenuItem,title:(0,P.jsx)(v().sA,{id:"shareMenuSearchRequest.importedSlackContactsSection.title",defaultMessage:"From Slack"}),loading:!y}),items:Dn({filteredContacts:Y,environment:x,inviteTargetsStore:A,blockStore:i,tokenQuery:g,menuListStore:w})},ie={key:"imported google contacts",render:e=>(0,P.jsx)(Ct().A,{...e,style:I.sectionMenuItem,title:(0,P.jsx)(v().sA,{id:"shareMenuSearchRequest.importedGoogleContactsSection.title",defaultMessage:"From Google"}),loading:!y}),items:Dn({filteredContacts:$,environment:x,inviteTargetsStore:A,blockStore:i,tokenQuery:g,menuListStore:w})},se="control"!==(0,Vt().r)("microsoft_contacts_import"),oe={key:"imported microsoft contacts",render:e=>se?(0,P.jsx)(Ct().A,{...e,style:I.sectionMenuItem,title:(0,P.jsx)(v().sA,{id:"shareMenuSearchRequest.importedMicrosoftContactsSection.title",defaultMessage:"From Microsoft"}),loading:!y}):void 0,items:Dn({filteredContacts:Z,environment:x,inviteTargetsStore:A,blockStore:i,tokenQuery:g,menuListStore:w})},ae={key:"mixed contacts",render:e=>(0,P.jsx)(Ct().A,{...e,style:I.sectionMenuItem,loading:!y}),items:Dn({filteredContacts:[...$,...Y,...Z].sort(((e,t)=>(e.value.name??"").localeCompare(t.value.name??""))),environment:x,inviteTargetsStore:A,blockStore:i,tokenQuery:g,menuListStore:w})},re=z||!W&&!G&&!H&&!X&&!J&&!ee&&!o&&!a&&!c&&g.length>0,le=(0,qt().h)(k),de=(0,Kt().A)(i);if(h)return(0,P.jsx)(Yt().z,{loading:!y,children:(0,P.jsx)(kt().u,{title:(0,P.jsx)(v().sA,{id:"inviteUserModal.searchInput.errorMessage",defaultMessage:"Something went wrong"})})});if(!y&&m)return(0,P.jsx)(Ht().J,{areaHeight:window.innerHeight});const ce={key:"user results",render:e=>(0,P.jsx)(Ct().A,{...e,style:I.sectionMenuItem,loading:!y,title:(0,P.jsx)(v().sA,{id:"shareMenuSearchRequest.suggestedEmail.title",defaultMessage:"Keep typing an email to invite"})}),items:qn({tokenQuery:g,possibleDomains:le??[],shouldShowAutoFillEmail:re,isGuestInviteRequestRequired:de.isGuestRequestRequired,environment:x,inviteTargetsStore:A,menuListStore:w,styles:I})},ue={key:"import contacts",render:e=>(0,P.jsx)(Ct().A,{...e,style:I.sectionMenuItem,loading:!y}),items:[{key:"import contacts",render:()=>(0,P.jsx)(It().A,{focused:!1,style:{cursor:"default"},caption:se?(0,P.jsx)(v().sA,{id:"shareMenuSearchRequest.importContactsWithMicrosoft.caption",defaultMessage:"Add contacts from Google, Slack, or Microsoft"}):(0,P.jsx)(v().sA,{id:"shareMenuSearchRequest.importContacts.caption",defaultMessage:"Add contacts from Google, Slack"}),icon:(0,P.jsxs)("div",{style:I.googleSlackIcons,children:[(0,P.jsx)(Qe().Q,{iconGroup:zt().mt,variantName:"default",style:{...I.icons,top:2,insetInlineStart:"50%",transform:"translateX(-50%)"}}),(0,P.jsx)(Qe().Q,{iconGroup:zt().jJ,variantName:"default",style:{...I.icons,bottom:2,insetInlineEnd:2}}),se?(0,P.jsx)(Qe().Q,{iconGroup:zt().gs,variantName:"default",style:{...I.microsoftIcon,bottom:2,insetInlineStart:2}}):void 0]}),right:(0,P.jsx)(tn,{emailMessage:e.emailMessage??"",inviteTargetsStore:e.inviteTargetsStore,flowId:e.flowId,totalContactsCount:D??0}),title:(0,P.jsx)(v().sA,{id:"shareMenuSearchRequest.importContacts.title",defaultMessage:"Import contacts"})}),action:()=>{}}]},ge={key:"agentShareWarning",render:e=>(0,P.jsx)(yt().N,{children:q?(0,P.jsx)(vt().P.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2,ease:"easeInOut"},style:{overflow:"hidden"},children:(0,P.jsx)(Ct().A,{...e,style:I.bannerSectionMenuItem})}):void 0}),items:[{key:"banner",render:()=>(0,P.jsx)(Mt().l,{display:"inline",tint:"blue",staticIcon:Rt().infoCircleIcon,label:(0,P.jsx)(Q().D,{styleKey:"captionMedium",children:(0,P.jsx)(v().sA,{id:"shareMenuSearchRequest.agentShareWarning.label",defaultMessage:"Sharing will make this agent’s sources and tools accessible to these user(s), even if they wouldn’t have access otherwise."})})}),action:()=>{}}]},me={key:"suggested",render:e=>(0,P.jsx)(Ct().A,{...e,style:I.sectionMenuItem,title:(0,P.jsx)(v().sA,{id:"shareMenuSearchRequest.suggestedSection.title",defaultMessage:"Suggested"}),loading:!y}),items:B.map((({inviteTarget:e,mostPermissivePermissions:t},n)=>({key:"newUser"===e.type?e.value.email:e.value.id,render:n=>{const s=Fe().P4({target:e,inviteTargetsStore:A});return(0,P.jsx)(Fn,{...n,intl:M,disabled:!1,inviteTarget:e,isInvited:s,store:i,mostPermissivePermissions:t})},action:()=>En({inviteTarget:e,inviteTargetsStore:A,menuListStore:w,rank:n,tokenQuery:g,environment:x,type:"suggested"})})))},fe={key:"in page",render:e=>(0,P.jsx)(Ct().A,{...e,style:I.sectionMenuItem,title:(0,P.jsx)(v().sA,{id:"shareMenuSearchRequest.inPageSection.titleRedesign",defaultMessage:"Already invited"}),loading:!y}),items:_.map(((e,t)=>{const{inviteTarget:n,permissionItem:s,mostPermissivePermissions:o}=e,{type:a}=n;if("existingUser"===a){if(!!o&&o.length>1)return{key:n.value.id,render:e=>(0,P.jsx)(On,{...e,blockStore:i,inviteTarget:n,permissionItem:s,mostPermissivePermissions:o,permissionItemArgs:p,rank:t,tokenQuery:g,isRestricted:K}),action:()=>{}};return C.mostPermissiveUserPermissions.find((e=>e.permissionItem.user_id===n.value.id))?{key:n.value.id,render:e=>(0,P.jsx)(On,{...e,blockStore:i,inviteTarget:n,permissionItem:s,permissionItemArgs:p,rank:t,tokenQuery:g,isRestricted:K}),action:()=>{}}:{key:n.value.id,render:e=>(0,P.jsx)(On,{...e,blockStore:i,inviteTarget:n,permissionItem:s,permissionItemArgs:p,rank:t,tokenQuery:g,isRestricted:K}),action:()=>En({inviteTarget:n,inviteTargetsStore:A,menuListStore:w,rank:t,tokenQuery:g,environment:x,type:"in_page"})}}if("group"===a){if(!!o&&o.length>1)return{key:n.value.id,render:o=>(0,P.jsx)(On,{...o,blockStore:i,inviteTarget:n,permissionItem:s,mostPermissivePermissions:e.mostPermissivePermissions,permissionItemArgs:p,rank:t,tokenQuery:g,isRestricted:K}),action:()=>{}};{const e=C.mostPermissiveGroupPermissions.find((e=>e.permissionItem.group_id===n.value.group_id));if(!e)return{key:n.value.id,render:e=>(0,P.jsx)(On,{...e,blockStore:i,inviteTarget:n,permissionItem:s,permissionItemArgs:p,rank:t,tokenQuery:g,isRestricted:K}),action:()=>En({inviteTarget:n,inviteTargetsStore:A,menuListStore:w,rank:t,tokenQuery:g,environment:x,type:"in_page"})};const o=i.getSpaceId();return o?{key:n.value.id,render:t=>(0,P.jsx)(It().A,{...t,itemMarginLeft:0,itemMarginRight:0,title:(0,P.jsx)(Zt().A,{store:i,groupPermission:e,spaceId:o,showInherited:!0,permissionItemArgs:p})}),action:()=>{}}:null}}(0,V().HB)(a)})).filter((e=>null!==e))},he={key:"not in page",render:e=>(0,P.jsx)(Ct().A,{...e,style:I.sectionMenuItem,title:g.length>0&&(0,P.jsx)(v().sA,{id:"shareMenuSearchRequest.notInPageSection.titleRedesign",defaultMessage:"Not invited to page"}),loading:!y}),items:B.map((({inviteTarget:e,mostPermissivePermissions:t},n)=>({key:"newUser"===e.type?e.value.email:e.value.id,render:n=>(0,P.jsx)(Fn,{...n,disabled:!1,intl:M,inviteTarget:e,isInvited:Fe().P4({target:e,inviteTargetsStore:A}),store:i,mostPermissivePermissions:t}),action:()=>En({inviteTarget:e,inviteTargetsStore:A,menuListStore:w,rank:n,tokenQuery:g,environment:x,type:"not_in_page"})})))};let ye=[];if(z&&ye.push(ce),ye.push(ge),W&&ye.push(me),G&&ye.push(fe),H&&ye.push(he),X&&ye.push(ne),J&&ye.push(ie),ee&&ye.push(oe),te&&ye.push(ae),o&&(ye=[ne],0===ne.items.length))return(0,P.jsx)(Un,{styles:I,importContactType:"slack"});if(a&&(ye=[ie],0===ie.items.length))return(0,P.jsx)(Un,{styles:I,importContactType:"google"});if(c&&(ye=[oe],0===oe.items.length))return(0,P.jsx)(Un,{styles:I,importContactType:"microsoft"});if(0===ye.length){if(ye=[ce],0===g.length&&!O)return N?(0,P.jsx)(Kn,{emailMessage:e.emailMessage,inviteTargetsStore:e.inviteTargetsStore,flowId:e.flowId}):(0,P.jsx)(zn,{styles:I});if(0===g.length&&O)return(0,P.jsx)("div",{style:I.keepTypingMessage,children:(0,P.jsx)(f().A,{isSecondaryColor:!0,isSmall:!0,children:(0,P.jsx)(v().sA,{id:"shareMenuSearchRequest.suggestedEmail.title",defaultMessage:"Keep typing an email to invite"})})})}else N&&ye.unshift(ue);return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(sn,{publicPermission:u.mostPermissivePublicItem}),(0,P.jsx)(Tt().A,{type:Tt().O.Vertical,initialFocus:g.length>0?0:void 0,sections:ye,store:w,disableKeyboard:j})]})}function Dn(e){const{filteredContacts:t,environment:n,inviteTargetsStore:i,blockStore:s,tokenQuery:o,menuListStore:a}=e;return t.map(((e,t)=>({key:e.value.email,render:t=>(0,P.jsx)(vn,{...t,disabled:!1,inviteTarget:e,isInvited:Fe().P4({target:e,inviteTargetsStore:i}),store:s}),action:()=>{Fe().P4({target:e,inviteTargetsStore:i})?i.setState({...i.state,inviteTargets:i.state.inviteTargets.filter((t=>"newUser"!==t.type||e.value.email!==t.value.email))}):(z().kH(n,{invite_token_query:o,selected_user_token:e,selected_user_token_rank:t,from:"share_modal_invite",subscription_tier:(0,St().AI)(),type:Ln(e)}),i.setState({inviteTargets:[...i.state.inviteTargets,e],tokenQuery:""}),a.unsetFocus())}})))}function Ln(e){return"google"===e.source?"google_contacts":"slack"===e.source?"slack":"microsoft"===e.source?"microsoft_contacts":void(0,V().HB)(e.source)}function En(e){const{inviteTarget:t,inviteTargetsStore:n,menuListStore:i,rank:s,tokenQuery:o,environment:a,type:r}=e;Fe().lW({inviteTargetsStore:n,inviteTarget:t})&&z().kH(a,{invite_token_query:o,selected_user_token:t,selected_user_token_rank:s,from:"share_modal_invite",subscription_tier:(0,St().AI)(),type:r}),i.unsetFocus()}const On=i.forwardRef((function(e,t){const{inviteTarget:n}=e,i=n.type;switch(i){case"group":case"existingUser":return(0,P.jsx)(Bn,{...e,inviteTarget:n});default:(0,V().HB)(i)}}));function Nn(e,t,n){var i,s,o;return"group"===e.type?{targetType:"group",targetName:e.value.name,permissionItem:(null==n||null===(i=n[0])||void 0===i?void 0:i.permissionItem)??{type:"group_permission",role:"none",group_id:e.value.group_id}}:"existingUser"===e.type?{targetType:"user",targetName:ee().Bj6.fromValue(te().oo,e.value).getDisplayName(t),permissionItem:(null==n||null===(s=n[0])||void 0===s?void 0:s.permissionItem)??{type:"user_permission",role:"none",user_id:e.value.id}}:"newUser"===e.type?{targetType:"user",targetName:e.value.email,permissionItem:(null==n||null===(o=n[0])||void 0===o?void 0:o.permissionItem)??{type:"user_permission",role:"none",user_id:e.value.email}}:void(0,V().HB)(e)}function Fn(e){const{mostPermissivePermissions:t,inviteTarget:n,store:i,intl:s}=e,o=(0,d().IS)((()=>({tooltip:{maxWidth:240}})),[]),a=(0,wn().z)({store:i,...Nn(n,s,t)});return(0,P.jsx)(wt().m,{delayThreshold:0,placement:"left",textWrap:!0,style:o.tooltip,disableTooltip:!(0,V().O9)(a),renderTooltip:()=>a,render:t=>(0,P.jsx)("div",{...t,children:(0,P.jsx)(vn,{...e})})})}function Un(e){const{styles:t,importContactType:n}=e,i="google"===n?"Google account":"slack"===n?"Slack workspace":"microsoft"===n?"Microsoft account":(0,V().HB)(n);return(0,P.jsxs)("div",{style:t.zeroState,children:[(0,P.jsx)(Y().I,{icon:Lt().personCropCircleBadgeExclamationPointFillIcon,size:"xl",colorVariant:"secondary"}),(0,P.jsxs)("div",{style:t.zeroStateText,children:[(0,P.jsx)("div",{style:{fontWeight:k().Wy.semibold,marginBottom:4},children:(0,P.jsx)(v().sA,{id:"shareMenuSearchRequest.noImportedContacts.title",defaultMessage:"No contacts found"})}),(0,P.jsx)("div",{children:(0,P.jsx)(v().sA,{id:"shareMenuSearchRequest.noImportedContacts.text",defaultMessage:"Try connecting a different {externalIntegrationCopy} or typing an email address",values:{externalIntegrationCopy:i}})})]})]})}function zn(e){const{styles:t}=e;return(0,P.jsxs)("div",{style:t.zeroState,children:[(0,P.jsx)(Y().I,{icon:Dt().inviteMemberIcon,size:"xl",colorVariant:"secondary"}),(0,P.jsxs)("div",{style:t.zeroStateText,children:[(0,P.jsx)("div",{style:{fontWeight:k().Wy.semibold,marginBottom:4},children:(0,P.jsx)(v().sA,{id:"shareMenuSearchRequest.noSuggestions.title",defaultMessage:"Members and guests will appear here"})}),(0,P.jsx)("div",{children:(0,P.jsx)(v().sA,{id:"shareMenuSearchRequest.noSuggestions.text",defaultMessage:"Try inviting someone with their email address or importing contacts"})})]})]})}function Kn(e){const{inviteTargetsStore:t,flowId:n,emailMessage:i}=e,s=(0,d().IS)((()=>({container:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flex:1,textAlign:"center",fontSize:14,position:"relative",pointerEvents:"auto",marginTop:32,marginBottom:24,gap:14},logos:{display:"flex",gap:12,alignItems:"center",justifyContent:"center"},text:{marginTop:6,textAlign:"center"},subtext:{color:b().Tj.text.secondary},button:{padding:"8px 12px"}})),[]),o=(0,Gt().Hc)(),a=(0,r().v3)(),l="control"!==(0,Vt().r)("microsoft_contacts_import"),c=(0,Wt().C)({onClickAuthenticated:e=>{U().Ay.setState({...U().Ay.state,tab:U().QC.Share,display:U().pP.Invite,focus:U().yZ.Search,source:e,emailMessage:i??""}),t.setState({...t.state,tokenQuery:""})},hideChevronIcon:!0,containerStyle:o.importListButtonContainer,buttonStyle:o.importListButton,flowId:n});return(0,P.jsxs)("div",{style:s.container,children:[(0,P.jsxs)("div",{style:s.logos,children:[(0,P.jsx)(Qe().Q,{iconGroup:zt().mt,variantName:"default",style:{height:22,width:22}}),(0,P.jsx)(Qe().Q,{iconGroup:zt().jJ,variantName:"default",style:{height:22,width:22}}),l?(0,P.jsx)(Qe().Q,{iconGroup:zt().gs,variantName:"default",style:{height:22,width:22}}):void 0]}),(0,P.jsxs)("div",{style:s.text,children:[(0,P.jsx)("div",{style:{fontWeight:k().Wy.semibold,marginBottom:4},children:(0,P.jsx)(v().sA,{id:"shareMenuSearchRequest.getStartedImportContacts.title",defaultMessage:"Import contacts"})}),(0,P.jsx)("div",{style:s.subtext,children:l?(0,P.jsx)(v().sA,{id:"shareMenuSearchRequest.getStartedImportContactsWithMicrosoft.text",defaultMessage:"Connect with Google, Slack, or Microsoft"}):(0,P.jsx)(v().sA,{id:"shareMenuSearchRequest.getStartedImportContacts.text",defaultMessage:"Connect with Google or Slack"})})]}),(0,P.jsx)("div",{children:(0,P.jsx)(At().A,{popupType:xt().nl.Popup,alignmentToOrigin:"start",placementToOrigin:"left",render:()=>(0,P.jsx)($t().A,{importListItems:c}),originGap:12,renderOrigin:e=>(0,P.jsx)(jt().E,{...e,onClick:()=>{var t;null===(t=e.onClick)||void 0===t||t.call(e),Ft().V(a,{source:"share_menu_empty_state"})},style:s.button,children:(0,P.jsx)(v().sA,{id:"shareMenuSearchRequest.getStartedImportContacts.button",defaultMessage:"Get started"})})})})]})}function Vn({tokenQuery:e,possibleDomains:t,shouldShowAutoFillEmail:n}){const i=(0,Nt().Ay)(e,function(e,t,n){return n?Array.from(new Set([...t,"gmail.com","yahoo.com","outlook.com","hotmail.com"])).map(((t,n)=>({tokenQuery:`${e.split("@")[0]}@${t}`,weight:n}))).slice(0,3):[{tokenQuery:e,weight:0}]}(e,t,n),(e=>e.tokenQuery));return 0===i.length?[{tokenQuery:e,weight:0}]:i}function qn({tokenQuery:e,possibleDomains:t,isGuestInviteRequestRequired:n,shouldShowAutoFillEmail:i,environment:s,inviteTargetsStore:o,menuListStore:a,styles:r}){return Vn({tokenQuery:e,possibleDomains:t,shouldShowAutoFillEmail:i}).map(((t,r)=>({key:t.tokenQuery,render:e=>(0,P.jsx)(It().A,{icon:(0,P.jsx)(Y().I,{icon:Dt().inviteMemberIcon}),title:(0,P.jsx)(Wn,{tokenQuery:t.tokenQuery,shouldShowAutofillEmail:i,isGuestInviteRequestRequired:n}),caption:n?(0,P.jsx)(v().sA,{id:"shareMenuSearchRequest.requestNewUser.buttonItem.caption",defaultMessage:"Workspace owners are required to view and approve guest invites"}):void 0,right:i&&(0,P.jsx)(Y().I,{icon:Bt,size:"sm",colorVariant:"tertiary"}),...e}),action:async()=>{const n=(0,Re().qh)(t.tokenQuery);if(!(0,Re().DT)(n)){const e={type:"invalidUser",value:{text:t.tokenQuery}};return void(Fe().P4({target:e,inviteTargetsStore:o})||o.setState({inviteTargets:[...o.state.inviteTargets,e],tokenQuery:""}))}const i=await Ut().Ah(s,[n]);if(!i.length)return;const l=i[0];Fe().P4({target:l,inviteTargetsStore:o})||(z().kH(s,{invite_token_query:e,selected_user_token:l,selected_user_token_rank:r,from:"share_modal_invite",subscription_tier:(0,St().AI)(),type:"autofill"}),o.setState({inviteTargets:[...o.state.inviteTargets,l],tokenQuery:""}),a.unsetFocus())}})))}function Wn(e){const{tokenQuery:t,shouldShowAutofillEmail:n,isGuestInviteRequestRequired:i}=e;return i?(0,P.jsx)(v().sA,{id:"shareMenuSearchRequest.requestNewUser.buttonItem",defaultMessage:"Request {tokenQuery} as a guest",values:{tokenQuery:t}}):n?(0,P.jsx)(v().sA,{id:"shareMenuSearchRequest.inviteNewUser.buttonItem.v1",defaultMessage:"“{tokenQuery}”",values:{tokenQuery:t}}):(0,P.jsx)(v().sA,{id:"shareMenuSearchRequest.inviteNewUser.buttonItem",defaultMessage:"Invite {tokenQuery}",values:{tokenQuery:t}})}const Gn=function(e){const t=(0,r().v3)(),n=(0,v().tz)(),[s,o]=(0,i.useState)(!0),a=(0,l().K8)((()=>e.inviteTargetsStore.state.tokenQuery),[e.inviteTargetsStore]),d=(0,l().K8)((()=>e.store.getSpaceId()),[e.store]),c=(0,l().K8)((()=>{if(e.shouldShowSlackOnly||e.shouldShowGoogleOnly||e.shouldShowMicrosoftOnly)return{userLimit:0,botLimit:0,groupLimit:0,importContactLimit:e.sectionRenderLimit};const t=rt().A.completeSlackAuthentications.state.length>0,n=rt().A.externalAuthentications.state.filter((e=>e.integration_id===lt().E8)).length>0,i=rt().A.externalAuthentications.state.filter((e=>e.integration_id===lt().LF)).length>0;return{userLimit:e.sectionRenderLimit,botLimit:0,groupLimit:e.shouldShowGroups?e.sectionRenderLimit:0,importContactLimit:t||n||i?e.sectionRenderLimit:0}}),[e.sectionRenderLimit,e.shouldShowGroups,e.shouldShowSlackOnly,e.shouldShowGoogleOnly,e.shouldShowMicrosoftOnly]),u=(0,bt().S)(),[{value:p,status:g}]=(0,_t().Yb)((async()=>({...await Ut().hQ({query:a,sectionLimit:c,membersOnly:e.membersOnly,environment:t,intl:n,pageContext:u}).finally((()=>o(!1))),tokenQuery:a})),[t,n,e.membersOnly,a,c,u],{debounce:40});return d?(0,P.jsx)(Rn,{...e,tokenQuery:a,showShimmer:s,ready:"pending"!==g&&"idle"!==g,error:"rejected"===g,result:p,spaceId:d}):null};function Hn(e){const t=(0,r().v3)(),n=(0,l().uB)(e.inviteTargetsStore,pe().Ay),s=(0,l().K8)((()=>n.state.inviteTargets.length>0),[n]),{display:o,source:a,focus:c,emailMessage:u}=(0,l().K8)((()=>{const{display:e}=U().Ay.state;return e===U().pP.Invite?U().Ay.state:{display:e,source:void 0,focus:void 0,emailMessage:""}}),[]),p=(0,l().O$)(Te().AppStoreSidebarSpaceStore),g=o===U().pP.Invite&&s,m=a===U().NL.Notion&&!s,h=(0,l().O$)(rt().A.completeSlackAuthentications),y=a===U().NL.Notion&&!s,S=(0,l().K8)((()=>rt().A.externalAuthentications.state.filter((e=>e.integration_id===lt().E8))),[]),x=a===U().NL.Notion&&!s,M=(0,l().K8)((()=>rt().A.externalAuthentications.state.filter((e=>e.integration_id===lt().LF))),[]),[A,j]=(0,i.useState)(!1),w=g&&!m,I=(0,i.useCallback)((()=>{n.reset()}),[n]);(0,i.useEffect)((()=>{if(!p||A)return;if(!m&&!y&&!x)return;const e=[...h.map((e=>({botId:e.id,importContactType:"slack"}))),...S.map((e=>({botId:e.id,importContactType:"google"}))),...M.map((e=>({botId:e.id,importContactType:"microsoft"})))];e.length>0&&(0,ct().b)({bots:e,spaceId:p.id,environment:t}),j(!0)}),[m,y,x]);const k=function({scrollerMarginBottom:e}){return(0,d().IS)((()=>({scroller:{flexGrow:1,marginBottom:e},importContactsContainer:{height:36,bottom:0,width:"100%",backgroundColor:b().Tj.background.elevated,pointerEvents:"all",transitionProperty:"max-height",transitionDuration:"0.3s",boxShadow:"0px -4px 4px rgba(0, 0, 0, 0.03)",padding:3},importContactsButton:{width:"100%",paddingTop:15,paddingBottom:15,paddingInlineStart:9,gap:8},importContactsButtonV2:{width:"100%",paddingTop:15,paddingBottom:15,paddingInlineStart:9,gap:8,fill:b().Tj.text.primary},warningLabel:{...(0,Ge().kJ)(),display:"flex",alignItems:"center",gap:2,color:b().Tj.text.secondary}})),[e])}({scrollerMarginBottom:w?ft:0}),T=(0,l().K8)((()=>!(0,F().Aj)({store:e.store})),[e.store]);return o!==U().pP.Invite?null:(0,P.jsxs)(P.Fragment,{children:[T?(0,P.jsx)(f().A,{style:k.warningLabel,isMultiline:!0,children:(0,P.jsx)(v().sA,{id:"shareMenuSearchRequest.suggestedSectionWarning.title",defaultMessage:"Some users may already have access through a parent page or teamspace"})}):void 0,(0,P.jsx)(dt().H,{type:at().A.Y,style:k.scroller,children:(0,P.jsx)(Gn,{inviteTargetsStore:n,store:e.store,menuListStore:e.menuListStore,shouldShowGroups:!0,shouldShowSlackOnly:a===U().NL.Slack,shouldShowGoogleOnly:a===U().NL.Google,shouldShowMicrosoftOnly:a===U().NL.Microsoft,membersOnly:!1,sectionRenderLimit:10,calculatedPermissions:e.calculatedPermissions,permissionItemArgs:e.permissionItemArgs,emailMessage:u,flowId:e.flowId})}),(0,P.jsx)(ht,{open:g&&!m,focus:c===U().yZ.Message,value:u,onFocus:()=>{a&&o===U().pP.Invite&&U().Ay.setState({...U().Ay.state,focus:U().yZ.Message,tab:U().QC.Share,display:o,source:a,emailMessage:u})},onChange:e=>{U().Ay.setState({...U().Ay.state,focus:c,tab:U().QC.Share,display:o,source:a,emailMessage:e.target.value})},onCancel:async()=>{await ut().T({environment:t,inviteTargetsStore:n})&&(ut().XP({environment:t,store:e.store}),I())},maxLength:1e3})]})}var Yn=()=>n(295633),$n=()=>n(706021),Qn=()=>n(347160),Zn=()=>n(891078),Xn=()=>n(300789),Jn=()=>n(908615),ei=()=>n(394888),ti=()=>n(49210),ni=()=>n(89002),ii=()=>n(252953),si=()=>n(496603),oi=()=>n(838239),ai=()=>n(227358),ri=()=>n(592674),li=()=>n(933266);function di(e){const{email:t}=e;return(0,P.jsx)(ie().A,{avatar:{email:t},size:28})}function ci(e){const{children:t}=e,n=(0,d().IS)((()=>({wrapper:{position:"relative"},shield:{position:"absolute",insetInlineStart:17,top:18}})),[]);return(0,P.jsxs)("div",{style:n.wrapper,children:[t,(0,P.jsx)("div",{style:n.shield,children:(0,P.jsx)(Qe().Q,{iconGroup:li().h,colorVariant:"secondary",variantName:"fillSmall",size:"xs"})})]})}function ui(e){const{rows:t,internalDomains:n}=e,i=(0,d().IS)((()=>({inviteTargetList:{background:b().Tj.background.secondary,borderRadius:12,maxHeight:227,overflowY:"auto",padding:"12px 16px",width:"100%"}})),[]);return(0,P.jsx)(dt().H,{type:at().A.Y,style:i.inviteTargetList,children:(0,P.jsx)(G().Y1,{gap:16,children:t.map((e=>{const{type:t}=e;switch(t){case"new":return(0,P.jsx)(pi,{email:e.email,internalDomains:n},e.email);case"existing":return(0,P.jsx)(gi,{userStore:e.userStore,internalDomains:n},e.userStore.id);default:(0,V().HB)(t)}}))})})}function pi(e){const{email:t,internalDomains:n}=e,i=(0,Le().C7)(t,n);return(0,P.jsx)(mi,{avatar:i?(0,P.jsx)(ci,{children:(0,P.jsx)(di,{email:t})}):(0,P.jsx)(di,{email:t}),name:t,email:t})}function gi(e){const{userStore:t,internalDomains:n}=e,i=(0,v().tz)(),{name:s,email:o}=(0,l().K8)((()=>({name:t.getDisplayName(i),email:t.getEmail()})),[t,i]);if(!s||!o)return null;const a=(0,Le().C7)(o,n);return(0,P.jsx)(mi,{avatar:a?(0,P.jsx)(ci,{children:(0,P.jsx)(ie().A,{userStore:t,size:28})}):(0,P.jsx)(ie().A,{userStore:t,size:28}),name:s,email:o})}function mi(e){const{avatar:t,name:n,email:i}=e;return(0,P.jsxs)(G().Y1,{direction:"horizontal",gap:10,align:"center-left",children:[t,(0,P.jsxs)(G().Y1,{gap:2,children:[(0,P.jsx)(Q().D,{styleKey:"bodyMedium",children:n}),(0,P.jsx)(Q().D,{styleKey:"captionRegular",colorVariant:"secondary",children:i})]})]})}function fi(e){const{type:t}=e;switch(t){case"new":return e.email;case"existing":return e.userStore.getEmail();default:(0,V().HB)(t)}}function hi(e){var t;const{inviteUserListRows:n,spaceStore:s,spaceUserStore:o,onClickAddMembers:a,onClickManageGuests:d}=e,c=(0,r().v3)(),u=(0,v().tz)(),[p,g]=(0,l().K8)((()=>[s.id,s.getName()]),[s]),m=(0,l().K8)((()=>null==o?void 0:o.getUserId()),[o]),f=(0,l().K8)((()=>{var e;return(null===(e=ri().A.getData(c,{spaceId:p}))||void 0===e?void 0:e.map((e=>e.domain)))??[]}),[c,p]),h=(0,Ve()._)({name:"internal_guests",spaceId:p,userId:m,amount:0}),y=(0,i.useCallback)((()=>{const e=n.map(fi).filter(V().O9);a(e)}),[n,a]);if(!h||0===f.length)return null;const b=(null===(t=si().oE(n.filter((e=>"new"===e.type)).map((e=>(0,Le().CH)(e.email,f))))[0])||void 0===t?void 0:t.url)??f[0].url;return(0,P.jsx)(_e().N,{debugName:"AddAsMembersModalContent",capture:!0,onEnter:y,children:(0,P.jsx)(ni().t,{header:(0,P.jsx)(oi().Y,{iconAndTitle:(0,P.jsx)(ai().Z,{iconGroup:ii().A,iconColorVariant:"secondary",title:u.formatMessage(vi.title,{spaceName:g,guestLimit:h.limit.total})}),description:u.formatMessage(vi.description,{domain:b,b:e=>(0,P.jsx)("b",{children:e})})}),footer:(0,P.jsx)(yi,{rowCount:n.length,onClickAddMembers:y,onClickManageGuests:d}),children:(0,P.jsx)(ui,{rows:n,internalDomains:f})})})}function yi(e){const{rowCount:t,onClickAddMembers:n,onClickManageGuests:i}=e,s=(0,v().tz)(),o=s.formatMessage(vi.addMember,{rowCount:t});return(0,P.jsxs)(G().Y1,{gap:16,children:[(0,P.jsxs)(G().Y1,{gap:8,children:[(0,P.jsx)(he().A,{colorPalette:"blue","aria-label":o,onClick:n,style:{height:32},children:o}),(0,P.jsx)($().A,{size:"lg","aria-label":s.formatMessage(vi.manageGuestsInSettings),onClick:i,children:s.formatMessage(vi.manageGuestsInSettings)})]}),(0,P.jsx)("div",{style:{textAlign:"center"},children:(0,P.jsx)(Q().D,{styleKey:"captionRegular",colorVariant:"secondary",children:s.formatMessage(vi.billingNotice)})})]})}const vi=(0,v().YK)({title:{id:"addAsMembersModal.title",defaultMessage:"{spaceName} is over the guest limit of {guestLimit}"},description:{id:"addAsMembersModal.description",defaultMessage:"Shares to work email domains ending with <b>@{domain}</b> must be added as members with access to your entire workspace."},addMember:{id:"addAsMembersModal.addMember",defaultMessage:"Add {rowCount, plural, one {member} other {{rowCount} members}}"},manageGuestsInSettings:{id:"addAsMembersModal.manageGuestsInSettings",defaultMessage:"Manage guests in settings"},billingNotice:{id:"addAsMembersModal.billingNotice",defaultMessage:"Each new member will be billed as an additional seat"}});n(16280);var bi=()=>n(675133),Si=()=>n(792057),xi=()=>n(128933),Mi=()=>n(165358),Ai=()=>n(319625),ji=()=>n(229833),wi=()=>n(763824),Ii=()=>n(258467),ki=()=>n(31082);const Ti=(0,v().YK)({nonAdminCannotEditPermissions:{defaultMessage:"You do not have permission to invite guests to this page. Ask an admin to send the invite.",id:"permissions.nonAdminCannotEditPermissions.message"},guestsAreNotAllowed:{defaultMessage:"Members cannot invite guests to pages in this workspace. Ask an admin to send the invite.",id:"shareMenu.guestsAreNotAllowed.message"},unexpectedProcessInviteFailure:{defaultMessage:"Failed to process invite",id:"shareMenu.unexpectedProcessInviteFailure.message"}});async function Ci(e){const{environment:t,intl:n,internalDomains:i,destination:s,invites:o,metadata:a,sudoModeStore:r,contextualInviteStore:l}=e,d=await async function(e){const{environment:t,invites:n,destination:i,metadata:s,sudoModeStore:o,contextualInviteStore:a}=e,r=(await(0,wi().lX)(n,20,(e=>async function(e){const{invite:t,environment:n,destination:i}=e,{store:s,spaceStore:o}=i,{defaultAddability:a}=t;try{switch(a.type){case"none":throw new Error("Cannot send invite with none addability type");case"member":return await async function(e){const{environment:t,invite:n,destination:i,metadata:s}=e,{invitee:o,defaultAddability:a}=n;if(void 0===o)throw new Error("Expected invite.invitee to be defined");const{email:r}=o,{role:l,store:d,spaceMembershipType:c,spaceStore:u}=i,{inviteOrigin:p}=s,g=await(0,Ii().sR)({environment:t,email:r});if(!g)throw new Error("Invitee user not found");const m={type:"user",membershipType:c,userId:g,inviteId:void 0},f={type:"user_permission",role:l,user_id:g};await(0,Ii().ZF)({blockPermissionItem:f,blockStore:d,environment:t,inviteOrigin:p,spaceActor:m,spaceStore:u,shareMenuSessionId:U().Ay.state.sessionId});const h="member"===a.type&&"over_internal_guest_limit"===a.reason;return{type:"createdMember",invite:n,inviteeUserId:g,spaceActor:m,blockPermissionItem:f,wasInternalDomainEnforced:h}}(e);case"member_request":return await async function(e){const{environment:t,invite:n,destination:i,metadata:s}=e,{invitee:o,internalDomain:a}=n;if(void 0===o)throw new Error("Expected invite.invitee to be defined");const{email:r}=o,{spaceStore:l}=i,{inviteMessage:d}=s,c=await(0,Ii().sR)({environment:t,email:r});if(!c)throw new Error("Invitee user not found");await(0,Ii().k7)({environment:t,inviteeUserId:c,inviteMessage:d,spaceStore:l});const u=void 0!==a;return{type:"createdMemberRequest",invite:n,wasInternalDomainEnforced:u}}(e);case"guest":case"guest_page_add":case"member_page_add":return await async function(e){const{environment:t,invite:n,destination:i,metadata:s,sudoModeStore:o}=e,{invitee:a}=n;if(void 0===a)throw new Error("Expected invite.invitee to be defined");const{email:r}=a,{role:l,store:d,canCreatePagesInCollection:c}=i,u=await(0,Ii().sR)({environment:t,email:r});if(!u)throw new Error("Invitee user not found");const p={type:"user_permission",role:l,user_id:u,can_create_pages_in_collection:c};return await(0,Ii().Ft)({blockPermissionItem:p,blockStore:d,environment:t,metadata:s,sudoModeStore:o,shareMenuSessionId:U().Ay.state.sessionId}),{type:"addedUserPermission",invite:n,inviteeUserId:u,blockPermissionItem:p}}(e);case"restricted_member_request":return await async function(e){const{invite:t,environment:n,destination:i,metadata:s}=e,o="createdRestrictedMemberRequest";if(await Pi({destination:i,environment:n,invite:t,metadata:s,type:o}))return{type:o,invite:t};return}(e);case"guest_request":return await async function(e){const{invite:t,environment:n,destination:i,metadata:s}=e,o="createdGuestRequest";if(await Pi({destination:i,environment:n,invite:t,metadata:s,type:o}))return{type:o,invite:t};return}(e);case"group":return await async function(e){const{environment:t,invite:n,destination:i,metadata:s,sudoModeStore:o}=e,{role:a,store:r,canCreatePagesInCollection:l}=i;if("group"!==n.inviteTarget.type)throw new Error("Expected invite.inviteTarget to be a group");const d=n.inviteTarget.value,c={type:"group_permission",role:a,group_id:d.group_id,can_create_pages_in_collection:l};return await(0,Ii().Ft)({blockPermissionItem:c,blockStore:r,environment:t,metadata:s,sudoModeStore:o}),{type:"addedGroupPermission",invite:n,group:d,blockPermissionItem:c}}(e);default:(0,V().HB)(a)}}catch(l){var r;const e=(0,Ai().A)(l).message,i={miscDataToConvertToString:{message:e,spaceId:o.id,blockId:s.id,actorUserId:n.currentUser.id,inviteeEmail:null===(r=t.invitee)||void 0===r?void 0:r.email,defaultAddabilityType:a.type}};let d,c;e.toLowerCase().includes("non-admin cannot edit permissions")?(d=!0,c="nonAdminCannotEditPermissions"):e.toLowerCase().includes("guests are not allowed")?(d=!0,c="guestsAreNotAllowed"):(d=!1,c="unexpectedProcessInviteFailure"),Mi().log({level:d?"info":"error",error:d?void 0:(0,ji().convertErrorToLog)(l),spaceId:o.id,from:"processInvite",type:c,data:i});const u=bi().A.formatMessage(Ti[c]);return void(d?Si().rG({message:u}):Si().f1(u))}}({environment:t,invite:e,destination:i,metadata:s,sudoModeStore:o})))).filter(V().O9);if(a){const e={};for(const t of r)"addedUserPermission"!==t.type&&"createdMember"!==t.type||"group"===t.invite.inviteTarget.type||(e[t.invite.inviteTarget.value.email]=t.inviteeUserId);a.setState({...a.state,invitedEmailToUserIdMap:e})}return r}({destination:s,environment:t,invites:o,metadata:a,sudoModeStore:r,contextualInviteStore:l});return(0,ki().Bw)({destination:s,environment:t,internalDomains:i,inviteResults:d,metadata:a}),0!==d.length&&(xi().D6({label:_i({invites:o,intl:n})}),!0)}function _i(e){var t;const{invites:n,intl:i}=e,s=null===(t=n[0].invitee)||void 0===t?void 0:t.email;s||i.formatMessage({id:"shareMenu.inviteResultsToast.label",defaultMessage:"Successfully sent"});const o=n.length-1,a=n.filter((e=>(0,De().bb)(e.invitee))).length;return n.filter((e=>"restricted_member_request"===e.defaultAddability.type)).length===n.length?o<=0?i.formatMessage({id:"shareMenu.inviteResultsToast.requestedRestrictedMember.label",defaultMessage:"Requested access for {firstInvitee}"},{firstInvitee:s}):i.formatMessage({id:"shareMenu.inviteResultsToast.requestedRestrictedMembers.label",defaultMessage:"Requested access for {firstInvitee} and {numAdditionalInvites, plural, one {{numAdditionalInvites} other person} other {{numAdditionalInvites} others}}"},{firstInvitee:s,numAdditionalInvites:o}):a===n.length?o<=0?i.formatMessage({id:"shareMenu.inviteResultsToast.inviteGuest.label",defaultMessage:"Invite sent to {firstInvitee}"},{firstInvitee:s}):i.formatMessage({id:"shareMenu.inviteResultsToast.inviteGuests.label",defaultMessage:"Invite sent to {firstInvitee} and {numAdditionalInvites, plural, one {{numAdditionalInvites} other person} other {{numAdditionalInvites} others}}"},{firstInvitee:s,numAdditionalInvites:o}):o<=0?i.formatMessage({id:"shareMenu.inviteResultsToast.shareWithMember.label",defaultMessage:"Shared with {firstInvitee}"},{firstInvitee:s}):i.formatMessage({id:"shareMenu.inviteResultsToast.shareWithMultiple.label",defaultMessage:"Shared with {firstInvitee} and {numAdditionalInvites, plural, one {{numAdditionalInvites} other person} other {{numAdditionalInvites} others}}"},{firstInvitee:s,numAdditionalInvites:o})}async function Pi(e){const{environment:t,invite:n,destination:i,metadata:s,type:o}=e;if(void 0===n.invitee)throw new Error("Expected invite.invitee to be defined");const{email:a}=n.invitee,{role:r,store:l,spaceStore:d}=i,{inviteMessage:c}=s,u={id:l.id,spaceId:d.id},p=await(0,Ii().sR)({environment:t,email:a});return!!p&&("createdGuestRequest"===o?await(0,Ii().Mb)({block:u,blockRole:r,environment:t,inviteeUserId:p,inviteMessage:c}):"createdRestrictedMemberRequest"===o&&await(0,Ii().Hq)({block:u,blockRole:r,environment:t,inviteeUserId:p,inviteMessage:c}),!0)}function Bi(e){e.reset(),U().Ay.setState({...U().Ay.state,tab:U().QC.Share,display:U().pP.MainShareMenu,source:U().mc.ShareTopbarButton})}async function Ri(e){const{addAsMembersResult:t,destination:n,environment:i,internalDomains:s,intl:o,invites:a,inviteTargetsStore:r,metadata:l}=e;var d;t&&("manageGuests"===t?(d="members",nt().Ay.setState({currentTab:d,defaultSubtab:void 0,highlightedSetting:void 0,open:!0,openedFrom:"share_menu"})):"addMembers"===t?(Bi(r),await Ci({destination:n,environment:i,internalDomains:s,invites:a,intl:o,metadata:l})):(0,V().HB)(t))}async function Di(e){const{destination:t,contextualInviteStore:n,metadata:i,invites:s,environment:o,internalDomains:a,intl:r,inviteTargetsStore:l,spaceStore:d,spaceUserStore:c,sudoModeStore:u}=e,p=s.map((e=>e.defaultAddability)).some((e=>"member"===e.type&&"over_internal_guest_limit"===e.reason)),g=s.map((e=>e.defaultAddability)).some((e=>["guest","guest_request","guest_page_add"].includes(e.type)));if(p){const e=s.map((e=>function(e){const{inviteTarget:t,environment:n}=e,{type:i}=t;switch(i){case"existingUser":return{type:"existing",userStore:new(an().L)(n,{table:te().oo,id:t.value.id})};case"newUser":return{type:"new",email:t.value.email};case"group":return;default:(0,V().HB)(i)}}({environment:o,inviteTarget:e.inviteTarget}))).filter(V().O9),n=await async function(e){const{inviteUserListRows:t,spaceStore:n,spaceUserStore:i}=e;return await ti().T.showAsyncModal((e=>(0,P.jsx)(ei().s,{isOpen:e.isOpen,onDismiss:e.onDismiss,onClosed:e.onClosed,areaConstraint:{width:{type:"fixed",length:400}},render:()=>(0,P.jsx)(hi,{inviteUserListRows:t,spaceStore:n,spaceUserStore:i,onClickAddMembers:()=>{e.resolve("addMembers")},onClickManageGuests:()=>{e.resolve("manageGuests")}})})))}({inviteUserListRows:e,spaceStore:d,spaceUserStore:c});await Ri({addAsMembersResult:n,destination:t,environment:o,internalDomains:a,intl:r,invites:s,inviteTargetsStore:l,metadata:i})}else{Bi(l);if(!(await Ci({destination:t,environment:o,internalDomains:a,intl:r,invites:s,metadata:i,sudoModeStore:u,contextualInviteStore:n})))return;g&&function(e){const{contextualInviteStore:t,environment:n,invites:i,spaceStore:s}=e,o=i.filter((e=>(0,V().O9)(e.invitee)&&function(e){const t=e.type;return["guest","guest_request","guest_page_add"].includes(t)}(e.defaultAddability))).map((e=>({email:e.invitee.email,isGuest:(0,De().bb)(e.invitee)})));t.setState({...t.state,invitedUsers:o}),K().BY({environment:n,spaceStore:s,contextualInviteStore:t})}({contextualInviteStore:n,environment:o,spaceStore:d,invites:s})}}var Li=()=>n(228974),Ei=()=>n(540459),Oi=()=>n(352321),Ni=()=>n(467211),Fi=()=>n(381374),Ui=()=>n(94985);function zi(e){const{invites:t,disabled:n,metadata:s,focus:o,onFocus:c,onInputChanged:u,onSubmit:p,placeholder:g,right:m,showEmptyError:f,setAutoFocusInput:h}=e,y=(0,bt().S)(),v=(0,r().v3)(),S=(0,l().uB)(e.inviteTargetsStore,pe().Ay),x=(0,l().K8)((()=>S.state.inviteTargets),[S]),M=t.filter((e=>x.includes(e.inviteTarget))),A=function(e){const{disabled:t,hasTokens:n}=e;return(0,d().IS)((()=>({tokenSpan:{maxWidth:"100%"},inputRightItemStyle:{alignSelf:"flex-start"},inputOuterStyle:{borderRadius:6,...t&&{background:b().Tj.inputBackground,color:b().Tj.text.secondary,fill:b().oZ.white,opacity:.4},alignItems:"flex-start"},inputAndTokenWrapRight:{gap:2},inputInnerStyle:{...!n&&{padding:2}},warningMessage:{color:"#DE5550"}})),[n,t])}({disabled:n,hasTokens:M.length>0}),j=(0,l().K8)((()=>S.state.tokenQuery),[S]),w=(0,l().K8)((()=>0===S.state.tokenQuery.trim().length),[S]),I=(0,i.useCallback)((e=>{Ni().S({inviteTargetsStore:S,targetToRemove:e})}),[S]);return x?(0,P.jsx)(Oi().Ay,{focus:o,focusAfterAnimation:!0,onClick:()=>{a().A.isMobile||null==c||c()},format:Oi().le.Share,value:j,onChange:e=>{if(w){const e=U().Ay.state;U().Ay.setState({...e,tab:U().QC.Share,display:U().pP.Invite,focus:U().yZ.Search,source:e.display===U().pP.Invite?e.source:U().NL.Notion,emailMessage:e.display===U().pP.Invite?e.emailMessage:""}),null==h||h(!1)}Ni().P({environment:v,pageContext:y,event:e,inviteTargetsStore:S,inviteOrigin:s.inviteOrigin,flowId:s.inviteFlowId,onInputChanged:u})},type:"email",tokens:M.map((({inviteTarget:e,defaultAddability:t},n)=>(0,P.jsx)(Ui().u5,{inviteTarget:e,onClickRemove:I,defaultAddability:t},n))),disabled:n,autoComplete:"off",placeholder:g,onRemoveLastToken:()=>{S.setState({...S.state,inviteTargets:S.state.inviteTargets.slice(0,-1)})},right:m,rightWrapStyle:A.inputRightItemStyle,showBorder:!0,inputStyle:A.inputInnerStyle,inputAndTokenWrapRightStyle:A.inputAndTokenWrapRight,style:A.inputOuterStyle,onSubmit:p,inputFullWidth:!0,message:(0,P.jsx)(Fi().p,{invalidInvites:(0,si().oE)(x.map((e=>"invalidUser"===e.type?e:void 0))),showEmptyError:f,styles:A.warningMessage})}):null}var Ki=()=>n(404694),Vi=()=>n(734762),qi=()=>n(148297),Wi=()=>n(51367);const Gi="sharing_contacts_import_tooltip";function Hi(e){const{originRef:t,onPrimaryButtonClick:n}=e,s=(0,r().v3)(),o=(0,l().K8)((()=>Ce().default.getEligibleGroup({experimentId:"microsoft_contacts_import",defaultGroup:"control"})),[]),a=(0,l().K8)((()=>M().default.isVisible(Gi)),[]),d=(0,Ki().V)(),c=(0,i.useCallback)((()=>{(0,Wi().Sq)(s,{callout_key:Gi,placement_key:"Tooltip",dismiss_type:"tooltip_dismiss"}),(0,Xn().a)(s,Gi)}),[s]),u=(0,i.useCallback)((()=>{(0,Wi().Y5)(s,{callout_key:Gi,placement_key:"Tooltip",click_type:"primary_cta"}),n()}),[s,n]);if("control"===o||!a)return null;const p="generic_tooltip"===o?(0,P.jsxs)(me().wt,{gap:10,children:[(0,P.jsxs)(me().Ye,{gap:5,children:[(0,P.jsx)(Qe().Q,{iconGroup:dn().j,variantName:"default",style:{height:20,width:20}}),(0,P.jsx)(Qe().Q,{iconGroup:rn().m,variantName:"default",style:{height:20,width:20}}),(0,P.jsx)(Qe().Q,{iconGroup:ln().g,variantName:"default",style:{height:20,width:20}})]}),(0,P.jsx)(v().sA,{id:"contacts_import_invite_tooltip.ms.header",defaultMessage:"Import contacts from Google, Slack, or Microsoft"})]}):(0,P.jsxs)(me().wt,{gap:10,children:[(0,P.jsx)(Qe().Q,{iconGroup:ln().g,variantName:"default",style:{height:20,width:20}}),(0,P.jsx)(v().sA,{id:"contacts_import_invite_tooltip.generic.header",defaultMessage:"You can now import contacts from Microsoft!"})]}),g="generic_tooltip"===o?(0,P.jsx)(v().sA,{id:"contacts_import_invite_tooltip.generic.content",defaultMessage:"Collaborate faster by importing contacts from your favorite tools."}):(0,P.jsx)(v().sA,{id:"contacts_import_invite_tooltip.ms.content",defaultMessage:"Notion now supports contact import from Outlook, Microsoft contacts, and more."});return(0,P.jsx)(Vi().B,{calloutId:Gi,shouldShow:a,inAppCalloutStore:d,onShow:()=>{(0,Wi().DL)(s,{callout_key:Gi,placement_key:"Tooltip"})},children:(0,P.jsx)(qi().k,{style:{marginInlineEnd:20},origin:t,placementToOrigin:"left",alignmentToOrigin:"start",numSteps:1,header:p,content:g,showPointer:!1,finalButtonContent:(0,P.jsx)(v().sA,{id:"contacts_import_invite_tooltip.finalButtonContent",defaultMessage:"Get started"}),skipButtonContent:(0,P.jsx)(v().sA,{id:"contacts_import_invite_tooltip.skipButtonContent",defaultMessage:"Not now"}),onSkipButtonClick:c,onPrimaryButtonClick:u,onCloseClick:c,shouldDismissUponOutsideClick:!0})})}var Yi=()=>n(133507);function $i(e){const{onClick:t,featureAvailability:n}=e;return(0,P.jsx)(wt().m,{disableTooltip:!1,renderTooltip:()=>(0,P.jsx)(Yi().j,{featureAvailability:n}),render:e=>(0,P.jsx)(he().A,{colorPalette:"blue",size:"lg",style:{marginInlineStart:8},onClick:t,...e,children:(0,P.jsx)(v().sA,{id:"shareMenu.inviteButton.upgrade",defaultMessage:"Upgrade"})})})}const Qi=1e3;function Zi(e){const{store:t,contextualInviteStore:n,internalDomains:s,inviteTargetsStore:o,invites:a,metadata:c,spaceMembershipType:u,spaceStore:p,spaceUserStore:g,sudoModeStore:m}=e,f=(0,r().v3)(),h=(0,v().tz)(),S=(0,d().IS)((()=>({permissionsRoleSelectButton:{display:"flex",whiteSpace:"nowrap",height:24,borderRadius:4,color:b().oZ.uiGray}})),[]),[x,M]=(0,i.useState)(t.table===Ot().C0?"reader":"editor"),[A,j]=(0,i.useState)(!1),[w,I]=(0,i.useState)(void 0),[k,T]=(0,i.useState)(!1),C=(0,le().X)("can_create_pages_in_collection_permission"),_=(0,i.useCallback)((()=>{const e=!A;j(e),e&&t instanceof Yn().B&&(0,Jn().Me)(t).then((e=>{e&&I(e)}))}),[A,t]),{source:B,focus:R,emailMessage:D,display:L}=(0,l().K8)((()=>{const{display:e}=U().Ay.state;return e===U().pP.Invite?U().Ay.state:{display:e,source:void 0,focus:void 0,emailMessage:""}}),[]),E=(0,l().K8)((()=>{if(t.table===y().ev)return t.getType()}),[t]),{inviteTargets:O,inputFieldText:N}=(0,l().K8)((()=>({inviteTargets:(0,Fe().U1)({inviteTargetsStore:o,includeInputFieldText:!0}),inputFieldText:o.state.tokenQuery.trim()})),[o]),F=async()=>{if(!k&&s){if(0===O.length){const e=U().Ay.state;return U().Ay.setState({...e,tab:U().QC.Share,display:U().pP.Invite,focus:U().yZ.Search,source:e.display===U().pP.Invite?e.source:U().NL.Notion,emailMessage:e.display===U().pP.Invite?e.emailMessage:""}),void z().UC(f,{source:"invite_button"})}T(!0);try{const e={role:x,canCreatePagesInCollection:A,store:t,spaceMembershipType:u,spaceStore:p};await Di({contextualInviteStore:n,destination:e,environment:f,internalDomains:s,intl:h,invites:a,inviteTargetsStore:o,metadata:c,spaceStore:p,spaceUserStore:g,sudoModeStore:m}),C&&A&&((0,Jn().pm)({environment:f,store:t,role:w??"read_and_write"}),I(void 0),j(!1))}finally{T(!1)}}},K=(0,De().sf)(a.map((e=>e.invitee)).filter(V().O9)),q=(0,l().K8)((()=>g.getUserId()),[g]),W=(0,Ve()._)({name:"guests",spaceId:p.id,userId:q,amount:K}),G=(0,l().K8)((()=>t.canEditMembership()),[t]),H=t.table===y().ev,Y=(0,Zn().i0)(H?t:void 0),$=(0,Zn().ty)(H?t:void 0),Q=Object.values(a).some((e=>{const t=e.defaultAddability.type;return"none"===t||"member_request"===t})),Z=D.length>Qi,X=k||!G||Y||$,[J,ee]=(0,i.useState)(!X),te=(0,i.useRef)(null),ne=(0,l().K8)((()=>"control"!==Ce().default.getEligibleGroup({experimentId:"microsoft_contacts_import",defaultGroup:"control"})),[]);(0,i.useEffect)((()=>{ne&&(0,Xn().HH)(f,Gi)}),[f,ne]);const ie=(0,Li().D)({permissionType:"user_permission",blockType:E,blockRole:x,blockTable:t.table,canCreatePagesInCollection:A,handleCanCreatePagesInCollectionChange:_,store:t,isInvite:!0}),se=(0,P.jsx)(Qn().Ay,{disabled:!G||Y||$,role:x,table:t.table,type:"user_permission",blockType:E,isInvite:!0,upgradeButtonName:"invite_permission_block",buttonStyle:S.permissionsRoleSelectButton,isMenuItem:!1,onChange:e=>M(e),spaceStore:p,...ie});return(0,P.jsx)(wt().m,{disableTooltip:G&&!Y&&!$,placement:"left",renderTooltip:()=>G?Y?(0,P.jsx)(v().sA,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip.pageInTrash",defaultMessage:"Restore page from trash to add people"}):$?(0,P.jsx)(v().sA,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip.hasAIEdits",defaultMessage:"Resolve pending edits to add people"}):void 0:(0,P.jsx)(v().sA,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip.needFullAccessRedesign",defaultMessage:"Request full access to share with others"}),render:e=>(0,P.jsxs)("div",{style:{display:"flex"},...e,ref:te,children:[(0,P.jsx)(Hi,{originRef:te,onPrimaryButtonClick:()=>{U().Ay.setState({...U().Ay.state,tab:U().QC.Share,display:U().pP.Invite,focus:U().yZ.Search,source:B||U().NL.Notion,emailMessage:D||""}),z().Wd(f,{source:B||U().NL.Notion}),0===O.length&&z().UC(f,{source:"invite_button"}),(0,Xn().a)(f,Gi)}}),(0,P.jsx)(zi,{inviteTargetsStore:o,metadata:c,focus:R===U().yZ.Search||L===U().pP.MainShareMenu&&J,setAutoFocusInput:ee,invites:a,disabled:X,onFocus:()=>{U().Ay.setState({...U().Ay.state,tab:U().QC.Share,display:U().pP.Invite,focus:U().yZ.Search,source:B||U().NL.Notion,emailMessage:D||""}),z().Wd(f,{source:B||U().NL.Notion}),0===O.length&&z().UC(f,{source:"invite_button"})},onSubmit:()=>{N.length>0||F()},placeholder:h.formatMessage({id:"shareMenu.inviteTargetsInput.placeholder.exp",defaultMessage:"Email or group, separated by commas"}),right:N.length>0&&U().Ay.getState().display===U().pP.Invite||O.length>0?se:void 0}),W?(0,$n().N9)(W,{available:()=>(0,P.jsx)(Ei().G,{tooltip:D.length>Qi?(0,P.jsx)(v().sA,{id:"shareMenu.inviteButton.emailOverMaxLength.tooltip",defaultMessage:"Message exceeds the limit of 1000 characters."}):void 0,disabled:!G||Y||$||Q||Z,onClick:F}),unavailable:e=>(0,P.jsx)($i,{featureAvailability:e,onClick:()=>{U().Ay.setState({...U().Ay.state,tab:U().QC.Share,display:U().pP.Invite,focus:void 0,source:B||U().NL.Notion,emailMessage:D||""}),Ut().D6({environment:f,upgradeButtonName:"user_permission_item",spaceStore:p})}})}):void 0]})})}var Xi=()=>n(755531),Ji=()=>n(718827),es=()=>n(347930),ts=()=>n(314907);const ns=function(e){const{buttonStyle:t}=(0,d().IS)((()=>({buttonStyle:{display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0,whiteSpace:"nowrap",height:28,borderRadius:6,boxShadow:b().Tj.shadow2XS,background:b().Tj.inputBackground,color:b().Tj.text.secondary,fill:b().oZ.white,lineHeight:1.2,paddingInlineStart:12,paddingInlineEnd:12,fontSize:14}})),[]);return(0,P.jsx)(Ji().Ay,{hovered:e.hovered,onClick:e.onClick,disabled:e.disabled,disabledFeedback:!0,style:{...t,...e.isLarge&&{height:32},...e.style},hoveredStyle:{background:b().Tj.buttonHoveredBackground},pressedStyle:{background:b().Tj.buttonPressedBackground},onFocus:e.onFocus,onBlur:e.onBlur,onMouseDown:e.onMouseDown,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,className:e.className,children:e.children})};const is=function(e){const{store:t}=e,i=(0,l().K8)((()=>t.canEditMembership()),[t]),s=(0,Zn().i0)(t.table===y().ev?t:void 0),o=(0,Zn().ty)(t.table===y().ev?t:void 0),r=(0,d().IS)((()=>({buttonContainer:{display:"flex",alignItems:"center",gap:gt().Y3},inputButton:{flex:1,justifyContent:"flex-start",overflow:"hidden",background:b().Tj.background.tertiaryTranslucent,borderRadius:10,color:b().Tj.text.tertiary,boxShadow:"none",height:a().A.isMobile?36:30},inputContent:{display:"flex",alignItems:"center",fontSize:16,fontWeight:400,...k().RC},iconContainer:{marginInlineEnd:8},blueButton:{minWidth:gt().CO}})),[]);return(0,P.jsx)(wt().m,{renderTooltip:()=>o?(0,P.jsx)(v().sA,{id:"inviteUserButton.tooltip.resolveAIEditsMessage",defaultMessage:"Resolve pending edits to add people"}):(0,P.jsx)(v().sA,{id:"inviteUserButton.tooltip.fullAccessOnlyMessage",defaultMessage:"Only those with full access can add people."}),disableTooltip:i&&!s&&!o,render:t=>(0,P.jsxs)("div",{style:r.buttonContainer,...t,children:[(0,P.jsx)(ns,{onClick:e.onClick,disabled:!i||s||o,style:r.inputButton,children:(0,P.jsx)("div",{style:r.inputContent,children:a().A.isMobile?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)("div",{style:r.iconContainer,children:(0,P.jsx)(Y().I,{icon:n(344417).magnifyingGlassSmallIcon,size:"sm",colorVariant:"secondary"})}),(0,P.jsx)(v().sA,{defaultMessage:"Invite people, emails, groups...",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithoutBots.mobile"})]}):(0,P.jsx)(v().sA,{defaultMessage:"Add emails or people",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithoutBots"})})}),a().A.isMobile?void 0:(0,P.jsx)(he().A,{colorPalette:"blue",size:"lg",onClick:e.onClick,disabled:!i||s||o,style:r.blueButton,children:(0,P.jsx)(v().sA,{id:"inviteUserButton.invitePersonLabel",defaultMessage:"Invite"})})]})})};function ss(e){const{store:t}=e,n=(0,r().v3)(),s=(0,r().WS)(),{sidebarSpaceId:o,sidebarSpaceStore:a}=(0,l().K8)((()=>{const e=(0,Xi().S)();return{sidebarSpaceId:null==e?void 0:e.id,sidebarSpaceStore:e}}),[]),c=(0,l().uB)(void 0,O().A),u=(0,l().K8)((()=>c.state.permissionsInviteStore),[c]),p=(0,l().K8)((()=>c.stageFromStoreState),[c]),g=(0,l().K8)((()=>u.state.modalOpen),[u]),m=(0,l().K8)((()=>t.canAdmin()),[t]),f=(0,ts().E)({spaceId:o}),h=(0,l().K8)((()=>(0,F().Xh)({store:t})),[t]),y=(0,d().IS)((()=>({button:{display:"flex",alignItems:"center",minHeight:0,marginBottom:16},buttonInner:{width:"100%"},modalButton:{height:36},requestedUsersToast:{marginBottom:96}})),[]),b=(0,i.useCallback)(((e,t)=>{e&&t>0&&xi().D6({label:(0,P.jsx)(v().sA,{id:"mobileInviteSection.onInviteComplete.toastMessage.requestedUsers",defaultMessage:"Sent request to invite {numRequests, plural, one {a guest} other {{numRequests} guests}}",values:{numRequests:t}}),style:s?y.requestedUsersToast:void 0})}),[s,y.requestedUsersToast]);return p!==E().d5.closed||s&&!m?null:(0,P.jsx)(Ji().Ay,{disabled:!0,style:y.button,children:(0,P.jsxs)("div",{style:y.buttonInner,children:[g&&a?(0,P.jsx)(es().H,{targetStore:t,spaceStore:a,disabled:!m,membersOnly:h,isSubscribed:f,upgradeButtonName:"invite_permission_block",shouldGrow:!0,buttonStyle:y.modalButton,permissionsInviteStore:u,onInviteComplete:b,analyticsFrom:"mobile_invite"}):void 0,(0,P.jsx)(is,{store:t,onClick:()=>(0,Ne().LH)({environment:n,permissionsInviteStore:u,store:t,isSubscribed:f,renderInShareModal:!1})})]})})}var os=()=>n(179030);function as(e){const{spaceName:t,domainUrl:n}=e,i=(0,v().tz)();return(0,P.jsx)(os().l,{tint:"gray",iconGroup:ii().A,label:i.formatMessage(rs.label,{spaceName:t}),description:i.formatMessage(rs.description,{domain:n}),display:"inline"})}const rs=(0,v().YK)({label:{id:"shareMenu.overLimitBanner.label",defaultMessage:"{spaceName} is over the guest limit"},description:{id:"shareMenu.overLimitBanner.description",defaultMessage:"If you share this page to a ‘@{domain}’ email, the invite will be sent to your workspace owners as a request to add them as a member with full access to the workspace."}});function ls(e){const{blockStore:t,contextualInviteStore:n,inviteTargetsStore:s,permissionItemArgs:o,spaceStore:r,spaceUserStore:c}=e,{spaceId:u,spaceName:p,userId:g,spaceModel:m}=(0,l().K8)((()=>({spaceId:r.getSpaceId(),spaceName:r.getName(),userId:c.getUserId(),spaceModel:r.getModel()})),[r,c]),f=(0,l().K8)((()=>(0,Pe().U)(t)),[t]),[h,v]=(0,l().K8)((()=>[c.getModel(),null==f?void 0:f.getModel()]),[c,f]),b=(0,l().K8)((()=>U().Ay.state.display),[]),S=function(e){return(0,d().IS)((()=>({container:{position:"relative",height:"unset",transition:"all",transitionDuration:"0.3s",display:"flex",flexDirection:"column",maxHeight:e?"80vh":530}})),[e])}((0,le().X)("collection_property_permissions")),x=(0,l().uB)(void 0,Be().$),M=(0,l().K8)((()=>n.state.flowId),[n]),A=function(e){return(0,i.useCallback)((t=>{t.preventDefault(),a().A.isMobile||e!==U().pP.MainShareMenu||U().Ay.setState({...U().Ay.state,tab:U().QC.Share,display:U().pP.Invite,focus:U().yZ.Search,source:U().NL.Notion,emailMessage:""})}),[e])}(b),j=(0,l().K8)((()=>(0,Fe().U1)({inviteTargetsStore:s,includeInputFieldText:!0}).map((e=>({inviteTarget:e,invitee:(0,We().qw)({inviteTarget:e,spaceStore:r})}))).filter(V().O9)),[s,r]),w=(0,qe().mF)({space:r,spaceUser:c,team:f,invitees:j.map((e=>e.invitee)).filter(V().O9),store:t}),I=(0,qe().kK)(c,f),k=(0,Oe().A)(r),T=j.map((e=>e.invitee)).filter((e=>void 0!==e&&void 0===e.currentRole&&k&&(0,Le().C7)(e.email,k))),C=(0,Ve()._)({name:"internal_guests",spaceId:u,userId:g,amount:T.length}),B=(0,Ke().P)({name:"non_admin_members",spaceId:u,userId:g})?"member":"owner",R=(0,Ue().r1)({spaceStore:r}),D=(0,l().K8)((()=>{const e=U().Ay.state,t=e.display===U().pP.Invite?e.emailMessage:"";return{inviteFlowId:n.state.flowId,inviteMessage:t,inviteOrigin:"share_menu",shareMenuSessionId:e.sessionId}}),[n]),L=(0,l().K8)((()=>w?j.map((e=>{const{inviteTarget:n,invitee:i}=e,s=null==i?void 0:i.email;let o,a;if("group"===n.type)if((0,Ne().dV)(n)){const e=(0,De().VH)({team:I,space:r,spaceUser:c,experimentService:Ce().default,shareTarget:t.table});a="can_add"===e.type?{type:"group"}:"can_request"===e.type?{type:"none",reason:"restricted_member_insufficient_role"}:{type:"none",reason:e.reason}}else a={type:"group"};else s?(o=(0,Le().CH)(s,k??[]),a=w[s]??{type:"none",reason:"other"}):a={type:"none",reason:"other"};return{defaultAddability:a,internalDomain:o,invitee:i,inviteTarget:n}})):[]),[j,w,k,c,r,I,t.table]),E=(0,Ee().Vi)(C,(()=>{if(!p)return;if(R)return;const e=T[0];if(!e)return;const t=(0,Re().zN)(e.email);return t?(0,P.jsx)(as,{spaceName:p,domainUrl:t}):void 0})),O=(0,le().X)("share_menu_inheritance_banner"),N=(0,l().O$)(Te().AppStoreSidebarSpaceViewStore),F=(0,l().K8)((()=>{var e;if(!N)return!1;const n=null===(e=N.getSettings())||void 0===e?void 0:e.agent_personalization_settings;return(null==n?void 0:n.context_page_id)===t.id&&t.table===y().ev}),[N,t]);return(0,P.jsx)(_e().N,{debugName:"ShareMenuShareTab",capture:!0,onTab:A,children:(0,P.jsxs)("div",{style:S.container,children:[(0,P.jsxs)(G().Y1,{direction:"vertical",gap:16,padding:a().A.isMobile?`0 ${Ge().u6}px 0px ${Ge().u6}px`:t.table!==y().ev?`16px ${Ge().rL}px 8px ${Ge().rL}px`:`0 ${Ge().rL}px 8px ${Ge().rL}px`,children:[a().A.isMobile?(0,P.jsx)(ss,{store:t}):(0,P.jsx)(Zi,{store:t,contextualInviteStore:n,internalDomains:k,invites:L,inviteTargetsStore:s,metadata:D,spaceMembershipType:B,spaceStore:r,spaceUserStore:c,sudoModeStore:o.sudoModeStore}),E]}),b===U().pP.MainShareMenu?(0,P.jsxs)(P.Fragment,{children:[F?(0,P.jsx)(Ye,{}):void 0,(0,P.jsx)(_().default,{store:t,calculatedPermissions:e.calculatedPermissions,buttonPopupStore:e.buttonPopupStore,permissionItemArgs:o,showPermissionInheritanceBanner:O})]}):void 0,b!==U().pP.Invite||a().A.isMobile?void 0:(0,P.jsx)(Hn,{store:t,inviteTargetsStore:s,menuListStore:x,calculatedPermissions:e.calculatedPermissions,permissionItemArgs:e.permissionItemArgs,flowId:M}),(0,P.jsx)(ze().A,{featureGateId:"guest_limit_debug_ui",whenEnabled:(0,P.jsx)(st,{domains:k,spaceId:u,spaceModel:m,userId:g,spaceUserModel:h,teamModel:v,blockStore:t}),whenDisabled:null})]})})}const ds=function(e){const{store:t,sudoModeStore:i}=e,s=(0,l().K8)((()=>i.state.changePermissionsEnabled),[i]),o=(0,l().K8)((()=>{if(!i)return!1;const e=i.state.privatePageStore;if(!(0,n(90023).F)(null==e?void 0:e.getSystemBlockTypeStore().getValue()))return!1;const s=!i.doesUserAlreadyHaveEditorAccess(t.pointer);return"workflow"===t.table?Boolean(i.shouldUserHaveAccessToPrivateWorkflow&&i.shouldUserHaveAccessToPrivateWorkflow())&&s&&Boolean(i.state.privateWorkflowStore):("block"!==t.table||!t.isPeopleCollectionViewPage())&&(Boolean(i.shouldUserHaveAccessToPrivatePageBlock&&i.shouldUserHaveAccessToPrivatePageBlock())&&s&&Boolean(i.state.privatePageStore))}),[i,t]),a=(0,d().IS)((()=>({container:{background:b().Tj.background.secondaryTranslucent,padding:"12px 18px",boxShadow:b().Tj.shadow2XS,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"baseline"},button:{fontWeight:k().Wy.medium,justifyContent:"center",marginTop:8,opacity:s?.5:1},icon:{transition:"all 200ms ease",transform:s?"rotate(-90deg)":void 0}})),[s]);return o?(0,P.jsxs)("div",{style:a.container,children:[(0,P.jsx)(f().A,{isMultiline:!0,children:(0,P.jsx)(v().sA,{id:"permissionsSettings.workspaceOwner.canChangePermissionsMessage",defaultMessage:"As a <b>workspace owner</b>, you can change the permissions of this {subject} to add yourself or others. Any changes will appear in the audit log.",values:{b:(...e)=>(0,P.jsx)("b",{children:e}),subject:"workflow"===t.table?(0,P.jsx)(v().sA,{id:"permissionsSettings.subject.agent",defaultMessage:"agent"}):(0,P.jsx)(v().sA,{id:"permissionsSettings.subject.page",defaultMessage:"page"})}})}),(0,P.jsx)($().A,{size:"lg",disabled:s,style:a.button,onClick:()=>{i.setState({...i.state,changePermissionsEnabled:!0})},iconLeading:{icon:n(570869).keySmallIcon,size:"sm",style:a.icon},children:s?(0,P.jsx)(v().sA,{id:"blockPermissionsSettings.workspaceOwner.isChangingPermissionsMessageButton",defaultMessage:"Changing permissions"}):(0,P.jsx)(v().sA,{id:"blockPermissionsSettings.workspaceOwner.canChangePermissionsMessageButton",defaultMessage:"Change permissions"})})]}):null};function cs(e){const t=(0,l().K8)((()=>U().Ay.state.tab),[]),n=(0,le().X)("marketplace_custom_agent_submission");switch(t){case U().QC.Share:return(0,P.jsx)(ls,{...e,blockStore:e.store});case U().QC.Publish:return e.store.table!==y().ev?n?(0,P.jsx)(Se,{store:e.store}):null:(0,P.jsx)(ke,{store:e.store,permissionItemArgs:e.permissionItemArgs,mostPermissivePublicItem:e.calculatedPermissions.mostPermissivePublicItem});default:(0,V().HB)(t)}}function us(){const e=(0,d().IS)((()=>({container:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",height:276},offlineMessageHeadline:{fontWeight:k().Wy.medium},iconStyle:{marginBottom:10}})),[]);return(0,P.jsxs)("div",{style:e.container,children:[(0,P.jsx)(Y().I,{icon:ue,size:"xl",colorVariant:"tertiary",style:e.iconStyle}),(0,P.jsx)("div",{style:e.offlineMessageHeadline,children:(0,P.jsx)(f().A,{isSecondaryColor:!0,isMultiline:!0,children:(0,P.jsx)(v().sA,{defaultMessage:"You’re offline",id:"blockPermissionsSettings.offline.headline"})})}),(0,P.jsx)(f().A,{isSecondaryColor:!0,isMultiline:!0,children:(0,P.jsx)(v().sA,{defaultMessage:"Go online to share and publish",id:"blockPermissionsSettings.offline.prompt"})})]})}const ps=function(e){const{store:t,permissionItemArgs:i,impliedPermissionOverrideIntent:s=!1}=e,o=(0,l().uB)(e.inviteTargetsStore,pe().Ay),r=(0,d().IS)((()=>({container:{display:"flex",flexDirection:"column",height:"100%"}})),[]),c=(0,l().O$)(n(929219).e);return(0,P.jsxs)("div",{style:r.container,children:[i.sudoModeStore&&!s?(0,P.jsx)(ds,{store:t,sudoModeStore:i.sudoModeStore}):void 0,a().A.isMobile?void 0:(0,P.jsx)(ge().aR,{store:t,inviteTargetsStore:o,mostPermissivePublicItem:e.calculatedPermissions.mostPermissivePublicItem}),c?(0,P.jsx)(cs,{inviteTargetsStore:o,...e}):(0,P.jsx)(us,{})]})};var gs=()=>n(64744);function ms(e){const{store:t,sudoModeStore:n,onUpgradeButtonClick:p,location:A,impliedPermissionOverrideIntent:w}=e,I=(0,r().v3)(),k=(0,gs().O)(t);(0,c().fJ)(L().Ns.publishSite),(0,c().fJ)(L().Ns.publishedSiteSettings);const T=(0,l().uB)(e.universalMemberInviteStore,O().A),_=(0,l().K8)((()=>T.state.contextualInviteStore),[T]),R=(0,N().H)(),z=(0,l().K8)((()=>t.getSpaceStore()),[t]),K=(0,s().U2)(z),V=(0,l().K8)((()=>F().dR({store:t,environment:I,trustedDomainsStore:R})),[I,t,R]),q=(0,l().K8)((()=>_.state.inviteStage),[_]),W=(0,l().K8)((()=>U().Ay.state.tab),[]),G=(0,d().IS)((()=>({title:{fontSize:16},topbarStyle:{paddingTop:15,paddingBottom:15,height:"auto",background:a().A.isMobile?b().Tj.background.secondary:void 0}})),[]),H=(0,i.useMemo)((()=>({onUpgradeButtonClick:p,sudoModeStore:n,location:A})),[p,n,A]),Y=(0,l().K8)((()=>M().default.isVisible(j().PUBLIC_SHARE_LINK_TOOLTIP_ID)),[]),$=(0,l().K8)((()=>(0,D().g)()),[]);if(!z)return $&&t.table===y().ev?(0,P.jsx)(B,{calculatedPermissions:V,store:t,permissionItemArgs:H,onClose:e.onClose}):null;if(!(a().A.isMobile||q!==E().d5.share_workspace&&q!==E().d5.request_workspace||Y||t.table!==y().ev))return(0,P.jsx)(re,{blockStore:t,spaceStore:z,contextualInviteStore:_});const Q=a().A.isMobile?{menuType:m().gu.Modal,disableHeaderShadow:!0,title:(0,P.jsx)(f().A,{style:G.title,children:(0,P.jsx)(v().sA,{defaultMessage:"Share settings",id:"blockPermissionsSettings.mobileShareMenu.titleV2"})}),additionalTopbarContent:t.table===y().ev?(0,P.jsx)(ge().zM,{store:t,mostPermissivePublicItem:V.mostPermissivePublicItem}):void 0,left:(0,P.jsx)(S().A,{href:(0,x().x)("guides.sharing"),analyticsFrom:"sharing"}),footer:W===U().QC.Share&&(0,P.jsx)(C().A,{store:t,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:V,permissionItemArgs:H,hasCollectionPropertyPermissionsSection:k.shouldRender}),topbarStyle:G.topbarStyle,right:(0,P.jsx)(v().sA,{...g().W.done}),onClickRight:e.onClose,whiteBackground:!1}:{menuType:m().gu.Popup,maxHeight:"90vh"};return K?(0,P.jsx)(h().A,{...Q,className:u().NXe,children:(0,P.jsx)(o().A,{debugName:"ShareMenuContainer",capture:!0,allowEsc:!0,children:(0,P.jsx)(fs,{store:t,spaceStore:z,spaceUserStore:K,permissionItemArgs:H,calculatedPermissions:V,buttonPopupStore:e.buttonPopupStore,inviteTargetsStore:e.inviteTargetsStore,contextualInviteStore:_,impliedPermissionOverrideIntent:w})})}):null}function fs({store:e,spaceStore:t,spaceUserStore:n,permissionItemArgs:s,calculatedPermissions:o,buttonPopupStore:a,inviteTargetsStore:l,contextualInviteStore:d,impliedPermissionOverrideIntent:c}){const u=(0,r().v3)();return(0,i.useEffect)((()=>{(0,A().I)({environment:u}),(0,p().clear)({environment:u})}),[u]),(0,P.jsx)(ps,{store:e,spaceStore:t,spaceUserStore:n,permissionItemArgs:s,calculatedPermissions:o,buttonPopupStore:a,inviteTargetsStore:l,contextualInviteStore:d,impliedPermissionOverrideIntent:c})}},308227:(e,t,n)=>{n.d(t,{A:()=>o});var i=()=>n(242422),s=()=>n(590526);function o(e){const{featureGateId:t,whenEnabled:n,whenDisabled:o,disableExposureLogging:a}=e,r=function(e){const{featureGateId:t,disableExposureLogging:n}=e;return(0,s().K8)((()=>i().default.checkGate({gateName:t,disableExposureLogging:n})),[t,n])}({featureGateId:t,disableExposureLogging:a});return r?n:o}},308228:(e,t,n)=>{n.d(t,{W:()=>r,m:()=>a});n(296540);var i=()=>n(69708),s=n(474848);const o=(0,i().YK)({addingGuestsToDefaultTeam:{id:"getTeamRoleDisabled.addingGuestsToDefaultTeam",defaultMessage:"Default teams can’t contain teamspace guests"},addingGuestsAsNonOwner:{id:"getTeamRoleDisabled.addingGuestsAsNonOwner",defaultMessage:"You must be a workspace owner and a teamspace owner to add teamspace guests"},makingAGroupATeamGuest:{id:"getTeamRoleDisabled.makingAGroupATeamGuest",defaultMessage:"Groups can’t be teamspace guests"},upgradingAnOwnerAsNonOwner:{id:"getTeamRoleDisabled.upgradingAnOwnerAsNonOwner",defaultMessage:"You must be a teamspace owner to add another owner"},downgradeLastUserOwner:{id:"getTeamRoleDisabled.downgradeLastUserOwner",defaultMessage:"Add another teamspace owner to downgrade yourself to member"},downgradeToOwnerAsNonOwner:{id:"getTeamRoleDisabled.downgradeToOwnerAsNonOwner",defaultMessage:"You must be a teamspace owner to downgrade other teamspace owners"},removeLastUserOwner:{id:"getTeamRoleDisabled.removeLastUserOwner",defaultMessage:"Add another teamspace owner to leave the team"},removeLastGroupOwner:{id:"getTeamRoleDisabled.removeLastGroupOwner",defaultMessage:"Add another teamspace owner to remove this group"},downgradeLastMakingAGroupAnOwner:{id:"getTeamRoleDisabled.downgradeLastMakingAGroupAnOwner",defaultMessage:"Add another teamspace owner to make this group a member"},downgradingAMemberToAGuest:{id:"getTeamRoleDisabled.downgradingAMemberToAGuest",defaultMessage:"To change this user to a teamspace guest, first remove them from the workspace."},removingMemberFromDefaultTeam:{id:"getTeamRoleDisabled.removingMemberFromDefaultTeam",defaultMessage:"Members cannot be removed from a default teamspace."},removingMemberAsMember:{id:"getTeamRoleDisabled.removingMemberTeam.noPermission",defaultMessage:"You must be a team owner to remove other team members in this teamspace."},changingTeamRoleAsNonTeamOwner:{id:"getTeamRoleDisabled.changingTeamRoleAsNonMember",defaultMessage:"You must be a teamspace owner to adjust teamspace membership."},addingRestrictedMemberAsOwner:{id:"getTeamRoleDisabled.addingRestrictedMemberAsOwner",defaultMessage:"Restricted members cannot be added as teamspace owners."}});function a({isCurrentUserTeamOwner:e,role:t,isDefaultTeam:n,userIsSpaceAdmin:i,isRoleForRestrictedMember:s,canRMsBeTeamOwners:a}){return e||"owner"!==t?n&&"team_level_guest"===t?l(o.addingGuestsToDefaultTeam):s&&"owner"===t&&!a?l(o.addingRestrictedMemberAsOwner):!i&&"team_level_guest"===t||!e&&"team_level_guest"===t?l(o.addingGuestsAsNonOwner):{isDisabled:!1,disabledReason:void 0}:l(o.upgradingAnOwnerAsNonOwner)}function r({isCurrentUserTeamOwner:e,role:t,isDefaultTeam:n,userIsSpaceAdmin:i,userIsEnterpriseWorkspaceOwner:s,originalTeamMemberInfo:r,onlyHasOneOwner:d,isUnowned:c,isMemberCurrentUser:u,canCurrentUserAddTeamMembers:p,isRoleForRestrictedMember:g,canRMsBeTeamOwners:m}){if("team_level_guest"===t&&"team_level_guest"!==r.type)return l(o.downgradingAMemberToAGuest);const f="owner"!==t&&"owner"===r.type;if(f&&!e)return l(o.downgradeToOwnerAsNonOwner);if(f&&d)return l("none"===t?"group"===r.entity_type?o.removeLastGroupOwner:o.removeLastUserOwner:"group"===r.entity_type?o.downgradeLastMakingAGroupAnOwner:o.downgradeLastUserOwner);if("none"===t&&n&&"user"===r.entity_type)return l(o.removingMemberFromDefaultTeam);return"group"===r.entity_type&&"team_level_guest"===t?l(o.makingAGroupATeamGuest):"owner"===t&&i&&"user"===r.entity_type&&c&&u||"owner"===t&&s&&u?{isDisabled:!1,disabledReason:void 0}:"none"===t?e||p&&"member"===r.type?{isDisabled:!1,disabledReason:void 0}:l(o.removingMemberAsMember):e?a({isCurrentUserTeamOwner:e,role:t,isDefaultTeam:n,userIsSpaceAdmin:i,isRoleForRestrictedMember:g,canRMsBeTeamOwners:m}):l(o.changingTeamRoleAsNonTeamOwner)}function l(e){return{isDisabled:!0,disabledReason:(0,s.jsx)(i().sA,{...e})}}},311221:(e,t,n)=>{n.d(t,{B:()=>a,X:()=>o});var i=()=>n(129522),s=()=>n(148134);function o(e){const{blockStore:t}=e,n=i().K.getRect(t);if(!n)return;const o=n.width,a=n.height,r=n.right-o,l=new DOMRect(r,n.top,o,a);s().Y.setState({open:!0,rect:l,blockStore:t})}function a(){s().Y.setState({open:!1,rect:s().Y.state.rect})}},313633:(e,t,n)=>{n.d(t,{A:()=>c});n(296540);var i=()=>n(401497),s=()=>n(695115),o=()=>n(563692),a=()=>n(340498),r=()=>n(69708),l=()=>n(100622),d=n(474848);function c(e){const{top:t,right:n,onClick:c}=e,u=(0,r().tz)(),p=(0,i().IS)((()=>({buttonBackground:{position:"absolute",top:t??12,insetInlineEnd:n??12,width:22,height:22,borderRadius:"100%",background:l().Tj.background.elevated},button:{width:"100%",height:"100%",borderRadius:"100%",display:"flex",justifyContent:"center",alignItems:"center",background:"transparent"},buttonHovered:{background:l().Tj.buttonHoveredBackground},icon:{width:a().Ev.xs,height:a().Ev.xs}})),[t,n]);return(0,d.jsx)("div",{style:p.buttonBackground,children:(0,d.jsx)(s().A,{ariaLabel:u.formatMessage({id:"closeButton.ariaLabel",defaultMessage:"Close"}),style:p.button,hoveredStyle:p.buttonHovered,onClick:c,icon:o().xMarkFillSmallIcon,iconStyle:p.icon})})}},315841:(e,t,n)=>{n.d(t,{Js:()=>a,Ns:()=>s,d:()=>o});var i=()=>n(79926);const s={publishSite:new(i().O2)("PublishSite",(async()=>await Promise.all([n.e(25700),n.e(35658),n.e(16345)]).then(n.bind(n,691385)))),publishedSiteSettings:new(i().O2)("PublishedSiteSettings",(async()=>await Promise.all([n.e(25700),n.e(40456),n.e(39301)]).then(n.bind(n,936897))))},o=(0,i()._h)(s.publishedSiteSettings,(e=>e.default)),a=(0,i()._h)(s.publishSite,(e=>e.default))},317655:(e,t,n)=>{n.r(t),n.d(t,{PermissionsInviteWithModal:()=>je});var i=n(296540),s=()=>n(300474),o=()=>n(135168),a=()=>n(484714),r=()=>n(590526),l=()=>n(401497),d=()=>n(711339),c=()=>n(741615),u=()=>n(127833),p=()=>n(250910),g=()=>n(160432),m=()=>n(148307),f=()=>n(84262),h=()=>n(69708),y=()=>n(980427),v=()=>n(134696),b=()=>n(701763),S=()=>n(542056),x=()=>n(743260),M=()=>n(299545),A=()=>n(852507),j=()=>n(882722),w=()=>n(224701),I=()=>n(249046),k=()=>n(106196),T=n(474848);function C(e){const{permissionsInviteStore:t,onInviteSubmit:n,onClose:s}=e,[o,a]=(0,i.useState)(!1),l=(0,r().K8)((()=>t.state.inviteTargets.length>0),[t]),d=(0,i.useCallback)((async()=>{a(!0);try{await n()}catch(e){}finally{a(!1)}}),[n]),c=(0,i.useCallback)((()=>{null==s||s(),t.reset()}),[t,s]);return(0,T.jsxs)(I().wt,{gap:8,children:[(0,T.jsx)(g().A,{colorPalette:"blue",onClick:d,disabled:!l||o,children:(0,T.jsx)(h().sA,{id:"spacePermissionsInviteFooter.submit.label",defaultMessage:"Send invite"})}),(0,T.jsx)(k().N,{buttonInfo:{buttonType:"secondary",label:(0,T.jsx)(h().sA,{id:"spacePermissionsInviteFooter.cancel.label",defaultMessage:"Cancel"}),onClick:c}})]})}const _=(0,n(340498).xh)("inviteMember",{default:{loader:()=>n.e(82292).then(n.bind(n,97835))},small:{loader:()=>n.e(82292).then(n.bind(n,779181))},fill:{loader:()=>n.e(82292).then(n.bind(n,489255))},fillSmall:{loader:()=>n.e(82292).then(n.bind(n,736414))}},["person","plus","add","include","join"]);var P=()=>n(838239),B=()=>n(227358);function R({inviteOrigin:e,isBillable:t}){const n=(0,i.useMemo)((()=>"post_upgrade_announcement"===e?(0,T.jsx)(h().sA,{id:"spacePermissionsInviteHeader.postUpgradeTitle",defaultMessage:"Invite your team to Notion"}):(0,T.jsx)(h().sA,{id:"spacePermissionsInviteHeader.title",defaultMessage:"Add members"})),[e]);return(0,T.jsx)(P().Y,{iconAndTitle:(0,T.jsx)(B().Z,{iconGroup:_,title:n}),description:(0,T.jsx)(h().sA,{...t?D.isBillable:D.isNotBillable})})}const D=(0,h().YK)({isBillable:{id:"spacePermissionsInviteHeader.billedDescription",defaultMessage:"Type or paste in emails below, separated by commas. Your workspace will be billed by members."},isNotBillable:{id:"spacePermissionsInviteHeader.freeDescription",defaultMessage:"Type or paste in emails below, separated by commas"}});var L=()=>n(31511),E=()=>n(493552),O=()=>n(456328);function N(e){const t=(0,l().IS)((()=>({container:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:6,alignSelf:"stretch"}})),[]);return(0,T.jsxs)("div",{style:t.container,children:[(0,T.jsx)(E().D,{styleKey:"captionMedium",colorVariant:"secondary",children:(0,T.jsx)(h().sA,{id:"spacePermissionsInviteMessageSection.label",defaultMessage:"Message"})}),(0,T.jsx)(F,{...e})]})}function F(e){const{permissionsInviteStore:t}=e,n=(0,r().K8)((()=>t.state.emailMessage),[t]),s=(0,h().tz)().formatMessage({id:"shareMenu.spacePermissionsInviteMessageInput.placeholder",defaultMessage:"Add a note to your invite..."}),o=1e3,a=n.length/o>=.8,l=(0,O().BS)(n),d=a||l,c=(0,i.useCallback)((e=>{t.setState({...t.state,emailMessage:e.target.value})}),[t]);return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(L().A,{textarea:!0,focusInitial:!1,placeholder:s,maxlength:o,value:n,onChange:c}),d?(0,T.jsx)(U,{messageLength:n.length,maxLength:o,shouldShowLengthWarning:a,shouldShowLinkWarning:l}):void 0]})}function U(e){const{shouldShowLengthWarning:t,shouldShowLinkWarning:n,messageLength:i,maxLength:s}=e;return(0,T.jsxs)(E().D,{styleKey:"captionMedium",colorVariant:"tertiary",children:[t?(0,T.jsx)(h().sA,{defaultMessage:"{characters} / {maxCharacters} characters",id:"ContextualInvite.permissions_invites.messageLengthWarning",values:{characters:i,maxCharacters:s}}):void 0,t&&n?" · ":void 0,n?(0,T.jsx)(h().sA,{defaultMessage:"Links will be omitted from your message",id:"ContextualInvite.permissions_invites.removeLinkWarning"}):void 0]})}var z=()=>n(230711),K=()=>n(483226),V=()=>n(807449),q=()=>n(265060),W=()=>n(81068),G=()=>n(803960),H=()=>n(100622),Y=()=>n(910322),$=()=>n(134217);function Q(e){const{permissionsInviteStore:t,spaceStore:n}=e,s=(0,a().v3)(),o=(0,r().K8)((()=>{const e=(0,K().AI)();return(0,$().fk)(e)}),[]);(0,A().l)((()=>{o||t.setState({...t.state,inviteTargets:[],inviteRole:"member"})}));const d=(0,r().K8)((()=>t.state.inviteRole),[t]),c=(0,z().U2)(n),g=(0,r().K8)((()=>null==c?void 0:c.getModel()),[c]),m=(0,i.useCallback)((e=>{S().lf({environment:s,newRole:e,permissionsInviteStore:t,spaceStore:n})}),[s,t,n]),f=(0,l().IS)((()=>({button:{width:"100%",margin:0,paddingTop:4,paddingBottom:4,border:`1px solid ${H().Tj.outlineButtonBorder}`},chevron:{marginInlineStart:3,marginInlineEnd:3},icon:{alignSelf:"start",marginTop:0,fill:H().Tj.icon.secondary,height:18,width:18}})),[]);if(!g)return null;const y=(0,Y().BL)({membershipType:d,isRemovable:!1,isCurrentUser:!1});return(0,T.jsx)(p().A,{popupType:u().nl.Popup,sameWidthAsOrigin:!0,originGap:8,render:e=>(0,T.jsx)(Y().kW,{spaceStore:n,spaceUser:g,targetUserId:void 0,isInvite:!0,currentType:d,parent:e,onChange:m,upgradeFrom:"sidebar_invite_people_button",from:"inviteMembersModal"}),renderOrigin:e=>(0,T.jsx)(W().A,{...e,right:(0,T.jsx)(V().I,{icon:G().arrowChevronSingleDownIcon,size:"xxs",colorVariant:"tertiary",style:f.chevron}),title:(0,T.jsx)(h().sA,{...y.label}),caption:(0,T.jsx)(h().sA,{...y.caption}),icon:(0,T.jsx)(q().Q,{colorPalette:"gray",colorVariant:"secondary",iconGroup:y.icon,variantName:"default"}),shouldWrapCaption:!0,buttonStyle:f.button,desktopIconStyle:f.icon,focused:!1})})}const Z=function(e){const t=(0,l().IS)((()=>({container:{display:"flex",flexDirection:"column",width:"100%",gap:8}})),[]);return(0,T.jsxs)("div",{style:t.container,children:[(0,T.jsx)(E().D,{styleKey:"captionMedium",colorVariant:"secondary",children:(0,T.jsx)(h().sA,{id:"spacePermissionsInviteRoleSection.label",defaultMessage:"Select role"})}),(0,T.jsx)(Q,{...e})]})};const X=function(e){const{onInviteClick:t,onClose:s,permissionsInviteStore:o,billingData:r,spaceStore:d,inviteOrigin:c}=e,u=(0,a().v3)();(0,A().l)((async()=>{await w().x(u)}));const p=(0,n(795523).Fq)(r),g=(0,i.useCallback)((()=>{o.setState({...o.state,inputFocus:"none"})}),[o]),m=(0,l().IS)((()=>({container:{width:460},body:{display:"flex",flexDirection:"column",gap:20,width:"100%"}})),[]);return(0,T.jsx)("div",{style:m.container,onClick:g,className:j().bFE,children:(0,T.jsx)(n(89002).t,{header:(0,T.jsx)(R,{inviteOrigin:c,isBillable:p}),footer:(0,T.jsx)(C,{onInviteSubmit:t,onClose:s,permissionsInviteStore:o}),children:(0,T.jsxs)("div",{style:m.body,children:[(0,T.jsx)(n(334013).A,{permissionsInviteStore:o}),(0,T.jsx)(Z,{permissionsInviteStore:o,spaceStore:d}),(0,T.jsx)(N,{permissionsInviteStore:o})]})})})};var J=()=>n(618841),ee=()=>n(698415),te=()=>n(405331),ne=()=>n(991249),ie=()=>n(433876),se=()=>n(295633),oe=()=>n(736847),ae=()=>n(96689),re=()=>n(496603),le=()=>n(232930),de=()=>n(78846),ce=()=>n(962036),ue=()=>n(347160),pe=()=>n(654856),ge=()=>n(897537);function me(e){const{store:t,permissionsInviteStore:s,membersOnly:o,upgradeButtonName:d,inviteOrigin:c,onInviteClick:u}=e,p=(0,a().v3)();(0,A().l)((async()=>{await w().x(p)}));const g=(0,r().K8)((()=>(0,M().Yu)(t)),[t]),m=(0,i.useCallback)((async()=>{await S().iS({environment:p,permissionsInviteStore:s,from:"share_menu",store:t})}),[p,s,t]),f=(0,l().IS)((()=>({right:{color:H().oZ.blue}})),[]);return(0,T.jsxs)(n(890492).A,{menuType:n(546926).gu.Modal,title:g?(0,T.jsx)(h().sA,{id:"inviteUserModal.addMemberMenu.title",defaultMessage:"Add members"}):(0,T.jsx)(h().sA,{id:"inviteUserModal.invitePersonMenu.title",defaultMessage:"Invite a person"}),right:(0,T.jsx)("div",{style:f.right,children:(0,T.jsx)(h().sA,{id:"inviteUserModal.mobile.inviteButton.label",defaultMessage:"Invite"})}),left:(0,T.jsx)(h().sA,{...n(245720).W.cancel}),onClickLeft:m,onClickRight:u,header:(0,T.jsx)(fe,{...e,inviteOrigin:c,onInviteClick:u}),className:j().bFE,children:[(0,T.jsx)(oe().A,{title:(0,T.jsx)(h().sA,{id:"inviteUserModal.permissionLevel.title",defaultMessage:"Permission level"}),children:(0,T.jsx)(ve,{store:t,upgradeButtonName:d,permissionsInviteStore:s})}),(0,T.jsx)("div",{children:(0,T.jsx)(he,{store:t,permissionsInviteStore:s,membersOnly:o})}),(0,T.jsx)(ye,{})]})}function fe(e){const{store:t,onInviteClick:n,permissionsInviteStore:o,inviteOrigin:l}=e,d=(0,a().v3)(),u=(0,r().K8)((()=>{const e=o.state.inputFocus;return"invitee"===e||"invitee-popup-closed"===e}),[o]),p=(0,s().r)(),g=(0,c().lh)({spaceId:p}),m=(0,i.useMemo)((()=>re().sg((()=>{v().D2(d,{invite_flow_id:o.state.flowId,billingData:g,invite_origin:l})}),1e3)),[d,o,l,g]),f=(0,i.useCallback)((async e=>{m(),await S().Pp({environment:d,event:e,permissionsInviteStore:o})}),[m,d,o]),h=(0,i.useCallback)((e=>{S().St({targetToRemove:e,permissionsInviteStore:o})}),[o]);return(0,T.jsx)(pe().A,{permissionsInviteStore:o,store:t,handleClickRemoveToken:h,handleInputChange:f,handleInputSubmit:n,origin:"share_modal",focus:u,handleFocus:()=>{}})}function he(e){const{store:t,permissionsInviteStore:n,membersOnly:i}=e,s=(0,r().K8)((()=>(0,M()._p)(t)),[t]),o=(0,r().K8)((()=>t instanceof se().B&&(0,de().h)(t.getSpaceStore())),[t]);return(0,T.jsx)(ge().A,{permissionsInviteStore:n,store:t,shouldShowGroups:s,sectionRenderLimit:10,membersOnly:i,guestsMustBeRequested:o})}function ye(){return(0,T.jsx)(oe().A,{topBorder:!0,disableDesktopPadding:!0,children:(0,T.jsx)(ce().g,{title:(0,T.jsx)(h().sA,{id:"inviteUserModal.helpButton.caption",defaultMessage:"Learn how to invite people and set permissions"}),href:(0,le().x)("guides.invitePerson"),analyticsFrom:"invite_person"})})}function ve(e){const t=(0,a().v3)(),{store:n,upgradeButtonName:s,permissionsInviteStore:d}=e,{inviteRole:c,table:u}=(0,r().O$)(d),p=(0,r().K8)((()=>(0,M()._p)(n)?n.getType():void 0),[n]),g=(0,r().K8)((()=>(0,M().Yu)(n)&&!n.canAdmin()),[n]),m=(0,r().K8)((()=>(0,M().Yu)(n)?n:(0,o().f)(n)),[n]),f=(0,i.useCallback)((e=>{S().lf({environment:t,newRole:e,permissionsInviteStore:d,spaceStore:m})}),[t,d,m]),h=(0,l().IS)((()=>({button:{display:"flex",whiteSpace:"nowrap",height:26,color:H().oZ.uiGray}})),[]),y=(0,z().U2)(m),v=(0,r().K8)((()=>null==y?void 0:y.getModel()),[y]);return c&&v?u===ae().NX?(0,T.jsx)(Y().VI,{spaceStore:m,spaceUser:v,targetUserId:void 0,currentType:c,isInvite:!0,isMenuItem:!0,buttonStyle:h.button,from:"spaceSettings",upgradeFrom:s,onChange:f}):(0,T.jsx)(ue().Ay,{disabled:g,role:c,table:u,type:"user_permission",blockType:p,isInvite:!0,upgradeButtonName:s,buttonStyle:h.button,isMenuItem:!0,onChange:f,spaceStore:m}):null}const be=i.memo(me);var Se=()=>n(430102),xe=()=>n(103448);function Me(e){const{targetStore:t,spaceStore:u,origin:p,sudoModeStore:g,onInviteComplete:y,onInviteClick:v,onClose:b,permissionsInviteStore:A}=e,j=(0,a().v3)(),I=(0,h().tz)(),k=(0,s().r)(),C=(0,c().lh)({spaceId:k}),_=(0,r().K8)((()=>A.state.modalOpen),[A]),P=(0,n(664594).T)(),B=(0,n(528093)._)({name:"members",spaceId:k,userId:P,amount:1}),R=e.analyticsFrom,D=(0,r().uB)(void 0,n(159026).Ay),L=(0,i.useCallback)(((e,t)=>{y?y(e,t):e||n(128933).D6({label:(0,T.jsx)(h().sA,{id:"SpacePermissionsInviteButton.handleOnInviteComplete.genericError",defaultMessage:"Invite failed to send"})})}),[y]),E=(0,i.useCallback)((async()=>{const e=d().default.DO_NOT_USE_markLegacy("share_menu.invite_user_lag");await S().kW({environment:j,targetStore:t,spaceStore:u,sudoModeStore:g,permissionsInviteStore:A,contextualInviteStore:D,onInviteClick:v,onInviteComplete:L,inviteOrigin:R,intl:I}),d().default.DO_NOT_USE_measureLegacy(e,{environment:j})}),[j,t,u,g,A,D,v,L,R,I]);(0,i.useEffect)((()=>{const e=(0,n(408895).M)({spaceId:k,userId:P,enforceIdsCheck:!1,debugFrom:"PermissionsInviteWithModal"});_&&!(0,n(534177).O9)(e)&&w().x(j)}),[j,_,k,P]);const O=(0,r().K8)((()=>Boolean(t.canEditMembership())),[t]),N=(0,r().K8)((()=>O&&(0,M().Yu)(t)&&(0,f().wy)(null==B?void 0:B.upsell)),[O,t,B]),F=(0,r().K8)((()=>function({store:e,canEditMembership:t,showUpgrade:n,membersAvailability:i}){if(!t&&(0,M().Yu)(e))return(0,T.jsx)(h().sA,{id:"inviteUserButton.tooltip.adminsOnlyMessage",defaultMessage:"Only admins can add members."});if(!t)return(0,T.jsx)(h().sA,{id:"inviteUserButton.tooltip.fullAccessOnlyMessage",defaultMessage:"Only those with full access can add people."});if(n)return(0,T.jsx)(xe().A,{imageURL:m().A.images.tooltips.upsells.spaceReadAndWritePng,imageWidth:240,imageHeight:100,caption:(0,T.jsx)(h().sA,{defaultMessage:"Members are teammates you invite to your workspace. They can access and add pages for all members to see, or be added to pages with permissions for private collaboration.",id:"permissionsInvite.spaceAddMemberUpgradeTooltip.caption"}),title:(0,T.jsx)(h().sA,{defaultMessage:"Upgrade to add members",id:"permissionsInvite.spaceAddMemberUpgradeTooltip.title"})});if(t&&!(0,f().wy)(null==i?void 0:i.upsell))return(0,T.jsx)(h().sA,{id:"inviteUserButton.tooltip.noUpsellAvailable",defaultMessage:"Adding members is not available."});return null}({store:t,canEditMembership:O,showUpgrade:N,membersAvailability:B})),[O,N,t,B]),U=(0,i.useCallback)((()=>async function(e,t,n,i,s){const a=await(0,x().iQ)({environment:e,permissionsInviteStoreState:n.state,from:i??((0,M().Yu)(t)?"space_share_modal":"page_share_modal"),spaceStore:(0,M().Yu)(t)?t:(0,o().f)(t)});a||(null==s||s(),n.reset())}(j,t,A,e.analyticsFrom,b)),[j,t,A,e.analyticsFrom,b]),z=(0,i.useCallback)((()=>C?n(726637).A.isMobile?(0,T.jsx)(be,{store:t,upgradeButtonName:e.upgradeButtonName,membersOnly:e.membersOnly,onInviteClick:E,inviteOrigin:R,permissionsInviteStore:A,billingData:C}):(0,n(406999).N2)(A)?(0,T.jsx)(X,{inviteOrigin:R,onInviteClick:E,billingData:C,permissionsInviteStore:A,onClose:b,spaceStore:u}):null:null),[t,e,E,b,R,A,C,u]),K=(0,l().IS)((()=>({modal:{display:"flex",alignSelf:"center",top:0}})),[]);return(0,M().Yu)(t)?(0,T.jsx)(ie().A,{open:_,onDismiss:U,renderContent:z,modalStyle:K.modal,origin:(0,T.jsx)(n(26697).m,{renderTooltip:()=>F,disableTooltip:O,render:n=>(0,T.jsx)(Ae,{spaceStore:u,tooltipEvents:n,actionEnabled:O,showUpgrade:N,buttonInner:p,membersAvailability:B,store:t,permissionsInviteStore:A,isSubscribed:e.isSubscribed,upgradeButtonName:e.upgradeButtonName,shouldGrow:e.shouldGrow,onInviteClick:e.onInviteClick,onInviteComplete:e.onInviteComplete,buttonStyle:e.buttonStyle,enableInviteDropdown:e.enableInviteDropdown,...n})})}):(0,T.jsx)(ie().A,{open:_,onDismiss:U,renderContent:z,origin:null})}function Ae({tooltipEvents:e,showUpgrade:t,actionEnabled:n,store:s,isSubscribed:o,enableInviteDropdown:d,onInviteClick:c,onInviteComplete:m,upgradeButtonName:S,onUpgradeButtonClick:M,shouldGrow:A,buttonStyle:j,permissionsInviteStore:w,buttonInner:I,membersAvailability:k,spaceStore:C}){const _=(0,a().v3)(),P=(0,h().tz)(),{forceImportDropdownOpen:B,shouldAddMembers:R}=(0,r().O$)(ee().F),D=(0,l().IS)((()=>({dropdownButton:{flex:A?1:0,...j},importListButton:{height:28,borderRadius:4,border:void 0,width:"100%"},importListButtonContainer:{padding:"0 6px",alignItems:"center"}})),[j,A]),L=(0,i.useCallback)((()=>function(e,t,n,i){(0,x().LH)({environment:e,permissionsInviteStore:i,store:t,renderInShareModal:!1,isSubscribed:n}),b().CW(e,{type:"invite"}),v().vX(e,{type:"invite",from:"settings_modal"})}(_,s,o,w)),[_,s,o,w]),E=(0,i.useCallback)((()=>(0,f().Pd)(k)&&t?function(e,t,n,i,s){ne().K(t,{from:e,upsell:n,spaceStore:i}),s&&s(),b().CW(t,{type:"upgrade"})}(S,_,k.upsell,C,M):L()),[_,L,M,t,S,k,C]);if(I)return(0,T.jsx)("div",{onClick:L,children:I});const O=(0,J().A)({onInviteClick:c,onInviteComplete:m,buttonStyle:D.importListButton,buttonContainerStyle:D.importListButtonContainer,shouldAddMembers:R}),N=!n||(0,f().Pd)(k)&&!(0,f().wy)(k.upsell);return d?(0,T.jsx)(p().A,{open:!!B||void 0,popupType:u().nl.Popup,alignmentToOrigin:"end",placementToOrigin:"bottom",render:()=>(0,T.jsx)(te().A,{importListItems:O}),originGap:12,onClose:()=>{B&&ee().F.closeImportDropdown()},renderOrigin:e=>(0,T.jsx)(Se().I,{disabled:N,style:D.dropdownButton,title:(0,T.jsx)(h().sA,{id:"inviteUserButton.addMemberLabel.dropdown",defaultMessage:"Add members"}),onClick:E,onDropdownClick:()=>{e.onClick(),y().V(_,{source:"add_members_button"})},color:"blue",dropdownAriaLabel:P.formatMessage({id:"permissionsInvite.dropdownAriaLabel",defaultMessage:"More invite options"})})}):(0,T.jsx)(g().A,{colorPalette:"blue",size:"lg",onClick:E,disabled:N,style:D.dropdownButton,...e,children:(0,T.jsx)(h().sA,{id:"inviteUserButton.addMemberLabel",defaultMessage:"Add members"})})}const je=i.memo(Me)},327994:(e,t,n)=>{n.d(t,{j:()=>o,u:()=>s});var i=()=>n(486678);const s=i().Z,o=i().S},329458:(e,t,n)=>{n.d(t,{L:()=>s});var i=()=>n(314529);function s(e,t){(0,i().DO_NOT_USE_trackLegacy)(e,"notion_topbar_click",t,{dontWait:!0})}},341694:(e,t,n)=>{n.d(t,{H:()=>d});var i=()=>n(907258),s=()=>n(590526),o=()=>n(21510),a=()=>n(673477),r=()=>n(696746);const l=["reply_menu_all_updates","reply_menu_archive","reply_menu_mentions_comments"];function d(){const e=(0,s().K8)((()=>o().A.state.open&&l.includes(o().A.state.discussionLocation)),[]),t=(0,s().K8)((()=>a().Ay.getIsMockText()),[]),n=(0,s().K8)((()=>(0,r().lU)(i().default.state.mainEditorCurrentBlockStore)),[]);return!t&&!e&&!n}},342990:(e,t,n)=>{n.d(t,{A:()=>S});n(581454),n(296540);var i=()=>n(484714),s=()=>n(590526),o=()=>n(401497),a=()=>n(249046),r=()=>n(807449),l=()=>n(448924),d=()=>n(980357),c=()=>n(995847),u=()=>n(100622),p=()=>n(187820),g=()=>n(562800),m=()=>n(300451),f=()=>n(885400),h=n(474848);const y={small:4,regular:14},v={small:{height:22,paddingInlineStart:8,paddingInlineEnd:10},regular:{height:42,paddingTop:10,paddingInlineStart:20,paddingInlineEnd:20,paddingBottom:8}},b={small:{height:28,paddingInlineStart:8,paddingInlineEnd:12},regular:{paddingTop:12,paddingInlineStart:16,paddingInlineEnd:16,paddingBottom:2}};function S(e){const{isMac:t}=(0,i().Y0)();return t?(0,h.jsx)(x,{...e}):(0,h.jsx)(A,{...e})}function x(e){const{store:t,siteRootBlockStore:n,size:i,location:s,showAddressBar:r}=e,l=y[i??"regular"],d=(0,o().IS)((()=>({container:{borderStartEndRadius:6,borderStartStartRadius:6,backgroundColor:"publish_preview"===s?u().Tj.palette.gray[75]:"transparent",...v[i??"regular"]},contentContainer:{flex:1}})),[s,i]),c=r&&t&&n;return(0,h.jsxs)(a().Ye,{alignItems:"center",gap:l,style:d.container,children:[(0,h.jsx)(M,{size:i}),c?(0,h.jsx)(a().Ye,{justifyContent:"center",alignItems:"center",style:d.contentContainer,children:(0,h.jsx)(w,{store:t,siteRootBlockStore:n})}):void 0]})}function M(e){const{size:t}=e,n=(0,o().IS)((()=>{const e="small"===t?6:10;return{circle:{borderRadius:"50%",height:e,width:e,background:u().Tj.icon.disabled}}}),[t]);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{style:n.circle}),(0,h.jsx)("div",{style:n.circle}),(0,h.jsx)("div",{style:n.circle})]})}function A(e){const{store:t,siteRootBlockStore:n,size:i,location:s,showAddressBar:r}=e,l=y[i??"regular"],d=(0,o().IS)((()=>({container:{width:"100%",borderStartEndRadius:6,borderStartStartRadius:6,backgroundColor:"publish_preview"===s?u().Tj.sitesPagePreviewWindowsChromeBar:"transparent",...b[i??"regular"]}})),[s,i]),c=r&&t&&n;return(0,h.jsxs)(a().Ye,{alignItems:"center",justifyContent:c?"center":"flex-end",gap:l,style:d.container,children:[c?(0,h.jsx)(w,{store:t,siteRootBlockStore:n}):void 0,(0,h.jsx)(j,{size:i})]})}function j(e){const{size:t}=e,n=(0,o().IS)((()=>({buttonsContainer:{display:"flex",gap:"small"===t?12:16,paddingInlineEnd:2}})),[t]);return(0,h.jsx)("div",{style:n.buttonsContainer,children:[l().$,d().u,c().xMarkSmallIcon].map(((e,n)=>(0,h.jsx)(r().I,{icon:e,size:"small"===t?"xxs":"xs",colorVariant:"tertiary",fitToViewBox:"horizontal"},`windows-buttons-${n}`)))})}function w(e){const{store:t,siteRootBlockStore:n}=e,{isMac:r}=(0,i().Y0)(),{icon:l,isEmptyPage:d,publicDomainName:c}=(0,s().K8)((()=>{const e=m().A.getState().faviconUrl;let i;const s=n.getSiteStore(),o=g().Ix({spaceStore:t.getSpaceStore(),domainId:null==s?void 0:s.getDomainId()});return i=e?{pointer:n.pointer,icon:e}:t.getIcon(),{icon:i,isEmptyPage:t.isEmptyPage(),publicDomainName:o}}),[t,n]),y=(0,o().IS)((()=>({container:{paddingInlineStart:r?120:12,paddingInlineEnd:r?120:12,paddingTop:4,paddingBottom:4,background:u().Tj.background.primary,borderRadius:r?16:20,border:`1px solid ${u().Tj.border.secondary}`,width:r?"auto":"100%",color:u().Tj.text.secondary,fontSize:12}})),[r]),v=l?(0,h.jsx)(p().B6,{disabled:!0,icon:l,isEmptyPage:d,disableShrinking:!0,size:16,emojiSize:16,style:{marginInlineEnd:4}}):(0,h.jsx)(f().A,{});return(0,h.jsxs)(a().Ye,{alignItems:"center",gap:4,style:y.container,children:[r?v:void 0,c]})}},345578:(e,t,n)=>{n.d(t,{A:()=>l});n(296540);var i=()=>n(807449),s=()=>n(26697),o=()=>n(642557),a=()=>n(69708),r=n(474848);function l(){return(0,r.jsx)(s().m,{textWrap:!0,style:{width:210},placement:"bottom",renderTooltip:()=>(0,r.jsx)(a().sA,{id:"teamLockIcon.tooltip",defaultMessage:"Private teamspaces can only be accessed or joined by invitation"}),render:e=>(0,r.jsx)("div",{...e,style:{alignContent:"center"},children:(0,r.jsx)(i().I,{icon:o().lockSmallIcon,size:"sm",colorVariant:"secondary"})})})}},354420:(e,t,n)=>{n.r(t),n.d(t,{DummyModal:()=>l});n(296540);var i=()=>n(148307),s=()=>n(69708),o=()=>n(32231),a=n(474848);const r=(0,s().YK)({title:{id:"dummyModal.title",defaultMessage:"Dummy Modal"},body:{id:"dummyModal.body",defaultMessage:"This is the body for the dummy modal."},primaryButton:{id:"dummyModal.primaryButton",defaultMessage:"Primary"},secondaryButton:{id:"dummyModal.secondaryButton",defaultMessage:"Secondary"},learnMore:{id:"dummyModal.learnMore",defaultMessage:"Learn More"}});function l(){const e=(0,s().tz)();return(0,a.jsx)(o().P,{messageKey:"dummy_modal",title:e.formatMessage(r.title),body:e.formatMessage(r.body),heroMedia:{src:i().A.images.sites.sitesLaunchModalPng,alt:"Dummy Modal",type:"image"},primary:{text:e.formatMessage(r.primaryButton)},secondary:{text:e.formatMessage(r.secondaryButton)},link:{text:e.formatMessage(r.learnMore),external:!0}})}},357731:(e,t,n)=>{n.d(t,{P:()=>g,U:()=>p});var i=()=>n(907258),s=()=>n(590526),o=()=>n(465628),a=()=>n(232615),r=()=>n(680977),l=()=>n(301421),d=()=>n(559241),c=()=>n(547149);function u(){const e=a().default.state;if("editing"===e.mode){const t=(0,o().H)(e.multiSelection);if(t&&(0,d().g)(t.selection)){const e=t.store,n=l().n.findEditableWithStore(e);if(n){return e.getValue()?void 0:n}}}}function p(){return(0,s().K8)(u,[])}function g(e){const{currentUserSettingsStore:t}=i().default.state;t&&c().createAndCommit({userAction:"educationTooltipsActions.completePressSlashTooltip",environment:e,perform:e=>{(0,r().m)({userSettingsStore:t,transaction:e,data:{pressed_slash_tooltip:!0}})},canUndo:!0,userId:t.id})}},359929:(e,t,n)=>{n.d(t,{A:()=>_,P:()=>T});var i=n(296540),s=()=>n(726637),o=()=>n(484714),a=()=>n(590526),r=()=>n(401497),l=()=>n(30537),d=()=>n(807449),c=()=>n(695115),u=()=>n(546926),p=()=>n(890492),g=()=>n(416504),m=()=>n(236262),f=()=>n(69708),h=()=>n(100622),y=()=>n(384944),v=()=>n(898286),b=()=>n(391214),S=()=>n(366437),x=()=>n(270710),M=()=>n(654774),A=()=>n(547149),j=()=>n(187820),w=()=>n(729368),I=n(474848);const k={property:!0};function T(){return(0,r().IS)((()=>({wrapper:{display:"flex",alignItems:"center",color:h().Tj.text.primary,fontSize:"13px",padding:"4px 8px"},input:{display:"block",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingInlineStart:10,paddingInlineEnd:10,width:"100%",borderRadius:4,boxShadow:h().Tj.inputBoxShadow,background:h().Tj.inputBackground,cursor:"text",position:"relative"}})),[])}function C(e){const t=(0,f().tz)(),n=(0,o().v3)(),r=(0,a().K8)((()=>x().A.state.clonedBlockStore),[]),l=(0,a().K8)((()=>null==r?void 0:r.getTitleStore()),[r]),d=(0,a().K8)((()=>(null==r?void 0:r.canEdit())??!1),[r]),c=(0,a().K8)((()=>{var e;if(r)return null===(e=r.getModel())||void 0===e?void 0:e.getEmptyTitlePlaceholder({getRecordModel:r.getRecordModel,userTimeZone:(0,g().P)(),intl:t})}),[r,t]);(0,i.useEffect)((()=>{if(!r)return;const e=r.getTitleStore();e&&(0,M().x)({environment:n,store:e,canSelectAllBlocks:!1})}),[r,n]);const m=T();if(!r||!l)return null;const{renderDelete:h}=e;let y;return y=s().A.isMobile?{menuType:u().gu.ActionSheet}:{menuType:u().gu.Popup,width:380},(0,I.jsx)(p().A,{...y,children:(0,I.jsxs)("div",{style:m.wrapper,children:[(0,I.jsx)(R,{blockStore:r}),(0,I.jsx)(w().A,{store:l,disabled:!d,onEsc:()=>v().V(n),onEnter:()=>v().V(n),onTab:()=>!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,placeholder:c,style:m.input,pasteBehavior:"inline",inPageFind:S().Os.none,disabledMentionTypes:k}),h&&d?(0,I.jsx)(P,{}):void 0]})})}const _=function(){const e=(0,o().v3)(),{clonedBlockStore:t,originRect:i}=(0,a().K8)((()=>{const{clonedBlockStore:e,originRect:t}=x().A.state;return{clonedBlockStore:e,originRect:t}}),[]);return(0,I.jsx)(n(127833).zD,{popupType:s().A.isMobile?l().n.SlideUp:l().n.Popup,open:Boolean(t),originRect:i,placementToOrigin:"bottom",alignmentToOrigin:"center",originGap:4,onDismiss:()=>v().V(e),render:()=>(0,I.jsx)(B,{}),trapFocus:!0})};function P(){const e=(0,o().v3)(),t=(0,f().tz)();return(0,I.jsx)(c().A,{ariaLabel:t.formatMessage({id:"renamePageMenu.deleteButton.ariaLabel",defaultMessage:"Delete"}),icon:e=>(0,I.jsx)(d().I,{icon:m().trashIcon,style:{...e}}),style:{marginInlineStart:6},hasBackground:!0,colorVariant:"primary",showShadow:!0,onClick:async()=>{const{originalBlockStore:t}=x().A.state;t&&await b().Af({environment:e,blocks:[t],shouldCheckSuggestEdit:!0}),v().V(e)}})}function B(){const e=(0,a().K8)((()=>x().A.state.renderDelete),[]);return(0,I.jsx)(C,{renderDelete:Boolean(e)})}function R({blockStore:e}){const t=(0,o().v3)(),n={width:28,height:28,marginInlineEnd:6,flexShrink:0,flexGrow:0,boxShadow:`inset 0 0 0 1px ${h().Tj.border.primaryTranslucent}`},i=(0,a().K8)((()=>e.canEdit()),[e]),s=(0,a().K8)((()=>{var t;return null===(t=e.getIconStore())||void 0===t?void 0:t.table}),[e]),r=(0,a().K8)((()=>{var t;return null===(t=e.getIconStore())||void 0===t?void 0:t.id}),[e]),l=(0,a().K8)((()=>e.getIcon()),[e]),d=(0,a().K8)((()=>e.isEmptyPage()),[e]),c=(0,a().K8)((()=>e.getType()),[e]),u=(0,a().K8)((()=>(0,j().Te)(e)),[e]);return i?(0,I.jsx)(j().B6,{disabled:!1,bucket:"secure",store:e,icon:l,iconRecordCategory:u,isEmptyPage:d,size:18,style:n,iconLoggingData:{recordTable:s,source:"breadcrumb",block_type:c,collection_id:"collection"===s?r:void 0},onChange:e=>function(e,t){const{clonedBlockStore:n}=x().A.state;if(n){const i=n.getIconStore();i&&A().createAndCommit({userAction:"RenamePageMenuPopup.handleRecordIconChange",environment:t,canUndo:!0,perform:t=>{y().KY({store:i,value:e,transaction:t})}})}}(e,t)}):(0,I.jsx)(j().B6,{disabled:!0,icon:l,iconRecordCategory:u,isEmptyPage:d,size:18,style:n})}},375099:(e,t,n)=>{n.d(t,{h:()=>r,v:()=>a});n(16280);var i=n(296540),s=n(474848);const o=(0,i.createContext)(void 0);function a({children:e,dependencies:t}){return(0,s.jsx)(o.Provider,{value:t,children:e})}function r(){const e=(0,i.useContext)(o);if(!e)throw new Error("SlashMenuDependenciesContext is missing a provider");return e}o.displayName="SlashMenuDependenciesContext"},378003:(e,t,n)=>{n.r(t),n.d(t,{CollectionMentionContextMenu:()=>_});n(296540);var i=()=>n(484714),s=()=>n(590526),o=()=>n(127833),a=()=>n(30537),r=()=>n(546926),l=()=>n(890492),d=()=>n(663639),c=()=>n(736847),u=()=>n(584262),p=()=>n(955363),g=()=>n(808764),m=()=>n(742852),f=()=>n(419942),h=()=>n(177256),y=()=>n(868840),v=()=>n(69708),b=()=>n(884107),S=()=>n(600449),x=()=>n(211716),M=()=>n(232930),A=()=>n(982909),j=()=>n(620558),w=()=>n(712505),I=()=>n(575143),k=()=>n(962036),T=n(474848);const C=(0,v().YK)({title:{id:"collectionMentionContextMenu.title",defaultMessage:"Data source"},openInNewTab:{id:"collectionMentionContextMenu.openInNewTab",defaultMessage:"Open in new tab"},openInNewWindow:{id:"collectionMentionContextMenu.openInNewWindow",defaultMessage:"Open in new window"},openInFullPage:{id:"collectionMentionContextMenu.openInFullPage",defaultMessage:"Open in full page"},openInSidePeek:{id:"collectionMentionContextMenu.openInSidePeek",defaultMessage:"Open in side peek"},copyLink:{id:"collectionMentionContextMenu.copyLink",defaultMessage:"Copy link"},learnMore:{defaultMessage:"Learn about data sources",id:"collectionMentionContextMenu.learnAboutDataSources"}});function _(){const e=(0,i().v3)(),t=(0,v().tz)(),{isActive:n,collectionStore:_}=(0,s().O$)(j().s),P=(0,s().K8)((()=>{const e=j().s.state;if(e.isActive)return new DOMRect(e.left,e.top,1,1)}),[]),B=(0,s().K8)((()=>w().default.isSidePeekOpen()),[]),R=()=>{A().V()};if(!n||!_)return null;const D={key:"open_in_new_window",render:(e,n)=>(0,T.jsx)(I().A,{...e,title:t.formatMessage(C.openInNewWindow),svg:g().U,onFocus:n.onFocus}),action:()=>{_&&((0,S().Zj)({environment:e,store:_,visitType:x().ig.Link,pageVisitSource:u().y8.LinkInPage,openInNew:"window"}),A().V())}},L={key:"open_in_full_page",render:(e,n)=>(0,T.jsx)(I().A,{...e,title:t.formatMessage(C.openInFullPage),svg:f().o,onFocus:n.onFocus}),action:()=>{_&&w().default.isSidePeekOpen()&&((0,S().Zj)({environment:e,store:_,visitType:x().ig.Link,pageVisitSource:u().y8.LinkInPage}),A().V())}},E={key:"open_in_side_peek",render:(e,n)=>(0,T.jsx)(I().A,{...e,title:t.formatMessage(C.openInSidePeek),svg:h().A,onFocus:n.onFocus}),action:()=>{_&&((0,S().Zj)({environment:e,store:_,visitType:x().ig.Link,pageVisitSource:u().y8.LinkInPage,peekMode:y().A}),A().V())}},O={key:"copy_link",render:(e,n)=>(0,T.jsx)(I().A,{...e,title:t.formatMessage(C.copyLink),svg:m().linkIcon,onFocus:n.onFocus}),action:async()=>{if(!_)return;(await b().R.clipboardActions.load()).copyLinkToCollection({environment:e,collectionStore:_}),A().V()}},N=[{key:"open_in_new_tab",render:(e,n)=>(0,T.jsx)(I().A,{...e,title:t.formatMessage(C.openInNewTab),svg:p().arrowDiagonalUpRightIcon,shortcut:"commandShiftEnter",onFocus:n.onFocus}),action:()=>{_&&((0,S().Zj)({environment:e,store:_,visitType:x().ig.Link,pageVisitSource:u().y8.LinkInPage,openInNew:"tab"}),A().V())}},...e.device.isNative?[D]:[],...B?[L]:[],E,O];return(0,T.jsx)(o().zD,{open:n,popupType:a().n.Popup,originRect:P,placementToOrigin:"bottom",alignmentToOrigin:"start",originGap:4,preventScaleTransition:!0,render:()=>(0,T.jsxs)(l().A,{menuType:r().gu.Popup,width:265,children:[(0,T.jsx)(d().A,{type:d().O.Vertical,initialFocus:void 0,sections:[{key:"collection_mention_menu",render:e=>(0,T.jsx)(c().A,{...e,title:t.formatMessage(C.title)}),items:N}],onAccept:R}),(0,T.jsx)(c().A,{topBorder:!0,children:(0,T.jsx)(k().g,{title:t.formatMessage(C.learnMore),href:(0,M().x)("guides.dataSources"),analyticsFrom:"collection_mention_context_menu"})})]}),onDismiss:R,trapFocus:!1})}},379648:(e,t,n)=>{n.r(t),n.d(t,{TopbarMoreMenu:()=>Dn});var i=n(296540),s=()=>n(242422),o=()=>n(726637),a=()=>n(484714),r=()=>n(792485),l=()=>n(590526),d=()=>n(401497),c=()=>n(807449),u=()=>n(546926),p=()=>n(890492),g=()=>n(424400),m=()=>n(791177),f=()=>n(736847),h=()=>n(344417),y=()=>n(69708),v=()=>n(100622),b=()=>n(284371),S=()=>n(636714),x=(n(16280),n(18107),n(967357),n(898992),n(672577),n(581454),n(737550),()=>n(314529)),M=()=>n(907258),A=()=>n(755531),j=()=>n(486547),w=()=>n(383036),I=()=>n(929219),k=()=>n(675133),T=()=>n(609679),C=()=>n(876338),_=()=>n(128933),P=()=>n(493552),B=()=>n(700500),R=()=>n(165358),D=()=>n(934999),L=()=>n(112665),E=()=>n(104077),O=()=>n(340498),N=n(474848);const F={viewBox:"0 0 20 20",fittedViewBox:"4.12 1.5 11.75 16",svg:(0,N.jsx)("path",{d:"M11.5 1.5c.768 0 1.41.534 1.58 1.25h.67c1.174 0 2.125.951 2.125 2.125v10.5A2.125 2.125 0 0 1 13.75 17.5h-7.5a2.125 2.125 0 0 1-2.125-2.125v-10.5c0-1.174.951-2.125 2.125-2.125h.67c.17-.716.812-1.25 1.58-1.25zM6.25 4a.875.875 0 0 0-.875.875v10.5c0 .483.392.875.875.875h7.5a.875.875 0 0 0 .875-.875v-10.5A.875.875 0 0 0 13.75 4h-.67a1.626 1.626 0 0 1-1.58 1.25h-3c-.768 0-1.41-.534-1.58-1.25zM8.5 2.75a.375.375 0 0 0-.375.375v.5c0 .207.168.375.375.375h3a.375.375 0 0 0 .375-.375v-.5a.375.375 0 0 0-.375-.375z"})},U=(0,O().wt)("clipboard",F,"default");var z=()=>n(274570);const K={viewBox:"0 0 20 20",fittedViewBox:"1.85 4.78 15.81 13.4",svg:(0,N.jsx)("path",{d:"M14.029 7.244q.814 0 1.419.362.502.306.845.856V7.418h1.36v7.336c0 1.053-.297 1.893-.9 2.506s-1.438.914-2.492.914c-1.143 0-2.066-.35-2.755-1.06l-.063-.065.06-.07.681-.797.071-.083.076.079q.751.78 1.945.781c.688 0 1.187-.182 1.515-.527.328-.347.502-.876.502-1.606v-.974a2.56 2.56 0 0 1-.845.857q-.605.363-1.42.362c-.937 0-1.682-.351-2.224-1.054-.54-.71-.805-1.666-.805-2.86s.265-2.145.804-2.844c.542-.713 1.288-1.069 2.226-1.069m.449 1.23c-.645 0-1.138.195-1.492.577-.356.383-.54.903-.54 1.57v1.073c0 .668.184 1.187.54 1.57.354.382.847.578 1.492.578q.785-.002 1.304-.387c.34-.25.51-.597.51-1.05V9.91c0-.453-.17-.8-.51-1.05q-.52-.384-1.304-.386M9.896 14.97l.04.13h-1.5l-.021-.072-.834-2.813H4.176l-.834 2.813-.02.072H1.85l.04-.13L5.013 4.78h1.758zm-5.371-4.014h2.707L5.877 6.303z"})},V=(0,O().wt)("fontStyleMono",K,"default"),q={viewBox:"0 0 20 20",fittedViewBox:"1.56 4.81 16.88 13.21",svg:(0,N.jsx)("path",{d:"M14.735 7.265q.716 0 1.154.238.443.239.686.552t.373.542h.114V7.363h1.373v7.82q0 .98-.453 1.607-.452.63-1.228.93a4.7 4.7 0 0 1-1.725.303q-.894 0-1.542-.234a3.1 3.1 0 0 1-1.053-.616 2.7 2.7 0 0 1-.621-.83l1.193-.558q.14.215.367.468.234.253.632.433.398.178 1.034.178.865 0 1.427-.418.566-.417.566-1.332v-1.512h-.093q-.135.235-.383.538a2.1 2.1 0 0 1-.687.522q-.437.225-1.148.224a3.16 3.16 0 0 1-1.636-.428q-.726-.433-1.149-1.263-.422-.835-.422-2.047 0-1.204.413-2.074.418-.875 1.143-1.343a3 3 0 0 1 1.665-.466m.274 1.213q-.69 0-1.154.352a2.16 2.16 0 0 0-.69.955q-.229.601-.23 1.347.001.76.235 1.338.234.576.695.904.462.323 1.144.323.656 0 1.11-.307.456-.31.69-.881.239-.577.239-1.377 0-.786-.234-1.382-.229-.601-.686-.935-.453-.337-1.12-.337M10.58 15H9.032l-.956-2.744h-4.01L3.111 15H1.565l3.68-10.182h1.65zm-6.083-3.982h3.15L6.11 6.608h-.08z"})},W=(0,O().wt)("fontStyleSans",q,"default"),G={viewBox:"0 0 20 20",fittedViewBox:"1.28 4.68 17.44 14.08",svg:(0,N.jsx)("path",{d:"M14.83 7.666c.688 0 1.17.164 1.75.367l2.029-.219.111-.011v1.116l-.105-.006-1.474-.077c.332.338.635.862.635 1.57 0 1.68-1.523 2.74-3.035 2.74q-.54 0-1.04-.166a1.7 1.7 0 0 0-.325.332.53.53 0 0 0-.114.295c0 .153.164.39.45.402h.002l2.787.162c.742.045 1.295.234 1.662.54.37.309.543.729.543 1.212 0 .654-.42 1.364-1.174 1.905-.757.543-1.859.924-3.248.924-.713 0-1.4-.15-1.91-.443-.513-.294-.86-.74-.86-1.324 0-.59.396-1.24 1.13-1.636l.251-.138-.967-.927-.049-.046.025-.062c.283-.723.597-1.104 1.092-1.531-.647-.441-1.099-1.17-1.099-2.18 0-1.67 1.306-2.799 2.933-2.799m-1.212 7.726a2.8 2.8 0 0 0-.356.492c-.127.225-.22.476-.22.718 0 .243.108.543.4.784.292.24.777.428 1.535.428 1.79 0 2.466-.852 2.466-1.449 0-.233-.075-.412-.237-.543-.168-.134-.439-.228-.85-.257zm1.123-6.95c-.408 0-.725.15-.942.426-.219.28-.344.697-.344 1.243 0 .71.148 1.265.404 1.637.253.368.614.564 1.059.565.708 0 1.316-.629 1.316-1.714 0-.776-.174-1.316-.444-1.66a1.28 1.28 0 0 0-1.05-.498m-4.433 5.558 1.025.332v.66h-3.99v-.664l.074-.02 1.149-.312-.84-2.412H4.268l-.8 2.244 1.324.483.066.024v.656H1.28v-.64l.063-.025.815-.323 3.568-9.016.022-.053.057-.01.488-.071.517-.147.089-.025zm-5.643-3.501h2.681L6.017 6.703z"})},H=(0,O().wt)("fontStyleSerif",G,"default");var Y=()=>n(735790),$=()=>n(11356),Q=()=>n(435644);const Z={viewBox:"0 0 20 20",fittedViewBox:"1.89 4.31 16.61 11.72",svg:(0,N.jsx)("path",{d:"m8.965 12.538 1.125 3.077a.625.625 0 1 0 1.174-.43L7.526 4.961a.987.987 0 0 0-1.854 0L1.934 15.185a.625.625 0 1 0 1.174.43l1.125-3.078zm-.457-1.25H4.69l1.909-5.223zm7.334 4.554a.625.625 0 0 1-.884 0l-2.475-2.475a.625.625 0 0 1 .884-.884l1.408 1.408V4.994a.625.625 0 1 1 1.25 0v8.897l1.408-1.408a.625.625 0 1 1 .884.884z"})},X=(0,O().wt)("textSmall",Z,"default");var J=()=>n(470020),ee=()=>n(496603),te=()=>n(534177),ne=()=>n(231536),ie=()=>n(896628),se=()=>n(384944),oe=()=>n(554340),ae=()=>n(799832),re=()=>n(930545),le=()=>n(575143),de=()=>n(718827),ce=()=>n(26697),ue=()=>n(302501),pe=()=>n(85229);function ge(e,t){return e.isFiltering?function(e){return(0,N.jsx)(le().A,{...e,title:e.caption,caption:void 0})}(e):function({id:e,caption:t,focused:n,isActive:s,onClick:a,onMouseDown:r,onMouseEnter:l,onMouseLeave:c,role:u,style:p,tooltip:g,ignoreLocalHoverState:m,disallowTabbing:f},h){const{isMenuListFocusVisible:y}=(0,i.useContext)(pe().V),b=(0,d().IS)((()=>({optionItem:{display:"flex",flexDirection:"column",alignItems:"center",minWidth:34,justifyContent:"flex-end"},button:{width:"100%",...o().A.isMobile?{padding:16,paddingTop:20,transition:"color 300ms, border 300ms",lineHeight:1}:{padding:6,paddingTop:10,borderRadius:4,transition:"color 300ms, border 300ms",lineHeight:1},justifyContent:"center",color:s?v().oZ.blue:"inherit",...n&&y&&{boxShadow:v().Tj.buttonBlueFocusRing}}})),[s,y,n]);return(0,N.jsx)(ce().m,{renderTooltip:()=>g,placement:"bottom",delayThreshold:80,render:i=>{const s=(0,w().A)(i,{onMouseEnter:l,onMouseLeave:c}),{onMouseDown:o,...d}=s;return(0,N.jsx)(de().Ay,{...d,id:e,role:u,ref:h,onClick:a,onMouseDown:s.onMouseDown||r,hovered:n,style:b.button,ignoreLocalHoverState:m,disallowTabbing:f,className:"notranslate",children:(0,N.jsxs)("div",{style:b.optionItem,children:[(0,N.jsx)("div",{style:{...p,height:25},children:"Ag"}),(0,N.jsx)(ue().A,{isSmall:!0,style:{marginTop:4},children:t})]})})}})}(e,t)}const me=i.forwardRef(ge);const fe=function(e){const{children:t}=e,{mobileStyle:n,desktopStyle:i}=(0,d().IS)((()=>({mobileStyle:{display:"flex",justifyContent:"space-around",boxShadow:`0 1px 0 ${v().Tj.border.secondaryTranslucent}`,background:v().Tj.popoverBackground},desktopStyle:{display:"flex",justifyContent:"space-between",padding:"0px 8px"}})),[]);return(0,N.jsx)(f().A,{...e,children:(0,N.jsx)("div",{style:o().A.isMobile?n:i,children:t})})};var he=()=>n(263885),ye=()=>n(584262),ve=()=>n(558687),be=()=>n(267271);var Se=()=>n(775584),xe=()=>n(733637),Me=()=>n(440902),Ae=()=>n(411960),je=()=>n(598101),we=()=>n(597755),Ie=()=>n(492414),ke=()=>n(549721);const Te=(0,y().YK)({openInMacAppName:{id:"action.openInMacApp.name",defaultMessage:"Open in Mac app"},openInWindowsAppName:{id:"action.openInWindowsApp.name",defaultMessage:"Open in Windows app"},openIniOSAppName:{id:"action.openIniOSApp.name",defaultMessage:"Open in iOS app"},openInAndroidAppName:{id:"action.openInAndroidApp.name",defaultMessage:"Open in Android app"}}),Ce=(0,be().Ls)({key:"open in mac app",displayName:Te.openInMacAppName,analyticsName:Te.openInMacAppName.defaultMessage,svg:ve().notionIcon,validators:[Me().v,(0,je().A)(xe().i),(0,je().A)(Se().F),function({environment:{device:e}}){return e.isMac},(0,je().A)(Ae().P)],closeParentMenu:!0,action:({blocks:e,environment:t})=>{const n=(0,Ie().Ay)({store:e[0],fullyQualified:!1,pageVisitSource:ye().y8.AppRedirect,embedded:!1});(0,ke().e)({url:(0,we().PT)(n),environment:t})}}),_e=(0,be().Ls)({key:"open in windows app",displayName:Te.openInWindowsAppName,analyticsName:Te.openInWindowsAppName.defaultMessage,svg:ve().notionIcon,validators:[Me().v,(0,je().A)(xe().i),(0,je().A)(Se().F),n(791117).u,(0,je().A)(Ae().P)],closeParentMenu:!0,action:({blocks:e,environment:t})=>{const n=(0,Ie().Ay)({store:e[0],fullyQualified:!1,pageVisitSource:ye().y8.AppRedirect,embedded:!1});(0,ke().e)({url:(0,we().PT)(n),environment:t})}}),Pe=(0,be().Ls)({key:"open in ios app",displayName:Te.openIniOSAppName,analyticsName:Te.openIniOSAppName.defaultMessage,svg:ve().notionIcon,validators:[Me().v,(0,je().A)(xe().i),n(808565).u,(0,je().A)(Ae().P)],closeParentMenu:!0,action:({blocks:e,environment:t})=>{const n=(0,Ie().Ay)({store:e[0],fullyQualified:!1,pageVisitSource:ye().y8.AppRedirect,embedded:!1});(0,ke().e)({url:n,environment:t})}}),Be=(0,be().Ls)({key:"open in android app",displayName:Te.openInAndroidAppName,analyticsName:Te.openInAndroidAppName.defaultMessage,svg:ve().notionIcon,validators:[Me().v,(0,je().A)(xe().i),n(875855).m,(0,je().A)(Ae().P)],closeParentMenu:!0,action:({blocks:e,environment:t})=>{const n=(0,Ie().Ay)({store:e[0],fullyQualified:!1,pageVisitSource:ye().y8.AppRedirect,embedded:!1});(0,ke().e)({url:n,environment:t})}});function Re(){return[Ce,_e,Pe,Be]}var De=()=>n(877235),Le=()=>n(910302),Ee=()=>n(383070),Oe=()=>n(77246),Ne=()=>n(147294);function Fe(e){const{blockStore:t,menuListItemProps:s,title:r,onFocus:d,closeParentMenu:c}=e,g=(0,a().v3)(),m=(0,u().Tf)(),f=(0,l().K8)((()=>Ee().zD.isFullPageTranslateEnabled()),[]),{detectedLanguage:h}=(0,n(514799).H)({pageStore:t,enabled:f}),v=(0,n(5580).n)(),[b,S]=(0,i.useState)(void 0),x=b??h??v,{isTranslating:M,editorModeConfigTranslateState:A}=(0,l().K8)((()=>{const e=Oe().Uv.getTranslateModeForBlock(t.id);return e?{isTranslating:!0,editorModeConfigTranslateState:e}:{isTranslating:!1,editorModeConfigTranslateState:{mode:"translate_unlocked",status:"pre_activation",sourceLanguage:x}}}),[t,x]),j=!(0,l().O$)(I().e),w=(0,i.useCallback)((e=>{const{sourceLanguage:t}=e;S(t)}),[]),k=(0,i.useCallback)((e=>{const{targetLanguage:n}=e;Le().Z9({pageStore:t,environment:g}),Le().Ww({pageStore:t,targetLanguage:n,sourceLanguage:x,environment:g,triggeredFrom:"action_menu"}),c()}),[t,x,g,c]),T=(0,i.useMemo)((()=>M?(0,N.jsx)(P().D,{colorPalette:"red",colorVariant:"accentPrimary",children:(0,N.jsx)(y().sA,{id:"translation.stop",defaultMessage:"Stop"})}):void 0),[M]);return"pre_activation"!==A.status||j?(0,N.jsx)(le().A,{...s,title:r,badge:(0,N.jsx)("div",{style:{marginInlineStart:6},children:(0,N.jsx)(Ne().Ee,{newBadgeKey:"ai_page_translation_topbar_more_action",didUserEngage:!1,keyType:"date"})}),svg:De().textTranslateIcon,right:T,onClick:()=>{Le().DL({pageStore:t,environment:g,triggeredFrom:"action_menu"}),c()},disabled:j,disabledFeedback:j,tooltipText:j?(0,N.jsx)(y().sA,{...be().AY.unavailableOfflineTooltip}):void 0}):(0,N.jsx)(n(662971).A,{...s,disableDefaultClick:!0,onFocus:d,focused:s.focused,disableCloseOnEnter:!0,renderExtension:(e,i)=>{const s=o().A.isMobile?{menuType:u().gu.Modal,right:m?void 0:(0,N.jsx)(y().sA,{...n(245720).W.done}),left:m?(0,N.jsx)(n(283163).h,{}):void 0,onClickRight:m?void 0:i.close,onClickLeft:m?i.close:void 0,shouldRenderMobileRefresh:m,paddingTop:m?10:void 0,title:r,...e}:{menuType:u().gu.Popup,height:480,...e};return(0,N.jsx)(p().A,{...s,onClick:e=>{e.stopPropagation()},children:(0,N.jsx)(n(391435).Z,{onSelectTargetLanguage:k,onSelectSourceLanguage:w,editorModeConfigTranslateState:A,sourceLanguage:x,detectedPageLanguage:h,preferredLanguage:v,subMenuPlacement:"left",pageId:t.id})})},renderOrigin:(e,t)=>(0,N.jsx)(le().A,{...e,ref:t,title:r,badge:(0,N.jsx)("div",{style:{marginInlineStart:6},children:(0,N.jsx)(Ne().Ee,{newBadgeKey:"ai_page_translation_topbar_more_action",didUserEngage:!1,keyType:"date"})}),svg:De().textTranslateIcon,right:T})})}var Ue=()=>n(158658);function ze(e){const{environment:t}=e;return e.blocks.some((e=>(0,n(400851).Y)({environment:t,blockStore:e,from:"pageActionsMenu",allowTabletsToUseLayoutBuilder:s().default.checkGate({gateName:"layouts_tablet_builder"})})))}var Ke=()=>n(486674);function Ve(){const e=(0,Ke().a)();return Boolean(null==e?void 0:e.getAssociatedCollectionStore())}n(823215);var qe=()=>n(613848);function We(e){if(o().A.isAdminMode)return!0;if(e.blocks.some((e=>{const t=(0,n(247450).h)({blockId:e.id,setting:"disableExport"});return Boolean(null==t?void 0:t.disabled)})))return!1;if((0,n(333344).P)(e)&&!(0,n(77295).K)(e))return!1;const t=function({environment:e}){const{sidebarSpaceStore:t}=M().default.state;if(!t)return!1;const n=qe().A.getData(e,{spaceId:t.id,userId:e.currentUser.id});return t.isDefined()?!t.getDisableExport():n?!n.disableExport:(0,oe().h)()}(e),{environment:i,blocks:s}=e;return s.every((e=>{const s=(0,n(74351).U)(e),o=null==s?void 0:s.getModel();return s&&o?(!i.currentUser.id||!(0,n(468006).CG)({team:o,userId:i.currentUser.id}))&&!s.getDisableExport():t}))}var Ge=()=>n(155963),He=()=>n(460995),Ye=()=>n(339425),$e=()=>n(963335),Qe=()=>n(333799);var Ze=()=>n(787281),Xe=()=>n(606376),Je=()=>n(514779),et=()=>n(49533),tt=()=>n(201004),nt=()=>n(467294),it=()=>n(419286),st=()=>n(422155);var ot=()=>n(470928),at=()=>n(821507),rt=()=>n(538075),lt=()=>n(603596),dt=()=>n(404141),ct=()=>n(795179),ut=()=>n(547149),pt=()=>n(962763),gt=()=>n(53528);const mt=(0,y().YK)({expiredVerification:{defaultMessage:"Expired",id:"verificationHelpers.mobileAction.subtitle.expiredVerification"},indefiniteVerification:{defaultMessage:"No expiration",id:"verificationHelpers.mobileAction.subtitle.indefiniteVerification"},verificationWithEndDate:{defaultMessage:"Until {date}",id:"verificationHelpers.mobileAction.subtitle.datedVerification"},archived:{defaultMessage:"Archived",id:"verificationHelpers.mobileAction.subtitle.archived"}});var ft=()=>n(488923),ht=()=>n(102172);const yt=(0,y().YK)({aiCoEditingName:{id:"action.aiCoEditing.name",defaultMessage:"AI co-editing"}}),vt=(0,be().fi)({key:"ai_co_editing",displayName:yt.aiCoEditingName,label:k().A.formatMessage(yt.aiCoEditingName),getSvgIcon:()=>n(824375).sparklesIcon,isChecked:(e,t)=>e.isNavigableBlock()&&(0,ht().Wv)(e,t),validators:[(0,je().A)(Ge().K),Ue().p,(0,je().A)(Ye().o),(0,je().A)(Xe().l),()=>Ee().zD.isAiEnabled(),(0,$e().S)("ai_co_editing")],action:async(e,t,n)=>{if(!t.isNavigableBlock())return;const i=(0,ht().Wv)(t,e);if(await(0,ft().ne)({environment:e,pageId:t.id,active:!i}),i){(await(0,ft().gY)()).clearStore()}}});var bt=()=>n(863687),St=()=>n(12956),xt=()=>n(774411),Mt=()=>n(961232),At=()=>n(142015),jt=()=>n(168345);const wt={viewBox:"0 0 20 20",fittedViewBox:"2.37 3.13 15.26 14.86",svg:(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("path",{d:"M10 5.88c.345 0 .625.28.625.625V8.38H12.5a.625.625 0 1 1 0 1.25h-1.875v1.875a.625.625 0 1 1-1.25 0V9.63H7.5a.625.625 0 1 1 0-1.25h1.875V6.505c0-.345.28-.625.625-.625"}),(0,N.jsx)("path",{d:"M15.5 3.13c1.174 0 2.125.951 2.125 2.125v7.5A2.125 2.125 0 0 1 15.5 14.88h-4.935l-3.871 2.978a.625.625 0 0 1-1.006-.496V14.88H4.5a2.125 2.125 0 0 1-2.125-2.125v-7.5c0-1.174.951-2.125 2.125-2.125zm.875 2.125a.875.875 0 0 0-.875-.875h-11a.875.875 0 0 0-.875.875v7.5c0 .483.392.875.875.875h1.813c.345 0 .625.28.625.625v1.838l3.033-2.334a.63.63 0 0 1 .381-.13H15.5a.875.875 0 0 0 .875-.874z"})]})},It=(0,O().wt)("commentAdd",wt,"default");var kt=()=>n(33376),Tt=()=>n(525884),Ct=()=>n(848392),_t=()=>n(158574),Pt=()=>n(189158),Bt=()=>n(182034);function Rt(e){return e.blocks.every((e=>{const t=null==e?void 0:e.getModel();return Boolean(null==t?void 0:t.isType(B().Gz))}))}var Dt=()=>n(462580),Lt=()=>n(900967),Et=()=>n(449195),Ot=()=>n(21178),Nt=()=>n(393686),Ft=()=>n(883497),Ut=()=>n(592968);const zt=(0,y().YK)({addCover:{id:"mobile_page_actions.add_cover",defaultMessage:"Add cover"},changeCover:{id:"mobile_page_actions.change_cover",defaultMessage:"Change cover"},addComment:{id:"mobile_page_actions.add_comment",defaultMessage:"Add comment"},viewComments:{id:"mobile_page_actions.view_comments",defaultMessage:"View comments"},backlinks:{id:"mobile_page_actions.backlinks",defaultMessage:"Backlinks"},addDescription:{id:"mobile_page_actions.add_description",defaultMessage:"Add description"},showDescription:{id:"mobile_page_actions.show_description",defaultMessage:"Show description"},hideDescription:{id:"mobile_page_actions.hide_description",defaultMessage:"Hide description"},viewBreadcrumb:{id:"mobile_page_actions.view_breadcrumb",defaultMessage:"View breadcrumb"}});function Kt(e){const{blockStore:t,environment:n}=e;return(0,be().Ls)({key:"add comment",displayName:zt.addComment,svg:It,analyticsName:zt.addComment.defaultMessage,validators:[tt().p,(0,je().A)(Ve),re().tm,(0,je().A)(re().tC)],closeParentMenu:!0,action:async()=>{await(0,Bt().O)({blockStore:t,environment:n})}})}function Vt(e){const{environment:t,intl:n,blockStore:i}=e,s=Boolean(i.getCover());return(0,be().Ls)({key:"add page cover",displayName:s?zt.changeCover:zt.addCover,svg:Ct().M,analyticsName:s?zt.changeCover.defaultMessage:zt.addCover.defaultMessage,validators:[Ue().p,et()._,(0,je().A)(Ye().o),(0,st().or)([Rt,Ge().K]),(0,je().A)(Dt().J)],closeParentMenu:!0,action:(e,s)=>{Nt().W({environment:t,intl:n,store:i,rect:e.originRect,from:"topbar_more_menu"})}})}function qt(e){const{environment:t,blockStore:n}=e,i=(0,Lt().Ju)(n,t).backlinksCount;if(i<=0)return;return"section_hide"!==(0,Et().nl)(n.getFormat().page_section_visibility)?(0,be().Ls)({key:"view backlinks",displayName:zt.backlinks,analyticsName:"view_backlinks",validators:[tt().p],closeParentMenu:!0,render:e=>(0,N.jsx)(le().A,{...e,title:(0,N.jsx)(y().sA,{id:"topbarMoreMenuActions.viewBacklinks",defaultMessage:"{numberOfBacklinks, plural, =0 {No backlinks} one {{numberOfBacklinks} backlink} other {{numberOfBacklinks} backlinks}}",values:{numberOfBacklinks:i}}),svg:At().D}),action:()=>{Ut().F.setState({isOpen:!0})}}):void 0}function Wt(e){const{blockStore:t}=e;if(!t.isCollectionView())return;const n=Mt().A.getPageViewBlockStore(t);if(!n)return;const{currentUserSettingsStore:i}=M().default.state,s=t.getCollectionViewSourceDescriptionStore(),o=Ot().cf(s),a=n.state.isPageDescriptionExpanded;return o&&a?Gt({shouldShow:!1,blockStore:t,descriptionStore:s,pageViewBlockStore:n,userSettingsStore:i}):o&&!a?Gt({shouldShow:!0,blockStore:t,descriptionStore:s,pageViewBlockStore:n,userSettingsStore:i}):function(e){const{blockStore:t,descriptionStore:n,pageViewBlockStore:i,userSettingsStore:s}=e;return(0,be().Ls)({key:"add collection description",displayName:zt.addDescription,analyticsName:"add_collection_description",validators:[Ge().K,Ue().p],closeParentMenu:!0,svg:Tt().infoCircleIcon,action:(e,o)=>{_t().KM({environment:e.environment,pageId:t.id,store:i,userSettingsStore:s,descriptionStore:n})}})}({blockStore:t,descriptionStore:s,pageViewBlockStore:n,userSettingsStore:i})}function Gt(e){const{shouldShow:t,blockStore:n,descriptionStore:i,pageViewBlockStore:s,userSettingsStore:o}=e;return(0,be().Ls)({key:t?"show collection description":"hide collection description",displayName:t?zt.showDescription:zt.hideDescription,analyticsName:t?"show_collection_description":"hide_collection_description",validators:[Ge().K,Ue().p],closeParentMenu:!0,svg:Tt().infoCircleIcon,action:(e,t)=>{_t().JO({store:s,pageId:n.id,descriptionStore:i,environment:e.environment,userSettingsStore:o})}})}function Ht(e){return(0,be().Ls)({key:"view breadcrumb",displayName:zt.viewBreadcrumb,analyticsName:"view_breadcrumb",validators:[(0,st().or)([tt().p,Ge().K])],closeParentMenu:!0,svg:kt().E,action:t=>{(0,Pt().f)(t.environment,e.blockStore)}})}var Yt=()=>n(354406),$t=()=>n(37689),Qt=()=>n(804643),Zt=()=>n(709906),Xt=()=>n(73926),Jt=()=>n(498002),en=()=>n(954719);const tn=(0,y().YK)({customizePageLabel:{id:"action.customizePage.label",defaultMessage:"Customize page"},exportName:{id:"action.export.name",defaultMessage:"Export"},exportCaption:{id:"action.export.caption",defaultMessage:"PDF, HTML, Markdown & CSV"},exportDisabledTooltip:{id:"action.export.disabledTooltip",defaultMessage:"Export is disabled for this page"},fontDefaultName:{id:"action.setPageFont.default.fuzzySearchKeywords",defaultMessage:"Font Default"},fontDefaultCaption:{id:"action.setPageFont.default.caption",defaultMessage:"Default"},fontDefaultTooltip:{id:"action.setPageFont.default.tooltip",defaultMessage:"The default sans-serif workhorse"},fontSerifName:{id:"action.setPageFont.serif.fuzzySearchKeywords",defaultMessage:"Font Serif"},fontSerifCaption:{id:"action.setPageFont.serif.caption",defaultMessage:"Serif"},fontSerifTooltip:{id:"action.setPageFont.serif.tooltip",defaultMessage:"Good for publishing"},fontMonoName:{id:"action.setPageFont.mono.fuzzySearchKeywords",defaultMessage:"Font Mono"},fontMonoCaption:{id:"action.setPageFont.mono.caption",defaultMessage:"Mono"},fontMonoTooltip:{id:"action.setPageFont.mono.tooltip",defaultMessage:"Good for drafting and notes"},fontComicName:{id:"action.setPageFont.comic.fuzzySearchKeywords",defaultMessage:"Font Comic"},fontComicCaption:{id:"action.setPageFont.comic.caption",defaultMessage:"Comic"},fontComicTooltip:{id:"action.setPageFont.comic.tooltip",defaultMessage:"Playful but cringe"},fontSmallTextKeywords:{id:"action.fontSmallText.fuzzySearchKeywords",defaultMessage:"Font Small Text"},fontSmallTextLabel:{id:"action.fontSmallText.label",defaultMessage:"Small text"},fullWidthLabel:{id:"action.fullWidth.label",defaultMessage:"Full width"},importName:{id:"action.import.name",defaultMessage:"Import"},lockPageName:{id:"action.lockPage.name",defaultMessage:"Lock page"},floatingTableOfContents:{id:"action.floatingTableOfContents.name",defaultMessage:"Table of contents"},notifyMe:{id:"action.notifyMe.name",defaultMessage:"Notify me"},pageVerification:{id:"action.pageVerification.name",defaultMessage:"Verify page"},addContentStatus:{id:"action.addContentStatus.name",defaultMessage:"Add content status"},contentStatus:{id:"action.contentStatus.name",defaultMessage:"Content status"},verifiedStatus:{id:"action.contentStatus.verified",defaultMessage:"Verified"},archivedStatus:{id:"action.contentStatus.archived",defaultMessage:"Archived"},pageHistoryName:{id:"action.pageHistory.name",defaultMessage:"View edit history"},pageHistoryNewName:{id:"action.pageHistoryNew.name",defaultMessage:"Version history"},pageHistoryFuzzySearchKeywords:{id:"action.pageHistory.fuzzySearchKeywords",defaultMessage:"Version history edits updates"},pageUpdates:{id:"action.pageUpdates.title",defaultMessage:"Page updates"},textFontStyle:{id:"action.textFontStyle.name",defaultMessage:"Text style"},suggestEditsName:{id:"action.suggestEdits.name",defaultMessage:"Suggest edits"},viewUpdatesAndAnalyticsName:{id:"action.updatesAndAnalytics.name",defaultMessage:"Updates & analytics"},viewUpdatesAndAnalyticsFuzzySearchKeywords:{id:"action.viewUpdatesAndAnalytics.fuzzySearchKeywords",defaultMessage:"Updates & analytics edits"},openPageLayoutEditor:{id:"action.layoutEditor.open",defaultMessage:"Customize layout"},translate:{id:"action.translate",defaultMessage:"Translate"},copyPageContents:{id:"action.copyPageContents.label",defaultMessage:"Copy page contents"}});function nn(e){const{environment:t,intl:n,context:i,isFiltering:s}=e,o=i.blocks[0],a=o.getFollowSettingsKey(),r=rt().H8({followSettingsKey:a,environment:t,blockStore:o,from:"more_menu"});if(o.isSystemBlock()){const e=!(o.isPeopleCollectionViewPage()||o.isPersonProfile());return[(0,be().gy)({key:"system block all actions",render:e=>(0,N.jsx)(f().A,{...e}),actions:[...e?[Tn,hn]:[],bt().qQ,bt().Zk,en().p6,yn,vn,...Re()]})]}const l=(0,at().aD)(t.device);return[s?ln(t,o.getFormat().page_font||"default"):an,(0,be().gy)({key:"topbar primary actions",render:e=>(0,N.jsx)(f().A,{...e,topBorder:!1}),actions:[bt().qQ,bt().Zk,en().p6,yn,vn,bn,xt().TR,xt().kl,xt().J8,xt().lb,$t().tw,Qt().dl]}),(0,be().gy)({key:"available offline",render:e=>(0,N.jsx)(f().A,{...e}),actions:[lt().Z]}),(0,be().gy)({key:"page style and layout",render:e=>(0,N.jsx)(f().A,{...e}),actions:[...l?(0,ee().oE)([bt().Xv,Vt({environment:t,intl:n,blockStore:o}),Kt({blockStore:o,environment:t}),(0,be().Ls)({key:"view comments",displayName:zt.viewComments,svg:jt().L,analyticsName:zt.viewComments.defaultMessage,validators:[tt().p,(0,je().A)(Ve),re().tm,re().XX],closeParentMenu:!0,action:()=>{Ft().A.setState({open:!0})}}),qt({environment:t,blockStore:o}),Wt({blockStore:o}),Ht({blockStore:o})]):[],Sn({environment:t,intl:n,blockStore:o}),...(0,ee().oE)([dn,cn,gn,Tn,hn])]}),Yt().LQ,(0,be().gy)({key:"viewing of page content",render:e=>(0,N.jsx)(f().A,{...e}),actions:[un,vt,bt().fg,bt().Fh,bt().cy]}),(0,be().gy)({key:"editing of page content",render:e=>(0,N.jsx)(f().A,{...e}),actions:[mn,fn]}),(0,be().gy)({key:"undo",render:e=>(0,N.jsx)(f().A,{...e}),actions:[en().tN]}),(0,be().gy)({key:"topbar import actions",render:e=>(0,N.jsx)(f().A,{...e}),actions:[In,bt().TD,kn]}),(0,be().gy)({key:"topbar wiki actions",render:e=>(0,N.jsx)(f().A,{...e}),actions:(0,ee().oE)([Jt().H0,Jt().hk])}),(0,be().gy)({key:"editorActions",render:e=>(0,N.jsx)(f().A,{...e}),actions:(0,ee().oE)([xn,An,Mn])}),wn(t,r),(0,he().A)(i),(0,be().gy)({key:"report page actions",render:e=>(0,N.jsx)(f().A,{...e}),actions:[Xt().H,Zt().X,Zt().aj]}),(0,be().gy)({key:"topbar view options",render:e=>(0,N.jsx)(f().A,{...e}),actions:Re()})]}function sn(e){return(0,be().Ls)({key:`font ${e.font||"default"}`,displayName:e.displayName,analyticsName:e.displayName.defaultMessage,validators:[(0,st().or)([(0,je().A)(Ge().K),He().A]),Ue().p,(0,je().A)(Ye().o),...e.extraValidators],render:(t,n)=>{const i=n.blocks[0].getFormat().page_font,s=e.font===i||!e.font&&!i;return(0,N.jsx)(me,{...t,isActive:s,font:e.font,tooltip:e.tooltip,style:e.style,caption:e.caption,isFiltering:e.isFiltering,isChecked:e.checkStatus,svg:e.svg})},closeParentMenu:!!e.isFiltering,track:{actionName:"set_font"},action:(t,{blocks:n,environment:i},s)=>{const{serverCommitResult:o}=ut().createAndCommit({userAction:"actionRegistry.createFontAction",environment:i,canUndo:!0,perform:t=>{ie().zA({stores:n,update:{page_font:e.font},transaction:t}),function(e,t){(0,x().DO_NOT_USE_trackLegacy)(e,"change_font_type",t)}(i,{type:e.font||"default"})}});o.then(t)}})}const on=[{font:"default",action:function(e){const{isFiltering:t,pageFont:n}=e;return sn({displayName:tn.fontDefaultName,caption:(0,N.jsx)(y().sA,{...tn.fontDefaultCaption}),font:void 0,tooltip:(0,N.jsx)(y().sA,{...tn.fontDefaultTooltip}),style:t?{}:{fontSize:24,fontFamily:b().vc(T().locale).sans,position:"relative",top:-2},extraValidators:[],isFiltering:t,checkStatus:"default"===n,svg:W})}},{font:"serif",action:function(e){const{isFiltering:t,pageFont:n}=e;return sn({displayName:tn.fontSerifName,caption:(0,N.jsx)(y().sA,{...tn.fontSerifCaption}),font:"serif",tooltip:(0,N.jsx)(y().sA,{...tn.fontSerifTooltip}),style:t?{}:{fontSize:25,fontFamily:b().vc(T().locale).serif,lineHeight:"21px"},extraValidators:[],isFiltering:t,checkStatus:"serif"===n,svg:H})}},{font:"mono",action:function(e){const{isFiltering:t,pageFont:n}=e;return sn({displayName:tn.fontMonoName,caption:(0,N.jsx)(y().sA,{...tn.fontMonoCaption}),font:"mono",tooltip:(0,N.jsx)(y().sA,{...tn.fontMonoTooltip}),style:t?{}:{fontSize:26,fontFamily:b().vc(T().locale).mono,position:"relative",top:-3,letterSpacing:-1},extraValidators:[],isFiltering:t,checkStatus:"mono"===n,svg:V})}},{font:"comic",action:function(e){const{isFiltering:t,pageFont:n}=e;return sn({displayName:tn.fontComicName,caption:(0,N.jsx)(y().sA,{...tn.fontComicCaption}),font:"comic",tooltip:(0,N.jsx)(y().sA,{...tn.fontComicTooltip}),style:{fontSize:t?14:26,fontFamily:b().vc(T().locale).comic,position:"relative",top:-3,letterSpacing:-1},extraValidators:[(0,st().or)([(0,$e().S)("comic_sans"),e=>e.blocks.some((e=>"comic"===e.getFormatStore().getKeyStore("page_font").getValue()))])],isFiltering:t,checkStatus:"comic"===n})}}],an=(0,be().gy)({key:"font section",title:void 0,render:e=>(0,N.jsx)(fe,{...e}),actions:on.map((e=>e.action({isFiltering:!1})))});function rn(e){return(0,be().gy)({key:"font extension menu",render:e=>(0,N.jsx)(f().A,{...e}),actions:on.map((t=>t.action({isFiltering:!0,pageFont:e})))})}function ln(e,t){const n=(0,v().O4)({theme:e.ThemeModeStore.state}),i=on.map((e=>e.font)).findIndex((e=>e===t))??0;return(0,be().gy)({key:"textStyleAction",render:e=>(0,N.jsx)(f().A,{...e}),actions:[(0,St().u)({key:"font style section",displayName:tn.textFontStyle,analyticsName:tn.textFontStyle.defaultMessage,svg:Q().a,right:(0,N.jsx)(N.Fragment,{children:t.charAt(0).toUpperCase()+t.slice(1)}),rightStyle:{color:n.text.tertiary,marginInlineEnd:5},width:300,validators:[(0,st().or)([(0,je().A)(Ge().K),He().A]),Ue().p,(0,je().A)(Ye().o)],subActions:()=>[rn(t)],initialFocus:i,hideSubActions:!0,fuzzySearchKeywordsArray:[tn.fontDefaultName,tn.fontSerifName,tn.fontMonoName]})]})}const dn=(0,be().fi)({key:"small text",displayName:tn.fontSmallTextKeywords,label:k().A.formatMessage(tn.fontSmallTextLabel),getSvgIcon:()=>X,isChecked:e=>Boolean(e.getFormat().page_small_text),validators:[(0,je().A)(Se().F),(0,st().or)([(0,je().A)(Ge().K),He().A]),Ue().p,(0,je().A)(Ye().o)],track:{actionName:"set_text_size"},action:(e,t,n)=>ie().zA({stores:[t],update:{page_small_text:!t.getFormat().page_small_text},transaction:n}),afterAction:(e,t)=>{(0,x().DO_NOT_USE_trackLegacy)(t,"change_font_size",{type:e?"small":"large"})}}),cn=(0,be().fi)({key:"full width",displayName:tn.fullWidthLabel,getSvgIcon:()=>n(665589).l,label:k().A.formatMessage(tn.fullWidthLabel),isChecked:e=>e.isFullWidth(),validators:[(0,je().A)(n(876396).t),(0,je().A)(Ge().K),Ue().p,(0,je().A)(Ye().o)],track:{actionName:"set_width"},action:(e,t,n)=>{ie().zA({stores:[t],update:{page_full_width:!t.isFullWidth()},transaction:n})},afterAction:(e,t)=>{(0,x().DO_NOT_USE_trackLegacy)(t,"change_page_width",{type:e?"full_width":"default_width"})}}),un=(0,be().fi)({key:"page lock",displayName:tn.lockPageName,label:k().A.formatMessage(tn.lockPageName),getSvgIcon:({isChecked:e})=>t=>(0,N.jsx)(n(124524).I,{isLocked:e,style:t}),isChecked:e=>e.isLockedForAllUsers(),validators:[(0,je().A)(Ge().K),Ue().p,(0,je().A)(Ye().o)],action:(e,t,n)=>se().zv({store:t.getFormatStore(),data:{block_locked:!t.isLockedForAllUsers(),block_locked_by:e.currentUser.id},transaction:n}),afterAction:()=>null}),pn=[(0,je().A)(Ge().K),Ue().p,(0,je().A)(Ye().o),(0,je().A)(Se().F),(0,st().or)([ze])],gn=(0,be().fi)({key:"floating table of contents",displayName:tn.floatingTableOfContents,getSvgIcon:()=>n(358359).L,label:k().A.formatMessage(tn.floatingTableOfContents),isChecked:e=>{var t;return"off"!==(null===(t=e.getModel())||void 0===t?void 0:t.getFloatingTableOfContentsState())},validators:pn,action:(e,t,n)=>{var i;const s="off"!==(null===(i=t.getModel())||void 0===i?void 0:i.getFloatingTableOfContentsState());se().zv({store:t.getFormatStore(),data:{page_floating_table_of_contents:{state:s?"off":"minimal"}},transaction:n})},afterAction:(e,t)=>{(0,n(564884).u)({environment:t,event:{eventName:"edit_page_table_of_contents_toggle",eventProperties:{is_table_of_contents_on:e}}})}}),mn=(0,be().Ls)({key:"suggest edits",displayName:tn.suggestEditsName,analyticsName:tn.suggestEditsName.defaultMessage,validators:[(0,je().A)(Xe().l),(0,je().A)(Se().F),(0,st().or)([(0,je().A)(Ge().K),He().A]),n(859398).$,(0,je().A)(Ye().o)],render:(e,t)=>{const i="suggest"===Oe().Uv.getMode(t.blocks[0]);return(0,N.jsx)(le().A,{...e,title:(0,N.jsx)(y().sA,{...tn.suggestEditsName}),svg:n(209416).a,right:i?(0,N.jsx)(P().D,{colorPalette:"red",colorVariant:"accentPrimary",children:(0,N.jsx)(y().sA,{id:"suggestEdits.stop",defaultMessage:"Stop"})}):void 0})},action:e=>{const t="suggest"===Oe().Uv.getMode(e.blocks[0])?"default":"suggest";"suggest"===t&&ct().A.reset(),n(473227).PD({environment:e.environment,navigableBlockStore:e.blocks[0],mode:t,location:"page_more_actions"})},closeParentMenu:!0}),fn=(0,be().Ls)({key:"translate",displayName:tn.translate,analyticsName:"open_translate_bar_from_topbar",validators:[function(){return Boolean(Ee().zD.isFullPageTranslateEnabled())},tt().p],closeParentMenu:!0,render:(e,t,{onFocus:n})=>{const i=t.blocks.at(0);if(i)return(0,N.jsx)(Fe,{onFocus:n,closeParentMenu:()=>{ct().A.reset()},blockStore:i,menuListItemProps:e,title:(0,N.jsx)(y().sA,{...tn.translate})})},action:()=>{}}),hn=(0,be().Ls)({key:"customize page",displayName:tn.customizePageLabel,analyticsName:tn.customizePageLabel.defaultMessage,svg:Y().M,validators:[(0,je().A)(ze),n(730580).V,(0,je().A)(Ye().o),(0,st().or)([(0,je().A)(Ge().K),He().A]),(0,st().or)([Se().F,(0,je().A)(Ve),Ze().U]),(0,je().A)(Ae().P)],closeParentMenu:!0,render:e=>(0,N.jsx)(le().A,{...e,title:(0,N.jsx)(y().sA,{...tn.customizePageLabel}),svg:Y().M}),action:e=>{n(334261).ho({originRect:e.originRect})}}),yn=(0,be().Fw)({key:"copy link to block non-desktop",displayName:be().AY.copyLinkNavigableTypeName,analyticsName:be().AY.copyLinkNavigableTypeName.defaultMessage,svg:n(742852).linkIcon,shortcuts:["copyCurrentPageLinkifiedBlockTitle"],validators:[Je().M,Me().v,(0,je().A)(n(929084).b),(0,je().A)(Ye().o),(0,je().A)(Ae().P)],closeParentMenu:!0,track:{actionName:"copy_block_link"},lazyDependencyKeys:["clipboardActions"],action:(e,{environment:t,blocks:n},i)=>{const s=(0,ne().Y)("clipboardActions");s?s.copyLinkToBlock({environment:t,blockStore:n[0],callback:e}):R().log({data:{miscDataToConvertToString:{actionKey:"copy link to block non-desktop"}},from:"topbarMoreActionRegistry",level:"info",type:"lazyDependencies:missingClipboardActions"})}}),vn=(0,be().Ls)({key:"copy page contents",displayName:tn.copyPageContents,analyticsName:tn.copyPageContents.defaultMessage,svg:U,validators:[(0,$e().S)("editor_enable_copy_page"),Me().v,tt().p,(0,je().A)(Ye().o),(0,je().A)(Ae().P)],closeParentMenu:!0,track:{actionName:"copy_page_contents"},lazyDependencyKeys:["clipboardActions","markdownLinkifyIt"],action:(e,{environment:t})=>{const n=(0,ne().Y)("clipboardActions");if(!n)return void R().log({data:{miscDataToConvertToString:{actionKey:"copy page contents"}},from:"topbarMoreActionRegistry",level:"info",type:"lazyDependencies:missingClipboardActions"});const i=(0,ne().Y)("markdownLinkifyIt");if(i)try{n.copyPageContents({environment:t,markdownLinkifyIt:i}),_().D6({label:k().A.formatMessage(j().clipboardMessages.copiedPageContentsToClipboard)}),e()}catch(s){_().D6({label:k().A.formatMessage(j().clipboardMessages.copyPageContentsError)}),R().log({data:{miscDataToConvertToString:{actionKey:"copy page contents",error:s}},from:"topbarMoreActionRegistry",level:"error",type:"copyPageContents.error"})}else R().log({data:{miscDataToConvertToString:{actionKey:"copy page contents"}},from:"topbarMoreActionRegistry",level:"info",type:"lazyDependencies:missingMarkdownLinkifyIt"})}}),bn=(0,be().Fw)({key:"duplicate",displayName:be().AY.duplicateName,analyticsName:be().AY.duplicateName.defaultMessage,svg:n(764781).V,validators:[et()._,Ue().p,be().fp,n(30549).G,(0,je().A)((0,it().X)(B().xd.externalObjectInstancePage)),(0,je().A)(Ze().U),(0,je().A)(nt().P),(0,je().A)(Ye().o)],shortcuts:["duplicate"],closeParentMenu:!0,track:{actionName:"duplicate"},action:async(e,{environment:t,pageContext:i},s)=>{const o=(0,n(747135).F)();if(!o)return;const a=o.getAssociatedCollectionStore();if(!a)return;if(!(0,n(957763).E)(t,(0,C().$)(i)))return;const r=new(n(512039).B)(t);if(r.setContext({type:"collectionPage",collectionViewBlockStore:void 0,collectionStore:a}),(0,n(3700).ls)(o,r))return void(await n(920836).HF({environment:t,blocks:[o],collectionContextStore:r,callback:e}));const l={type:"collection",parent:a.getSpaceShardedPointer(),addToTemplates:o.isTemplate()},d=await(0,n(213477).hh)({environment:t,sourceBlocks:[o],destination:l,from:"fork_page.to_collection",options:{addCopyName:!0,allowRedundancy:!1,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!o.isInsideTemplate()},navigateToTarget:!0,skipUserFacingMessages:!1,duplicateSubtreeGateName:"duplicate_subtree_collection_flows"});if(!n(973647).Q.isSuccess(d))throw d.error;e()},disabled:()=>!I().A.state.online,renderTooltip:()=>k().A.formatMessage(be().AY.unavailableOfflineTooltip),disableTooltip:()=>I().A.state.online});function Sn(e){const{environment:t,intl:n,blockStore:i}=e,o=(0,v().O4)({theme:t.ThemeModeStore.state}),a=s().default.checkGate({gateName:"archive_content"}),r=(0,ot().i1)(i).type;let l,d,c;switch(r){case"verified":case"expired":a?(l=tn.contentStatus,c=n.formatMessage(tn.verifiedStatus)):(l=tn.pageVerification,c=function(e){const{intl:t,blockStore:n}=e,i=(0,ot().i1)(n);switch(i.type){case"none":return;case"expired":return t.formatMessage(mt.expiredVerification);case"verified":if(i.isIndefinite)return t.formatMessage(mt.indefiniteVerification);{const e=i.dateTimeRange.end,n=(0,gt().OH)({dateTime:e,intl:t,shortenDateAndRange:!0});return t.formatMessage(mt.verificationWithEndDate,{date:n})}case"archived":return t.formatMessage(mt.archived);default:(0,te().HB)(i)}}({intl:n,blockStore:i})),d=L().badgeCheckIcon;break;case"archived":l=tn.contentStatus,c=n.formatMessage(tn.archivedStatus),d=D().archiveBoxIcon;break;case"none":l=a?tn.addContentStatus:tn.pageVerification,c=void 0,d=L().badgeCheckIcon;break;default:(0,te().HB)(r)}return(0,be().Ls)({key:"open page verification menu",analyticsName:"Open page verification",displayName:l,render:e=>(0,N.jsx)(le().A,{...e,svg:d,title:(0,N.jsx)(y().sA,{...l}),right:(0,N.jsx)("div",{style:{color:o.text.tertiary,marginInlineEnd:0},children:c}),rightStyle:{marginInlineEnd:5},showExtensionArrow:!0}),validators:[Se().F,e=>(0,Ue().p)(e),()=>{var e;const t=null===(e=(0,A().S)())||void 0===e?void 0:e.getModel();return Boolean(t&&(0,J().X)(t))}],closeParentMenu:!1,action:()=>{pt().h()}})}const xn=(0,be().Ls)({key:"open page updates",analyticsName:"Open page updates",displayName:tn.pageUpdates,svg:z().clockIcon,validators:[re().tm,Se().F],closeParentMenu:!0,action:()=>{n(102727).A.setState({open:!0})},disabled:()=>!I().A.state.online}),Mn=(0,be().Ls)({key:"action page history",displayName:tn.pageHistoryNewName,analyticsName:tn.pageHistoryName.defaultMessage,fuzzySearchKeywords:tn.pageHistoryFuzzySearchKeywords,svg:$().G,validators:[(0,st().or)([oe().h,n(788436).X]),et()._,Je().M,(0,je().A)(nt().P),(0,je().A)(Qe().Q),(0,je().A)(Ae().P)],closeParentMenu:!0,action:({environment:e,blocks:t})=>n(82926).WE({environment:e,blockStore:t[0],from:"topbar"}),render:({onClick:e,key:t,...i},{environment:s,pageContext:o})=>{const a=(0,C().$)(o);return(0,N.jsx)(n(643908).F,{spaceStore:a,requireUpgradeToTier:!1,analyticsName:"history_modal",onClick:e,alwaysAllowClick:!0,render:(e,t)=>{const n=!I().A.state.online;return(0,N.jsx)(le().A,{...(0,w().A)(i,e),title:k().A.formatMessage(tn.pageHistoryNewName),svg:$().G,dontShrinkRight:!0,right:t,tooltipText:n?k().A.formatMessage(be().AY.unavailableOfflineTooltip):void 0,disabled:n,disabledFeedback:n})},renderUpgradeTooltip:()=>{}},t)}}),An=(0,be().Ls)({key:"view updates and analytics",displayName:tn.viewUpdatesAndAnalyticsName,analyticsName:tn.viewUpdatesAndAnalyticsName.defaultMessage,fuzzySearchKeywords:tn.viewUpdatesAndAnalyticsFuzzySearchKeywords,validators:[function(e){if(o().A.isMobile)return!1;const t=e.blocks.at(0);return!!t&&(!!o().A.isAdminMode||!!t.canEdit())},(0,je().A)(Ae().P)],svg:z().clockIcon,closeParentMenu:!0,action:e=>{const{currentUserSettingsStore:t}=M().default.state;t&&ut().createAndCommit({environment:e.environment,userAction:"topbarMoreActonRegistry.openUpdatesAndAnalytics",canUndo:!0,perform:e=>{(0,n(680977).m)({userSettingsStore:t,transaction:e,data:{opened_new_top_bar_updates_entrypoint:!0}})}}),n(869562).handleSidebarButtonClick(e.environment,e.blocks[0],n(737230).tF.Updates,"more_menu")},disabled:()=>!I().A.state.online,renderTooltip:()=>k().A.formatMessage(be().AY.unavailableOfflineTooltip),disableTooltip:()=>I().A.state.online});function jn(e,t){var n;const i=(0,v().O4)({theme:e.ThemeModeStore.state});return(0,St().u)({key:"notifications",displayName:tn.notifyMe,analyticsName:tn.notifyMe.defaultMessage,svg:E().r,right:null===(n=t.find((e=>e.isSelectedOption)))||void 0===n?void 0:n.action.displayName,rightStyle:{color:i.text.tertiary,marginInlineEnd:5},width:300,initialFocus:t.findIndex((e=>e.isSelectedOption))??0,validators:[(0,je().A)(Ye().o),(0,je().A)(Ae().P)],subActions:()=>[(0,be().gy)({key:"notifications",render:e=>(0,N.jsx)(f().A,{...e}),actions:t.map((({action:e})=>e))})],hideSubActions:!0,fuzzySearchKeywordsArray:(0,ee().oE)(t.map((({action:e})=>e.displayName?rt().aE(e.displayName):void 0)))})}function wn(e,t){return(0,be().gy)({key:"notifyMe",render:e=>(0,N.jsx)(f().A,{...e}),actions:[jn(e,t)]})}const In=(0,be().Ls)({key:"open import modal",displayName:tn.importName,analyticsName:tn.importName.defaultMessage,svg:n(820579).arrowLineDownIcon,validators:[n(730107).I,Ue().p,(0,je().A)((0,it().X)(B().xd.externalObjectInstancePage)),(0,je().A)(nt().P),(0,je().A)(Ye().o)],closeParentMenu:!0,action:({blocks:e,environment:t})=>{let i=!1;if(1===e.length){const[t]=e;i=t.isCollectionView()}i?n(141945).A.setState({open:!0}):(n(559926).kY(t,{from:"topbar",flowId:n(191227).A.createFlowId()}),dt().Ay.setState({...dt().Ay.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0,openedFrom:"topbar"}))},disabled:()=>!I().A.state.online,renderTooltip:()=>k().A.formatMessage(be().AY.unavailableOfflineTooltip),disableTooltip:()=>I().A.state.online}),kn=(0,be().Ls)({key:"export block",displayName:tn.exportName,analyticsName:tn.exportName.defaultMessage,validators:[],closeParentMenu:!0,render:(e,t)=>{const{environment:i,blocks:s}=t,o=!I().A.state.online,a=i.currentUser.isLoggedIn(),r=s.length>0&&We(t),l=(0,Qe().Q)(t),d=(0,Ae().P)(t),c=o||!a||!r||d||l;return(0,N.jsx)(le().A,{...e,svg:n(419178).Q,title:(0,N.jsx)(y().sA,{...tn.exportName}),tooltipText:o?(0,N.jsx)(y().sA,{...be().AY.unavailableOfflineTooltip}):c?(0,N.jsx)(y().sA,{...tn.exportDisabledTooltip}):(0,N.jsx)(y().sA,{...tn.exportCaption}),disabled:c,disabledFeedback:c})},action:({blocks:e,environment:t})=>{const i=e[0];if(!i.isDefined())return;let s=!0;const o=(0,ae().U)(e[0]);if(o){const e=null==o?void 0:o.collectionStore();null!=e&&e.isPageTreeCollection()&&(s=!1)}n(656144).Ss({environment:t,root:{id:i.id,table:"block",spaceId:i.getSpaceId()},isCollectionViewExportTypeSupported:s})}}),Tn=(0,be().Ls)({key:"open page layout editor",displayName:tn.openPageLayoutEditor,analyticsName:tn.openPageLayoutEditor.defaultMessage,validators:[ze],closeParentMenu:!0,render:function(e){const t=!I().A.state.online;return(0,N.jsx)(le().A,{...e,disabled:t,disabledFeedback:t,svg:n(167170)._,title:(0,N.jsx)(n(249046).Ye,{children:(0,N.jsx)(y().sA,{...tn.openPageLayoutEditor})}),tooltipText:t?(0,N.jsx)(y().sA,{...be().AY.unavailableOfflineTooltip}):void 0})},action:function({environment:e,blocks:t}){let i,s,o,a;for(const n of t)if(n.isCollectionView()){const e=n.getCollectionStoreIfSingleSource();if(e){i=n,s=e;const t=(0,ae().U)(n);o=null==t?void 0:t.collectionViewStore(),a="customize_database_button_in_three_dot_menu";break}}else{const e=n.getAssociatedCollectionStore();if(e&&!e.isPageTreeCollection()){i=n,s=e,a="customize_page_button_in_three_dot_menu";break}}if(!s||!i||!a)throw new Error("Could not edit page layout: Could not find collection");n(447934).nh({environment:e,blockStore:i,collectionStore:s,collectionViewStore:o,from:a})},disabled:()=>!I().A.state.online,renderTooltip:()=>k().A.formatMessage(be().AY.unavailableOfflineTooltip),disableTooltip:()=>I().A.state.online});var Cn=()=>n(232930),_n=()=>n(381684),Pn=()=>n(419357),Bn=()=>n(962036),Rn=()=>n(715011);function Dn(e){const{blockStore:t,onClickOriginRect:n,handleAccept:g,handleDismiss:x}=e,M=(0,a().v3)(),A=(0,y().tz)(),[j,w]=(0,i.useState)(""),I=(0,r().S)(),[k,T]=(0,m().$)(),C=(0,l().K8)((()=>({environment:M,blocks:[t],originRect:n,publicEditMode:void 0,analyticsFrom:"topbar_more_menu",pageContext:I})),[M,t,n,I]),{initialSections:_,filterSections:P}=(0,l().K8)((()=>({initialSections:nn({environment:M,intl:A,context:C,isFiltering:!1}),filterSections:nn({environment:M,intl:A,context:C,isFiltering:!0})})),[M,A,C]),B=(0,l().K8)((()=>0===j.length&&!t.isCollectionView()&&t.canEdit()&&t.hasContent()&&!t.isPersonProfile()),[t,j]),R=(0,l().K8)((()=>0===j.length&&t.canEdit()&&!t.isPersonProfile()),[t,j.length]),D=(0,l().K8)((()=>t.canEdit()&&t.isCollectionView()),[t]),L=(0,d().IS)((()=>({menuPropIcon:{color:v().Tj.palette.gray[500]}})),[]),E=(0,l().K8)((()=>o().A.isMobile&&!s().default.checkGate({gateName:"mobile_topbar_more_menu_search"})||t.isPersonProfile()),[t]),O=o().A.isMobile?{menuType:u().gu.Modal,title:(0,N.jsx)(y().sA,{defaultMessage:"Actions",id:"topbarMoreButton.mobileActionsMenu.title"}),leftRightButtonStyle:L.menuPropIcon,onClickRight:x,titleOuterStyle:{fontSize:17,fontWeight:b().Wy.bold},paddingTop:10,enableMobileRefresh:!0}:{menuType:u().gu.Popup,maxHeight:"80vh"};return(0,N.jsxs)(p().A,{...O,children:[E?(0,N.jsx)(S().A,{sections:_,onAccept:g,context:C}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(f().A,{isInput:!0,children:(0,N.jsx)(Pn().Ay,{value:j,onChange:e=>w(e.target.value),focus:!0,focusAfterAnimation:!0,placeholder:A.formatMessage({defaultMessage:"Search actions…",id:"topbarMenu.filterForActions.placeholder"}),preventCaptureDeleteWhenEmpty:!0,preventCaptureSpacebarWhenEmpty:!0,inputLeft:(0,N.jsx)(c().I,{icon:h().magnifyingGlassSmallIcon,size:"sm",colorVariant:"secondary"}),showClearButton:!0,...k})}),(0,N.jsx)(S().A,{sections:_,filterSections:P,onAccept:g,context:C,filter:j,showNoResultsMessage:!0,initialFocus:j.length>0?0:void 0,comboboxProps:T})]}),B&&!R?(0,N.jsx)(Ln,{store:t}):void 0,R?(0,N.jsx)(_n().g,{store:t,showWordCount:B}):void 0,D?(0,N.jsx)(En,{}):void 0]})}function Ln({store:e}){const t=(0,d().IS)((()=>({caption:{color:v().Tj.text.tertiary}})),[]),n=(0,N.jsx)("span",{style:t.caption,children:(0,N.jsx)(y().sA,{id:"pageMoreButton.wordCount.caption",defaultMessage:"Word count: {count}",values:{count:(0,N.jsx)(Rn().A,{store:e})}})});return(0,N.jsx)(f().A,{topBorder:!0,children:(0,N.jsx)(g().Ay,{caption:n})})}function En(){return(0,N.jsx)(f().A,{topBorder:!0,children:(0,N.jsx)(Bn().g,{title:(0,N.jsx)(y().sA,{defaultMessage:"Learn about databases",id:"topbar.moreButton.collectionHelpButton"}),href:(0,Cn().x)("guides.database"),analyticsFrom:"topbar_more_button"})})}},379887:(e,t,n)=>{n.d(t,{g:()=>a,j:()=>o});var i=n(296540);const s={clearSelection:()=>{}},o=(0,i.createContext)(s);function a(){return(0,i.useContext)(o)}o.displayName="ClearSelectionContext"},387226:(e,t,n)=>{n.d(t,{F1:()=>h,KQ:()=>d,Wt:()=>p,dB:()=>f,vP:()=>u,wL:()=>c,zD:()=>g});n(944114),n(898992),n(581454),n(908872);var i=()=>n(675133),s=()=>n(69708),o=()=>n(806638),a=()=>n(404141),r=()=>n(547149),l=()=>n(716776);const d=(0,s().YK)({emptyWithIcon:{defaultMessage:"Empty page with icon",id:"templatePickerHelpers.basicTemplateItems.emptyWithIcon"},empty:{defaultMessage:"Empty page",id:"templatePickerHelpers.basicTemplateItems.empty"},templates:{defaultMessage:"Templates",id:"templatePickerHelpers.basicTemplateItems.templates"},import:{defaultMessage:"Import",id:"templatePickerHelpers.basicTemplateItems.import"}}),c={name:i().A.formatMessage(d.empty),iconFn:n(177148).Y,type:"empty_page",shouldShow:()=>!0,onClick:(e,t)=>{r().createAndCommit({userAction:"templatePickerHelpers.emptyTemplateItems",environment:e,canUndo:!0,perform:n=>{l().n({environment:e,store:t,transaction:n})}})}},u={name:i().A.formatMessage(d.templates),type:"templates",iconFn:e=>(0,n(826693).notionTemplateIcon)(e),shouldShow:()=>!0,onClick:e=>{(0,o().P)({environment:e})}},p={name:i().A.formatMessage(d.templates),type:"templates",iconFn:e=>(0,n(235773).notionTemplateTintableIcon)(e),shouldShow:()=>!0,onClick:e=>{(0,o().P)({environment:e})}},g={name:i().A.formatMessage(d.import),type:"import",iconFn:n(820579).arrowLineDownIcon,shouldShow:()=>!0,onClick:(e,t)=>{const i=n(206267).JW();n(191227).A.setState({flowId:i}),n(559926).kY(e,{from:"new_page",flowId:i}),a().Ay.setState({...a().Ay.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0})}},m=(0,s().YK)({pageWithIcon:{defaultMessage:"Page with icon",id:"templatePickerHelpers.mobileBasicTemplateItems.pageWithIcon"},emptyPage:{defaultMessage:"Empty page",id:"templatePickerHelpers.mobileBasicTemplateItems.emptyPage"}}),f=[{name:i().A.formatMessage(m.pageWithIcon),type:"page_with_icon",shouldShow:()=>!0,onClick:(e,t)=>{r().createAndCommit({userAction:"templatePickerHelpers.mobileBasicTemplateItems",environment:e,canUndo:!0,perform:n=>{l().T({environment:e,store:t,transaction:n})}})}},{name:i().A.formatMessage(m.emptyPage),type:"empty_page",shouldShow:()=>!0,onClick:(e,t)=>{r().createAndCommit({userAction:"templatePickerHelpers.mobileBasicTemplateItems",environment:e,canUndo:!0,perform:n=>{l().n({environment:e,store:t,transaction:n})}})}}];function h(e,t){const n=new Map(e.map((e=>[e.type,e])));return t.reduce(((e,t)=>(n.has(t)&&e.push(n.get(t)),e)),[])}},391435:(e,t,n)=>{n.d(t,{Z:()=>k});n(944114),n(898992),n(354520),n(581454);var i=n(296540),s=()=>n(564884),o=()=>n(59226),a=()=>n(726637),r=()=>n(484714),l=()=>n(401497),d=()=>n(265060),c=()=>n(546926),u=()=>n(890492),p=()=>n(81068),g=()=>n(449279),m=()=>n(663639),f=()=>n(736847),h=()=>n(293821),y=()=>n(644161),v=()=>n(185078),b=()=>n(69708),S=()=>n(100622),x=()=>n(778078),M=()=>n(419357),A=()=>n(662971),j=n(474848);const w=1,I=(0,b().YK)({sourceLanguage:{id:"translation.languageMenuList.sourceLanguage",defaultMessage:"From"},selectLanguage:{id:"translation.languageMenuList.selectLanguage",defaultMessage:"To"},detectedLanguage:{id:"translation.languageMenuList.detectedLanguage",defaultMessage:"Detected language"},preferredLanguage:{id:"translation.languageMenuList.preferredLanguage",defaultMessage:"Preferred language"},languageSearchPlaceholder:{id:"translation.languageMenuList.languageSearchPlaceholder",defaultMessage:"Search languages…"}});function k(e){const{onSelectTargetLanguage:t,onSelectSourceLanguage:n,editorModeConfigTranslateState:o,sourceLanguage:a,detectedPageLanguage:d,preferredLanguage:c,subMenuPlacement:u,subMenuAlignment:g,pageId:h}=e,v=(0,r().v3)(),x=(0,b().tz)(),M="loading"===o.status,k=T(M),P=(0,l().IS)((()=>({menuItemSectionBottomBorder:{boxShadow:`${S().Tj.border.secondaryTranslucent} 0px 1px 0px`},...k})),[k]);(0,i.useEffect)((()=>{if("pre_activation"===o.status){const e=setTimeout((()=>{(0,s().u)({environment:v,event:{eventName:"translate_page_interaction",eventProperties:{type:"action_menu_rendered",page_id:h}}})}),750);return()=>clearTimeout(e)}}),[o.status,h,v]);const B=o.targetLanguage,R=_({disabled:M,filter:e=>a!==e,currentSelectedLanguage:o.targetLanguage,onSelectLanguage:e=>{t({targetLanguage:e})}});return(0,j.jsx)(m().A,{initialFocus:w,type:m().O.Vertical,disableInitialScroll:!0,sections:[{key:"sourceLanguage",render:e=>(0,j.jsx)(f().A,{...e,title:x.formatMessage(I.sourceLanguage),desktopTitleStyle:{marginInlineStart:2,marginInlineEnd:2},style:P.menuItemSectionBottomBorder}),items:[{key:a,render:(e,{onFocus:t})=>(0,j.jsx)(A().A,{...e,onFocus:t,disableDefaultClick:!0,placementToOrigin:u,alignmentToOrigin:g,renderOrigin:(e,t)=>(0,j.jsx)(p().A,{...e,disabled:M,buttonStyle:P.button,ref:t,title:x.formatMessage((0,y().Bj)(a)),caption:a===d?x.formatMessage(I.detectedLanguage):a===c?x.formatMessage(I.preferredLanguage):void 0}),renderExtension:e=>(0,j.jsx)(C,{disabled:M,extensionPopupButtonEvents:e,currentTargetLanguage:B,sourceLanguage:a,onSelectSourceLanguage:n})}),action:()=>{}}]},{key:"selectLanguage",render:e=>(0,j.jsx)(f().A,{...e,title:x.formatMessage(I.selectLanguage),desktopTitleStyle:{marginInlineStart:2,marginInlineEnd:2}}),items:R}]})}function T(e){return(0,l().IS)((()=>({button:{color:e?S().Tj.text.tertiary:S().Tj.text.primary}})),[e])}function C(e){const{extensionPopupButtonEvents:t,currentTargetLanguage:n,disabled:i,sourceLanguage:s,onSelectSourceLanguage:o}=e,r=_({disabled:i,filter:e=>e!==n,currentSelectedLanguage:s,onSelectLanguage:e=>{o({sourceLanguage:e})}}),l=a().A.isMobile?{menuType:c().gu.ActionSheet,...t}:{menuType:c().gu.Popup,width:200,height:380,...t};return(0,j.jsx)(u().A,{...l,onClick:e=>{e.preventDefault()},children:(0,j.jsx)(m().A,{initialFocus:void 0,type:m().O.Vertical,sections:[{key:"originalLanguage",render:e=>(0,j.jsx)(f().A,{...e}),items:r}]})})}function _(e){const{disabled:t,filter:n,currentSelectedLanguage:s,onSelectLanguage:a}=e,r=(0,b().tz)(),[l,c]=(0,i.useState)(""),u=T(t),m=(0,i.useMemo)((()=>({key:"language-search-input",render:e=>(0,j.jsx)(M().Ay,{...e,disabled:t,placeholder:r.formatMessage(I.languageSearchPlaceholder),value:l,onChange:e=>c(e.target.value),focus:!0,inputLeft:(0,j.jsx)(d().Q,{iconGroup:h().C,colorPalette:"gray",colorVariant:"accentPrimary",variantName:"default"})}),action:()=>{}})),[l,t,r]),f=(0,i.useMemo)((()=>({key:"no-results",render:()=>(0,j.jsx)(g().u,{title:(0,j.jsx)(b().sA,{defaultMessage:"No results found",id:"TranslationLanguageMenuList.noResults"})}),action:()=>{}})),[]),S=(0,o().X)("editor_basic_rtl"),A=(0,i.useMemo)((()=>(0,v().J6)({includeRtlLanguages:S})),[S]),w=(0,i.useMemo)((()=>{const e=[];for(const t of A)if(n(t)){const n=r.formatMessage((0,y().Bj)(t));e.push({languageCode:t,languageName:n})}return e.sort(((e,t)=>e.languageName.localeCompare(t.languageName)))}),[n,r,A]),k=(0,i.useMemo)((()=>(0,x().Ay)(l,w,(({languageName:e})=>e.toLowerCase()))),[l,w]),C=(0,i.useMemo)((()=>k.map((({languageCode:e,languageName:n})=>({key:e,render:i=>(0,j.jsx)(p().A,{...i,buttonStyle:u.button,disabled:t,title:n,isChecked:s===e}),action:()=>{t||a(e)}})))),[k,t,s,a,u.button]);return 0===C.length?[m,f]:[m,...C]}},392331:(e,t,n)=>{n.r(t),n.d(t,{NotionCalendarLaunchModal:()=>O});var i=n(296540),s=()=>n(907258),o=()=>n(726637),a=()=>n(484714),r=()=>n(590526),l=()=>n(401497),d=()=>n(755222),c=()=>n(609679),u=()=>n(577914),p=()=>n(388926),g=()=>n(807449),m=()=>n(631524),f=()=>n(160432),h=()=>n(302501),y=()=>n(218275),v=()=>n(671089),b=()=>n(16789),S=()=>n(69708),x=()=>n(100622),M=()=>n(284371),A=()=>n(40970),j=()=>n(687039),w=()=>n(232930),I=()=>n(300789),k=()=>n(51367),T=()=>n(218429),C=()=>n(752860),_=()=>n(964556),P=()=>n(645200),B=()=>n(694498),R=()=>n(20022),D=n(474848);const L=(0,S().YK)({getNotionCalendar:{id:"notionCalendarLaunchButton.getNotionCalendar",defaultMessage:"Get Notion Calendar"},downloadApp:{id:"notionCalendarLaunchButton.downloadApp",defaultMessage:"Download app"},openCalendar:{id:"notionCalendarLaunchButton.openCalendar",defaultMessage:"Open Calendar"}});const E=function({style:e,openCalendarFrom:t,getNotionCalendarFrom:d,onOpenCalendarClick:c,onGetNotionCalendarClick:u,onDownloadClick:p}){const g=(0,a().v3)(),m=(0,l().IS)((()=>({button:{marginInlineStart:8,whiteSpace:"nowrap",...e}})),[e]),h=(0,r().O$)(n(365917).X),y=(0,r().K8)((()=>{const e=(0,n(755531).S)();return e&&(0,n(686070).d)({spaceStore:e})}),[]),[{value:v}]=(0,n(187174).Yb)((async()=>!(null===R().Ht||void 0===R().Ht||!R().Ht.isProtocolRegistered)&&R().Ht.isProtocolRegistered(o().A.calendar.desktopProtocol)),[]),b=(0,i.useCallback)((()=>{P().Op({environment:g,spaceStore:void 0,collectionViewStore:void 0,from:t}),null==c||c()}),[g,t,c]),x=(0,i.useCallback)((()=>{const{currentUserSettingsStore:e,sidebarSpaceStore:t}=s().default.state;e&&t&&(P().Op({environment:g,spaceStore:t,collectionViewStore:void 0,from:d}),null==u||u())}),[g,d,u]),M=(0,i.useCallback)((()=>{(0,C().L)({environment:g,url:o().A.calendar.downloadUrl}),null==p||p()}),[g,p]);return g.device.isElectron?v?(0,D.jsx)(f().A,{colorPalette:"blue",style:m.button,size:"lg",onClick:b,children:(0,D.jsx)(S().sA,{...L.openCalendar})}):(0,D.jsx)(f().A,{colorPalette:"blue",style:m.button,size:"lg",onClick:M,children:(0,D.jsx)(S().sA,{...L.downloadApp})}):h||y?(0,D.jsx)(f().A,{colorPalette:"blue",style:m.button,size:"lg",onClick:b,children:(0,D.jsx)(S().sA,{...L.openCalendar})}):(0,D.jsx)(f().A,{style:m.button,size:"lg",onClick:x,children:(0,D.jsx)(S().sA,{...L.getNotionCalendar})})};function O(){const e=(0,a().v3)(),t=(0,l().IS)((()=>({container:{maxWidth:442},closeButton:{position:"absolute",top:12,insetInlineEnd:12,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:x().Tj.outlineButtonPressedBackground,width:18,height:18},closeButtonHovered:{background:x().Tj.outlineButtonPressedBackground},content:{padding:24,display:"flex",flexDirection:"column"},title:{fontWeight:M().Wy.bold,fontSize:25,display:"flex",marginBottom:6},divider:{backgroundColor:x().Tj.border.secondary,opacity:.5},footer:{padding:"20px 24px",display:"flex",alignItems:"center",justifyContent:"space-between"},successTitle:{fontSize:25,fontWeight:M().Wy.bold,margin:"8px 0"},downloadContainer:{display:"flex",padding:"16px 20px",marginTop:28,borderRadius:12,background:x().Tj.background.secondaryTranslucent},downloadContent:{display:"flex",flexDirection:"column",paddingInlineEnd:8},downloadTitle:{fontSize:16,fontWeight:M().Wy.semibold,marginBottom:4},downloadButtonContainer:{display:"flex"},downloadButton:{height:32,marginTop:12},notionCalendarLogo:{display:"flex",alignSelf:"end"}})),[]);(0,i.useEffect)((()=>{const t=()=>{d().A.state.isVisible&&B().A.state.isConnectingCalendar&&(B().A.setState({isConnectingCalendar:!1}),_().refreshExternalIntegrationStore({environment:e}))};return d().A.addListener(t),()=>{d().A.removeListener(t)}}),[e]);const n=(0,r().K8)((()=>B().A.state.signupCtaAttribution||"onboardingModalSignIn"),[]),R=(0,i.useCallback)((()=>{const{currentUserSettingsStore:t}=s().default.state;t&&(k().Sq(e,{callout_key:"notion_calendar_launch_promo",dismiss_type:"modal_dismiss_clicked",placement_key:"Modal"}),I().a(e,"notion_calendar_launch_promo"),P().MR({environment:e,userSettingsStore:t}),B().A.setState({signupCtaAttribution:void 0}))}),[e]),O=(0,i.useCallback)((()=>{const{currentUserSettingsStore:t,sidebarSpaceStore:n}=s().default.state;t&&n&&(k().Y5(e,{callout_key:"notion_calendar_launch_promo",click_type:"primary_cta",placement_key:"Modal"}),I().a(e,"notion_calendar_launch_promo"),P().rI(e,{phase:"dismissed_completely",transactionUserAction:"NotionCalendarLaunchModal.openCalendar",userSettingsStore:t}))}),[e]),F=(0,i.useCallback)((()=>{const{currentUserSettingsStore:t,sidebarSpaceStore:n}=s().default.state;t&&n&&(k().Y5(e,{callout_key:"notion_calendar_launch_promo",click_type:"primary_cta",placement_key:"Modal"}),e.device.isElectron&&I().a(e,"notion_calendar_launch_promo"),P().rI(e,{phase:"connected_notion_calendar",transactionUserAction:"NotionCalendarLaunchModal.getNotionCalendar",userSettingsStore:t}))}),[e]),U=(0,i.useCallback)((()=>{const{currentUserSettingsStore:t}=s().default.state;t&&(k().Y5(e,{callout_key:"notion_calendar_launch_promo",click_type:"primary_cta",placement_key:"Modal"}),I().a(e,"notion_calendar_launch_promo"),P().rI(e,{phase:"dismissed_completely",transactionUserAction:"NotionCalendarLaunchModal.clickDownload",userSettingsStore:t}))}),[e]),z=(0,r().K8)((()=>{var e;const t=null===(e=s().default.state.currentUserSettingsStore)||void 0===e?void 0:e.getSettings();return null==t?void 0:t.notion_calendar_launch_modal_phase}),[]),K=()=>(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(u().R,{onClick:R}),(0,D.jsxs)("div",{style:t.content,children:[(0,D.jsx)(g().I,{icon:v().checkmarkCircleIcon,size:"xl",colorVariant:"secondary"}),(0,D.jsx)("div",{style:t.successTitle,children:(0,D.jsx)(S().sA,{defaultMessage:"Success!",id:"notionCalendarLaunchModal.successTitle"})}),(0,D.jsx)(h().A,{isSecondaryColor:!0,isMultiline:!0,children:(0,D.jsx)(S().sA,{defaultMessage:"You can now view Notion docs, projects, tasks, and timelines alongside calendar events on Notion Calendar",id:"notionCalendarLaunchModal.successCaption"})}),(0,D.jsxs)("div",{style:t.downloadContainer,children:[(0,D.jsxs)("div",{style:t.downloadContent,children:[(0,D.jsx)("div",{style:t.downloadTitle,children:(0,D.jsx)(S().sA,{defaultMessage:"Get the desktop app",id:"notionCalendarLaunchModal.downloadTitle"})}),(0,D.jsx)(h().A,{isSecondaryColor:!0,isMultiline:!0,children:(0,D.jsx)(S().sA,{defaultMessage:"See notifications, view your schedule, and join meetings from anywhere",id:"notionCalendarLaunchModal.downloadCaption"})}),(0,D.jsx)("div",{style:t.downloadButtonContainer,children:(0,D.jsx)(f().A,{colorPalette:"blue",style:t.downloadButton,onClick:()=>{A().Lt(e,{cta:"download"}),(0,C().L)({environment:e,url:o().A.calendar.downloadUrl}),U()},children:(0,D.jsx)(S().sA,{...L.downloadApp})})})]}),(0,D.jsx)("div",{style:t.notionCalendarLogo,children:(0,D.jsx)(g().I,{icon:b().notionCalendarIcon,size:56})})]})]})]}),V=()=>(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(j().Ay,{src:"https://player.vimeo.com/video/900939588?h=187435ef3c",defaultTextTrack:j().VH[c().locale]||"en",options:{muted:!0,autoplay:!0,loop:!0,background:!0,playsinline:!0}}),(0,D.jsx)(u().R,{style:t.closeButton,hoveredStyle:t.closeButtonHovered,onClick:R}),(0,D.jsxs)("div",{style:t.content,children:[(0,D.jsx)("div",{style:t.title,children:(0,D.jsx)(S().sA,{defaultMessage:"Meet Notion Calendar",id:"notionCalendarLaunchModal.title"})}),(0,D.jsxs)(h().A,{isSecondaryColor:!0,isMultiline:!0,children:[(0,D.jsx)(S().sA,{defaultMessage:"The beautifully designed calendar for your life and work. Integrated and synced with all your calendar events.",id:"notionCalendarLaunchModal.caption"})," "]})]}),(0,D.jsx)(p().A,{size:1,style:t.divider}),(0,D.jsxs)("div",{style:t.footer,children:[(0,D.jsx)(m().p,{colorPalette:"gray",href:(0,w().x)("blog.notionCalendarLaunch"),external:!0,iconTrailing:{icon:y().arrowUpRightSquareSmallIcon,size:"sm"},children:(0,D.jsx)(S().sA,{defaultMessage:"Learn more",id:"notionCalendarLaunchModal.learnMore"})}),(0,D.jsx)(E,{openCalendarFrom:"onboardingModalOpenCalendar",getNotionCalendarFrom:n,onOpenCalendarClick:()=>{A().be(e,{cta:"open_calendar"}),O()},onGetNotionCalendarClick:()=>{A().be(e,{cta:"get_calendar"}),F()},onDownloadClick:()=>{A().be(e,{cta:"download"}),U()}})]})]});return(0,D.jsx)(T().l,{messageKey:"notion_calendar_launch_promo",desktopRenderInner:()=>(0,D.jsx)(N,{launchModalPhase:z,renderChild:()=>"connected_notion_calendar"===z?K():V()}),desktopInnerStyle:t.container,desktopOnDismiss:R,phoneRenderInner:()=>null})}function N({launchModalPhase:e,renderChild:t}){const n=(0,a().v3)();return(0,i.useEffect)((()=>{"connected_notion_calendar"===e?A().Y8(n):A().aq(n)}),[n,e]),t()}},393686:(e,t,n)=>{n.d(t,{A:()=>y,W:()=>v});n(16280),n(944114);var i=()=>n(726637),s=()=>n(675133),o=()=>n(792057),a=()=>n(896628),r=()=>n(383594),l=()=>n(675925),d=()=>n(892632),c=()=>n(977872),u=()=>n(867772),p=()=>n(547149),g=()=>n(46986),m=()=>n(568365);const f=1500,h=(0,n(69708).YK)({pageCover:{defaultMessage:"Page cover",id:"pageCover.title"},fileTypeCaption:{defaultMessage:"Images wider than {idealImageWidth} pixels work best.",id:"pageCover.fileType.caption"},uploadFailed:{defaultMessage:"Upload failed",id:"pageCover.errorDialogMessage.uploadFailed"},preparing:{defaultMessage:"Preparing...",id:"pageCover.status.preparing"},downloading:{defaultMessage:"Downloading...",id:"pageCover.status.downloading"},embedTitle:{defaultMessage:"Link",id:"pageCover.embedType.title"},embedPlaceholder:{defaultMessage:"Paste an image link…",id:"pageCover.embedType.placeholder"},embedCaption:{defaultMessage:"Works with any image from the web.",id:"pageCover.embedType.caption"},embedSubmit:{defaultMessage:"Submit",id:"pageCover.embedType.buttonText"},downloadingAiImage:{defaultMessage:"Downloading AI image...",id:"pageCover.downloadingAiImage.status"},aiImageGenerateTitle:{id:"pageCover.aiImageGenerate.title",defaultMessage:"Notion AI"},aiImageGenerateCaption:{id:"pageCover.aiImageGenerate.caption",defaultMessage:"Generate a custom image using AI based on your description"},aiImageGenerateButtonText:{id:"pageCover.aiImageGenerate.buttonText",defaultMessage:"Generate Image"},aiImageGenerateInputPlaceholder:{id:"pageCover.aiImageGenerate.inputPlaceholder",defaultMessage:"Generate a pattern, artwork, photo..."}});async function y({environment:e,intl:t,store:n,imageUrl:i,callback:s}){try{var a;m().M.setState({loadingMode:u().Gi,progressText:t.formatMessage(h.downloadingAiImage)});const r=await fetch(i);if(!r.ok)throw new Error(`Failed to download image: ${r.statusText}`);const l=await r.blob(),c=`ai-generated-${Date.now()}.png`,p=new File([l],c,{type:l.type||"image/png"});d().QM({environment:e,file:p,bucket:"secure",record:(null===(a=n.getCoverStore())||void 0===a?void 0:a.pointer)??n.pointer,isFileBlock:!1,reportRichUploadMetrics:!0,onStart:x,onProgress:M,onComplete:t=>{A({environment:e,store:n,url:{originUrl:t},callback:s})},onError:()=>{o().f1(t.formatMessage(h.uploadFailed))}})}catch(r){o().f1(t.formatMessage(h.uploadFailed)),s()}}function v({environment:e,intl:t,store:n,rect:s,from:u}){const m=(0,g().Vf)({spaceStore:n.getSpaceStore()}),v=[{type:"gallery",onChange:({url:t,position:i})=>{(0,l().o)(e,{action:"edit_cover",block_type:"page",from:u},(s=>{S({environment:e,store:n,url:{originUrl:t},position:i,callback:s})}))}},{type:"file",fileUpload:!1,imageUpload:!0,videoUpload:!1,caption:t.formatMessage(h.fileTypeCaption,{idealImageWidth:f}),onUpload:i=>{(0,l().o)(e,{action:"edit_cover",block_type:"page",from:u},(s=>{var a;r().I(),d().QM({environment:e,file:i[0],bucket:"secure",record:(null===(a=n.getCoverStore())||void 0===a?void 0:a.pointer)??n.pointer,isFileBlock:!1,reportRichUploadMetrics:!0,onStart:e=>{r().I(),x(e)},onProgress:M,onComplete:t=>{A({environment:e,store:n,url:{originUrl:t},callback:s})},onError:()=>{o().f1(t.formatMessage(h.uploadFailed))}})}))}},{type:"embed",title:t.formatMessage(h.embedTitle),inputPlaceholder:t.formatMessage(h.embedPlaceholder),caption:t.formatMessage(h.embedCaption),buttonText:t.formatMessage(h.embedSubmit),onChange:t=>{(0,l().o)(e,{action:"edit_cover",block_type:"page",from:u},(i=>{var s;s={environment:e,store:n,url:t,callback:i},b({...s,position:.5}),r().I()}))}},{type:"unsplash",onChange:({url:t,position:i})=>{(0,l().o)(e,{action:"edit_cover",block_type:"page",from:u},(s=>{S({environment:e,store:n,url:{originUrl:t},position:i,callback:s})}))}}];m&&!i().A.isMobile&&v.push({type:"generate",title:t.formatMessage(h.aiImageGenerateTitle),caption:t.formatMessage(h.aiImageGenerateCaption),buttonText:t.formatMessage(h.aiImageGenerateButtonText),inputPlaceholder:t.formatMessage(h.aiImageGenerateInputPlaceholder),defaultAvatar:"/images/assistant_static_face_favicon.png",integration:"ai-image-generator",spaceId:n.pointer.spaceId??"",blockId:n.id,size:{width:1500,height:843},source:"page_cover",n:1,onGenerationStart:({prompt:e})=>{r().I(),c().P.setBlockState(n.id,{prompt:e,source:"page_cover"})},onGenerationEnd:async({url:i})=>{await Promise.resolve(),(0,l().o)(e,{action:"edit_cover",block_type:"page",from:u},(s=>{c().P.setBlockState(n.id,void 0),y({environment:e,intl:t,store:n,imageUrl:i,callback:s})}))},onGenerationError:()=>{c().P.setBlockState(n.id,void 0)}}),r().W(e,{originGap:8,originRect:s,isSmallWidth:!1,popupWidth:540,maxHeight:485,title:t.formatMessage(h.pageCover),onDelete:()=>{!function({environment:e,store:t}){r().I(),p().createAndCommit({userAction:"PageCover.handleDelete",environment:e,canUndo:!0,perform:e=>{a().PT({store:t,transaction:e})}})}({environment:e,store:n})},currentTab:"gallery",tabs:v})}async function b(e){const{environment:t,store:n,url:i,position:o,callback:r}=e,{serverCommitResult:l}=p().createAndCommit({userAction:"PageCover.updatePageCover",environment:t,canUndo:!0,perform:e=>{a().fg({store:n,url:i,position:o||.5,transaction:e})}});await l,r(),m().M.state.loadingMode===u().vS&&m().M.setState({loadingMode:u().Gi,dataURL:m().M.state.dataURL,uploadProgress:t.device.isMobileNative?void 0:100,progressText:s().A.formatMessage(h.downloading)})}function S(e){b(e),i().A.isMobile&&r().I()}function x(e){const{file:t,name:n,size:i}=e;if(m().M.setState({loadingMode:u().Wc,file:t,name:n,size:i}),t.type.indexOf("image")>=0)if(t instanceof File){const e=new FileReader;e.onload=e=>{var t;const n=(null===(t=e.target)||void 0===t?void 0:t.result)??void 0;n&&"string"!=typeof n||m().M.state.loadingMode!==u().Wc||m().M.setState({...m().M.state,loadingMode:u().vS,uploadProgress:0,dataURL:n})},e.readAsDataURL(t)}else m().M.state.loadingMode===u().Wc&&m().M.setState({...m().M.state,loadingMode:u().vS,dataURL:t.dataURL,progressText:s().A.formatMessage(h.preparing)});else m().M.state.loadingMode===u().Wc&&m().M.setState({...m().M.state,loadingMode:u().vS,progressText:s().A.formatMessage(h.preparing)})}function M(e){const{progressPercent:t,progressText:n}=e;m().M.state.loadingMode===u().vS&&m().M.setState({...m().M.state,uploadProgress:t,progressText:n})}function A(e){b({...e,position:.5})}},405331:(e,t,n)=>{n.d(t,{A:()=>d});n(296540);var i=()=>n(401497),s=()=>n(663639),o=()=>n(736847),a=()=>n(69708),r=()=>n(100622),l=n(474848);const d=function(e){const{importListItems:t}=e,d=(0,n(590526).uB)(void 0,n(452004).$),c=(0,i().IS)((()=>({InviteDropdownMenu:{background:r().Tj.background.elevated,width:265,borderRadius:8},helpSection:{width:"100%"}})),[]),u={key:"all_import_sections",render:e=>(0,l.jsx)(o().A,{...e,title:(0,l.jsx)(a().sA,{id:"spacePermissionsSettings.inviteLinkRefreshModal.inviteDropdownMenu.title",defaultMessage:"Import from"})}),items:t},p={key:"help_section",render:e=>(0,l.jsx)(o().A,{...e,topBorder:!0}),items:[{key:"help_section",render:e=>g,action:()=>{}}]},g=(0,l.jsx)(n(552712).N,{style:{display:"flex",padding:"0 4px"},className:"notion-print-ignore",href:(0,n(232930).x)("guides.publicAPI"),external:!0,children:(0,l.jsx)(n(631524).p,{iconLeading:{icon:n(721479).questionMarkCircleSmallIcon,size:"sm"},colorPalette:"gray",style:c.helpSection,children:(0,l.jsx)(a().sA,{id:"spacePermissionsSettings.inviteLinkRefreshModal.inviteDropdownMenu.learnMore",defaultMessage:"Learn more"})})});return(0,l.jsx)(n(890492).A,{menuType:n(546926).gu.Popup,children:(0,l.jsx)(s().A,{type:s().O.Vertical,store:d,initialFocus:void 0,disableInitialScroll:!0,disableCommandEnter:!0,sections:[u,p],style:c.InviteDropdownMenu})})}},408095:(e,t,n)=>{n.d(t,{qY:()=>I,r0:()=>A,lh:()=>T,dJ:()=>w,d9:()=>b,lY:()=>F,Fz:()=>N,yK:()=>C,ab:()=>O,tE:()=>j,X8:()=>S,$m:()=>y,QR:()=>x,P$:()=>v});var i=()=>n(876544),s=()=>n(686452),o=()=>n(158894),a=()=>n(564613),r=()=>n(407444),l=()=>n(74007),d=()=>n(888382),c=()=>n(295434),u=()=>n(979340),p=()=>n(69708),g=()=>n(232930);const m=n.p+"f6312fd4cd8217ce.png",f=n.p+"84cf2899a9948385.png",h=n.p+"a9c59c32b6df48a5.png",y=["free","plus","business","enterprise"],v=(0,p().YK)({advancedAIButtonTooltip:{id:"ProductLimit.advancedAIButtonTooltip",defaultMessage:"Upgrade to Business"},advancedAIButtonMemberTooltipPrimary:{id:"ProductLimit.advancedAIButtonMemberTooltipPrimary",defaultMessage:"Request access to Advanced AI features on the Business Plan"},advancedAIButtonMemberTooltipSecondary:{id:"ProductLimit.advancedAIButtonMemberTooltipSecondary",defaultMessage:"Get AI Meeting Notes, Enterprise Search, and Research Mode"},coreAIButtonTooltip:{id:"ProductLimit.coreAIButtonTooltip",defaultMessage:"Upgrade with the AI Add On to access Notion AI for Writer, Q&A and foundational AI features"},upgrade:{id:"ProductLimit.upgrade",defaultMessage:"Upgrade"},addToPlan:{id:"ProductLimit.addToPlan",defaultMessage:"Add to plan"},contactSalesSalesAssisted:{id:"ProductLimit.contactSalesSalesAssisted",defaultMessage:"Contact sales"},advancedAILabel:{id:"ProductLimit.advancedAILabel",defaultMessage:"Advanced Notion AI"},advancedAIUpsellDescription:{id:"ProductLimit.advancedAIUpsellDescription",defaultMessage:"Upgrade to search everywhere, automate meeting notes & more"},advancedAIDescription:{id:"ProductLimit.advancedAIDescription",defaultMessage:"Search everywhere, automate meeting notes & more"},coreAILabel:{id:"ProductLimit.coreAILabel",defaultMessage:"Notion AI"},aiLabel:{id:"ProductLimit.aiLabel",defaultMessage:"Notion AI"},coreAIDescription:{id:"ProductLimit.coreAIDescription",defaultMessage:"Upgrade to search everywhere, automate meeting notes & more"},activePlan:{id:"ProductLimit.activePlan",defaultMessage:"Active plan"},aiAddOnHeading:{id:"ProductLimit.aiAddOnLabel",defaultMessage:"Notion AI"},aiTierHeading:{id:"ProductLimit.aiTierLabel",defaultMessage:"Notion AI"},aiSettings:{id:"ProductLimit.aiSettings",defaultMessage:"Settings"},aiAddOnTooltip:{id:"ProductLimit.aiAddOnTooltip",defaultMessage:"Your workspace currently has access to Notion AI core features only. Upgrade to Business to get the full set of advanced features."},aiBusinessTierTooltip:{id:"ProductLimit.aiBusinessTierTooltip",defaultMessage:"Included with the Business Plan"},aiEnterpriseLimitedTierTooltip:{id:"ProductLimit.aiEnterpriseTierTooltip",defaultMessage:"Included with the Enterprise Limited Plan"},aiAddOnUsage:{id:"ProductLimit.aiAddOnUsage",defaultMessage:"{usedCount}/{totalCount} AI responses used"},aiAddedToPlan:{id:"ProductLimit.aiAddedToPlan",defaultMessage:"Added to plan"},aiIncludedInPlan:{id:"ProductLimit.aiIncludedInPlan",defaultMessage:"Included in plan"},otherPlans:{id:"ProductLimit.otherPlans",defaultMessage:"Other plans to consider"},teamBlocksLabel:{id:"ProductLimit.teamBlocksLabel",defaultMessage:"Team blocks"},teamBlocksUsage:{id:"ProductLimit.teamBlocksUsage",defaultMessage:"{usedCount}/{totalCount} team blocks used"},restrictions:{id:"ProductLimit.downgrade",defaultMessage:"Downgrade"},ctaPrice:{id:"SpaceSubscriptionPlans.productCta",defaultMessage:"From {money}/member per month"},ctaButtonLabel:{id:"SpaceSubscriptionPlans.productCtaButtonLabel",defaultMessage:"Upgrade"},unlimitedBlocksForIndividuals:{id:"SpaceSubscriptionPlans.includes.unlimitedBlocksForIndividuals",defaultMessage:"Unlimited blocks for individuals"},unlimitedBlocksForTeams:{id:"SpaceSubscriptionPlans.includes.unlimitedBlocksForTeams",defaultMessage:"Unlimited blocks for teams"},unlimitedFileUploads:{id:"SpaceSubscriptionPlans.includes.unlimitedFileUploads",defaultMessage:"Unlimited file uploads"},collaborativeWorkspace:{id:"SpaceSubscriptionPlans.includes.collaborativeWorkspaces",defaultMessage:"Collaborative workspace"},integrations:{id:"SpaceSubscriptionPlans.includes.integrations",defaultMessage:"Slack, GitHub, and more integrations"},pageHistory7Days:{id:"SpaceSubscriptionPlans.includes.pageHistory.7",defaultMessage:"7 day page history"},pageHistory30Days:{id:"SpaceSubscriptionPlans.includes.pageHistory.30",defaultMessage:"30 day page history"},pageHistory90Days:{id:"SpaceSubscriptionPlans.includes.pageHistory.90",defaultMessage:"90 day page history"},pageHistoryUnlimited:{id:"SpaceSubscriptionPlans.includes.pageHistory.unlimited",defaultMessage:"Unlimited page history"},guests10:{id:"SpaceSubscriptionPlans.includes.guests.10",defaultMessage:"Invite up to 10 guests"},guests100:{id:"SpaceSubscriptionPlans.includes.guests.100",defaultMessage:"Invite up to 100 guests"},guests250:{id:"SpaceSubscriptionPlans.includes.guests.250",defaultMessage:"Invite up to 250 guests"},guestsCustom:{id:"SpaceSubscriptionPlans.includes.guests.custom",defaultMessage:"Custom guest limits"},aiCredits:{id:"SpaceSubscriptionPlans.includes.aiCredits",defaultMessage:"10 free AI credits"},samlSSO:{id:"SpaceSubscriptionPlans.includes.saml.sso",defaultMessage:"SAML SSO"},userProvisioning:{id:"SpaceSubscriptionPlans.includes.scim",defaultMessage:"User provisioning (SCIM)"},advancedSecurityControls:{id:"SpaceSubscriptionPlans.includes.advancedSecurityControls",defaultMessage:"Advanced security controls"},auditLog:{id:"SpaceSubscriptionPlans.includes.auditLog",defaultMessage:"Audit log"},privateTeamspaces:{id:"SpaceSubscriptionPlans.includes.privateTeamspaces",defaultMessage:"Private Teamspaces"},bulkPdfExport:{id:"SpaceSubscriptionPlans.includes.bulkPdfExport",defaultMessage:"Bulk PDF export"},customerSuccessManager:{id:"SpaceSubscriptionPlans.includes.customerSuccessManager",defaultMessage:"Customer success manager"},includesFree:{id:"SpaceSubscriptionPlans.includes.free",defaultMessage:"Includes"},includesPlus:{id:"SpaceSubscriptionPlans.includes.plus",defaultMessage:"Everything in Free, and"},includesBusiness:{id:"SpaceSubscriptionPlans.includes.business",defaultMessage:"Everything in Plus, and"},includesEnterprise:{id:"SpaceSubscriptionPlans.includes.enterprise",defaultMessage:"Everything in Business, and"},seeAllPlans:{id:"SpaceSubscriptionPlans.seeAllPlans",defaultMessage:"See all plans"},allPlans:{id:"spaceSubscriptionPlans.allPlans.title",defaultMessage:"All plans"},salesAssistedDisabled:{id:"spaceSubscriptionPlans.referToSalesRep",defaultMessage:"Please contact your Notion account manager to make changes to your plan"},contactSales:{id:"SpaceSubscriptionPlans.contactSales",defaultMessage:"Contact Sales"},talkToSales:{id:"SpaceSubscriptionPlans.talkToSales",defaultMessage:"Talk to sales to learn more"}}),b=(0,p().YK)({free:{id:"ProductOverview.mayMoment.free.caption",defaultMessage:"Organize every corner of your work and life"},personal:{id:"ProductOverview.mayMoment.personal.caption",defaultMessage:"A place to plan and get organized, with a 1-member limit"},plus:{id:"ProductOverview.mayMoment.plus.caption",defaultMessage:"For small groups to plan and get organized"},business:{id:"ProductOverview.mayMoment.business.caption",defaultMessage:"The connected workspace with all-in-one AI"},student:{id:"ProductOverview.mayMoment.student.caption",defaultMessage:"For students & educators"},enterprise:{id:"ProductOverview.mayMoment.enterprise.caption",defaultMessage:"For organizations to operate with scalability, control & security"}}),S={free:v.includesFree,student:v.includesPlus,plus:v.includesPlus,personal:v.includesPlus,business:v.includesBusiness,enterprise:v.includesEnterprise},x=(0,p().YK)({summary:{id:"plansPage.highlightCards.summary",defaultMessage:"Summary"},highlights:{id:"plansPage.highlightCards.highlights",defaultMessage:"Highlights"},compareAllFeatures:{id:"plansPage.compareAllFeatures.button.label",defaultMessage:"Compare all features"},price:{id:"plansPage.price",defaultMessage:"{money} per member / month"},priceOnTrial:{id:"plansPage.price.onTrial",defaultMessage:"{money} per member / month until {date}"},billedAnnually:{id:"plansPage.billedAnnually",defaultMessage:"billed annually"},billedMonthly:{id:"plansPage.billedMonthly",defaultMessage:"billed monthly"},priceMonthly:{id:"plansPage.price.monthly",defaultMessage:"{money} billed monthly"}}),M=(0,p().YK)({free:{id:"plansPage.activePlan.free.description",defaultMessage:"For organizing every corner of your work and life"},student:{id:"plansPage.activePlan.student.description",defaultMessage:"For students & educators"},personal:{id:"plansPage.activePlan.personal.description",defaultMessage:"A place to plan and get organized, with a 1-member limit"},personalForIos:{id:"plansPage.activePlan.personal.ios.description",defaultMessage:"Purchased in-app, through Apple"},personalForAndroid:{id:"plansPage.activePlan.personal.android.description",defaultMessage:"Purchased in-app, through Google Play"},plus:{id:"plansPage.activePlan.plus.description.afterMayMoment",defaultMessage:"For small teams and professionals to work together"},business:{id:"plansPage.activePlan.business.description.afterMayMoment",defaultMessage:"The connected workspace with all-in-one AI"},businessTrial:{id:"plansPage.activePlan.business.description.trialAfterMayMoment",defaultMessage:"30 days of Notion AI and other Business features"},enterprise:{id:"plansPage.activePlan.enterprise.description.afterMayMoment",defaultMessage:"For organizations to operate with scalability, control & security"}}),A=(0,p().YK)({singlePlayerPlans:{id:"plansPage.activePlan.generic.tooltip",defaultMessage:"Your plan has a 1-member limit. Switch your plan to add more members."},iosPlans:{id:"plansPage.activePlan.personal.ios.tooltip",defaultMessage:"Your plan has a 1-member limit. You can cancel this plan through Apple Subscriptions, and then upgrade in Notion."},androidPlans:{id:"plansPage.activePlan.personal.android.tooltip",defaultMessage:"Your plan has a 1-member limit. You can cancel this plan through Google Play, and then upgrade in Notion."}}),j={label:u().v0.personalForIos,description:M.personalForIos,tooltip:A.iosPlans},w={label:u().v0.personalForAndroid,description:M.personalForAndroid,tooltip:A.androidPlans},I={free:{label:u().v0.free,description:M.free},student:{label:u().v0.educationPlus,description:M.student},personal:{label:u().v0.plus,description:M.personal,tooltip:A.singlePlayerPlans},plus:{label:u().v0.plus,description:M.plus},business:{label:u().v0.business,description:M.business},businessTrial:{label:u().v0.business,description:M.businessTrial},enterprise:{label:u().v0.enterprise,description:M.enterprise},enterprise_limited:{label:u().v0.enterpriseLimited,description:M.enterprise}},k=(0,p().YK)({description:{id:"plansPage.aiSection.description",defaultMessage:"Notion AI for Q&A, Autofill, Writer, and more"},descriptionV2:{id:"plansPage.aiSection.descriptionV2",defaultMessage:"Search, generate, analyze, and chat with Notion AI"},price:{id:"plansPage.aiSection.price",defaultMessage:"From {money} per member / month, billed annually"},added:{id:"plansPage.aiSection.added",defaultMessage:"Added"},mailAIDescription:{id:"plansPage.aiSection.mailAIDescription",defaultMessage:"Get AI-powered labels and writing for Notion Mail"}}),T={upgrade:v.upgrade,addToPlan:v.addToPlan,advancedAIHeading:v.advancedAILabel,advancedAIUpsellDescription:v.advancedAIUpsellDescription,advancedAIDescription:v.advancedAIDescription,advancedAIButtonTooltip:v.advancedAIButtonTooltip,advancedAIRequestButtonTooltipPrimary:v.advancedAIButtonMemberTooltipPrimary,advancedAIRequestButtonTooltipSecondary:v.advancedAIButtonMemberTooltipSecondary,coreAIHeading:v.coreAILabel,aiHeading:v.aiLabel,coreAIDescription:v.coreAIDescription,coreAIButtonTooltip:v.coreAIButtonTooltip,aiAddOnHeading:v.aiAddOnHeading,tierHeading:v.aiTierHeading,aiAddOnTooltip:v.aiAddOnTooltip,businessTierTooltip:v.aiBusinessTierTooltip,enterpriseLimitedTierTooltip:v.aiEnterpriseLimitedTierTooltip,description:k.description,descriptionV2:k.descriptionV2,mailAIDescription:k.mailAIDescription,planPrice:k.price,ctaMessage:v.addToPlan,ctaMessageSalesAssisted:v.contactSalesSalesAssisted,added:k.added,addedToPlan:v.aiAddedToPlan,includedInPlan:v.aiIncludedInPlan,settings:v.aiSettings,request:n(695689).P.request},C=(0,p().YK)({active:{id:"plansPage.highlightCards.badge.active",defaultMessage:"Active"},enterprise_limited:{id:"plansPage.highlightCards.badge.enterpriseLimited",defaultMessage:"Limited"},popular:{id:"plansPage.highlightCards.badge.popular",defaultMessage:"Popular"},best_value:{id:"plansPage.highlightCards.badge.bestValue",defaultMessage:"Best value"},recommended:{id:"plansPage.highlightCards.badge.recommended",defaultMessage:"Recommended"},free_trial:{id:"plansPage.highlightCards.badge.freeTrial",defaultMessage:"Free trial"},coming_soon:{id:"plansPage.highlightCards.badge.comingSoon",defaultMessage:"Coming soon"}}),_=(0,p().YK)({forms:{id:"plansPage.highlightCards.mayMoment.free.forms",defaultMessage:"Basic forms"},sites:{id:"plansPage.highlightCards.mayMoment.free.sites",defaultMessage:"Basic sites"},automations:{id:"plansPage.highlightCards.mayMoment.free.automations",defaultMessage:"Basic automations"},databases:{id:"plansPage.highlightCards.mayMoment.free.databases",defaultMessage:"Custom databases"},calendar:{id:"plansPage.highlightCards.mayMoment.free.calendar",defaultMessage:"Notion Calendar"},mail:{id:"plansPage.highlightCards.mayMoment.free.mail",defaultMessage:"Notion Mail"}}),P=(0,p().YK)({blocks:{id:"plansPage.highlightCards.mayMoment.plus.blocks",defaultMessage:"Unlimited blocks"},blocksTooltip:{id:"plansPage.highlightCards.mayMoment.plus.blocks.tooltip",defaultMessage:"Workspaces with 2+ members are limited to {blockLimitNumber} blocks on the Free plan"},charts:{id:"plansPage.highlightCards.mayMoment.plus.charts",defaultMessage:"Unlimited charts"},forms:{id:"plansPage.highlightCards.mayMoment.plus.forms",defaultMessage:"Custom forms"},sites:{id:"plansPage.highlightCards.mayMoment.plus.sites",defaultMessage:"Custom sites"},integrations:{id:"plansPage.highlightCards.mayMoment.plus.integrations",defaultMessage:"Basic integrations"},integrationsTooltip:{id:"plansPage.highlightCards.mayMoment.plus.integrations.tooltip",defaultMessage:"Embeds, previews, custom automations and database syncs"}}),B=(0,p().YK)({salesAssistedAIDescription:{id:"plansPage.highlightCards.mayMoment.salesAssisted.business.aiDescription",defaultMessage:"Contact Sales for Notion AI"}}),R=(0,p().YK)({aiIncluded:{id:"plansPage.highlightCards.mayMoment.business.aiIncluded",defaultMessage:"Notion AI included"},saml:{id:"plansPage.highlightCards.mayMoment.business.saml.sso",defaultMessage:"SAML SSO"},verifyPages:{id:"plansPage.highlightCards.mayMoment.business.verifyPages",defaultMessage:"Verify any page"},search:{id:"plansPage.highlightCards.mayMoment.business.search",defaultMessage:"Enterprise search"},searchTooltip:{id:"plansPage.highlightCards.mayMoment.business.search.tooltip",defaultMessage:"Get instant answers across your connected apps with Notion AI"},integrations:{id:"plansPage.highlightCards.mayMoment.business.integrations",defaultMessage:"Premium integrations"},integrationsTooltip:{id:"plansPage.highlightCards.mayMoment.business.integrations.tooltip",defaultMessage:"Embeds, previews, custom automations and database syncs"}}),D=(0,p().YK)({salesAssistedAIDescription:{id:"plansPage.highlightCards.mayMoment.salesAssisted.enterprise.aiDescription",defaultMessage:"Contact Sales for Notion AI"}}),L=(0,p().YK)({aiIncluded:{id:"plansPage.highlightCards.mayMoment.enterprise.aiIncluded",defaultMessage:"Notion AI included"},userProvisioning:{id:"plansPage.highlightCards.mayMoment.enterprise.userProvisioning",defaultMessage:"User provisioning"},auditLog:{id:"plansPage.highlightCards.mayMoment.enterprise.auditLog",defaultMessage:"Audit log"},security:{id:"plansPage.highlightCards.mayMoment.enterprise.security",defaultMessage:"Advanced security & controls"},search:{id:"plansPage.highlightCards.mayMoment.enterprise.search",defaultMessage:"Enterprise search"},searchTooltip:{id:"plansPage.highlightCards.mayMoment.enterprise.search.tooltip",defaultMessage:"Get instant answers across your connected apps with Notion AI"},integrations:{id:"plansPage.highlightCards.mayMoment.enterprise.integrations",defaultMessage:"Advanced integrations"},integrationsTooltip:{id:"plansPage.highlightCards.mayMoment.enterprise.integrations.tooltip",defaultMessage:"Embeds, previews, custom automations and database syncs"}}),E={integrations:(0,g().x)("guides.dataAndIntegrations"),enterpriseSearch:(0,g().x)("guides.aiConnectors")},O={student:u().v0.student,personal:u().v0.personal,free:u().v0.free,plus:u().v0.plus,business:u().v0.business,enterprise:u().v0.enterprise,enterprise_limited:u().v0.enterpriseLimited};function N({intl:e,isSalesAssisted:t,aiPurchasability:n}){let p,g;return p=t&&"none"===n.currentState.featureSet?[R.saml,R.verifyPages,{message:R.integrations,iconBar:{icons:[r().gmailIcon,o().figmaIcon,c().zendeskIcon,s().asanaIcon],followText:"+5"},multiLine:!0,tooltip:{imagePath:h,description:e.formatMessage(R.integrationsTooltip),link:E.integrations}},{message:B.salesAssistedAIDescription,multiLine:!0}]:[R.aiIncluded,R.saml,R.verifyPages,{message:R.search,iconBar:{icons:[d().slackIcon,l().googleDriveIcon,a().gitHubIcon,i().U],followText:"+4"},multiLine:!0,tooltip:{imagePath:m,description:e.formatMessage(R.searchTooltip),link:E.enterpriseSearch}},{message:R.integrations,iconBar:{icons:[r().gmailIcon,o().figmaIcon,c().zendeskIcon,s().asanaIcon],followText:"+5"},multiLine:!0,tooltip:{imagePath:h,description:e.formatMessage(R.integrationsTooltip),link:E.integrations}}],g=t&&"none"===n.currentState.featureSet?[L.userProvisioning,L.auditLog,{message:L.security,multiLine:!0},{message:L.integrations,tooltip:{imagePath:h,description:e.formatMessage(L.integrationsTooltip),link:E.integrations}},{message:D.salesAssistedAIDescription,multiLine:!0}]:[L.aiIncluded,L.userProvisioning,L.auditLog,{message:L.security,multiLine:!0},{message:L.search,iconBar:{icons:[d().slackIcon,l().googleDriveIcon,a().gitHubIcon,i().U],followText:"+4"},multiLine:!0,tooltip:{imagePath:f,description:e.formatMessage(L.searchTooltip),link:E.enterpriseSearch}},{message:L.integrations,tooltip:{imagePath:h,description:e.formatMessage(L.integrationsTooltip),link:E.integrations}}],{free:[_.forms,_.sites,_.automations,_.databases,_.calendar,_.mail],plus:[{message:P.blocks,tooltip:{description:e.formatMessage(P.blocksTooltip,{blockLimitNumber:(0,u().lP)()})}},P.charts,P.forms,P.sites,{message:P.integrations,iconBar:{icons:[d().slackIcon,l().googleDriveIcon,r().gmailIcon]},multiLine:!0,tooltip:{description:e.formatMessage(P.integrationsTooltip),link:E.integrations}}],business:p,enterprise:g}}function F({featureSet:e}){switch(e){case"core":return T.coreAIHeading;case"none":case"advanced":return T.advancedAIHeading;default:return e}}},417242:(e,t,n)=>{n.r(t),n.d(t,{MobileShareMenuRenderer:()=>m});var i=n(296540),s=()=>n(907258),o=()=>n(726637),a=()=>n(484714),r=()=>n(590526),l=()=>n(127833),d=()=>n(482707),c=()=>n(114871),u=()=>n(321172),p=()=>n(538233),g=n(474848);function m(e){const t=(0,r().O$)(p().A),n=(0,a().v3)(),d=(0,r().O$)(s().AppStoreMainEditorCurrentBlockStore),c=(0,i.useCallback)((()=>{(0,u().XP)({environment:n,store:d})}),[n,d]);return o().A.isMobile?(0,g.jsx)(l().zD,{popupType:l().nl.BottomSheet,bottomSheetInitialState:"full",trapFocus:!0,open:t.open,render:()=>(0,g.jsx)(f,{menuState:t,onClose:c}),onDismiss:c}):null}function f(e){const t=(0,r().uB)(void 0,c().Ay),n=(0,r().O$)(s().AppStoreMainEditorCurrentBlockStore);return e.menuState.open&&n?(0,g.jsx)(d().k,{store:n,buttonPopupStore:p().A,location:"topbar_mobile",onClose:e.onClose,inviteTargetsStore:t}):null}},418493:(e,t,n)=>{n.d(t,{E:()=>a,e:()=>r});n(898992),n(823215);var i=()=>n(587682),s=()=>n(925832);function o(e){var t;const n=(0,s().s)(e);if(n.length>0)return n;const i=null===(t=e.ownerDocument)||void 0===t?void 0:t.documentElement;return i?[i]:[]}function a(e){const{element:t,extraBottomSpacing:n=0}=e;let i=t.getBoundingClientRect();i=DOMRect.fromRect({x:i.x,y:i.y,width:i.width,height:i.height+n});return o(t).every((e=>{const t=e.getBoundingClientRect();return i.top>=t.top&&i.bottom<=t.bottom&&i.left>=t.left&&i.right<=t.right}))}function r({element:e,rect:t,widthRequired:n,heightRequired:s,containerRectsCache:a}){const r=t??e.getBoundingClientRect();return!(r.width<=0&&r.height<=0)&&o(e).every((e=>{const t=null==a?void 0:a.get(e),o=t??e.getBoundingClientRect();!t&&a&&a.set(e,o);const l=(0,i().E$)(r,o);return l.width>=(void 0!==n?Math.min(n,r.width):0)&&l.height>=(void 0!==s?Math.min(s,r.height):0)}))}},419860:(e,t,n)=>{n.d(t,{i:()=>c,l:()=>d});var i=()=>n(242422),s=()=>n(484714),o=()=>n(590526),a=()=>n(192359),r=()=>n(666976),l=()=>n(677169);function d(){const e=(0,s().v3)(),{botId:t}=(0,l().m)(),n=c(),i=(0,o().K8)((()=>(0,r().A)(e)&&(0,a().M5)()),[e]);return Boolean(e.device.isElectron&&t&&i&&"disabled"!==n)}function c(){return(0,o().K8)((()=>i().default.getEligibleGroup({experimentId:"ai_meeting_notes_umn_intents",defaultGroup:"disabled",disableExposureLogging:!0})),[])}},421861:(e,t,n)=>{n.d(t,{i:()=>M});var i=n(296540),s=()=>n(907258),o=()=>n(726637),a=()=>n(590526),r=()=>n(278729),l=()=>n(807449),d=()=>n(764880),c=n(474848);const u={viewBox:"0 0 16 16",fittedViewBox:"2.49 2.19 11.01 11.97",svg:(0,c.jsx)("path",{d:"m4.145 2.922-.227-.265a.55.55 0 1 0-.836.716l1.491 1.739a3.9 3.9 0 0 0-.46 1.836v.895a2.78 2.78 0 0 1-.687 1.83l-.616.703c-.709.81-.134 2.078.942 2.078h2.2a2.081 2.081 0 0 0 4.095 0h.819l1.216 1.419a.55.55 0 0 0 .843-.707L4.153 2.931zm1.068 4.026c0-.32.054-.626.152-.912l4.558 5.318h-6.17a.153.153 0 0 1-.116-.253l.617-.705a3.88 3.88 0 0 0 .959-2.553zm1.773 5.506h2.028a1.081 1.081 0 0 1-2.028 0m6.302-.554a1.244 1.244 0 0 0-.098-1.524l-.616-.704a2.78 2.78 0 0 1-.687-1.829v-.895a3.89 3.89 0 0 0-2.124-3.465 1.85 1.85 0 0 0-3.526 0l-.112.06.738.86.062-.027.29-.121.042-.312A.75.75 0 0 1 8 3.29c.378 0 .692.281.743.653l.043.312.29.121a2.79 2.79 0 0 1 1.711 2.572v.895c0 .513.102 1.016.294 1.482z"})},p=(0,n(340498).wt)("bellSlashSmall",u,"small");var g=()=>n(848538),m=()=>n(69708),f=()=>n(100622),h=()=>n(534177),y=()=>n(284371),v=()=>n(486674),b=()=>n(231704),S=()=>n(313171);function x(e,t){const{user:i,focused:r}=e,u=(0,n(484714).v3)(),g=(0,m().tz)(),h=(0,n(401497).IS)((()=>({tooltip:{color:f().Tj.text.inverseSecondary,fontWeight:y().Wy.regular,maxWidth:240},tooltipHeader:{color:f().Tj.text.inversePrimary,fontWeight:y().Wy.medium}})),[]),b=(0,d().A7)(i),S=(0,d().lR)(g,b),x=(0,a().K8)((()=>{const e=(0,v().a)();return!(e&&(0,n(928074).Aj)({store:e}))||"none"!==(0,n(499764).om)(i.id)}),[i.id]),M=(0,a().K8)((()=>{var e;return i.id===(null===(e=s().default.state.currentUserStore)||void 0===e?void 0:e.id)}),[i.id]),w=(0,n(341694).H)(),I=(0,a().K8)((()=>{if(!w)return;if(!r)return;if(x)return;const e=(0,v().a)(),t=e&&Boolean(n(763884).K.get({userId:u.currentUser.id,key:(0,n(773706).T)(e.id)})),i=null==e?void 0:e.canAdmin();return!t&&i?(0,c.jsx)(l().I,{icon:n(97835).inviteMemberIcon,size:17,colorVariant:"secondary"}):(0,c.jsx)(l().I,{icon:p,size:17,colorVariant:"secondary"})}),[w,u.currentUser.id,x,r]),k=(0,a().K8)((()=>{if(!w)return null;const e=i.email;return(0,c.jsxs)("div",{style:h.tooltip,children:[(0,c.jsx)("header",{style:h.tooltipHeader,children:(0,c.jsx)(j,{userName:S,userHasAccessToPage:x,userIsSelf:M})}),e]})}),[w,x,M,S,i.email,h.tooltip,h.tooltipHeader]);return(0,c.jsx)(n(457688).A,{...e,ref:t,actor:b,right:I,tooltip:k,badge:(0,c.jsx)(A,{user:i}),tooltipPlacement:w?"right":void 0,useEmailAsTooltip:!w,customUserTitleStyles:o().A.isMobile?{fontSize:14}:void 0,iconSizeOverride:o().A.isMobile?24:void 0})}const M=i.forwardRef(x);function A({user:e}){const t=(0,a().O$)(s().AppStoreSidebarSpaceStore),n=(0,a().K8)((()=>{if(t)return r().V.createChildStore(t,(0,g().i1)({userId:e.id,spaceId:t.id})).getMembershipType()}),[t,e.id]);if(!n)return null;switch(n){case"none":case"member":case"membership_admin":case"owner":return null;case"page_guest":return(0,c.jsx)(b().w,{labelType:"guest"});case"restricted_member":return(0,c.jsx)(S().L,{});default:(0,h().HB)(n)}}function j({userName:e,userHasAccessToPage:t,userIsSelf:n}){return n?(0,c.jsx)(m().sA,{defaultMessage:"You",id:"activitySection.authorPhrase.forOneAuthorCurrentUser.label"}):t?null:(0,c.jsx)(m().sA,{id:"mentionMenu.UserMentionMenuItem.noAccessTooltip",defaultMessage:"{userName} won’t be notified because they don’t have page access",values:{userName:e}})}},429816:(e,t,n)=>{n.d(t,{A:()=>M});n(898992),n(672577),n(737550);var i=n(296540),s=()=>n(242422),o=()=>n(417553),a=()=>n(484714),r=()=>n(792485),l=()=>n(590526),d=()=>n(380745),c=()=>n(700500),u=()=>n(671894),p=()=>n(954719),g=()=>n(278634),m=()=>n(231536),f=()=>n(544198),h=()=>n(753721),y=()=>n(836724),v=()=>n(807990),b=()=>n(206051),S=()=>n(407054),x=n(474848);function M(e){const t=(0,a().v3)(),[s,c]=(0,i.useState)([]),u=(0,h().X)();(0,i.useEffect)((()=>{(async()=>{if(u){const e=await n.e(15498).then(n.bind(n,857954));c(e.lowPriActionsWithKeyboardShortcuts)}})()}),[u]);const g=(0,r().S)(),f=(0,i.useRef)(),y=(0,i.useRef)();(0,i.useEffect)((()=>{function e(e){e.clientX===f.current&&e.clientY===y.current||(f.current=e.clientX,y.current=e.clientY,d().A.setKeyboardMode(!1))}return window.addEventListener("mousemove",e),()=>{window.removeEventListener("mousemove",e)}}),[]);const v=(0,l().K8)((()=>[...(0,p().bD)(),...s]),[s]),b=(0,i.useMemo)((()=>function(e,t,n){const i={};for(const s of t){s.lazyDependencyKeys&&(0,m().G)(...s.lazyDependencyKeys);for(const o of s.shortcuts)i[o]=i=>j(o,i,e,t,n)}return i}(t,v,g)),[t,v,g]);return(0,x.jsx)(o().k,{debugName:e.debugName,priority:e.priority,enable:e.capture,shortcuts:b})}function A(){return!function(){const e=document.querySelector("#intercom-container");return!(!e||!e.contains(document.activeElement))}()&&!(S().A.state.isActive&&!s().default.checkGate({gateName:"block_menu_shortcut_fix"}))}function j(e,t,n,i,o){if(!A())return;const a=b().default.state.stores,r=b().default.state.pivot||a[0],l=r&&y().T.getRectFromStore(r),p=i.find((t=>!!t.shortcuts.some((t=>t===e))&&u().F6(t,{environment:n,blocks:a,originRect:l,publicEditMode:void 0,pageContext:o})));if(p){"keydown"===t.type&&t.preventDefault&&t.preventDefault();const e=S().A.state.isActive;p.action({environment:n,blocks:a,originRect:l,publicEditMode:void 0,analyticsFrom:"keyboard_shortcut",pageContext:o},t);const i=a[0];let r,u,h;i&&(r=i.getType(),u=r?(0,c().Yt)(r,i.getFormat()):void 0,h=i.getParentCollectionIdUpToTwoLevels());const{collectionId:y,ownedCollectionCount:b,linkedCollectionCount:x}=(0,f().P)(i,{skipPages:!0});(0,g().N)(n,{analyticsName:p.analyticsName,action_type:p.analyticsActionType,from:"keyboard_shortcut",block_id:null==i?void 0:i.id,block_type:r,is_toggleable:u,collection_id:y,owned_collection_count:b,linked_collection_count:x,parent_collection_id:h}),m={resetBlockMenuStore:e},d().A.setKeyboardMode(!0),v().default.reset(),s().default.checkGate({gateName:"block_menu_shortcut_fix"})&&m.resetBlockMenuStore&&S().A.reset()}var m}},430102:(e,t,n)=>{n.d(t,{I:()=>g});var i=n(296540),s=()=>n(401497),o=()=>n(718827),a=()=>n(606712),r=()=>n(150161),l=()=>n(807449),d=()=>n(26697),c=()=>n(854705),u=()=>n(100622),p=n(474848);const g=i.memo(i.forwardRef((function(e,t){const{style:n,color:i,title:o,onClick:a,onDropdownClick:l,mainButtonTooltip:d,dropdownTooltip:c,dropdownAriaLabel:g,iconLeading:h,iconStyle:y,mainButtonStyle:v,isLoading:b,className:S,disabled:x,disableDropdown:M,size:A,variant:j="solid"}=e,w=(0,s().IS)((()=>{const e=(0,r().qq)({size:A,isButtonGapEnabled:!1});return{wrap:{position:"relative",display:"inline-flex",flexShrink:0,height:e.height,...n},border:{position:"absolute",pointerEvents:"none",border:"outline"===j?`1px solid ${u().Tj.outlineButtonBorder}`:void 0,borderRadius:e.borderRadius,top:0,insetInlineStart:0,insetInlineEnd:0,bottom:0}}}),[A,j,n]);return(0,p.jsxs)("div",{style:w.wrap,className:S,children:[(0,p.jsx)(m,{ref:t,color:i,disabled:x,disableDropdown:M,iconLeading:h,iconStyle:y,isLoading:b,mainButtonStyle:v,mainButtonTooltip:d,onClick:a,title:o,variant:j}),(0,p.jsx)(f,{ref:t,color:i,disabled:M,dropdownAriaLabel:g,dropdownTooltip:c,isLoading:b,onDropdownClick:l,variant:j}),(0,p.jsx)("div",{style:w.border})]})}))),m=i.memo(i.forwardRef((function(e,t){const{mainButtonTooltip:i,onClick:a,disabled:l,disableDropdown:c,isLoading:g,iconLeading:m,title:f,color:v,variant:b,mainButtonStyle:S,iconStyle:x,size:M}=e,A=(0,s().eP)(),j=(0,s().IS)((()=>{const e=(0,r().qq)({size:M,isButtonGapEnabled:!1}),t=y({color:v,variant:b,themeMode:A});return{mainButton:{display:"flex",alignItems:"center",justifyContent:"center",whiteSpace:"nowrap",borderStartStartRadius:e.borderRadius,borderEndStartRadius:e.borderRadius,borderStartEndRadius:c?e.borderRadius:void 0,borderEndEndRadius:c?e.borderRadius:void 0,paddingInlineStart:e.paddingInlineStart,paddingInlineEnd:e.paddingInlineEnd,fontSize:e.fontSize,fontWeight:n(284371).Wy.medium,...t.default,...S},icon:{width:12,marginInlineEnd:6,fill:h(v,b,{outline:t.default.color,solid:{blue:u().oZ.white,black:u().oZ.white,orange:u().Tj.palette.orange[400]}}),...x},buttonHoveredStyle:t.hovered,buttonPressedStyle:t.pressed}}),[v,c,x,S,M,b,A]);return i?(0,p.jsx)(d().m,{renderTooltip:()=>i,render:e=>(0,p.jsxs)(o().Ay,{ref:t,style:j.mainButton,onClick:a,disabled:l,disabledFeedback:!0,hoveredStyle:j.buttonHoveredStyle,pressedStyle:j.buttonPressedStyle,...e,children:[m?m(j.icon):null,f]})}):(0,p.jsxs)(o().Ay,{ref:t,style:j.mainButton,onClick:a,disabled:l||g,disabledFeedback:!0,hoveredStyle:j.buttonHoveredStyle,pressedStyle:j.buttonPressedStyle,children:[g?(0,p.jsx)(n(98126).A,{style:{marginInlineEnd:4}}):null,m?m(j.icon):null,f]})}))),f=i.memo(i.forwardRef((function(e,t){const{disableDropdown:a,disabled:g,dropdownAriaLabel:m,dropdownTooltip:f,onDropdownClick:v,isLoading:b,size:S,color:x,variant:M}=e,A=(0,s().eP)(),j=(0,s().IS)((()=>{const e=(0,r().qq)({size:S,isButtonGapEnabled:!1}),t=y({color:x,variant:M,themeMode:A});return{dropdownButton:{display:"flex",alignItems:"center",justifyContent:"center",width:n(726637).A.isMobile?28:24,alignSelf:"stretch",borderStartEndRadius:e.borderRadius,borderEndEndRadius:e.borderRadius,boxShadow:"outline"===M||"blue"===x||"black"===x?`inset 1px 0 0 ${u().Tj.border.primaryTranslucent}`:"orange"===x?`${u().Tj.palette.orange["dark"===A?200:100]} 1px 0 0 inset`:(0,n(534177).HB)(x),...t.default},dropdownButtonIcon:{marginTop:2,fill:h(x,M,{outline:t.default.color,solid:{blue:u().oZ.white,black:u().oZ.white,orange:u().Tj.palette.orange["dark"===A?500:400]}})},buttonHoveredStyle:t.hovered,buttonPressedStyle:t.pressed}}),[x,S,M,A]),w=(0,i.useCallback)((e=>(0,p.jsx)(o().Ay,{ref:t,style:j.dropdownButton,onClick:v,disabledFeedback:!0,hoveredStyle:j.buttonHoveredStyle,pressedStyle:j.buttonPressedStyle,ariaLabel:m,...e,children:(0,p.jsx)(l().I,{icon:c().arrowChevronSingleDownFillSmallIcon,size:"sm",style:j.dropdownButtonIcon})})),[m,v,t,j.buttonHoveredStyle,j.buttonPressedStyle,j.dropdownButton,j.dropdownButtonIcon]),I=(0,i.useCallback)((()=>f),[f]);return a||g?null:f?(0,p.jsx)(d().m,{renderTooltip:I,render:w}):(0,p.jsx)(o().Ay,{ref:t,style:j.dropdownButton,onClick:v,disabledFeedback:!0,hoveredStyle:j.buttonHoveredStyle,pressedStyle:j.buttonPressedStyle,disabled:b,ariaLabel:m,children:(0,p.jsx)(l().I,{icon:c().arrowChevronSingleDownFillSmallIcon,size:"sm",style:j.dropdownButtonIcon})})})));function h(e,t,n){return"object"!=typeof n[t]?n[t]:n[t][e]}function y(e){const{color:t,variant:n,themeMode:i}=e;return{default:{background:h(t,n,{outline:void 0,solid:{blue:u().Tj.blue.background.accentPrimary,black:u().Tj.background.accentPrimary,orange:u().Tj.orange.background.secondaryTranslucent}}),color:h(t,n,{outline:{blue:u().Tj.blue.text.accentPrimary,black:u().Tj.text.primary,orange:u().Tj.orange.text.accentPrimary},solid:{blue:u().Tj.blue.text.inversePrimary,black:u().Tj.text.inversePrimary,orange:u().Tj.orange.text.accentPrimary}})},hovered:{background:h(t,n,{outline:{blue:u().Tj.blue.background.secondaryTranslucent,black:u().Tj.gray.background.secondaryTranslucent,orange:u().Tj.orange.background.secondaryTranslucent},solid:{blue:(0,a().R)({color:u().Tj.blue.background.accentPrimary,mode:i}),black:(0,a().R)({color:u().Tj.background.accentPrimary,mode:"dark"}),orange:(0,a().R)({color:u().Tj.orange.background.secondaryTranslucent,mode:i})}})},pressed:{background:h(t,n,{outline:{blue:(0,a().y)({color:u().Tj.blue.background.secondaryTranslucent,mode:i}),black:(0,a().y)({color:u().Tj.gray.background.secondaryTranslucent,mode:i}),orange:(0,a().y)({color:u().Tj.orange.background.secondaryTranslucent,mode:i})},solid:{blue:(0,a().y)({color:u().Tj.blue.background.accentPrimary,mode:i}),black:(0,a().y)({color:u().Tj.background.accentPrimary,mode:"dark"}),orange:(0,a().y)({color:u().Tj.orange.background.secondaryTranslucent,mode:i})}})}}}},435212:(e,t,n)=>{n.d(t,{Kz:()=>o,Sc:()=>a,as:()=>s});var i=()=>n(564884);function s(e,t){(0,i().u)({environment:e,event:{eventName:"open_customize_site",eventProperties:t}})}function o(e,t){(0,i().u)({environment:e,event:{eventName:"update_site_customization_settings",eventProperties:t}})}function a(e){(0,i().u)({environment:e,event:{eventName:"close_customize_site",eventProperties:{}}})}},444570:(e,t,n)=>{n.d(t,{KG:()=>u,TH:()=>c,mC:()=>p,zb:()=>g});var i=()=>n(295633),s=()=>n(700500),o=()=>n(534177),a=()=>n(120672),r=()=>n(836724),l=()=>n(52957),d=()=>n(327994);function c(e){var t,n,o;const{environment:d,store:c,selectableBoundingRect:u}=e,p=c.getType();if(!p||!(0,s().UL)(p))return(null==u?void 0:u.width)??0;const g=null===(t=c.getParentBlockStore())||void 0===t?void 0:t.getType();if("page"===g)return(0,a().y)(d);const m=null===(n=c.getRecordStoreUIParent())||void 0===n||null===(n=n.findRecordStoreUIAncestor((e=>Boolean(e instanceof i().B&&e.isPath([])&&r().T.findSelectableFromStore(e)))))||void 0===n?void 0:n.ancestor,f=m&&m instanceof i().B?r().T.findSelectableFromStore(m):void 0,h=f?null===(o=l().default.state.selectableRectMap.get(f))||void 0===o?void 0:o.width:(null==u?void 0:u.width)??0,y=g?function(e){switch(e){case"bulleted_list":case"toggle":case"to_do":case"numbered_list":return 26;case"callout":return 60;default:return 0}}(g):0;return(h??0)-y}function u(e){const{store:t,selectableBoundingRect:n,containerWidth:i}=e,a=t.getType();if(!(n&&i&&a&&(0,s().UL)(a)))return 0;const r=(e=>{const n=null===(e=t.getFormat())||void 0===e?void 0:e.block_alignment;if(!n){return t.isRootOrDirectChild()?"center":"left"}return n})();switch(r){case"right":const e=i/2;return n.width-e-e;case"center":return(n.width-i)/2;case"left":return 0;default:(0,o().HB)(r)}}function p(e){const t=e.getNode();return t?parseInt(getComputedStyle(t).marginTop):0}function g(){return d().u}},448360:(e,t,n)=>{n.d(t,{W:()=>i});const i=n(757695).Store.createValue(!1,{name:"AiPageTranslationCalloutStore"})},448924:(e,t,n)=>{n.d(t,{$:()=>s});n(296540);const i={viewBox:"0 0 16 16",fittedViewBox:"2.57 7.37 10.86 1.26",svg:(0,n(474848).jsx)("path",{d:"M3.2 7.375a.625.625 0 1 0 0 1.25h9.6a.625.625 0 0 0 0-1.25z"})},s=(0,n(340498).wt)("dashLongSmall",i,"small")},449789:(e,t,n)=>{function i(e){const{store:t,toggleSource:n}=e;t.update((e=>{const t=!e.isKeyboardShortcutsOpen;return{...e,isKeyboardShortcutsOpen:t,toggleSource:t?n:e.toggleSource,openCount:t?e.openCount+1:e.openCount}}))}function s(e){const{store:t}=e;return t.state.isKeyboardShortcutsOpen}n.d(t,{W:()=>s,j:()=>i})},455215:(e,t,n)=>{n.d(t,{A:()=>w});n(581454);var i=n(296540),s=()=>n(484714),o=()=>n(590526),a=()=>n(882722),r=()=>n(250910),l=()=>n(546926),d=()=>n(631524),c=()=>n(287188),u=()=>n(302501),p=()=>n(890492),g=()=>n(81068),m=()=>n(663639),f=()=>n(736847),h=()=>n(75756),y=()=>n(839816),v=()=>n(69708),b=()=>n(100622),S=()=>n(204077),x=()=>n(438754),M=n(474848);function A({hasDismissButton:e,onDismiss:t}){const n=(0,s().v3)(),o=(0,v().tz)(),[r,c]=(0,i.useState)(!1);(0,i.useEffect)((()=>()=>{e||r&&S().wB()}),[o,r,e]);const g=[{key:"trackingTypes",render:e=>(0,M.jsx)(f().A,{...e,topBorder:0!==e.index}),items:y().dc.map((e=>({key:e,render:t=>(0,M.jsx)(j,{menuListItemProps:t,trackingType:e,setShowReloadOnMenuClose:c,isNativeiOSApp:n.device.isMobileNative&&n.device.isIOS}),action:()=>S().Ef(n,e)})))}];return(0,M.jsxs)(p().A,{className:a().Qm5,menuType:l().gu.Popup,width:260,children:[(0,M.jsx)("div",{style:{display:"flex",alignItems:"center",paddingTop:e?4:0},children:e?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(u().A,{isSmall:!0,isMultiline:!0,style:{width:"80%",paddingInlineStart:14},children:(0,M.jsx)("b",{children:(0,M.jsx)(v().sA,{...h().LS.customizeCookiesHeader})})}),(0,M.jsx)(d().p,{style:{float:"inline-end",marginInlineStart:-8,paddingInlineStart:8,paddingInlineEnd:8,color:b().Tj.blue.text.accentPrimary},onClick:()=>{S().gz(n,x().A.getPermission()),t&&t()},children:(0,M.jsx)(v().sA,{...h().LS.cookieDismissButtonLabel})})]}):void 0}),(0,M.jsx)(m().A,{type:m().O.Vertical,initialFocus:void 0,sections:g})]})}function j(e){const{menuListItemProps:t,trackingType:n,setShowReloadOnMenuClose:i,isNativeiOSApp:a}=e,{title:r,caption:l,subtitle:d}=(0,h().ID)(n,a),[{permission:u}]=(0,o().$y)(x().A),p=(0,s().v3)();return(0,M.jsx)(g().A,{...t,title:(0,M.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,M.jsx)("div",{style:{marginInlineEnd:0},children:(0,M.jsx)(v().sA,{...r})})}),caption:(0,M.jsxs)("div",{children:[d?(0,M.jsx)("div",{children:(0,M.jsx)("span",{style:{color:b().Tj.red.text.accentPrimary},children:(0,M.jsx)(v().sA,{...d})})}):void 0,(0,M.jsx)("div",{children:(0,M.jsx)("span",{style:{color:b().Tj.text.secondary},children:(0,M.jsx)(v().sA,{...l})})})]}),shouldWrapCaption:!0,right:(0,M.jsx)("div",{style:{display:"flex",width:"100%",alignItems:"center",cursor:"pointer"},children:(0,M.jsx)(c().A,{on:u[n],disabled:"necessary"===n,onClick:()=>{i(!0),S().Ef(p,n)}})})})}const w=function({renderOrigin:e,hasDismissButton:t,onDismiss:n}){return(0,M.jsx)(r().A,{popupType:r().z.Popup,placementToOrigin:"bottom",alignmentToOrigin:"start",renderOrigin:e,render:()=>(0,M.jsx)(A,{hasDismissButton:t,onDismiss:n})})}},461232:(e,t,n)=>{n.d(t,{C:()=>x,v:()=>S});n(898992),n(354520),n(803949),n(581454);var i=()=>n(907258),s=()=>n(755531),o=()=>n(242422),a=()=>n(675133),r=()=>n(792057),l=()=>n(812174),d=()=>n(950566),c=()=>n(824862),u=()=>n(798880),p=()=>n(606219),g=()=>n(496603),m=()=>n(559926),f=()=>n(594794),h=()=>n(547149),y=()=>n(769864),v=()=>n(384944);const b=(0,n(69708).YK)({webhookUrlError:{id:"webhookActions.webhookUrlError",defaultMessage:"Connection failed. Please wait and try again or try another URL."}});async function S(e){const{environment:t,integration:n,webhookUrl:o,webhookSecret:S,webhookHeaders:x,webhookSubscriptionId:M,onError:A,onSuccess:j=(()=>{})}=e,{currentUserRootStore:w,sidebarSpaceStore:I}=i().default.state;if(!w||!I)return{error:{success:!1}};const k={};x.map((e=>{const{key:t,value:n}=e;return{key:t.trim(),value:String(n).trim()}})).filter((({key:e,value:t})=>e&&t)).forEach((({key:e,value:t})=>{k[e]=t}));const T={headers:k};if("failed"===(await y().callApi({eventName:"testWebhookConnection",environment:t,data:{integrationId:n.id,webhookUrl:o,webhookSecret:S||void 0,webhookCustomization:T,spaceId:I.id}})).type)return r().f1(a().A.formatMessage(b.webhookUrlError)),{error:{success:!1}};const{serverCommitResult:C}=h().createAndCommit({userAction:"webhookActions.createWebhookSubscription",environment:t,canUndo:!0,perform:i=>{i.postSubmitCallbacks=[A];const a=I.id;if(e.webhookSubscriptionId){const e=(0,s().S)(),a=M&&e?l().g.createChildStore(e,{id:M,table:p().TF,spaceId:e.id}):void 0;if(a){const e=a.getWebhookUrl()!==o,s=a.getWebhookSecret()!==S,r=!g().n4(a.getWebhookCustomization(),T);(e||s||r)&&(m().zW(t,{integration_id:n.id,has_updated_webhook_url:e||void 0,has_updated_webhook_secret:s||void 0}),v().zv({transaction:i,data:{webhook_url:o,webhook_secret:S,webhook_customization:T,health:{status:"active"}},store:a}))}}else{const e=(0,f().Z1)({environment:t,table:c().GP,spaceId:a});v().vt({environment:t,table:c().GP,args:{id:e,space_id:a,parent:{table:"space",id:I.id},type:"external",name:n.getName(),icon:n.getInfo().icon,integration_id:n.id,capabilities:n.getCapabilities(),createdBy:{table:u().oo,id:w.id}},inMemoryRecordCache:I.inMemoryRecordCache,transaction:i}),v().vt({environment:t,table:p().TF,args:{id:(0,f().Z1)({environment:t,spaceId:a,table:p().TF}),bot_id:e,space_id:a,parentPointer:{table:"space",id:I.id},createdByPointer:{table:u().oo,id:w.id},api_version:d().h9,webhook_url:o,webhook_secret:S,webhook_customization:T,health:{status:"active"}},inMemoryRecordCache:I.inMemoryRecordCache,transaction:i}),m().dm(t,{integration_id:n.id,configuration_type:"manual",bot_id:e})}}});return await C,j(),{value:{success:!0}}}async function x(e){const t=o().default.checkGate({gateName:"webhooks_beta"}),{environment:n,spaceId:i}=e;if(!n.currentUser.isLoggedIn()||!t)return{webhookSubscriptionIds:[],recordMap:{__version__:3}};const s=await y().callCellCompatibleApi({eventName:"getWebhookSubscriptions",environment:n,data:{spaceId:i},cellNavigation:{cellId:void 0,spaceId:i}});if("failed"===s.type)throw s.error;return s.data}},462786:(e,t,n)=>{n.d(t,{q:()=>o});n(296540);var i=n(474848);const s={viewBox:"0 0 16 16",fittedViewBox:"1.97 1.57 11.85 13.4",svg:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{d:"M13.612 1.787a.733.733 0 0 0-1.032 0l-.5.5a.075.075 0 0 0 0 .105l.932.932c.029.03.076.03.106 0l.494-.494a.1.1 0 0 0 .018-.03.734.734 0 0 0-.018-1.013m-2.03 1.103a.075.075 0 0 0-.106 0L5.748 8.608a1 1 0 0 0-.216.358l-.243.786-.001.003c-.057.214.142.431.36.355l.78-.242a.8.8 0 0 0 .363-.217l5.723-5.723a.075.075 0 0 0 0-.106z"}),(0,i.jsx)("path",{d:"M7.382 3.225a5.407 5.407 0 0 0-5.407 5.407v.206c0 1.028.304 2.033.874 2.888a7.53 7.53 0 0 0 4.438 3.128l.411.102a.625.625 0 0 0 .303-1.212l-.41-.103a6.28 6.28 0 0 1-3.702-2.608 3.96 3.96 0 0 1-.664-2.195v-.206a4.157 4.157 0 0 1 4.157-4.157h.28q.457 0 .886.089a.08.08 0 0 0 .068-.02l.897-.896a.075.075 0 0 0-.029-.124 5.7 5.7 0 0 0-1.822-.299z"}),(0,i.jsx)("path",{d:"M12.232 5.533a.075.075 0 0 0-.113-.008l-.789.788a.075.075 0 0 0-.008.096c.49.716.778 1.582.778 2.514a2.574 2.574 0 0 1-2.229 2.552l-.064.008a4.05 4.05 0 0 1-3.01-.806.08.08 0 0 0-.068-.012l-.06.018-.756.235h-.001c-.155.052-.301.07-.438.063a.075.075 0 0 0-.058.127 5.3 5.3 0 0 0 4.556 1.615l.065-.01a3.824 3.824 0 0 0 3.313-3.79 5.68 5.68 0 0 0-1.118-3.39"})]})},o=(0,n(340498).wt)("pencilAndOutlineSmall",s,"small")},464291:(e,t,n)=>{n.d(t,{p:()=>s});n(296540);const i={viewBox:"0 0 20 20",fittedViewBox:"2.37 4.12 15.25 11.75",svg:(0,n(474848).jsx)("path",{d:"M2.375 6.25c0-1.174.951-2.125 2.125-2.125h11c1.174 0 2.125.951 2.125 2.125v7.5a2.125 2.125 0 0 1-2.125 2.125h-11a2.125 2.125 0 0 1-2.125-2.125zm14 2.625h-5.75v2.25h5.75zm0 3.5h-5.75v2.25H15.5a.875.875 0 0 0 .875-.875zm-7-3.5h-5.75v2.25h5.75zm0 3.5h-5.75v1.375c0 .483.392.875.875.875h4.875z"})},s=(0,n(340498).wt)("tableHeaderRow",i,"default")},466529:(e,t,n)=>{n.r(t),n.d(t,{HorizontalTemplatePicker:()=>se});n(898992),n(823215),n(354520),n(581454);var i=n(296540),s=()=>n(135168),o=()=>n(59226),a=()=>n(242422),r=()=>n(993905),l=()=>n(726637),d=()=>n(484714),c=()=>n(792485),u=()=>n(590526),p=()=>n(401497),g=()=>n(929219),m=()=>n(675133),f=()=>n(127833),h=()=>n(30537),y=()=>n(396896),v=()=>n(807449),b=()=>n(302501),S=()=>n(663639),x=()=>n(452004),M=()=>n(575157),A=()=>n(589407),j=()=>n(120282),w=()=>n(421559),I=()=>n(340498),k=()=>n(206267),T=()=>n(826693),C=()=>n(743246),_=()=>n(69708),P=()=>n(100622),B=()=>n(534177),R=()=>n(160568),D=()=>n(177163),L=()=>n(732067),E=()=>n(716776),O=()=>n(387226),N=()=>n(896464),F=()=>n(226916),U=()=>n(264699),z=()=>n(630223),K=()=>n(854513),V=()=>n(192359),q=()=>n(249696),W=()=>n(68465),G=()=>n(478726),H=()=>n(443002),Y=()=>n(806638),$=()=>n(58180),Q=()=>n(957763),Z=()=>n(891360),X=()=>n(547149),J=()=>n(839754),ee=()=>n(922952),te=()=>n(239924),ne=n(474848);const ie=8;function se(e){const{store:t,context:n,menuListStore:o,editorWidth:l}=e,[x]=(0,i.useState)((()=>(0,k().JW)())),se=re(),ce=(0,G().L5)(n),ue=(0,p().IS)((()=>({root:{background:ce?P().Tj.background.elevated:P().Tj.background.primary,paddingBottom:"min(48px, 5vh)",pointerEvents:"all"},pillContainer:{cursor:"pointer",display:"flex",justifyContent:"flex-start"},menu:{maxWidth:l}})),[ce,l]),[pe,ge]=function(e){const{store:t}=e,n=(0,d().v3)(),i=(0,u().K8)((()=>"editor"===t.getRole()),[t]),s=(0,u().K8)((()=>{if(!n.currentUser.id)return!1;const e=t.getSpaceStore();if(!e)return!1;const i=H().H({spaceStore:e,userId:n.currentUser.id,environment:n});return(0,$().E)(t,i)}),[t,n]),o=(0,u().K8)((()=>t.getParentTable()===C().C0),[t]),r={name:(0,_().tz)().formatMessage(ae.tableTemplateTitle),type:"database",iconFn:w().T,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>{const n=t.getParentStore();n&&(0,ee().u)(n)&&(0,te().openTemplateOnboardingModal)({parentStore:n,template:void 0,version:(0,te().getTemplateOnboardingVersion)({template:void 0}),origin:"new_page_pills",navigateToOnFinish:"created_collection",onClose:n=>{(0,J()._M)({environment:e,newPageStore:t,result:n})}})}},l=function(e){const{environment:t,store:n}=e,i=(0,_().tz)(),s=(0,c().S)(),o=(0,u().K8)((()=>null==s?void 0:s.publicEditModeStore.state),[null==s?void 0:s.publicEditModeStore]),r=(0,u().K8)((()=>(0,W().ZE)(o,n)),[o,n]);return{name:(0,u().K8)((()=>"on"===a().default.getEligibleGroup({experimentId:"research_mode_empty_page_entrypoint",defaultGroup:"control"})),[])?i.formatMessage(ae.writeWithAi):i.formatMessage(ae.askAi),type:"ai",iconFn:e=>(0,ne.jsx)(L().UY,{}),shouldShow:()=>r,onClick:()=>{X().createAndCommit({userAction:"HorizontalTemplatePicker.genericHelpMeWriteNewPageWithAI",environment:t,canUndo:!0,perform:e=>{E().n({environment:t,store:n,transaction:e,preventTextSelection:!1,onTextSelection(){(0,D().openHelpMeWriteGenericPopup)({environment:t,title:""})}})}})}}}({environment:n,store:t}),p=function(){const e=(0,_().tz)(),t=(0,q().W)(),n=(0,u().K8)((()=>{const e=Z().W.state;return(0,V().vz)(e)}),[]);return{name:e.formatMessage(n),type:"transcription",iconFn:e=>(0,ne.jsx)(v().I,{icon:j().a,colorVariant:"primary",style:{...e}}),shouldShow:()=>t,onClick:async e=>{(await K().$.load()).appendTranscriptionBlockToPage({environment:e})}}}(),g=function(e){const t=(0,d().v3)();return{name:(0,_().tz)().formatMessage(ae.formTemplateTitle),type:"quick-form",iconFn:M().D,shouldShow:()=>!0,onClick:async()=>{await(0,F().t)({environment:t,store:e})}}}(t),f=function(e){const{isTablet:t}=(0,d().Y0)();return{name:m().A.formatMessage(O().KQ.templates),type:"templates",iconFn:e=>(0,T().notionTemplateIcon)(e),shouldShow:()=>!t,onClick:e=>{(0,Y().P)({environment:e})}}}(),h=[...o?[]:[l],p,r,...i&&!s?[g]:[],...s?[]:[f]].filter((e=>e.shouldShow(n))),y=[...U()._,le,O().zD];return[h,y]}({store:t}),[me,fe]=function(e){const{store:t,editorWidth:n,initialVisible:o,initialOverflow:a,eventId:r}=e,l=(0,d().v3)(),c=(0,_().tz)(),u=re(),g=(0,p().IS)((()=>({icon:{width:I().Ev.default,height:I().Ev.default,fill:P().Tj.icon.primary}})),[]),[m,y]=i.useState(void 0),[S,x]=i.useState([]),[M,j]=i.useState(void 0),[w,k]=i.useState(o.length);(0,i.useEffect)((()=>{if(!(n&&S.every(B().O9)&&M))return;let e=0,t=0;for(;t<o.length&&(e+=S[t]+ie,!(e+M>n+24));)t++;k(t)}),[S,n,o.length,M]);const T=o.slice(0,w).map(((e,n)=>{const i={key:"ai-skill"===e.type?`${e.type}-${n}`:e.type,render:({ref:i,...s})=>{var o;const a=i=>{var o;s.onMouseEnter(i),null===(o=e.onMouseEnter)||void 0===o||o.call(e,l,t),y(n)},r=n=>{var i;null===(i=e.onMouseLeave)||void 0===i||i.call(e,l,t),y(void 0)};return(0,ne.jsx)(z().E,{onSizeChange:e=>{if(S[n]===e.width)return;const t=[...S];t[n]=e.width,x(t)},children:(0,ne.jsx)("div",{children:(0,ne.jsx)(N().J,{...s,focused:m===n,format:"horizontal-new-page",title:(0,ne.jsx)(b().A,{children:e.name}),type:e.type,icon:null===(o=e.iconFn)||void 0===o?void 0:o.call(e,g.icon),onMouseEnter:a,onMouseLeave:r,locked:!1})})})},action:n=>{(0,Q().E)(l,(0,s().f)(t))&&(R().ki(l,{is_keyboard:"keydown"===n.event.type,from:"horizontal_template_picker",template_type:e.type,event_id:r}),e.onClick(l,t))}};return i})),[C,D]=i.useState(!1),L=w,E={key:"more",render:({ref:e,...n})=>(0,ne.jsx)(f().zD,{origin:(0,ne.jsx)(z().E,{onSizeChange:e=>j(e.width),children:(0,ne.jsx)("div",{children:(0,ne.jsx)(N().J,{...n,focused:m===L,onMouseEnter:e=>{y(L)},onMouseLeave:e=>{y(void 0)},format:"horizontal-new-page",title:u?null:(0,ne.jsx)(b().A,{children:c.formatMessage(ae.more)}),type:"more",icon:(0,ne.jsx)(v().I,{icon:A().ellipsisIcon,colorVariant:"secondary"}),locked:!1})})}),alignmentToOrigin:"start",placementToOrigin:"top",originGap:4,open:C,popupType:h().n.Popup,onDismiss:()=>D(!1),render:()=>(0,ne.jsx)(de,{store:t,items:[...o.slice(w),...a],eventId:r})}),action:e=>{R().ki(l,{is_keyboard:"keydown"===e.event.type,from:"horizontal_template_picker",template_type:"more",event_id:r}),D(!0)}};return[T,E]}({store:t,editorWidth:l,initialVisible:pe,initialOverflow:ge,eventId:x});return!(0,u().O$)(g().e)?null:(0,ne.jsx)(r().s,{allowSelectionWithin:!1,children:(0,ne.jsx)(S().A,{type:S().O.Horizontal,store:o,initialFocus:void 0,style:ue.menu,disableInitialScroll:!0,disableCommandEnter:!0,isEnterOnHoverEmpty:!0,disableKeyboard:!0,sections:[{key:"Get started",render:e=>(0,ne.jsxs)(ne.Fragment,{children:[(0,ne.jsx)(oe,{isInPeekView:ce}),(0,ne.jsx)("div",{style:ue.root,children:(0,ne.jsxs)(y().VP,{gap:12,children:[(0,ne.jsx)(b().A,{isSmall:!0,isSecondaryColor:!0,style:{fontWeight:500,paddingInlineStart:10},children:se?(0,ne.jsx)(_().sA,{defaultMessage:"Get started with",id:"PageEditor.horizontalTemplatePicker.getStarted.label.new"}):(0,ne.jsx)(_().sA,{defaultMessage:"Get started",id:"PageEditor.horizontalTemplatePicker.getStarted.label"})}),(0,ne.jsx)("div",{style:ue.pillContainer,children:(0,ne.jsx)(y().fI,{gap:ie,children:e.children})})]},e.key)})]}),items:[...me,fe]}]})})}function oe(e){const t=(0,p().IS)((()=>({fade:{background:`linear-gradient(0deg, ${e.isInPeekView?P().Tj.background.elevated:P().Tj.background.primary} 0%, ${P().Tj.contentBackgroundTransparent} 100%)`,height:140,width:"100%"}})),[e.isInPeekView]);return(0,ne.jsx)("div",{style:t.fade})}const ae=(0,_().YK)({askAi:{defaultMessage:"Ask AI",id:"newpage.templates.writeWithAiCondensed"},writeWithAi:{defaultMessage:"Write",id:"newpage.templates.writeWithAi"},more:{defaultMessage:"More",id:"newpage.templates.more"},tableTemplateTitle:{defaultMessage:"Database",id:"newpage.templates.table"},formTemplateTitle:{defaultMessage:"Form",id:"newpage.templates.form"}});function re(){const{isTablet:e}=(0,d().Y0)(),t=(0,o().X)("tablet_refresh_template_pills_gate");return!(!e||!t)||!l().A.isMobile}const le={name:"",type:"divider",iconFn:e=>null,shouldShow:()=>!0,onClick:()=>{}};function de(e){const{store:t,items:n,eventId:o}=e,a=(0,d().v3)(),r=(0,i.useMemo)((()=>new(x().$)),[]),l=(0,p().IS)((()=>({menu:{width:200,cursor:"pointer",padding:"6px 4px"},icon:{width:I().Ev.default,fill:P().Tj.icon.primary},divider:{height:1,background:P().Tj.border.primary,margin:"6px -6px"}})),[]),c=n.filter((e=>e.shouldShow(a))).map((e=>{const n={key:e.name,render:({ref:t,...n})=>{var i;return"divider"===e.type?(0,ne.jsx)("div",{style:l.divider}):(0,ne.jsx)(N().J,{...n,format:"horizontal-new-page-submenu",title:(0,ne.jsx)(b().A,{children:e.name}),type:e.type,icon:null===(i=e.iconFn)||void 0===i?void 0:i.call(e,l.icon),locked:!1})},action:n=>{(0,Q().E)(a,(0,s().f)(t))&&(R().ki(a,{is_keyboard:"keydown"===n.event.type,from:"horizontal_template_picker",template_type:e.type,event_id:o}),e.onClick(a,t))}};return n}));return(0,ne.jsx)(S().A,{type:S().O.Vertical,store:r,initialFocus:void 0,disableInitialScroll:!0,disableCommandEnter:!0,isEnterOnHoverEmpty:!0,disableKeyboard:!0,sections:[{key:"Items",render:e=>(0,ne.jsx)("div",{style:l.menu,children:(0,ne.jsx)(y().VP,{children:e.children},e.key)}),items:c}]})}},473119:(e,t,n)=>{n.d(t,{c:()=>o});n(296540);var i=n(474848);const s={viewBox:"0 0 16 16",svg:()=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("circle",{cx:"8",cy:"8",r:"8",fill:"none",stroke:"currentColor",children:[(0,i.jsx)("animate",{attributeName:"r",from:"3",to:"8",dur:"1s",begin:"0s",repeatCount:"indefinite"}),(0,i.jsx)("animate",{attributeName:"opacity",from:"1",to:"0",dur:"1s",begin:"0s",repeatCount:"indefinite"})]}),(0,i.jsx)("circle",{cx:"8",cy:"8",r:"3",fill:"currentColor"})]})},o=(0,n(504900).p)("pulsingDotAnimated",s)},476197:(e,t,n)=>{n.d(t,{c:()=>u,u:()=>g});var i=n(296540),s=()=>n(300474),o=()=>n(484714),a=()=>n(590526),r=()=>n(300789),l=()=>n(999544),d=()=>n(292395),c=()=>n(685377);function u(){const e=(0,o().v3)(),t=g();return(0,i.useEffect)((()=>{if(void 0!==t)if(t>=1)r().$j(e,"ai_usage_notification_limit_reached",{skipDefaultRules:["FrequencyCapRule","MinimumAccountAgeRule"]});else{if(t>=d().SK)return p(e,"ai_usage_notification_limit_reached"),void r().$j(e,"ai_usage_notification_limit_warning",{skipDefaultRules:["FrequencyCapRule","MinimumAccountAgeRule"]});l().Xh("ai_usage_notification_limit_warning")&&p(e,"ai_usage_notification_limit_warning"),l().Xh("ai_usage_notification_limit_reached")&&p(e,"ai_usage_notification_limit_reached")}}),[e,t]),null}function p(e,t){r().X3(e,t),l().nS(e,t)}function g(){const e=(0,o().v3)(),t=(0,s().r)();return(0,a().K8)((()=>{if(!t)return;const n=c().y.getData(e,{spaceId:t});return(0,d().gY)(n)}),[e,t])}},479554:(e,t,n)=>{n.d(t,{F:()=>a});var i=()=>n(41174),s=()=>n(384944),o=()=>n(547149);function a(e){const{environment:t,collectionViewStore:n,collectionPointerToAdd:a}=e,r=n.getCollectionSource();if(!r||"typed"!==r.type)return;const l=r.aggregatedCollections?(0,i()._E)(r.aggregatedCollections):[];if(l.length>=i().mB)return;const d=[...l,{collectionPointer:a}],c=n.getFormatStore().getKeyStore("collection_view_source");o().createAndCommit({userAction:"addAggregatedCollection",environment:t,canUndo:!0,perform:e=>{s().KY({store:c,transaction:e,value:{...r,aggregatedCollections:d}})}})}},481411:(e,t,n)=>{n.d(t,{k:()=>o});const i=["topbar_more_button","available_offline_item"];class s extends(()=>n(757695))().Store{getInitialState(){return{currentStep:i[0],numSteps:i.length}}nextStep(){const e=i.indexOf(this.state.currentStep);e>=this.state.numSteps-1||this.setState({...this.state,currentStep:i[e+1]})}reset(){super.reset()}}const o=new s},483461:(e,t,n)=>{n.d(t,{S:()=>s});var i=()=>n(457419);function s(e){return e.isType("page")&&!(0,i().S)(e)&&!e.isCollectionView()&&!e.isInsideCollection()&&!e.isAssociatedCollectionAPageTree()&&e.canAdmin()}},485253:(e,t,n)=>{n.r(t),n.d(t,{MobilePageUpdatesMenuRenderer:()=>x});var i=n(296540),s=()=>n(726637),o=()=>n(590526),a=()=>n(245720),r=()=>n(127833),l=()=>n(546926),d=()=>n(890492),c=()=>n(69708),u=()=>n(102727),p=(n(581454),()=>n(907258)),g=()=>n(401497),m=()=>n(100622),f=()=>n(753397),h=()=>n(187959),y=()=>n(914795),v=()=>n(792526),b=n(474848);function S(){const e=(0,i.useCallback)((()=>(0,b.jsx)(v().A,{message:(0,b.jsx)(c().sA,{defaultMessage:"Any changes to this page will show up here.",id:"updatesModal.currentPageTab.emptyPrompt"}),title:(0,b.jsx)(c().sA,{defaultMessage:"No page updates",id:"updatesModal.currentPageTab.emptyPromptTitle"})})),[]),t=(0,o().O$)(p().AppStoreSidebarSpaceStore),n=(0,o().O$)(p().AppStoreMainEditorCurrentBlockStore),s=(0,o().K8)((()=>{var e;const t=null==n||null===(e=n.getCollectionPointers())||void 0===e?void 0:e.map((e=>e.id)),i=null==n?void 0:n.isCollectionView();return null!=n&&n.isDefined()?{id:n.id,isCollection:i,collectionIds:t}:void 0}),[n]),a=(0,g().IS)((()=>({getNotifiedFor:{padding:18,backgroundColor:m().Tj.background.secondary}})),[]);return t&&s&&n?(0,b.jsxs)("div",{children:[(0,b.jsx)(f().QB,{navigableBlockStore:n,from:"page_updates",buttonPopupStore:h().A,style:a.getNotifiedFor}),(0,b.jsx)(y().A,{navigableBlockStore:n,collectionIds:s.collectionIds,spaceId:t.id,empty:e,source:"updates_sidebar"},"current-page")]}):null}function x(e){const t=(0,o().K8)((()=>u().A.state.open),[]),n=(0,i.useCallback)((()=>{u().A.setState({open:!1})}),[]);return s().A.isMobile?(0,b.jsx)(r().zD,{popupType:r().nl.BottomSheet,bottomSheetInitialState:"full",trapFocus:!0,open:t,render:()=>(0,b.jsx)(M,{onClose:n}),onDismiss:n}):null}function M(e){const{onClose:t}=e,n={menuType:l().gu.Modal,title:(0,b.jsx)(c().sA,{defaultMessage:"Page Updates",id:"pageUpdatesModal.mobileMenu.title"}),right:(0,b.jsx)(c().sA,{...a().W.done}),onClickRight:t};return(0,b.jsx)(d().A,{...n,children:(0,b.jsx)(S,{})})}},487443:(e,t,n)=>{n.r(t),n.d(t,{TeamPermissionsInviteWithModal:()=>l});n(296540);var i=()=>n(590526),s=()=>n(401497),o=()=>n(433876),a=()=>n(284331),r=n(474848);function l({teamStore:e,permissionsInviteStore:t,origin:n}){const l=(0,i().K8)((()=>t.state.modalOpen),[t]),d=()=>{t.reset()},c=(0,s().IS)((()=>({modal:{alignSelf:"center",overflow:"visible",top:0,width:500},overlay:{display:"flex",flexDirection:"column",alignItems:"end",padding:22}})),[]);return(0,r.jsx)(o().A,{modalStyle:c.modal,open:l,onDismiss:d,renderContent:()=>(0,r.jsx)("div",{style:c.overlay,children:(0,r.jsx)(a().A,{teamStore:e,permissionsInviteStore:t,isNewlyCreatedTeam:!1,onSubmitSuccessful:d,onDismiss:d})}),origin:n})}},498002:(e,t,n)=>{n.d(t,{zk:()=>O,wm:()=>L,Js:()=>F,H0:()=>z,hk:()=>K});n(296540);var i=()=>n(907258),s=()=>n(483226),o=()=>n(3284),a=()=>n(201980),r=()=>n(69708),l=()=>n(67103),d=()=>n(383036),c=()=>n(401497),u=()=>n(26697),p=()=>n(575143),g=()=>n(515918),m=n(474848);function f({menuListItemProps:e,title:t,caption:n,icon:i,disabled:s,tooltipText:o,showNewBadge:a}){const r=(0,c().IS)((()=>({menuItem:{WebkitBackfaceVisibility:"hidden"},caption:{whiteSpace:"pre-wrap"},badgeWrapper:{marginInlineStart:6}})),[]);return(0,m.jsx)(u().m,{placement:"right",disableTooltip:!o,renderTooltip:()=>o,render:o=>(0,m.jsx)(p().A,{...(0,d().A)(e,o),style:r.menuItem,title:t,caption:n,captionStyle:n?r.caption:void 0,svg:i,disabled:s,disabledFeedback:s,right:a&&(0,m.jsx)("div",{style:r.badgeWrapper,children:(0,m.jsx)(g().A,{})})})})}var h=()=>n(574357),y=()=>n(10462),v=()=>n(339425),b=()=>n(440902),S=()=>n(598101),x=()=>n(957606),M=()=>n(797942),A=()=>n(182106),j=()=>n(723085),w=()=>n(854150);function I(e){if(!e)return;const t=e.getParentPointer(),n=e.getRecordStoreUIParent();return(null==t?void 0:t.table)===w().yK&&n?j().h.createChildStore(n,t):I(e.getParentBlockStore())}var k=()=>n(370907);function T(e){return function(e){const{environment:t,blocks:n,pageContext:s}=e;if(!(0,k().y)(e))return!1;if(!M().w8({environment:t,blocks:n,pageContext:s}))return!1;const o=t.currentUser.id,{sidebarSpaceStore:a}=i().default.state;if(!o||null==a||!a.isDefined())return!1;if(!(0,x().sx)({environment:t,spaceStore:a}))return!1;for(const i of n){var r;if(!i.isPageBlock())return!1;if("team"!==(null===(r=A().A.findOutlinerItemFromStore(i))||void 0===r?void 0:r.type))return!1;const e=I(i);if(null==e||!e.canAdmin())return!1}return!0}(e)&&(0,n(730107).I)()}n(18107),n(967357);function C(e){if(!(0,b().v)(e))return!1;const t=e.blocks.at(0);return!!t&&(0,n(483461).S)(t)}var _=()=>n(547149),P=()=>n(267271),B=()=>n(843005);const R=(0,r().YK)({createTeamFromPageFullName:{id:"action.createTeamFromPage.fullName",defaultMessage:"Turn into teamspace"},createTeamFromPageCaption:{id:"action.createTeamFromPage.caption",defaultMessage:"Space for your team to customize permissions and collaborate"},createTeamFromPageName:{id:"action.createTeamFromPage.name",defaultMessage:"Teamspace"},turnPageIntoWikiCaption:{id:"action.turnPageIntoWiki.caption",defaultMessage:"Organize by owner, tags, verification, and more"},turnPageIntoWikiName:{id:"action.turnPageIntoWiki.name",defaultMessage:"Wiki"},undoTurnPageIntoWikiName:{id:"action.undoTurnPageIntoWiki.name",defaultMessage:"Undo wiki"},turnPageIntoWikiFullName:{id:"action.turnPageIntoWiki.fullName",defaultMessage:"Turn into wiki"}});function D(e,t){return(0,P().Ls)({key:"turn page into team",displayName:t,analyticsName:R.createTeamFromPageFullName.defaultMessage,svg:o().arrowSquarePathUpDownIcon,validators:e,closeParentMenu:!0,render:(e,i)=>{const o=function(e){const{blockStore:t,environment:n}=e;if(!n.currentUser.id)return null;if(0===a().q4_(t.getTitleValue()).length)return(0,m.jsx)(r().sA,{defaultMessage:"Cannot turn page without a title into a Teamspace",id:"sidebar.turnPageIntoTeamButton.missingTitleDisabledTooltip"});if("private"===(0,x().UY)(t).accessLevel&&!(0,s().HO)())return(0,m.jsx)(r().sA,{defaultMessage:"Only Business Plans and above can turn a private page into a Teamspace",id:"sidebar.turnPageIntoTeamButton.privateTeamsOnlyOnBusinessPlansAndAboveDisabledTooltip"});return null}({environment:i.environment,blockStore:i.blocks[0]});return(0,m.jsx)(f,{menuListItemProps:e,title:(0,m.jsx)(r().sA,{...t}),caption:(0,m.jsx)(r().sA,{...R.createTeamFromPageCaption}),disabled:Boolean(o),tooltipText:o,icon:n(737693).V})},action:({blocks:e,environment:t})=>{const i=e[0];n(475355).Vs({environment:t,page:i})}})}const L=D([(0,h().U)([T,(0,S().A)(C)])],R.createTeamFromPageFullName),E=D([T],R.createTeamFromPageName),O=(0,n(12956).u)({key:"turn into teamspace or wiki",displayName:B().DZ.turnIntoSection,analyticsName:B().DZ.turnIntoSection.defaultMessage,svg:o().arrowSquarePathUpDownIcon,validators:[T,C],subActions:()=>[(0,P().gy)({key:"turn into teamspace or wiki",render:e=>(0,m.jsx)(n(736847).A,{...e}),actions:[E,U]})],width:300});function N(e,t){return(0,P().Ls)({key:"turn page into wiki",displayName:t,analyticsName:R.turnPageIntoWikiFullName.defaultMessage,svg:o().arrowSquarePathUpDownIcon,validators:e,closeParentMenu:!0,action:({environment:e,blocks:t})=>{var s;const o=n(242422).default.getEligibleGroup({experimentId:"wiki_education_convert_modal",defaultGroup:"control"}),a=!0===(null===(s=i().default.state.currentUserSettingsStore)||void 0===s||null===(s=s.getSettings())||void 0===s?void 0:s.seen_targeted_wiki_prompt);"bottom_right"!==o||a?_().createAndCommit({userAction:"actionRegistry.turnIntoAction.wiki",environment:e,canUndo:!0,perform:n=>{l().hJ({environment:e,blocks:t,transaction:n,source:"page_menu"})}}):n(816013).r.setState({showConvertTooltip:!1,forceShow:!0,pendingWikiBlockStore:t[0]})},render:e=>{const i=!n(929219).A.state.online;return(0,m.jsx)(f,{menuListItemProps:e,title:(0,m.jsx)(r().sA,{...t}),disabled:i,icon:o().arrowSquarePathUpDownIcon,tooltipText:i?(0,m.jsx)(r().sA,{...P().AY.unavailableOfflineTooltip}):(0,m.jsx)(r().sA,{...R.turnPageIntoWikiCaption})})}})}const F=N([(0,h().U)([C,(0,S().A)(T)]),(0,S().A)(v().o)],R.turnPageIntoWikiFullName),U=N([C],R.turnPageIntoWikiName);const z=N([C,(0,S().A)(v().o),(0,S().A)(y().Z)],R.turnPageIntoWikiFullName),K=(0,P().Ls)({key:"undo turn page into wiki",displayName:R.undoTurnPageIntoWikiName,analyticsName:R.undoTurnPageIntoWikiName.defaultMessage,svg:n(454503).arrowUTurnUpLeftIcon,validators:[b().v,n(730580).V,(0,S().A)(n(606376).l),n(460995).A,n(77295).K,(0,S().A)(v().o),(0,S().A)(y().Z)],closeParentMenu:!0,action:async({environment:e,blocks:t})=>{const{accept:i}=await n(792057).Gh({message:(0,m.jsx)("div",{style:{textAlign:"center"},children:(0,m.jsx)(r().sA,{defaultMessage:"Turn “{pageName}” back into a normal page?",id:"action.undoTurnIntoWiki.message",values:{pageName:a().q4_(t[0].getTitleValue())}})}),description:(0,m.jsx)("div",{style:{textAlign:"center"},children:(0,m.jsx)(r().sA,{defaultMessage:"This will remove properties like owners and verification from your pages",id:"action.undoTurnIntoWiki.description"})})});i&&_().createAndCommit({userAction:"actionRegistry.undoTurnIntoAction.wiki",environment:e,canUndo:!0,isUndoTransaction:!0,perform:n=>{l().nQ({environment:e,blocks:t,transaction:n,source:"page_menu"})}})}})},500844:(e,t,n)=>{n.r(t),n.d(t,{TeamPermissionsInvite:()=>z});n(898992),n(354520),n(581454),n(737550);var i=n(296540),s=()=>n(664594),o=()=>n(135168),a=()=>n(484714),r=()=>n(590526),l=()=>n(401497),d=()=>n(278729),c=()=>n(546926),u=()=>n(352321),p=()=>n(890492),g=()=>n(842599),m=()=>n(187174),f=()=>n(259524),h=()=>n(848538),y=()=>n(69708),v=()=>n(100622),b=()=>n(542056),S=()=>n(897537),x=()=>n(417555),M=()=>n(47373),A=()=>n(743260),j=()=>n(957606),w=()=>n(205618),I=()=>n(224701),k=()=>n(907258),T=()=>n(726637),C=()=>n(250910),_=()=>n(631524),P=()=>n(26697),B=()=>n(81068),R=()=>n(663639),D=()=>n(736847),L=()=>n(854705),E=()=>n(496603),O=()=>n(308228),N=()=>n(43450),F=n(474848);function U(e){const{selectedRole:t,allRoles:n,onChange:i,teamStore:s,labelStyle:o,isRoleForRestrictedMember:a}=e,l=(0,N().R)(s),d=(0,r().K8)((()=>{const{sidebarSpaceStore:e}=k().default.state;return null==e?void 0:e.canEditMembership()}),[]),u=(0,r().K8)((()=>s.isDefault()),[s]),g=(0,r().K8)((()=>(0,j().TI)()),[]);return(0,F.jsx)(C().A,{popupType:T().A.isMobile?C().z.SlideUp:C().z.Popup,renderOrigin:e=>(0,F.jsx)(_().p,{style:o,iconTrailing:{icon:L().arrowChevronSingleDownFillSmallIcon,size:"xs",colorVariant:"tertiary"},...e,children:(0,F.jsx)(y().sA,{...j().Y7[t].label})}),placementToOrigin:"bottom",render:e=>{const s=[{key:"roles",render:e=>(0,F.jsx)(D().A,{...e,topBorder:0!==e.index}),items:n.map((n=>{const{isDisabled:s,disabledReason:o}=(0,O().m)({role:n,isCurrentUserTeamOwner:Boolean(l),userIsSpaceAdmin:Boolean(d),isDefaultTeam:u,isRoleForRestrictedMember:a,canRMsBeTeamOwners:g}),r={key:n,render:e=>(0,F.jsx)(P().m,{disableTooltip:!s,placement:"right",textWrap:!0,renderTooltip:()=>o,render:i=>(0,F.jsx)("span",{...i,children:(0,F.jsx)(B().A,{...e,isChecked:E().n4(n,t),disabled:s,disabledFeedback:s,title:(0,F.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,F.jsx)(y().sA,{...j().Y7[n].label})}),caption:(0,F.jsx)("span",{style:{color:v().Tj.text.secondary},children:(0,F.jsx)(y().sA,{...j().Y7[n].caption})}),shouldWrapCaption:!0})})}),action:()=>{i(n),e.close()}};return r}))}];let o;return o=T().A.isMobile?{menuType:c().gu.Modal,title:(0,F.jsx)(y().sA,{id:"teamPermissionsMenu.mobile.title",defaultMessage:"Select teamspace role"}),right:(0,F.jsx)(y().sA,{id:"teamPermissionsMenu.mobile.doneButton.label",defaultMessage:"Done"}),onClickRight:e.close}:{menuType:c().gu.Popup,width:264},(0,F.jsx)(p().A,{...o,children:(0,F.jsx)(R().A,{type:R().O.Vertical,initialFocus:void 0,sections:s})})}})}function z(e){const{teamStore:t,onEmptySubmit:n}=e,i=(0,a().v3)();(0,m().Yb)((async()=>{await I().x(i)}),[]);const s=(0,r().uB)(e.permissionsInviteStore,w().A),o=(0,r().K8)((()=>Boolean(s.state.isFocused)),[s]),d=(0,r().K8)((()=>s.state.tokenQuery),[s]),u=o&&d.length>0,g=(0,l().IS)((()=>({permissionsInviteSearchRequest:{position:"absolute",width:"100%",borderRadius:4,backgroundColor:v().Tj.background.primary,boxShadow:v().Tj.shadowLG,marginTop:4},scroller:{zIndex:1}})),[]);function f(e){s.setState({...s.state,isFocused:e})}return(0,F.jsx)("div",{onFocus:()=>f(!0),onBlur:()=>f(!1),children:(0,F.jsx)(p().A,{menuType:c().gu.Popup,header:(0,F.jsx)(K,{teamStore:t,permissionsInviteStore:s,setFocus:f,onEmptySubmit:n}),scrollerStyle:g.scroller,width:"100%",tokenInputHeader:!1,disableScroller:!0,children:u?(0,F.jsx)("div",{style:g.permissionsInviteSearchRequest,children:(0,F.jsx)(S().A,{permissionsInviteStore:s,store:t,shouldShowGroups:!0,sectionRenderLimit:10,membersOnly:!1,disableInvitedUsers:!0})}):void 0})})}function K(e){const{teamStore:t,permissionsInviteStore:n,onEmptySubmit:o,setFocus:c}=e,p=(0,y().tz)(),m=(0,a().v3)(),S=(0,s().T)(),x=(0,i.useRef)(null),M=(0,r().K8)((()=>Boolean(n.state.isFocused)),[n]),j=(0,r().K8)((()=>n.state.tokenQuery),[n]),w=(0,r().K8)((()=>n.state.inviteTargets),[n]),I=(0,r().K8)((()=>{if(t.getDisableRestrictedMembers())return!0;const e=t.getSpaceStore();if(!e||!S)return!0;const n=d().V.createChildStore(e,(0,h().i1)({userId:S,spaceId:e.id})),i=null==n?void 0:n.getMembershipType();return!i||!(0,f()._X)({roleThatCanAddRestrictedMembersToTeamspaces:e.getSetting("roles_that_can_add_restricted_members_to_teamspaces"),spaceUserRole:i,isTeamOwner:t.canAdmin()})}),[t,S]),k=(0,l().IS)((()=>({inputTokenVerticalMargin:{marginTop:3,marginBottom:3},tokenMenuItem:{alignItems:"unset",borderRadius:4,paddingTop:5,paddingBottom:5,paddingInlineStart:8,paddingInlineEnd:5,boxShadow:M?v().Tj.buttonBlueFocusRing:v().Tj.inputBoxShadow,maxHeight:"40vh"},inputDiv:{marginBottom:0}})),[M]);function T(e){const t=n.state.inviteTargets.filter((t=>t!==e));n.setState({...n.state,inviteTargets:t})}const C=w.map((e=>{const t="newUser"===e.type?e.value.email:`${e.type}-${e.value.id}`;return(0,F.jsx)(V,{target:e,restrictedMembersDisabled:I,onClickRemove:T},t)}));return(0,F.jsx)(u().Ay,{ref:x,focus:M,onClick:()=>c(!0),format:u().le.Share,value:j,onChange:async e=>{await async function(e){const{environment:t,permissionsInviteStore:n,event:i,setFocus:s,inputRef:o}=e,a=i.target.value,{extractedEmails:r,newInputValue:l}=(0,g().Ct)(a),d=await b().Ah(t,r),c=d.filter((e=>!(0,A().mQ)({target:e,permissionsInviteStore:n}))),u=[...n.state.inviteTargets,...c];if(n.setState({...n.state,inviteTargets:u,tokenQuery:l}),u.length>0){if(!l){const e=o.current;e&&(e.value="")}s(!(c.length>0))}}({environment:m,event:e,permissionsInviteStore:n,setFocus:c,inputRef:x})},onEmptySubmit:o,type:"email",placeholder:p.formatMessage({id:"teamPermissionsInvite.searchInput.placeholder",defaultMessage:"Search people or groups"}),tokens:C,tokenWrapStyle:{gap:4},onRemoveLastToken:function(){const e=n.state;n.setState({...e,inviteTargets:e.inviteTargets.slice(0,-1)})},focusAfterAnimation:!0,right:(0,F.jsx)(q,{teamStore:t,permissionsInviteStore:n}),style:k.tokenMenuItem,inputStyle:k.inputTokenVerticalMargin,inputDivStyle:k.inputDiv,inputFullWidth:!0})}function V(e){const{target:t,restrictedMembersDisabled:n,onClickRemove:i}=e,s=(0,l().IS)((()=>({yellowToken:{backgroundColor:v().Tj.yellow.background.secondaryTranslucent},redToken:{backgroundColor:v().Tj.red.background.secondaryTranslucent},inputTokenVerticalMargin:{marginTop:3,marginBottom:3}})),[]),o=(0,r().K8)((()=>(0,A().yi)(t)?s.yellowToken.backgroundColor:(0,A().dV)(t)&&n?s.redToken.backgroundColor:void 0),[t,s,n]);return(0,F.jsx)(x().A,{target:t,onClickRemove:i,shouldWrap:!0,style:s.inputTokenVerticalMargin,backgroundColor:o})}function q(e){const{teamStore:t,permissionsInviteStore:n}=e,i=(0,r().K8)((()=>{const e=(0,o().f)(t);return!(null!=e&&e.getDisableTeamGuests())&&(0,M().Qd)()}),[t]),s=(0,r().K8)((()=>n.state.inviteRole),[n]),a=(0,r().K8)((()=>n.state.inviteTargets.some((e=>(0,A().dV)(e)))),[n]),d=(0,l().IS)((()=>({teamRoleLabel:{marginTop:3,marginBottom:3,marginInlineStart:5}})),[]);function c(e){n.setState({...n.state,inviteRole:e})}return i?(0,F.jsx)(U,{teamStore:t,selectedRole:s,allRoles:j().vm,onChange:c,labelStyle:d.teamRoleLabel,isRoleForRestrictedMember:a}):(0,F.jsx)(U,{teamStore:t,selectedRole:s,allRoles:j().H1,onChange:c,labelStyle:d.teamRoleLabel,isRoleForRestrictedMember:a})}},514799:(e,t,n)=>{n.d(t,{H:()=>r});var i=()=>n(484714),s=()=>n(590526),o=()=>n(185078),a=()=>n(910302);function r(e){const{detectedLanguage:t,canSuggestInConfidence:n}=function(e){const{pageStore:t,enabled:n,forceUpdate:o=!1}=e,r=(0,i().v3)();return(0,s().K8)((()=>n&&t?a().bY({pageStore:t,environment:r,enabled:n,forceUpdate:o}):{detectedLanguage:void 0,canSuggestInConfidence:!1}),[t,r,n,o])}(e);return t&&!(0,o().cE)(t)?{detectedLanguage:void 0,canSuggestInConfidence:!1}:{detectedLanguage:t,canSuggestInConfidence:n}}},521354:(e,t,n)=>{n.r(t),n.d(t,{AppComponents:()=>tf});var i=n(296540),s=()=>n(59226),o=()=>n(726637),a=()=>n(377441),r=()=>n(484714),l=()=>n(590526),d=()=>n(79926);const c=new(d().O2)("message-store-debug-panel",(async()=>await n.e(64199).then(n.bind(n,278333)))),u=(0,d()._h)(c,(e=>e.MessageStoreDebugPanel));var p=()=>n(178534),g=n(474848);function m(){return(0,l().K8)((()=>p().A.state.open),[],{debugName:"MessageStoreDebugPanelWrapper.isOpen"})?(0,g.jsx)(u,{}):null}const f=(0,d()._h)(new(d().O2)("slashMenu",(()=>n.e(92903).then(n.bind(n,931202)))),(e=>e.SlashMenu));var h=()=>n(375099),y=(n(944114),n(898992),n(672577),n(737550),()=>n(564884)),v=()=>n(907258),b=()=>n(242422),S=()=>n(852507),x=()=>n(401497),M=()=>n(675133),A=()=>n(489295),j=()=>n(295633),w=()=>n(74351),I=()=>n(882722),k=()=>n(843427),T=()=>n(232615),C=()=>n(127833),_=()=>n(30537),P=()=>n(388926),B=()=>n(98126),R=()=>n(546926),D=()=>n(302501),L=()=>n(890492),E=()=>n(81068),O=()=>n(663639),N=()=>n(736847),F=()=>n(700500),U=()=>n(90023),z=()=>n(304740),K=()=>n(651784),V=()=>n(179034),q=()=>n(69708),W=()=>n(100622),G=()=>n(284371),H=()=>n(720665),Y=()=>n(437219),$=()=>n(485444),Q=()=>n(515918);const Z={quip:"Quip",evernote:"Evernote",workflowy:"Workflowy",monday:"Monday",confluence:"Confluence",trello:"Trello"},X=[{name:Z.quip,attributes:[],regex:"^(?<site>https:\\/\\/[a-zA-Z0-9_-]+\\.quip\\.com)\\/(?<docId>[a-zA-Z0-9]+)(?:\\/(?<title>[^\\/?#]+))?\\/?(?:\\?.*)?$"}],J=[{name:Z.evernote,attributes:[],regex:"^(?<site>https:\\/\\/www\\.evernote\\.com)\\/shard\\/(?<shardId>[^\\/]+)\\/nl\\/(?<userId>[^\\/]+)\\/(?<noteId>[a-zA-Z0-9]+)\\/?(?:.*)?$"},{name:Z.evernote,attributes:[],regex:"^(?<site>https:\\/\\/www\\.evernote\\.com)\\/client\\/web#\\?b=(?<notebookId>[^&]+)&n=(?<noteId>[^&]+)$"},{name:Z.evernote,attributes:[],regex:"^(?<site>https:\\/\\/www\\.evernote\\.com)\\/client\\/web#\\/note\\/(?<noteId>[a-f0-9-]+)(?:\\?.*)?$"}],ee=[{name:Z.workflowy,attributes:[],regex:"^(?<site>https:\\/\\/workflowy\\.com)\\/s\\/(?<shareId>[a-zA-Z0-9-_]+)\\/?(?:.*)?$"},{name:Z.workflowy,attributes:[],regex:"^(?<site>https:\\/\\/workflowy\\.com)\\/#\\/(?<nodeId>[a-zA-Z0-9-_]+)\\/?(?:.*)?$"}],te=[{name:Z.monday,attributes:[],regex:"^(?<site>https:\\/\\/[a-zA-Z0-9_-]+\\.monday\\.com)\\/boards\\/(?<boardId>\\d+)\\/views\\/(?<viewId>\\d+)\\/?(?:.*)?$"},{name:Z.monday,attributes:[],regex:"^(?<site>https:\\/\\/[a-zA-Z0-9_-]+\\.monday\\.com)\\/boards\\/(?<boardId>\\d+)\\/?(?:.*)?$"},{name:Z.monday,attributes:[],regex:"^(?<site>https:\\/\\/[a-zA-Z0-9_-]+\\.monday\\.com)\\/items\\/(?<itemId>\\d+)\\/?(?:.*)?$"}],ne=[{name:Z.confluence,attributes:[],regex:"^(?<site>https:\\/\\/[a-zA-Z0-9_-]+\\.atlassian\\.net)\\/wiki\\/spaces\\/(?<spaceKey>[a-zA-Z0-9_-]+)\\/pages\\/(?<pageId>\\d+)\\/(?<pageTitle>[^\\/?#]+)\\/?(?:.*)?$"},{name:Z.confluence,attributes:[],regex:"^(?<site>https:\\/\\/[a-zA-Z0-9_-]+\\.atlassian\\.net)\\/wiki\\/spaces\\/(?<spaceKey>[a-zA-Z0-9_-]+)\\/?(?:.*)?$"}],ie=[{name:Z.trello,attributes:[],regex:"^(?<site>https:\\/\\/trello\\.com)\\/b\\/(?<boardId>[a-zA-Z0-9]+)(?:\\/(?<title>[^\\/?#]+))?\\/?(?:\\?.*)?$"}],se={[Z.quip]:X,[Z.evernote]:J,[Z.workflowy]:ee,[Z.monday]:te,[Z.confluence]:ne,[Z.trello]:ie};function oe(e){if(!e||"string"!=typeof e)return{type:"failure"};for(const[t,n]of Object.entries(se))for(const i of n)if(new RegExp(i.regex).test(e)&&ae(t))return{type:"success",importName:t,pattern:i};return{type:"failure"}}function ae(e){return Object.values(Z).some((t=>t===e))}var re=()=>n(457419),le=()=>n(938201),de=()=>n(666803),ce=()=>n(404141),ue=()=>n(62246),pe=()=>n(160475),ge=()=>n(689355);const me=(0,q().YK)({image:{defaultMessage:"Embed image",id:"embedMenu.action.image"},video:{defaultMessage:"Embed video",id:"embedMenu.action.video"},tweet:{defaultMessage:"Embed Tweet",id:"embedMenu.action.tweet"},drive:{defaultMessage:"Embed Google Drive",id:"embedMenu.action.drive"},gist:{defaultMessage:"Embed GitHub Gist",id:"embedMenu.action.gist"},figma:{defaultMessage:"Embed Figma",id:"embedMenu.action.figma"},invision:{defaultMessage:"Embed Invision project",id:"embedMenu.action.invision"},abstract:{defaultMessage:"Embed Abstract project",id:"embedMenu.action.abstract"},framer:{defaultMessage:"Embed Framer prototype",id:"embedMenu.action.framer"},whimsical:{defaultMessage:"Embed Whimsical board",id:"embedMenu.action.whimsical"},mixpanel:{defaultMessage:"Embed Mixpanel project",id:"embedMenu.action.mixpanel"},sketch:{defaultMessage:"Embed Sketch document",id:"embedMenu.action.sketch"},excalidraw:{defaultMessage:"Embed Excalidraw",id:"embedMenu.action.excalidraw"},replit:{defaultMessage:"Embed a repl",id:"embedMenu.action.replit"},miro:{defaultMessage:"Embed Miro board",id:"embedMenu.action.miro"},audio:{defaultMessage:"Embed audio",id:"embedMenu.action.audio"},maps:{defaultMessage:"Embed Google Maps",id:"embedMenu.action.maps"},loom:{defaultMessage:"Embed Loom",id:"embedMenu.action.loom"},typeform:{defaultMessage:"Embed Typeform",id:"embedMenu.action.typeform"},codepen:{defaultMessage:"Embed CodePen",id:"embedMenu.action.codepen"},pdf:{defaultMessage:"Embed PDF",id:"embedMenu.action.pdf"},embed:{defaultMessage:"Embed",id:"embedMenu.action.createEmbed"},hex:{defaultMessage:"Embed Hex",id:"embedMenu.action.hex"},deepnote:{defaultMessage:"Embed Deepnote",id:"embedMenu.action.deepnote"},drawing:{defaultMessage:"Embed a drawing",id:"embedMenu.action.drawing"}}),fe=(0,q().YK)({mentionBlock:{defaultMessage:"Mention",id:"embedMenu.actions.mentionBlock.title"},createLinkedViewOfDatabase:{defaultMessage:"Linked database view",id:"embedMenu.actions.createLinkedViewOfDatabase.title"},bookmarkMenuItem:{defaultMessage:"Bookmark",id:"embedMenu.actions.createBookmark.title"},newBookmarkMenuItem:{defaultMessage:"Preview",id:"embedMenu.actions.createNewBookmark.title"},createTransclusionItem:{defaultMessage:"Synced block",id:"embedMenu.actions.createTransclusion.title"},dismissItem:{defaultMessage:"URL",id:"embedMenu.actions.dismiss.title"},linkMention:{defaultMessage:"Mention",id:"embedMenu.actions.linkMention.title"},embed:{defaultMessage:"Embed",id:"embedMenu.actions.embed.title"}}),he="3rd party import section",ye={image:M().A.formatMessage(me.image),video:M().A.formatMessage(me.video),tweet:M().A.formatMessage(me.tweet),drive:M().A.formatMessage(me.drive),gist:M().A.formatMessage(me.gist),figma:M().A.formatMessage(me.figma),invision:M().A.formatMessage(me.invision),abstract:M().A.formatMessage(me.abstract),framer:M().A.formatMessage(me.framer),whimsical:M().A.formatMessage(me.whimsical),mixpanel:M().A.formatMessage(me.mixpanel),miro:M().A.formatMessage(me.miro),sketch:M().A.formatMessage(me.sketch),excalidraw:M().A.formatMessage(me.excalidraw),replit:M().A.formatMessage(me.replit),audio:M().A.formatMessage(me.audio),maps:M().A.formatMessage(me.maps),loom:M().A.formatMessage(me.loom),typeform:M().A.formatMessage(me.typeform),codepen:M().A.formatMessage(me.codepen),pdf:M().A.formatMessage(me.pdf),embed:M().A.formatMessage(me.embed),hex:M().A.formatMessage(me.hex),deepnote:M().A.formatMessage(me.deepnote),drawing:M().A.formatMessage(me.drawing)};const ve=function(){const e=(0,r().v3)(),t=(0,r().Y0)(),n=(0,l().O$)(ge().A);return(0,g.jsx)(C().zD,{popupType:t.isMobileNative&&!t.isTablet?_().n.SlideUp:_().n.Popup,open:n.open,originRect:n.open?n.selectionRect:void 0,placementToOrigin:"bottom",alignmentToOrigin:"start",originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:o().A.isMobile,keepFocus:o().A.isMobile,render:()=>n.loading?(0,g.jsx)(B().k,{}):(0,g.jsx)(Ie,{}),onDismiss:()=>be(e)})};function be(e){const t=ge().A.state;if(!t.open)return;const{url:n}=t;Y().ol(e,{url:n,type:"close"}),(0,ge().V)()}function Se({environment:e,importType:t,isImportGateEnabled:n}){return n?{key:he,render:e=>(0,g.jsx)(N().A,{...e}),items:[{key:"import",render:n=>(0,g.jsx)(xe,{environment:e,importType:t,menuItemProps:n}),action:()=>function(e,t){let n;(0,pe().t)({environment:e,action:"click",from:"paste_link"}),t&&(n=function(e){switch(e){case"Evernote":return"evernote";case"Monday":return"monday";case"Confluence":return"confluence";case"Trello":return"trello";case"Workflowy":return"workflowy";case"Quip":return"quip";default:return}}(t)),ce().Ay.setState({...ce().Ay.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:n,openedFrom:"link_paste"}),(0,ge().V)()}(e,t)}]}:null}function xe({environment:e,importType:t,menuItemProps:n}){return(0,S().w)((()=>{(0,pe().t)({environment:e,action:"view",from:"paste_link"})})),(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(P().A,{size:4}),(0,g.jsx)(E().A,{...n,title:(0,g.jsx)(q().sA,{id:"embedMenu.actions.import.title",defaultMessage:"Import from {importType}",values:{importType:t}})})]})}const Me=["youtube.com","youtu.be","instagram.com","twitter.com","x.com","facebook.com","linkedin.com","pinterest.com","tiktok.com","spotify.com","maps.google.com","drive.google.com","docs.google.com","slides.google.com","sheets.google.com","forms.google.com","indify.co","open.spotify.com","music.youtube.com","figma.com","amazon","wikipedia.org","medium.com","naver.com","canva.com","miro.com","reddit.com","calendly.com","forms.gle"];function Ae(e){var t;const{environment:n,url:i,textStore:s,shouldShowAgentEmbedOption:a}=e,r=[],l=s.getRecordStoreUIParent(),d=null===(t=(0,A().aP)(s))||void 0===t?void 0:t.getSpaceStore(),c=ue().en(s),u=function(e){if(!(e instanceof j().B))return!1;const t=e.getType();return!!t&&(0,F().IU)(t,e.getFormat())}(l),p=(0,K().parseRoute)({url:i,baseUrl:o().A.domainBaseUrl,publicDomainName:o().A.publicDomainName,isMobile:o().A.isMobile||!1,protocol:o().A.protocol,currentUrl:window.location.href}),m=(0,K().WZ)(p),f="page"===p.name?p.blockId:m?p.peekViewBlockId:void 0,h=void 0!==f,y="collection"===p.name,v="agent"===p.name;if(m&&!h&&!y)return[];if(v)r.push({name:M().A.formatMessage(fe.mentionBlock),type:"mention-page"}),a&&!c&&u&&r.push({name:M().A.formatMessage(fe.embed),type:F().xd.workflow});else if(h){const e=j().B.createChildStore(s,{table:V().ev,id:f}),t=function(e){const t=e.getSystemBlockTypeStore().getValue();return!(0,U().xm)(t)}(e);t&&r.push({name:M().A.formatMessage(fe.mentionBlock),type:"mention-page"});const n="page"===p.name&&p.scrollToBlockId,i=n?j().B.createChildStore(s,{table:V().ev,id:n}):void 0,o=(null==d?void 0:d.id)===e.getSpaceId();e.isType("form")&&!c&&u&&o&&r.push({name:M().A.formatMessage(fe.embed),type:F().xd.form});const a=e.isCollectionView(),l="page"===p.name?p.collectionViewId:void 0;i||!a||c||e.isCollectionViewPageWithContent()&&function(e,t){const n=e.getCollectionViewStores().find((e=>e.id===t&&"page"===e.getType()));return Boolean(n)}(e,l)||function(e,t){const n=e.getCollectionViewStores().find((e=>e.id===t&&"form_editor"===e.getType()));return Boolean(n)}(e,l)||!o||!u||!t||r.push({name:M().A.formatMessage(fe.createLinkedViewOfDatabase),type:F().xd.collectionView}),null==i||!i.canEdit()||i.isNavigableBlock()||c||(0,re().S)(i)||(0,le().r)(i)||function(e){const t=e.getParentBlockStore();return!(null==t||!t.isTranscriptionBlock())&&t.getContentIds().includes(e.id)}(i)||i.getSpaceId()!==(null==d?void 0:d.id)||!u||!t||r.push({name:M().A.formatMessage(fe.createTransclusionItem),type:"create-transclusion"})}else y?(r.push({name:M().A.formatMessage(fe.mentionBlock),type:"mention-page"}),r.push({name:M().A.formatMessage(fe.createLinkedViewOfDatabase),type:F().xd.collectionView})):r.push({name:M().A.formatMessage(fe.linkMention),type:"link-mention"});const b={url:i,baseUrl:o().A.domainBaseUrl,publicDomainName:o().A.publicDomainName};if(!v){const e=H().HP(ye);for(const t of e)"embed"!==t&&u&&z().dA[t](b)&&r.push({name:ye[t],type:t});!c&&u&&z().Vp(b)&&r.push({name:M().A.formatMessage(fe.bookmarkMenuItem),type:F().xd.bookmark}),!c&&!y&&u&&z().dA.embed(b)&&r.push({name:ye.embed,type:"embed"})}if(0===r.length)return[];const S=r.map((({name:e,type:t})=>({key:`embed ${e}`,render:t=>(0,g.jsx)(E().A,{...t,title:e}),action:()=>function(e,t,n){const i=ge().A.state;if(!i.open)return;const{url:s}=i;ue().Ju({environment:t,type:e,spaceId:n}),"form"!==e&&Y().ol(t,{url:s,type:e})}(t,n,null==d?void 0:d.id)}))),x={key:"dismiss",render:e=>(0,g.jsx)(E().A,{...e,title:M().A.formatMessage(fe.dismissItem)}),action:()=>be(n)};return(0,K().Jx)(p)||y||v||we(i,Me)?S.push(x):S.splice(1,0,x),S}function je(e){const{embedMenuState:t,environment:n,isImportGateEnabled:i,shouldShowAgentEmbedOption:s}=e,{url:o,textStore:a}=t,r=Ae({environment:n,url:o,textStore:a,shouldShowAgentEmbedOption:s});if(0===r.length)return[];const l={key:"embed section",render:e=>(0,g.jsx)(N().A,{...e}),items:r},d={key:"import section",render:e=>(0,g.jsx)(N().A,{...e,style:{paddingTop:0,paddingBottom:6}}),items:[{key:"jira-sync",render:e=>(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(P().A,{size:4}),(0,g.jsx)(E().A,{...e,title:(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(q().sA,{id:"embedMenu.actions.import.jiraTitle",defaultMessage:"Sync Jira projects and issues"}),(0,g.jsx)("span",{style:{display:"inline",marginInlineStart:6},children:(0,g.jsx)(Q().A,{})})]})})]}),action:()=>function(e){var t,n;const i=ge().A.state;if(!i.open)return;const{url:s}=i,o=v().default.state.mainEditorCurrentBlockStore,a=o&&(null===(t=(0,w().U)(o))||void 0===t?void 0:t.id),r=null===(n=s.match(/\/projects\/(\w+)\//))||void 0===n?void 0:n[1];de().Ay.setState({...de().Ay.state,teamSpaceId:a,projectKeys:r?[r]:[]}),$().j({environment:e,from:"external_object_instance_block",action:"show_teamspaces"}),(0,y().u)({environment:e,event:{eventName:"external_sync_entry_point",eventProperties:{integration:"jira",flowId:de().Ay.createNewFlowId(),from:"link_paste_menu"}}}),(0,ge().V)(),Y().ol(e,{url:s,type:"jira-sync"})}(n)}]},c=oe(o),u="success"===c.type?c.importName:void 0,p=Se({environment:n,importType:u,isImportGateEnabled:i});return we(o,["atlassian.net/jira","/jira/"])?[l,d]:i&&function(e){return"success"===oe(e).type}(o)&&p?[l,p]:[l]}function we(e,t){return t.some((t=>e.includes(t)))}function Ie(){const e=(0,r().v3)(),t=(0,s().X)("contextualized_import_entrypoints"),n=(0,l().K8)((()=>b().default.getConfig({configName:"custom_agent_sub_features"}).allow_agent_embed??!1),[]),a=(0,l().K8)((()=>{const i=ge().A.state;return i.open?je({embedMenuState:i,environment:e,isImportGateEnabled:t,shouldShowAgentEmbedOption:n}):null}),[e,t,n]),d=(0,l().K8)((()=>!!ge().A.state.loading),[]);(0,i.useEffect)((()=>{const e=(null==a?void 0:a.length)??0;d||0!==e||(0,ge().V)()}),[a,d]),function(){const e=(0,l().O$)(ge().A),t=(0,l().O$)(T().default);(0,i.useEffect)((()=>{if(e.open&&"editing"===t.mode){const{multiSelection:n}=t;(0,k().K)(n)&&n.start.store.id===e.textStore.id&&n.end.index===e.urlSelection.endIndex||(0,ge().V)()}}),[e,t])}();const c=(0,x().IS)((()=>({header:o().A.isMobile?{display:"flex",justifyContent:"center",alignItems:"center",fontSize:16,fontWeight:G().Wy.semibold,background:W().Tj.background.secondary,height:45}:{paddingInlineStart:12,paddingInlineEnd:12,paddingTop:10,paddingBottom:4,color:W().Tj.text.secondary,fontSize:G().J.UISmall.desktop,fontWeight:450,fontStyle:"normal",font:"SF Pro"}})),[]);if(null===a)return null;let u;return u=o().A.isMobile?{menuType:R().gu.ActionSheet}:{menuType:R().gu.Popup,width:a.some((e=>e.key===he))?270:a.some((e=>"import section"===e.key))?260:200,maxHeight:"40vh"},d?(0,g.jsx)(B().A,{style:{marginInlineStart:3,marginInlineEnd:3}}):(0,g.jsx)(L().A,{...u,className:I().poM,header:(0,g.jsx)(D().A,{style:c.header,isSmall:!o().A.isMobile,isSecondaryColor:!o().A.isMobile,children:(0,g.jsx)(q().sA,{id:"embedMenu.header",defaultMessage:"Paste as"})}),children:(0,g.jsx)(O().A,{type:O().O.Vertical,sections:a,initialFocus:0})})}var ke=()=>n(695115),Te=()=>n(26697),Ce=()=>n(721479),_e=()=>n(995847),Pe=()=>n(29554),Be=()=>n(440024),Re=()=>n(24973),De=()=>n(721235);function Le(e){let t=0,n=!1;const i=Re().A.state.blockStore;Re().A.state.open&&null!=i&&i.getPropertyValue("alt_text")&&(t=(0,Pe().r4)(i.getPropertyValue("alt_text"),i).length,n=Re().A.state.isEmptyOnOpen),De().S(e,{number_of_characters:t,did_create:n}),Re().A.setState({open:!1,blockStore:i}),(0,Be().I)({environment:e})}var Ee=()=>n(729368),Oe=()=>n(366437),Ne=()=>n(232930),Fe=()=>n(115512),Ue=()=>n(260850);const ze=(0,q().YK)({learnTooltip:{defaultMessage:"Learn more about alt text",id:"altTextMenuPopup.helpButton.tooltip"}});function Ke(){const e=(0,r().v3)(),t=(0,q().tz)(),n=(0,x().IS)((()=>({wrapper:{padding:o().A.isMobile?16:12,display:"flex",flexDirection:"column",fontSize:Fe().vQ,wordBreak:"break-word",maxHeight:o().A.isMobile?"35vh":"200px",overflowY:"auto"},closeButton:{borderRadius:"100%",width:22,height:22,float:"inline-end",marginInlineStart:8},input:{marginTop:o().A.isMobile?16:12,padding:o().A.isMobile?"8px 12px":"4px 10px",width:"100%",borderRadius:6,boxShadow:W().Tj.inputBoxShadow,background:W().Tj.background.primary,cursor:"text",overflowX:"hidden"},helpText:{color:W().Tj.text.secondary,display:"inline"},helpButton:{marginInlineStart:2,display:"inline-flex",position:"absolute",transform:o().A.isMobile?void 0:"translateY(-1px)"}})),[]),{altTextStore:s,altText:a,canEdit:d}=(0,l().K8)((()=>{const e=Re().A.state.blockStore,t=void 0!==e&&e.canEdit()&&!(0,le().r)(e);return{altTextStore:null==e?void 0:e.getPropertyStore("alt_text"),altText:e?(0,Pe().r4)(null==e?void 0:e.getPropertyValue("alt_text"),e):void 0,canEdit:t}}),[]);return(0,i.useEffect)((()=>{s&&(0,Ue().z)({store:s})}),[s]),(0,g.jsx)(L().A,{menuType:o().A.isMobile?R().gu.ActionSheet:R().gu.Popup,width:o().A.isMobile?"100vw":310,children:(0,g.jsxs)("div",{style:n.wrapper,children:[(0,g.jsxs)("div",{children:[(0,g.jsx)(ke().A,{style:n.closeButton,hovered:!0,icon:_e().xMarkSmallIcon,onClick:()=>Le(e),ariaLabel:t.formatMessage({id:"altTextMenuPopup.closeButton",defaultMessage:"Close"})}),d?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("div",{style:n.helpText,children:(0,g.jsx)(q().sA,{id:"altTextMenuPopup.description",defaultMessage:"Add alt text to describe this image. This makes your page more accessible to people who are vision-impaired or blind"})}),(0,g.jsx)(Te().m,{renderTooltip:()=>t.formatMessage(ze.learnTooltip),render:e=>(0,g.jsx)(ke().A,{ariaLabel:t.formatMessage(ze.learnTooltip),icon:Ce().questionMarkCircleSmallIcon,external:!0,href:(0,Ne().x)("guides.altText"),style:n.helpButton,colorVariant:"tertiary",...e})})]}):a]}),d&&s?(0,g.jsx)(Ee().A,{store:s,disabled:!1,pasteBehavior:"plaintext",style:n.input,placeholderStyle:n.input,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableInsertText:!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableMentions:!0,disableEmbedMenu:!0,disableMobileActionBar:!0,disableComment:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,onEnter:()=>Le(e),onEsc:()=>Le(e),onTab:()=>!0,placeholder:t.formatMessage({id:"altTextMenuPopup.placeholder",defaultMessage:"Add alt text..."}),inPageFind:Oe().Os.none}):void 0]})})}const Ve=function(){const e=(0,r().v3)(),t=(0,x().IS)((()=>({popup:{background:W().Tj.background.elevated,borderStartStartRadius:o().A.isMobile?12:6,borderStartEndRadius:o().A.isMobile?12:6,insetInlineStart:o().A.isMobile?0:8}})),[]),{open:n,originRect:i}=(0,l().K8)((()=>{const{open:e}=Re().A.state;return e?{open:e,originRect:Re().A.state.originRect}:{open:e,originRect:void 0}}),[]);return(0,g.jsx)(C().zD,{popupType:o().A.isMobile?_().n.SlideUp:_().n.Popup,open:n,originRect:i,originGap:8,placementToOrigin:"bottom",alignmentToOrigin:"end",onDismiss:()=>Le(e),render:()=>(0,g.jsx)(Ke,{}),sameWidthAsOrigin:!1,style:t.popup,trapFocus:!0})};var qe=()=>n(115796),We=()=>n(543886),Ge=()=>n(405170),He=()=>n(430923),Ye=()=>n(774733);const $e=new(d().O2)("desktop",(async()=>{const[{Notification:e},{default:t}]=await Promise.all([Promise.all([n.e(14388),n.e(7097)]).then(n.bind(n,15121)),Promise.all([n.e(14388),n.e(7097)]).then(n.bind(n,286533))]);return{Notification:e,ElectronContextMenu:t}})),Qe=(0,d()._h)($e,(e=>e.ElectronContextMenu));var Ze=()=>n(75858),Xe=()=>n(636714),Je=()=>n(278634),et=()=>n(673477),tt=()=>n(129522),nt=()=>n(836724),it=()=>n(206051),st=()=>n(991249),ot=()=>n(295304),at=()=>n(547149);const rt={subscriptionsDependencies:{renderUpgradeButton:({upsell:e,spaceStore:t})=>(0,g.jsx)(n(324043).j,{source:"slash_menu",display:"button",width:"fill",upsell:e,spaceStore:t}),triggerUpsell:st().K,showBlockingExperienceToast:n(598729).Q,validateCanCreateBlock:n(957763).E},selectionDependencies:{edit:n(518489).h},educationDependencies:{completePressSlashTooltip:n(357731).P},analyticsDependencies:{trackCreateBlock:n(37450).vH,trackBlockAction:Je().N},registryDependencies:{GlobalBlockRegistry:tt().K},actionRegistryDependencies:{getInsertAndSlashActionsStore:n(92601).s7},blockSelectionDependencies:{getRectFromStore:nt().T.getRectFromStore.bind(nt().T),getSelectedStores:()=>it().default.state.stores},menuStoreDependencies:{getIsMenuStoresOpen:()=>n(97270).A.state.open||et().Ay.state.open||ge().A.state.open},textActionsDependencies:{setValue:ot().R9},transactionDependencies:{createAndCommit:at().createAndCommit},actionMenuListDependencies:{ActionMenuList:Xe().A,validateAction:n(671894).F6}};var lt=()=>n(251994);const dt=new(d().O2)("LazyEmojiMenu",(()=>n.e(90012).then(n.bind(n,730967)))),ct=(0,d()._h)(dt,(e=>e.default));n(803949),n(581454);var ut=()=>n(755531),pt=()=>n(755222),gt=()=>n(852273),mt=()=>n(770063),ft=()=>n(813206),ht=()=>n(584262),yt=()=>n(416504),vt=()=>n(921997),bt=()=>n(959044),St=()=>n(496603),xt=()=>n(763824),Mt=()=>n(848259),At=()=>n(769864),jt=()=>n(89053),wt=()=>n(534606),It=()=>n(44551),kt=()=>n(246766);function Tt(e){return null===It().electronApi||void 0===It().electronApi?void 0:It().electronApi.setBadge(e)}var Ct=()=>n(182805),_t=()=>n(299545),Pt=()=>n(209879),Bt=()=>n(21899),Rt=()=>n(303742),Dt=()=>n(179534);function Lt(e){const{sidebarSpaceViewStore:t,sidebarSpaceStore:n,currentUserRootStore:s}=(0,l().K8)((()=>({sidebarSpaceViewStore:v().default.state.sidebarSpaceViewStore,sidebarSpaceStore:(0,ut().S)(),currentUserRootStore:v().default.state.currentUserRootStore})),[]),o=(0,l().K8)((()=>e?null==n?void 0:n.userId:void 0),[e,null==n?void 0:n.userId]),a=(0,l().K8)((()=>(0,Rt().o)(t)?(0,Bt().f)({currentUserRootStore:s}):[]),[s,t]),d=(0,l().K8)((()=>pt().A.state.isVisible),[]),c=(0,q().tz)(),u=(0,r().v3)(),p=(0,i.useRef)(),g=(0,i.useRef)(),m=(0,i.useRef)(-1),f=(0,i.useCallback)((()=>{const{mobileNative:e}=u,{allSpaces:t,currentSpace:n}=Et();e&&(t===p.current&&n===g.current||e.setBadgeNumber(t,n),g.current=n),t!==p.current&&Tt(t>0?`${t}`:""),p.current=t}),[u]),h=(0,i.useMemo)((()=>St().Oo(f)),[f]),y=(0,i.useCallback)((async(e,i)=>{if(i===m.current||!n&&!(0,Rt().o)(t))return;if(m.current=i,!function(e){if(0===Dt().A.state.results.length)return!0;if(!document.hasFocus())return!0;if(!e.includes("unreadCount"))return!0;return!1}(String(i)))return;const s=await(async e=>{const t=[],n=At().callInitialFanoutApi({eventName:"getUserNotifications",environment:u,data:{size:1e3,isInboxV2:!0,markNotificationsAsReceived:e},headers:{}});for await(const i of n)"success"===i.type&&t.push(...i.data.results);return t})(d);Dt().A.setState({results:s}),h();const o=St().KC.apply(null,s.map((e=>e.unreceived.notificationIds)));for(const r of o)(0,Rt().o)(t)?a.forEach((e=>{const t=e.getSpaceStore();t&&Ot(r,t,e,c,u)})):n&&t&&Ot(r,n,t,c,u)}),[n,t,a,h,u,c,d]);(0,i.useEffect)((()=>{d&&y("visibilityChange",m.current)}),[d,y]);const b=(0,i.useMemo)((()=>St().nF(y,1e3)),[y]);(0,i.useEffect)((()=>{if(!o)return;const e=(0,vt().dp)(o),t=gt().Ay.addListener(e,void 0,(({key:e,value:t})=>{Pt().A.whenActive((()=>{b(e,t)}))}),void 0,u),n="blank"===u.RouterStore.state.route.name&&(0,Ct().isPrewarmedTabLoadSidebarEnabled)();return y("initializeListener",n?void 0:-1),Dt().A.addListener(f),u.mobileNative&&v().default.addListener(f),()=>{t&&gt().Ay.removeListener(t,u),Dt().A.addListener(f),u.mobileNative&&v().default.removeListener(f)}}),[o,u,y,b,f])}function Et(){const e="mentions";return{allSpaces:Dt().A.getTotalUnreadCountForType(e),currentSpace:Dt().A.getUnreadCountForSidebarSpace()[e]??0}}async function Ot(e,t,n,i,s){const a=(0,mt().v3)(t,{table:bt()._p,id:e,spaceId:t.id});await a.load();const r=a.getKeyStore("activity_id").getValue(),l=a.getKeyStore("space_id").getValue();if(!l||!r)return;const d=(0,_t().jA)(a,r,l);await d.load();const c=d.getModel(),{currentUserStore:u}=v().default.state;if(u&&n&&c&&!c.invalid&&!ft().zP(c,u.id)&&await(0,wt().a)()&&"undefined"!=typeof Notification){if(await n.load(),!n.isDefined())return;if(!c.isMentionType())return;if("reacted"===c.getType())return;if(!n.getNotifyDesktop())return;if(!s.device.isDesktop)return;if(s.device.isBrowser&&b().default.checkGate({gateName:"browser_push_notifications"})&&"granted"!==Notification.permission){const e=Notification.requestPermission();void 0!==e&&await(0,xt().nQ)(1e4,e)}const t=(0,(await $e.load()).Notification)({activity:c,getRecordValue:a.getRecordValue,userTimeZone:(0,yt().P)(),intl:i,pageVisitSource:ht().y8.PushNotification,recipientUser:u.getModel(),experimentService:b().default,collectionFeatureGates:(0,jt().i)(),spaceIdCreator:s.idCreator.getSpaceIdCreatorSync(l)});if(!t)return;const{subject:r,body:p}=t,g=b().default.checkGate({gateName:"desktop_deduplicate_notifications"}),m=new Notification(r,{body:p,silent:!0,...g?{tag:e}:{}}),f=ft().JT(c.type),h={medium:"desktop_push",type:f,badge_number:Et().allSpaces,notification_id:a.id,activity_id:d.id},y=e=>Mt().Gj({environment:s,args:h,action:e});y("sent"),m.addEventListener("show",(()=>y("shown"))),m.addEventListener("close",(()=>y("closed"))),m.addEventListener("click",(()=>{const e=ft().KP({activity:c,getRecordModel:a.getRecordModel,baseUrl:o().A.domainBaseUrl,pageVisitSource:ht().y8.PushNotification});!function(e,t){null!==It().electronApi&&void 0!==It().electronApi&&It().electronApi.openNotificationUrl?It().electronApi.openNotificationUrl(e):(0,kt().navigate)({environment:t,url:e})}((0,ht().p3)(e,[f,"desktop_push"],ht().y8.PushNotification),s),y("clicked")}))}}var Nt=()=>n(187174),Ft=()=>n(534177),Ut=()=>n(288157),zt=()=>n(957606);function Kt({environment:e,tab:t}){const{sidebarSpaceViewStore:n,sidebarSpaceStore:i,currentUserStore:s,spaceTransitionStatus:o}=v().default.state,a=null==n?void 0:n.getUserId(),r=null==n?void 0:n.getSpaceId(),l={readyForRequest:!1,userId:void 0,spaceViewId:void 0,spaceId:void 0};return null!=n&&n.isDefined()&&n.getAlive()&&n.canRead()&&a&&r?(0,v().isTransitioningSpaces)(o)||e.currentUser.id!==a||(null==s?void 0:s.id)!==a||(null==i?void 0:i.id)!==r?l:function(e){if("library"===e)return(0,Ut().xc)();if("home"===e)return(0,zt().$H)();return(0,Ft().HB)(e),!1}(t)?{readyForRequest:!0,userId:a,spaceViewId:n.id,spaceId:r}:l:l}var Vt=()=>n(91765);function qt(){const e=(0,r().v3)(),{libraryListenerState:t,libraryViewNameToSortOption:n}=(0,l().K8)((()=>{const t=v().AppStoreSidebarSpaceViewStore.state;return{libraryListenerState:Kt({environment:e,tab:"library"}),libraryViewNameToSortOption:t?(0,Vt().qg)(t):void 0}}),[e],{useDeepEqual:!0}),s=(0,i.useRef)(n);s.current=n;const o=(0,i.useMemo)((()=>(0,St().sg)((t=>e.api.callCellCompatibleApi(t)),1e3,{leading:!0,trailing:!0})),[e.api]);return(0,Nt().Yb)((async()=>{t.readyForRequest&&s.current&&await o({eventName:"getLibraryPage",environment:e,data:{spaceViewId:t.spaceViewId,spaceId:t.spaceId,libraryViewNameToSortOption:s.current},userId:t.userId,cellNavigation:{spaceId:t.spaceId}})}),[o,e,t.spaceId,t.spaceViewId,t.userId,t.readyForRequest]),null}const Wt=new(d().O2)("linkMenu",(()=>n.e(4586).then(n.bind(n,323779)))),Gt=(0,d()._h)(Wt,(e=>e.default));n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698);var Ht=()=>n(230711),Yt=()=>n(571595);function $t(){const e=(0,r().v3)(),{shouldTrigger:t,spaceId:n,userId:s}=(0,l().K8)((()=>{const e={shouldTrigger:!1,spaceId:void 0,userId:void 0},{sidebarSpaceStore:t,sidebarSpaceViewStore:n,spaceTransitionStatus:i,currentUserStore:s}=v().default.state;if((0,v().isTransitioningSpaces)(i))return e;if(!s||!t||!n)return e;const o=(0,Ht().dp)(t,s.id),a=null==o?void 0:o.getMembershipType();return o&&a&&(0,Yt().m$)(a)?{shouldTrigger:!0,spaceId:t.getSpaceId(),userId:s.id}:e}),[]);return(0,i.useEffect)((()=>{t&&(Qt.has(n)||(Qt.add(n),At().callCellCompatibleApi({eventName:"scheduleSetupPeopleCollection",environment:e,data:{spaceId:n},userId:s,cellNavigation:{spaceId:n}})))}),[e,t,n,s]),null}const Qt=new Set;var Zt=()=>n(785728);const Xt=(0,St().sg)(At().callApi,1e3,{leading:!0,trailing:!0}),Jt=function(){const e=(0,r().v3)(),t=(0,l().K8)((()=>Kt({environment:e,tab:"home"})),[e]);return(0,Nt().Yb)((async()=>{t.readyForRequest&&await Xt({eventName:"getUserHomePages",environment:e,data:{spaceViewId:t.spaceViewId,spaceId:t.spaceId},userId:t.userId,headers:(0,Zt().WS)({cellId:void 0,recordId:t.spaceViewId,spaceId:t.spaceId})})}),[e,t.readyForRequest,t.spaceViewId,t.spaceId,t.userId]),null},en=(0,d()._h)(new(d().O2)("RecentsCachingListener",(async()=>await n.e(62516).then(n.bind(n,437879)))),(e=>e.RecentsCachingListener));var tn=()=>n(578510),nn=()=>n(497597);var sn=()=>n(337738),on=()=>n(568891),an=()=>n(396406),rn=()=>n(269380);const ln=function(){const e=(0,l().O$)(on().Hf);return(0,g.jsx)(an().O,{open:e,children:(0,g.jsx)(dn,{})})};function dn(){const e=(0,l().O$)(on().Ay),t=(0,l().K8)((()=>function(){const e=on().Ay.state;if(!e.isDragging)return;const{startX:t,startY:n,currentX:i,currentY:s}=e;return{position:"absolute",top:0,insetInlineStart:0,transform:`translate3d(${i-t}px, ${s-n}px, 0)`}}()),[]);if(!e.isDragging)return null;const n=e.draggedStores.map(((t,n)=>(0,g.jsx)("div",{children:e.ghostElements[n].map(((e,t)=>(0,g.jsx)(rn().A,{element:e},t)))},n)));return(0,g.jsx)("div",{style:t,children:n})}var cn=()=>n(171510),un=()=>n(226627),pn=()=>n(415246),gn=()=>n(395868),mn=()=>n(229508),fn=()=>n(791057),hn=()=>n(605674);const yn=Symbol("initial");function vn(e){const{spaceViewStore:t,type:n}=e,s=(0,r().v3)(),[o,a]=function(e){const{spaceViewStore:t,type:n}=e;return(0,l().K8)((()=>{var e;if(!t||!t.isDefined())return;const i=t.getUserId(),s=null===(e=t.getSpaceStore())||void 0===e?void 0:e.getSpaceIdCreator();if(!i||!s)return;const o=un().L.fromSpaceViewStore(s,t,n);if(!o||!o.isDefined())return;const a=o.getSectionType();return[o,(0,gn().VL)(a)&&"recents"!==a&&"teamspaces"!==a?(0,vt().eG)((0,pn().Ah)(a,i,s)):void 0]}),[t,n])}({spaceViewStore:t,type:n})??[],d=function(e){const t=(0,r().v3)(),n=(0,i.useRef)(yn),[s,o]=(0,i.useState)(0);return(0,i.useEffect)((()=>{if(n.current=yn,o(0),e){const i=gt().Ay.addListener(e,void 0,(({value:e})=>{n.current!==yn&&n.current!==e&&o((e=>e+1)),n.current=e}),void 0,t);if(i)return()=>gt().Ay.removeListener(i,t)}}),[t,e]),s}(a);(0,Nt().Yb)((()=>o&&d>0?async function(e){const{environment:t,sidebarSectionStore:n}=e;if(await n.load(),!n.isDefined())return;const i=n.getSpaceId(),s=b().default.isStatsigReady()?(0,Ut().J)():void 0;if(!1===s)return;const o=await t.api.callCellCompatibleApi({eventName:"getSidebarSectionItems",environment:t,data:{spaceId:i,sectionId:n.id,gateOverride:s},cellNavigation:{spaceId:i}});if("success"!==o.type||!o.data)return;if(!o.data.inGate)return;const a=o.data.truncatedBlockIds,r=o.data.hasMore;(0,hn().$)(n.pointer).setState({visibleBlockIds:a,hasMore:r})}({environment:s,sidebarSectionStore:o}):Promise.resolve()),[d,s,o],{throttle:500})}function bn(e){const{spaceViewStore:t}=e;return vn({spaceViewStore:t,type:"shared"}),vn({spaceViewStore:t,type:"private"}),vn({spaceViewStore:t,type:"myMeetings"}),null}function Sn(){const e=(0,Ut().gO)(),t=(0,Ut().el)(),n=(0,mn().a)();return function({spaceViewStore:e,isItemEndpointEnabled:t,isSectionEndpointEnabled:n}){const s=(0,r().v3)(),o=i.useRef(t),a=i.useRef(n);i.useEffect((()=>{const i=!o.current&&t,r=!a.current&&n;if(e&&(i||r)){const t=e.getSpaceId();t&&(0,fn().r)({environment:s,spaceId:t})}o.current=t,a.current=n}),[t,n,e,s])}({spaceViewStore:n,isItemEndpointEnabled:e,isSectionEndpointEnabled:t}),e?(0,g.jsx)(bn,{spaceViewStore:n}):null}var xn=()=>n(476197),Mn=()=>n(578136);function An(){const e=(0,r().v3)(),t=(0,l().K8)((()=>{const t=e.RouterStore.state.route;if("team"===t.name)return t.teamId}),[e]),n=(0,l().K8)((()=>function({environment:e,currentTeamId:t}){const{sidebarSpaceViewStore:n,sidebarSpaceStore:i,currentUserStore:s,spaceTransitionStatus:o}=v().default.state,a=e.deviceStore.state,r=null==n?void 0:n.getUserId(),l=null==n?void 0:n.getSpaceId(),d={readyForTeamHomePagesRequest:!1,spaceViewUserId:void 0,spaceViewId:void 0,spaceViewSpaceId:void 0,currentTeamId:void 0};return null!=n&&n.isDefined()&&n.getAlive()&&n.canRead()&&r&&l&&t?(0,v().isTransitioningSpaces)(o)||e.currentUser.id!==r||(null==s?void 0:s.id)!==r||(null==i?void 0:i.id)!==l?d:(0,Mn().D)({isMobileNative:a.isMobileNative,disableExposureLogging:!0})?{readyForTeamHomePagesRequest:!0,spaceViewId:n.id,spaceViewUserId:r,spaceViewSpaceId:l,currentTeamId:t}:d:d}({environment:e,currentTeamId:t})),[e,t]);return(0,Nt().Yb)((async()=>{n.readyForTeamHomePagesRequest&&await jn({eventName:"createCollectionViewBlockForPosts",environment:e,data:{teamId:n.currentTeamId,spaceId:n.spaceViewSpaceId},userId:n.spaceViewUserId,headers:(0,Zt().WS)({cellId:void 0,recordId:n.spaceViewId,spaceId:n.spaceViewSpaceId})})}),[n.readyForTeamHomePagesRequest,n.spaceViewSpaceId,n.spaceViewUserId,n.spaceViewId,e,n.currentTeamId]),null}const jn=(0,St().sg)(At().callApi,1e3,{leading:!0,trailing:!0});var wn=()=>n(664594),In=()=>n(920198),kn=()=>n(929219);const Tn=100;function Cn(e){const{eventKey:t,spaceId:n,onRefetch:s,deferForHiddenTabs:o=!0}=e,a=(0,r().v3)(),d=(0,i.useRef)(s);d.current=s;const c=(0,i.useRef)(null),u=(0,i.useRef)(null),p=(0,i.useRef)(!1),g=(0,i.useRef)(null),m=(0,i.useCallback)((e=>()=>{const t=c.current??"all";c.current=null,g.current=null,d.current({idsToRefetch:t,spaceId:e})}),[]),f=(0,i.useCallback)((()=>{g.current&&(clearTimeout(g.current),g.current=null)}),[]),h=(0,i.useCallback)((({value:e,passThroughData:t})=>{const i=p.current,s=u.current;if(u.current=e,p.current=!0,!n)return;const a=!i;if(a||e!==s){if(a||"all"===c.current||!Array.isArray(t))c.current="all";else{null===c.current&&(c.current=new Set);for(const e of t)c.current.add(e)}f(),o&&!pt().A.state.isVisible||(g.current=setTimeout(m(n),Tn))}}),[n,o,m,f]);(0,i.useEffect)((()=>{if(!t||!n)return;const e=gt().Ay.addListener(t,void 0,h,void 0,a);return function(){f(),e&&gt().Ay.removeListener(e,a)}}),[t,a,n,h,f]);const y=(0,l().K8)((()=>pt().A.state.isVisible),[]),v=(0,i.useRef)(y);(0,i.useEffect)((()=>{if(!n)return;const e=y&&!v.current;v.current=y,e&&o&&null!==c.current&&(f(),m(n)())}),[n,y,o,m,f]),(0,i.useEffect)((()=>{f(),c.current=null,u.current=null,p.current=!1}),[t,n,f])}var _n=()=>n(302996),Pn=()=>n(383293),Bn=()=>n(165358),Rn=()=>n(96689),Dn=()=>n(468006),Ln=()=>n(821062),En=()=>n(51781);function On(){const e=(0,r().v3)(),t=(0,wn().T)(),n=(0,l().O$)(kn().e),s=(0,In().L)(),o=(0,Ht().U2)(s),a=null==s?void 0:s.id,d=(0,l().K8)((()=>{if(!o)return!1;const e=o.getMembershipType();return(0,Dn().WU)({membershipType:e})}),[o]);(0,i.useEffect)((()=>{t&&a&&d&&((0,En().fetchUnfetchedTeamsFromLocalStorage)(),n&&(0,En().fetchUnfetchedTeams)({userId:t,spaceId:a,teamTypes:new Set(["Joined"]),environment:e}))}),[e,t,a,d,n]);const c=(0,l().K8)((()=>{const e=[];for(const t of Object.keys(Pn().q.state))for(const n of Object.keys(Pn().q.state[t]))e.push({userId:t,spaceId:n});return e}),[],{equalityFn:Ln().k});return(0,g.jsx)(g.Fragment,{children:c.map((({userId:e,spaceId:t})=>(0,g.jsx)(Nn,{userId:e,spaceId:t},`teams-listener-${e}-${t}`)))})}function Nn(e){const{userId:t,spaceId:n}=e,s=(0,r().v3)(),o=(0,l().K8)((()=>{const e=(0,Rn().n2)(n),i=new(_n().SpaceStore)(s,e);return(0,Ht().dp)(i,t)}),[s,t,n]),a=(0,l().K8)((()=>{const e=o.getMembershipType();return(0,Dn().WU)({membershipType:e})}),[o]),d=(0,i.useCallback)((e=>{const{idsToRefetch:i,spaceId:o}=e;if(n!==o)return;Pn().q.getUnit(t,o)?(0,En().refetchTeams)({userId:t,spaceId:o,teamIds:i,environment:s}):Bn().rateLimitedLog({from:"TeamsListener",level:"error",type:"teamsUnitNotFound",spaceId:o,data:{miscDataToConvertToString:{userId:t}}})}),[s,t,n]);return Cn({eventKey:a?(0,vt().um)(n):void 0,spaceId:n,onRefetch:d,deferForHiddenTabs:!0}),null}var Fn=()=>n(300474),Un=()=>n(523713),zn=()=>n(964556);function Kn(){const e=(0,r().v3)(),t=e.currentUser.id,n=(0,Fn().r)(),s=(0,l().K8)((()=>(0,Un().x)({isPhone:e.device.isPhone,spaceStore:(0,ut().S)()})),[e.device]);return(0,i.useEffect)((()=>{if(!n||!t||!s)return;const i=gt().Ay.addListener((0,vt().DZ)({notionUserId:t,spaceId:n}),void 0,(0,gt().AY)((({version:t})=>{-1!==t&&Vn(e)})),void 0,e);return function(){i&&gt().Ay.removeListener(i,e)}}),[e,t,n,s]),null}const Vn=(0,St().sg)((e=>{zn().refreshExternalIntegrationStore({environment:e})}),5e3,{leading:!0,trailing:!0});var qn=()=>n(755877),Wn=()=>n(730219),Gn=()=>n(192180),Hn=()=>n(51317);function Yn(e){switch(e){case Wn().A.Preview:return(0,g.jsx)(q().sA,{id:"internalUnfurlingMenu.actions.pasteAsPreview.title",defaultMessage:"Preview"});case Wn().A.Mention:return(0,g.jsx)(q().sA,{id:"internalUnfurlingMenu.actions.pasteAsMention.title",defaultMessage:"Mention"});case Wn().A.Link:return(0,g.jsx)(q().sA,{id:"internalUnfurlingMenu.actions.pasteAsLink.title",defaultMessage:"Link"});default:(0,Ft().HB)(e)}}const $n=function(){const e=(0,r().v3)(),t=(0,i.useRef)(null),[n]=(0,l().$y)(Hn().A),s=(0,i.useCallback)((t=>{if(n.open){var i;if(!t)Gn().fS({actionType:n.focusedIndex,environment:e,commentStore:null===(i=n.args.commentStore)||void 0===i?void 0:i.state,useTempStores:!1});Hn().A.setState({open:!1})}}),[e,n]),a=(0,i.useCallback)((e=>{n.open&&"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"Enter"!==e.key&&s(void 0)}),[s,n.open]),d=(0,i.useCallback)((e=>{if(!n.open||!e.target)return;const i=t.current;i&&(i.contains(e.target)||s(void 0))}),[s,n.open]);(0,i.useEffect)((()=>((0,qn().P)(window,"keydown",a),(0,qn().P)(window,"mousedown",d),()=>{(0,tn().O)(window,"keydown",a),(0,tn().O)(window,"mousedown",d)})),[a,d]);const c=(0,i.useRef)(!1);function u(t){var i;n.open&&void 0!==t.indexGlobal&&(Hn().A.setState({...n,focusedIndex:t.indexGlobal}),Gn().fS({actionType:t.indexGlobal,environment:e,commentStore:null===(i=n.args.commentStore)||void 0===i?void 0:i.state,useTempStores:!0}))}(0,l().K8)((()=>{var t,i;const s=(n.open&&(null===(t=n.args.commentStore)||void 0===t?void 0:t.state)&&(null===(i=n.args.commentStore.state)||void 0===i?void 0:i.isReady()))??!1;var o;s&&!c.current&&n.open&&Gn().fS({actionType:n.focusedIndex,environment:e,commentStore:null===(o=n.args.commentStore)||void 0===o?void 0:o.state,useTempStores:!0});c.current=s}),[e,n]);const p=(0,l().K8)((()=>e.device.isMobileNative&&!e.device.isTablet),[e]);return(0,g.jsx)(C().zD,{popupType:p?_().n.SlideUp:_().n.Popup,open:n.open,originRect:n.open?n.selectionRect:void 0,placementToOrigin:"top",alignmentToOrigin:"start",originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:o().A.isMobile,keepFocus:o().A.isMobile,render:function(){var i;if(!n.open)return;const s=function(t){const{url:n,args:i}=t,s=[];s.push({title:Yn(Wn().A.Preview),validator:()=>!0,type:Wn().A.Preview}),s.push({title:Yn(Wn().A.Mention),validator:()=>!0,type:Wn().A.Mention}),s.push({title:Yn(Wn().A.Link),validator:()=>!0,type:Wn().A.Link});const a={key:"menu section",render:e=>(0,g.jsx)(N().A,{...e}),items:St().oE(s.map((({title:t,validator:s,type:a})=>{if(s({url:n,baseUrl:o().A.domainBaseUrl,publicDomainName:o().A.publicDomainName})){return{key:`item ${a}`,render:n=>(0,g.jsx)(E().A,{...n,title:t,onMouseEnter:t=>{var s;n.onMouseEnter(t),Gn().fS({actionType:a,environment:e,commentStore:null===(s=i.commentStore)||void 0===s?void 0:s.state,useTempStores:!0})}}),action:()=>{var t;return Gn().fS({actionType:a,environment:e,commentStore:null===(t=i.commentStore)||void 0===t?void 0:t.state,useTempStores:!1})}}}})))};return[a]}(n),a=o().A.isMobile?{display:"flex",justifyContent:"center",alignItems:"center",fontSize:16,fontWeight:G().Wy.semibold,height:45}:{paddingInlineStart:12,paddingInlineEnd:12,paddingTop:10,paddingBottom:4,fontWeight:G().Wy.semibold};let r;return r=o().A.isMobile?{menuType:R().gu.ActionSheet}:{menuType:R().gu.Popup,width:200,maxHeight:"40vh"},null!==(i=n.args.commentStore)&&void 0!==i&&i.state&&n.args.commentStore.state.isReady()?(0,g.jsx)(L().A,{...r,className:I().poM,ref:t,header:(0,g.jsx)(D().A,{style:a,isSmall:!o().A.isMobile,isSecondaryColor:!o().A.isMobile,children:(0,g.jsx)(q().sA,{id:"embedMenu.header",defaultMessage:"Paste as"})}),children:(0,g.jsx)(O().A,{type:O().O.Vertical,sections:s,onKeyboardArrow:u,initialFocus:0,priority:1,disallowBackspace:!0})}):(0,g.jsx)(L().A,{...r,className:I().poM,ref:t,header:(0,g.jsx)(D().A,{style:a,isSmall:!o().A.isMobile,isSecondaryColor:!o().A.isMobile,children:(0,g.jsx)(q().sA,{id:"embedMenu.header",defaultMessage:"Paste as"})}),children:(0,g.jsx)(N().A,{style:{display:"flex",justifyContent:"center"},children:(0,g.jsx)(B().k,{})})})},onDismiss:()=>s(void 0)})};var Qn=()=>n(160432),Zn=()=>n(297813),Xn=()=>n(510683),Jn=()=>n(384944);var ei=()=>n(448421);const ti=function(){const e=(0,r().v3)(),t=(0,l().O$)(ei().A),s=(0,q().tz)(),o=(0,i.useContext)(n(45105).w);if(!t.open)return null;const a=t.integration.info.icon;return a?(0,g.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",cursor:"default",padding:16,background:W().Tj.popoverBackground,borderRadius:4,boxShadow:W().Tj.shadowSM,position:"absolute",bottom:65+o,insetInlineEnd:16+o,width:240,zIndex:111,clipPath:"inset(-10px -10px -10px -10px)"},children:[(0,g.jsx)(n(854672).A,{type:"image_url",imageURL:a,size:38,style:{marginBottom:6}}),(0,g.jsx)("div",{style:{color:W().Tj.text.primary,fontSize:14,fontWeight:G().Wy.semibold,marginBottom:6,textAlign:"center"},children:(0,g.jsx)(q().sA,{id:"inlineUnfurlingAuthenticationPopup.title",defaultMessage:"Connect to {integration}",values:{integration:t.integration.name}})}),(0,g.jsxs)("div",{style:{color:W().Tj.text.secondary,fontSize:12,marginBottom:8,textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[(0,g.jsx)(q().sA,{id:"inlineUnfurlingAuthenticationPopup.caption",defaultMessage:"You, and anyone else who has access to this Notion page, will see rich previews that update live."}),(0,g.jsx)(n(416783).V,{href:(0,Ne().x)("guides.unfurling"),external:!0,children:(0,g.jsx)(q().sA,{id:"inlineUnfurlingAuthenticationPopup.learnMore.text",defaultMessage:"Learn more"})})]}),(0,g.jsx)(Qn().A,{colorPalette:"blue",onClick:()=>async function(e){const t=ei().A.state,{sidebarSpaceStore:n}=v().default.state;if(!t.open||!n)return;await Xn().Jq({environment:e,integration:t.integration,spaceId:n.id,unfurlUrl:t.unfurlUrl,externalObjectInstanceBlockId:t.externalObjectInstanceBlockId,from:"external_object_instance_inline_popup"}),ni(t.integration.id,e),ei().A.reset()}(e),style:{width:"100%"},children:(0,g.jsx)(q().sA,{id:"inlineUnfurlingAuthenticationPopup.connectButton",defaultMessage:"Connect"})}),(0,g.jsx)(ke().A,{icon:Zn().xMarkFillIcon,ariaLabel:s.formatMessage({defaultMessage:"Close",id:"unfurlingInformationPopup.closeButton.ariaLabel"}),onClick:()=>function(e){const t=ei().A.state;t.open&&ni(t.integration.id,e);ei().A.reset()}(e),style:{position:"absolute",top:6,insetInlineEnd:6}})]}):null};function ni(e,t){const{currentUserSettingsStore:n}=v().default.state;n&&at().createAndCommit({userAction:"UnfurlingInformationPopup.markPopupAsDismissed",environment:t,canUndo:!0,perform:t=>{!function(e){const{transaction:t,userSettingsStore:n,integrationId:i}=e;Jn().KY({store:(0,mt()._y)(n,n.pointer,["settings","dismissed_link_preview_integration_popup",i]),value:!0,transaction:t})}({transaction:t,userSettingsStore:n,integrationId:e})}})}n(18107),n(967357),n(354520);var ii=()=>n(617871),si=()=>n(506391),oi=()=>n(559926),ai=()=>n(650829),ri=()=>n(13898),li=()=>n(859004),di=()=>n(397740),ci=()=>n(461912);const ui=function(){const e=(0,l().uB)(ci().A),t=(0,r().v3)(),n=(0,i.useRef)(null),s=(0,r().Y0)(),[a,d]=(0,l().K8)((()=>[e.state.open,e.state.open?e.state.renderRect:void 0]),[e]);return(0,i.useEffect)((()=>{const e=e=>{a&&"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"Enter"!==e.key&&yi(t)},i=e=>{if(!a||!e.target||!n.current)return;const i=n.current;i&&i!==e.target&&yi(t)};return(0,qn().P)(window,"keydown",e),(0,qn().P)(window,"mousedown",i),()=>{(0,tn().O)(window,"keydown",e),(0,tn().O)(window,"mousedown",i)}}),[a,n,t]),(0,g.jsx)(C().zD,{popupType:s.isMobileNative&&!s.isTablet?_().n.SlideUp:_().n.Popup,open:Boolean(a&&d),originRect:a?d:void 0,placementToOrigin:"top",alignmentToOrigin:"start",originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:o().A.isMobile,keepFocus:o().A.isMobile,render:()=>(0,g.jsx)(pi,{}),onDismiss:yi})};function pi(){const e=(0,l().uB)(ci().A),t=(0,r().v3)(),n=(0,i.useRef)(null),s=(0,q().tz)(),[a,d,c,u]=(0,l().K8)((()=>[e.state.open,e.state.open?e.state.allOptionTypes:[],e.state.open?e.state.integration:void 0,e.state.open?e.state.url:void 0]),[e]),p=(0,x().IS)((()=>({header:o().A.isMobile?{display:"flex",justifyContent:"center",alignItems:"center",fontSize:16,fontWeight:G().Wy.semibold,background:W().Tj.background.secondary,height:45}:{paddingInlineStart:12,paddingInlineEnd:12,paddingTop:10,paddingBottom:4,color:W().Tj.text.secondary,fontSize:G().J.UISmall.desktop,fontWeight:450,font:"SF Pro"}})),[]);if(!a)return null;const m={fontSize:G().J.UIRegular.desktop,fontWeight:G().Wy.regular,font:"SF Pro"},f=(null==c?void 0:c.id)===ii().mn&&d.includes("import"),h={key:"embed section",render:e=>(0,g.jsx)(N().A,{...e,topBorder:0!==e.index}),items:d.filter((e=>"import"!==e)).map((e=>({key:e,render:n=>(0,g.jsx)(E().A,{...n,title:(0,g.jsx)(gi,{optionType:e,integration:c}),onMouseEnter:i=>{n.onMouseEnter(i),mi(e,s,t)},style:m}),action:()=>fi(e,t)})))},y=d.filter((e=>"import"===e)),v=y.length>0?{key:"import section",render:e=>(0,g.jsx)(N().A,{...e,topBorder:0!==e.index}),items:y.map((e=>({key:e,render:n=>(0,g.jsx)(vi,{props:n,optionType:e,integration:c,environment:t,intl:s,menuTextStyle:m}),action:()=>fi(e,t)})))}:void 0,b=(f?[v,h]:[h,v]).filter(Ft().O9);return(0,g.jsx)(ai().LazyAssistantUnfurlingMenuWithAiSection,{url:u,integration:c,headerStyle:p.header,menuTextStyle:m,updateUnfurlingOptionType:mi,handleDismiss:fi,renderMenu:({maybeAiActionSection:e})=>{let i;return i=o().A.isMobile?{menuType:R().gu.ActionSheet}:{menuType:R().gu.Popup,width:d.includes("import")?260:Boolean(e)?220:200,maxHeight:"40vh",onClickOutside:()=>yi(t)},(0,g.jsx)(L().A,{...i,className:I().Uvd,ref:n,header:(0,g.jsx)(D().A,{style:p.header,isSmall:!o().A.isMobile,isSecondaryColor:!o().A.isMobile,children:(0,g.jsx)(q().sA,{id:"embedMenu.header",defaultMessage:"Paste as"})}),children:(0,g.jsx)(O().A,{type:O().O.Vertical,sections:e?[...b,e]:b,initialFocus:0,onKeyboardArrow:n=>function(e,t,n,i){const s=ci().A.state;if(!s.open||void 0===e.indexGlobal)return;const o=s.allOptionTypes.at(e.indexGlobal);if(!o)return void(i&&mi("preview",t,n));mi(o,t,n)}(n,s,t,Boolean(e)),priority:1,disallowBackspace:!0})})}})}function gi({optionType:e,integration:t}){return"preview"===e?(0,g.jsx)(q().sA,{id:"unfurlingMenu.actions.pasteAsPreview.title",defaultMessage:"Preview"}):"mention"===e?(0,g.jsx)(q().sA,{id:"unfurlingMenu.actions.pasteAsMention.title",defaultMessage:"Mention"}):"link"===e?(0,g.jsx)(q().sA,{id:"unfurlingMenu.actions.pasteAsLink.title",defaultMessage:"URL"}):"drive"===e?(0,g.jsx)(q().sA,{id:"unfurlingMenu.actions.pasteAsDrive.title",defaultMessage:"Embed"}):"collection"===e?(0,g.jsx)(q().sA,{id:"unfurlingMenu.actions.pasteAsDatabase.title",defaultMessage:"Database"}):"import"===e?(null==t?void 0:t.id)===ii().me?(0,g.jsxs)("div",{style:{display:"flex"},children:[(0,g.jsx)(q().sA,{id:"unfurlingMenu.actions.import.jiraTitle",defaultMessage:"Sync Jira projects and issues"}),(0,g.jsx)("span",{style:{display:"inline",marginInlineStart:6},children:(0,g.jsx)(Q().A,{})})]}):(null==t?void 0:t.id)===ii().mn?(0,g.jsxs)("div",{style:{display:"flex"},children:[(0,g.jsx)(q().sA,{id:"unfurlingMenu.actions.import.salesforceTitle",defaultMessage:"Sync Reports"}),(0,g.jsx)("span",{style:{display:"inline",marginInlineStart:6},children:(0,g.jsx)(ri().A,{})})]}):(0,g.jsx)(q().sA,{id:"unfurlingMenu.actions.import.title",defaultMessage:"Import from {integration}",values:{integration:null==t?void 0:t.name}}):void(0,Ft().HB)(e)}function mi(e,t,n){at().createAndCommit({userAction:"UnfurlingMenu.handleMenuListKeyboardArrow",environment:n,canUndo:!1,perform:i=>{zn().setUnfurlingOptionType({environment:n,type:hi(e),useTemporaryRecordCache:!0,transaction:i,intl:t})}})}function fi(e,t){const n=ci().A.state;oi().Gp(t,{unfurl_option_type:e||"default",integration:n.open?n.integration.name:"default"}),"import"===e&&n.open?(at().createAndCommit({userAction:"UnfurlingMenu.handleDismiss",environment:t,canUndo:!0,perform:e=>{zn().close({environment:t,setType:"link",transaction:e})}}),function({environment:e,integration:t,url:n,blockStore:i}){var s,o;switch(t.id){case ii().MN:ce().Ay.setState({...ce().Ay.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:"asana",openedFrom:"link_paste"});break;case ii().Hd:const a=(0,si().WS)({url:n,integration:t});if(a){const e=a.find((e=>"title"===e.id)),t=null==e?void 0:e.values[0];di().A.setState({...di().A.state,selectedFileId:t})}ce().Ay.setState({...ce().Ay.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:"googleDocs",openedFrom:"link_paste"});break;case ii().wK:ce().Ay.setState({...ce().Ay.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:"trello",openedFrom:"link_paste"});break;case ii().me:const r=i&&(null===(s=(0,w().U)(i))||void 0===s?void 0:s.id),l=/\/projects\/(\w+)\//,d=null===(o=n.match(l))||void 0===o?void 0:o[1];de().Ay.setState({...de().Ay.state,teamSpaceId:r,projectKeys:d?[d]:[]}),$().j({environment:e,from:"external_object_instance_block",action:"show_teamspaces"});const c=de().Ay.createNewFlowId();(0,y().u)({environment:e,event:{eventName:"external_sync_entry_point",eventProperties:{integration:"jira",from:"link_paste_menu",flowId:c}}});break;case ii().mn:li().M2({url:n,environment:e,from:"external_object_instance_block",integration:t,blockStore:i})}}({environment:t,integration:n.integration,url:n.url,blockStore:n.stores.blockStore})):at().createAndCommit({userAction:"UnfurlingMenu.handleDismiss",environment:t,canUndo:!0,perform:n=>{zn().close({environment:t,setType:e?hi(e):void 0,transaction:n})}})}function hi(e){return"import"===e?"link":e}function yi(e){fi(void 0,e)}function vi({props:e,optionType:t,integration:n,environment:i,intl:s,menuTextStyle:o}){return(0,g.jsx)(E().A,{...e,title:(0,g.jsx)(gi,{optionType:t,integration:n}),onMouseEnter:n=>{e.onMouseEnter(n),mi(t,s,i)},style:o})}var bi=()=>n(429816),Si=(n(823215),()=>n(461106)),xi=()=>n(197959),Mi=()=>n(182641),Ai=()=>n(725332),ji=()=>n(655236),wi=()=>n(835066),Ii=()=>n(517223),ki=()=>n(644914),Ti=()=>n(737230),Ci=()=>n(372154),_i=()=>n(933922),Pi=()=>n(782482),Bi=()=>n(611648),Ri=()=>n(463438),Di=()=>n(273321),Li=()=>n(143943),Ei=()=>n(555776),Oi=()=>n(116008),Ni=()=>n(151838),Fi=()=>n(507463);const Ui=[Ci().c.Open,Ci().c.Resolved],zi="block_menu";const Ki=function(e){const{discussionIds:t,blockStore:s,recursivelyLoadAllDiscussions:a,tab:d,property_id:c}=e,u=(0,r().v3)(),p=(0,q().tz)(),{resolved:m,unresolved:f}=(0,l().K8)((()=>{const e=(void 0!==t&&t.length>0?[...new Set(t)].map((e=>Si().c.createChildStore(s,{table:xi().$Y,id:e,spaceId:s.getSpaceId()}))):_t().Bw(s,{recursivelyLoadAllDiscussions:a,includePropertyDiscussions:!0})).filter((e=>{if(t&&!t.includes(e.id)&&!_t().j3(e))return!1;return!Boolean(c)||e.getPropertyId()===c})).sort(((e,t)=>t.getReactionStores().length-e.getReactionStores().length)),{resolved:n,unresolved:i}=_t().uy(e);return 0===i.length?{resolved:n,unresolved:i}:{resolved:[],unresolved:i}}),[s,a,t,c]),h=(0,i.useRef)([]);(0,i.useEffect)((()=>{const e=f.filter((e=>(0,ji().s)({discussionStore:e,navigableBlockStore:s.getNavigableBlockStore()})));h.current=e}),[f,s]);const y=(0,x().IS)((()=>({closeButton:{position:"absolute",insetInlineEnd:10,borderRadius:"50%",background:W().Tj.background.tertiaryTranslucent}})),[]),v=(0,i.useCallback)((()=>{if(f.length>0){const e=f.filter((e=>h.current.includes(e)));(0,Ai().X)({environment:u,discussionStores:e})}Mi().xl()}),[u,f]);let b;return b=o().A.isMobile?{menuType:R().gu.Modal,title:t&&t.length>1?(0,g.jsx)(q().sA,{defaultMessage:"Discussions",id:"multipleBlockDiscussionMenu.mobileMenuSheet.title"}):(0,g.jsx)(q().sA,{defaultMessage:"Discussion",id:"singleBlockDiscussionMenu.mobileMenuSheet.title"}),header:(0,g.jsx)(Gi,{tab:d,resolved:m,unresolved:f}),right:(0,g.jsx)(ke().A,{icon:Zn().xMarkFillIcon,style:y.closeButton,onClick:v,ariaLabel:p.formatMessage({id:"blockDiscussionMenu.closeButton.ariaLabel",defaultMessage:"Close"})}),onClickRight:v,whiteBackground:!0,height:"100%"}:{menuType:R().gu.Popup,header:(0,g.jsx)(Gi,{tab:d,resolved:m,unresolved:f}),width:480,maxHeight:"50vh",onClickOutside:v},(0,g.jsx)(n(329661).A,{capture:!0,preventType:Bi().A.All,children:(0,g.jsx)(_i().A,{capture:!0,allowMobileAutoScroll:!0,render:()=>(0,g.jsx)(Pi().N,{debugName:"BlockDiscussionMenu",capture:!0,onEsc:v,onBackspace:Wi,onDelete:Wi,children:(0,g.jsx)(Ni().A,{store:s,droppable:!0,render:()=>(0,g.jsx)(L().A,{...b,children:(0,g.jsx)(Yi,{tab:d,blockStore:s,resolved:m,unresolved:f,onDismiss:v})})},s.id)})})})};function Vi({message:e}){const t=(0,x().IS)((()=>({emptyState:{textAlign:"center",padding:o().A.isMobile?"64px 18px":"32px 18px 36px",fontSize:14,color:W().Tj.text.secondary}})),[]);return(0,g.jsx)("div",{style:t.emptyState,children:e})}function qi(e){const t=Ci().A.state;t.open&&Ci().A.setState({...t,tab:Ui[e]})}function Wi(e){null==e||e.preventDefault(),Mi().xl()}function Gi({tab:e,resolved:t,unresolved:n}){const i=(0,r().v3)(),{device:s}=i,o=n.length,a=t.length,l=(0,x().IS)((()=>({openCountStyle:{color:W().Tj.text.tertiary},resolvedCountStyle:{color:W().Tj.text.disabled}})),[]);return 0===a||0===o?null:(0,g.jsx)(Ri().LZ,{tabs:[(0,g.jsxs)("div",{children:[(0,g.jsx)(q().sA,{defaultMessage:"Open",id:"blockDiscussionMenu.openDiscussionsTab.title"},"openDiscussionsTitle")," ",(0,g.jsx)("span",{style:l.openCountStyle,children:o})]},"openDiscussions"),(0,g.jsxs)("div",{children:[(0,g.jsx)(q().sA,{defaultMessage:"Resolved",id:"blockDiscussionMenu.resolvedDiscussionsTab.title"},"resolvedDiscussionsTitle")," ",(0,g.jsx)("span",{style:l.resolvedCountStyle,children:a})]},"resolvedDiscussions")],selectedIndex:Ui.indexOf(e),onChange:qi,style:{...s.isAndroid&&{borderBottom:"none"}}})}function Hi(e){const{value:t}=(0,d().fJ)(Ye().commentsDependency),n=(0,r().v3)(),i=(0,l().K8)((()=>Oi().A.state.open&&Ei().A.state.overlapsExistingDiscussionMenu),[]),s=(0,l().K8)((()=>Ci().A.state.open&&Ci().A.state.tab===Ci().c.Open),[]),o=(0,l().K8)((()=>Ci().A.state.open&&Ci().A.state.keepNewDiscussionAtBottom),[]),a=(0,l().K8)((()=>(Oi().A.state.open&&Ei().A.state.overlapsExistingDiscussionMenu)??!1),[]);if(0===e.discussionStores.length)return null;const c=o?e.discussionStores[0]:void 0;return(0,g.jsxs)(g.Fragment,{children:[t?e.discussionStores.slice(c?1:0).map(((n,i,s)=>(0,g.jsx)(Ye().PW,{store:n,format:t.discussionHelpers.DiscussionFormat.Menu,isFirst:0===i,isOnly:1===s.length,discussionLocation:zi,showResolveButtonByDefaultIfPossible:!1,blockStore:e.blockStore,onDismiss:e.onDismiss},n.id))):void 0,c&&t?(0,g.jsx)(Ye().PW,{store:c,format:t.discussionHelpers.DiscussionFormat.Menu,isFirst:1===e.discussionStores.length,isOnly:1===e.discussionStores.length,discussionLocation:zi,showResolveButtonByDefaultIfPossible:!1,blockStore:e.blockStore,onDismiss:e.onDismiss},c.id):void 0,i&&s?(0,g.jsx)(Di().A,{environment:n,shouldShowTopDividerLine:!0,shouldExpandDiscussionWidth:a,noBackgroundColors:!0}):void 0]})}function Yi({tab:e,blockStore:t,resolved:n,unresolved:s,onDismiss:a}){const r=(0,Li().C)({type:"discussionLocation",location:zi}),c=(0,l().K8)((()=>t.getType()),[t]),u=(0,l().K8)((()=>Fi().B(t)),[t]),{value:p}=(0,d().fJ)(Ye().commentsDependency);if(!p)return null;if(e===Ci().c.Open){if(s.length>0){const e=c&&(0,Ft().O)(F().kt,c);return o().A.isMobile&&e&&u&&!r?(0,g.jsxs)(i.Fragment,{children:[(0,g.jsx)("div",{style:{padding:"12px 16px",boxShadow:`0 1px 0 ${W().Tj.border.secondaryTranslucent}`,marginBottom:1},children:(0,g.jsx)(u,{store:t,disabled:!0,hideContent:!0,style:{fontSize:14,pointerEvents:"none"},isQuickFind:!0})}),(0,g.jsx)(Hi,{discussionStores:s,blockStore:t,onDismiss:a})]}):(0,g.jsx)(Hi,{discussionStores:s,blockStore:t,onDismiss:a})}return(0,g.jsx)(Vi,{message:(0,g.jsx)(q().sA,{defaultMessage:"No comments to show.",id:"blockDiscussionMenu.emptyState.noCommentsMessage"})})}return n.length>0?(0,g.jsx)(Hi,{discussionStores:n,blockStore:t,onDismiss:a}):(0,g.jsx)(Vi,{message:(0,g.jsx)(q().sA,{defaultMessage:"No resolved comments.",id:"blockDiscussionMenu.emptyState.noResolvedCommentsMessage"})})}const $i=function(){const e=(0,r().v3)(),t=(0,r().Y0)(),n=(0,l().K8)((()=>Ci().A.state.rect),[]),s=(0,i.useRef)([]),a=(0,l().K8)((()=>Ci().A.state.open),[]);(0,i.useEffect)((()=>{const e=Ci().A.state;if(!a||!e.open)return;const{blockStore:t}=e,{spaceId:n}=t.pointer;if(!n)return;const i=Ci().A.getOpenDiscussionIds().map((e=>Si().c.createChildStore(t,{table:xi().$Y,id:e,spaceId:n}))).filter((e=>!(0,ji().s)({discussionStore:e,navigableBlockStore:t.getNavigableBlockStore()}))).map((e=>e.id));s.current=i}),[a]);const d=(0,l().K8)((()=>{if(!Ci().A.state.open)return!1;let t=!1;const n=Ci().A.state.property_id;if(Ci().A.state.open&&n){var i;const e=null===(i=Ci().A.state.blockStore)||void 0===i||null===(i=i.getAssociatedCollectionStore())||void 0===i?void 0:i.getLayoutStore();e&&(t=(0,Ii().Hc)({layoutStore:e,propertyId:n}).isPropertyInPageDetails)}const s=(0,wi().$N)(e,Ci().A.state.blockStore),o=Ti().Ay.state.currentTab===Ti().tF.Comments&&(0,ki().Nk)(e);if(t)return!0;if(o)return!1;if(!s)return!0;if(Ci().A.state.discussionIds&&Ci().A.state.discussionIds.length>0){const e=wi().Ob.state;if(!Ci().A.state.discussionIds.every((t=>e.some((e=>e.id===t)))))return!0}return!1}),[e]),c=(0,i.useCallback)((()=>{const t=Ci().A.state;if(t.open){const{blockStore:n}=t,{spaceId:i}=n.pointer;if(i){const t=Ci().A.getOpenDiscussionIds().map((e=>Si().c.createChildStore(n,{table:xi().$Y,id:e,spaceId:i}))).filter((e=>!s.current.includes(e.id)));(0,Ai().X)({environment:e,discussionStores:t})}}Mi().xl()}),[e]),u=(0,l().O$)(Ci().A),p=(0,i.useCallback)((()=>{if(u.open)return(0,g.jsx)(Ki,{tab:u.tab,blockStore:u.blockStore,discussionIds:u.discussionIds,recursivelyLoadAllDiscussions:u.recursivelyLoadAllDiscussions,property_id:u.property_id})}),[u]),m=o().A.isMobile?_().n.BottomSheet:_().n.Popup;return(0,g.jsx)(C().zD,{popupType:m,bottomSheetBackgroundColor:"primary",bottomSheetInitialState:t.isPhone?"full":"half",open:d,originRect:n,placementToOrigin:"bottom",alignmentToOrigin:"center",disableMouseCapture:!0,originGap:4,render:p,preventScaleTransition:!0,preventOpacityTransition:!0,onDismiss:c,trapFocus:!1})};var Qi=()=>n(807449),Zi=()=>n(755956),Xi=()=>n(925193),Ji=()=>n(847832),es=()=>n(412975),ts=()=>n(471415),ns=()=>n(541372),is=()=>n(177163),ss=()=>n(732067),os=()=>n(949575),as=()=>n(945710),rs=()=>n(520937),ls=()=>n(310770),ds=()=>n(911339),cs=()=>n(607833),us=()=>n(486674),ps=()=>n(495159),gs=()=>n(84349),ms=()=>n(525569);const fs=(0,q().YK)({createTransclusion:{defaultMessage:"Paste and sync",id:"blockPasteMenu.actions.createTransclusion.title"},linkToPage:{defaultMessage:"Link to page",id:"blockPasteMenu.actions.linkToPage.title"},dismissItem:{defaultMessage:"Dismiss",id:"blockPasteMenu.actions.dismiss.title"},pasteItem:{defaultMessage:"Paste",id:"blockPasteMenu.actions.paste.label"},suggestedActionsSectionTitle:{defaultMessage:"Suggested actions",id:"blockPasteMenu.actions.suggestedActionsSectionTitle"}});const hs=function(){const e=(0,r().Y0)(),t=(0,r().v3)(),s=(0,l().O$)(gs().A),{stores:a,phase:d}=(0,l().O$)(it().default);(0,i.useEffect)((()=>{s.open&&((0,Ln().A)(a,s.blocks)&&d===n(60481).o.Selected||ns().VN(t))}),[s,a,d,t]);const c=(0,i.useCallback)((()=>{ns().VN(t)}),[t]),u=s.open&&"ai_actions"===s.type;return(0,g.jsx)(C().zD,{popupType:e.isMobileNative&&!e.isTablet?_().n.SlideUp:_().n.Popup,open:s.open,originRect:s.open?s.rect:void 0,placementToOrigin:u?"right":"bottom",alignmentToOrigin:u?"start":"end",originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:o().A.isMobile,keepFocus:o().A.isMobile,render:()=>(0,g.jsx)(vs,{}),onDismiss:c,disableFlippingPlacement:u})};function ys(e){const t=(0,q().tz)(),{menuItemProps:n}=e,i=o().A.isMobile?{mobileIconStyle:{marginInlineStart:18,marginInlineEnd:2}}:{};return(0,g.jsx)(E().A,{...n,title:t.formatMessage(ps().VT.askAI),icon:(0,g.jsx)(ss().vF,{}),...i})}function vs(){const e=(0,q().tz)(),t=(0,r().v3)(),n=(0,x().eP)(),i=(0,s().X)("agent_writer"),a=(0,l().K8)((()=>{var e;return null===(e=(0,us().a)())||void 0===e?void 0:e.getSpaceId()}),[]),d=(0,l().K8)((()=>{const s=gs().A.state;return s.open?"ai_actions"===s.type?function(e){var t;const{environment:n,themeMode:i,isAgentWriterEnabled:s,intl:a}=e,r=(0,us().a)();if(!r)return null;const l=(0,os().clientSkillToAssistantSurfaceAction)((0,as().getAllClientSkills)({currentPageRecordPointer:void 0,currentCollectionRecordPointer:void 0})),d={type:"entrypoint",entrypoint:"blockPasteMenu",isMobile:o().A.isMobile,pageStore:r,selectionState:it().default.state,textSelectionState:T().default.state,userSettings:null===(t=v().default.state.currentUserSettingsStore)||void 0===t?void 0:t.getSettings()},c=(0,os().filterAssistantSurfaceActionsForContext)(l,d),u=(0,ls().d7)({assistantSuggestionContext:d,validatedActions:c}).filter(as().isAssistantSurfaceActionWithClientSkill).map((e=>({...e,isSuggested:!0}))),p=(0,os().clientSkillToAssistantSurfaceAction)(u),m=(0,Xi().gC)(),f={key:"ai_actions_paste_menu",render:e=>(0,g.jsx)(N().A,{...e,title:a.formatMessage(fs.suggestedActionsSectionTitle)}),items:[{key:"paste",render:e=>(0,g.jsx)(E().A,{...e,icon:(0,g.jsx)(Qi().I,{icon:es().arrowTurnDownLeftIcon}),title:a.formatMessage(fs.pasteItem)}),action:()=>{(0,y().u)({environment:n,event:{eventName:"block_paste_menu_action",eventProperties:{type:"ai_actions",action:"paste"}}}),ns().VN(n)}},...p.map((e=>({key:e.skillType,render:t=>(0,g.jsx)(E().A,{...t,title:a.formatMessage(cs().DZ.writerGlobalSkill,{displayName:a.formatMessage(e.displayName),acceptsParameters:(0,Ji().yH)(e.skillType)||(0,Ji().SH)(e.skillType)}),icon:(0,g.jsx)(ts().O1,{svg:e.icon,svgFill:(0,rs().vJ)(e.category).color(i).color})}),action:async()=>{try{if((0,y().u)({environment:n,event:{eventName:"block_paste_menu_action",eventProperties:{type:"ai_actions",action:"client_skill",skill_type:e.skillType}}}),s&&(0,Zi().R)(e.skillType))return ns().VN(n),void(await(0,is().toggleInitialPrompt)({from:"block_paste_menu",environment:n,agentPrebuiltPromptType:e.skillType}));ns().VN(n),await(0,is().toggleInitialPrompt)({from:"block_paste_menu",environment:n,sessionId:m});const t=ms().default.state;if(!t||"assistantCompletionPopup"!==t.type||"initialPrompt"!==t.stage)return;await ds().assistantWriterActions.triggerAssistantSkillCompletion({environment:n,context:t.context,clientSkillWithParameterValues:(0,as().dangerouslyCreateClientSkillWithParameterValues)(e),updater:ms().default.createUpdater(),sessionId:m,from:"block_paste_menu",assistantSurfaceType:o().A.isMobile?"mobileWriter":"writer"})}catch{Bn().log({level:"info",from:"BlockPasteMenu",type:"triggerAssistantSkillCompletionError",error:{message:"Error triggering assistant skill completion"},data:{miscDataToConvertToString:{skillType:e.skillType}}})}}}))),{key:"ask_ai",render:e=>(0,g.jsx)(ys,{menuItemProps:e}),action:async()=>{try{(0,y().u)({environment:n,event:{eventName:"block_paste_menu_action",eventProperties:{type:"ai_actions",action:"ask_ai"}}}),ns().VN(n),await(0,is().toggleInitialPrompt)({from:"block_paste_menu",environment:n,sessionId:m})}catch{Bn().log({level:"info",from:"BlockPasteMenu",type:"triggerAssistantWriterError",error:{message:"Error opening assistant writer"}})}}}]};return[f]}({environment:t,themeMode:n,isAgentWriterEnabled:i,intl:e}):"blocks"===s.type||"links"===s.type?function(e,t,n,i){const{blocks:s}=e,o=[];if("blocks"===e.type){const{copiedStores:a,pageSource:r}=e;ns().GV({currentSpaceId:n,blocks:s,copiedStores:a})&&o.push({name:i.formatMessage(fs.createTransclusion),action:async()=>{(0,y().u)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:e.type,action:"create_transclusion"}}}),await ns().Ce({environment:t,blocks:s,copiedBlockIds:a.map((e=>e.id)),removeBlocks:!0})}}),ns().h8({blocks:s})&&o.push({name:i.formatMessage(fs.linkToPage),action:async()=>((0,y().u)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:e.type,action:"link_to_page"}}}),ns().Xw({environment:t,blocks:s,source:{type:"blocks",copiedStores:a,pageSource:r}}))})}return"links"===e.type&&o.push({name:i.formatMessage(fs.linkToPage),action:async()=>((0,y().u)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:e.type,action:"link_to_page"}}}),ns().Xw({environment:t,blocks:s,source:{type:"links",copiedLinks:e.copiedLinks}}))}),[{key:"embed section",render:e=>(0,g.jsx)(N().A,{...e}),items:[{key:"dismiss",render:e=>(0,g.jsx)(E().A,{...e,title:i.formatMessage(fs.dismissItem)}),action:()=>{(0,y().u)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:e.type,action:"dismiss"}}}),ns().VN(t)}},...o.map((({name:e,action:t})=>({key:`embed ${e}`,render:t=>(0,g.jsx)(E().A,{...t,title:e}),action:t})))]}]}(s,t,a,e):void(0,Ft().HB)(s):null}),[t,n,a,i,e]);if(null===d)return null;let c;return c=o().A.isMobile?{menuType:R().gu.ActionSheet}:{menuType:R().gu.Popup,width:320,maxHeight:"40vh"},(0,g.jsx)(L().A,{...c,className:I().poM,children:(0,g.jsx)(O().A,{type:O().O.Vertical,sections:d,initialFocus:0})})}var bs=()=>n(598790),Ss=()=>n(465628),xs=()=>n(978810),Ms=()=>n(712505);function As(e){const{e:t,environment:n,routingData:i,openInNew:s,peekModeForNavigation:o}=e;if("block"!==i.citationAnnotationData.type)return;const{blockId:a,spaceId:r,citationNumber:l}=i.citationAnnotationData;if(!a||!l)return;t.preventDefault&&t.preventDefault(),"stopPropagation"in t&&t.stopPropagation&&t.stopPropagation();const d=new(j().B)(n,{table:V().ev,id:a,spaceId:r});xs().O({environment:n,citedBlockStore:d,returnToBlockStore:i.fromBlockStore,openInNew:s,peekModeForNavigation:o})}function js(e){return"target"in e&&e.target instanceof HTMLElement&&null!==e.target.closest(".notion-peek-renderer")&&Ms().default.state.open?(0,Ms().getUrlParamFromPeekMode)(Ms().default.getPeekMode()):void 0}function ws(){const e=(0,r().v3)(),t=(0,l().K8)((()=>{const e=T().default.state;if("editing"!==e.mode)return;const t=(0,Ss().H)(e.multiSelection);if(!t)return;const n=(0,Pe().vv)(t);return n?{fromBlockStore:(0,bs().T)(t.store),citationAnnotationData:n}:void 0}),[]),n=(0,i.useCallback)((n=>{if(t)return As({e:n,environment:e,routingData:t,openInNew:"tab",peekModeForNavigation:js(n)})}),[e,t]),s=(0,i.useCallback)((n=>{if(t)return As({e:n,environment:e,routingData:t,openInNew:void 0,peekModeForNavigation:js(n)})}),[e,t]);return t?(0,g.jsx)(Pi().N,{debugName:"CitationListener",capture:!0,onEnter:s,onCommandEnter:n}):null}var Is=()=>n(121946),ks=()=>n(31511);const Ts=function(){const e=(0,r().v3)(),{device:t}=e,{active:n,stringValue:i,manualCopyMessage:s,manualCopyMessageValues:o}=(0,l().K8)((()=>{const{active:e,stringValue:t,manualCopyMessage:n,manualCopyMessageValues:i}=Is().A.state;return{active:e,stringValue:t,manualCopyMessage:n,manualCopyMessageValues:i}}),[]),a=window.innerWidth/2-150,d=window.innerHeight/2,c=s?(0,g.jsx)(q().sA,{...s,values:o}):t.isMobileNative?(0,g.jsx)(q().sA,{defaultMessage:"Tap to copy the link above",id:"clipboardInputRenderer.copyLink.mobile_message"}):(0,g.jsx)(q().sA,{defaultMessage:"Right click and copy the link above",id:"clipboardInputRenderer.copyLink.message"});return(0,g.jsx)(C().zD,{popupType:t.isMobileNative?_().n.SlideUp:_().n.Popup,open:n,originRect:{top:d,left:a},onDismiss:Cs,placementToOrigin:"bottom",alignmentToOrigin:"start",originGap:0,render:()=>(0,g.jsx)(Pi().N,{debugName:"ClipboardInputRenderer",capture:!0,onEnter:St().D_,onCommandEnter:St().D_,onCommandShiftEnter:St().D_,onCommandSlash:St().D_,onDelete:St().D_,onBackspace:St().D_,onEsc:St().D_,onLeft:St().D_,onRight:St().D_,onUntab:St().D_,onTab:St().D_,onSelectAll:St().D_,onRedo:St().D_,onUndo:St().D_,onToggleBold:St().D_,onToggleItalics:St().D_,onToggleStrike:St().D_,onToggleCode:St().D_,onCut:St().D_,onCopy:St().D_,onPaste:St().D_,onKeypress:St().D_,children:(0,g.jsxs)("div",{style:{padding:8,width:300},children:[(0,g.jsx)(ks().A,{style:{width:"100%",fontSize:12},value:i,focus:!0,textarea:!0,selectAll:!0,readOnly:!0}),(0,g.jsx)(D().A,{isSmall:!0,style:{marginTop:6,pointerEvents:"none"},children:c})]})})})};function Cs(){Is().A.setState({...Is().A.state,active:!1,stringValue:"",manualCopyMessage:void 0,manualCopyMessageValues:void 0})}var _s=()=>n(588264),Ps=()=>n(887480),Bs=()=>n(290247),Rs=()=>n(798880),Ds=()=>n(229833);function Ls(){const e=(0,r().v3)(),t=(0,wn().T)(),n=(0,Fn().r)(),s=(0,i.useCallback)((async n=>{const{spaceId:i}=n;if(!t)return;const s=await e.api.callCellCompatibleApi({eventName:"getSpacePermissionGroupIdsContainingMembers",environment:e,data:{spaceId:i,userIds:[t]},cellNavigation:{cellId:void 0,spaceId:i}});if("failed"===s.type)return void Bn().rateLimitedLog({from:"CurrentUserSpaceGroupMembershipListener",level:"error",type:"getSpacePermissionGroupIdsContainingMembers",spaceId:i,actor:{table:Rs().oo,id:t},error:(0,Ds().convertErrorToLog)(s.error)});const o=Bs()._.getState();Bs()._.setState({...o,[t]:{...o[t],[i]:{spacePermissionGroupIds:new Set(s.data.userToGroupMap[t]??[])}}})}),[e,t]);return Cn({eventKey:n&&t?(0,vt().BK)({spaceId:n,userId:t}):void 0,spaceId:n,onRefetch:s,deferForHiddenTabs:!0}),null}var Es=()=>n(666144),Os=()=>n(671432),Ns=()=>n(423219);function Fs(e){const{environment:t,pointers:n,userIdToCloneFrom:i}=e;for(const s of n)Es().PC({environment:t,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,pointer:s,model:t.defaultRecordCache.inMemoryRecordCache.getRecordModel({pointer:s,userId:i}),role:"reader",updatePaths:[[]],debugSource:"CustomEmojisListener"})}const Us=new(n(99895).G)((()=>0));const zs=function(){const e=(0,r().v3)(),[t,s]=(0,i.useState)(!1);(0,i.useEffect)((()=>{!async function(){await n(807054).waitForInitialPageRenderToComplete(),s(!0)}()}),[]);const o=(0,l().K8)((()=>{var e;return null===(e=(0,n(87878).vZ)())||void 0===e?void 0:e.id}),[]),a=e.currentUser.id,d=(0,l().K8)((()=>{const e=Ns().A.getKeys();return o&&a?e.includes(o)?e:[...e,o]:e}),[o,a]);return function(e,t){const n=(0,r().v3)();(0,i.useEffect)((()=>{const i=Us.get(e)+1;Us.set(e,i);const s=()=>{};Object.defineProperty(s,"name",{configurable:!0,enumerable:!1,value:`useRetainRecordsInMemory(${e} ${i})`});for(const e of t)n.defaultRecordCache.inMemoryRecordCache.addListenerToRecord(e,s),Os().Ye({pointer:e,userId:n.currentUser.id});return()=>{for(const e of t)n.defaultRecordCache.inMemoryRecordCache.removeListenerToRecord(e,s),Os().N$({environment:n,pointer:e,userId:n.currentUser.id})}}),[e,n,t])}("CustomEmojis",(0,l().K8)((()=>{if(!t)return[];const n=[];for(const t of d){const i=Ns().A.getDataWithoutRefetch(e,{spaceId:t});if(!i)continue;const s=i.pointers,r=i.lastFetchedBy;t===o&&r!==a&&Fs({environment:e,pointers:s,userIdToCloneFrom:r}),n.push(...s)}return n}),[d,o,a,e,t])),function(e){const t=(0,r().v3)();(0,i.useEffect)((()=>{const n=[];for(const i of e){const e=gt().Ay.addListener((0,vt().VW)(i),void 0,(({value:e})=>{Ns().A.emit(t,{spaceId:i},e)}),void 0,t);e&&n.push(e)}return()=>{for(const e of n)gt().Ay.removeListener(e,t)}}),[t,e])}(d),null};var Ks=()=>n(755125),Vs=()=>n(597777),qs=()=>n(201980),Ws=()=>n(220719),Gs=()=>n(743336),Hs=()=>n(180252),Ys=()=>n(536131);const $s=function(){const e=(0,l().O$)(Ys().A);return(0,g.jsx)(C().zD,{popupType:o().A.isMobile?_().n.BottomSheet:_().n.Popup,open:e.open,originRect:e.originRect,onDismiss:Gs().V,render:()=>(0,g.jsx)(Qs,{shouldShowReminder:!!e.open&&e.allowReminders}),trapFocus:!0})};function Qs({shouldShowReminder:e}){const t=(0,r().v3)(),n=(0,l().K8)((()=>Zs()),[]);if(!n)return null;const i="default",{date_format:s,time_format:o,dateValue:a}=n;return(0,g.jsx)(d().u2,{dependency:Ze().cm,children:({DatePropertyMenu:n})=>(0,g.jsx)(n,{firstDayOfWeek:Hs().XX.state,value:a,canConfigureCollection:!0,onChangeValue:e=>function(e,t,n){if(!e)return void function(e,t){const n=Zs();if(!n)return;const{textStore:i,textValue:s,tokenIndex:o}=n,a=qs().AhH(s.slice(0,o)),r=qs().AhH(s.slice(0,o+1));at().createAndCommit({userAction:"DateMentionMenu.removeDateAnnotation",environment:e,canUndo:!0,perform:t=>{ot().jQ({environment:e,store:i,selection:{startIndex:a,endIndex:r},transaction:t})}})}(t);if(!Vs().kC(e))return;const i=Zs();if(!i)return;const{date_format:s,time_format:o}=i;Xs({date_format:s,time_format:o,...e},t,n)}(e,t,i),dateFormat:s,onChangeDateFormat:e=>function(e,t,n){const i=Zs();if(!i)return;const{dateValue:s,time_format:o}=i;Xs({date_format:e,time_format:o,...s},t,n)}(e,t,i),timeFormat:o,onChangeTimeFormat:e=>function(e,t,n){const i=Zs();if(!i)return;const{dateValue:s,date_format:o}=i;Xs({date_format:o,time_format:e,...s},t,n)}(e,t,i),onDismiss:Gs().V,disabled:!1,shouldShowReminder:e,isTemplatePage:!1})})}function Zs(){const e=Ys().A.state;if(e.open){const{textStore:t,tokenIndex:n}=e,i=t.getValue();if(i){const e=i[n];if(e){(0,Ws().MX)(qs().qXl(e),"Token should be a mention token");const s=qs().uPN(e),o=qs().$CJ(s);if(o){const{date_format:a,time_format:r,...l}=qs().K7D(o);return{textStore:t,textValue:i,tokenIndex:n,token:e,annotations:s,date_format:a,time_format:r,dateValue:l}}}}}}function Xs(e,t,n){const i=Zs();if(!i)return;const{textStore:s,textValue:o,tokenIndex:a,token:r,annotations:l}=i,d=l.map((t=>qs().qsB(t)?["d",e]:t)),c=qs().Ey_(r[0],d),u=qs().AhH(o.slice(0,a)),p=qs().AhH(o.slice(0,a+1));at().createAndCommit({userAction:"DateMentionMenu.setDateAnnotationData",environment:t,canUndo:!0,perform:e=>{ot().jQ({environment:t,store:s,selection:{startIndex:u,endIndex:p},transaction:e}),ot().yr({environment:t,store:s,tokens:[c],index:u,transaction:e}),b().default.checkGate({gateName:"mobile_clear_selection_on_date_mention_menu_change_kill_switch"})||(0,Ks().clear)({environment:t})}})}var Js=()=>n(756117),eo=()=>n(205262),to=()=>n(908006),no=()=>n(121924),io=()=>n(243838),so=()=>n(631524),oo=()=>n(522419),ao=()=>n(630230),ro=()=>n(973238),lo=()=>n(526278),co=()=>n(940563),uo=()=>n(709550),po=()=>n(617668),go=()=>n(343666),mo=()=>n(124952),fo=()=>n(50556),ho=()=>n(35622),yo=()=>n(391214),vo=()=>n(691809),bo=()=>n(640867);const So={background:"rgba(255, 255, 255, 0.055)"},xo={padding:"6px 10px 6px 6px"},Mo={padding:"6px 6px 6px 10px"},Ao={display:"flex",borderRadius:4,background:W().IF.blackWithAlpha(.65)},jo=.25,wo=.5,Io=.5,ko=2,To=1/wo,Co=-.002,_o=-.004;function Po(){const e=(0,r().v3)(),t=(0,i.useRef)(!1),n=(0,i.useRef)(),s=(0,i.useRef)(),[o,a]=(0,i.useState)(!1),[d,c]=(0,i.useState)(void 0),[u,p]=(0,i.useState)(!1),{isOpen:m,rendered:f,fullScreenNodeRect:h,fullscreenNodeAnimationComplete:y,contentAspectRatio:v,zoomScale:b,panOffset:S,skipAnimations:x,isSaving:M,blockStore:A,panStartPosition:j}=(0,l().K8)((()=>{var e;const{state:t}=bo().A;return{isOpen:t.isOpen,rendered:null===(e=t.renderFullScreenNode)||void 0===e?void 0:e.call(t),fullScreenNodeRect:t.fullScreenNodeRect,fullscreenNodeAnimationComplete:t.fullscreenNodeAnimationComplete,contentAspectRatio:t.contentAspectRatio,zoomScale:t.zoomScale,panOffset:t.panOffset,skipAnimations:t.skipAnimations,isSaving:Boolean(t.isSaving),blockStore:t.blockStore,panStartPosition:t.panStartPosition}}),[]),w=(0,l().K8)((()=>{const t=e.WindowSizeStore.state.width;return ho().wX(t)}),[e.WindowSizeStore]);(0,no().A)({capture:m,preventType:Bi().A.All});const I=(0,i.useCallback)((()=>{n.current&&clearTimeout(n.current)}),[]),k=(0,i.useCallback)((()=>{p(!0),I(),o||M||(n.current=setTimeout((()=>p(!1)),2e3))}),[I,o,M]),T=(0,i.useCallback)((e=>{k();const t=Math.max(Math.min(e,ko),Io),n=t<=1?{x:0,y:0}:S;bo().A.setState({...bo().A.state,zoomScale:t,panOffset:n})}),[S,k]),C=(0,i.useCallback)((e=>{const t=$o(e,d);t&&(e.x!==t.x&&(j.x=j.x+(e.x-t.x)),e.y!==t.y&&(j.y=j.y+(e.y-t.y)),bo().A.setState({...bo().A.state,panOffset:t,panStartPosition:j}))}),[d,j]),_=(0,i.useCallback)((()=>{a(!1),bo().A.setState({...bo().A.state,zoomScale:1,panStartPosition:{x:0,y:0},panOffset:{x:0,y:0}})}),[]),P=(0,i.useCallback)((()=>{a(!0),I()}),[I]),B=(0,i.useCallback)((()=>{a(!1),k()}),[k]),R=(0,i.useCallback)(((t=!1)=>{ho().VN(),(0,mo().d)(e,{type:"close",triggered_by:t?"keypress":"click"}),(0,Be().I)({environment:e}),Yo(),to().default.afterNextFlush((()=>{_()}))}),[e,_]),D=(0,i.useCallback)((e=>{(0,eo().V)(e)||R()}),[R]),L=(0,i.useCallback)((e=>{if(e.stopPropagation(),(0,eo().V)(e))return;let t,n;t=b<1?1:b<1.5?1.5:1,n=t<=1?{x:0,y:0}:$o({x:(window.innerWidth/2-e.clientX)/(t/(t-1)),y:(window.innerHeight/2-e.clientY)/(t/(t-1))},d)??S,bo().A.setState({...bo().A.state,zoomScale:t,panOffset:n}),k(),B()}),[d,B,S,k,b]),E=(0,i.useCallback)(((t,n=!1)=>{if(!A)return;const i=No();if(!i)return;const o=i.findIndex((e=>e.id===A.id));if(o+t<0||o+t>=i.length)return;(0,mo().d)(e,{type:t>0?"next":"previous",image_count:i.length,image_index:o+t,triggered_by:n?"keypress":"click"}),bo().A.setState({...bo().A.state,skipAnimations:!0}),s.current&&clearTimeout(s.current),s.current=setTimeout((()=>{bo().A.setState({...bo().A.state,skipAnimations:!1})}),250);const a=i[o+t];yo().iy({environment:e,blockStore:a}),_()}),[A,e,_]),O=(0,i.useCallback)(((e=!1)=>{E(-1,e)}),[E]),N=(0,i.useCallback)(((e=!1)=>{E(1,e)}),[E]),F=(0,i.useCallback)(((t=!1)=>{let n=Math.ceil((b-wo)*To)/To;b-n<jo&&(n-=wo),(0,mo().d)(e,{type:"zoom_out",new_zoom:n,triggered_by:t?"keypress":"click"}),T(n)}),[e,T,b]),U=(0,i.useCallback)(((t=!1)=>{let n=Math.floor((b+wo)*To)/To;n-b<jo&&(n+=wo),(0,mo().d)(e,{type:"zoom_in",new_zoom:n,triggered_by:t?"keypress":"click"}),T(n)}),[e,T,b]),z=(0,i.useCallback)((e=>{d&&1===e.buttons&&Fo()&&C({x:e.clientX/b-j.x,y:e.clientY/b-j.y})}),[d,j.x,j.y,C,b]),K=(0,i.useCallback)((e=>{switch(e.key){case"+":case"=":U(!0);break;case"-":case"_":F(!0)}}),[U,F]);(0,i.useEffect)((()=>{const e=e=>{T(b+e)},n=t=>{m&&(t.preventDefault(),t.ctrlKey?t.deltaY?e(t.deltaY*_o):t.deltaX&&e(t.deltaX*_o):t.metaKey?t.deltaY?e(t.deltaY*Co):t.deltaX&&e(t.deltaX*Co):Fo()&&C({x:S.x-t.deltaX,y:S.y-t.deltaY}))};return m&&(window.addEventListener("wheel",n,{passive:!1}),t.current=!0),()=>{window.removeEventListener("wheel",n),t.current=!1}}),[m,S.x,S.y,C,T,b]);const V=window.innerWidth,q=window.innerHeight-2*w;let W=V-2*w;const G=v??(h?h.width/h.height:void 0);if(void 0===G)return null;let H=W/G;if(H>q){const e=H/q;H/=e,W/=e}const Y={opacity:0},$={scale:b,opacity:1,translateX:S.x,translateY:S.y,width:"100%",height:"100%"};let Q;return Q=u?b>=1.5?"zoom-out":"zoom-in":"none",(0,g.jsx)(an().O,{open:m||!y,children:(0,vo().A)((e=>(0,g.jsx)(Pi().N,{debugName:"FullScreenRenderer",capture:m,onEsc:()=>{R(!0)},onEnter:St().D_,onSpace:()=>R(!0),onCommandEnter:()=>R(!0),onCommandShiftEnter:St().D_,onCommandSlash:St().D_,onUp:St().D_,onDown:St().D_,onDelete:St().D_,onBackspace:St().D_,onLeft:()=>O(!0),onRight:()=>N(!0),onUntab:St().D_,onTab:St().D_,onSelectAll:St().D_,onRedo:St().D_,onUndo:St().D_,onToggleBold:St().D_,onToggleItalics:St().D_,onToggleStrike:St().D_,onToggleCode:St().D_,onCut:St().D_,onCopy:St().D_,onPaste:St().D_,onKeypress:K,children:(0,g.jsxs)("div",{style:Qo({isOpen:m,showControls:u}),...e,onClick:D,onMouseMove:k,children:[m?(0,g.jsx)(io().B,{}):void 0,(0,g.jsx)(Js().A,{visible:m,initial:Y,exit:Y,animate:$,skip:x,forceCompositeLayer:!0,style:{display:"flex",cursor:Q,maxWidth:W,maxHeight:H,justifyContent:"center"},ref:e=>{e&&!d&&c({width:e.clientWidth,height:e.clientHeight})},onClick:L,onMouseDown:Ho,onMouseUp:Yo,onMouseLeave:Yo,onMouseMove:z,onAnimationEnd:Go,children:f}),(0,g.jsx)(Bo,{visible:u,isOpen:m,zoomScale:b,handleZoomIn:U,handleZoomOut:F,handlePrevious:O,handleNext:N,setZoomScale:T,disableZoomEditing:B,enableZoomEditing:P,clearHideControlsTimeout:I,resetHideControlsTimeout:k,isSaving:M,isEditingZoom:o,handleClose:R})]})})))})}function Bo({visible:e,isOpen:t,zoomScale:n,handleZoomIn:i,handleZoomOut:s,handleNext:a,handlePrevious:d,setZoomScale:c,disableZoomEditing:u,enableZoomEditing:p,resetHideControlsTimeout:m,clearHideControlsTimeout:f,isSaving:h,isEditingZoom:y,handleClose:v}){const b=(0,r().v3)(),{blockStore:S,imageUrl:x}=(0,l().K8)((()=>({blockStore:bo().A.state.blockStore,imageUrl:bo().A.state.imageUrl})),[]),M=(0,l().K8)((()=>{var e;return Boolean(S&&(x||(null===(e=S.getProperties())||void 0===e?void 0:e.source)&&qs().q4_(S.getProperties().source)))}),[S,x]);if(o().A.isMobile)return null;return(0,g.jsxs)(Js().A,{visible:e,initial:{opacity:1},exit:{opacity:0},animate:{opacity:1},style:Uo(t),onClick:e=>{!function(e){e.stopPropagation()}(e),m(),u()},children:[(0,g.jsx)("div",{style:{...Ao,marginInlineEnd:10},children:(0,g.jsx)(Do,{handlePrevious:d,handleNext:a})}),(0,g.jsxs)("div",{style:Ao,children:[(0,g.jsx)(Ro,{zoomScale:n,handleZoomIn:i,handleZoomOut:s,setZoomScale:c,disableZoomEditing:u,enableZoomEditing:p,isEditingZoom:y}),(0,g.jsx)(Wo,{}),M?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(Lo,{onClick:()=>{if(!S||!M)return;bo().A.setState({...bo().A.state,isSaving:!0}),f();const e=null==S?void 0:S.getProperties();let t,n;if(t=x||qs().q4_(null==e?void 0:e.source),t){if((0,oo()._J)(t)){const i=qs().q4_(null==e?void 0:e.title)||(0,oo().Jt)(t);n=fo().KE(b,{url:t,download:!0,downloadName:i,permissionRecord:S.pointer})}else{const i=qs().q4_(null==e?void 0:e.caption);n=(0,oo().pJ)(t,null==S?void 0:S.pointer,o().A.domainBaseUrl,b.currentUser.id,i)}n.then((()=>{bo().A.setState({...bo().A.state,isSaving:!1}),(0,mo().d)(b,{type:"download",triggered_by:"click"}),m()}))}},loading:h}),(0,g.jsx)(Wo,{})]}):void 0,(0,g.jsx)(Eo,{onClick:v})]})]})}function Ro({zoomScale:e,handleZoomIn:t,handleZoomOut:n,setZoomScale:s,disableZoomEditing:o,enableZoomEditing:a,isEditingZoom:l}){const d=(100*e).toFixed(0),c=(0,r().v3)(),u=(0,i.useCallback)((e=>{const t=e.target,n=parseInt(t.value);if(!isNaN(n)){const e=n/100;(0,mo().d)(c,{type:"set_zoom",new_zoom:e}),s(e)}o()}),[o,c,s]);return(0,g.jsxs)("div",{style:{alignItems:"center",display:"flex",height:"100%",justifySelf:"flex-start"},children:[(0,g.jsx)(Te().m,{renderTooltip:()=>(0,g.jsx)(qo,{primaryText:(0,g.jsx)(q().sA,{id:"fullScreenRenderer.zoomOut",defaultMessage:"Zoom out"}),secondaryText:"-"}),disableTooltip:e<=Io,render:t=>(0,g.jsx)(so().p,{...t,disabled:e<=Io,style:{...Ko(e<=Io),...Mo},onClick:n,iconLeading:{icon:uo().o,size:"sm",colorVariant:"inversePrimary"}})}),l?(0,g.jsx)(Oo,{initialValue:d,onSubmit:u,onCancel:o,primaryColor:W().oZ.white,secondaryColor:zo()}):(0,g.jsx)(so().p,{onClick:e=>{e.stopPropagation(),a()},style:{color:zo(),margin:0,width:46,padding:0,justifyContent:"center"},children:`${d}%`}),(0,g.jsx)(Te().m,{renderTooltip:()=>(0,g.jsx)(qo,{primaryText:(0,g.jsx)(q().sA,{id:"fullScreenRenderer.zoomIn",defaultMessage:"Zoom in"}),secondaryText:"+"}),disableTooltip:e>=ko,render:n=>(0,g.jsx)(so().p,{...n,disabled:e>=ko,style:Ko(e>=ko),onClick:t,iconLeading:{icon:po().plusIcon,colorVariant:"inversePrimary"}})})]})}function Do({handlePrevious:e,handleNext:t}){const n=(0,g.jsx)("div",{}),{blockStore:i,allImageBlocksOnPage:s}=(0,l().K8)((()=>{const{blockStore:e}=bo().A.state;return{blockStore:e,allImageBlocksOnPage:e?No():[]}}),[]);if(!i)return n;if(s.length<=1)return n;const o=s.findIndex((e=>e.id===(null==i?void 0:i.id)))??-1;if(-1===o)return n;const a=s.length;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(Te().m,{renderTooltip:()=>(0,g.jsx)(qo,{primaryText:(0,g.jsx)(q().sA,{id:"fullScreenRenderer.previous",defaultMessage:"Back"}),secondaryText:(0,g.jsx)(Vo,{imageIndex:o-1,totalImageCount:a})}),disableTooltip:0===o,render:t=>(0,g.jsx)(so().p,{...t,disabled:o<=0,style:{...Ko(o<=0),...Mo},hoveredStyle:So,onClick:()=>e(),iconLeading:{icon:lo().arrowStraightLeftIcon,colorVariant:"inversePrimary"}})}),(0,g.jsx)(Te().m,{renderTooltip:()=>(0,g.jsx)(qo,{primaryText:(0,g.jsx)(q().sA,{id:"fullScreenRenderer.next",defaultMessage:"Next"}),secondaryText:(0,g.jsx)(Vo,{imageIndex:o+1,totalImageCount:a})}),disableTooltip:o+1===a,render:e=>(0,g.jsx)(so().p,{...e,disabled:o>=a-1,style:{...Ko(o>=a-1),...xo},hoveredStyle:So,onClick:()=>t(),iconLeading:{icon:co().arrowStraightRightIcon,colorVariant:"inversePrimary"}})})]})}function Lo({onClick:e,loading:t}){return(0,g.jsx)(Te().m,{renderTooltip:()=>(0,g.jsx)(qo,{primaryText:(0,g.jsx)(q().sA,{id:"fullScreenRenderer.download",defaultMessage:"Download"})}),render:n=>(0,g.jsx)(so().p,{...n,disabled:t,onClick:e,style:Ko(!1),hoveredStyle:So,iconLeading:t?void 0:{icon:ro().arrowInCircleDownIcon,colorVariant:"inversePrimary"},isLoading:t})})}function Eo({onClick:e}){return(0,g.jsx)(Te().m,{renderTooltip:()=>(0,g.jsx)(qo,{primaryText:(0,g.jsx)(q().sA,{defaultMessage:"Close",id:"fullscreenRenderer.closeButton.label"}),secondaryText:"esc"}),render:t=>(0,g.jsx)(so().p,{...t,onClick:e,style:{...Ko(!1),...xo},hoveredStyle:So,iconLeading:{icon:ao().i,colorVariant:"inversePrimary"}})})}function Oo(e){const[t,n]=(0,i.useState)(e.initialValue);return(0,g.jsx)(ks().A,{style:{width:46,color:e.primaryColor},inputStyle:{textAlign:"center",border:"solid 1px rgba(45, 156, 219, 0.72)",borderRadius:4,boxShadow:"0px 0px 0px 3px rgba(45, 156, 219, 0.2)"},onClick:e=>e.stopPropagation(),onChange:e=>{const t=e.target;n(t.value)},value:t,onSubmit:e.onSubmit,focusInitial:!0,selectAll:!0,format:"transparent",right:(0,g.jsx)("span",{style:{color:e.secondaryColor},children:"%"}),onKeyDown:t=>{t.stopPropagation(),"Escape"===t.key?e.onCancel():"Tab"===t.key&&e.onSubmit(t)}})}function No(){const{blockStore:e}=bo().A.state;if(!e)return[];if(function(){const{blockStore:e}=bo().A.state;return(null==e?void 0:e.getParentTable())===go().SN}()){return e.getParentStore().getContentStores().filter((e=>"image"===e.getType())).filter((e=>Boolean(e.getProperties().source)))}const t=it().default.getCurrentRootStore();return tt().K.getMembersByDOMOrder({filter:e=>"image"===e.renderedType&&Boolean(e.getBlockStore().findRecordStoreUIAncestor((e=>Boolean(t&&e===t))).ancestor)}).map((e=>e.getBlockStore())).filter((e=>Boolean(e.getProperties().source)))}function Fo(){const{zoomScale:e}=bo().A.state;return e>1}function Uo(e){return{bottom:30,display:e?"flex":"none",fontSize:14,insetInlineStart:"50%",lineHeight:1.2,position:"absolute",transform:"translate(-50%, 0)"}}function zo(){return W().IF.whiteWithAlpha(.5)}function Ko(e){return{borderRadius:4,opacity:e?.4:1,padding:6}}function Vo({imageIndex:e,totalImageCount:t}){return(0,g.jsx)(q().sA,{values:{currentIndex:e+1,totalCount:t},defaultMessage:"{currentIndex} of {totalCount}",id:"fullscreenRenderer.imageCount.label"})}function qo(e){const{primaryText:t,secondaryText:n}=e;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("span",{style:{marginInlineEnd:n?4:void 0},children:t}),n?(0,g.jsx)("span",{style:{color:zo()},children:n}):void 0]})}function Wo(){return(0,g.jsx)("span",{style:{borderInlineStart:`1px solid ${W().IF.whiteWithAlpha(.25)}`,height:"100%"}})}function Go(){const{isOpen:e}=bo().A.state;e||bo().A.setState({...bo().A.state,fullscreenNodeAnimationComplete:!0})}function Ho(e){const{panOffset:t,zoomScale:n}=bo().A.state;bo().A.setState({...bo().A.state,panStartPosition:{x:e.clientX/n-t.x,y:e.clientY/n-t.y},skipAnimations:!0})}function Yo(){bo().A.setState({...bo().A.state,skipAnimations:!1})}function $o(e,t){if(!t)return;let n,i;n=t.width*ko>window.innerWidth?(t.width*ko-window.innerWidth)/(2*ko):(window.innerWidth-t.width*ko)/(2*ko),i=t.height*ko>window.innerHeight?(t.height*ko-window.innerHeight)/(2*ko):(window.innerHeight-t.height*ko)/(2*ko);return{x:Math.min(Math.max(e.x,-1*n),n),y:Math.min(Math.max(e.y,-1*i),i)}}function Qo(e){const{isOpen:t,showControls:n}=e;return{zIndex:999,position:"fixed",top:0,insetInlineStart:0,insetInlineEnd:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center",pointerEvents:t?"auto":"none",cursor:n?void 0:"none"}}var Zo=()=>n(834974),Xo=()=>n(311221),Jo=()=>n(148134),ea=()=>n(784489),ta=()=>n(754858),na=()=>n(144440),ia=()=>n(404783),sa=()=>n(120672),oa=()=>n(504023),aa=()=>n(977872),ra=()=>n(301809),la=()=>n(209199),da=()=>n(383036),ca=()=>n(363901),ua=()=>n(132855),pa=()=>n(474393);function ga(e){const t=(0,q().tz)(),n=(0,r().v3)(),{device:i}=n,s=(0,ca().A)(!0),{disabled:a,visible:l,onSubmit:d,animated:c,sendTooltip:u}=e;return(0,g.jsx)(Js().A,{initial:{opacity:0},exit:{opacity:0,position:"absolute"},animate:{opacity:1},skip:!c,visible:l,style:{display:"flex",flexDirection:"column-reverse",alignItems:"end",pointerEvents:l?void 0:"none",width:"min-content"},children:(0,g.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:o().A.isMobile?16:6},children:[i.isMobileBrowser?void 0:(0,g.jsx)(pa().m,{}),(0,g.jsx)(Te().m,{disableTooltip:!(0,Ft().O9)(u),renderTooltip:()=>u,render:e=>(0,g.jsx)(ke().A,{ariaLabel:t.formatMessage({id:"imageEditInput.sendButton.ariaLabel",defaultMessage:"Generate edited image"}),icon:ua().arrowInCircleUpFillIcon,onClick:d,colorPalette:a?void 0:"blue",colorVariant:a?"secondary":"accentPrimary",disabled:a,size:o().A.isMobile?"md":"sm",iconStyle:{height:o().A.isMobile?26:24,width:o().A.isMobile?26:24},...(0,da().A)(s,e)})})]})})}const ma=(0,q().YK)({placeholder:{id:"ImageEditInput.placeholder",defaultMessage:"Describe how to edit this image..."}}),fa=i.memo(i.forwardRef(ha));function ha(e,t){const a=(0,r().v3)(),{device:d}=a,c=(0,q().tz)(),u=(0,s().X)("editor_basic_rtl"),p=e.discussionInputStore,m=(0,l().O$)(p),{textStore:f}=m,[h,y]=(0,i.useState)(!1),b=(0,i.useRef)(null),S=(0,l().O$)(v().AppStoreSidebarSpaceViewStore),M=(0,n(219348).DV)(S),A=(0,l().K8)((()=>{const e=T().default.state;return"editing"===e.mode&&(0,k().K)(e.multiSelection)&&e.multiSelection.start.store===f}),[f]),{inputIsEmptyValue:j,inputHasNewLineCharacter:w}=(0,l().K8)((()=>({inputIsEmptyValue:(0,n(473975).inputIsEmpty)(p),inputHasNewLineCharacter:p.hasNewLineCharacter()})),[p]),C=A||!j,_=(0,i.useCallback)((()=>{var e;return null===(e=b.current)||void 0===e?void 0:e.focus()}),[]),{autoFocus:P=!1}=e;(0,i.useEffect)((()=>{P&&(async()=>{await xt().wR(10),await to().default.afterNextFlush(),(0,Ue().z)({store:f}),await to().default.afterNextFlush(),_()})()}),[P,f,_]);const B=C||h,R=(0,x().IS)((()=>({inputWrapper:{display:"flex",flex:1,minWidth:0,fontSize:14,borderRadius:6,transition:"background 300ms ease",cursor:B?"text":"pointer",alignSelf:"center",position:"relative",flexWrap:"wrap",justifyContent:"flex-end",background:"transparent",alignItems:"center",rowGap:4,columnGap:6,paddingTop:4,paddingInlineEnd:4,paddingBottom:3,paddingInlineStart:4,marginTop:-4,marginInlineEnd:-4,marginBottom:0,marginInlineStart:-4},textFieldStyle:{fontSize:14,maxHeight:d.isMobileNative?"50vh":"70vh",WebkitOverflowScrolling:"touch",userSelect:"auto",WebkitUserSelect:"auto",lineHeight:"20px",overflow:"auto",whiteSpace:"pre-wrap",padding:2,margin:-2},textFieldWrapper:{flexGrow:1,display:"flex",minHeight:24,paddingTop:2,width:w||o().A.isMobile?"100%":""},assistantFace:{width:24,height:24,borderRadius:"50%",backgroundColor:W().Tj.background.elevated,flexShrink:0,display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",userSelect:"none",marginTop:0,marginInlineEnd:8}})),[B,d.isMobileNative,w]),D=function(e){const{isEditing:t,textRef:n}=e;if(!t)return{};const i=e=>{"key"in e&&(e.metaKey||e.ctrlKey)&&n.current&&(0,ra().e)({store:n.current.getProps().store})},s=e=>{"key"in e&&(e.metaKey||e.ctrlKey)&&n.current&&(0,Ue().z)({store:n.current.getProps().store})};return{onUp:i,onDown:s}}({isEditing:A,textRef:b}),L=()=>{e.onSubmit()};return(0,g.jsx)(Pi().N,{debugName:"ImageEditInput",capture:A,onCommandEnter:St().D_,children:(0,g.jsx)("div",{className:I().rgg,style:ya,onFocus:t=>{const i=t.target;var s;i instanceof HTMLElement&&(0,n(819121).p)(i)&&(null===(s=e.onFocus)||void 0===s||s.call(e),y(!0))},onBlur:t=>{var n;null===(n=e.onBlur)||void 0===n||n.call(e),y(!1)},children:(0,g.jsxs)("div",{style:va,children:[(0,g.jsx)("div",{style:R.assistantFace,"aria-hidden":"true",children:(0,g.jsx)(n(761894).x,{accessory:M,variant:"xsmall"})}),(0,g.jsxs)("div",{onClick:_,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||_()},style:R.inputWrapper,tabIndex:-1,role:"textbox",children:[(0,g.jsx)("div",{dir:u&&(0,la().A1)()?"rtl":"auto",style:R.textFieldWrapper,children:(0,g.jsx)(Ee().A,{style:R.textFieldStyle,store:f,parentStore:e.parentStore,disabled:!1,onEnter:()=>{if(!o().A.isMobile)return void L();const e="editing"===T().default.state.mode&&T().default.state.multiSelection;e&&at().createAndCommit({userAction:"ImageEditInput.handleEnter",environment:a,canUndo:!0,perform:t=>{ot().$D({environment:a,editorMode:"default",string:"\n",multiSelection:e,disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:t})}})},onCommandEnter:L,onEsc:e.onCancel,...D,placeholder:c.formatMessage(ma.placeholder),ref:b,isDiscussionInput:!0,disableSlashCommands:!0,disableInsertText:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableEmbedMenu:!0,disabledMentionTypes:{reminder:!0,property:!0},disableMobileActionBar:!0,disableStyleAnnotations:d.isMobileBrowser,disableInsertedDeletedAnnotations:d.isMobileBrowser,pasteBehavior:"inline",inPageFind:Oe().Os.none,className:"image-edit-input-text-block",disableMoveCursorToEndOnFocus:!1})}),(0,g.jsx)(ga,{visible:B,disabled:j,onSubmit:L,animated:Boolean(o().A.isMobile)})]})]})})})}const ya={display:"flex",flexDirection:"column",width:"100%"},va={display:"flex",alignItems:"center",flexGrow:1};const ba=(0,q().YK)({title:{id:"ImageEditMenu.title",defaultMessage:"Edit Image"},closeAriaLabel:{id:"ImageEditMenu.closeButton.ariaLabel",defaultMessage:"Close"},editError:{id:"ImageEditMenu.editError.message",defaultMessage:"Failed to edit image. Please try again."},emptyPromptError:{id:"ImageEditMenu.emptyPromptError.message",defaultMessage:"Please enter a description of how to edit the image."}});function Sa({blockStore:e}){const t=(0,q().tz)(),n=(0,r().v3)(),s=(0,i.useMemo)((()=>{const t=e.getSpaceId();if(t)return new(ia().A)(n,t)}),[n,e]),a=(0,oa().x)(e.id),l=(0,i.useCallback)((()=>{Xo().B()}),[]),d=(0,i.useCallback)((async()=>{if(!s||a)return;const i=s.state.textStore.getValue(),o=qs().q4_(i);if(!o||0===o.trim().length)return void(0,ea().f)({item:{durationMs:"keep",label:t.formatMessage(ba.emptyPromptError)}});const r=e.getSpaceId();if(!r)return;Xo().B(),aa().P.setBlockState(e.id,{prompt:o.trim(),source:"image_edit"});const l=Date.now();ta().g7(n,{source:"page_block",duration_ms:0,status:"start"});try{var d;const i=await ta().FK({environment:n,prompt:o.trim(),spaceId:r,blockPointer:e.getSpaceShardedPointer()}),s=Date.now()-l,a=null==i||null===(d=i.images)||void 0===d?void 0:d[0];if(!i||i.error||!a){var c,u;aa().P.setBlockState(e.id,void 0),ta().g7(n,{source:"page_block",duration_ms:s,status:"error",error_code:(null==i||null===(c=i.error)||void 0===c?void 0:c.code)??"no_images",...null!=a&&a.model?{model:a.model}:{}});const o=null!=i&&null!==(u=i.error)&&void 0!==u&&u.code?ta().ys(i.error.code):t.formatMessage(ba.editError);return void(0,ea().f)({item:{durationMs:"keep",label:o}})}ta().g7(n,{source:"page_block",duration_ms:s,status:"success",...a.model?{model:a.model}:{}});const p=await fetch(a.url),g=await p.blob(),m=new File([g],"ai-edited-image.png",{type:g.type||"image/png"}),f=(0,sa().y)(n);na().QM({environment:n,store:e,file:m,pageWidth:f,preferredType:"image"}),aa().P.setBlockState(e.id,void 0)}catch(p){const i=Date.now()-l;aa().P.setBlockState(e.id,void 0),ta().g7(n,{source:"page_block",duration_ms:i,status:"error",error_code:"exception"}),(0,ea().f)({item:{durationMs:"keep",label:t.formatMessage(ba.editError)}})}}),[e,s,n,t,a]),c=(0,x().IS)((()=>({closeButton:{position:"absolute",insetInlineEnd:10,borderRadius:"50%",background:W().Tj.background.tertiaryTranslucent},contentContainer:{padding:"10px"}})),[]);if(!s)return null;let u;return u=o().A.isMobile?{menuType:R().gu.Modal,title:(0,g.jsx)(q().sA,{...ba.title}),right:(0,g.jsx)(ke().A,{icon:Zn().xMarkFillIcon,style:c.closeButton,onClick:l,ariaLabel:t.formatMessage(ba.closeAriaLabel)}),onClickRight:l,whiteBackground:!0,height:"100%"}:{menuType:R().gu.Popup,width:480,maxHeight:"50vh",onClickOutside:l},(0,g.jsx)(_i().N,{capture:!0,allowMobileAutoScroll:!0,wrapperTag:"div",children:(0,g.jsx)(Pi().N,{debugName:"ImageEditMenu",capture:!0,onEsc:l,children:(0,g.jsx)(L().A,{...u,children:(0,g.jsx)("div",{style:c.contentContainer,children:(0,g.jsx)(fa,{parentStore:e,blockStore:e,onSubmit:d,onCancel:l,discussionInputStore:s,autoFocus:!0})})})})})}function xa(){const e=(0,r().Y0)(),t=(0,l().K8)((()=>Jo().Y.state.rect),[]),n=(0,l().K8)((()=>Jo().Y.state.open),[]),s=(0,i.useCallback)((()=>{Xo().B()}),[]),a=(0,i.useCallback)((()=>{if(Jo().Y.state.open)return(0,g.jsx)(Sa,{blockStore:Jo().Y.state.blockStore})}),[]),d=o().A.isMobile?_().n.BottomSheet:_().n.Popup;return(0,g.jsx)(C().zD,{popupType:d,bottomSheetBackgroundColor:"primary",bottomSheetInitialState:e.isPhone?"full":"half",open:n,originRect:t,placementToOrigin:"bottom",alignmentToOrigin:"center",originGap:4,render:a,onDismiss:s,trapFocus:!1})}var Ma=()=>n(448619),Aa=()=>n(250452),ja=()=>n(569777),wa=()=>n(624643);const Ia=function(){const e=(0,r().v3)(),t=(0,i.useRef)(null),s=(0,i.useCallback)((n=>function(e,t,n){if(!ja().A.isOpen())return;if(!n.current)return;const i=n.current.getSelection();if(!i)return;const s=ja().A.state.value.length;"altKey"in e&&!e.altKey&&"shiftKey"in e&&!e.shiftKey&&i.startIndex===s&&i.endIndex===s&&(Ca(t),Ma().IV())}(n,e,t)),[e]),o=(0,i.useCallback)((n=>function(e,t,n){if(!n.current)return;const i=n.current.getSelection();if(!i)return;"altKey"in e&&!e.altKey&&"shiftKey"in e&&!e.shiftKey&&0===i.startIndex&&0===i.endIndex&&(Ca(t),Ma().IV(ja().q.Backward))}(n,e,t)),[e]),a=(0,i.useCallback)((()=>Ca(e)),[e]),c=(0,l().O$)(ja().A),u=(0,l().K8)((()=>function(){if(!ja().A.isOpen())return;return ja().A.state.savedTextSelectionRect}()),[]),p=(0,l().K8)((()=>function(){var e;if("editing"!==T().default.state.mode&&!ja().A.isOpen())return!0;const t=ja().A.isOpen()?null===(e=(0,Ss().H)(ja().A.state.savedTextSelectionState.multiSelection))||void 0===e?void 0:e.store:void 0;if(t&&!t.canEdit())return!0;if(t){const e=(0,Aa().TL)(t);if((0,re().S)(e))return!0}const n={[qs().Ifu.User]:qs().Ifu.User,[qs().Ifu.Page]:qs().Ifu.Page,[qs().Ifu.Collection]:qs().Ifu.Collection,[qs().Ifu.CustomEmoji]:qs().Ifu.CustomEmoji,[qs().Ifu.Comment]:qs().Ifu.Comment,[qs().Ifu.Bot]:qs().Ifu.Bot,[qs().Ifu.Date]:qs().Ifu.Date,[qs().Ifu.ExternalObjectInstance]:qs().Ifu.ExternalObjectInstance,[qs().Ifu.TemporaryPage]:qs().Ifu.TemporaryPage,[qs().Ifu.TemporaryCollection]:qs().Ifu.TemporaryCollection,[qs().Ifu.TemplateVariable]:qs().Ifu.TemplateVariable,[qs().Ifu.FormulaPageProperty]:qs().Ifu.FormulaPageProperty,[qs().Ifu.FormulaContextValue]:qs().Ifu.FormulaContextValue,[qs().Ifu.Group]:qs().Ifu.Group,[qs().Ifu.Team]:qs().Ifu.Team,[qs().Ifu.Citation]:qs().Ifu.Citation,[qs().Ifu.TemporaryCitation]:qs().Ifu.TemporaryCitation,[qs().Ifu.LinkMention]:qs().Ifu.LinkMention,[qs().Ifu.ChatSelectionContext]:qs().Ifu.ChatSelectionContext,[qs().Ifu.AssistantInstructionsCollection]:qs().Ifu.AssistantInstructionsCollection,[qs().Ifu.Place]:qs().Ifu.Place,[qs().Ifu.SlackSpecialMention]:qs().Ifu.SlackSpecialMention,[qs().Ifu.TemporarySearchFilter]:qs().Ifu.TemporarySearchFilter,[qs().Ifu.TitleOnly]:qs().Ifu.TitleOnly,[qs().Ifu.Sort]:qs().Ifu.Sort,[qs().Ifu.SearchFilterCreatedTime]:qs().Ifu.SearchFilterCreatedTime,[qs().Ifu.SearchFilterLastEditedTime]:qs().Ifu.SearchFilterLastEditedTime,[qs().Ifu.DeletionMarker]:qs().Ifu.DeletionMarker};for(const i of Object.values(n))if((0,wa().y)(i))return!0;return!1}()),[]);if(!c.open)return null;const m=c.value,f=c.error;return(0,g.jsx)(d().u2,{dependency:n(354584).y,children:e=>c.open?(0,g.jsx)(n(921966).A,{Prism:e,ref:t,isOpen:!0,equationValue:m,error:f,displayMode:"inline",disabled:p,originRect:u,originGap:8,onDismiss:Ta,onChange:ka,onSubmit:a,onLeft:o,onRight:s}):null})};function ka(e,t){ja().A.isOpen()&&ja().A.setState({...ja().A.state,value:e,error:t})}function Ta(){Ma().IV()}function Ca(e){at().createAndCommit({userAction:"InlineEquationOverlay.handleSubmit",environment:e,canUndo:!0,perform:t=>{Ma().t5({environment:e,equationStore:ja().A,transaction:t})}})}const _a=new(d().O2)("LazyMediaMenu",(()=>n.e(55394).then(n.bind(n,775812)))),Pa=(0,d()._h)(_a,(e=>e.default));var Ba=()=>n(916694),Ra=()=>n(626652),Da=()=>n(463042),La=()=>n(536612),Ea=()=>n(732810),Oa=()=>n(278132),Na=()=>n(852424),Fa=()=>n(247331),Ua=()=>n(239381),za=()=>n(879765),Ka=()=>n(797809),Va=()=>n(829300),qa=()=>n(455971),Wa=()=>n(603533),Ga=()=>n(17022),Ha=()=>n(757695);class Ya extends Ha().Store{getInitialState(){}}const $a=new Ya;function Qa(e){const{isFirefox:t}=(0,r().Y0)();return(0,i.useCallback)((n=>{Ga().e.withListenerIgnored((()=>{var i;const s=et().Ay.state;if(!s.open)return;if(!n)return void s.temporaryInputData.setState(void 0);const{title:o,icon:a,allowTabCompletion:r}=n,l=e.current??"",d=o.toLowerCase().startsWith(l)?s.oldTextValue&&0!==(null===(i=s.oldTextValue)||void 0===i?void 0:i.length)?"":o.slice(l.length):"";$a.setState(r?d:void 0);const c=t?void 0:a;s.temporaryInputData.setState({prefix:s.insertionType,suffix:"[["===s.insertionType&&l.endsWith("]]")?"]]":"",completion:d,prefixIcon:c})}))}),[e,t])}const Za=(0,q().YK)({backButtonAriaLabel:{defaultMessage:"Back",id:"formulaMentionMenu.backButton.ariaLabel"},possessiveContextValueProperty:{defaultMessage:"{contextValueName}’s {propertyName}",id:"formulaMentionMenu.possessiveContextValueProperty.title"}}),Xa=i.memo((function(e){const{mentionMenuCurrentFormulaStore:t,queryRef:n}=e,s=(0,l().K8)((()=>(0,Wa().W)()),[]),o=(0,l().K8)((()=>{const e=t.state.formulaTypecheckContextValue;if(e&&e.kind===Fa().FormulaContextValueKind.ContextValue)return e}),[t]),a=function(e){const{contextValue:t,queryRef:n,setTemporaryInputData:i}=e,s=(0,r().v3)(),o=(0,q().tz)(),a=(0,l().K8)((()=>{if(!t)return;const e=function(){const e=it().default.getCurrentRootStore();if(e&&e instanceof j().B)return e;const{sidebarSpaceStore:t}=v().default.state;return t||void 0}();return e?function(e,t){const n=function(e){if("block"!==e.type.type||!(0,Ft().O9)(e.type.collection))return;return e.type.collection}(t);if(!n)return;const i=Ea().m.createChildStore(e,n);return i.getSchema()}(e,t):void 0}),[t]);if(!t)return[];const d=(0,Ua().sM)(t),c=new Set,u=a?(0,St().oE)(Object.entries(a).map((([e,a])=>{if(a&&Fa().FORMULAS_SUPPORTED_COLLECTION_PROPERTY_TYPES.includes(a.type))return void 0!==(null==a?void 0:a.type)&&(0,Ft().Xk)(Fa().FormulaTokenSupportedBlockSystemPropertyList,null==a?void 0:a.type)&&c.add(a.type),{action:i=>{at().createAndCommit({userAction:"FormulaMentionMenu.menuItem",environment:s,canUndo:!0,perform:r=>{const l=(0,qs().ESw)({contextValueId:t.id,name:(0,Oa().Nl)(o,d,a.name),property:e,valueSnapshot:"current"});Va().Ju({annotations:[l],editorMode:"default",environment:s,mentionType:"formulaContextVariable",menuListItemAction:i,query:n.current??"",transaction:r})}})},key:`formula property ${e}`,render:e=>(e.focused&&i({allowTabCompletion:!0,icon:(0,g.jsx)(qa().sL,{}),title:o.formatMessage(Za.possessiveContextValueProperty,{contextValueName:d,propertyName:a.name})}),(0,g.jsx)(E().A,{...e,icon:(0,g.jsx)(Ja,{children:Na().LE[a.type]({height:17,width:17})}),title:a.name}))}}))):[],p="block"===t.type.type?(0,St().oE)(Ka().BY.map((e=>{if(c.has(e))return;const a=Ka().g1(e,o);return{action:i=>{at().createAndCommit({userAction:"FormulaMentionMenu.systemProperty",environment:s,canUndo:!0,perform:r=>{const l=(0,qs().ESw)({contextValueId:t.id,name:(0,Oa().Nl)(o,d,a),property:e,valueSnapshot:"current"});Va().Ju({annotations:[l],editorMode:"default",environment:s,mentionType:"formulaContextVariable",menuListItemAction:i,query:n.current??"",transaction:r})}})},key:`system property ${e}`,render:t=>{t.focused&&i({allowTabCompletion:!0,icon:(0,g.jsx)(qa().sL,{}),title:o.formatMessage(Za.possessiveContextValueProperty,{contextValueName:d,propertyName:a})});const n=e;return(0,g.jsx)(E().A,{...t,icon:(0,g.jsx)(Ja,{children:Na().LE[n]({height:17,width:17})}),title:a})}}}))):[];return[...u,...p]}({contextValue:o,queryRef:n,setTemporaryInputData:Qa(n)}),d=function(e){const{contextValue:t,items:n,mentionMenuCurrentFormulaStore:s}=e,o=(0,q().tz)(),a=(0,i.useCallback)((()=>{s.setState({formulaTypecheckContextValue:void 0}),et().Ay.updateOpenState({showFormulaProperty:!1})}),[s]),r=(0,x().IS)((()=>({backButton:{height:20,width:20},backButtonIcon:{width:17},sectionDesktopTitle:{paddingInline:10},titleHeader:{display:"inline-flex",alignItems:"center",gap:2}})),[]);if(0===n.length||!t)return[];const l=(0,Ua().sM)(t);return[{items:n,key:"formula properties section",render:e=>(0,g.jsx)(N().A,{...e,desktopTitleStyle:r.sectionDesktopTitle,title:(0,g.jsxs)("header",{style:r.titleHeader,children:[(0,g.jsx)(ke().A,{ariaLabel:o.formatMessage(Za.backButtonAriaLabel),icon:za().$,iconStyle:r.backButtonIcon,onClick:a,style:r.backButton}),(0,g.jsx)(q().sA,{defaultMessage:"Property from {contextValueName}",id:"formulaMentionMenu.formulaPropertiesSection.title",values:{contextValueName:l}})]})})}]}({contextValue:o,items:a,mentionMenuCurrentFormulaStore:t});if(!d||0===d.length)return null;const c={menuType:R().gu.Popup,width:s};return(0,g.jsx)(L().A,{...c,children:(0,g.jsx)(O().A,{initialFocus:0,sections:d,type:O().O.Vertical})})}));function Ja(e){const{children:t}=e,n=(0,x().IS)((()=>({wrapper:{display:"inline-flex",alignItems:"center",justifyContent:"center",height:20,width:20}})),[]);return(0,g.jsx)("div",{style:n.wrapper,children:t})}var er=()=>n(691298),tr=()=>n(114871),nr=()=>n(875497);class ir extends Ha().Store{getInitialState(){return{formulaTypecheckContextValue:void 0}}}const sr=ir;var or=()=>n(472090);class ar extends Ha().Store{getInitialState(){return{userId:"",userEmail:"",displayName:""}}}const rr=ar;function lr(e,t){return t?et().Ay.state.open&&"@"===et().Ay.state.insertionType&&e.device.isAndroid&&t.startsWith("@")?t.slice(1).trim():et().Ay.state.open&&"[["===et().Ay.state.insertionType&&t.endsWith("]]")?t.slice(0,-2).trim():t.trim():""}var dr=()=>n(567141),cr=()=>n(966505),ur=()=>n(766637);function pr(e,t){const n=(0,l().K8)((()=>et().Ay.getMentionMenuContext()),[]);return(0,i.useCallback)((()=>{let i,s=Date.now();const o=et().Ay.state;if(o.open&&(s=o.openTime,i=o.flowId),o.open){var a;const r=Date.now(),{numServerRequests:l}=ur().A.state,d=o.sessionId,c=o.showMentionAndShare;dr().sM(e,{timeToAbandonInMs:r-s,analyticsFrom:n,queryLength:(null===(a=t.current)||void 0===a?void 0:a.length)??0,flowId:i,searchSessionId:d,searchSessionFlowNumber:l,stage:c?"share":"user_selection"})}o.open&&o.showInvite&&cr().F$(e,{origin:et().Ay.getInviteOrigin(),invite_flow_id:o.flowId}),(0,et().q6)()}),[n,e,t])}function gr({usePopupOnMobile:e}){const t=(0,r().Y0)();return!e&&(t.isMobileNative&&!t.isTablet)}var mr=()=>n(792485),fr=()=>n(963248);function hr({clearSavedSelection:e,filter:t}){var n;const i=(0,r().v3)(),s=(0,l().O$)(et().Ay),o=(0,l().K8)((()=>(0,Wa().W)()),[]),a=null===(n=(0,mr().S)())||void 0===n?void 0:n.spaceStore;if(!s.open)return null;const d="block"===s.textStore.table?s.textStore.id:void 0;return(0,g.jsx)(fr().v8,{blocksToMove:[],isAddTo:!0,isCreateIn:!0,onAccept:n=>{Va().eh({environment:i,titleText:lr(i,t),clearSavedSelection:e,createInValue:n,spaceStore:a,menuListItemAction:void 0})},parentBlockId:d,onAutocompleteQueryChange:yr,autocompleteQuery:s.createInQuery,desktopWidth:o,onCancel:vr})}function yr(e){et().Ay.updateOpenState({createInQuery:e})}function vr(){et().Ay.updateOpenState({showCreateIn:!1,createInQuery:""}),Va().VN(!0)}var br=()=>n(690490);function Sr({inviteTargetsStore:e,personPropertyInviteStore:t,filter:n}){const s=(0,r().v3)(),o=(0,i.useCallback)((()=>xr(s,e,t)),[s,e,t]),a=(0,l().K8)((()=>(0,us().a)()),[]),d=(0,l().K8)((()=>et().Ay.getInviteOrigin()),[]);return a?(0,g.jsx)(br().i,{inviteOrigin:d,store:a,onInviteCompleteFn:i=>{if(!i.success)return xr(s,e,t),null;const{invitedUsers:o,requestedUsers:a}=i,r=St().xW(Object.values(o),Object.values(a));r.length?at().createAndCommit({userAction:"MentionMenu.inviteMenu",environment:s,canUndo:!0,perform:e=>{Va().Ju({environment:s,editorMode:"default",annotations:r.map((e=>(0,qs().P4h)(e))),transaction:e,menuListItemAction:void 0,query:lr(s,n),mentionType:"user"})}}):xr(s,e,t)},handleBackButtonClick:o,inviteTargetsStore:e,personPropertyInviteStore:t}):null}function xr(e,t,n){const i=et().Ay.state;i.open&&(cr().F$(e,{origin:et().Ay.getInviteOrigin(),invite_flow_id:i.flowId}),t.setState({tokenQuery:"",inviteTargets:[]}),n.setState({...n.state,emailMessage:""}),et().Ay.updateOpenState({showInvite:!1}))}var Mr=()=>n(988083),Ar=()=>n(517415),jr=()=>n(537193),wr=()=>n(97835),Ir=()=>n(763884),kr=()=>n(134696),Tr=()=>n(579627),Cr=()=>n(495262),_r=()=>n(469874),Pr=()=>n(773706);function Br(e){const t=(0,r().v3)(),n=(0,l().K8)((()=>(0,us().a)()),[]),{mentionMenuCurrentMentionStore:i,menuPopupType:s}=e,{userId:o,displayName:a,userEmail:d}=(0,l().O$)(i),c=(0,l().K8)((()=>(0,_r().y)(t,Mr().A.state.estimatedKeyboardWebViewOverlap,Mr().A.state.nativeBottomBarHeight)),[t]),u=(0,l().K8)((()=>et().Ay.state.open),[]);if(!n)return null;const p={key:"invite buttons",render:e=>(0,g.jsx)(N().A,{...e}),items:[{key:"MentionMenu.MentionWithoutSharing",render:e=>(0,g.jsx)(E().A,{title:(0,g.jsx)(q().sA,{defaultMessage:"Mention without sharing",id:"mentionMenu.peopleSection.invitePrompt.mentionWithoutSharing"}),caption:(0,g.jsx)(q().sA,{defaultMessage:"Mention {userDisplayName} without sharing this document",id:"mentionMenu.peopleSection.invitePrompt.mentionWithoutSharingCaption",values:{userDisplayName:a}}),icon:(0,g.jsx)(Qi().I,{icon:jr().b}),...e}),action:()=>{at().createAndCommit({userAction:"MentionMenu.menuItem",environment:t,canUndo:!0,perform:e=>{Va().Ju({environment:t,editorMode:"default",annotations:[(0,qs().P4h)(o)],transaction:e,menuListItemAction:void 0,query:"",mentionType:"user",shareMenuSelection:"mention_without_share"})}}),Ir().K.set({userId:t.currentUser.id,key:(0,Pr().T)(n.id),value:!0})}},{key:"MentionMenu.MentionAndShare",render:e=>(0,g.jsx)(E().A,{title:(0,g.jsx)(q().sA,{defaultMessage:"Mention and share",id:"mentionMenu.peopleSection.invitePrompt.mentionAndShare"}),caption:(0,g.jsx)(q().sA,{defaultMessage:"Grant {userDisplayName} full access",id:"mentionMenu.peopleSection.invitePrompt.mentionAndShareCaption",values:{userDisplayName:a}}),icon:(0,g.jsx)(Qi().I,{icon:wr().inviteMemberIcon}),...e}),action:()=>{at().createAndCommit({userAction:"MentionMenu.menuItem",environment:t,canUndo:!0,perform:e=>{Va().Ju({environment:t,editorMode:"default",annotations:[(0,qs().P4h)(o)],transaction:e,menuListItemAction:void 0,query:"",mentionType:"user",shareMenuSelection:"mention_and_share"})}}),at().createAndCommit({userAction:"MentionAndInviteUserComponent.setPermission",environment:t,canUndo:!0,perform:e=>{Tr().zP({environment:t,transaction:e,store:n,permissionItems:[{type:"user_permission",role:"editor",user_id:o}],pagePermissionChangeLocation:"mention_share_menu"})}}),kr().Jg(t,{role:"editor",is_space:!1,invite_targets:[{type:"existingUser",value:{id:o,version:0,email:d}}],is_onboarding:!1,invite_origin:"mention_menu",permission_items:[{type:"user_permission",role:"editor",user_id:o}],invite_message_length:0}),(0,Ar().r)({item:{label:(0,g.jsx)(q().sA,{id:"mentionMenu.mentionShareMenu.mentionAndShare.snackbarMessage",defaultMessage:"Successfully granted {user} full access",values:{user:a}})},undoFunc:()=>{Cr().tN({environment:t,preventSelectText:!0}),at().createAndCommit({userAction:"MentionAndInviteUserComponent.setPermission.undoShare",environment:t,canUndo:!0,perform:e=>{Tr().zP({environment:t,transaction:e,store:n,permissionItems:[{type:"user_permission",role:"none",user_id:o}],pagePermissionChangeLocation:"mention_share_menu"})}})}})}}]},m=s===R().gu.ActionSheet?{menuType:R().gu.ActionSheet,disableBottomPadding:!0,height:`calc(70vh - ${c}px)`}:{menuType:R().gu.Popup};return(0,g.jsxs)(L().A,{...m,children:[(0,g.jsx)(Pi().N,{debugName:"MentionMenu",capture:u}),(0,g.jsx)(O().A,{type:O().O.Vertical,initialFocus:0,sections:[p]})]})}const Rr=(0,q().YK)({addPage:{defaultMessage:"Type to add or link page…",id:"mentionMenu.addPage.prompt2"}});var Dr=()=>n(711339),Lr=()=>n(589407),Er=()=>n(311337),Or=()=>n(152075),Nr=()=>n(336765),Fr=()=>n(710515),Ur=()=>n(310109),zr=()=>n(173979),Kr=()=>n(778078),Vr=()=>n(37824);var qr=()=>n(635455),Wr=()=>n(148307),Gr=()=>n(955363),Hr=()=>n(264879),Yr=()=>n(857783),$r=()=>n(276303);const Qr={...G().RC,fontWeight:G().Wy.medium,maxWidth:160,display:"inline-block",verticalAlign:"bottom"};function Zr(e){const{pageTitle:t}=e;return t?(0,g.jsx)(q().sA,{defaultMessage:"New “{filterText}” page in…",id:"createPageMenuItem.title.withPageName",values:{filterText:(0,g.jsx)("span",{style:Qr,children:t})}}):(0,g.jsx)(q().sA,{defaultMessage:"Add new page in…",id:"createPageMenuItem.title.withoutPageName"})}function Xr(e){const{pageTitle:t}=e;return t?(0,g.jsx)(q().sA,{defaultMessage:"New “{filterText}” sub-page",id:"createSubpageMenuItem.title.withPageName",values:{filterText:(0,g.jsx)("span",{style:Qr,children:t})}}):(0,g.jsx)(q().sA,{defaultMessage:"Add new sub-page",id:"createSubpageMenuItem.title.withoutPageName"})}var Jr=()=>n(103448);function el(e){const{isFirstSection:t,query:n,clearSavedSelection:s,setTemporaryInputData:a}=e,{isOpen:d,insertionType:c,isCreatePageEnabled:u,textStore:p}=(0,l().K8)((()=>{const e=et().Ay.state.open;return{isOpen:e,isCreatePageEnabled:et().Ay.state.mentionTypes.createPage,insertionType:e?et().Ay.state.insertionType:void 0,textStore:e?et().Ay.state.textStore:void 0}}),[]),m=function(e){var t;const{query:n,textStore:s,clearSavedSelection:a,setTemporaryInputData:d}=e,c=(0,r().v3)(),u=(0,q().tz)(),p=(0,l().K8)((()=>Hr().D8(s)),[s]),m=null===(t=(0,mr().S)())||void 0===t?void 0:t.spaceStore,f=(0,i.useMemo)((()=>({key:"add new subpage",action:async e=>{p&&await Va().eh({environment:c,clearSavedSelection:a,titleText:n,createInValue:p.createInValue,onPageCreated:e=>{e&&""===qs().q4_(e.getTitleValue())&&Yr().uK({environment:c,store:e,pageVisitSource:ht().y8.Create})},menuListItemAction:e,spaceStore:m})},render:e=>{e.focused&&d({title:0===n.length?u.formatMessage(Rr.addPage):"",icon:(0,g.jsx)(qa().Yo,{}),allowTabCompletion:!1});const t=t=>(0,g.jsx)(E().A,{...(0,da().A)(t||{},e),icon:(0,g.jsx)(Qi().I,{icon:po().plusIcon}),title:(0,g.jsx)(Xr,{pageTitle:n})});return o().A.isMobile?t():(0,g.jsx)(Te().m,{renderTooltip:()=>(0,g.jsx)(Jr().A,{imageURL:Wr().A.images.tooltips.pageMenu.newSubpagePng,imageWidth:140,imageHeight:100,caption:(0,g.jsx)(q().sA,{...$r().DZ.createSubpage})}),placement:"right",delayThreshold:0,render:e=>t(e)})}})),[c,a,p,u,n,d,m]);return f}({query:n,textStore:p,clearSavedSelection:s,setTemporaryInputData:a}),f=function(e){const{query:t,setTemporaryInputData:n}=e,s=(0,q().tz)(),a=(0,i.useCallback)((()=>{et().Ay.updateOpenState({showCreateIn:!0})}),[]),r=(0,i.useMemo)((()=>({key:"open create in menu",action:a,render:e=>{e.focused&&n({title:0===t.length?s.formatMessage(Rr.addPage):"",icon:(0,g.jsx)(qa().Yo,{}),allowTabCompletion:!1});const i=n=>(0,g.jsx)(E().A,{...(0,da().A)(n||{},e),icon:(0,g.jsx)(Qi().I,{icon:Gr().arrowDiagonalUpRightIcon}),title:(0,g.jsx)(Zr,{pageTitle:t})});return o().A.isMobile?i():(0,g.jsx)(Te().m,{renderTooltip:()=>(0,g.jsx)(Jr().A,{imageURL:Wr().A.images.tooltips.pageMenu.newPageInPng,imageWidth:140,imageHeight:100,caption:(0,g.jsx)(q().sA,{...$r().DZ.newPageIn})}),placement:"right",delayThreshold:0,render:e=>i(e)})}})),[a,s,t,n]);return r}({query:n,setTemporaryInputData:a}),h=(0,i.useMemo)((()=>{if(!u||!d)return;const e="@"===c?(0,g.jsx)(q().sA,{id:"mentionMenu.createPageSection.title",defaultMessage:"New page"}):void 0;return{key:"create page",render:n=>(0,g.jsx)(N().A,{...n,title:e,desktopTitleStyle:t?{paddingTop:4}:void 0,topBorder:!t}),items:[m,f]}}),[t,m,f,u,d,c]);return h}var tl=()=>n(906745),nl=()=>n(395361),il=()=>n(869190),sl=()=>n(604995),ol=()=>n(498140),al=()=>n(68913),rl=()=>n(274570),ll=()=>n(5580);function dl(e){const{category:t,query:n,setTemporaryInputData:i,templateVariableResults:s}=e,o=(0,r().v3)(),a=(0,q().tz)();return s.filter((e=>(0,zr().BX)(e,t))).map((e=>({key:e,render:t=>{const n=(0,zr().Ti)(e,a),s=(0,zr().EC)(e,a);return t.focused&&i({title:n,icon:(0,g.jsx)(qa().sL,{}),allowTabCompletion:!0}),(0,g.jsx)(E().A,{...t,title:n,caption:s,inline:!0})},action:t=>{at().createAndCommit({userAction:"MentionMenu.menuItem",environment:o,canUndo:!0,perform:i=>{Va().Ju({environment:o,editorMode:"default",annotations:[qs().Ii$({type:e})],transaction:i,menuListItemAction:t,query:n,mentionType:"templateVariable"})}})}})))}var cl=()=>n(280244);function ul(e){const{templateVariableResults:t,formulaContextVariableResults:o,isFirstSection:a,query:d,setTemporaryInputData:c,disabled:u=!1}=e,p=(0,r().v3)(),m=(0,q().tz)(),f=function(e,t=!1){const[o,a]=(0,i.useState)([]),r=(0,q().tz)(),{areDateMentionsAllowed:d,areReminderMentionsAllowed:c}=(0,l().K8)((()=>({areDateMentionsAllowed:et().Ay.state.mentionTypes.date,areReminderMentionsAllowed:et().Ay.state.mentionTypes.reminder})),[]),u=(0,ll().n)(),p=(0,s().X)("chrono_node_date_mentions",{disableExposureLogging:!1,enableEventTrailLogging:!1}),g=(0,s().X)("default_mentioned_dates_to_reminders",{disableExposureLogging:!1,enableEventTrailLogging:!1}),m=(0,i.useCallback)((async()=>{if(0===e.length)return;const t=await async function(e){const{query:t,intl:i,userLocal:s,areReminderMentionsAllowed:o}=e,{chronoNodeDependency:a}=await Promise.all([n.e(91757),n.e(58587)]).then(n.bind(n,211051)),r=await a.load(),l={en:r.en.parse,ja:r.ja.parse,zh:r.zh.parse,fr:r.fr.parse,de:r.de.parse,es:r.es.parse,pt:r.pt.parse,nl:r.nl.parse},d=t.toLowerCase(),c=d.includes(i.formatMessage(Ml.ago).toLowerCase()),u=[l[s]??r.en.parse,r.en.parse];let p=[];u.some((e=>{const n=e(t,void 0,{forwardDate:!c});return n.length>0&&(p=n,!0)}));const g=p.length>0?p[0]:void 0;if(!g)return;const{start:m,end:f}=g,h=m.isCertain("minute")||m.isCertain("hour"),y=(null==f?void 0:f.isCertain("minute"))||(null==f?void 0:f.isCertain("hour")),v=m.date().getTime(),b=null==f?void 0:f.date().getTime(),S=(0,yt().P)(),x=sl().KQ(v,S),M={unit:"day",value:0,time:Vs().lM,defaultTimeZone:S},A=t.toLowerCase().startsWith(i.formatMessage(ol().DZ.remind).toLowerCase())&&o;let j;if(v&&!b)j=h?{...x,reminder:A?gl(m):void 0}:{type:"date",start_date:x.start_date,reminder:A?M:void 0};else if(b){const e=sl().NC(v,b,(0,yt().P)());j=h&&y?{...e,reminder:A?gl(m):void 0}:{type:"daterange",end_date:e.end_date,start_date:e.start_date,reminder:A?M:void 0}}if(!j)return;const w=(0,il().ZF)({value:j,allowRelativeDates:!0,date_format:"relative",userTimeZone:(0,yt().P)(),intl:i,getToday:()=>sl().ah((0,yt().P)())}),I={label:w,value:()=>j,source:"chrono-node"},k=o&&(A||e.isDefaultMentionedDatesToRemindersEnabled)?xl(j):void 0;if(!k||!A&&!Sl(j))return[I];const T={label:w,value:()=>k,source:"chrono-node"};if(A)return[T];return[I,T]}({query:e,intl:r,userLocal:u,isDefaultMentionedDatesToRemindersEnabled:g,areReminderMentionsAllowed:c}),i=t&&t.filter((e=>e.label.length>0));i&&0!==i.length?a(i):a([])}),[r,g,e,u,c]),f=(0,nl().Y)((async()=>await m()),100);return(0,Nt().Yb)((async()=>{if(t||!d)return void a([]);p&&f.cancel();const n=function(e){const{query:t,allowReminder:n,intl:i,isDefaultMentionedDatesToRemindersEnabled:s}=e;if(0===t.length)return(0,St().oE)([{label:i.formatMessage(Ml.autocompleteToday),value:()=>sl().Ec((0,yt().P)()),source:"luxon"},n?void 0:{label:i.formatMessage(Ml.autocompleteNextTuesday),value:()=>{const e=sl().ah((0,yt().P)()),t=e.set({weekday:2,hour:15}),n=t<=e?t.plus({week:2}):t.plus({week:1});return{type:"datetime",start_date:n.toFormat(sl().tr),start_time:n.toFormat(Vs().GE),time_zone:(0,yt().P)()}},source:"luxon"},n?{label:i.formatMessage(Ml.autocompleteReminderV2),value:()=>({type:"datetime",start_date:sl().uf((0,yt().P)()).start_date,start_time:Vs().vM,reminder:{unit:"day",value:0,time:Vs().lM,defaultTimeZone:(0,yt().P)()},time_zone:(0,yt().P)()}),source:"luxon"}:void 0]);const o=t.normalize("NFKD"),a=n?ol().bm(o,i):ol().FA(o,i);if(!a)return[];const r=(0,il().ZF)({value:a,date_format:"relative",userTimeZone:(0,yt().P)(),intl:i,allowRelativeDates:!0}),l=(0,Vs().Lh)(a)||t.toLowerCase().startsWith(i.formatMessage(ol().DZ.remind).toLowerCase()),d={label:r,value:()=>a,source:"luxon"},c=n?xl(a):void 0,u=Sl(a);if(!(c&&(0,Vs().Lh)(c)&&u))return[d];const p={label:r,value:()=>c,source:"luxon"};if(l)return[p];if(s)return[d,p];return[d]}({query:e,allowReminder:c,isDefaultMentionedDatesToRemindersEnabled:g,intl:r}).slice(0,6);n.length>0||!p?a(n):await f()}),[t,d,p,e,c,g,r,f]),o}(d,u),h=dl({templateVariableResults:t,category:"date",query:d,setTemporaryInputData:c}),y=(0,cl().DK)({formulaReturnType:"date",query:d,formulaContextVariableResults:o,setTemporaryInputData:c}),v=(0,i.useMemo)((()=>{const e=f.some((e=>(0,Vs().Lh)(e.value())));return f.map((({label:t,value:n,source:i})=>{const s=n();return{key:(0,Vs().Lh)(s)?`${t}-reminder-date-result`:`${t}-date-result`,render:s=>(0,g.jsx)(pl,{...s,label:t,value:n,source:i,intl:m,setTemporaryInputData:c,hasReminderInResults:e}),action:e=>{at().createAndCommit({userAction:"MentionMenu.menuItem",environment:p,canUndo:!0,perform:t=>{Va().Ju({environment:p,editorMode:"default",annotations:[["d",{...s,date_format:"relative"}]],transaction:t,menuListItemAction:e,query:d,mentionType:(0,Vs().Lh)(s)?"reminder":"date"})}})}}}))}),[f,m,c,p,d]),b=(0,i.useMemo)((()=>u?[]:[...y,...h,...v]),[v,y,h,u]),S=(0,i.useMemo)((()=>{if(!u&&0!==b.length)return{key:"date results",render:e=>(0,g.jsx)(N().A,{...e,title:(0,g.jsx)(q().sA,{defaultMessage:"Date",id:"mentionMenu.dateSection.title"}),desktopTitleStyle:a?{paddingTop:4}:void 0,topBorder:!a}),items:b}}),[b,a,u]);return S}function pl(e){const{label:t,value:n,source:i,intl:s,setTemporaryInputData:o,hasReminderInResults:a}=e,r=n();e.focused&&o({title:t,icon:(0,g.jsx)(qa().sL,{}),allowTabCompletion:!0});const l="chrono-node"===i?function(e,t){const n="daterange"===e.type||"datetimerange"===e.type;if(n)return;const i=(0,yt().P)(),s=tl().DateTime.now().setZone(i);let o=tl().DateTime.fromFormat(e.start_date,sl().tr,{zone:i});"date"===e.type?o=o.startOf("day"):"datetime"===e.type&&(o=(0,sl().mF)(e));if("datetime"===e.type&&e.start_time){const e=Math.round(o.diff(s,"minutes").minutes),n=Math.abs(e),i=e>0;if(n<yl)return 0===n?t.formatMessage(Ml.now):t.formatMessage(i?Ml.minutesFromNow:Ml.minutesAgo,{count:n});if(n<vl){const e=Math.round(n/60);return t.formatMessage(i?Ml.hoursFromNow:Ml.hoursAgo,{count:e})}}const a=s.startOf("day"),r=Math.round(o.startOf("day").diff(a,"days").days);if(0===r)return t.formatMessage(Ml.today);if(1===r)return t.formatMessage(Ml.tomorrow);if(-1===r)return t.formatMessage(Ml.yesterday);const l=Math.abs(r),d=r>0;return l<ml?t.formatMessage(d?Ml.daysFromToday:Ml.daysAgo,{count:l}):l<fl?t.formatMessage(d?Ml.weeksFromToday:Ml.weeksAgo,{count:Math.round(l/ml)}):l<hl?t.formatMessage(d?Ml.monthsFromToday:Ml.monthsAgo,{count:Math.round(l/fl)}):t.formatMessage(d?Ml.yearsFromToday:Ml.yearsAgo,{count:Math.round(l/hl)})}(n(),s):ol().e_(t,s)?(0,il().ZF)({value:r,userTimeZone:(0,yt().P)(),intl:s,allowRelativeDates:!1}):void 0;if((0,Vs().Lh)(n())){const n=s.formatMessage(Ml.remind);return(0,g.jsx)(E().A,{...e,title:n,caption:l??t,inline:!0,icon:(0,g.jsx)(Qi().I,{icon:al().alarmIcon}),shouldWrapCaption:!0})}return(0,g.jsx)(E().A,{...e,title:t,caption:a?"":l,inline:Boolean(l),icon:(0,g.jsx)(Qi().I,{icon:rl().clockIcon}),shouldWrapCaption:!0})}function gl(e){const t=e.isCertain("minute")?"minute":e.isCertain("hour")?"hour":"day";return"minute"===t?{unit:t,value:e.get("minute")??0}:"hour"===t?{unit:t,value:e.get("hour")??0}:{unit:"day",value:0,time:Vs().lM}}const ml=7,fl=30,hl=365,yl=60,vl=24*yl;const bl={time:Vs().lM,unit:"day",value:0};function Sl(e){const t=sl().Dz(e);if(!t)return!1;if("datetime"===e.type&&e.start_time){const t=tl().DateTime.now().setZone((0,yt().P)());return(0,sl().mF)(e)>t}return t.start>sl().ah((0,yt().P)())}function xl(e){if((0,Vs().Lh)(e)||!Sl(e))return e;switch(e.type){case"date":case"daterange":return{...e,reminder:bl};case"datetimerange":case"datetime":return{...e,reminder:{unit:"minute",value:0}};default:(0,Ft().HB)(e)}}const Ml=(0,q().YK)({autocompleteToday:{defaultMessage:"Today",id:"mentionMenu.date.autocomplete.today"},autocompleteNextTuesday:{defaultMessage:"Next Tuesday 3pm",id:"mentionMenu.date.autocomplete.nextTuesday"},autocompleteReminderV2:{defaultMessage:"Tomorrow 9am",id:"mentionMenu.date.autocomplete.reminderV2"},remind:{defaultMessage:"Remind me",id:"mentionMenu.date.autocomplete.remind"},now:{defaultMessage:"Now",id:"mentionMenu.date.timeCaption.now"},today:{defaultMessage:"Today",id:"mentionMenu.date.timeCaption.today"},tomorrow:{defaultMessage:"Tomorrow",id:"mentionMenu.date.timeCaption.tomorrow"},yesterday:{defaultMessage:"Yesterday",id:"mentionMenu.date.timeCaption.yesterday"},minutesFromNow:{defaultMessage:"{count, plural, one {# minute from now} other {# minutes from now}}",id:"mentionMenu.date.timeCaption.minutesFromNow"},minutesAgo:{defaultMessage:"{count, plural, one {# minute ago} other {# minutes ago}}",id:"mentionMenu.date.timeCaption.minutesAgo"},hoursFromNow:{defaultMessage:"{count, plural, one {# hour from now} other {# hours from now}}",id:"mentionMenu.date.timeCaption.hoursFromNow"},hoursAgo:{defaultMessage:"{count, plural, one {# hour ago} other {# hours ago}}",id:"mentionMenu.date.timeCaption.hoursAgo"},daysFromToday:{defaultMessage:"{count, plural, one {# day from now} other {# days from now}}",id:"mentionMenu.date.timeCaption.daysFromToday"},daysAgo:{defaultMessage:"{count, plural, one {# day ago} other {# days ago}}",id:"mentionMenu.date.timeCaption.daysAgo"},weeksFromToday:{defaultMessage:"{count, plural, one {# week from now} other {# weeks from now}}",id:"mentionMenu.date.timeCaption.weeksFromToday"},weeksAgo:{defaultMessage:"{count, plural, one {# week ago} other {# weeks ago}}",id:"mentionMenu.date.timeCaption.weeksAgo"},monthsFromToday:{defaultMessage:"{count, plural, one {# month from now} other {# months from now}}",id:"mentionMenu.date.timeCaption.monthsFromToday"},monthsAgo:{defaultMessage:"{count, plural, one {# month ago} other {# months ago}}",id:"mentionMenu.date.timeCaption.monthsAgo"},yearsFromToday:{defaultMessage:"{count, plural, one {# year from now} other {# years from now}}",id:"mentionMenu.date.timeCaption.yearsFromToday"},yearsAgo:{defaultMessage:"{count, plural, one {# year ago} other {# years ago}}",id:"mentionMenu.date.timeCaption.yearsAgo"},ago:{defaultMessage:"ago",id:"mentionMenu.date.timeCaption.ago"}});var Al=()=>n(169626),jl=()=>n(862139);const wl=(0,q().YK)({groupMentionCaption:{defaultMessage:"{numMembersInGroup, plural, one {{numMembersInGroup} member} other {{numMembersInGroup} members}}",id:"mentionMenu.group.caption"}});function Il(e){const{isFirstSection:t,query:n,setTemporaryInputData:s}=e,a=(0,r().v3)(),d=(0,q().tz)(),c=function(e){const{query:t}=e,n=(0,l().K8)((()=>et().Ay.state.mentionTypes.group),[]),s=(0,l().K8)((()=>Al().h.getAllGroups()),[]),o=(0,i.useMemo)((()=>n?(0,Kr().Ay)(t,s,(e=>e.name||""),{normalizeFuzzyScore:!0}):[]),[n,t,s]);return o}({query:n}),u=(0,Fn().r)(),p=(0,l().K8)((()=>{const e=new Map;for(const t of c){const n=Al().h.getGroupData(t.group_id);n?e.set(t.group_id,n.memberCount):Bn().log({level:"warning",from:"useGroupResultsMenuSection",type:"groupDataNotFound",data:{groupId:t.group_id}})}return e}),[c]),m=(0,i.useMemo)((()=>St().oE(c.map((e=>{if(!u)return;const t=d.formatMessage(wl.groupMentionCaption,{numMembersInGroup:p.get(e.group_id)||0});return{key:e.id,render:n=>(n.focused&&s({title:e.name||"",icon:(0,g.jsx)(qa().sL,{}),allowTabCompletion:!0}),(0,g.jsx)(jl()._,{menuListItemProps:{...n,caption:t},group:e,iconSizeOverride:o().A.isMobile?24:void 0})),action:t=>{at().createAndCommit({userAction:"MentionMenu.groupMention",environment:a,canUndo:!0,perform:i=>{Va().Ju({environment:a,editorMode:"default",annotations:[qs().dWL(e.group_id,u)],transaction:i,menuListItemAction:t,query:n,mentionType:"group"})}})}}})))),[c,u,d,s,a,n,p]),f=(0,i.useMemo)((()=>{if(0!==m.length)return{key:"group results",render:e=>(0,g.jsx)(N().A,{...e,title:(0,g.jsx)(q().sA,{defaultMessage:"Groups",id:"mentionMenu.groupSection.title"}),desktopTitleStyle:t?{paddingTop:4}:void 0,topBorder:!t}),items:m}}),[m,t]);return f}var kl=()=>n(125958),Tl=()=>n(18387),Cl=()=>n(16006);const _l=i.forwardRef((function(e,t){const{store:i}=e;return(0,g.jsx)(E().A,{...e,ref:t,title:(0,g.jsx)(Cl().A,{store:i}),className:"notranslate",icon:(0,g.jsx)(Qi().I,{icon:n(96042).I})})}));function Pl(e){const t=(0,r().v3)(),n=(0,q().tz)(),{query:o,setTemporaryInputData:a,isFirstSection:d}=e,c=function(e){const{intl:t,query:n}=e,i=n.toLowerCase(),o=(0,s().X)("mention_menu_page_headings"),a=(0,l().K8)((()=>o&&et().Ay.state.mentionTypes.heading),[o]),r=(0,l().K8)((()=>{const e=(0,Tl().Z)();if(!e)return;const{mainEditorCurrentBlockStore:t}=v().default.state;return e===t?t:Ms().default.peekTargetStore.state===e?Ms().default.peekTargetStore.state:void 0}),[]),d=(0,l().K8)((()=>a&&r?(0,kl().T)(r.id,r.getRecordModel):[]),[a,r],{recomputeSchedule:"lazy"}),c=(0,l().K8)((()=>r?(0,St().oE)(d.map((e=>{const n=j().B.createChildStore(r,{table:V().ev,id:e}),s=n.getModel();if(!s)return;const o=s.getRenderTitle({getRecordModel:n.getRecordModel,userTimeZone:(0,yt().P)(),intl:t});return o&&o.toLowerCase().includes(i)?n:void 0}))):[]),[t,i,r,d],{recomputeSchedule:"lazy"});return c}({query:o,intl:n}),u=0===c.length,p=(0,l().K8)((()=>c.map((e=>{const i=e.id;return{key:i,render:t=>{if(t.focused){const t=e.getModel();if(t){const i=t.getRenderTitle({getRecordModel:e.getRecordModel,userTimeZone:(0,yt().P)(),intl:n});a({title:i||"",icon:(0,g.jsx)(qa().zC,{}),allowTabCompletion:!0})}}return(0,g.jsx)(_l,{...t,store:e})},action:e=>{at().createAndCommit({userAction:"MentionMenu.getHeaderResultsMenuSection",environment:t,canUndo:!0,perform:n=>{Va().Ju({environment:t,editorMode:"default",annotations:[["p",i]],transaction:n,menuListItemAction:e,query:o,mentionType:"heading"})}})}}}))),[t,c,n,o,a]),m=(0,i.useMemo)((()=>{if(!u)return{key:"heading results",render:e=>(0,g.jsx)(N().A,{...e,title:(0,g.jsx)(q().sA,{defaultMessage:"Link to heading",id:"mentionMenu.headerSection.title"}),desktopTitleStyle:d?{paddingTop:4}:void 0,topBorder:!d}),items:p}}),[p,d,u]);return m}var Bl=()=>n(519831);var Rl=()=>n(852711);function Dl(e){const{isFirstSection:t,query:n,setTemporaryInputData:s,disabled:o=!1}=e,{teamResults:a,currentTeamResultStore:d}=function(e){const{isMobileNative:t}=(0,r().Y0)(),{query:n}=e,i=(0,l().K8)((()=>(0,Mn().D)({isMobileNative:t,disableExposureLogging:!0})&&et().Ay.state.mentionTypes.team),[t]),s=(0,l().K8)((()=>{if(!i)return[];if(!et().Ay.state.open)return[];const e=v().default.state.sidebarSpaceViewStore,t=e?(0,Fr().r)(e):[];return(0,Kr().Ay)(n,t,(e=>e.getName()||""),{normalizeFuzzyScore:!0})}),[i,n]),o=(0,l().K8)((()=>et().Ay.state.open?et().Ay.state.textStore:void 0),[]);return{teamResults:s,currentTeamResultStore:(0,l().K8)((()=>{if(o&&(0,Nr().W)(o))return(0,Or().I)(o)}),[o])}}({query:n}),c=(0,r().v3)(),u=(0,Fn().r)(),p=(0,l().K8)((()=>St().oE(a.map((e=>{if(!u)return;return{key:e.id,render:t=>(t.focused&&s({title:e.getName()||"",icon:(0,g.jsx)(qa().sL,{}),allowTabCompletion:!0}),(0,i.createElement)(Rl().A,{...t,key:e.id,teamStore:e})),action:t=>{at().createAndCommit({userAction:"MentionMenu.teamMention",environment:c,canUndo:!0,perform:i=>{const s=qs().DH3(e.id,u,"teamspace");Va().Ju({environment:c,editorMode:"default",annotations:[s],transaction:i,menuListItemAction:t,query:n,mentionType:"team"})}})}}})))),[c,n,s,u,a]),m=(0,i.useMemo)((()=>{if(!o&&0!==p.length)return{key:"team results",render:e=>(0,g.jsx)(N().A,{...e,title:(0,g.jsx)(q().sA,{defaultMessage:"Teams",id:"mentionMenu.teamSection.title"}),desktopTitleStyle:t?{paddingTop:4}:void 0,topBorder:!t}),items:p}}),[p,t,o]);return{currentTeamResultStore:o?void 0:d,teamResultsSection:m}}var Ll=()=>n(542129),El=(n(908872),()=>n(764880)),Ol=()=>n(833243),Nl=()=>n(695608),Fl=()=>n(498212),Ul=()=>n(812182),zl=()=>n(499764),Kl=()=>n(385979),Vl=()=>n(928074),ql=()=>n(448693);const Wl=(0,q().YK)({here:{id:"mentionMenu.SlackSpecialMentionMenuItem.hereMention",defaultMessage:"@here"},channel:{id:"mentionMenu.SlackSpecialMentionMenuItem.channelMention",defaultMessage:"@channel"}}),Gl=(0,q().YK)({here:{id:"mentionMenu.SlackSpecialMentionMenuItem.hereMentionNoAmpersand",defaultMessage:"here"},channel:{id:"mentionMenu.SlackSpecialMentionMenuItem.channelMentionNoAmpersand",defaultMessage:"channel"}}),Hl=[{message:Gl.here,channelRecipient:"here"},{message:Gl.channel,channelRecipient:"channel"}],Yl=i.forwardRef((function(e,t){const{channelRecipient:i}=e;return(0,g.jsx)(E().A,{...e,icon:(0,g.jsx)(Qi().I,{icon:n(523277).q}),title:(0,g.jsx)(q().sA,{...Wl[i]}),ref:t,inline:!0,caption:(0,g.jsx)(q().sA,{...Wl[i]})})}));var $l=()=>n(421861),Ql=()=>n(341694),Zl=()=>n(62088);const Xl="__invite";function Jl(e){const{isFirstSection:t,query:n,inviteTargetsStore:a,personPropertyInviteStore:d,mentionMenuCurrentMentionStore:c,setTemporaryInputData:u,templateVariableResults:p,formulaContextVariableResults:m,currentTeamResultStore:f,disabled:h}=e,v=(0,r().v3)(),b=(0,q().tz)(),S=(0,s().X)("mention_menu_section_prioritization_enabled"),x=(0,l().K8)((()=>et().Ay.state.mentionTypes.user),[]),{results:M,isLoading:A}=(0,Zl().uE)({query:n,disabled:h,useMentionMenuStore:!0}),j=(0,l().K8)((()=>(0,us().a)()),[]),w=(0,l().K8)((()=>j&&Boolean(Ir().K.get({userId:v.currentUser.id,key:(0,Pr().T)(j.id)}))),[v.currentUser.id,j]),I=(0,l().K8)((()=>et().Ay.state.mentionTypes.inviteUserToPage&&!w),[w]),k=dl({templateVariableResults:p,category:"user",query:n,setTemporaryInputData:u}),T=(0,cl().DK)({formulaReturnType:"person",query:n,formulaContextVariableResults:m,setTemporaryInputData:u}),C=(0,l().K8)((()=>{const e=et().Ay.state.mentionTypes.team;return(0,Mn().D)({isMobileNative:v.device.isMobileNative,disableExposureLogging:!0})&&e}),[v.device.isMobileNative]),_=(0,l().K8)((()=>!M.find((e=>e.email===n))&&et().Ay.state.mentionTypes.inviteUserToWorkspace&&a&&d),[n,M,a,d]),P=(0,Fn().r)(),B=(0,l().K8)((()=>{var e;return"slack_notification"===(null===(e=Vr().A.state.automationActionStore)||void 0===e?void 0:e.getType())}),[]),R=_||M.length>0||k.length>0||T.length>0||C,D=(0,l().K8)((()=>{if(!P||!f||!R)return;const e=b.formatMessage({id:"posts.teamMenuItem.everyoneMentionNoAmpersand",defaultMessage:"everyone"});return e.startsWith(n)?{key:"everyone-unique-item",render:t=>(t.focused&&u({title:e,icon:(0,g.jsx)(qa().sL,{}),allowTabCompletion:!0}),(0,i.createElement)(Rl().A,{...t,key:"everyone-unique-item",teamStore:f,renderAsEveryoneMention:!0})),action:e=>{at().createAndCommit({userAction:"MentionMenu.teamMention",environment:v,canUndo:!0,perform:t=>{Va().Ju({environment:v,editorMode:"default",annotations:[qs().DH3(f.id,P,"everyone")],transaction:t,menuListItemAction:e,query:n,mentionType:"team"})}})}}:void 0}),[R,f,v,b,n,u,P]),L=(0,l().K8)((()=>Hl.reduce(((e,t)=>{if(!B)return e;const{channelRecipient:s,message:o}=t,a=b.formatMessage(o);if("channel"!==s&&"here"!==s)return e;if(!a.startsWith(n))return e;const r=function(e){return`slack-special-mention-${e}-unique-item`}(s),l={key:r,render:e=>(e.focused&&u({title:a,icon:(0,g.jsx)(qa().sL,{}),allowTabCompletion:!0}),(0,i.createElement)(Yl,{...e,channelRecipient:s,key:r})),action:e=>{at().createAndCommit({userAction:`MentionMenu.slackSpecialMention.${o.id}MenuItem`,environment:v,canUndo:!0,perform:t=>{Va().Ju({environment:v,editorMode:"default",annotations:[qs().zP1(s)],transaction:t,menuListItemAction:e,query:n,mentionType:"slackSpecialMention"})}})}};return e.push(l),e}),[])),[B,v,b,n,u]),O=(0,Ql().H)(),F=(0,l().K8)((()=>et().Ay.getMentionMenuContext()??V().ev),[]),U=(0,l().K8)((()=>!!j&&((0,Vl().Aj)({store:j})&&j.canAdmin())),[j]),z=(0,i.useCallback)((async({user:e})=>{if(!(!o().A.isMobile&&O&&!w&&U))return;if(!j)return;const t=await At().callApi({eventName:"canMentionInviteUserToPage",environment:v,data:{block:{id:j.pointer.id,table:V().ev,spaceId:j.getSpaceId()},mentionedUser:{id:e.id,table:Rs().oo,spaceId:j.getSpaceId()}}});if("success"!==t.type||!t.data.canInvite)return;const n=(0,Fl().Ay)();Ul().HK(function(e){const{environment:t,user:n,pageStore:i,intl:s,flowId:o,from:a}=e;return i&&Ir().K.set({userId:t.currentUser.id,key:(0,Pr().T)(i.id),value:!0}),{id:`invite_${n.id}`,title:s.formatMessage(nd.pageInviteToastTitle,{name:n.name??n.email}),jsxMessage:(0,g.jsx)(ed,{user:n}),actions:{primary:{title:s.formatMessage(nd.pageInviteToastInviteButton),onAction:()=>{if(!i)return;const s="read_and_write";at().createAndCommit({userAction:"MentionMenu.menuItem",environment:t,canUndo:!0,perform:e=>{Tr().zP({environment:t,transaction:e,store:i,permissionItems:[{type:"user_permission",role:s,user_id:n.id}],pagePermissionChangeLocation:"mention_share_menu",fromPermissionWrapper:"mention_menu",flowId:o})}}),Ir().K.set({userId:t.currentUser.id,key:(0,Pr().T)(i.id),value:!1}),kr().Jg(t,{role:s,is_space:!1,invite_targets:[{type:"existingUser",value:n}],is_onboarding:!1,invite_origin:"mention_menu",permission_items:[{type:"user_permission",role:s,user_id:n.id}],invite_message_length:0,invite_flow_id:o}),td(t,{flow_id:o,selection:"invite",target_user_id:n.id,from:a}),Ul().HK(function(e){const{user:t,intl:n,environment:i,pageStore:s,flowId:o,from:a}=e;return{id:`invite_${t.id}`,icon:Ol().checkmarkCircleSmallIcon,title:n.formatMessage(nd.pageInviteSnackbarSuccessTitle),jsxMessage:void 0,message:n.formatMessage(nd.pageInviteSnackbarSuccessMessage),actions:{primary:{title:n.formatMessage(nd.pageInviteUndo),onAction:()=>{at().createAndCommit({userAction:"MentionMenu.menuItem",environment:i,canUndo:!0,perform:e=>{s&&Tr().zP({environment:i,transaction:e,store:s,permissionItems:[{type:"user_permission",role:"none",user_id:t.id}],pagePermissionChangeLocation:"mention_share_menu",flowId:o})}}),Ul().UW(`invite_${t.id}`),function(e,t){(0,y().u)({environment:e,event:{eventName:"undo_invite_to_page_popup",eventProperties:t}})}(i,{flow_id:o,target_user_id:t.id,from:a})}}}}}(e))}},secondary:{title:s.formatMessage(nd.pageInviteToastIgnoreButton),onAction:()=>{i&&(Ul().UW(`invite_${n.id}`),td(t,{flow_id:o,selection:"dismiss",target_user_id:n.id,from:a}))}}}}}({environment:v,user:e,pageStore:j,intl:b,flowId:n,from:F})),function(e,t){(0,y().u)({environment:e,event:{eventName:"trigger_invite_to_page_popup",eventProperties:t}})}(v,{flow_id:n,target_user_id:e.id,from:F})}),[v,w,U,O,j,F,b]),K=(0,l().K8)((()=>et().Ay.state.open?et().Ay.state.flowId:void 0),[]),W=(0,i.useCallback)(((e,t,n,i)=>{t.reset(),n.reset(),K&&(t.setState({...t.state,tokenQuery:i}),n.setState({...n.state,flowId:K}),cr().TS(e,{origin:et().Ay.getInviteOrigin(),invite_flow_id:K}),et().Ay.updateOpenState({showInvite:!0}))}),[K]),G=(0,l().K8)((()=>M.map((e=>{const t=e.id;return{key:t,render:n=>(n.focused&&u({title:(0,Nl().c6)(b,e),icon:(0,g.jsx)(qa().sL,{}),allowTabCompletion:!0}),(0,i.createElement)($l().i,{...n,key:t,user:e})),action:i=>{const s=(0,zl().om)(t);I&&"none"===s?(c.setState({userId:t,userEmail:e.email,displayName:(0,El().A7)(e).getDisplayName(b)}),et().Ay.updateOpenState({showMentionAndShare:!0})):(at().createAndCommit({userAction:"MentionMenu.menuItem",environment:v,canUndo:!0,perform:t=>{Va().Ju({environment:v,editorMode:"default",annotations:[(0,qs().P4h)(e.id)],transaction:t,menuListItemAction:i,query:n,mentionType:"user"})}}),z({user:e}))}}})).concat(_&&R&&a&&d?[{key:Xl,action:()=>W(v,a,d,n),render:e=>(e.focused&&u({title:"",icon:(0,g.jsx)(qa().sL,{}),allowTabCompletion:!1}),(0,g.jsx)(E().A,{...e,icon:(0,g.jsx)(Qi().I,{icon:wr().inviteMemberIcon}),title:n.length>0?(0,g.jsx)(q().sA,{defaultMessage:"Invite “{query}”…",id:"mentionMenu.peopleSection.invitePrompt",values:{query:n}}):(0,g.jsx)(q().sA,{defaultMessage:"Invite…",id:"mentionMenu.peopleSection.invitePrompt.empty"})}))}]:[])),[z,v,W,b,a,c,d,n,u,_,I,R,M]),H=(0,i.useMemo)((()=>[...D?[D]:[],...L,...T,...k,...G]),[D,T,k,L,G]),Y=(0,Kl().h)({resultsCount:H.length,shouldShow:A,variant:"mention-menu-people"}),$=(0,i.useMemo)((()=>{if(0===H.length&&!A)return;const e=H.length>0;return{key:A&&!e?"user-results-loading":A||e?"user-results":"user-results-empty",render:e=>(0,g.jsx)(N().A,{...e,title:(0,g.jsx)(q().sA,{id:"mentionMenu.peopleSection.title",defaultMessage:"People"}),desktopTitleStyle:t?{paddingTop:4}:void 0,topBorder:!t}),items:[...H,...Y]}}),[H,A,Y,t]);if(!x)return{userResultsSection:void 0,isUserResultsLoading:!1,numberOfUserResults:0,hasUserResultsWithPrefixedMatch:!1};const Q=function(e,t){if(t.length<2)return!1;const n=e.some((e=>{var n;return e.email.toLowerCase().startsWith(t.toLowerCase())||(null===(n=e.name)||void 0===n?void 0:n.toLowerCase().startsWith(t.toLowerCase()))}));return n}(M,n);return{hasUserResultsWithPrefixedMatch:S&&Q,userResultsSection:$,isUserResultsLoading:A,numberOfUserResults:M.length}}function ed(e){const{user:t}=e,n=(0,x().IS)((()=>{const e=(0,W().O4)({theme:"dark"});return{container:{display:"flex",flexDirection:"column",gap:4},tokenContainer:{paddingTop:4,paddingBottom:4},darkTooltip:{background:e.background.accentPrimary,color:e.text.inversePrimary}}}),[]);return(0,g.jsxs)("div",{style:n.container,children:[(0,g.jsx)(Te().m,{overlayContainerZIndex:202,alignment:"center",originGap:2,placement:"top",renderTooltip:()=>t.email,render:e=>(0,g.jsx)("div",{style:n.tokenContainer,...e,children:(0,g.jsx)(ql().t_,{userValue:t,isSingle:!0,shouldShrink:!0,format:ql().t_.Format.Medium,hasPersonHoverCard:!1})}),style:n.darkTooltip}),(0,g.jsx)("div",{children:(0,g.jsx)(q().sA,{...nd.pageInviteToastMessage})})]})}function td(e,t){(0,y().u)({environment:e,event:{eventName:"select_invite_to_page_popup",eventProperties:t}})}const nd=(0,q().YK)({pageInviteToastTitle:{defaultMessage:"Invite to page?",id:"mentionMenu.UserMentionMenuItem.inviteToastTitle"},pageInviteToastMessage:{defaultMessage:"They won’t be notified unless you invite them to the page.",id:"mentionMenu.UserMentionMenuItem.inviteToastMessage"},pageInviteToastInviteButton:{defaultMessage:"Invite",id:"mentionMenu.UserMentionMenuItem.inviteToastInviteButton"},pageInviteToastIgnoreButton:{defaultMessage:"Ignore",id:"mentionMenu.UserMentionMenuItem.inviteToastIgnoreButton"},pageInviteSnackbarSuccessTitle:{defaultMessage:"Invite sent",id:"mentionMenu.UserMentionMenuItem.snackbarInviteSuccessTitle"},pageInviteSnackbarSuccessMessage:{defaultMessage:"They were notified and invited to edit the page.",id:"mentionMenu.UserMentionMenuItem.snackbarInviteSuccessMessage"},pageInviteUndo:{defaultMessage:"Undo",id:"mentionMenu.UserMentionMenuItem.undoToastMessage"}});var id=()=>n(842599);function sd(e){const{hasUserResultsWithPrefixedMatch:t,numberOfUserResults:n,templateVariableResults:s,query:o}=e,a=o.length>0,r=(0,l().K8)((()=>et().Ay.state.open&&et().Ay.state.insertionType),[]),d=function(e){const{hasUserResultsWithPrefixedMatch:t,templateVariableResults:n,query:i,numberOfUserResults:s}=e,o=(0,l().K8)((()=>et().Ay.state.open),[]),a=(0,l().K8)((()=>et().Ay.state.open?et().Ay.state.sectionOrder:void 0),[]),r=function(e){const{numberOfUserResults:t,templateVariableResults:n,query:i}=e,s=t+n.length;if(""===i||s>0||(0,id().xn)(i))return!0;const o=n.some((e=>(0,zr().BX)(e,"user")));if(o)return!0;return!1}({numberOfUserResults:s,templateVariableResults:n,query:i});if(o&&a)return a;if(r)return t?rd:ad;return od}({hasUserResultsWithPrefixedMatch:t,numberOfUserResults:n,templateVariableResults:s,query:o});return(0,i.useMemo)((()=>{const e=d,t=(0,H().sb)([...e,...et().kc]),n=t.filter((e=>"createPage"!==e));return"+"===r?["createPage",...n]:"@"===r&&a||"[["===r?[...n,"createPage"]:t}),[a,r,d])}const od=["date","page","team","group","heading","user","bot"],ad=["date","user","bot","page","team","group","heading"],rd=["user","date","bot","page","team","group","heading"];function ld(e){const{query:t,clearSavedSelection:n,inviteTargetsStore:s,personPropertyInviteStore:o,mentionMenuCurrentMentionStore:a,mentionMenuCurrentFormulaStore:d,setTemporaryInputData:c,shouldIncludeDataSourceMentions:u}=e,[p,m]=(0,i.useState)(od[0]),f=(0,r().v3)(),h=(0,l().K8)((()=>(0,Er().y)(f)),[f]),y=(0,r().WS)(),{expandSection:v,isOpen:b,collectionStore:S}=(0,l().K8)((()=>({isOpen:et().Ay.state.open,expandSection:et().Ay.state.open?et().Ay.state.expandSection:void 0,collectionStore:et().Ay.state.open?et().Ay.state.collectionStore:void 0})),[]),M=function(e){const t=(0,q().tz)();return(0,l().K8)((()=>et().Ay.state.mentionTypes.templateVariable),[])?(0,zr().W4)(e,t):[]}(t),A=function(e){const t=(0,l().K8)((()=>et().Ay.state.mentionTypes.formulaContextVariable),[]),{automationActionStore:n,typecheckResult:s}=(0,l().K8)((()=>({automationActionStore:Vr().A.state.automationActionStore,typecheckResult:Vr().A.state.typecheckResult})),[]),o=(0,i.useMemo)((()=>n&&s?(0,Ur().getContextValuesForAction)({value:s},n.id):(null==s?void 0:s.valueTypes)||[]),[n,s]),a=s&&t;return(0,i.useMemo)((()=>a?(0,Kr().Ay)(e,o,(e=>e.kind!==Fa().FormulaContextValueKind.ContextValue?"":e.name),{normalizeFuzzyScore:!0}):[]),[a,e,o])}(t),{pageResultsSection:j,isPageResultsLoading:w,reportBadSearchMetadata:I}=(0,Ll().v)({query:t,isFirstSection:"page"===p,setTemporaryInputData:c,formulaContextVariableResults:A,shouldIncludeDataSourceMentions:u}),k=ul({templateVariableResults:M,formulaContextVariableResults:A,isFirstSection:"date"===p,query:t,setTemporaryInputData:c}),T=Pl({query:t,setTemporaryInputData:c,isFirstSection:"heading"===p}),{teamResultsSection:C,currentTeamResultStore:_}=Dl({isFirstSection:"team"===p,query:t,setTemporaryInputData:c}),{userResultsSection:P,isUserResultsLoading:B,numberOfUserResults:R,hasUserResultsWithPrefixedMatch:D}=Jl({isFirstSection:"user"===p,query:t,inviteTargetsStore:s,personPropertyInviteStore:o,mentionMenuCurrentMentionStore:a,setTemporaryInputData:c,templateVariableResults:M,formulaContextVariableResults:A,currentTeamResultStore:_,disabled:h}),L=Il({isFirstSection:"group"===p,query:t,setTemporaryInputData:c}),O=el({isFirstSection:"createPage"===p,query:t,clearSavedSelection:n,setTemporaryInputData:c}),F=(0,cl().BT)({mentionMenuCurrentFormulaStore:d,setTemporaryInputData:c,isFirstSection:"formula"===p,formulaContextVariableResults:A}),U=(0,cl().bO)({query:t,formulaContextVariableResults:A,setTemporaryInputData:c,isFirstSection:"custom-formula"===p}),{botResultsSection:z,isBotResultsLoading:K}=(0,qr().Ju)({isFirstSection:"bot"===p,query:t,setTemporaryInputData:c,disabled:h}),V=function(e){const{query:t,setTemporaryInputData:n,collectionStore:s,disabled:o=!1}=e,a=(0,r().v3)(),d=(0,l().K8)((()=>{if(!s||o)return[];const e=s.getSchema();return e?Object.entries(e).map((([e,t])=>({id:e,name:t.name||"",type:t.type}))):[]}),[s,o]),c=(0,i.useMemo)((()=>d.length?(0,Kr().Ay)(t,d,(e=>e.name)):[]),[d,t]),u=(0,x().DP)(),p=(0,i.useMemo)((()=>c.map((e=>({key:`property-${e.id}`,render:t=>(t.focused&&n({title:e.name,icon:(0,g.jsx)(qa().sL,{}),allowTabCompletion:!0}),(0,g.jsx)(E().A,{...t,title:e.name,caption:e.type,inline:!0,icon:(0,g.jsx)(Na().zB,{type:e.type,icon:void 0,size:16,theme:u})})),action:n=>{if(!s)return;const i=qs().ESw({property:e.id,collection:{table:Bl().Vl,id:s.id,spaceId:s.getSpaceId()},name:e.name});at().createAndCommit({userAction:"insertPropertyMention",environment:a,canUndo:!0,perform:e=>{Va().Ju({environment:a,editorMode:"default",annotations:[i],transaction:e,menuListItemAction:n,query:t,mentionType:"property"})}})}})))),[c,n,s,a,t,u]);if(p.length&&!o)return{key:"property",render:e=>(0,g.jsx)(N().A,{...e,title:(0,g.jsx)(q().sA,{id:"mentionMenu.propertySection",defaultMessage:"Properties"})}),items:p}}({isFirstSection:"property"===p,query:t,setTemporaryInputData:c,collectionStore:S,disabled:!S}),G=(0,i.useMemo)((()=>({date:k,user:P,page:j,group:L,team:C,heading:T,createPage:O,formula:F,"custom-formula":U,property:V,bot:z})),[k,P,j,L,C,T,O,F,U,V,z]),H=sd({hasUserResultsWithPrefixedMatch:D,templateVariableResults:M,numberOfUserResults:R,query:t});(0,i.useEffect)((()=>{const e=H.find((e=>void 0!==G[e]));m(e??H[0])}),[G,H]);const Y=!B&&!w&&!K;(0,i.useEffect)((()=>{const e=Dr().default.DO_NOT_USE_markLegacy("rum.mention_menu_ready");Y&&Dr().default.DO_NOT_USE_measureLegacy(e,{environment:f})}),[f,Y]);const $=(0,i.useCallback)((e=>function(e){const{sectionName:t,menuSection:n,isOpen:i,expandSection:s,isPhone:o}=e;if(!i||s===t)return n;const{items:a}=n,r=o||"heading"===t?3:5;if(a.length<=r)return n;const l=[...a.slice(0,r),{key:"show more",render:e=>(0,g.jsx)(E().A,{...e,onMouseDown:e=>{e.target instanceof HTMLElement&&e.target.click(),e.stopPropagation()},icon:(0,g.jsx)(Qi().I,{icon:Lr().ellipsisIcon,colorVariant:"secondary"}),title:(0,g.jsx)("span",{style:{color:W().Tj.text.secondary},children:(0,g.jsx)(q().sA,{defaultMessage:"{numberMore} more results",id:"mentionMenu.showMoreResultsButton.title",values:{numberMore:a.length-r}})})}),action:()=>{et().Ay.updateOpenState({expandSection:t})}}];return{...n,items:l}}({sectionName:e.sectionName,menuSection:e.menuSection,isPhone:y,isOpen:b,expandSection:v})),[y,b,v]);return{sections:(0,i.useMemo)((()=>{const e=[];for(const t of H){const n=G[t];n&&(h&&"user"===t||e.push("createPage"===t?n:$({sectionName:t,menuSection:n})))}return e}),[H,G,$,h]),reportBadSearchMetadata:I,numberOfUserResults:R,isSearchLoading:w||B}}var dd=()=>n(104556),cd=()=>n(542101),ud=()=>n(245241),pd=()=>n(174192),gd=()=>n(702473);function md(e){const{reportBadSearchMetadata:t,isLoading:n=!1}=e,{debugInfo:s,localResults:o,serverResults:a,exposedSearchExperiments:r,reportBadSearchInputRequest:d}=t,c=(0,q().tz)(),u=(0,l().K8)((()=>gd().A.state.open),[]),p=(0,i.useCallback)((e=>{n||gd().A.update((t=>({...t,open:!0,feedback:e})))}),[n]),m=(0,x().IS)((()=>({container:{display:"flex",alignItems:"center",gap:4},text:{fontSize:12,color:n?W().Tj.text.disabled:W().Tj.text.tertiary,marginInlineStart:4},iconButton:{height:20,width:20,padding:2}})),[n]);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("div",{style:m.container,children:[(0,g.jsx)(Te().m,{placement:"top",renderTooltip:()=>(0,g.jsx)("div",{children:c.formatMessage(fd.tooltipGood)}),render:e=>(0,g.jsx)(ke().A,{...e,onClick:()=>p("thumbsUp"),icon:cd().r,ariaLabel:c.formatMessage(fd.thumbsUpAriaLabel),style:m.iconButton,disabled:n})}),(0,g.jsx)(Te().m,{placement:"top",renderTooltip:()=>(0,g.jsx)("div",{children:c.formatMessage(fd.tooltipBad)}),render:e=>(0,g.jsx)(ke().A,{...e,onClick:()=>p("thumbsDown"),icon:dd()._,ariaLabel:c.formatMessage(fd.thumbsDownAriaLabel),style:m.iconButton,disabled:n})}),(0,g.jsx)("span",{style:m.text,children:c.formatMessage(fd.giveSearchFeedback)})]}),u?(0,g.jsx)(pd().e,{productSurface:ud().xi.mentionMenu,localResults:o,serverResults:a,debugInfo:s,exposedSearchExperiments:r,reportBadSearchInputRequest:d}):void 0]})}const fd=(0,q().YK)({tooltipGood:{id:"search.feedback.tooltip.good",defaultMessage:"Useful results"},tooltipBad:{id:"search.feedback.tooltip.bad",defaultMessage:"Not useful results"},thumbsUpAriaLabel:{id:"search.feedback.thumbsUp",defaultMessage:"Search was helpful"},thumbsDownAriaLabel:{id:"search.feedback.thumbsDown",defaultMessage:"Search was not helpful"},giveSearchFeedback:{id:"mentionMenu.feedback.giveSearchFeedback",defaultMessage:"Give search feedback"}}),hd=(0,q().YK)({noResults:{defaultMessage:"No results",id:"mentionMenu.noSearchResults.title"}}),yd=(0,q().YK)({mentionAll:{defaultMessage:"Mention a person, page, or date…",id:"mentionMenu.personPageDate.prompt2"},mentionPersonPage:{defaultMessage:"Mention a person or page…",id:"mentionMenu.personPage.prompt2"},mentionPersonDate:{defaultMessage:"Mention a person or date…",id:"mentionMenu.personDate.prompt2"},mentionPageDate:{defaultMessage:"Mention a page or date…",id:"mentionMenu.pageDate.prompt2"},mentionPerson:{defaultMessage:"Mention a person…",id:"mentionMenu.person.prompt2"},mentionDate:{defaultMessage:"Mention a date…",id:"mentionMenu.date.prompt2"},mentionPage:{defaultMessage:"Type to link or add page…",id:"mentionMenu.page.prompt2"}}),vd=i.memo((function(e){const{query:t,queryRef:n,clearSavedSelection:i,inviteTargetsStore:s,personPropertyInviteStore:o,mentionMenuCurrentMentionStore:a,mentionMenuCurrentFormulaStore:r}=e;return(0,g.jsx)(bd,{query:t,queryRef:n,clearSavedSelection:i,inviteTargetsStore:s,personPropertyInviteStore:o,mentionMenuCurrentMentionStore:a,mentionMenuCurrentFormulaStore:r})}));function bd({query:e,queryRef:t,clearSavedSelection:s,inviteTargetsStore:a,personPropertyInviteStore:d,mentionMenuCurrentMentionStore:c,mentionMenuCurrentFormulaStore:u}){const p=(0,q().tz)(),m=(0,r().v3)(),f=(0,l().O$)(et().Ay),h=(0,l().O$)(kn().e),y=Boolean(f.open&&f.usePopupOnMobile),v=Qa(t),{sections:b,reportBadSearchMetadata:S,isSearchLoading:M}=ld({clearSavedSelection:s,query:e,inviteTargetsStore:a,personPropertyInviteStore:d,mentionMenuCurrentMentionStore:c,mentionMenuCurrentFormulaStore:u,setTemporaryInputData:v,shouldIncludeDataSourceMentions:f.mentionTypes.collection}),A=(0,n(111043).o)();(0,i.useEffect)((()=>{if(!h)return;const e=f.mentionTypes.user,t=f.mentionTypes.page,n=f.mentionTypes.date;let i="";e&&t&&n?i=p.formatMessage(yd.mentionAll):e&&t?i=p.formatMessage(yd.mentionPersonPage):e&&n?i=p.formatMessage(yd.mentionPersonDate):t&&n?i=p.formatMessage(yd.mentionPageDate):e?i=p.formatMessage(yd.mentionPerson):n?i=p.formatMessage(yd.mentionDate):t&&f&&(i=f.open&&"+"===f.insertionType?p.formatMessage(Rr.addPage):p.formatMessage(yd.mentionPage)),v({title:i,icon:(0,g.jsx)(qa().gf,{insertionType:f.open?f.insertionType:"+"}),allowTabCompletion:!1})}),[h,v,p,f]);const j=(0,x().IS)((()=>({offlineMessage:{display:"flex",gap:4,alignItems:"center",background:W().Tj.background.secondary,borderRadius:4,padding:"8px 12px",margin:"12px 12px 0"},footer:{borderTop:`1px solid ${W().Tj.border.secondary}`,padding:"4px 12px"}})),[]);let w;h||(w=(0,g.jsxs)("div",{style:j.offlineMessage,children:[(0,g.jsx)(Qi().I,{icon:n(553034).C,size:18,colorVariant:"secondary"}),(0,g.jsx)(D().A,{isSmall:!0,showTooltipWhenTruncated:!0,children:(0,g.jsx)(q().sA,{defaultMessage:"Offline: Connect to see all options",id:"mentionMenu.offlineMessage"})})]}));const I=f.mentionTypes.page||f.mentionTypes.user,k=e.length>0&&I&&h?(0,g.jsx)("div",{style:j.footer,children:(0,g.jsx)(md,{reportBadSearchMetadata:S,isLoading:M})}):void 0,T=(0,l().K8)((()=>(0,Wa().W)()),[]),C=pr(m,t);let _;_=gr({usePopupOnMobile:y})?{menuType:R().gu.ActionSheet,disableBottomPadding:!0,height:`calc(70vh - ${A}px)`}:{menuType:R().gu.Popup,width:T,maxHeight:o().A.isMobile?"30vh":"40vh",onClickOutside:C};const P=(0,i.useCallback)((e=>{(function(e){return""===e})(t.current??"")&&(e.preventDefault(),C())}),[t,C]);return(0,g.jsxs)(L().A,{..._,header:w,footer:k,children:[(0,g.jsx)(Pi().N,{debugName:"MentionMenu",capture:f.open,onBackspace:P}),(0,g.jsx)(O().A,{type:O().O.Vertical,initialFocus:0,sections:b,onEmptyEnter:C,resetInitialFocusOnSectionChange:!0,performHandleEnterOnTab:!0}),0===b.length?(0,g.jsx)(N().A,{children:(0,g.jsx)(n(449279).u,{title:(0,g.jsx)(q().sA,{...hd.noResults})})}):void 0]})}function Sd(){const e=(0,r().v3)(),t=(0,l().O$)(et().Ay),n=t.open&&t.showCreateIn,s=t.open&&t.showInvite,a=t.open&&t.showMentionAndShare,d=t.open&&t.showFormulaProperty,c=Boolean(t.usePopupOnMobile),u=(0,l().uB)(void 0,tr().Ay),p=(0,l().uB)(void 0,nr().A),m=(0,l().uB)(void 0,rr),f=(0,l().uB)(void 0,sr),h=(0,l().K8)((()=>{if(t.open)return(0,Ra().a)(t.textStore,t.oldTextValue,t.isEmptyPageTitle?"":t.insertionType)}),[t]),y=(0,l().K8)((()=>{if(h&&t.open)return(0,Ba().m)(t.textStore,h)}),[h,t]),v=(0,l().K8)((()=>lr(e,y)),[e,y]),b=(0,i.useRef)(v);(0,i.useEffect)((()=>{b.current=v}),[v]);const S=!!t.open&&("+"!==t.insertionType||""!==v),x=(0,l().K8)((()=>(0,us().a)()),[]),M=(0,l().K8)((()=>S&&(x&&(n&&!o().A.isMobile||s)||a)),[S,x,n,s,a]),{clearSavedSelection:A,getSavedSelection:j}=(0,er().A)({shouldPreserveTextSelection:M,shouldPreserveBlockSelection:!1,shouldRestoreSelection:M});(0,i.useEffect)((()=>{const e=et().Ay.state;if(e.open){var t;const n=T().default.state,i="editing"===n.mode?(0,Ss().H)(n.multiSelection):void 0,s=(null==i?void 0:i.store)===e.textStore,o=j().textSelectionState,a=o&&"editing"===o.mode&&(null===(t=(0,Ss().H)(o.multiSelection))||void 0===t?void 0:t.store)===e.textStore;if(!s&&!a)return void(0,et().q6)();const r=s&&(null==i?void 0:i.selection);if(h&&r&&(r.startIndex<h.filter.startIndex||r.endIndex>h.filter.endIndex))return void(0,et().q6)();const l=y&&y[0];if("+"===e.insertionType&&l&&!(0,Da().D$)(l))return void(0,et().q6)();if("@"===e.insertionType&&l&&(0,Da().Yv)(l))return void(0,et().q6)();void 0!==y||e.isEmptyPageTitle||(0,et().q6)()}}),[y,j,h]);const[w,I]=(0,i.useState)(void 0),k=La().A.getSize(),P=(0,l().K8)((()=>{if(o().A.isMobile&&0!==k)return La().A.find((e=>e.isCaptured()))}),[k]);(0,i.useEffect)((()=>{const e=null==P?void 0:P.getNode();if(e){const t=new(or().E);return t.observe(e),t.rect.addListener((e=>{I({height:`calc(100vh - ${e.state.height}px)`})})),()=>t.destroy()}}),[P]);const B=gr({usePopupOnMobile:c}),D=B?_().n.SlideUp:_().n.Popup,L=pr(e,b);return(0,g.jsx)(C().zD,{popupType:D,open:S,originRect:t.open?t.selectionRect?{...t.selectionRect,left:t.selectionRect.left-22*((0,la().A1)()?-1:1)}:t.selectionRect:void 0,slideUpWrapStyle:w,placementToOrigin:"bottom",alignmentToOrigin:"start",originGap:12,disableMouseCapture:!s,disableContentScroll:!0,onDismiss:L,disableDarkOverlayBackground:o().A.isMobile,keepFocus:!0,trapFocus:o().A.isMobile,render:()=>o().A.isMobile?(0,g.jsxs)(g.Fragment,{children:[a||n?void 0:(0,g.jsx)(vd,{query:v,queryRef:b,clearSavedSelection:A,inviteTargetsStore:u,personPropertyInviteStore:p,mentionMenuCurrentMentionStore:m,mentionMenuCurrentFormulaStore:f}),(0,g.jsx)(C().zD,{popupType:_().n.BottomSheet,render:()=>(0,g.jsx)(hr,{clearSavedSelection:A,filter:y}),open:n,keepFocus:!0,trapFocus:!0}),(0,g.jsx)(C().zD,{popupType:_().n.SlideUp,render:()=>(0,g.jsx)(Sr,{inviteTargetsStore:u,personPropertyInviteStore:p,filter:y}),open:s,keepFocus:!0,trapFocus:!1}),(0,g.jsx)(C().zD,{popupType:D,render:()=>(0,g.jsx)(Br,{mentionMenuCurrentMentionStore:m,menuPopupType:B?R().gu.ActionSheet:R().gu.Popup}),open:a,keepFocus:!0,originRect:t.open?t.selectionRect:void 0,slideUpWrapStyle:w,placementToOrigin:"bottom",alignmentToOrigin:"start",originGap:12,isFullWidthOnMobile:!0,trapFocus:!1}),(0,g.jsx)(C().zD,{keepFocus:!0,open:d,popupType:_().n.SlideUp,render:()=>(0,g.jsx)(Xa,{mentionMenuCurrentFormulaStore:f,queryRef:b}),trapFocus:!1})]}):n?(0,g.jsx)(hr,{clearSavedSelection:A,filter:y}):s?(0,g.jsx)(Sr,{inviteTargetsStore:u,personPropertyInviteStore:p,filter:y}):a?(0,g.jsx)(Br,{mentionMenuCurrentMentionStore:m,menuPopupType:R().gu.Popup}):d?(0,g.jsx)(Xa,{mentionMenuCurrentFormulaStore:f,queryRef:b}):(0,g.jsx)(vd,{query:v,queryRef:b,clearSavedSelection:A,inviteTargetsStore:u,personPropertyInviteStore:p,mentionMenuCurrentMentionStore:m,mentionMenuCurrentFormulaStore:f})})}var xd=()=>n(179895),Md=()=>n(134060),Ad=()=>n(909993);var jd=()=>n(331179),wd=()=>n(490884),Id=()=>n(209660),kd=()=>n(134837),Td=()=>n(680074),Cd=()=>n(191227);const _d={...wd().k2,csv:[...wd().k2.csv,"text/csv"]},Pd=wd().fF.filter((e=>["csv","docx","html","txt","markdown","pdf"].includes(e)));function Bd(e){return Object.keys(_d).includes(e)}function Rd(e){var t;const{type:n,environment:i}=e,s=function(e){for(const t of Object.keys(_d)){if(!Bd(t))continue;const n=_d[t];if((Array.isArray(n)?n.flat(1/0):[n]).includes(e))return t}}(n);if(!s||"string"!=typeof n||!Pd.includes(s))return;const o=(0,Td().R$)(i),a=null==o||null===(t=o.getSettings())||void 0===t?void 0:t.adoption_entry_points,r=a?null==a?void 0:a.import_nudge_on_drag:void 0;if(r&&r.length>0)return;b().default.checkGate({gateName:"contextualized_import_entrypoints"})&&((0,pe().t)({environment:i,action:"view",from:"import_nudge_on_drag"}),Ul().Iz({message:M().A.formatMessage(Dd.triggerNudgeOnDragDescription),presentationType:"transient",id:"nudge-on-drag",title:M().A.formatMessage(Dd.triggerNudgeOnDragTitle),onUserDismiss:()=>{(0,pe().t)({environment:i,action:"dismiss",from:"import_nudge_on_drag"})},onDismiss:()=>{(0,kd().p)(i,{entryPoint:"import_nudge_on_drag"})},actions:{primary:{title:M().A.formatMessage(Dd.triggerNudgeOnDragPrimaryAction),onAction:()=>{const e=Cd().A.getOrCreateFlowId();(0,pe().t)({environment:i,action:"click",from:"import_nudge_on_drag"}),oi().kY(i,{from:"import_nudge_on_drag",flowId:e}),Ul().UW("nudge-on-drag"),Id().Ow({currentTab:"imports",openedFrom:"import_nudge_on_drag",subtab:s})}}}}))}const Dd=(0,q().YK)({triggerNudgeOnDragTitle:{id:"adoption.nudgeOnDrag.title",defaultMessage:"Try importing your file"},triggerNudgeOnDragDescription:{id:"adoption.nudgeOnDrag.description",defaultMessage:"You can import this file to directly edit your content in a Notion database"},triggerNudgeOnDragPrimaryAction:{id:"adoption.nudgeOnDrag.primaryAction",defaultMessage:"Import now"}});const Ld=function(){const e=(0,r().v3)(),t=(0,i.useRef)(void 0);return(0,i.useEffect)((()=>{const i=t=>{var n;if(null!==(n=t.dataTransfer)&&void 0!==n&&n.types.includes("application/x.notion.tab-id"))return t.dataTransfer.dropEffect="move",void t.preventDefault();t.preventDefault(),function(e,t){const n=(0,jd().v)(t,{startX:e.clientX,startY:e.clientY,stores:[],isNativeDrag:!0,getGhostElement:void 0});n&&(0,Be().I)({environment:t})}(t,e),s(t)},s=St().nF((i=>{t.current&&window.clearTimeout(t.current),t.current=window.setTimeout(Od,function(e){const{device:t}=e;if(t.isLinux)return 2e3;if(t.isIOS&&b().default.checkGate({gateName:"ios_native_drag_handler_delay"}))return 1e3;return 200}(e),e),(0,n(683730).G)(e,{currentX:i.clientX,currentY:i.clientY})}),Ed),o=t=>{!function(e,t){var n;e.preventDefault();const i=Array.from((null===(n=e.dataTransfer)||void 0===n?void 0:n.files)||[]);i.length>0&&(Rd({environment:t,type:i[0].type}),function(e){const{environment:t,files:n,analyticsFrom:i}=e;if(on().Ay.state.isDragging){var s;const e=on().Ay.state.currentDropZone;let r;var o,a;e&&(r=e.type===on().OX.Selectable?nt().T.findSelectableFromStore(e.store):xd().A.findDropTargetFromKey(e.key),null===(o=r)||void 0===o||null===(o=o.props)||void 0===o||null===(a=o.onNativeDrop)||void 0===a||a.call(o,{files:n,droppedDirection:e.direction})),(0,Md().t)(t,{draggedTypes:[],from:i,asCopy:!1}),(0,Ad().P)(t,null===(s=r)||void 0===s?void 0:s.props.keepTextSelectionOnDrop)}}({environment:t,files:i,analyticsFrom:"native_drag"}))}(t,e)};return window.addEventListener("dragover",i),window.addEventListener("drop",o),()=>{window.removeEventListener("dragover",i),window.removeEventListener("drop",o)}}),[e]),null},Ed=62.5;function Od(e){Od(e)}var Nd=()=>n(86159),Fd=()=>n(211716),Ud=()=>n(35392);const zd=function(){const e=(0,l().K8)((()=>{const e=T().default.state;if("editing"!==e.mode)return null;const t=(0,Ss().H)(e.multiSelection);if(!t)return null;const{store:n,selection:i}=t;if(i.endIndex!==i.startIndex+1)return null;const s=n.getValue(),o=qs().ANx(s,i.startIndex);if(!o||!qs().rjO(o))return null;const[a]=qs().N5L([o]);return{pageId:a,store:n}}),[]),t=(0,i.useCallback)((()=>(0,g.jsx)(Kd,{pageMentionTokenStoreState:e})),[e]);if(o().A.isMobile)return null;const n=Nd().getSelectionRect();return(0,g.jsx)(Te().m,{render:()=>{},renderTooltip:t,originRect:n,forceVisibleState:Boolean(e&&n),placement:"bottom"})};function Kd({pageMentionTokenStoreState:e}){const t=(0,r().v3)(),n=(0,i.useCallback)((n=>function(e,t,n){if(!n)return;const{pageId:i,store:s}=n;if(!i)return;e.preventDefault();const o=j().B.createChildStore(s,{table:V().ev,id:i});Yr().uK({store:o,environment:t,visitType:Fd().ig.Link,openInNew:"tab",pageVisitSource:ht().y8.MentionInPage})}(n,t,e)),[t,e]),s=(0,i.useCallback)((n=>function(e,t,n){if(!n)return;const{pageId:i,store:s}=n;if(!i)return;e.preventDefault&&e.preventDefault();const o=j().B.createChildStore(s,{table:V().ev,id:i});Yr().uK({store:o,environment:t,visitType:Fd().ig.Link,pageVisitSource:ht().y8.MentionInPage})}(n,t,e)),[t,e]);return(0,g.jsx)(Pi().N,{debugName:"PageMentionOverlay",capture:!0,onEnter:s,onCommandEnter:n,children:(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(q().sA,{defaultMessage:"Open page",id:"pageMentionOverlay.openPage"}),(0,g.jsx)("div",{children:(0,g.jsx)(Ud().A,{onlyShowFirst:!0,name:"enter",style:{color:W().Tj.text.inverseSecondary}})})]})})}var Vd=()=>n(792071);function qd(){const e=(0,r().v3)(),t=(0,Fn().r)(),n=(0,s().X)("enable_space_permission_groups_listener_logging"),o=(0,i.useRef)(t);o.current=t;const a=(0,i.useCallback)((async t=>{const{idsToRefetch:i,spaceId:s}=t;if(s!==o.current)return void Bn().rateLimitedLog({from:"PermissionGroupsInSpaceListener",level:"info",type:"spaceChangedByStartOfHandleRefetch",spaceId:s,data:{miscDataToConvertToString:{userId:e.currentUser.id,groupIds:"all"===i?"all":i.size}}});n&&Bn().rateLimitedLog({from:"PermissionGroupsInSpaceListener",level:"info",type:"apiCallStarting",spaceId:s,data:{miscDataToConvertToString:{userId:e.currentUser.id,groupIds:"all"===i?"all":i.size}}});const a="all"===i?void 0:Array.from(i),r=await e.api.callCellCompatibleApi({eventName:"getAllSpacePermissionGroupsWithMemberCount",environment:e,data:{spaceId:s,groupIds:a},cellNavigation:{cellId:void 0,spaceId:s}});if(n&&Bn().rateLimitedLog({from:"PermissionGroupsInSpaceListener",level:"success"===r.type?"info":"error",type:"apiCallCompleted",spaceId:s,data:{miscDataToConvertToString:{userId:e.currentUser.id,success:"success"===r.type}}}),"failed"===r.type)return void Bn().rateLimitedLog({from:"PermissionGroupsInSpaceListener",level:"error",type:"getAllCurrentSpacePermissionGroupsFailed",spaceId:s,error:(0,Ds().convertErrorToLog)(r.error)});const l=void 0===a?new Map:new Map(Al().h.state.permissionGroupsAndMemberCounts);if(void 0!==a){const e=new Set(r.data.groupsWithMemberCount.map((e=>e.group.group_id)));for(const t of a)e.has(t)||l.delete(t)}s===o.current?(r.data.groupsWithMemberCount.forEach((e=>{const t=Vd().Bj6.fromValue("space_permission_group",e.group);l.set(t.getGroupId(),{group:t,memberCount:e.memberCount,membershipTypes:e.membershipTypes})})),Al().h.setState({...Al().h.state,permissionGroupsAndMemberCounts:l})):Bn().rateLimitedLog({from:"PermissionGroupsInSpaceListener",level:"info",type:"spaceChangedByEndOfHandleRefetch",spaceId:s,data:{miscDataToConvertToString:{userId:e.currentUser.id,groupIds:"all"===i?"all":i.size}}})}),[e,n]);return Cn({eventKey:t?(0,vt().g7)(t):void 0,spaceId:t,onRefetch:a,deferForHiddenTabs:!0}),null}var Wd=()=>n(569577),Gd=()=>n(315957),Hd=()=>n(654774);const Yd=Object.freeze({property:!0});function $d(){const e=(0,q().tz)(),t=(0,r().v3)(),n=(0,l().K8)((()=>Gd().A.state.blockStore),[]),s=(0,l().K8)((()=>null==n?void 0:n.getTitleStore()),[n]),a=(0,l().K8)((()=>(null==n?void 0:n.canEdit())??!1),[n]),d=(0,l().K8)((()=>{var t;return(null==n||null===(t=n.getModel())||void 0===t?void 0:t.getEmptyTitlePlaceholder({getRecordModel:n.getRecordModel,userTimeZone:(0,yt().P)(),intl:e}))??""}),[n,e]);if((0,i.useEffect)((()=>{const{blockStore:e}=Gd().A.state;if(!e)return;const n=e.getTitleStore();n&&(0,Hd().x)({environment:t,store:n,canSelectAllBlocks:!1})}),[t]),!n||!s)return null;let c;return c=o().A.isMobile?{menuType:R().gu.ActionSheet}:{menuType:R().gu.Popup,width:380},(0,g.jsx)(L().A,{...c,children:(0,g.jsx)("div",{style:{display:"flex",alignItems:"center",color:W().Tj.text.primary,fontSize:"13px",padding:"4px 8px"},children:(0,g.jsx)(Ee().A,{store:s,disabled:!a,onEsc:()=>Wd().V(t),onEnter:()=>Wd().V(t),onTab:()=>!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,placeholder:d,style:{display:"flex",alignItems:"center",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingInlineStart:10,paddingInlineEnd:10,width:"100%",borderRadius:4,boxShadow:W().Tj.inputBoxShadow,background:W().Tj.inputBackground,cursor:"text",position:"relative"},pasteBehavior:"inline",inPageFind:Oe().Os.none,disabledMentionTypes:Yd})})})}const Qd=function(){const e=(0,r().v3)(),{blockStore:t,originRect:n}=(0,l().K8)((()=>{const{blockStore:e,originRect:t}=Gd().A.state;return{blockStore:e,originRect:t}}),[]);return(0,g.jsx)(C().zD,{popupType:o().A.isMobile?_().n.SlideUp:_().n.Popup,open:Boolean(t),originRect:n,placementToOrigin:"bottom",alignmentToOrigin:"center",originGap:4,onDismiss:()=>Wd().V(e),render:()=>(0,g.jsx)($d,{}),trapFocus:!0})};var Zd=()=>n(359929),Xd=()=>n(477293),Jd=()=>n(718957),ec=()=>n(551541),tc=()=>n(587682),nc=()=>n(166972),ic=()=>n(77311);function sc(){const e=Nd().get(),t="empty"!==T().default.state.mode&&!(0,ic().k)(T().default.state.multiSelection);return!(!t||void 0!==e)||void 0!==e&&!e.collapsed&&t}var oc=()=>n(440375),ac=()=>n(718827),rc=()=>n(250910),lc=()=>n(713998),dc=()=>n(383567),cc=()=>n(324254),uc=()=>n(476195),pc=()=>n(703778),gc=()=>n(156425),mc=()=>n(340498);const fc={viewBox:"0 0 16 16",fittedViewBox:"4.31 3.03 7.37 9.94",svg:(0,g.jsx)("path",{d:"M5.143 3.035a.825.825 0 0 0-.825.825v8.28c0 .456.369.825.825.825H8.19c1.116 0 2.02-.241 2.645-.802.646-.578.847-1.357.847-2.093 0-.948-.436-1.733-1.117-2.245.514-.526.736-1.2.736-1.895 0-.904-.438-1.63-1.08-2.127s-1.488-.768-2.314-.768zm.825 4.14v-2.49h1.94c1.12 0 1.744.688 1.744 1.245 0 .38-.125.641-.365.83-.27.213-.789.415-1.724.415zm0 4.14v-2.49h2.561c.495 0 .87.152 1.122.38.25.23.382.54.382.865 0 .447-.117.702-.297.864-.2.179-.63.381-1.545.381z"})},hc=(0,mc().wt)("textBoldSmall",fc,"small"),yc={viewBox:"0 0 16 16",fittedViewBox:"4.49 3.23 7.02 9.54",svg:(0,g.jsx)("path",{d:"M10.88 3.235h-3.6a.625.625 0 0 0 0 1.25h.991l-1.834 7.03H5.12a.625.625 0 1 0 0 1.25h3.6a.625.625 0 0 0 0-1.25h-.99l1.833-7.03h1.317a.625.625 0 1 0 0-1.25"})},vc=(0,mc().wt)("textItalicSmall",yc,"small"),bc={viewBox:"0 0 16 16",fittedViewBox:"2.33 2.69 11.34 10.61",svg:(0,g.jsx)("path",{d:"M11.505 10.553c0-.732-.226-1.391-.74-1.928h2.275a.625.625 0 1 0 0-1.25H8.065c-.94-.201-1.516-.483-1.853-.792-.319-.293-.467-.65-.467-1.136 0-.413.192-.766.565-1.036.385-.278.968-.466 1.69-.466s1.306.188 1.691.466c.373.27.564.623.564 1.036a.625.625 0 1 0 1.25 0c0-.863-.426-1.574-1.081-2.048-.644-.466-1.5-.704-2.424-.704s-1.78.238-2.423.704c-.656.474-1.082 1.185-1.082 2.048 0 .732.226 1.391.74 1.928H2.96a.625.625 0 0 0 0 1.25h4.975c.94.201 1.517.483 1.853.792.319.293.467.65.467 1.136 0 .413-.191.766-.564 1.036-.386.278-.969.466-1.691.466s-1.306-.187-1.69-.466c-.374-.27-.565-.623-.565-1.036a.625.625 0 0 0-1.25 0c0 .863.426 1.574 1.081 2.048.644.466 1.5.704 2.424.704s1.78-.238 2.424-.704c.655-.474 1.08-1.185 1.08-2.048"})},Sc=(0,mc().wt)("textStrikethroughSmall",bc,"small"),xc={viewBox:"0 0 16 16",fittedViewBox:"2.33 3.23 11.33 11.51",svg:(0,g.jsx)("path",{d:"M3.68 3.235a.625.625 0 1 0 0 1.25h.455v4.307c0 .955.294 1.908.952 2.63.667.73 1.654 1.163 2.913 1.163 2.23 0 3.865-1.793 3.865-3.793V4.485h.455a.625.625 0 1 0 0-1.25h-2.16a.625.625 0 1 0 0 1.25h.455v4.307c0 1.327-1.093 2.543-2.615 2.543-.958 0-1.59-.32-1.99-.756-.407-.447-.625-1.079-.625-1.787V4.485h.455a.625.625 0 0 0 0-1.25zm-.72 10.26a.625.625 0 1 0 0 1.25h10.08a.625.625 0 0 0 0-1.25z"})},Mc=(0,mc().wt)("textUnderlineSmall",xc,"small");var Ac=()=>n(37165),jc=()=>n(743246),wc=()=>n(175947),Ic=()=>n(843005),kc=()=>n(21869),Tc=()=>n(332751);function Cc(e){const{clientSkill:t}=e,n=(0,q().tz)().formatMessage(t.displayName);return(0,g.jsx)(g.Fragment,{children:n})}var _c=()=>n(383070),Pc=()=>n(715142),Bc=()=>n(602098),Rc=()=>n(929345),Dc=()=>n(302655);function Lc(e){if(e.inMemoryRecordCache.isMockTextStore){const t=(0,A().zH)(e);if(t.table===V().ev){if("automation_id"in t.getProperties())return!0}}return Boolean(e.findRecordStoreUIAncestor((e=>e instanceof Rc().b||e instanceof Dc().d)).ancestor)}var Ec=()=>n(262559),Oc=()=>n(560595),Nc=()=>n(68465),Fc=()=>n(471083),Uc=()=>n(478726),zc=()=>n(747100),Kc=()=>n(38554),Vc=()=>n(441199),qc=()=>n(77246),Wc=()=>n(807926),Gc=()=>n(711319),Hc=()=>n(285288),Yc=()=>n(270710),$c=()=>n(170722),Qc=()=>n(369241),Zc=()=>n(459572),Xc=()=>n(213799),Jc=()=>n(720263),eu=()=>n(496889);function tu({targetBlockStore:e,experimentGroup:t,disabled:n,dimensionStyles:i}){const s=(0,r().v3)(),o=n||!e;return(0,g.jsx)(eu().A,{store:e,style:{borderRadius:6,padding:6,width:28,height:28,...i},iconStyle:{fill:W().Tj.icon.primary},fadeIn:!1,onClick:()=>{(0,kc().s)(s,{action:"more"})},disabled:o,experimentGroup:t})}var nu=()=>n(746630);function iu({targetBlockStore:e,iconOnly:t,style:n}){return(0,g.jsx)(nu().A,{style:{borderRadius:6,color:W().Tj.icon.primary,fill:W().Tj.icon.primary,height:28,width:t?28:void 0,...n},iconOnly:t,blockStore:e})}var su=()=>n(209416),ou=()=>n(473227);function au(e){const t=(0,r().v3)(),n=(0,l().K8)((()=>"suggest"===qc().Uv.getMode(e.blockStore)),[e.blockStore]),s=()=>{const i=e.blockStore.getRecordStoreUIRoot();i&&i instanceof j().B&&i.isNavigableBlock()&&ou().PD({environment:t,navigableBlockStore:i,mode:n?"default":"suggest",location:"rich_text_menu"})},a=(0,x().IS)((()=>({button:{display:"flex",alignItems:"center",padding:e.iconOnly?6:"0 6px",whiteSpace:"nowrap",gap:4,color:n?W().Tj.blue.icon.accentPrimary:W().Tj.icon.primary,...e.style},keyboardShortcut:{color:W().Tj.text.inverseSecondary}})),[n,e.iconOnly,e.style]);return(0,g.jsx)(Te().m,{renderTooltip:()=>(0,g.jsxs)(i.Fragment,{children:[(0,g.jsx)("div",{children:n?(0,g.jsx)(q().sA,{defaultMessage:"Turn off suggesting",id:"inlineSuggestButton.tooltipDisable"}):(0,g.jsx)(q().sA,{defaultMessage:"Suggest edits",id:"inlineSuggestButton.tooltipEnable"})}),(0,g.jsx)("div",{children:(0,g.jsx)(Ud().A,{style:a.keyboardShortcut,name:"suggest"})})]}),render:t=>(0,g.jsxs)(ac().Ay,{style:a.button,disabled:e.disabled,disabledFeedback:e.disabled,onClick:s,...t,children:[(0,g.jsx)(Qi().I,{icon:su().a}),o().A.isMobile||e.iconOnly?void 0:n?(0,g.jsx)(q().sA,{defaultMessage:"Suggesting",id:"inlineSuggestButton.suggestingLabel"}):(0,g.jsx)(q().sA,{defaultMessage:"Suggest",id:"inlineSuggestButton.suggestLabel"})]})})}function ru({targetBlockStore:e,iconOnly:t,style:n}){return(0,g.jsx)(au,{style:{borderRadius:6,height:28,...n},iconOnly:t,blockStore:e})}var lu=()=>n(236228),du=()=>n(777849),cu=()=>n(780243);const uu={[F().xd.button]:new Set(["showActionButton","showCompletions","showDiscuss","showReact","showSuggest","showTurnInto"]),[F().xd.code]:new Set(["showCode","showCompletions"]),[F().xd.table]:new Set(["showTurnInto","showActionButton","showCompletions"]),[F().xd.tableRow]:new Set(["showTurnInto","showActionButton","showCompletions"]),[F().xd.aiBlock]:new Set(["showTurnInto","showActionButton","showCompletions","showSuggest","showDiscuss","showReact"])},pu={[F().xd.factory]:!0},gu=36;const mu=function(){const e=(0,mr().S)(),t=(0,r().v3)(),n=(0,l().O$)($c().A),s=(0,l().O$)(T().default),{isActive:a,blockTarget:d,isAnimatingClosed:c}=n,u=(0,l().O$)(v().AppStoreMainEditorCurrentBlockStore),p=(0,l().K8)((()=>_c().zD.isRichTextMenuSuggestionEnabled()),[]),m=(0,l().K8)((()=>{var e;return"slack_notification"===(null===(e=Vr().A.getState().automationActionStore)||void 0===e?void 0:e.getType())}),[]),[f,h]=(0,i.useState)(void 0),S=(0,i.useCallback)((()=>{var e;if(!p||!u)return;const t=(0,os().filterAndRankAssistantSurfaceActionsForContext)((0,os().clientSkillToAssistantSurfaceAction)((0,as().getAllClientSkills)({currentPageRecordPointer:void 0,currentCollectionRecordPointer:void 0})),{type:"entrypoint",entrypoint:"richTextMenu",pageStore:u,selectionState:it().default.state,textSelectionState:T().default.state,isMobile:o().A.isMobile,userSettings:null===(e=v().default.state.currentUserSettingsStore)||void 0===e?void 0:e.getSettings()}).at(0);return t?{...t,isSuggested:!0}:void 0}),[p,u]),x=(0,l().K8)((()=>{const t=d,n=T().default.state;if(!a||"empty"===n.mode)return;const{multiSelection:i}=n,s=(0,k().K)(i);if(s){if(i.start.index+1===i.end.index){const e=(0,qs().ANx)(i.start.store.getValue(),i.start.index);if(e&&(0,qs().B8H)(e))return}if((0,ic().k)(i))return}const o=(0,Jd().$W)(i),r=o.map((({editable:e})=>e.getContextClosestSelectableStore())),l=T().default.isEditingComment(),c=T().default.isEditingFormQuestion(),u=t&&"form"===t.getType(),p=c||u,g=T().default.isEditingCaption(),h=t&&t.getParentTable()===Bl().Vl,y=s&&t&&i.start.store===t.getCollectionViewSourceDescriptionStore(),v=zc().Gb(),S=null==e?void 0:e.publicEditModeStore.state,x=!(0,zl().QT)(S)&&(i.start.store.canEdit()&&i.end.store.canEdit()),M=t&&"suggest"===qc().Uv.getMode(t),A=b().default.checkGate({gateName:"block_reactions"}),j=r.some(((e,t)=>{const n=o[t].store.table===go().SN&&!o[t].editable.props.disabled;return!!e&&(e.isLocked()||e.isNavigableAncestorLocked())&&!n})),w=x&&!j&&!o.some((e=>e.editable.props.disableFormattingAnnotations)),I=t&&t.getType(),C=I&&uu[I],_=null==t?void 0:t.isType("button"),P=(0,Bc().u)(i.start.store)||(0,Bc().u)(i.end.store),B=Lc(i.start.store)||Lc(i.end.store),R=null==t?void 0:t.getNavigableBlockStore(),D=(null==R?void 0:R.getParentTable())===jc().C0;let L=!1;const E=We().A.state.isOpen?We().A.state:Ge().A.state.isOpen?Ge().A.state:void 0;if(E){const e=E.store.getParentStore();if((null==e?void 0:e.table)===Bl().Vl){const t=e.getSchema(),n=E.property,i=(0,lc()._g)({schema:t,property:n});"text"!==(null==i?void 0:i.type)||i.ai_inference||(L=!0)}}const O=(0,U().SF)(null==t?void 0:t.getSystemBlockTypeStore().getValue()),N={isSingleStoreSelection:s,showTurnInto:Boolean(s&&!l&&!h&&!y&&!g&&t&&w&&!_&&!M&&!p&&(P||!B)),showBold:Boolean(w),showItalic:Boolean(w),showStrikethrough:Boolean(w),showUnderline:Boolean(w)&&!m,showCode:Boolean(w)&&!m,showLink:Boolean(s&&w),showHighlight:Boolean(w)&&!m,showDiscuss:Boolean(!l&&t&&O&&(L||!h)&&!y&&!p&&!B&&!D),showReact:Boolean(A&&!l&&t&&!h&&!y&&!B&&!p&&!D),showSuggest:Boolean(!l&&t&&!o.some((e=>e.editable.props.disableSuggestEdit))&&!h&&!y&&!B&&!v&&!j&&!p&&!D),showEquation:Boolean(s&&w&&!M&&!p&&!m),showActionButton:Boolean(s&&!l&&!g&&t&&!h&&!p&&!o.some((e=>e.editable.props.disableRichTextActions))&&(P||!B)),targetBlockStore:t,isComment:l,showCompletions:Boolean((0,Nc().ZE)(S,t)&&w&&!l&&!g&&t&&!h&&!y&&!_&&!B&&!M&&!p),topRankedSkill:f};if(C&&C.size>0)for(const e of C)N[e]=!1;return N}),[d,a,null==e?void 0:e.publicEditModeStore,f,m]),[M,w]=(0,i.useState)(x);(0,i.useEffect)((()=>{x&&w(x)}),[x]);const I=x&&x.showDiscuss&&!x.showBold,C=function(e){const t=(0,r().v3)(),n=(0,r().Y0)(),i=(0,l().K8)((()=>t.WindowSizeStore.state.height),[t.WindowSizeStore]);return(0,l().K8)((()=>{if("empty"===e.mode)return;const t=Nd().get();if(!t)return;if(t.collapsed)return;const s=Nd().getRect(t);if(!s)return;let o=0;o=(0,la().A1)()?(0,ec().A)().width-s.right:s.left;const a=s.top-gu-25,r=wc().ek(n.isElectronMac),l=i-gu-25;return{top:Math.min(Math.max(a,r),l),left:o}}),[i,n.isElectronMac,e])}(s),_=(0,i.useRef)(!1);(0,i.useEffect)((()=>{a?C&&!_.current&&((0,y().u)({environment:t,event:{eventName:"text_selection_menu_shown",eventProperties:{}}}),_.current=!0):_.current=!1}),[a,C,t]);const P=(0,i.useCallback)((()=>{var e;if(Gc().A.state.open||Qc().A.state.open)return;if(oc().l.state)return Tc().I();const i=T().default.state;if("empty"===i.mode)return Tc().I();const s=(0,Jd().$W)(i.multiSelection);if(0===s.length)return Tc().I();if(!s.every((({store:e})=>e.table===V().ev||e.table===go().SN||e.table===Bl().Vl||e.table===Ac().lo)))return Tc().I();if(!t.currentUser.isLoggedIn()||!s.every((({store:e})=>e.canComment())))return;const o=Nd().get();if((0,Oc().f)())return Tc().I();if(s.some((({editable:e})=>e.props.disableStyleAnnotations)))return Tc().I();if(s.some((({editable:e})=>e.props.disableRichTextActions)))return Tc().I();const a=s.map((({editable:e})=>e.getContextClosestSelectableStore()));if(a.some((e=>e&&e.pathIsDead())))return Tc().I();if(a.some((e=>e&&(0,Pc().dL)(e))))return Tc().I();if(a.some(((e,t)=>{const n=s[t].store.canComment(),i=s[t].store.table===go().SN&&s[t].editable.props.disabled;return!!e&&(e.isLocked()||e.isNavigableAncestorLocked())&&!n||i})))return Tc().I();const r=s.some((({store:e})=>{const t=(0,A().zH)(e);if(!(t instanceof j().B))return!1;const n=t.getValue();return!!n&&pu[n.type]}));if(r)return Tc().I();const l=o?Nd().getRect(o):void 0;return l&&!tc().HY(l,(0,ec().A)())||Yc().A.isActive()||Gd().A.isActive()||ja().A.isOpen()||r||Vc().default.isPeekDismissableState()||!o||!sc()||Wc().A.state.open||"assistantCompletionPopup"===ms().default.state.type?Tc().I():(h(S()),void $c().A.setState({...n,isActive:!0,isAnimatingClosed:!1,blockTarget:it().default.state.stores[0],context:null===(e=s[0])||void 0===e?void 0:e.editable.richTextContext}))}),[t.currentUser,n,h,S]),B=(0,i.useMemo)((()=>St().nF(P,200,{leading:!1})),[P]);(0,i.useEffect)((()=>(it().default.addListener(B),T().default.addListener(B),nc().A.addListener(P),Hc().A.addListener(P),Zc().A.addListener(P),Vc().default.addListener(P),()=>{T().default.removeListener(B),it().default.removeListener(B),nc().A.removeListener(P),Hc().A.removeListener(P),Zc().A.removeListener(P),Vc().default.removeListener(P)})),[P,B]);const R=(0,l().K8)((()=>function(e){const t=null==e?void 0:e.getParentStore();if((null==t?void 0:t.table)===V().ev)return!!t&&(0,Uc().fc)(t);return!1}(d)),[d]),D=(0,i.useCallback)((()=>{n.isActive||$c().A.setState({...n,isAnimatingClosed:!1}),w(x)}),[n,x]);return C?(0,g.jsx)(an().O,{open:a||c,children:(0,g.jsx)(hu,{handleAnimationEnd:D,isActive:a,isExternallyImportedAndSyncedCollectionPageBlockTarget:R,lastRenderState:M,richTextMenuStoreState:n,canOnlyDiscuss:I,top:C.top,left:C.left})}):null},fu=i.forwardRef((function({lastRenderState:e,richTextMenuStoreState:t,canOnlyDiscuss:n,style:i,top:s,left:o},a){const r=Math.max(n?o:o-60,0),l=n?"12px 0":12;return(0,g.jsxs)("div",{className:I().Vl,style:{pointerEvents:"none",position:"absolute",top:s,insetInlineStart:0,display:"flex",width:"100%",...i},ref:a,children:[(0,g.jsx)("div",{style:{flexShrink:1,width:r,minWidth:24}}),(0,vo().A)((t=>(0,g.jsx)("div",{style:{pointerEvents:"none",padding:l},...t,children:e?(0,g.jsx)(Cu,{renderState:e}):void 0}))),(0,g.jsx)("div",{style:{flexGrow:1,flexShrink:1,minWidth:36}})]})}));function hu({handleAnimationEnd:e,isActive:t,isExternallyImportedAndSyncedCollectionPageBlockTarget:n,lastRenderState:i,richTextMenuStoreState:s,canOnlyDiscuss:o,top:a,left:r}){return(0,g.jsx)(Js().A,{tag:fu,visible:t&&!n,initial:{opacity:0,scale:.98},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.98},onAnimationEnd:e,config:{duration:120},lastRenderState:i,richTextMenuStoreState:s,canOnlyDiscuss:o,top:a,left:r})}function yu({styles:e}){return(0,g.jsx)("div",{style:{height:24,width:1,borderInlineEnd:`1px solid ${W().Tj.border.secondaryTranslucent}`,margin:"auto 6px",...e}})}function vu({blockStore:e}){const t=(0,r().v3)(),n=(0,q().tz)();let i=(0,g.jsx)(q().sA,{defaultMessage:"Turn into",id:"richTextMenu.turnIntoButton.label"});const s=(0,mr().S)(),o=(0,l().K8)((()=>e.getType()),[e]);if(o){const e=Fc().ry[o];i=e&&e.displayName||i}return(0,g.jsx)(rc().A,{popupType:rc().z.Popup,buttonPopupStore:Qc().A,originGap:4,renderOrigin:e=>(0,g.jsx)(Te().m,{renderTooltip:()=>n.formatMessage({defaultMessage:"Turn into",id:"richTextMenu.turnIntoButton.tooltip"}),render:t=>(0,g.jsxs)(ac().Ay,{style:{display:"flex",alignItems:"center",paddingInlineStart:7,paddingInlineEnd:6,gap:6,whiteSpace:"nowrap",color:W().Tj.icon.primary,borderRadius:6},...(0,da().A)(e,t),children:[i,(0,g.jsx)(Qi().I,{icon:cc().arrowChevronSingleDownSmallIcon,size:"xs",colorVariant:"tertiary",fitToViewBox:"horizontal"})]})}),render:()=>(0,g.jsx)(L().A,{menuType:R().gu.Popup,children:(0,g.jsx)(Xe().A,{context:{blocks:[e],environment:t,publicEditMode:void 0,analyticsFrom:"rich_text_menu",pageContext:s},sections:[Ic().t3],onAccept:n=>{const i=e.getType(),s=e.getFormat();Tc().I(),(0,Je().N)(t,{analyticsName:n.analyticsName,action_type:n.analyticsActionType,from:"rich_text_menu",block_id:e.id,block_type:i,is_toggleable:i?(0,F().Yt)(i,s):void 0,parent_collection_id:e.getParentCollectionIdUpToTwoLevels()})}})}),onClick:()=>{(0,kc().s)(t,{action:"turn_into"})}})}function bu(){return(0,g.jsx)(lu().A,{type:"b",tooltipLabel:(0,g.jsxs)(i.Fragment,{children:[(0,g.jsx)("div",{children:(0,g.jsx)(q().sA,{defaultMessage:"Bold",id:"richTextMenu.boldButton.tooltip"})}),(0,g.jsx)("div",{children:(0,g.jsx)(Ud().A,{style:{color:W().Tj.text.inverseSecondary},name:"toggleBold"})})]}),children:(0,g.jsx)(Qi().I,{icon:hc,size:"sm"})})}function Su(){return(0,g.jsx)(lu().A,{type:"i",tooltipLabel:(0,g.jsxs)(i.Fragment,{children:[(0,g.jsx)("div",{children:(0,g.jsx)(q().sA,{defaultMessage:"Italicize",id:"richTextMenu.italicsButton.tooltip"})}),(0,g.jsx)("div",{children:(0,g.jsx)(Ud().A,{style:{color:W().Tj.text.inverseSecondary},name:"toggleItalics"})})]}),children:(0,g.jsx)(Qi().I,{icon:vc,size:"sm"})})}function xu(){return(0,g.jsx)(lu().A,{type:"s",tooltipLabel:(0,g.jsxs)(i.Fragment,{children:[(0,g.jsx)("div",{children:(0,g.jsx)(q().sA,{defaultMessage:"Strike-through",id:"richTextMenu.strikeThroughButton.tooltip"})}),(0,g.jsx)("div",{children:(0,g.jsx)(Ud().A,{style:{color:W().Tj.text.inverseSecondary},name:"toggleStrike"})})]}),children:(0,g.jsx)(Qi().I,{icon:Sc,size:"sm"})})}function Mu(){return(0,g.jsx)(lu().A,{type:"_",tooltipLabel:(0,g.jsxs)(i.Fragment,{children:[(0,g.jsx)("div",{children:(0,g.jsx)(q().sA,{defaultMessage:"Underline",id:"richTextMenu.underlineButton.tooltip"})}),(0,g.jsx)("div",{children:(0,g.jsx)(Ud().A,{style:{color:W().Tj.text.inverseSecondary},name:"toggleUnderline"})})]}),children:(0,g.jsx)(Qi().I,{icon:Mc,size:"sm"})})}function Au(){return(0,g.jsx)(lu().A,{type:"c",tooltipLabel:(0,g.jsxs)(i.Fragment,{children:[(0,g.jsx)("div",{children:(0,g.jsx)(q().sA,{defaultMessage:"Mark as code",id:"richTextMenu.markAsCodeButton.tooltip"})}),(0,g.jsx)("div",{children:(0,g.jsx)(Ud().A,{style:{color:W().Tj.text.inverseSecondary},name:"toggleCode"})})]}),children:(0,g.jsx)(Qi().I,{icon:uc().codeSmallIcon,size:"sm"})})}function ju({}){return(0,g.jsx)(cu().A,{children:(0,g.jsxs)("div",{style:{display:"flex",gap:6,alignItems:"center"},children:[(0,g.jsx)(Qi().I,{icon:pc().linkSmallIcon,size:"sm",fitToViewBox:"horizontal"}),(0,g.jsx)(Qi().I,{icon:cc().arrowChevronSingleDownSmallIcon,size:"xs",colorVariant:"tertiary",fitToViewBox:"horizontal"})]})})}function wu({intl:e,topRankedSkill:t}){const n=(0,x().eP)(),i=(0,r().v3)(),a=(0,s().X)("agent_writer"),d=(0,l().K8)((()=>_c().zD.isXMLAssistantEnabled()),[]);return(0,g.jsxs)(g.Fragment,{children:[t?(0,g.jsxs)(ac().Ay,{style:{display:"flex",alignItems:"center",padding:"0 8px",whiteSpace:"nowrap",borderRadius:6},onClick:()=>{a?(0,Zi().R)(t.skillType)?(0,is().toggleInitialPrompt)({environment:i,from:"rich_text_menu",agentPrebuiltPromptType:t.skillType}):(0,is().toggleInitialPrompt)({environment:i,from:"rich_text_menu"}):(0,ts().Nj)({environment:i,clientSkillWithParameterValues:(0,as().dangerouslyCreateClientSkillWithParameterValues)(t),from:"rich_text_menu",assistantSurfaceType:o().A.isMobile?"mobileWriter":"writer"}),(0,kc().s)(i,{action:"completions"})},children:[t.icon({width:16,height:16,marginInlineEnd:6,fill:(0,rs().vJ)(t.category).color(n).color}),(0,g.jsx)("span",{children:(0,g.jsx)(Cc,{clientSkill:t})})]}):void 0,(0,g.jsx)(Te().m,{renderTooltip:()=>(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("div",{children:d?e.formatMessage({defaultMessage:"Make edits, find answers, and more",id:"richTextMenu.assist.assistantTooltip"}):e.formatMessage({defaultMessage:"Ask AI to help edit, review, or generate text.",id:"richTextMenu.assist.tooltip"})}),(0,g.jsx)("div",{children:(0,g.jsx)(Ud().A,{style:{color:W().Tj.text.inverseSecondary},name:"commandJ"})})]}),render:e=>(0,g.jsxs)(ac().Ay,{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"0 6px",whiteSpace:"nowrap",borderRadius:6,height:28},...e,onClick:()=>{(0,is().toggleInitialPrompt)({from:"rich_text_menu",environment:i}),(0,kc().s)(i,{action:"completions"})},children:[(0,g.jsx)(ss().Su,{}),(0,g.jsx)("span",{style:{marginInlineStart:6,marginInlineEnd:2},children:(0,g.jsx)(q().sA,{defaultMessage:"Ask AI",id:"richTextMenu.assistButton.label"})})]})})]})}function Iu(){const e=(0,r().v3)(),t=(0,Kc().U)(),n=(0,l().O$)(T().default),s=(0,i.useMemo)((()=>{if(!t)return;if("editing"!==n.mode)return;if((0,ic().k)(n.multiSelection))return;return n.multiSelection.start.store.pointer.table===V().ev&&n.multiSelection.end.store.pointer.table===V().ev?n.multiSelection:void 0}),[t,n]),o=void 0!==s;return t?(0,g.jsxs)(ac().Ay,{style:{display:"flex",alignItems:"center",padding:"0 8px",whiteSpace:"nowrap",borderRadius:6,height:28,gap:6},disabled:!o,onClick:()=>{s&&((0,Ec().L)({environment:e,textSelection:s,chatPanelStore:(0,us().a)(),source:"rich_text_menu"}),(0,kc().s)(e,{action:"add_to_chat"}))},children:[(0,g.jsx)(Qi().I,{icon:dc().F,size:"sm"}),(0,g.jsx)("span",{children:(0,g.jsx)(q().sA,{defaultMessage:"Add to chat",id:"richTextMenu.addToChat.label"})})]}):null}function ku(){const e=(0,r().v3)();return(0,g.jsx)(du().A,{onClick:()=>{(0,kc().s)(e,{action:"e"}),Tc().I()},children:(0,g.jsx)(Qi().I,{icon:gc().M,size:"sm"})})}function Tu({targetBlockStore:e,iconOnly:t}){const n=(0,q().tz)();return(0,g.jsx)(Jc().A,{style:{borderRadius:6,color:W().Tj.icon.primary,fill:W().Tj.icon.primary,height:28},iconOnly:t,blockStore:e,ariaLabel:n.formatMessage({id:"richTextMenu.Discussions.OpenDiscussionButton",defaultMessage:"Write a comment"})})}function Cu({renderState:e}){const t=(0,q().tz)(),n=(0,l().K8)((()=>$c().A.state.isActive),[]),i=(0,Kc().U)(),s=e.showDiscuss||e.showReact||e.showSuggest,o=e.showBold||e.showItalic||e.showUnderline||e.showStrikethrough||e.showCode||e.showEquation||e.showHighlight,a=o;return(0,g.jsxs)("div",{style:{display:"inline-flex",alignItems:"stretch",height:gu,background:W().Tj.popoverBackground,overflow:"hidden",fontSize:14,lineHeight:1.2,borderRadius:8,boxShadow:W().Tj.shadowMD,pointerEvents:n?"auto":"none",padding:"4px"},onMouseDown:e=>e.preventDefault(),children:[e.showCompletions?(0,g.jsxs)(g.Fragment,{children:[i?(0,g.jsx)(Iu,{}):void 0,(0,g.jsx)(wu,{intl:t,topRankedSkill:i?void 0:e.topRankedSkill}),(0,g.jsx)(yu,{})]}):void 0,s&&e.targetBlockStore?(0,g.jsxs)(g.Fragment,{children:[e.showDiscuss?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(Tu,{targetBlockStore:e.targetBlockStore,iconOnly:!1}),a||!e.showReact&&!e.showSuggest?void 0:(0,g.jsx)(yu,{})]}):void 0,e.showReact?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(iu,{targetBlockStore:e.targetBlockStore,iconOnly:a}),!a&&e.showSuggest?(0,g.jsx)(yu,{}):void 0]}):void 0,e.showSuggest?(0,g.jsx)(ru,{targetBlockStore:e.targetBlockStore,iconOnly:a}):void 0,o?(0,g.jsx)(yu,{}):void 0]}):void 0,o?(0,g.jsxs)(g.Fragment,{children:[e.showTurnInto&&e.targetBlockStore?(0,g.jsx)(vu,{blockStore:e.targetBlockStore}):void 0,(0,g.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[e.showBold?(0,g.jsx)(bu,{}):void 0,e.showItalic?(0,g.jsx)(Su,{}):void 0,e.showUnderline?(0,g.jsx)(Mu,{}):void 0,e.showStrikethrough?(0,g.jsx)(xu,{}):void 0,e.showCode?(0,g.jsx)(Au,{}):void 0,e.showEquation?(0,g.jsx)(ku,{}):void 0]}),e.showLink?(0,g.jsx)(ju,{}):void 0,e.showHighlight?(0,g.jsx)(Xc().A,{blockStore:e.targetBlockStore,updatedColorPickerIconStyles:{width:20,height:20,fontSize:12}}):void 0]}):void 0,e.showActionButton&&e.targetBlockStore?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(yu,{}),(0,g.jsx)(tu,{targetBlockStore:e.targetBlockStore})]}):void 0]})}var _u=()=>n(859002),Pu=()=>n(481721),Bu=()=>n(742852),Ru=()=>n(724925),Du=()=>n(967919);const Lu={viewBox:"0 0 20 20",fittedViewBox:"5.55 3.95 8.9 12.11",svg:(0,g.jsx)("path",{d:"M6.428 3.95a.875.875 0 0 0-.875.875v10.35c0 .483.392.875.875.875h3.81c1.377 0 2.461-.298 3.203-.963.763-.682 1.006-1.607 1.006-2.5 0-1.199-.582-2.18-1.483-2.788.704-.64 1.007-1.494 1.007-2.386 0-2.145-2.08-3.463-4.086-3.463zm.875 6.925h3.359c1.303 0 2.035.805 2.035 1.713 0 .586-.153.954-.423 1.196-.29.26-.873.516-2.036.516H7.303zm2.165-1.75H7.303V5.7h2.582c1.452 0 2.336.9 2.336 1.713 0 .515-.172.89-.516 1.16-.373.294-1.057.55-2.237.552"})},Eu=(0,mc().wt)("textBold",Lu,"default"),Ou={viewBox:"0 0 20 20",fittedViewBox:"5.77 4.2 8.45 11.6",svg:(0,g.jsx)("path",{d:"m10.541 5.45-2.374 9.1H6.4a.625.625 0 1 0 0 1.25h4.5a.625.625 0 1 0 0-1.25H9.46l2.374-9.1H13.6a.625.625 0 1 0 0-1.25H9.1a.625.625 0 1 0 0 1.25z"})},Nu=(0,mc().wt)("textItalic",Ou,"default");var Fu=()=>n(372604);const Uu={viewBox:"0 0 20 20",fittedViewBox:"3.07 3.52 13.86 12.96",svg:(0,g.jsx)("path",{d:"M10.065 9.373H16.3a.627.627 0 1 1 0 1.255h-3.233q.063.052.122.107c.723.665 1.038 1.505 1.038 2.456 0 1.024-.503 1.868-1.288 2.436-.772.56-1.81.85-2.939.85s-2.167-.29-2.94-.85c-.784-.568-1.288-1.412-1.288-2.436a.628.628 0 0 1 1.255 0c0 .571.268 1.057.77 1.42.513.37 1.276.611 2.203.611.928 0 1.69-.24 2.204-.611.5-.363.768-.849.768-1.42 0-.645-.199-1.134-.632-1.532-.452-.416-1.207-.777-2.405-1.032H3.7a.627.627 0 1 1 0-1.254h3.233l-.122-.108C6.088 8.6 5.773 7.76 5.773 6.81c0-1.024.503-1.868 1.288-2.436.772-.56 1.81-.85 2.94-.85s2.166.29 2.938.85c.785.568 1.289 1.412 1.289 2.436a.628.628 0 0 1-1.255 0c0-.571-.268-1.057-.77-1.42-.513-.37-1.275-.611-2.203-.611s-1.69.24-2.203.612c-.502.362-.77.848-.77 1.42 0 .644.2 1.133.633 1.531.452.416 1.207.777 2.405 1.032"})},zu=(0,mc().wt)("textStrikethrough",Uu,"default"),Ku={viewBox:"0 0 20 20",fittedViewBox:"3.07 4.2 13.86 14.08",svg:(0,g.jsx)("path",{d:"M15.4 5.45a.625.625 0 1 0 0-1.25h-2.7a.625.625 0 1 0 0 1.25h.725v5.54c0 1.743-1.434 3.335-3.425 3.335-1.235 0-2.07-.414-2.602-.996-.541-.594-.823-1.423-.823-2.339V5.45H7.3a.625.625 0 0 0 0-1.25H4.6a.625.625 0 1 0 0 1.25h.725v5.54c0 1.163.358 2.314 1.15 3.181.8.877 1.99 1.404 3.525 1.404 2.699 0 4.675-2.17 4.675-4.585V5.45zm1.525 12.2c0 .345-.28.625-.625.625H3.7a.625.625 0 1 1 0-1.25h12.6c.345 0 .625.28.625.625"})},Vu=(0,mc().wt)("textUnderline",Ku,"default");var qu=()=>n(118307);const Wu=220;function Gu({targetBlockStore:e,disabled:t,experimentGroup:n}){const i=(0,l().uB)(void 0,qu().A),s=(0,q().tz)(),o=s.formatMessage({defaultMessage:"More actions",id:"blockOverflowMenuButton.moreActions.tooltip"});return(0,g.jsx)(rc().A,{popupType:rc().z.Popup,popupWrapStyle:{width:Wu},buttonPopupStore:i,originGap:4,disabled:t,renderOrigin:e=>(0,g.jsx)(Te().m,{renderTooltip:()=>o,delayThreshold:300,render:n=>(0,g.jsx)(ac().Ay,{style:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:32,borderRadius:6},ariaLabel:o,disabled:t,disabledFeedback:t,...(0,da().A)(n,e),children:(0,g.jsx)(Qi().I,{icon:Lr().ellipsisIcon,colorVariant:"primary"})})}),render:()=>e?(0,g.jsx)(L().A,{menuType:R().gu.Popup,children:(0,g.jsx)(O().A,{type:O().O.Vertical,initialFocus:void 0,style:{display:"flex",flexDirection:"column",gap:4,padding:"4px 0px"},sections:[..."vertical"===n?[{key:"actions",render:e=>(0,g.jsx)(N().A,{...e}),items:[{key:"reactions",render:t=>{const{ref:n,...i}=t;return(0,g.jsx)(nu().A,{style:{borderRadius:6,height:28,justifyContent:"flex-start",fontSize:14},...i,blockStore:e,iconOnly:!1})},action:()=>{}},{key:"suggest",render:t=>{const{ref:n,...i}=t;return(0,g.jsx)(au,{style:{borderRadius:6,height:28,fontSize:14,marginBottom:-4},...i,blockStore:e,iconOnly:!1})},action:()=>{}}]}]:[],{key:"overflow_actions",render:e=>(0,g.jsx)(N().A,{...e,topBorder:"vertical"===n}),items:[{key:"action",render:t=>{const{ref:n,...i}=t;return(0,g.jsx)(eu().A,{store:e,style:{borderRadius:6,display:"flex",alignItems:"center",height:28,width:"100%",padding:"0px 6px"},iconStyle:{fill:W().Tj.icon.primary},fadeIn:!1,...i,onClick:()=>{},label:s.formatMessage({defaultMessage:"Block Options",id:"blockOverflowMenuButton.blockOptions.label"})})},action:()=>{}}]}]})}):void 0})}function Hu(){return(0,g.jsx)("div",{style:{height:1,marginInline:8,background:W().Tj.border.secondaryTranslucent,marginTop:4,marginBottom:4}})}const Yu={[F().xd.button]:new Set(["showActionButton","showCompletions","showDiscuss","showReact","showSuggest","showTurnInto"]),[F().xd.code]:new Set(["showCode","showCompletions"]),[F().xd.table]:new Set(["showTurnInto","showActionButton","showCompletions"]),[F().xd.tableRow]:new Set(["showTurnInto","showActionButton","showCompletions"]),[F().xd.aiBlock]:new Set(["showTurnInto","showActionButton","showCompletions","showSuggest","showDiscuss","showReact"])},$u={[F().xd.factory]:!0},Qu=192,Zu=338,Xu=60,Ju=8,ep=16;function tp({isActive:e=!0}){const t=(0,r().v3)(),n=function(e){const t=(0,r().v3)();if((0,l().K8)((()=>({width:t.WindowSizeStore.state.width,height:t.WindowSizeStore.state.height})),[t.WindowSizeStore]),!e)return null;const n=document.querySelector(`.${I().GSK}`);return n instanceof HTMLElement?n.getBoundingClientRect().left:null}(e);(0,l().K8)((()=>t.WindowSizeStore.state.width),[t.WindowSizeStore]);const i=(0,l().K8)((()=>(0,ki().kf)(t)),[t]),s=(0,l().K8)((()=>zc().Gb()),[]);if(!e)return{canFitInMargin:!1};if(s)return{canFitInMargin:!1};const o=n??i;return{canFitInMargin:o-i>=Qu+Ju+ep,editorLeftBoundary:o}}function np({menuHeight:e,experimentGroup:t,textSelectionState:n,isActive:i=!0}){const s=(0,r().v3)(),o=(0,r().Y0)(),{canFitInMargin:a}=tp({isActive:i}),d=(0,l().K8)((()=>s.WindowSizeStore.state.height),[s.WindowSizeStore]),c=(0,l().K8)((()=>s.WindowSizeStore.state.width),[s.WindowSizeStore]);return(0,l().K8)((()=>{if(!i)return;nc().A.state,Hc().A.state,Zc().A.state;if("empty"===n.mode)return;const s=Nd().get();if(!s)return;if(s.collapsed)return;const r=Nd().getRect(s);if(!r)return;let l=0;l=(0,la().A1)()?c-r.right:r.left;const u=wc().ek(o.isElectronMac),p=function({textRect:e,menuHeight:t,windowHeight:n,contentTop:i,canFitInMargin:s,experimentGroup:o}){if(s&&"vertical_margin"===o){let s=e.top-Ju;return s+t+8>n&&(s=n-t-8),Math.max(s,i)}let a=e.bottom;if(a+t>n){const n=e.top-t;a=n>=i?n:i}return a}({textRect:r,menuHeight:e,windowHeight:d,contentTop:u,canFitInMargin:a,experimentGroup:t});return{top:p,left:l}}),[e,d,c,o.isElectronMac,a,t,i,n])}function ip({experimentGroup:e}){const[t,n]=(0,i.useState)(!1),s=(0,mr().S)(),a=(0,r().v3)(),d=(0,l().O$)($c().A),c=(0,l().O$)(T().default),{isActive:u,blockTarget:p,isAnimatingClosed:m}=d,f=(0,l().K8)(us().a,[]),h=(0,l().K8)((()=>_c().zD.isRichTextMenuSuggestionEnabled()),[]),S=(0,l().K8)((()=>{var e;return"slack_notification"===(null===(e=Vr().A.getState().automationActionStore)||void 0===e?void 0:e.getType())}),[]),[x,M]=(0,i.useState)(void 0),w=(0,i.useCallback)((()=>{var e;if(!h||!f)return;const t=(0,os().filterAndRankAssistantSurfaceActionsForContext)((0,os().clientSkillToAssistantSurfaceAction)((0,as().getAllClientSkills)({currentPageRecordPointer:void 0,currentCollectionRecordPointer:void 0})),{type:"entrypoint",entrypoint:"richTextMenu",pageStore:f,selectionState:it().default.state,textSelectionState:T().default.state,isMobile:o().A.isMobile,userSettings:null===(e=v().default.state.currentUserSettingsStore)||void 0===e?void 0:e.getSettings()}).at(0);return t?{...t,isSuggested:!0}:void 0}),[h,f]),I=(0,l().K8)((()=>{const e=T().default.state;if(!u||"empty"===e.mode)return;const t=it().default.state.stores[0],{multiSelection:n}=e,i=(0,k().K)(n);if(i){if(n.start.index+1===n.end.index){const e=(0,qs().ANx)(n.start.store.getValue(),n.start.index);if(e&&(0,qs().B8H)(e))return}if((0,ic().k)(n))return}const o=(0,Jd().$W)(n),a=o.map((({editable:e})=>e.getContextClosestSelectableStore())),r=T().default.isEditingComment(),l=T().default.isEditingFormQuestion(),d=t&&"form"===t.getType(),c=l||d,p=T().default.isEditingCaption(),g=t&&t.getParentTable()===Bl().Vl,m=i&&t&&n.start.store===t.getCollectionViewSourceDescriptionStore(),f=zc().Gb(),h=null==s?void 0:s.publicEditModeStore.state,y=!(0,zl().QT)(h)&&(n.start.store.canEdit()&&n.end.store.canEdit()),v=t&&"suggest"===qc().Uv.getMode(t),M=b().default.checkGate({gateName:"block_reactions"}),A=a.some(((e,t)=>{const n=o[t].store.table===go().SN&&!o[t].editable.props.disabled;return!!e&&(e.isLocked()||e.isNavigableAncestorLocked())&&!n})),j=y&&!A&&!o.some((e=>e.editable.props.disableFormattingAnnotations)),w=t&&t.getType(),I=w&&Yu[w],C=null==t?void 0:t.isType("button"),_=(0,Bc().u)(n.start.store)||(0,Bc().u)(n.end.store),P=Lc(n.start.store)||Lc(n.end.store),B=null==t?void 0:t.getNavigableBlockStore(),R=(null==B?void 0:B.getParentTable())===jc().C0;let D=!1;const L=We().A.state.isOpen?We().A.state:Ge().A.state.isOpen?Ge().A.state:void 0;if(L){const e=L.store.getParentStore();if((null==e?void 0:e.table)===Bl().Vl){const t=e.getSchema(),n=L.property,i=(0,lc()._g)({schema:t,property:n});"text"!==(null==i?void 0:i.type)||i.ai_inference||(D=!0)}}const E=(0,U().SF)(null==t?void 0:t.getSystemBlockTypeStore().getValue()),O={isSingleStoreSelection:i,showTurnInto:Boolean(i&&!r&&!g&&!m&&!p&&t&&j&&!C&&!v&&!c&&(_||!P)),showBold:Boolean(j),showItalic:Boolean(j),showStrikethrough:Boolean(j),showUnderline:Boolean(j)&&!S,showCode:Boolean(j)&&!S,showLink:Boolean(i&&j),showHighlight:Boolean(j)&&!S,showDiscuss:Boolean(!r&&t&&E&&(D||!g)&&!m&&!c&&!P&&!R),showReact:Boolean(M&&!r&&t&&!g&&!m&&!P&&!c&&!R),showSuggest:Boolean(!r&&t&&!o.some((e=>e.editable.props.disableSuggestEdit))&&!g&&!m&&!P&&!f&&!A&&!c&&!R),showEquation:Boolean(i&&j&&!v&&!c&&!S),showActionButton:Boolean(i&&!r&&!p&&t&&!g&&!c&&!o.some((e=>e.editable.props.disableRichTextActions))&&(_||!P)),targetBlockStore:t,isComment:r,showCompletions:Boolean((0,Nc().ZE)(h,t)&&j&&!r&&!p&&t&&!g&&!m&&!C&&!P&&!v&&!c),topRankedSkill:x};if(I&&I.size>0)for(const s of I)O[s]=!1;return O}),[u,s,x,S]),[C,_]=(0,i.useState)(I);(0,i.useEffect)((()=>{I&&_(I)}),[I]);const P=C&&C.showDiscuss&&!C.showBold,B=(0,i.useRef)(Zu),R=np({menuHeight:B.current,experimentGroup:e,textSelectionState:c,isActive:u}),D=(0,i.useRef)(void 0),[L,E]=(0,i.useState)(void 0),O=(0,i.useRef)(void 0);(0,i.useEffect)((()=>{const e=()=>{O.current&&(clearTimeout(O.current),O.current=void 0)},t=e=>{D.current=e,E(e)};if(e(),!R)return D.current=void 0,void E(void 0);const n=D.current;if(!n)return void t(R);const i=Math.abs(R.left-n.left),s=Math.abs(R.top-n.top);return(i>100||s>10)&&(O.current=setTimeout((()=>{t(R),O.current=void 0}),20)),e}),[R]);const N=(0,i.useRef)(!1);(0,i.useEffect)((()=>{u?L&&!N.current&&((0,y().u)({environment:a,event:{eventName:"text_selection_menu_shown",eventProperties:{}}}),N.current=!0):N.current=!1}),[u,L,a]);const F=(0,i.useCallback)((e=>{e<100||(B.current=e)}),[B]),z=tp({isActive:u}).canFitInMargin,K=(0,i.useCallback)((()=>{var n;if(Gc().A.state.open||Qc().A.state.open)return;if(oc().l.state)return Tc().I();const i=T().default.state;if(a.TextSelectionCompositionStore.state.isComposing||t)return Tc().I();if("empty"===i.mode)return Tc().I();const s=(0,Jd().$W)(i.multiSelection);if(0===s.length)return Tc().I();if(!s.every((({store:e})=>e.table===V().ev||e.table===go().SN||e.table===Bl().Vl||e.table===Ac().lo)))return Tc().I();if(!a.currentUser.isLoggedIn()||!s.every((({store:e})=>e.canComment())))return;const o=Nd().get();if((0,Oc().f)())return Tc().I();if(s.some((({editable:e})=>e.props.disableStyleAnnotations)))return Tc().I();if(s.some((({editable:e})=>e.props.disableRichTextActions)))return Tc().I();const r=s.map((({editable:e})=>e.getContextClosestSelectableStore()));if(r.some((e=>e&&e.pathIsDead())))return Tc().I();if(r.some((e=>e&&(0,Pc().dL)(e))))return Tc().I();if(r.some(((e,t)=>{const n=s[t].store.canComment(),i=s[t].store.table===go().SN&&s[t].editable.props.disabled;return!!e&&(e.isLocked()||e.isNavigableAncestorLocked())&&!n||i})))return Tc().I();const l=s.some((({store:e})=>{const t=(0,A().zH)(e);if(!(t instanceof j().B))return!1;const n=t.getValue();return!!n&&$u[n.type]}));if(l)return Tc().I();const c=o?Nd().getRect(o):void 0;return c&&!tc().HY(c,(0,ec().A)())||Yc().A.isActive()||Gd().A.isActive()||ja().A.isOpen()||l||Vc().default.isPeekDismissableState()||!o||!sc()||Wc().A.state.open||"assistantCompletionPopup"===ms().default.state.type?Tc().I():(M(w()),void $c().A.setState({...d,isActive:!0,isAnimatingClosed:!1,blockTarget:it().default.state.stores[0],context:null===(n=s[0])||void 0===n?void 0:n.editable.richTextContext,isInMargin:z&&"vertical_margin"===e}))}),[a.currentUser,d,M,w,z,e,a.TextSelectionCompositionStore,t]),q=(0,i.useMemo)((()=>St().nF(K,100,{leading:!1})),[K]);(0,i.useEffect)((()=>{const e=()=>{n(!0),K()},t=()=>{n(!1),K()};return window.addEventListener("compositionstart",e),window.addEventListener("compositionend",t),()=>{window.removeEventListener("compositionstart",e),window.removeEventListener("compositionend",t)}}),[K]),(0,i.useEffect)((()=>{it().default.addListener(q),T().default.addListener(q),nc().A.addListener(K),Hc().A.addListener(K),Zc().A.addListener(K),Vc().default.addListener(K);const e=a.TextSelectionCompositionStore;return e.addListener(K),()=>{T().default.removeListener(q),it().default.removeListener(q),nc().A.removeListener(K),Hc().A.removeListener(K),Zc().A.removeListener(K),Vc().default.removeListener(K),e.removeListener(K)}}),[K,q,a.TextSelectionCompositionStore]);const W=(0,l().K8)((()=>function(e){const t=null==e?void 0:e.getParentStore();if((null==t?void 0:t.table)===V().ev)return!!t&&(0,Uc().fc)(t);return!1}(p)),[p]),G=(0,i.useCallback)((()=>{d.isActive||$c().A.setState({...d,isAnimatingClosed:!1}),_(I)}),[d,I]);return L?(0,g.jsx)(an().O,{open:u||m,children:(0,g.jsx)(op,{handleAnimationEnd:G,onHeightChange:F,isActive:u,isExternallyImportedAndSyncedCollectionPageBlockTarget:W,lastRenderState:C,richTextMenuStoreState:d,canOnlyDiscuss:P,experimentGroup:e,top:L.top,left:L.left})}):null}const sp=i.forwardRef((function({lastRenderState:e,richTextMenuStoreState:t,canOnlyDiscuss:s,isActive:o,style:a,onHeightChange:r,experimentGroup:l,top:d,left:c},u){const{canFitInMargin:p,editorLeftBoundary:m}=tp({isActive:o}),f=function({left:e,canOnlyDiscuss:t,experimentGroup:n,canFitInMargin:i,editorLeftBoundary:s}){let o=t?e:e-Xu;return"vertical_margin"===n&&i&&(o=s-Qu-Ju-ep),Math.max(o,0)}({left:c,canOnlyDiscuss:s,experimentGroup:l,canFitInMargin:p,editorLeftBoundary:m??0}),h=(0,i.useRef)(null);return(0,i.useLayoutEffect)((()=>{h.current&&r(h.current.getBoundingClientRect().height)}),[e,r]),(0,g.jsxs)("div",{className:I().Vl,style:{pointerEvents:"none",position:"absolute",top:d,insetInlineStart:0,display:"flex",width:"100%",...a},ref:(0,n(558842).Px)(h,u),children:[(0,g.jsx)("div",{style:{flexShrink:1,width:f,minWidth:24}}),(0,vo().A)((t=>(0,g.jsx)("div",{style:{pointerEvents:"none",padding:Ju},...t,children:e?(0,g.jsx)(Sp,{renderState:e,experimentGroup:l,canOnlyDiscuss:s}):void 0}))),(0,g.jsx)("div",{style:{flexGrow:1,flexShrink:1,minWidth:36}})]})}));function op({handleAnimationEnd:e,onHeightChange:t,isActive:n,isExternallyImportedAndSyncedCollectionPageBlockTarget:s,lastRenderState:o,richTextMenuStoreState:a,canOnlyDiscuss:r,experimentGroup:l,top:d,left:c}){const u=Math.max(r?c:c-Xu,0)+8+Qu/2,p=(0,i.useMemo)((()=>({delay:n?200:0,duration:100})),[n]);return(0,g.jsx)(Js().A,{tag:sp,visible:n&&!s,initial:{opacity:0,scale:.98},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.98},onAnimationEnd:e,config:p,style:{transformOrigin:`${u}px center`},lastRenderState:o,richTextMenuStoreState:a,canOnlyDiscuss:r,isActive:n,onHeightChange:t,experimentGroup:l,top:d,left:c})}function ap({blockStore:e,disabled:t}){const n=(0,x().eP)(),i=(0,r().v3)(),s=(0,q().tz)(),o=t||!e;let a=(0,g.jsx)(q().sA,{defaultMessage:"Turn into",id:"richTextMenu.turnIntoButton.label"}),d=Fu().U;const c=(0,mr().S)(),u=(0,l().K8)((()=>null==e?void 0:e.getType()),[e]);if(u){const e=Fc().ry[u];a=e&&e.displayName||a;const t=null==e?void 0:e.icon("dark"===n);t&&(d=t)}return(0,g.jsx)(rc().A,{popupType:rc().z.Popup,buttonPopupStore:Qc().A,originGap:4,disabled:o,renderOrigin:e=>(0,g.jsx)(Te().m,{renderTooltip:()=>(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("div",{children:s.formatMessage({defaultMessage:"Turn into",id:"richTextMenu.turnIntoButton.tooltip"})}),(0,g.jsx)("div",{style:{color:W().Tj.text.inverseSecondary},children:a})]}),render:t=>(0,g.jsx)(ac().Ay,{style:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:32,whiteSpace:"nowrap",color:W().Tj.icon.primary,borderRadius:6},disabled:o,disabledFeedback:o,...(0,da().A)(e,t),children:(0,g.jsx)(Qi().I,{icon:d})})}),render:()=>e?(0,g.jsx)(L().A,{menuType:R().gu.Popup,children:(0,g.jsx)(Xe().A,{context:{blocks:[e],environment:i,publicEditMode:void 0,analyticsFrom:"rich_text_menu",pageContext:c},sections:[Ic().t3],onAccept:t=>{const n=e.getType(),s=e.getFormat();Tc().I(),(0,Je().N)(i,{analyticsName:t.analyticsName,action_type:t.analyticsActionType,from:"rich_text_menu",block_id:e.id,block_type:n,is_toggleable:n?(0,F().Yt)(n,s):void 0,parent_collection_id:e.getParentCollectionIdUpToTwoLevels()})}})}):null,onClick:()=>{(0,kc().s)(i,{action:"turn_into"})}})}function rp({disabled:e}){return(0,g.jsx)(lu().A,{type:"b",style:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:32},tooltipLabel:(0,g.jsxs)(i.Fragment,{children:[(0,g.jsx)("div",{children:(0,g.jsx)(q().sA,{defaultMessage:"Bold",id:"richTextMenu.boldButton.tooltip"})}),(0,g.jsx)("div",{children:(0,g.jsx)(Ud().A,{style:{color:W().Tj.text.inverseSecondary},name:"toggleBold"})})]}),disabled:e,children:(0,g.jsx)(Qi().I,{icon:Eu,size:"default"})})}function lp({disabled:e}){return(0,g.jsx)(lu().A,{type:"i",style:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:32},tooltipLabel:(0,g.jsxs)(i.Fragment,{children:[(0,g.jsx)("div",{children:(0,g.jsx)(q().sA,{defaultMessage:"Italicize",id:"richTextMenu.italicsButton.tooltip"})}),(0,g.jsx)("div",{children:(0,g.jsx)(Ud().A,{style:{color:W().Tj.text.inverseSecondary},name:"toggleItalics"})})]}),disabled:e,children:(0,g.jsx)(Qi().I,{icon:Nu,size:"default"})})}function dp({disabled:e}){return(0,g.jsx)(lu().A,{type:"s",style:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:32},tooltipLabel:(0,g.jsxs)(i.Fragment,{children:[(0,g.jsx)("div",{children:(0,g.jsx)(q().sA,{defaultMessage:"Strike-through",id:"richTextMenu.strikeThroughButton.tooltip"})}),(0,g.jsx)("div",{children:(0,g.jsx)(Ud().A,{style:{color:W().Tj.text.inverseSecondary},name:"toggleStrike"})})]}),disabled:e,children:(0,g.jsx)(Qi().I,{icon:zu})})}function cp({disabled:e}){return(0,g.jsx)(lu().A,{type:"_",style:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:32},tooltipLabel:(0,g.jsxs)(i.Fragment,{children:[(0,g.jsx)("div",{children:(0,g.jsx)(q().sA,{defaultMessage:"Underline",id:"richTextMenu.underlineButton.tooltip"})}),(0,g.jsx)("div",{children:(0,g.jsx)(Ud().A,{style:{color:W().Tj.text.inverseSecondary},name:"toggleUnderline"})})]}),disabled:e,children:(0,g.jsx)(Qi().I,{icon:Vu})})}function up({disabled:e}){return(0,g.jsx)(lu().A,{type:"c",style:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:32},tooltipLabel:(0,g.jsxs)(i.Fragment,{children:[(0,g.jsx)("div",{children:(0,g.jsx)(q().sA,{defaultMessage:"Mark as code",id:"richTextMenu.markAsCodeButton.tooltip"})}),(0,g.jsx)("div",{children:(0,g.jsx)(Ud().A,{style:{color:W().Tj.text.inverseSecondary},name:"toggleCode"})})]}),disabled:e,children:(0,g.jsx)(Qi().I,{icon:Pu().codeIcon})})}function pp({disabled:e}){return(0,g.jsx)(cu().A,{style:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:32,paddingInlineStart:0,paddingInlineEnd:0},disabled:e,children:(0,g.jsx)(Qi().I,{icon:Bu().linkIcon,fitToViewBox:"horizontal"})})}function gp(){const e=(0,r().v3)();return(0,g.jsxs)(ac().Ay,{style:{display:"flex",alignItems:"center",justifyContent:"flex-start",whiteSpace:"nowrap",borderRadius:6,height:32,gap:6,padding:"0 6px"},onClick:()=>{(0,is().toggleInitialPrompt)({from:"rich_text_menu",environment:e}),(0,kc().s)(e,{action:"completions"})},children:[(0,g.jsx)(ss().Su,{}),(0,g.jsx)("span",{children:(0,g.jsx)(q().sA,{defaultMessage:"Ask AI...",id:"richTextMenu.askAI.label"})})]})}function mp(){const e=(0,r().v3)(),t=(0,Kc().U)(),n=(0,l().O$)(T().default),s=(0,i.useMemo)((()=>{if(!t)return;if("editing"!==n.mode)return;if((0,ic().k)(n.multiSelection))return;return n.multiSelection.start.store.pointer.table===V().ev&&n.multiSelection.end.store.pointer.table===V().ev?n.multiSelection:void 0}),[t,n]),o=void 0!==s;return t?(0,g.jsxs)(ac().Ay,{style:{display:"flex",alignItems:"center",justifyContent:"flex-start",whiteSpace:"nowrap",borderRadius:6,height:32,gap:6,padding:"0 8px"},disabled:!o,onClick:()=>{s&&(0,Ec().L)({environment:e,textSelection:s,chatPanelStore:(0,us().a)(),source:"rich_text_menu"})},children:[(0,g.jsx)(Qi().I,{icon:dc().F}),(0,g.jsx)("span",{children:(0,g.jsx)(q().sA,{defaultMessage:"Add to chat",id:"richTextMenu.addToChat.label"})})]}):null}const fp=["improve_writing","fix_spelling_grammar","explain_this"];function hp({skillType:e}){const t=(0,r().v3)(),n=(0,s().X)("agent_writer"),i=rs().iS[e],a=i.suggestedDisplayName??i.displayName;return(0,g.jsxs)(ac().Ay,{style:{display:"flex",alignItems:"center",justifyContent:"flex-start",whiteSpace:"nowrap",borderRadius:6,height:32,gap:6,padding:"0 6px"},onClick:()=>{n?(0,Zi().R)(e)?(0,is().toggleInitialPrompt)({from:"rich_text_menu",environment:t,agentPrebuiltPromptType:e}):(0,is().toggleInitialPrompt)({from:"rich_text_menu",environment:t}):(0,ts().Nj)({environment:t,clientSkillWithParameterValues:(0,as().dangerouslyCreateClientSkillWithParameterValues)((0,as().createClientGlobalSkill)(e)),from:"rich_text_menu",assistantSurfaceType:o().A.isMobile?"mobileWriter":"writer"}),(0,kc().s)(t,{action:"completions"})},children:[(()=>{switch(e){case"explain_this":return(0,g.jsx)(Qi().I,{icon:_u().chatIcon});case"improve_writing":return(0,g.jsx)(Qi().I,{icon:Ru().l});default:return i.icon({width:20,height:20})}})(),(0,g.jsx)("span",{children:(0,g.jsx)(q().sA,{...a})})]})}function yp(){return(0,g.jsxs)(g.Fragment,{children:[fp.map((e=>(0,g.jsx)(hp,{skillType:e},e))),(0,g.jsx)(gp,{}),(0,g.jsx)(mp,{})]})}function vp({disabled:e}){const t=(0,r().v3)();return(0,g.jsx)(du().A,{style:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:32},disabled:e,onClick:()=>{(0,kc().s)(t,{action:"e"}),Tc().I()},children:(0,g.jsx)(Qi().I,{icon:Du().v})})}function bp({targetBlockStore:e,disabled:t,experimentGroup:n,canOnlyDiscuss:i}){const s=(0,q().tz)();return(0,g.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,g.jsx)(Jc().A,{style:{borderRadius:6,color:W().Tj.icon.primary,fill:W().Tj.icon.primary,height:32,flex:1,paddingInline:6,gap:6,justifyContent:"flex-start"},placement:"left",iconOnly:!1,blockStore:e,disabled:t,ariaLabel:s.formatMessage({id:"richTextMenu.Discussions.OpenDiscussionButton",defaultMessage:"Write a comment"})}),e&&(["vertical_2","vertical_margin"].includes(n)||i)?(0,g.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:4,marginInlineStart:0},children:[(0,g.jsx)(iu,{targetBlockStore:e,iconOnly:!0,style:{width:32,height:32,paddingInline:0,justifyContent:"center"}}),(0,g.jsx)(ru,{targetBlockStore:e,iconOnly:!0,style:{width:32,height:32,paddingInline:0,justifyContent:"center"}})]}):void 0]})}function Sp({renderState:e,experimentGroup:t,canOnlyDiscuss:n}){const i=(0,l().K8)((()=>$c().A.state.isActive),[]),s=e.showDiscuss||e.showReact||e.showSuggest,o=e.showBold||e.showItalic||e.showUnderline||e.showStrikethrough||e.showCode||e.showEquation||e.showHighlight;return(0,g.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"stretch",width:Qu,background:W().Tj.popoverBackground,overflow:"hidden",fontSize:14,lineHeight:1.2,borderRadius:14,boxShadow:W().Tj.shadowMD,pointerEvents:i?"auto":"none",padding:8},children:[o?(0,g.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:4},children:[(0,g.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:4},children:[(0,g.jsx)(ap,{blockStore:e.targetBlockStore,disabled:!e.showTurnInto}),(0,g.jsx)(Xc().A,{blockStore:e.targetBlockStore,richTextMenuExperimentGroup:t,style:{width:32,height:32,justifyContent:"center",padding:0},updatedColorPickerIconStyles:{width:20,height:20,fontSize:12},disabled:!(e.showHighlight&&e.targetBlockStore)}),(0,g.jsx)(rp,{disabled:!e.showBold}),(0,g.jsx)(lp,{disabled:!e.showItalic}),(0,g.jsx)(cp,{disabled:!e.showUnderline})]}),(0,g.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:4},children:[(0,g.jsx)(pp,{disabled:!e.showLink}),(0,g.jsx)(dp,{disabled:!e.showStrikethrough}),(0,g.jsx)(up,{disabled:!e.showCode}),(0,g.jsx)(vp,{disabled:!e.showEquation}),["vertical_2","vertical_margin"].includes(t)?(0,g.jsx)(tu,{targetBlockStore:e.targetBlockStore,experimentGroup:t,disabled:!e.showActionButton,dimensionStyles:{width:32,height:32}}):(0,g.jsx)(Gu,{targetBlockStore:e.targetBlockStore,disabled:!e.targetBlockStore,experimentGroup:t})]})]}):void 0,s&&e.showDiscuss?(0,g.jsxs)(g.Fragment,{children:[n?void 0:(0,g.jsx)(Hu,{}),(0,g.jsx)(bp,{targetBlockStore:e.targetBlockStore,disabled:!e.targetBlockStore,experimentGroup:t,canOnlyDiscuss:n})]}):void 0,e.showCompletions?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(Hu,{}),(0,g.jsx)(yp,{})]}):void 0]})}function xp(){const e=(0,Xd().r)("rich_text_menu_layout"),t=(0,l().K8)((()=>{var e;const t=T().default.state;if("empty"!==t.mode)return null===(e=(0,Jd().$W)(t.multiSelection)[0])||void 0===e?void 0:e.editable.richTextContext}),[]);var n;return"agent-chat-input"===(n=t)||"comment-input"===n||"form-input"===n||!e.includes("vertical")?(0,g.jsx)(mu,{}):(0,g.jsx)(ip,{experimentGroup:e})}var Mp=()=>n(402014),Ap=()=>n(961232),jp=()=>n(960955),wp=()=>n(267724),Ip=()=>n(869562),kp=()=>n(749687);const Tp=4,Cp=18,_p=.38,Pp=100,Bp=200;const Rp=function(){const e=(0,r().v3)(),t=(0,i.useRef)(void 0),n=(0,i.useRef)(void 0),s=(0,i.useRef)(1/0),o=(0,i.useRef)(void 0),a=(0,i.useRef)(void 0),d=(0,l().K8)((()=>e.WindowSizeStore.state.width),[e]);return(0,i.useEffect)((()=>{d<Ip().OnlyOneSidebarVisibleWidthThreshold&&(0,ki().Nk)(e)&&(0,ki().KB)(e)&&Ip().setExpand({environment:e,isExpanded:!1,from:"sidebar_listener",saveDetailsSidebarPreference:!1})}),[e,d]),(0,i.useEffect)((()=>{const i=i=>{!function({e,environment:t,timerRef:n,hoverDelayTimerRef:i,cachedPageViewRectRef:s,previousMousePositionRef:o,mouseSpeedRef:a}){(0,Mp().SQ)(e,Mp().y$.SidebarMouseMove,(()=>{if(!jp().A.hasOpenPopups()){if(Dp(s),void 0!==o.current){const t=e.clientX-o.current.x,n=e.clientY-o.current.y;a.current=Math.hypot(t,n)}if(function({x:e,y:t,timerRef:n,previousMousePositionRef:i}){i.current={x:e,y:t},clearTimeout(n.current),n.current=setTimeout((()=>{i.current=void 0}),100)}({x:e.clientX,y:e.clientY,timerRef:n,previousMousePositionRef:o}),s.current){const n=kp().sidebarOpenStore.state,o=(0,la().A1)(),r=t.WindowSizeStore.state.width,l=t.WindowSizeStore.state.height,d=o?r-e.clientX:e.clientX,c=o?r-s.current.right:s.current.left,u=Math.max(c*_p,Cp,kp().sidebarMousePeekXStore.state);!(e.clientY>l-Bp)&&d<u&&!Ms().default.isCenterPeekOpen()&&!wp().A.getState().open&&a.current<Tp&&!n?(clearTimeout(i.current),i.current=setTimeout((()=>{Ip().open({fromElectron:!1})}),Pp)):clearTimeout(i.current),n&&d>(0,ki().r6)(t)&&d>u&&Ip().close()}}}))}({e:i,environment:e,timerRef:o,hoverDelayTimerRef:a,cachedPageViewRectRef:t,previousMousePositionRef:n,mouseSpeedRef:s})},r=e=>{clearTimeout(a.current),function(e){e.relatedTarget||Ip().close()}(e)};return window.addEventListener("mousemove",i),window.addEventListener("mouseout",r),()=>{window.removeEventListener("mousemove",i),window.removeEventListener("mouseout",r)}}),[e]),null};const Dp=St().nF((function(e){const t=function(){const{mainEditorCurrentBlockStore:e}=v().default.state,t=Ap().A.find((t=>t.store===e));if(t)return t.getContentWrapEl()??void 0;return}();e.current=t?t.getBoundingClientRect():document.body.getBoundingClientRect()}),500);var Lp=()=>n(54565),Ep=()=>n(135168),Op=()=>n(884780),Np=()=>n(450104),Fp=()=>n(312788),Up=()=>n(991003),zp=()=>n(609679),Kp=()=>n(795732),Vp=()=>n(792057),qp=()=>n(730240),Wp=()=>n(983610),Gp=()=>n(917150),Hp=()=>n(696060),Yp=()=>n(245720),$p=()=>n(577914),Qp=()=>n(265060),Zp=()=>n(552712),Xp=()=>n(406094),Jp=()=>n(493552),eg=()=>n(484392),tg=()=>n(26440),ng=()=>n(580993);const ig=(0,mc().xh)("page",{default:{loader:()=>n.e(5140).then(n.bind(n,920495))},small:{loader:()=>n.e(5140).then(n.bind(n,146633))},fill:{loader:()=>n.e(5140).then(n.bind(n,619403))},fillSmall:{loader:()=>n.e(5140).then(n.bind(n,351586))}},["document","lines","text","paper","file"]);var sg=()=>n(161479),og=()=>n(979340),ag=()=>n(615234),rg=()=>n(555690);function lg(){return rg().MO.filter((e=>"personal"!==e.tier))}function dg(e){const{nextFutureSnapshot:t,subscriptionTier:n,isAdminMode:i}=e;if(i)return{isLocked:!1};if(!t)return{isLocked:!1};const s=(o=t,(Date.now()-parseInt(o.timestamp))/ag().nD);var o;if((0,og().sP)(n)&&s<=rg().et.plus.days)return{isLocked:!1};const a=function(e){return lg().filter((t=>t.days>e)).map((e=>e.tier))}(s);if((0,og().Kv)(n,a))return{isLocked:!1};const r=a[0]??"enterprise";if((0,og().dL)(r))return{isLocked:!1};const l=function(e){const t=lg(),n=t.findIndex((t=>t.tier===e));if(!(n<=0))return t[n-1]}(r);return{isLocked:!0,upsellTier:r,snapshotDaysOld:s,planBelowDays:null==l?void 0:l.days}}var cg=()=>n(148024),ug=()=>n(82926),pg=()=>n(675925);const gg={SnapshotAdminDebugButton:new(d().O2)("SnapshotAdminDebugButton",(async()=>await n.e(14201).then(n.bind(n,84598))))},mg=(0,d().jQ)(gg.SnapshotAdminDebugButton,(e=>e.SnapshotAdminDebugButton));var fg=()=>n(614699),hg=()=>n(788436),yg=()=>n(891078),vg=()=>n(944369),bg=()=>n(570323),Sg=()=>n(134217),xg=()=>n(823541),Mg=()=>n(187820),Ag=()=>n(64901),jg=()=>n(221844),wg=()=>n(898244),Ig=()=>n(452540),kg=()=>n(388821),Tg=()=>n(696706),Cg=()=>n(869558),_g=()=>n(376254);const Pg=function(e){const{navigate:t}=(0,i.useContext)(Fp().E),s=(0,r().v3)(),a=(0,r().Y0)(),d=(0,l().K8)((()=>e.blockStore.getAssociatedCollectionStore()),[e.blockStore]),c=(0,l().K8)((()=>{var e;return null==d||null===(e=d.getLayoutStore())||void 0===e?void 0:e.getModules()}),[d]),u=(0,l().K8)((()=>{if(!d)return 0;const{count:e}=(0,Ii().pm)({collectionStore:d});return e}),[d])>0&&!o().A.isMobile,p=(0,x().IS)((()=>({spinnerWrapper:{padding:32,display:"flex",alignItems:"center",justifyContent:"center"},scroller:{background:W().Tj.background.primary,zIndex:1,flexGrow:1,...u&&{paddingInlineStart:70,paddingInlineEnd:70}},container:{display:"flex",flexDirection:"row",flexGrow:1,overflow:"hidden"},layoutDetailsSidebar:{width:n(253658).xt,flexShrink:0,borderInlineStart:`1px solid ${W().Tj.border.secondary}`}})),[u]),m=(0,i.useCallback)((e=>{ug().un(s),t({environment:s,url:e})}),[s,t]),f=e.blockStore.id,h=e.timestamp,[y]=(0,Nt().Yb)((async()=>await async function(e,t,n){const{timestamp:i}=e,s=e.block.id,o=await At().callApi({eventName:"getSnapshotContents",environment:n,data:e});if("failed"===o.type)throw o.error;const a=kg().RecordMapWithRole.create(o.data.contentMap),r=n.currentUser.id,l=new(jg().A)({name:"PageSnapshotPreview"});for(const{pointer:g,model:m}of a)m&&l.setModelAndRole({pointer:g,userId:r},m,"reader");l.snapshotData={blockId:s,timestamp:i};const d=new Map,c=e=>{const n=l.getRecord({pointer:e,userId:r}),i=(0,Ig().jV)(e);n||!(0,Fl().uj)(e.id)||d.has(i)||d.set(i,(0,mt().v3)(t,e))},u=[];for(const{model:g}of a)if(g)if(g.table===V().ev){const e=g,t=e.getProperties(),n=Tg().L3.uniq(Object.keys(t).map((e=>qs().moK(t[e]))).flat());for(const d of n)c(d);const i=Tg().L3.uniq(Object.keys(t).map((e=>(0,lc().n)(t[e]))).flat());for(const d of i)c(d);const s=e.isNavigableBlock()?[]:e.getContentIds()||[];for(const d of s)c({table:V().ev,id:d});const o=e.getCollectionPointers();for(const d of o)c(d),u.push(d.id);const a=St().sb(Object.keys(t).map((e=>qs().Fbh(t[e]))).flat());for(const d of a)c({table:Rs().oo,id:d});const r=g.getCreatedByPointer();r&&c(r);const l=g.getLastEditedByPointer();l&&c(l)}else if(g.table===Cg().Gy){var p;const e=null===(p=g.getFormat())||void 0===p?void 0:p.collection_pointer;e&&c(e)}else if(g.table===go().SN){const e=g.getCreatedByPointer();e&&c(e)}return await Bg({relatedStoresMap:d,inMemoryRecordCache:l,currentUserId:r}),u.forEach((e=>{var t;const n=null===(t=l.getRecord({pointer:{table:Bl().Vl,id:e},userId:r}))||void 0===t?void 0:t.value;n&&n.schema&&Object.keys(n.schema).forEach((e=>{var t;const i=null===(t=n.schema)||void 0===t?void 0:t[e],s=i&&(0,wg().nC)(i)?(0,wg().zO)(i):void 0;s&&c({table:Bl().Vl,id:s})}))})),await Bg({relatedStoresMap:d,inMemoryRecordCache:l,currentUserId:r}),{blockStore:new(j().B)(n,{table:V().ev,id:s},{inMemoryRecordCache:l}),timestamp:i}}({block:{id:f,spaceId:(0,sg().e)(e.blockStore.pointer.spaceId)},timestamp:h},e.blockStore,s)),[f,s,e.blockStore,h]),v="pending"!==y.status&&"idle"!==y.status,b=y.value,S=y.error,M=(0,Up().A)(!v||!b,400,400),A=(0,l().K8)((()=>{if(M)return(0,g.jsx)("div",{style:p.spinnerWrapper,children:(0,g.jsx)(B().k,{})});if(S)return(0,g.jsx)("div",{style:{padding:32},children:(0,g.jsx)(q().sA,{defaultMessage:"Something went wrong.",id:"pageSnapshotPreview.unknownPreviewLoadError.message"})});const t=(0,n(122001).f)({environment:s,store:e.blockStore});return b?(0,g.jsxs)(n(249046).Ye,{style:p.container,children:[(0,g.jsx)(Ni().A,{store:b.blockStore,isDefaultContainer:!0,droppable:!0,render:({selectableEvents:e})=>(0,g.jsx)(_g().H,{style:p.scroller,type:t,...e,children:(0,g.jsx)(fg().Ay,{store:b.blockStore,disabled:!0,context:Kp().R.InPageSnapShot,paddingBottom:(0,fg().Wj)(a),layoutModulesByArea:c})})},b.timestamp),u&&null!=c&&c.page_details?(0,g.jsx)(_g().H,{style:p.layoutDetailsSidebar,type:Bi().A.Y,children:(0,g.jsx)(n(146594).H,{store:b.blockStore,context:Kp().R.InPageSnapShot,disabled:!0,shownAs:"static_sidebar",modules:c.page_details})}):void 0]}):void 0}),[M,S,s,e.blockStore,b,p.spinnerWrapper,p.container,p.layoutDetailsSidebar,p.scroller,u,c,a]);return(0,g.jsx)(Op().K,{from:"PageSnapshotPreview",fallback:({error:e,errorId:t})=>(0,g.jsx)(Np().LargeSurfaceRenderError,{error:e,errorId:t}),children:(0,g.jsx)(n(110525).B,{value:m,children:A})})};async function Bg(e){const{relatedStoresMap:t,inMemoryRecordCache:n,currentUserId:i}=e,s=Array.from(t.values());await(0,xt().lX)(s,25,(async e=>{await e.load();const t=e.getValue();t&&n.setRecord({pointer:e.pointer,userId:i},{role:"reader",value:t})}))}var Rg=()=>n(147577);const Dg={display:"flex",justifyContent:"center",padding:32},Lg=(0,q().YK)({restoreSnapshotError:{id:"historyModal.restoreSnapshot.errorMessage",defaultMessage:"Failed to restore version."}});const Eg=function(){const e=(0,q().tz)(),t=(0,r().v3)(),i=(0,l().O$)(bg().A),s=Zg();return o().A.isMobile?(0,g.jsx)(C().zD,{ariaLabel:zg(e),popupType:_().n.SlideUp,open:i.open,render:()=>(0,g.jsx)(Qg,{}),onDismiss:()=>ug().un(t)}):(0,g.jsx)(n(107975).a,{ariaLabel:zg(e),open:i.open,innerStyle:s.modal,onDismiss:()=>ug().un(t),render:()=>(0,g.jsx)(Qg,{}),className:I().uMd})},Og=(0,g.jsx)(q().sA,{defaultMessage:"This page does not have any snapshots yet. Allow up to 10 minutes for the first snapshot to be generated.",id:"historyModal.noSnapshotsYet.message"});function Ng(e){var t;const n=dg({...e,subscriptionTier:null===(t=Wp().subscriptionDataStoreInstance.state)||void 0===t?void 0:t.subscriptionTier,isAdminMode:o().A.isAdminMode});if(n.isLocked&&n.upsellTier&&n.snapshotDaysOld)return{tier:n.upsellTier,titleMessage:(0,g.jsx)(q().sA,{defaultMessage:"{snapshotLimitDays} day page history",id:"historyModal.upsell.title",values:{snapshotLimitDays:n.planBelowDays??Math.floor(n.snapshotDaysOld)}}),bodyMessage:(0,g.jsx)(q().sA,{defaultMessage:"Please upgrade to the {upsellTier} plan to access versions older than {snapshotLimitDays} days",id:"historyModal.upsell.message",values:{upsellTier:(0,eg().A)((0,og().$P)(n.upsellTier)?"plus":n.upsellTier),snapshotLimitDays:n.planBelowDays??Math.floor(n.snapshotDaysOld)}})}}function Fg(){return(0,g.jsx)(Ag().A,{href:(0,Ne().x)("guides.pageHistory"),analyticsFrom:"page_history"})}function Ug(e,t){return!o().A.isMobile||"personal"===e&&(0,vg().m)({environment:t})}function zg(e){return e.formatMessage({id:"historyModal.ariaLabel",defaultMessage:"Page History"})}function Kg({menuState:e}){const t=(0,l().K8)((()=>e.blockStore.getIcon()),[e.blockStore]),n=(0,l().K8)((()=>e.blockStore.isEmptyPage()),[e.blockStore]),s=Zg();return e.snapshot?(0,g.jsxs)(i.Fragment,{children:[(0,g.jsxs)("div",{style:s.header,children:[t?(0,g.jsx)(Mg().B6,{disabled:!0,icon:t,isEmptyPage:n,size:o().A.isMobile?24:20}):null,t?null:(0,g.jsx)(Qp().Q,{iconGroup:ig,variantName:"default",colorVariant:"secondary"}),(0,g.jsx)(Jp().D,{styleKey:"bodyRegular",colorVariant:"tertiary",style:{minWidth:0,flex:1},children:(0,g.jsx)(Cl().A,{store:e.blockStore,style:{maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}})})]}),(0,g.jsx)(Pg,{blockStore:e.blockStore,timestamp:e.snapshot.timestamp})]}):null}function Vg(e,t,n){st().K(t,{from:"history_modal",upsell:{type:"product",product:e,limit:{type:"none"},trialability:"none"},spaceStore:(0,Ep().f)(n)})}function qg({message:e,showUpgradeButtonForTier:t,blockStore:n}){const i=(0,r().v3)(),s=(0,l().K8)((()=>Sg().qc(Wp().subscriptionDataStoreInstance.state)),[]),a=Zg();let d=Ug(t,i);return d&&(0,vg().m)({environment:i})&&"personal"===t&&!s&&(d=!1),s||(d=!1),(0,g.jsxs)("div",{style:o().A.isMobile?a.unavailableMessageComponentMobile:a.unavailableMessageComponent,children:[Ug(t,i)?(0,g.jsx)("img",{src:Wr().A.images.icons.clockArrowLockSvg,alt:"locked clock icon"}):null,(0,g.jsx)("div",{style:{...!o().A.isMobile&&{maxWidth:283}},children:e}),d&&t?(0,g.jsx)(Xp().A,{size:"lg",onClick:()=>Vg(t,i,n),style:a.upsell,iconLeading:{icon:ua().arrowInCircleUpFillIcon,colorPalette:"blue",colorVariant:"accentPrimary"},children:(0,g.jsx)(q().sA,{defaultMessage:"Upgrade plan",id:"historyModal.upgradeForHistoryButton.labelVHR"})}):null]})}function Wg(e){const t=(0,r().v3)(),n=(0,q().tz)(),{menuState:s,loadingMore:a}=e,d=(0,Up().A)(a,300,100),c=Zg();const u=function(e){const t=new Map;return e.forEach((e=>{const n=(0,il().W_)(parseInt(e.timestamp),"very_short",zp().locale),i=t.get(n)??0;t.set(n,i+1)})),t}(e.snapshotValues),p=(0,i.useCallback)((e=>{const t=e>Date.now()-6*H().nD,n=u.get((0,il().W_)(e,"very_short",zp().locale));return!!n&&(n>1||t)}),[u]),m=(0,l().K8)((()=>St().oE(e.snapshotValues.map(((i,a)=>{const r=a>0?e.snapshotValues[a-1]:void 0,l=!Ng({snapshot:i,nextFutureSnapshot:r});return{key:i.id,action:()=>{ug().Xn({environment:t,snapshot:i,nextFutureSnapshot:r})},render:e=>{const t=i.authors||[],a=n.formatList(St().oE(t.map((e=>(0,qp().JQ)({parentStore:s.blockStore,pointer:e}).getDisplayName(n)))),{type:"conjunction",style:"narrow"}),r=(0,g.jsx)("div",{style:{...G().RC},children:a}),d=Boolean(s.snapshot&&s.snapshot.id===i.id),u=parseInt(i.timestamp),m=p(u),f=(0,il().oo)(u,zp().locale,n,m);return l?(0,g.jsx)(E().A,{...e,title:f,focused:!o().A.isMobile&&d,caption:r,buttonStyle:c.buttonMenuItem,itemMarginLeft:8,right:o().A.isAdminMode?(0,g.jsx)(mg,{snapshot:i}):null}):(0,g.jsx)(E().A,{...e,title:(0,g.jsx)("div",{style:c.menuItem,children:(0,g.jsx)("div",{style:{...o().A.isMobile&&{display:"flex",flex:1},...G().RC},children:f})}),focused:!o().A.isMobile&&d,caption:r,right:(0,g.jsx)(Qp().Q,{iconGroup:ng().U,variantName:"fillSmall",colorVariant:"tertiary"}),buttonStyle:c.buttonMenuItem,itemMarginLeft:8,rightStyle:{marginInlineEnd:"7px"}})}}})))),[e.snapshotValues,t,n,s.blockStore,s.snapshot,c,p]),f=s.snapshot&&s.snapshot.id,h=m.findIndex((e=>f===e.key)),y=[{key:"snapshots",render:e=>(0,g.jsx)(N().A,{...e}),items:m}];return(0,g.jsxs)(i.Fragment,{children:[(0,g.jsx)(O().A,{type:O().O.Vertical,initialFocus:h,sections:y}),(0,g.jsx)(Hp().A,{loading:a,fetchSize:s.size,resultSize:e.snapshotValues.length,onLoadMore:ug().p2}),d?(0,g.jsx)("div",{style:Dg,children:(0,g.jsx)(B().k,{})}):void 0]})}function Gg({menuState:e,onRestoreSnapshot:t}){const n=(0,q().tz)(),i=(0,r().v3)();return(0,g.jsx)(C().zD,{popupType:_().n.SlideUp,open:Boolean(e.snapshot),forceFullScreenSlideUp:!0,render:()=>{if(!e.snapshot)return null;const s=Ng({snapshot:e.snapshot,nextFutureSnapshot:e.nextFutureSnapshot}),o=!s,a=o?(0,g.jsx)(Pg,{blockStore:e.blockStore,timestamp:e.snapshot.timestamp}):(0,g.jsx)(qg,{blockStore:e.blockStore,message:s.bodyMessage,showUpgradeButtonForTier:s.tier}),r=!o&&i.device.isMobileBrowser;return(0,g.jsx)(L().A,{menuType:R().gu.Modal,title:(0,il().jE)(parseInt(e.snapshot.timestamp),zp().locale,n),right:(0,g.jsx)(q().sA,{...Yp().W.done}),onClickRight:ug().j8,leftDisabled:!o&&!i.device.isMobileBrowser,left:r?(0,g.jsx)(q().sA,{defaultMessage:"Upgrade",id:"historyModal.mobileSnapshotMenu.upgradeButton.label"}):(0,g.jsx)(q().sA,{defaultMessage:"Restore",id:"historyModal.mobileSnapshotMenu.restoreButton.label"}),onClickLeft:()=>(async()=>{r?Vg(s.tier,i,e.blockStore):await t()})(),whiteBackground:o,forceFullScreenSlideUp:!0,children:a})}})}function Hg(e){const{navigate:t}=(0,i.useContext)(Fp().E),n=(0,mr().S)(),s=(0,r().v3)(),{menuState:o}=e,a=(0,yg().i0)(o.blockStore),d=(0,yg().ty)(o.blockStore),c=(0,l().K8)((()=>Boolean(o.snapshot&&!a&&!d&&!Ng({snapshot:o.snapshot,nextFutureSnapshot:o.nextFutureSnapshot})&&function(e,t,n){return(0,hg().X)({environment:t,blocks:[e.blockStore],originRect:void 0,publicEditMode:void 0,pageContext:n})}(o,s,n))),[s,o,a,d,n]),u=Zg();return(0,g.jsxs)("div",{style:u.sidebarStyle,children:[(0,g.jsxs)("div",{style:u.sidebarHeader,children:[(0,g.jsx)(Jp().D,{styleKey:"titleSmSemibold",colorVariant:"primary",children:(0,g.jsx)(q().sA,{id:"historyModal.desktopModal.sidebar.title",defaultMessage:"Version history"})}),(0,g.jsx)($p().R,{onClick:()=>ug().un(s),style:u.dismiss})]}),(0,g.jsx)(Gp()._,{type:Bi().A.Y,style:{flex:1},children:(0,g.jsx)(Wg,{...e})}),(0,g.jsxs)("div",{style:u.actions,children:[(0,g.jsx)(so().p,{size:"lg",colorPalette:"gray",onClick:()=>{cg().FH(s,{from:"page_history"}),t({environment:s,url:(0,Ne().x)("guides.pageHistory"),openInNew:"tab"})},iconLeading:{icon:Ce().questionMarkCircleSmallIcon,size:"sm"},children:(0,g.jsx)(q().sA,{defaultMessage:"Learn more",id:"historyModal.desktopModal.learnMoreButtonVHR.label"})}),(0,g.jsx)(Te().m,{disableTooltip:c,renderTooltip:()=>d?(0,g.jsx)(q().sA,{defaultMessage:"Resolve pending edits to restore snapshots.",id:"historyModal.desktopModal.sidebar.resolvePendingEdits.tooltip"}):a?(0,g.jsx)(q().sA,{defaultMessage:"Restore page from trash to restore snapshots.",id:"historyModal.desktopModal.sidebar.restorePageFromTrashMessage.tooltip"}):(0,g.jsx)(q().sA,{defaultMessage:"Upgrade to restore snapshots.",id:"historyModal.desktopModal.sidebar.upgradeMessage.tooltip"}),render:t=>(0,g.jsx)(Qn().A,{colorPalette:"blue",size:"lg",onClick:e.onRestoreSnapshot,disabled:!c,...t,style:u.restoreButton,children:(0,g.jsx)(q().sA,{defaultMessage:"Restore",id:"historyModal.desktopModal.restoreButtonVHR.label"})})})]})]})}function Yg(e){const t=(0,r().v3)();let n,s;return e.loadingMore||0!==e.snapshotValues.length||(n=(0,g.jsx)(qg,{blockStore:e.menuState.blockStore,message:Og,showUpgradeButtonForTier:!1})),s=e.error?(0,g.jsx)("div",{style:Dg,children:(0,g.jsx)(q().sA,{defaultMessage:"Something went wrong",id:"historyModal.errorMessage"})}):e.initialLoading?(0,g.jsx)("div",{style:Dg,children:(0,g.jsx)(B().k,{})}):(0,g.jsxs)(i.Fragment,{children:[(0,g.jsx)(Gp()._,{type:Bi().A.Y,children:(0,g.jsx)(Wg,{...e})}),(0,g.jsx)(Gg,{...e})]}),(0,g.jsx)(L().A,{menuType:R().gu.Modal,title:(0,g.jsx)(q().sA,{defaultMessage:"History",id:"historyModal.mobileHistoryMenu.title"}),left:(0,g.jsx)(Fg,{}),right:(0,g.jsx)(q().sA,{...Yp().W.done}),onClickRight:()=>ug().un(t),header:n,children:(0,g.jsx)(Op().K,{from:"MobileHistory",fallback:({error:e,errorId:t})=>(0,g.jsx)(Np().LargeSurfaceRenderError,{error:e,errorId:t}),children:s})})}function $g(e){const t=(0,r().Y0)(),n=(0,l().K8)((()=>e.menuState.snapshot?Ng({snapshot:e.menuState.snapshot,nextFutureSnapshot:e.menuState.nextFutureSnapshot}):null),[e.menuState.nextFutureSnapshot,e.menuState.snapshot]),i=Zg(),s=(0,l().K8)((()=>(0,fg().Wj)(t)),[t]),a=(0,l().K8)((()=>(0,Ep().f)(e.menuState.blockStore)),[e.menuState.blockStore]);let d;return d=e.error?(0,g.jsx)("div",{style:Dg,children:(0,g.jsx)(q().sA,{defaultMessage:"Something went wrong",id:"historyModal.desktopModal.errorMessage"})}):e.initialLoading?(0,g.jsx)("div",{style:Dg,children:(0,g.jsx)(B().k,{})}):n?(0,g.jsxs)("div",{style:i.blurContainer,children:[(0,g.jsx)("div",{style:o().A.isMobile?i.unavailableMessageComponentMobile:i.unavailableMessageComponent,children:(0,g.jsx)(xg().V,{icon:tg().w,title:n.titleMessage,description:n.bodyMessage,source:"history_modal",upsell:{type:"product",product:n.tier,limit:{type:"none"},trialability:"none"},spaceStore:a})}),(0,g.jsx)("div",{style:i.snapshotBlur,children:(0,g.jsx)(fg().Ay,{store:e.menuState.blockStore,disabled:!0,context:Kp().R.InPageSnapShot,paddingBottom:s})})]}):e.loadingMore||0!==e.snapshotValues.length?(0,g.jsx)(Kg,{menuState:e.menuState}):(0,g.jsx)(qg,{blockStore:e.menuState.blockStore,message:Og,showUpgradeButtonForTier:!1}),(0,g.jsxs)(Op().K,{from:"DesktopHistory",fallback:({errorId:e})=>(0,g.jsx)(Np().LargeSurfaceRenderError,{errorId:e}),children:[(0,g.jsx)("div",{style:i.preview,children:d}),(0,g.jsx)(Hg,{...e})]})}function Qg(){const e=(0,q().tz)(),t=(0,r().v3)(),n=(0,l().O$)(bg().A),[i]=(0,Nt().Yb)((async()=>{if(n.open)return await async function(e,t,n){const i=await At().callApi({eventName:"getSnapshotsList",environment:n,data:e});if("failed"===i.type)throw i.error;const{snapshots:s}=i.data;if(t.pageHasCollection=s.some((e=>{var t;const n="collection"===e.parent_table,i=null===(t=e.collection_ids)||void 0===t?void 0:t.length;return n||i&&0!==i})),t.openSnapshotNearTimestamp){const e=parseInt(t.openSnapshotNearTimestamp),i=s.findIndex((t=>parseInt(t.timestamp)<e));0===s.length||(0===i?ug().Xn({environment:n,snapshot:s[i],nextFutureSnapshot:void 0}):i>0?ug().Xn({environment:n,snapshot:s[i-1],nextFutureSnapshot:i>1?s[i-2]:void 0}):s.length<t.size?ug().Xn({environment:n,snapshot:s[s.length-1],nextFutureSnapshot:s.length>1?s[s.length-2]:void 0}):ug().p2())}else Boolean(t.snapshot)||o().A.isMobile||bg().A.setState({...t,snapshot:s[0],nextFutureSnapshot:void 0});return i.data}({block:{id:n.blockStore.id,spaceId:(0,sg().e)(n.blockStore.pointer.spaceId)},size:n.size},n,t)}),[t,n]),s="pending"!==i.status&&"idle"!==i.status,a=i.error,d=i.value,c=(0,Up().A)(Boolean(n.open&&(!d||d.snapshots.length>=n.size&&n.openSnapshotNearTimestamp)),400,100);if(!n.open)return null;const u=o().A.isMobile?Yg:$g;return(0,g.jsx)(u,{snapshotValues:d?d.snapshots:[],menuState:n,onRestoreSnapshot:async function(){if(!n.open)return;const i="restore_collection",s=n.pageHasCollection?[{key:i,text:(0,g.jsx)(q().sA,{defaultMessage:"Also restore databases on this page",id:"historyModal.confirmDialog.selectOption.collection"}),description:(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(q().sA,{defaultMessage:"All database pages and their properties from this version will be restored, which may impact other users or database views. To restore database page content, restore an earlier version for each page.",id:"historyModal.confirmDialog.selectOption.collection.description"})," ",(0,g.jsx)(Zp().N,{external:!0,href:(0,Ne().x)("guides.pageHistoryRestore"),style:{display:"inline",textDecoration:"underline"},children:(0,g.jsx)(q().sA,{id:"historyModal.confirmDialog.selectOption.collection.learnMore",defaultMessage:"Learn more"})})]})}]:void 0,{accept:o,selectionResult:a}=await Vp().Gh({message:(0,g.jsx)("div",{style:{fontWeight:G().Wy.semibold,fontSize:"medium"},children:(0,g.jsx)(q().sA,{defaultMessage:"Restore to this version?",id:"historyModal.confirmDialog.description"})}),acceptLabel:(0,g.jsx)(q().sA,{defaultMessage:"Restore",id:"historyModal.confirmDialog.restoreButton.label"}),selectionItems:s,mode:s?"wide":void 0,textAlign:"left"});if(o){try{await(0,pg().o)(t,{action:"restore_snapshot",from:"snapshot_history_modal",block_type:void 0},(e=>ug().n5(t,null==a?void 0:a[i]).then(e)))}catch{Vp().f1(e.formatMessage(Lg.restoreSnapshotError))}ug().un(t)}},error:a,initialLoading:c,loadingMore:!s})}function Zg(){return(0,x().IS)((()=>({sidebarStyle:{display:"flex",flexDirection:"column",flexShrink:0,width:Rg().pN,paddingTop:10,paddingInlineEnd:8,paddingBottom:0,paddingInlineStart:8,borderInlineStart:`\n\t\t\t1px solid ${W().Tj.border.secondaryTranslucent}\n\t\t`},sidebarHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",alignSelf:"stretch",paddingTop:4,paddingInlineEnd:4,paddingBottom:4,paddingInlineStart:8},actions:{display:"flex",paddingTop:12,paddingInlineEnd:12,paddingBottom:12,paddingInlineStart:6,borderTop:`\n\t\t\t\t\t1px solid ${W().Tj.border.secondaryTranslucent}\n\t\t\t\t`,justifyContent:"space-between",marginInlineStart:"-8px",marginInlineEnd:"-8px"},preview:{display:"flex",flexDirection:"column",width:`calc(100% - ${Rg().pN}px)`,boxShadow:`calc(var(--direction, 1) * 1px) 0 0 ${W().Tj.border.secondaryTranslucent}`,overflow:"hidden"},restoreButton:{backgroundColor:W().Tj.blue.text.accentPrimary,borderRadius:"6px",boxShadow:"none"},buttonMenuItem:{marginInlineStart:"0px",marginInlineEnd:"0px",width:"100%",borderRadius:"6px"},menuItem:{display:"flex",alignItems:"center",justifyContent:"space-between"},header:{display:"flex",alignItems:"center",flexShrink:0,height:45,paddingInlineStart:14,paddingInlineEnd:14,gap:6,width:"100%",overflow:"hidden"},modal:{height:`${Rg().fi}vh`,width:`${Rg().oR}vw`,overflow:"hidden",display:"flex",borderRadius:"12px"},blurContainer:{position:"relative",width:"100%",height:"100%",overflow:"hidden"},unavailableMessageText:{position:"absolute",width:"100%",height:"100%",zIndex:1},snapshotBlur:{position:"relative",pointerEvents:"none",filter:"blur(20px)",opacity:"30%",margin:"-5px"},unavailableMessageComponentMobile:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",marginTop:28,padding:16,textAlign:"center",fontSize:14,position:"relative",zIndex:1,background:W().Tj.popoverBackground,boxShadow:`\n\t\t\t\t\t\t\t\t0 -1px 0 ${W().Tj.border.secondaryTranslucent},\n\t\t\t\t\t\t\t\t0 1px 0 ${W().Tj.border.secondaryTranslucent}\n\t\t\t\t\t\t\t`},unavailableMessageComponent:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:16,textAlign:"center",fontSize:14,height:"100%",gap:16},upsell:{gap:4,paddingInlineStart:"8px",paddingInlineEnd:"12px",borderRadius:"6px"},dismiss:{position:"unset"}})),[])}var Xg=()=>n(999752),Jg=()=>n(664713),em=()=>n(90873);const tm=10;function nm(){const e=(0,r().v3)(),{sidebarSpaceStore:t,currentUserStore:n,currentUserRootStore:s}=(0,l().K8)((()=>({sidebarSpaceStore:(0,ut().S)(),currentUserStore:v().default.state.currentUserStore,currentUserRootStore:v().default.state.currentUserRootStore})),[]),o=null==n?void 0:n.id,a=(0,Ut().Kv)(),d=(0,l().K8)((()=>St().oE(a?[null==t?void 0:t.id,...(0,Bt().f)({currentUserRootStore:s,excludeGuestWithPrivatePages:!1}).map((e=>e.getSpaceId()))]:[null==t?void 0:t.id])),[a,t,s]);return(0,i.useEffect)((()=>{if(!o)return;const t=async(t,n)=>{const i=em().A.getSharedPagesState({userId:o,spaceId:t});i&&i.emitValue===n||await Jg().Z({environment:e,userId:o,spaceId:t,emitValue:n})},n=d.length>tm?new(Xg().O)(tm):void 0,i=d.map((i=>{const s=St().nF((async({value:e})=>n?n.enqueue((async()=>t(i,e))):t(i,e)),5e3);return{listener:gt().Ay.addListener((0,vt().Rs)({userId:o,spaceId:i}),void 0,s,void 0,e),throttledHandler:s}}));return function(){null==n||n.cancel(),i&&i.forEach((({listener:t,throttledHandler:n})=>{t&&gt().Ay.removeListener(t,e),n&&n.cancel()}))}}),[d,o,e]),null}n(16280);var im=()=>n(777022),sm=()=>n(744619),om=()=>n(721908),am=()=>n(723085),rm=()=>n(418493),lm=()=>n(636081),dm=()=>n(62371),cm=()=>n(854150),um=()=>n(242028),pm=()=>n(681894),gm=()=>n(799832),mm=()=>n(993996),fm=()=>n(158658),hm=()=>n(125591),ym=()=>n(960492),vm=()=>n(692763),bm=()=>n(52957);const Sm=200,xm=30,Mm=125,Am=25;var jm=function(e){return e[e.Selectable=0]="Selectable",e[e.DropTarget=1]="DropTarget",e}(jm||{});function wm(e){return e.type===jm.Selectable?{type:on().OX.Selectable,store:e.target.props.store,direction:e.direction}:{type:on().OX.DropTarget,key:e.target.props.dropTargetKey,direction:e.direction}}function Im(e){const{target:t,device:n,direction:i,points:s}=e;return i===on().bH.Onto||!n.isPhone||t.props.dropzoneShouldNeverUseOrigin?s.mousePoint:{x:s.originPoint.x,y:s.mousePoint.y}}function km(e){return(0,vm().MS)(e)?{type:jm.Selectable,target:e}:{type:jm.DropTarget,target:e}}function Tm(e){if(!e||!(0,vm().MS)(e))return!1;let t=e;const n=on().Ay.state;if(!n.isDragging)return!1;const{draggedStores:i}=n;for(;t;){if(i.indexOf(t.props.store)>=0)return!0;t=t.getContextClosestSelectable()}return!1}function Cm(e){const{dropzoneMustBeWithinHorizontalBound:t,device:n}=e;return t?0:n.isPhone?9999:0}function _m(e){switch(e.direction){case on().bH.Onto:return function(e){const{device:t,isNativeDrag:n,rect:i,target:s,points:o,priority:a,canAcceptDrop:r}=e,l=on().bH.Onto,d=Im({device:t,target:s,direction:l,points:o});if((n?s.props.canNativeDropOnto:s.props.canDropOnto)&&Bm(d,i)&&!Tm(s)&&r(s,l))return{...km(s),direction:l,left:i.left,top:i.top,width:i.width,height:i.height,priority:a}}(e);case on().bH.Left:return function(e){const{device:t,isNativeDrag:n,rect:i,target:s,points:o,priority:a,optionKeyDown:r,canAcceptDrop:l}=e,d=on().bH.Left,c=Im({device:t,target:s,direction:d,points:o});if(i){const e=(0,la().A1)(),t=e?i.right:i.left,o=e?i.right:i.left;if((n?s.props.canNativeDropLeft:s.props.canDropLeft)&&c.y>=i.top&&c.y<=i.bottom&&Math.abs(c.x-t)<=Sm&&(r||!Tm(s))&&l(s,d))return{...km(s),direction:d,left:o,top:i.top,width:0,height:i.height,priority:a}}}(e);case on().bH.Right:return function(e){const{device:t,isNativeDrag:n,rect:i,target:s,points:o,priority:a,optionKeyDown:r,canAcceptDrop:l}=e,d=on().bH.Right,c=Im({device:t,target:s,direction:d,points:o});if(i){const e=(0,la().A1)(),t=e?i.left:i.right,o=e?i.left:i.right;if((n?s.props.canNativeDropRight:s.props.canDropRight)&&c.y>=i.top&&c.y<=i.bottom&&Math.abs(c.x-t)<=Sm&&(r||!Tm(s))&&l(s,d))return{...km(s),direction:d,left:o,top:i.top,width:0,height:i.height,priority:a}}}(e);case on().bH.Above:return function(e){const{device:t,isNativeDrag:n,rect:i,target:s,points:o,priority:a,optionKeyDown:r,canAcceptDrop:l}=e,d=s.props.verticalDropZoneExtraLeftEdgeOffset??xm,c=Cm({dropzoneMustBeWithinHorizontalBound:s.props.dropzoneMustBeWithinHorizontalBound,device:t}),u=on().bH.Above,p=Im({device:t,target:s,direction:u,points:o});if((n?s.props.canNativeDropAbove:s.props.canDropAbove)&&i&&p.x>=i.left-d-c&&p.x<=i.right+c&&(r||!Tm(s))&&Math.abs(p.y-i.top)<=Mm&&(i.height<=2*Am||p.y<=i.top+Am)&&l(s,u))return{...km(s),direction:u,left:i.left,top:i.top,width:i.width,height:0,priority:a}}(e);case on().bH.Below:return function(e){const{device:t,isNativeDrag:n,rect:i,target:s,points:o,priority:a,optionKeyDown:r,canAcceptDrop:l}=e,d=s.props.verticalDropZoneExtraLeftEdgeOffset??xm,c=Cm({dropzoneMustBeWithinHorizontalBound:s.props.dropzoneMustBeWithinHorizontalBound,device:t}),u=Mm,p=s.props.isLastItem?Number.MAX_SAFE_INTEGER:Mm,g=on().bH.Below,m=Im({device:t,target:s,direction:g,points:o});if((n?s.props.canNativeDropBelow:s.props.canDropBelow)&&i&&m.x>=i.left-d-c&&m.x<=i.right+c&&i.bottom-m.y<=u&&m.y-i.bottom<=p&&(i.height<=2*Am||m.y>=i.bottom-Am)&&(r||s.props.isLastItem||!Tm(s))&&l(s,on().bH.Below))return{...km(s),direction:on().bH.Below,left:i.left,top:i.bottom,width:i.width,height:0,priority:a}}(e)}}function Pm(e){const{device:t,rect:n,target:i,points:s,optionKeyDown:o}=e;return Bm(Im({device:t,target:i,direction:on().bH.Onto,points:s}),n)&&Tm(i)&&!o}function Bm(e,t){return Boolean(t&&e.x>=t.left&&e.x<=t.right&&e.y>=t.top&&e.y<=t.bottom)}var Rm=()=>n(396301),Dm=()=>n(797942),Lm=()=>n(182106),Em=()=>n(444570),Om=()=>n(673660),Nm=()=>n(807990),Fm=()=>n(915440);const Um=2,zm=20,Km=7;function Vm(){const e=(0,i.useRef)(!1),t=(0,i.useRef)(!1),n=(0,i.useRef)(void 0),s=(0,r().Y0)(),o=(0,r().v3)(),a=(0,mr().S)(),l=(0,om().d)((e=>Ga().e.withListenerIgnored((()=>m(e)))),60),d=(0,i.useCallback)((()=>{e.current||l(void 0)}),[l]),c=(0,om().d)((()=>{const{isDragging:e}=on().Ay.state;to().default.afterNextFlush((()=>{n.current&&!e&&Ym(o,n.current.target,n.current.x,n.current.y)}))}),60),u=(0,i.useMemo)((()=>new WeakMap),[]),p=(0,i.useCallback)((e=>{const t=u.get(e);if(u.has(e))return t??!1;const n=(0,mm().x)({environment:o,blocks:e,publicEditMode:null==a?void 0:a.publicEditModeStore.state,pageContext:a});return u.set(e,n),n??!1}),[o,a,u]),g=(0,i.useCallback)((()=>{if(e.current)throw new Error("Assertion failure, updateDragState() called when isUpdatingDragState === true!");e.current=!0;try{const e=on().Ay.state;if(!e.isDragging)return;const{draggedStores:t,currentX:n,currentY:i,offsetX:s,offsetY:r,isNativeDrag:l}=e,d=function(e){const{points:t,draggingStore:n,isNativeDrag:i,environment:s,pageContext:o,canDragFn:a}=e,{device:r}=s,l=(0,sm().r)(),d=function(){const{selectableRectMap:e}=bm().default.state,{dropTargetRectMap:t}=ym().A.state,n=new Map;for(const[i,s]of e.entries())n.set(i,s);return t.forEach(((e,t)=>{n.set(t,e)})),n}(),c=d.keys();let u=c.next();const p=nt().T.findSelectableFromStore(n),g=p?p.getContextSelectableContainer():void 0;let m=[];for(;!u.done;){const e=u.value;u=c.next();const n=d.get(e),p=e.getContextSelectableContainer();if(r.isPhone&&p!==g)continue;if(!p||p.getProps().disable)continue;const f=Wm(p),h={device:r,isNativeDrag:i,rect:n,target:e,points:t,priority:f,optionKeyDown:l.option,canAcceptDrop:(e,t)=>ef({target:e,direction:t,optionKeyDown:l.option,environment:s,pageContext:o,canDragFn:a})};if(Pm(h))return{ontoDropZone:void 0,verticalDropZone:void 0,horizontalDropZones:[]};m.push(...St().oE([_m({...h,direction:on().bH.Onto}),_m({...h,direction:on().bH.Left}),_m({...h,direction:on().bH.Right}),_m({...h,direction:on().bH.Above}),_m({...h,direction:on().bH.Below})]))}m=function(e){const t=Qm(St().Sk(e,Qm));return e.filter((e=>Qm(e)===t))}(m);const f=m.filter((e=>e.direction===on().bH.Above||e.direction===on().bH.Below)),h=St().wq(f,(e=>Math.abs(e.top-$m(e,t,s).y)));if(h&&h.target===p)return{ontoDropZone:void 0,verticalDropZone:void 0,horizontalDropZones:[]};let y=f.filter((({top:e})=>Math.abs(e-(h?h.top:0))<=Um));if(y.length>1){y=y.filter((e=>{const n=$m(e,t,s).x,i=Cm({device:r});return n>=e.left-i&&n<=e.left+e.width+i})),y=St().Ul(y,(({left:e})=>e));let e=0;for(;e<y.length-1;e++){const n=y[e+1],i=$m(n,t,s).x;if(n.left>i)break}y=y.slice(0,e+1),y.reverse()}const v=y.map(wm);let b;const S=m.filter((e=>e.direction===on().bH.Onto)),x=St().wq(S,(e=>e.height));if(x){f.some((e=>{const n=$m(e,t,s).y;return Math.abs(e.top-n)<Km}))||(b=wm(x))}let M;const A=m.filter((e=>e.direction===on().bH.Left||e.direction===on().bH.Right)).sort(((e,t)=>e.height-t.height));let j=St().wq(A,(e=>{const n=$m(e,t,s).x;return Math.abs(e.left-n)}));if(j){const e=j,t=A.filter((t=>Math.abs(t.left-e.left)<zm));t.length>0&&(j=St().wq(t,(e=>e.left)))}if(j){const e=j;f.some((t=>t.top>=e.top&&t.top+t.height<=e.top+e.height))||(M=wm(j))}return{ontoDropZone:b,verticalDropZone:M,horizontalDropZones:v}}({points:{mousePoint:{x:n,y:i},originPoint:{x:n-s,y:i-r}},draggingStore:t[0],isNativeDrag:l,environment:o,pageContext:a,canDragFn:p});if(d.ontoDropZone)return void on().Ay.setState({...e,currentDropZone:d.ontoDropZone,currentHintDropZones:[],currentParentStore:void 0});if(d.verticalDropZone)return void on().Ay.setState({...e,currentDropZone:d.verticalDropZone,currentHintDropZones:[],currentParentStore:void 0});if(d.horizontalDropZones.length>0){const t=d.horizontalDropZones[0],n=St().RT(d.horizontalDropZones);if(t.type===on().OX.Selectable){const i=nt().T.findSelectableFromStore(t.store);if(i){const s=i.getContextClosestSelectable();let o;return s&&s.props.store!==t.store&&s.props.shouldShowParentHalo&&(o=s.props.store),void on().Ay.setState({...e,currentDropZone:t,currentHintDropZones:n,currentParentStore:o})}}else{if(xd().A.findDropTargetFromKey(t.key))return void on().Ay.setState({...e,currentDropZone:t,currentHintDropZones:n,currentParentStore:void 0})}}on().Ay.setState({...e,currentDropZone:void 0,currentHintDropZones:[],currentParentStore:void 0})}finally{e.current=!1}}),[o,p,a]),m=(0,i.useCallback)((e=>{const i=Nm().default.state;if(!(e&&e.target instanceof Element)||i.isOpen&&i.menuIsOpen||(n.current={target:e.target,x:e.clientX,y:e.clientY}),t.current)return void(t.current=!1);const{isDragging:s}=on().Ay.state;if(s)g();else{if(!n.current)return;Ym(o,n.current.target,n.current.x,n.current.y)}}),[o,g]),f=(0,i.useCallback)((()=>{const{isDragging:e}=on().Ay.state;e&&g()}),[g]),h=(0,i.useCallback)((()=>{t.current=!0}),[]);(0,i.useEffect)((()=>(window.addEventListener("mousemove",l),it().default.addListener(c),s.isIOS&&window.addEventListener("touchend",h),window.addEventListener("keydown",f),window.addEventListener("keyup",f),on().Ay.addListener(d),window.addEventListener("scroll",Zm,!0),window.addEventListener("resize",Xm),Hs().RR.addListener(Jm),(0,Om().s)(),()=>{window.removeEventListener("mousemove",l),it().default.removeListener(c),s.isIOS&&window.removeEventListener("touchend",h),window.removeEventListener("keydown",f),window.removeEventListener("keyup",f),on().Ay.removeListener(d),window.removeEventListener("scroll",Zm,!0),window.removeEventListener("resize",Xm),Hs().RR.removeListener(Jm)})),[s.isIOS,d,c,f,l,h])}function qm(){const e=Nm().default.state;e.isOpen&&!e.menuIsOpen&&Nm().default.reset()}function Wm(e){return(it().default.state.droppableContainerStack||[]).indexOf(e)}const Gm=24,Hm=24;function Ym(e,t,n,i){var s,o;const a=Nm().default.state;if(a.isOpen&&a.menuIsOpen)return;const r=function(e){const{environment:t,target:n,x:i,y:s,rightMarginCommentActionsEnabled:o}=e;if(Fm().A.state.isResizing||on().Ay.state.isDragging||nn().default.state.isActive||Hs().RR.state)return;const{selectableRectMap:a}=bm().default.state,r=im().A.getMembersByDOMOrder({filter:e=>{const t=e.getNode();return Boolean(t&&t.contains(n))}})[0];if(!r)return;const l=a.keys();let d=l.next();const c=[],u=[],p=new Map;for(;!d.done;){const e=d.value,n=a.get(e),g=e.getNode();if(!n||!g||!e.props.shouldShowHoverMenu&&!e.props.shouldShowCommentMenu||e.getContextSelectableContainer()!==r){d=l.next();continue}if(!(0,rm().e)({element:g,rect:n,widthRequired:Gm,heightRequired:Hm,containerRectsCache:p})){d=l.next();continue}const m=Em().TH({environment:t,store:e.props.store,selectableBoundingRect:n}),f=Em().KG({store:e.props.store,selectableBoundingRect:n,containerWidth:m}),h=Em().mC(e);if(tc().ux((0,Nm().getExpandedSelectableRect)(n,o,m,f,h),i,s)){for(const t of Nm().HOVER_REGIONS)tc().ux((0,Nm().getHoverRegionOfRect)(n,t,m,f,h),i,s)&&u.push({selectable:e,hoveredRegion:t});tc().ux((0,Nm().getExactSelectableRect)(n,o),i,s)&&c.push(e)}d=l.next()}const g=(0,la().A1)()?-1:1,m=St().Ul(c,(e=>{const t=a.get(e);return t?-t.left*g:1/0})),f=m.find((e=>{const t=e.getNode();return!t||!m.find((n=>{if(n!==e){const e=n.getNode();return Boolean(e&&t.contains(e))}return!1}))}));return f?{exactSelectable:f,nearbySelectables:u,container:r}:{nearbySelectables:u,container:r}}({environment:e,target:t,x:n,y:i,rightMarginCommentActionsEnabled:!0});if(!r)return void Nm().default.reset();const l=!a.isOpen||(null===(s=r.exactSelectable)||void 0===s?void 0:s.props.store)!==a.currentStore,d=a.isOpen&&(null===(o=r.exactSelectable)||void 0===o?void 0:o.props.store)===a.currentStore;var c,u;l?Nm().default.setState({...a,isOpen:!0,menuIsOpen:!1,container:r.container,nearbySelectables:r.nearbySelectables,currentStore:null===(c=r.exactSelectable)||void 0===c?void 0:c.props.store,selectableBoundingRect:null===(u=r.exactSelectable)||void 0===u||null===(u=u.getNode())||void 0===u?void 0:u.getBoundingClientRect(),mouseX:n,mouseY:i}):d&&Nm().default.setState({...a,nearbySelectables:r.nearbySelectables,mouseX:n,mouseY:i})}function $m(e,t,n){return Im({device:n.device,target:e.target,points:t})}function Qm(e){return(null==e?void 0:e.priority)??0}function Zm(){(0,Om().A)(),qm()}function Xm(){(0,Om().A)(),qm()}function Jm(){const e=Nm().default.state,t=Hs().RR.state;e.isOpen&&!e.menuIsOpen&&t&&Nm().default.reset()}function ef(e){const{target:t,direction:n,optionKeyDown:i,environment:s,pageContext:a,canDragFn:r}=e;if(We().A.state.isOpen&&!Ms().default.state.open)return!1;if(Ge().A.state.isOpen)return!1;const l=on().Ay.state,d=l.isDragging?l.draggedStores:[],c=!!l.isDragging&&l.isNativeDrag;let u,p,g,m=!1,f=!1;d.find((e=>{const t=Lm().A.findOutlinerItemFromStore(e);return!!t&&(u=t,p=t.type,m=t.isTopLevelItem,!0)}));const h=(0,vm().MS)(t)?Lm().A.findOutlinerItemFromStore(t.props.store):void 0,y=null==h?void 0:h.parentStore;var S;h&&(g=h.type,f=h.isTopLevelItem||"team"===(null===(S=h.parentStore)||void 0===S?void 0:S.table));if(function(e){var t;const{draggingOutlinerItem:n,selectableOutlinerItemParent:i,direction:s}=e;if(n&&"team"===n.type&&n.isTopLevelItem&&(null===(t=n.parentStore)||void 0===t?void 0:t.pointer.table)===cm().yK){const e=n.parentStore;if(!(n.store.getParentId()===e.pointer.id||i&&i.pointer.id===e.pointer.id&&s!==on().bH.Onto))return!0}return!1}({draggingOutlinerItem:u,selectableOutlinerItemParent:y,direction:n}))return!1;if(!(0,vm().MS)(t))return t.props.canAcceptDrop({direction:n,draggingStores:d,isNativeDrag:c});const x=t.props.store;if(x.pathIsDead())return!1;if((0,Pc().dL)(x))return!1;if("suggest"===qc().Uv.getMode(x))return!1;const M=(0,gm().U)(x);if(M&&M.isInTrashStore.state)return!1;const A=x.getAssociatedCollectionStore();if(n===on().bH.Onto&&A){const e=A.id,t=(0,gm().U)(x),n=null==t?void 0:t.collectionViewBlockStore(),i=null==t?void 0:t.collectionViewStore();if(n&&i&&"page"!==i.getType()){if(d.find((i=>{const s=i.getAssociatedCollectionStore(),o=(0,gm().U)(i);return Boolean(i instanceof j().B&&s&&s.id===e)||Boolean(o===t&&x.id!==n.id)})))return!1}}if(n!==on().bH.Onto){const e=(0,gm().U)(x);if("collectionTypedView"===(null==e?void 0:e.contextTypeFromStoreState)&&e.databaseTypeFromStoreState){if(!d.find((t=>{const n=(0,gm().U)(t);return(null==n?void 0:n.databaseTypeFromStoreState)===e.databaseTypeFromStoreState})))return!1}}if(t.props.groupsPointer){var w;const e=(null==A?void 0:A.getSchema())??(null===(w=(0,gm().U)(x))||void 0===w||null===(w=w.collectionStore())||void 0===w?void 0:w.getSchema());if(Boolean(t.props.groupsPointer.find((t=>!e||!(0,lm().wj)(t,e))))){if(d.find((e=>{var n;const i=nt().T.findSelectableFromStore(e);return(null==i||null===(n=i.props)||void 0===n?void 0:n.groupsPointer)&&t.props.groupsPointer&&!(0,dm().PZ)(i.props.groupsPointer,t.props.groupsPointer)})))return!1}}const I=d.some((e=>e.isInLibraryBlock()))&&(0,Ut().w$)();if(!(0,Dm().Zw)({itemsToMove:d,destinationStore:x,direction:n,draggingOutlinerType:p,allowLibraryExceptions:I&&n!==on().bH.Onto}))return!1;if(i&&d.find((e=>e.isTypedCollectionViewBlock()||(0,um().s)(e))))return!1;if(h&&n!==on().bH.Onto&&!f&&!(0,hm().e)({environment:s,blocks:[h.store],publicEditMode:null==a?void 0:a.publicEditModeStore.state,pageContext:a}))return!1;if(g&&c)return!1;if("bookmarks"===p&&m&&("bookmarks"!==g||!f||n===on().bH.Onto))return!1;if(!b().default.checkGate({gateName:"drag_between_favorites_outliner"})&&"bookmarks"===g&&f&&n!==on().bH.Onto&&("bookmarks"!==p||!m))return!1;if(u&&u.isTopLevelItem&&"team"===u.type&&u.parentStore&&u.parentStore.table===cm().yK){const e=u.parentStore,t=am().h.createChildStore(e,{...e.pointer,table:cm().yK});if(t&&!(0,Rm().dp)({teamStore:t,environment:s}))return!1}if(h&&h.isTopLevelItem&&"team"===h.type&&h.parentStore&&h.parentStore.table===cm().yK){const e=h.parentStore,t=am().h.createChildStore(e,{...e.pointer,table:cm().yK});if(t&&!(0,Rm().dp)({teamStore:t,environment:s}))return!1}const{sidebarSpaceViewStore:k,currentUserSettingsStore:T}=v().default.state,C=g?Rm().r_[g]:void 0;if(k&&h&&u&&C&&h.isTopLevelItem&&n!==on().bH.Onto&&u.type!==g){const{sortOption:e}=(0,Rm().RQ)({spaceViewStore:k,type:C,userSettingsStore:T});if("lastEdited"===e)return!1}if("shared"===g&&f&&n!==on().bH.Onto&&("shared"!==p||!m))return!1;if(g&&f&&n!==on().bH.Onto){if(d.find((e=>{const t=e.getType();return Boolean(!t||!F().BJ[t])})))return!1}if(g&&o().A.isMobile&&n===on().bH.Onto&&f)return!1;if(d.some((e=>Boolean(pm().A.findCollectionTemplatePickerItemFromStore(e))))!==Boolean(pm().A.findCollectionTemplatePickerItemFromStore(x)))return!1;if(n===on().bH.Onto&&x&&!(0,fm().p)({environment:s,blocks:[x],publicEditMode:null==a?void 0:a.publicEditModeStore.state,pageContext:a}))return!1;if(I){if(!(0,Ut().FR)()&&n===on().bH.Onto)return!1;const e=x.getRecordStoreUIParent(),t=e instanceof j().B&&e.isLibraryBlock();if(t&&"favorites"===(0,Vt().oK)(e)&&n===on().bH.Onto)return!1;if(d.some((e=>!e.canAdmin()))&&n===on().bH.Onto)return!1;if(x.isCollectionView()&&n===on().bH.Onto)return!1;if(x.isInLibraryBlock()&&!t&&!x.isLibraryBlock()&&n===on().bH.Below)return!1}if(!r(d))return!1;if(d.some((e=>e.isTransclusionType()))){if(x.findRecordStoreUIAncestor((e=>{if(e===x)return!1;const t=e.isTable("block")&&e.isPath([])&&e.getKeyStore("type").getValue();return Boolean(t&&(0,F().Mp)(t))})).ancestor)return!1}return!0}function tf(){const e=(0,r().Y0)(),t=(0,r().v3)(),{isElectron:n}=e;(0,i.useEffect)((()=>{if(o().A.isMobile){function e(e){e.preventDefault()}return document.addEventListener("gesturestart",e),()=>{document.removeEventListener("gesturestart",e)}}}),[]),(0,i.useEffect)((()=>{function e(e){e.preventDefault()}return window.addEventListener("dragstart",e),()=>{window.removeEventListener("dragstart",e)}}),[]),(0,i.useEffect)((()=>{function e(e){nn().default.state.isActive&&(e.preventDefault(),(0,sn().K)({environment:t,currentX:nn().default.state.currentX,currentY:nn().default.state.currentY,toggle:e.shiftKey}))}function n(e){nn().default.state.isActive&&(e.preventDefault(),(0,sn().K)({environment:t,currentX:e.clientX,currentY:e.clientY,toggle:e.shiftKey}))}function i(e){nn().default.state.isActive&&((0,a().M)(e)||e.preventDefault(),function(e){const t=nn().default.state;if(t.isActive){const{moved:n,verticalScrollerEl:i,horizontalScrollerEl:s,handleScroll:o}=t;n||(0,Be().I)({environment:e}),i&&(0,tn().O)(i,"scroll",o),s&&(0,tn().O)(s,"scroll",o),nn().default.setState({isActive:!1})}}(t))}return window.addEventListener("keydown",e),window.addEventListener("keyup",e),window.addEventListener("mousemove",n),window.addEventListener("mouseup",i),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",e),window.removeEventListener("mousemove",n),window.removeEventListener("mouseup",i)}}),[t]);const l=t.currentUser.isLoggedIn();Lt(l),Vm();const d=(0,s().X)("usage_based_pricing_pfa_checks_purchased_credits_enabled");return(0,g.jsxs)(i.Fragment,{children:[(0,g.jsx)($i,{}),(0,g.jsx)(xa,{}),(0,g.jsx)(Ye().Gc,{}),(0,g.jsx)(Ye().MC,{}),(0,g.jsx)(m,{}),(0,g.jsx)(bi().A,{priority:-1,capture:!0,debugName:"AppComponents"}),l&&!o().A.isMobile?(0,g.jsx)(Rp,{}):void 0,l?(0,g.jsx)(cn().Q,{}):void 0,l?(0,g.jsx)(qd,{}):void 0,l?(0,g.jsx)(Ls,{}):void 0,l?(0,g.jsx)(Kn,{}):void 0,l?(0,g.jsx)(Jt,{}):void 0,l?(0,g.jsx)(qt,{}):void 0,l?(0,g.jsx)(Sn,{}):void 0,l?(0,g.jsx)(An,{}):void 0,l?(0,g.jsx)($t,{}):void 0,l?(0,g.jsx)(nm,{}):void 0,l?(0,g.jsx)(On,{}):void 0,l&&d?(0,g.jsx)(xn().c,{}):void 0,(0,g.jsx)(ln,{}),(0,g.jsx)(Ld,{}),(0,g.jsx)(Ze().Li,{}),(0,g.jsx)(Ze().Tb,{}),(0,g.jsx)(Zd().A,{}),(0,g.jsx)(Qd,{}),(0,g.jsx)(Po,{}),(0,g.jsx)(Ts,{}),o().A.isMobile?void 0:(0,g.jsx)(xp,{}),(0,g.jsx)(Ia,{}),(0,g.jsx)(zd,{}),(0,g.jsx)(ws,{}),(0,g.jsx)(Pa,{}),(0,g.jsx)(ct,{}),(0,g.jsx)(qe().C4,{store:We().A}),(0,g.jsx)(qe().C4,{store:Ge().A}),(0,g.jsx)(He().DV,{}),(0,g.jsx)(Sd,{}),(0,g.jsx)(h().v,{dependencies:rt,children:(0,g.jsx)(f,{})}),(0,g.jsx)(ve,{}),(0,g.jsx)(en,{}),(0,g.jsx)(ui,{}),(0,g.jsx)($n,{}),(0,g.jsx)(ti,{}),(0,g.jsx)(hs,{}),(0,g.jsx)(Lp().A,{}),(0,g.jsx)(Gt,{}),n?(0,g.jsx)(Qe,{}):void 0,(0,g.jsx)($s,{}),(0,g.jsx)(_s().Y,{}),l?(0,g.jsx)(Eg,{}):void 0,(0,g.jsx)(Zo().nJ,{}),(0,g.jsx)(Ve,{}),(0,g.jsx)(Ps().yQ,{}),l?(0,g.jsx)(zs,{}):void 0,(0,g.jsx)(lt().h,{})]})}},523277:(e,t,n)=>{n.d(t,{q:()=>s});n(296540);const i={viewBox:"0 0 20 20",fittedViewBox:"2.02 2.58 15.67 14.83",svg:(0,n(474848).jsx)("path",{d:"M15.405 2.586c-.423 0-.837.117-1.197.338l-2.709 1.663a7.8 7.8 0 0 1-4.068 1.149H4.226a2.2 2.2 0 0 0-2.2 2.2v2.133a2.2 2.2 0 0 0 2.2 2.2h.085l1.191 3.953a1.675 1.675 0 0 0 1.604 1.192h.998c.925 0 1.675-.75 1.675-1.675v-3.107c.6.19 1.178.453 1.72.785l2.709 1.663a2.288 2.288 0 0 0 3.485-1.95V4.874a2.29 2.29 0 0 0-2.288-2.288m-6.876 9.76v3.393c0 .235-.19.425-.425.425h-.998a.425.425 0 0 1-.407-.302l-1.082-3.594H7.43q.555 0 1.098.078m6.73-8.5a1.04 1.04 0 0 1 1.184 1.028v8.256a1.038 1.038 0 0 1-1.183 1.028zm-1.1.574v9.164l-2.006-1.232a9 9 0 0 0-2.41-1.032V6.684a9 9 0 0 0 2.41-1.032zM7.43 11.019H4.226a.95.95 0 0 1-.95-.95V7.936a.95.95 0 0 1 .95-.95H7.43q.611 0 1.213-.082V11.1a9 9 0 0 0-1.213-.082"})},s=(0,n(340498).wt)("megaphone",i,"default")},523347:(e,t,n)=>{n.d(t,{e:()=>D});n(898992),n(672577),n(581454);var i=n(296540),s=()=>n(756117),o=()=>n(395361),a=()=>n(590526),r=()=>n(401497),l=()=>n(718827),d=()=>n(249046),c=()=>n(250910),u=()=>n(118307),p=()=>n(807449),g=()=>n(695115),m=()=>n(31511),f=()=>n(546926),h=()=>n(493552),y=()=>n(373009),v=()=>n(890492),b=()=>n(81068),S=()=>n(663639),x=()=>n(736847),M=()=>n(324254),A=()=>n(582684),j=()=>n(344417),w=()=>n(253673),I=()=>n(824375),k=()=>n(435644),T=()=>n(69708),C=()=>n(100622),_=()=>n(284371),P=()=>n(523996),B=n(474848);const R=(0,T().YK)({searchLabel:{id:"workspaceDiscovery.searchButton.tooltip",defaultMessage:"Search"},searchInputPlaceholder:{id:"workspaceDiscovery.searchInput.placeholder",defaultMessage:"Type to search..."},sortRecommended:{id:"workspaceDiscovery.sort.recommended",defaultMessage:"Recommended"},sortWorkspaceName:{id:"workspaceDiscovery.sort.spaceName",defaultMessage:"Workspace name"},sortMemberCount:{id:"workspaceDiscovery.sort.members",defaultMessage:"Number of members"}});function D(e){const{isReimaginedStyles:t,isInSettingsModal:n=!1}=e,i=O({isReimaginedStyles:t,isInSettingsModal:n});return(0,B.jsxs)(d().Ye,{justifyContent:"space-between",style:i.commandBarContainer,children:[(0,B.jsx)(L,{isReimaginedStyles:t,isInSettingsModal:n}),(0,B.jsx)(E,{isReimaginedStyles:t,isInSettingsModal:n})]})}function L(e){const{isReimaginedStyles:t,isInSettingsModal:n=!1}=e,s=(0,a().uB)(void 0,u().A),o=(0,a().K8)((()=>P().jF.state.sort),[]),r=O({isReimaginedStyles:t,isInSettingsModal:n}),d=(0,i.useCallback)(((e,t)=>{P().jF.setState({...P().jF.state,sort:{type:e,order:"asc"}}),t.close()}),[]),g=()=>[{key:"recommended",label:R.sortRecommended,icon:I().sparklesIcon},{key:P().w1,label:R.sortWorkspaceName,icon:k().a},{key:P().qZ,label:R.sortMemberCount,icon:w().personIcon}],m=g().find((e=>e.key===o.type));return(0,B.jsx)(c().A,{popupType:c().z.Popup,renderOrigin:e=>t?(0,B.jsx)(y().E,{iconLeading:A().arrowUpDownIcon,iconTrailing:M().arrowChevronSingleDownSmallIcon,colorPalette:"blue",...e,shape:"pill",style:r.reimaginedSortButton,children:m?(0,B.jsx)(T().sA,{...m.label}):(0,B.jsx)(T().sA,{defaultMessage:"Sort",id:"workspaceDiscovery.sort.title"})}):(0,B.jsxs)(l().Ay,{...e,style:r.sortButton,children:[(0,B.jsx)(p().I,{icon:A().arrowUpDownIcon,size:"sm",colorVariant:"secondary"}),(0,B.jsx)(T().sA,{defaultMessage:"Sort",id:"workspaceDiscovery.sort.title"}),(0,B.jsx)(p().I,{icon:M().arrowChevronSingleDownSmallIcon,size:10,colorVariant:"secondary",style:r.chevronDownIcon})]}),buttonPopupStore:s,render:e=>(0,B.jsx)(v().A,{menuType:f().gu.Popup,width:235,children:(0,B.jsx)(S().A,{type:S().O.Vertical,initialFocus:void 0,sections:[{key:"pages",render:e=>(0,B.jsx)(x().A,{...e}),items:g().map((t=>({key:t.key,action:()=>{d(t.key,e)},render:e=>(0,B.jsx)(b().A,{...e,title:(0,B.jsxs)("div",{style:r.menuItem,children:[(0,B.jsx)(p().I,{icon:t.icon}),(0,B.jsx)(h().D,{styleKey:"bodyRegular",children:(0,B.jsx)(T().sA,{...t.label})})]}),isChecked:o.type===t.key})})))}]})})})}function E(e){const{isReimaginedStyles:t,isInSettingsModal:n=!1}=e,r=(0,T().tz)(),[l,c]=(0,i.useState)(!1),u=(0,i.useCallback)((()=>{c(!l)}),[l]),p=(0,i.useCallback)((()=>{c(!1)}),[]),f=(0,a().K8)((()=>P().jF.state.searchQuery),[]),h=(0,i.useCallback)((e=>{P().jF.setState({...P().jF.state,searchQuery:e.target.value})}),[]),y=(0,o().Y)(h,250),v=(0,i.useCallback)((()=>{P().jF.setState({...P().jF.state,searchQuery:""}),c(!1)}),[]),b=O({isReimaginedStyles:t,isInSettingsModal:n});return(0,B.jsxs)(d().Ye,{alignItems:"center",style:b.searchContainer,children:[(0,B.jsx)(g().A,{icon:j().magnifyingGlassSmallIcon,style:b.searchButton,disabled:!1,onClick:u,ariaLabel:r.formatMessage(R.searchLabel)}),(0,B.jsx)(s().A,{visible:l,animate:{width:150,opacity:1},initial:{width:0,opacity:0},exit:{width:0,opacity:0},children:(0,B.jsx)(m().A,{style:b.searchInput,format:"transparent",placeholder:r.formatMessage(R.searchInputPlaceholder),value:f,onChange:y,focusInitial:!0,showClearButton:!0,onClearButtonClick:v,onCancel:p})})]})}function O(e){const{isReimaginedStyles:t,isInSettingsModal:n}=e;return(0,r().IS)((()=>({commandBarContainer:{paddingInlineStart:t||n?0:24},sortButton:{display:"flex",flexDirection:"row",alignItems:"center",width:"fit-content",gap:4,paddingInlineStart:8,paddingInlineEnd:8,paddingTop:4,paddingBottom:4,borderRadius:8,background:C().Tj.background.secondary,fontSize:14,color:C().Tj.text.secondary},reimaginedSortButton:{fontWeight:_().Wy.regular},menuItem:{display:"flex",flexDirection:"row",alignItems:"center",gap:8,paddingInlineStart:8,paddingInlineEnd:8,paddingTop:4,paddingBottom:4},hoveredMenuItem:{borderRadius:8},chevronDownIcon:{marginInlineStart:4},searchContainer:{maxWidth:140,fontSize:14},searchInput:{paddingInlineEnd:4},searchButton:{height:28,width:28}})),[t,n])}},523713:(e,t,n)=>{n.d(t,{x:()=>o});var i=()=>n(534177),s=()=>n(686070);function o({isPhone:e,spaceStore:t}){return!e&&(0,i().O9)(t)&&!(0,s().d)({spaceStore:t})}},523996:(e,t,n)=>{n.d(t,{fH:()=>o,jF:()=>l,qZ:()=>a,w1:()=>s});n(898992),n(354520);var i=()=>n(496603);const s="name",o="createdBy",a="members-count";class r extends(()=>n(757695))().Store{getInitialState(){return{sort:{type:"recommended",order:"asc"},searchQuery:void 0,discoverableWorkspaces:[],allDiscoverableWorkspacesCount:0}}getJoinableSpaces(e){const{discoverableWorkspaces:t,sort:n,searchQuery:r}=this.state;let l=t;return r&&(l=l.filter((e=>{var t;return null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(r.toLowerCase())}))),n.type===s?l=(0,i().My)(l,(e=>{var t;return null===(t=e.name)||void 0===t?void 0:t.toLowerCase()}),n.order):n.type===a?l=(0,i().My)(l,(e=>e.totalMemberCount),n.order):n.type===o&&(l=(0,i().My)(l,(e=>{var t;return null===(t=e.createdBy)||void 0===t||null===(t=t.name)||void 0===t?void 0:t.toLowerCase()}),n.order)),this.emit(),l}}const l=new r},525639:(e,t,n)=>{n.r(t),n.d(t,{DatePropertyMenu:()=>Ie});var i=n(296540),s=()=>n(717137),o=()=>n(59226),a=()=>n(726637),r=()=>n(484714),l=()=>n(590526),d=()=>n(609679),c=()=>n(546926),u=()=>n(890492),p=()=>n(736847),g=()=>n(604995),m=()=>n(416504),f=()=>n(971404),h=()=>n(69708),y=()=>n(117586),v=()=>n(287188),b=()=>n(81068),S=()=>n(597777),x=n(474848);function M({dateValue:e,onChangeValue:t}){const n=(0,i.useCallback)((()=>{if("date"===e.type){const n=A(e),i={type:"datetime",start_date:e.start_date,start_time:n,time_zone:(0,m().P)(),reminder:(0,S().Lh)(e)?S().ex(e.reminder):void 0};null==t||t(i)}else if("daterange"===e.type){const n=A(e),i={type:"datetimerange",start_date:e.start_date,start_time:n,end_date:e.end_date,end_time:n,time_zone:(0,m().P)(),reminder:(0,S().Lh)(e)?S().ex(e.reminder):void 0};null==t||t(i)}else if("datetime"===e.type){const n={type:"date",start_date:e.start_date,reminder:(0,S().Lh)(e)?S().vW(e.reminder,(0,m().P)()):void 0};null==t||t(n)}else{const n={type:"daterange",start_date:e.start_date,end_date:e.end_date,reminder:(0,S().Lh)(e)?S().vW(e.reminder,(0,m().P)()):void 0};null==t||t(n)}}),[e,t]);return(0,x.jsx)(b().A,{focused:!1,onClick:n,title:(0,x.jsx)(h().sA,{defaultMessage:"Include time",id:"LuxonDatePropertyMenu.menuItem.includeTime.label"}),right:(0,x.jsx)(v().A,{on:"date"!==e.type&&"daterange"!==e.type,onClick:n})})}function A(e){const t=e.start_date,n=g().C6.isoToUnixMs(t,(0,m().P)()),i=g().T_((0,m().P)()).start_time;if(!n)return i;return g().c_(n)?g().Tj((0,m().P)()).start_time:S().vM}var j=n.n(n(32485)),w=()=>n(906745),I=()=>n(546174),k=()=>n(401497),T=()=>n(718827),C=()=>n(631524),_=()=>n(382607),P=()=>n(100622),B=()=>n(209199),R=()=>n(534177),D=()=>n(284371),L=()=>n(541181),E=()=>n(807778),O=()=>n(498140),N=()=>n(515872);const F=Object.freeze({backgroundColor:P().oZ.blue,color:P().oZ.white}),U=Object.freeze({backgroundColor:P().IF.blueWithAlpha(.43)});function z(e,t){switch(e){case y().dz.InvalidDate:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidDateError.tooltip",defaultMessage:"Invalid date"});case y().dz.InvalidRange:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidDateOrTimeRangeError.tooltip",defaultMessage:"Invalid range"});case y().dz.InvalidTime:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidTimeError.tooltip",defaultMessage:"Invalid time"})}}function K(e,t,n){return void 0===e||"relative"===e||"ll"===e?S().WA(Y(n,t)):S().c1(e)}function V(e,t){return e&&(e!==S().jk||t)?S().B4(e):S()._g}function q(){return(0,f().X)(d().locale).time}function W(e,t,n){return(0,O().FM)(e,V(t,!1),n)}function G(e,t,n,i,s){return a().A.isMobile?(0,O().yc)(e,g().tr,t):(0,O().yc)(e,K(n,t,s),t)}function H(e,t,n,i){return!e||"number"==typeof e&&isNaN(e)?t&&(0,N().J)(t)?function(e,t){var n,i;const s=(null==t||null===(n=t.getPropertyTypeSpecificConfig("date"))||void 0===n?void 0:n.endDate)??!1,o=(null==t||null===(i=t.getPropertyTypeSpecificConfig("date"))||void 0===i?void 0:i.includeTime)??!1,a=g().vF({timezone:(0,m().P)()});if(s&&o)return g().NC(a.startOf("day").valueOf(),a.startOf("day").valueOf(),(0,m().P)());if(s)return g().Mk(a.valueOf(),a.valueOf(),(0,m().P)());if(o)return g().Xo(a.startOf("day"));return e}(n,i):n:e}function Y(e,t){return e||t.locale}function $(e,t,n){return"date"===e.type?{...e,type:"daterange",end_date:t||e.start_date}:"datetime"===e.type?{...e,type:"datetimerange",end_date:t||e.start_date,end_time:n||e.start_time}:void(0,R().HB)(e)}const Q=(0,h().YK)({todayButtonLabel:{id:"datePicker.todayButton.label",defaultMessage:"Today"},nowButtonLabel:{id:"datePicker.nowButton.label",defaultMessage:"Now"},previousMonthLabel:{id:"datePicker.previousMonth.label",defaultMessage:"Go to previous month"},nextMonthLabel:{id:"datePicker.nextMonth.label",defaultMessage:"Go to next month"}});function Z({store:e,dateValue:t,disabled:n,firstDayOfWeek:s,onChangeValue:o}){const r=(0,c().Tf)(),u=(0,l().K8)((()=>(0,E().D$)()),[]),{focus:p,currentMonth:f}=(0,l().K8)((()=>({focus:e.state.focus,currentMonth:e.state.currentMonth})),[e]),v=(0,k().IS)((()=>({container:{textAlign:"center",...a().A.isMobile?{padding:"16px 14px 16px",background:P().Tj.popoverBackground,...!r&&{borderBottom:`1px solid ${P().Tj.border.secondaryTranslucent}`}}:{padding:`0 ${_().Qm}px`}},todayButton:{minWidth:43,maxWidth:80,height:20,padding:"0 8px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},button:{background:"none",border:"none",cursor:"pointer",padding:0,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:3},navButtonSize:{width:20,height:20},navButton:{width:"11px",height:"17px",color:P().oZ.uiGray}})),[r]),b=g().AA(t,(0,m().P)()),M=f||b.start,A=b.start.toJSDate(),O=p===y().xQ.StartDate||p===y().xQ.StartTime,N=(0,i.useCallback)((({day:i,activeModifiers:s,domEvent:a,datePreset:r})=>{if(n)return;const l=g().T_((0,m().P)()),d=w().DateTime.fromJSDate(i).setLocale(S().M5).toFormat(g().tr);if(a.shiftKey&&(S().$P(t)||S().Ar(t))){const n=$(t,d);return null==o||o(n),void e.setState({...e.state,focus:y().xQ.EndDate})}let c;if(S().oM(t)||S().L3(t)){p===y().xQ.StartDate||p===y().xQ.StartTime?c={...t,start_date:d,..."now"===r?{start_time:l.start_time}:{}}:p===y().xQ.EndDate||p===y().xQ.EndTime?c={...t,end_date:d,..."now"===r?{end_time:l.start_time}:{}}:(0,R().HB)(p);const n=g().AA(c,(0,m().P)());n.end<n.start&&(S().oM(c)?c={...c,start_date:c.end_date,end_date:c.start_date}:S().L3(c)?c={...c,start_date:c.end_date,start_time:c.end_time,end_date:c.start_date,end_time:c.start_time}:(0,R().HB)(c),e.setState({...e.state,focus:p===y().xQ.StartDate||p===y().xQ.StartTime?y().xQ.EndDate:y().xQ.StartDate})),e.setState({...e.state,focus:p===y().xQ.StartDate||p===y().xQ.StartTime?y().xQ.EndDate:y().xQ.StartDate})}else c={...t,start_date:d,..."now"===r?{start_time:l.start_time}:{}};return e.setState({...e.state,error:{...e.state.error,[p]:void 0},inputTemporaryValue:{...e.state.inputTemporaryValue,[p]:void 0}}),null==o||o(c),c}),[t,n,p,o,e]),z=(0,i.useCallback)(((e,t,n)=>{N({day:e,activeModifiers:t,domEvent:n})}),[N]),K=(0,i.useCallback)((t=>{e.setState({...e.state,currentMonth:w().DateTime.fromJSDate(t)})}),[e]),V=(0,i.useMemo)((()=>{if(b.end){const e=b.end.toJSDate();return{modifiers:{range:{from:A,to:e},...O?{end:e,start:A}:{start:A,end:e}},modifiersStyles:{range:{backgroundColor:"transparent"},start:O?F:U,end:O?U:F}}}return{selected:A,modifiers:{start:A},modifiersStyles:{start:F}}}),[b.end,A,O]),q=(0,i.useCallback)((e=>{const n=S().Ar(t)||S().L3(t),i=n?Q.nowButtonLabel:Q.todayButtonLabel;return(0,x.jsx)("div",{className:"notion-calendar-caption",children:(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[(0,x.jsx)(I().$J,{displayMonth:e.displayMonth}),(0,x.jsxs)("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[(0,x.jsx)(C().p,{onClick:e=>{K(w().DateTime.now().toJSDate());const t=n?"now":"today";N({day:w().DateTime.now().toJSDate(),domEvent:e,datePreset:t})},colorPalette:"gray",style:{...v.button,...v.todayButton,fontSize:12,fontWeight:D().Wy.medium},children:(0,x.jsx)(h().sA,{...i})}),(0,x.jsx)(T().Ay,{onClick:()=>K(w().DateTime.fromJSDate(e.displayMonth).minus({months:1}).toJSDate()),style:{...v.button,...v.navButtonSize},"aria-label":Q.previousMonthLabel.defaultMessage,children:(0,B().A1)()?(0,x.jsx)(I()._l,{style:v.navButton}):(0,x.jsx)(I().Bu,{style:v.navButton})}),(0,x.jsx)(T().Ay,{onClick:()=>K(w().DateTime.fromJSDate(e.displayMonth).plus({months:1}).toJSDate()),style:{...v.button,...v.navButtonSize},"aria-label":Q.nextMonthLabel.defaultMessage,children:(0,B().A1)()?(0,x.jsx)(I().Bu,{style:v.navButton}):(0,x.jsx)(I()._l,{style:v.navButton})})]})]})})}),[v.button,v.navButtonSize,v.todayButton,v.navButton,K,t,N]);return(0,x.jsx)("div",{style:v.container,children:u?(0,x.jsx)(L().n,{className:"notion-date-property-menu notranslate",components:{Caption:q},numberOfMonths:1,weekStartsOn:s,defaultMonth:M.toJSDate(),month:M.toJSDate(),locale:d().locale,showOutsideDays:!0,fixedWeeks:!0,onDayClick:z,onMonthSelected:K,...V}):(0,x.jsx)(L().n,{className:j()("notion-date-property-menu notranslate",{"notion-date-property-menu--rtl":(0,B().A1)()}),numberOfMonths:1,weekStartsOn:s,defaultMonth:M.toJSDate(),month:M.toJSDate(),locale:d().locale,showOutsideDays:!0,fixedWeeks:!0,onDayClick:z,onMonthSelected:K,...V})})}function X({onChangeValue:e}){const t=(0,i.useCallback)((()=>{null==e||e(void 0)}),[e]);return(0,x.jsx)(b().A,{focused:!1,onClick:t,title:(0,x.jsx)(h().sA,{defaultMessage:"Clear",id:"LuxonDatePropertyMenu.clearButton.label"})})}n(581454);var J=()=>n(250910),ee=()=>n(114912),te=()=>n(663639);function ne({dateFormat:e,onChangeDateFormat:t}){const n=(0,h().tz)(),s=e||S().vz,o=(0,i.useCallback)((e=>{null==t||t(e)}),[t]),r=(0,i.useCallback)((e=>(0,x.jsx)(ee()._,{...e,focused:!1,title:(0,x.jsx)(h().sA,{defaultMessage:"Date format",id:"LuxonDatePropertyMenu.menuItem.format.label"}),showExtensionArrow:a().A.isMobile,chevronType:"right",right:s?n.formatMessage(S().xz[s]):(0,x.jsx)(h().sA,{defaultMessage:"Empty",id:"LuxonDatePropertyMenu.formatMenu.emptyButton.label"})})),[s,n]);return(0,x.jsx)(J().A,{popupType:a().A.isMobile?J().z.BottomSheet:J().z.Popup,bottomSheetInitialState:"half",placementToOrigin:"right",renderOrigin:r,render:e=>{const t=S().wJ.map((t=>({key:t,action:()=>{o(t),e.close()},render:e=>(0,x.jsx)(b().A,{...e,title:n.formatMessage(S().xz[t]),isChecked:t===s})})));let i={menuType:c().gu.Popup};return a().A.isMobile&&(i={menuType:c().gu.Modal,title:(0,x.jsx)(h().sA,{defaultMessage:"Date format",id:"LuxonDatePropertyMenu.mobileDateFormatModal.title"})}),(0,x.jsx)(u().A,{...i,children:(0,x.jsx)(te().A,{type:te().O.Vertical,initialFocus:void 0,sections:[{key:"date format section",render:e=>(0,x.jsx)(p().A,{...e}),items:t}]})})}})}function ie({dateValue:e,onChangeValue:t}){const n=(0,i.useCallback)((()=>{if("datetimerange"===e.type){const n={type:"datetime",start_date:e.start_date,start_time:e.start_time,time_zone:e.time_zone,reminder:e.reminder};null==t||t(n)}else if("daterange"===e.type){const n={type:"date",start_date:e.start_date,reminder:e.reminder};null==t||t(n)}else{const n=$(e);null==t||t(n)}}),[e,t]);return(0,x.jsx)(b().A,{focused:!1,onClick:n,title:(0,x.jsx)(h().sA,{defaultMessage:"End date",id:"LuxonDatePropertyMenu.menuItem.endDate.label"}),right:(0,x.jsx)(v().A,{on:"daterange"===e.type||"datetimerange"===e.type,onClick:n})})}var se=()=>n(31511),oe=()=>n(26697),ae=()=>n(720665);const re=12;function le({store:e,disabled:t,locale:n,surface:s,dateFormat:o,timeFormat:d,dateValue:c,formQuestionStore:u,onChangeValue:p}){const f=(0,r().v3)(),{device:v,WindowSizeStore:b}=f,M=(0,h().tz)(),{focus:A,inputTemporaryValue:j,error:w}=(0,l().K8)((()=>({focus:e.state.focus,inputTemporaryValue:e.state.inputTemporaryValue,error:e.state.error})),[e]),{formQuestionHasEndDate:I,formQuestionIncludesTime:T}=(0,l().K8)((()=>{var e,t;return{formQuestionHasEndDate:(null==u||null===(e=u.getPropertyTypeSpecificConfig("date"))||void 0===e?void 0:e.endDate)??!1,formQuestionIncludesTime:(null==u||null===(t=u.getPropertyTypeSpecificConfig("date"))||void 0===t?void 0:t.includeTime)??!1}}),[u]),C=(0,i.useMemo)((()=>g().AA(c,(0,m().P)(),Y(n,M))),[c,n,M]),B=s&&(0,N().J)(s)?T:"datetime"===c.type||"datetimerange"===c.type,D=s&&(0,N().J)(s)?I:"daterange"===c.type||"datetimerange"===c.type,L=(0,i.useCallback)((()=>{const t=e.state.inputTemporaryValue.startDate;if(!t)return;const i=G(t,M,o,0,n);if(!i)return y().dz.InvalidDate;const s={...c,start_date:i},a=g().Dz(s);if(!a)return y().dz.InvalidRange;e.setState({...e.state,currentMonth:a.start,error:{...e.state.error,[y().xQ.StartDate]:void 0},inputTemporaryValue:{...e.state.inputTemporaryValue,[y().xQ.StartDate]:void 0}}),null==p||p(s)}),[o,c,f,M,n,p,e]),E=(0,i.useCallback)((()=>{const t=e.state.inputTemporaryValue.startTime;if(!t)return;const n=W(t,d,M);if(!n)return y().dz.InvalidTime;if(S().L3(c)){const{newDate:t,currentMonth:i}=g().uj({previous:c,updatedStartTime:n});e.setState({...e.state,currentMonth:i,error:{...e.state.error,[y().xQ.StartTime]:void 0,[y().xQ.EndDate]:void 0,[y().xQ.EndTime]:void 0},inputTemporaryValue:{...e.state.inputTemporaryValue,[y().xQ.StartTime]:void 0}}),null==p||p(t)}else{if(!S().Ar(c))return y().dz.InvalidTime;{const t={...c,start_time:n},i=g().Dz(t);e.setState({...e.state,currentMonth:i.start,error:{...e.state.error,[y().xQ.StartTime]:void 0},inputTemporaryValue:{...e.state.inputTemporaryValue,[y().xQ.StartTime]:void 0}}),null==p||p(t)}}}),[c,M,p,e,d]),O=(0,i.useCallback)((()=>{const t=e.state.inputTemporaryValue.endDate;if(!t)return;const i=G(t,M,o,0,n);if(!i)return y().dz.InvalidDate;if(!S().oM(c)&&!S().L3(c))return;const s={...c,end_date:i},a=g().Dz(s);if(!a)return y().dz.InvalidRange;e.setState({...e.state,currentMonth:a.end,error:{...e.state.error,[y().xQ.EndDate]:void 0},inputTemporaryValue:{...e.state.inputTemporaryValue,[y().xQ.EndDate]:void 0}}),null==p||p(s)}),[o,c,f,M,n,p,e]),F=(0,i.useCallback)((()=>{const t=e.state.inputTemporaryValue.endTime;if(!t)return;const n=W(t,d,M);if(!n)return y().dz.InvalidTime;if(!S().L3(c))return;const i={...c,end_time:n},s=g().Dz(i);if(!s)return y().dz.InvalidRange;e.setState({...e.state,currentMonth:s.end,error:{...e.state.error,[y().xQ.EndTime]:void 0},inputTemporaryValue:{...e.state.inputTemporaryValue,[y().xQ.EndTime]:void 0}}),null==p||p(i)}),[c,M,p,e,d]),U=(0,i.useCallback)((()=>{e.setState({...e.state,focus:y().xQ.StartDate,inputIsFocused:!0,currentMonth:C.start})}),[C.start,e]),z=(0,i.useCallback)((()=>{e.setState({...e.state,focus:y().xQ.StartTime,inputIsFocused:!0,currentMonth:C.start})}),[C.start,e]),K=(0,i.useCallback)((()=>{C.end&&e.setState({...e.state,focus:y().xQ.EndDate,inputIsFocused:!0,currentMonth:C.end})}),[C.end,e]),V=(0,i.useCallback)((()=>{C.end&&e.setState({...e.state,focus:y().xQ.EndTime,inputIsFocused:!0,currentMonth:C.end})}),[C.end,e]),q=(0,i.useCallback)((()=>{let t;if(e.state.focus===y().xQ.StartDate)t=L();else if(e.state.focus===y().xQ.StartTime)t=E();else if(e.state.focus===y().xQ.EndDate)t=O();else{if(e.state.focus!==y().xQ.EndTime)return(0,R().HB)(e.state.focus);t=F()}t?e.setState({...e.state,error:{...e.state.error,[e.state.focus]:t}}):e.setState({...e.state,inputTemporaryValue:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0},inputIsFocused:!1,error:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0}})}),[O,F,L,E,e]),H=(0,i.useCallback)((t=>{e.setState({...e.state,inputTemporaryValue:{...e.state.inputTemporaryValue,[e.state.focus]:t.target.value||""}}),v.isAndroid&&q()}),[v.isAndroid,q,e]),[$,Q]=(0,l().K8)((()=>[a().A.isMobile?b.getSafePaddingLeftCSS(16):_().Qm,a().A.isMobile?b.getSafePaddingRightCSS(16):_().Qm]),[b]),Z=(0,k().IS)((()=>({container:{paddingTop:a().A.isMobile?16:8,paddingBottom:a().A.isMobile?16:8,paddingInlineStart:$,paddingInlineEnd:Q,display:B?"block":"flex",...a().A.isMobile&&{boxShadow:`\n                            0 1px 0 ${P().Tj.border.secondaryTranslucent}\n                        `,position:"relative",zIndex:2},background:a().A.isMobile?P().Tj.popoverBackground:void 0}})),[$,Q,B]);return(0,x.jsxs)("div",{style:Z.container,children:[(0,x.jsx)(de,{inputDateValue:j.startDate,inputTimeValue:j.startTime,rangeValue:C.start,disabled:t,dateError:w.startDate,timeError:w.startTime,isDateFocused:A===y().xQ.StartDate,isTimeFocused:A===y().xQ.StartTime,hasTime:B,hasEndDate:D,locale:n,dateFormat:o,timeFormat:d,onChange:H,onDateFocus:U,onTimeFocus:z,onBlur:q,onSubmit:q}),D?(0,x.jsx)("div",{style:{width:12,height:8}}):void 0,C.end?(0,x.jsx)(de,{inputDateValue:j.endDate,inputTimeValue:j.endTime,rangeValue:C.end,disabled:t,dateError:w.endDate,timeError:w.endTime,isDateFocused:A===y().xQ.EndDate,isTimeFocused:A===y().xQ.EndTime,hasTime:B,hasEndDate:D,locale:n,dateFormat:o,timeFormat:d,onChange:H,onDateFocus:K,onTimeFocus:V,onBlur:q,onSubmit:q}):void 0]})}function de({inputDateValue:e,inputTimeValue:t,rangeValue:n,disabled:s,dateError:l,timeError:d,isDateFocused:c,isTimeFocused:u,hasTime:p,hasEndDate:m,locale:f,dateFormat:y,timeFormat:v,onChange:b,onDateFocus:M,onTimeFocus:A,onBlur:j,onSubmit:w}){const I=(0,r().Y0)(),T=(0,h().tz)(),C=(0,R().O9)(l)||(0,R().O9)(d),_=c||u,B=(0,o().X)("ios_date_picker_input_fix"),D=(0,k().IS)((()=>({input:ce(I,C,_,m,B),separator:{height:14,width:1,background:P().Tj.border.secondaryTranslucent,marginInlineStart:6,marginInlineEnd:12,flexShrink:0}})),[I,C,_,m,B]),L=(0,i.useCallback)((()=>z(l,T)),[l,T]),E=(0,i.useCallback)((()=>z(d,T)),[d,T]),O=(0,i.useCallback)((()=>{if(a().A.isMobile){const t=(0,ae().pN)(e)?n.toFormat(g().tr):e;return(0,x.jsx)(se().A,{type:I.isIOS&&B?"text":"date",format:"transparent",value:I.isIOS&&B?n.toFormat(K(y,T,f)):t,onChange:b,onFocus:M,onBlur:j,onSubmit:w,onCancel:w,disabled:s,size:1})}{const t=(0,ae().pN)(e)?n.toFormat(K(y,T,f)):e;return(0,x.jsx)(se().A,{selectAll:!0,format:"transparent",value:t,focusInitial:c,onChange:b,onFocus:M,onBlur:j,onSubmit:w,onCancel:w,disabled:s,size:1})}}),[y,I.isIOS,s,j,b,M,w,e,T,c,f,n,B]),N=(0,i.useCallback)((()=>{const e=I.isIOS&&B?{paddingTop:10}:void 0;if(a().A.isMobile){const i=(0,ae().pN)(t)?n.toFormat(S().GE):t;return(0,x.jsx)(se().A,{type:"time",format:"transparent",value:i,onChange:b,onFocus:A,onBlur:j,onSubmit:w,onCancel:w,size:1,disabled:s,style:e})}{const i=(0,ae().pN)(t)?n.toFormat(V(v,!1)):t;return(0,x.jsx)(se().A,{format:"transparent",value:i,focusInitial:u,onChange:b,onFocus:A,onBlur:j,onSubmit:w,onCancel:w,size:1,disabled:s,style:e})}}),[I.isIOS,B,s,j,b,w,A,t,u,n,v]);return(0,x.jsxs)("div",{style:D.input,children:[(0,x.jsx)(oe().m,{renderTooltip:L,originGap:re,forceVisibleState:(0,R().O9)(l),placement:"left",render:O}),p?(0,x.jsx)("div",{style:D.separator}):void 0,p?(0,x.jsx)(oe().m,{renderTooltip:E,originGap:re,forceVisibleState:(0,R().O9)(d),placement:"right",render:N}):void 0]})}function ce(e,t,n,i,s){return{display:"flex",alignItems:"center",borderRadius:6,height:28,lineHeight:1.2,paddingInlineStart:8,paddingInlineEnd:8,flexBasis:"50%",flexGrow:1,fontSize:a().A.isMobile?16:14,...e.isIOS&&s&&{verticalAlign:"middle"},...t?{background:P().IF.redWithAlpha(.15),boxShadow:`inset 0 0 0 2px ${P().oZ.red}`}:n&&i?{background:P().IF.blueWithAlpha(.15),boxShadow:`inset 0 0 0 2px ${P().oZ.blue}`}:{background:P().Tj.inputBackground,boxShadow:P().Tj.inputBoxShadow}}}var ue=()=>n(656704),pe=()=>n(869190),ge=()=>n(496603),me=()=>n(314529);function fe({dateValue:e,onChangeValue:t,defaultReminder:n}){const s=(0,r().v3)(),l=(0,h().tz)(),d=(0,o().X)("enable_no_reminder_setting"),g=(0,i.useCallback)((n=>{S().Mb(n)?d?null==t||t({...e,reminder:n}):null==t||t({...e,reminder:void 0}):S().fc(n)?null==t||t({...e,reminder:{...n,defaultTimeZone:(0,m().P)()}}):"datetime"!==e.type&&"datetimerange"!==e.type||null==t||t({...e,reminder:n}),function(e,t){(0,me().DO_NOT_USE_trackLegacy)(e,"set_reminder",{date:t.date,reminder:t.reminder})}(s,{date:e,reminder:n})}),[e,s,t,d]),f=(0,i.useCallback)((t=>(0,x.jsx)(ee()._,{...t,title:(0,x.jsx)(h().sA,{defaultMessage:"Remind",id:"LuxonDatePropertyMenu.menuItem.remind.label"}),focused:!1,showExtensionArrow:a().A.isMobile,chevronType:"right",right:(0,ue().y)({reminder:void 0===e.reminder?n:e.reminder,intl:l,formatTime:pe().fU})})),[e.reminder,l,n]),y=(0,i.useCallback)((t=>{let i;i=a().A.isMobile?{menuType:c().gu.Modal,title:(0,x.jsx)(h().sA,{defaultMessage:"Remind",id:"LuxonDatePropertyMenu.mobileRemindModal.title"})}:{menuType:c().gu.Popup,width:250};const s=("date"===e.type||"daterange"===e.type?S().vK:S().SA).map((i=>{const s=(0,ue().y)({reminder:i,shouldShowTime:!0,intl:l,formatTime:pe().fU});return{key:s,action:()=>{g(i),t.close()},render:t=>{let o;return o=void 0===e.reminder?void 0===n?S().Mb(i):ge().n4(i,n):S().Mb(e.reminder)?S().Mb(i):ge().n4(i,e.reminder),(0,x.jsx)(b().A,{...t,title:s,isChecked:o})}}}));return(0,x.jsx)(u().A,{...i,children:(0,x.jsx)(te().A,{type:te().O.Vertical,sections:[{key:"reminder section",render:e=>(0,x.jsx)(p().A,{...e}),items:s}],initialFocus:void 0})})}),[e.type,e.reminder,l,g,n]);return(0,x.jsx)(J().A,{popupType:a().A.isMobile?J().z.BottomSheet:J().z.Popup,bottomSheetInitialState:"half",placementToOrigin:"right",renderOrigin:f,render:y})}var he=()=>n(232930),ye=()=>n(962036),ve=()=>n(64901);function be(){return a().A.isMobile?(0,x.jsx)(ve().A,{href:(0,he().x)("guides.reminders"),analyticsFrom:"date_selector"}):(0,x.jsx)(ye().g,{title:(0,x.jsx)(h().sA,{defaultMessage:"Learn about reminders",id:"LuxonDatePropertyMenu.learnMore.helpButton.label"}),href:(0,he().x)("guides.reminders"),analyticsFrom:"date_selector"})}function Se({dateValue:e,timeFormat:t,onChangeTimeFormat:n}){const s=(0,h().tz)(),o="date"===e.type||"daterange"===e.type,r=V(t,!0),l=function(e){const t=V(e,!0),n=q();for(const i in n)if(n[i]===t)return i;return"12h"}(t),d=q(),g=(0,i.useCallback)((e=>{const t=d[e];null==n||n(t)}),[n,d]),m=(0,i.useCallback)((e=>(0,x.jsx)(ee()._,{...e,focused:!1,title:(0,x.jsx)(h().sA,{defaultMessage:"Time format",id:"LuxonDatePropertyMenu.menuItem.timeFormat.label"}),disabled:o,showExtensionArrow:a().A.isMobile,chevronType:"right",right:!o&&(r?s.formatMessage(S().px[l]):(0,x.jsx)(h().sA,{defaultMessage:"Empty",id:"LuxonDatePropertyMenu.timeFormatMenu.emptyButton.label"}))})),[s,o,l,r]);if(o)return null;return(0,x.jsx)(J().A,{popupType:a().A.isMobile?J().z.BottomSheet:J().z.Popup,bottomSheetInitialState:"half",placementToOrigin:"right",renderOrigin:m,render:e=>{const t=S().ZD.map((t=>({key:t,action:()=>{g(t),e.close()},render:e=>(0,x.jsx)(b().A,{...e,title:s.formatMessage(S().px[t]),isChecked:t===l})})));let n={menuType:c().gu.Popup};return a().A.isMobile&&(n={menuType:c().gu.Modal,title:(0,x.jsx)(h().sA,{defaultMessage:"Time format",id:"LuxonDatePropertyMenu.mobileTimeFormatModal.title"})}),(0,x.jsx)(u().A,{...n,children:(0,x.jsx)(te().A,{type:te().O.Vertical,initialFocus:void 0,sections:[{key:"time format section",render:e=>(0,x.jsx)(p().A,{...e}),items:t}]})})}})}var xe=()=>n(891793);function Me(e){const{dateValue:t,onChangeValue:n}=e,s="date"===t.type||"daterange"===t.type,o="datetime"===t.type||"datetimerange"===t.type?t.time_zone:(0,m().P)(),r=(0,i.useCallback)((e=>{if("datetime"===t.type||"datetimerange"===t.type){const i={...t,time_zone:e};null==n||n(i)}}),[t,n]);return s?null:(0,x.jsx)(xe().G,{enableRecents:!0,placementToOrigin:"right",currentValue:o,onSelect:r,renderOrigin:e=>(0,x.jsx)(ee()._,{...e,title:(0,x.jsx)(h().sA,{defaultMessage:"Timezone",id:"datePropertyMenuFormatAndTimezone.timezone.label"}),focused:!1,right:!s&&g().GF(o),showExtensionArrow:a().A.isMobile,chevronType:"right"})})}var Ae=()=>n(173979),je=()=>n(877750);function we(e){const{onChangeValue:t}=e,n=(0,h().tz)();return(0,x.jsx)(p().A,{title:(0,x.jsx)(h().sA,{defaultMessage:"Shortcuts",id:"DatePropertyMenu.menuItem.shortcuts.label"}),children:["now","today"].map((e=>(0,x.jsx)(b().A,{title:(0,x.jsx)(je().W,{templateVariableType:e}),caption:(0,Ae().EC)(e,n),inline:!0,onClick:()=>{null==t||t(e)},focused:!1},`relative-date-shortcut-${e}`)))})}const Ie=i.memo((function(e){const t=(0,l().uB)(void 0,y().Ay),{inputIsFocused:i}=(0,l().O$)(t);return(0,n(691298).A)({shouldPreserveTextSelection:!0,shouldPreserveBlockSelection:!0,shouldRestoreSelection:!0}),(0,x.jsx)(s().A,{debugName:"DatePropertyMenu",capture:i,allowEsc:!0,children:(0,x.jsx)(s().A,{debugName:"DatePropertyMenu",allowEsc:!0,capture:!0,allowUndo:!0,children:(0,x.jsx)(ke,{store:t,...e})})})}));function ke(e){const{store:t,value:s,header:y,isTemplatePage:v,shouldShowReminder:b,shouldShowControls:S=!0,canConfigureCollection:A,disabled:j,surface:w,dateFormat:I,timeFormat:k,defaultReminder:T,firstDayOfWeek:C,formQuestionStore:_,onChangeValue:P,onChangeDateFormat:B,onChangeTimeFormat:R}=e,D=(0,i.useMemo)((()=>g().Ec((0,m().P)())),[]),L=(0,l().K8)((()=>H(s,w,D,_)),[s,w,D,_]),E=(0,l().K8)((()=>t.state.inputIsFocused),[t]),O=(0,i.useMemo)((()=>a().A.isMobile?{menuType:c().gu.Modal,title:(0,x.jsx)(h().sA,{defaultMessage:"Date",id:"LuxonDatePropertyMenu.mobileDate.title"}),left:b?(0,x.jsx)(be,{}):void 0,header:(0,x.jsx)(p().A,{children:(0,x.jsx)(le,{store:t,disabled:j,locale:d().locale,surface:w,dateFormat:I,timeFormat:k,dateValue:L,formQuestionStore:_,onChangeValue:P})}),includeFixedHeaderSpacing:!0,scrollerStyle:{paddingBottom:n(838364).H}}:{menuType:c().gu.Popup,maxHeight:"none",width:"min-content",header:y}),[I,L,j,w,_,y,P,b,t,k]),N=!f().V.includes(d().locale),F=(0,r().Y0)(),U=(0,o().X)("ios_date_picker_input_fix"),z=E&&!(F.isIOS&&U);return(0,x.jsxs)(u().A,{...O,children:[(0,x.jsx)(n(797324).A,{show:z}),v?(0,x.jsx)(we,{onChangeValue:P}):void 0,(0,x.jsxs)(p().A,{topBorder:v,children:[a().A.isMobile?void 0:(0,x.jsx)(le,{store:t,disabled:j,locale:d().locale,surface:w,dateFormat:I,timeFormat:k,dateValue:L,formQuestionStore:_,onChangeValue:P}),(0,x.jsx)(Z,{store:t,dateValue:L,firstDayOfWeek:C,disabled:j,onChangeValue:P})]}),j?void 0:(0,x.jsxs)(x.Fragment,{children:[b||S?(0,x.jsxs)(p().A,{topBorder:!0,children:[S?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(ie,{dateValue:L,onChangeValue:P}),A?(0,x.jsx)(ne,{dateFormat:I,onChangeDateFormat:B}):void 0,(0,x.jsx)(M,{dateValue:L,onChangeValue:P}),A&&N?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(Se,{dateValue:L,timeFormat:k,onChangeTimeFormat:R}),(0,x.jsx)(Me,{dateValue:L,onChangeValue:P})]}):void 0]}):void 0,b?(0,x.jsx)(fe,{dateValue:L,onChangeValue:P,defaultReminder:T}):void 0]}):void 0,(0,x.jsx)(p().A,{topBorder:!0,children:(0,x.jsx)(X,{onChangeValue:P})}),!a().A.isMobile&&b?(0,x.jsx)(p().A,{topBorder:!0,children:(0,x.jsx)(be,{})}):void 0]})]})}},525700:(e,t,n)=>{n.d(t,{Bp:()=>R,DD:()=>U,E9:()=>J,F$:()=>Z,H6:()=>C,HE:()=>_,HY:()=>D,JI:()=>G,Nf:()=>H,U0:()=>F,V_:()=>Y,XL:()=>z,Xz:()=>K,aD:()=>P,aN:()=>W,d7:()=>q,d8:()=>I,j4:()=>$,n0:()=>Q,pu:()=>O,sd:()=>V,uH:()=>L,uY:()=>X,wl:()=>B,yF:()=>N,zV:()=>T});n(944114),n(898992),n(354520),n(581454),n(296540);var i=()=>n(726637),s=()=>n(128933),o=()=>n(68263),a=()=>n(161479),r=()=>n(101628),l=()=>n(245241),d=()=>n(69708),c=()=>n(496603),u=()=>n(769864),p=()=>n(496414),g=()=>n(384944),m=()=>n(594794),f=()=>n(752860),h=()=>n(976721),y=()=>n(562800),v=()=>n(547149),b=()=>n(40226),S=()=>n(380682),x=()=>n(300451),M=()=>n(676870),A=()=>n(435212),j=n(474848);const w=(0,d().YK)({savingSiteSettings:{id:"siteSettingsActions.publishingSiteSettings.loadingMessage",defaultMessage:"Saving site settings…"}});function I(e){const{environment:t,store:n,type:i,header:s,domainId:o,settings:l}=e,d=n.getSiteStore();if(d)return d.id;let c=o;var u;c||(c=null===(u=y().Nq(n.getSpaceStore()))||void 0===u?void 0:u.id);const p=(0,m().JH)({environment:t,table:r().Eu,spaceId:(0,a().e)(n.getSpaceId())});v().createAndCommit({userAction:"publishSite.create",environment:t,canUndo:!0,perform:e=>{const o=g().vt({environment:t,table:p.table,args:{id:p.id,type:i,spaceId:p.spaceId,blockId:n.id,domainId:c,currentUserId:t.currentUser.id,header:s??{},settings:l??{}},inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,transaction:e});return g().zv({store:n.getFormatStore(),data:{site_id:o.id},transaction:e}),o.id}})}function k(e){const{environment:t,siteRootBlockStore:n,domainId:i}=e;let s=n.getSiteStore();if(s||(I({environment:t,type:"site",store:n,domainId:i}),s=n.getSiteStore()),s)return s}function T(e){const{environment:t,domainId:n,resetWatermark:i}=e,o=k(e);o&&o.isDefined()&&(v().createAndCommit({userAction:"publishSite.updatePublicDomain",environment:t,canUndo:!0,perform:e=>{o.getDomainId()!==n&&v().applyOperation({transaction:e,store:o,operation:o.getModel().ops.updatePublicDomainId({domainId:n,currentUserId:t.currentUser.id})})}}),v().createAndCommit({userAction:"publishSite.resetWatermark",environment:t,canUndo:!0,perform:e=>{if(i){const n=o.getHeader();v().applyOperation({transaction:e,store:o,operation:o.getModel().ops.updateHeader({header:{...n,hideWatermark:!1},currentUserId:t.currentUser.id})})}}}),s().D6({label:(0,j.jsx)(d().sA,{id:"publishSiteSettings.publicDomain.confirmation",defaultMessage:"Successfully updated domain for all pages within this site"})}))}function C(e){const{environment:t,siteRootBlockStore:n,isSearchEngineIndexingEnabled:i}=e,s=k(e);if(!s)return;"form"!==s.getType()&&v().createAndCommit({userAction:"publishSite.updateSeoEnabled",environment:t,canUndo:!0,perform:e=>{s&&s.isDefined()&&i!==s.isSearchEngineIndexingEnabled()&&(v().applyOperation({transaction:e,store:s,operation:s.getModel().ops.updateIsSearchEngineIndexingEnabled({isSearchEngineIndexingEnabled:i,currentUserId:t.currentUser.id})}),i&&e.postSubmitCallbacks.push((async e=>{e||await u().callApi({eventName:"enqueueScanContentTask",environment:t,data:{pagePointer:{id:n.id,table:"block",spaceId:(0,a().e)(n.pointer.spaceId)}}})})))}})}function _(e){const{environment:t,store:n,seoTitle:i,seoDescription:o}=e;v().createAndCommit({userAction:"publishSite.create",environment:t,canUndo:!0,perform:e=>{const a=n.getFormat().seo_title,r=n.getFormat().seo_description;a===i&&r===o||(g().zv({store:n.getFormatStore(),data:{seo_title:i,seo_description:o},transaction:e}),(0,M().NZ)(t,{target_block_id:n.id,new_title:i??null,new_description:o??null}),s().D6({label:(0,j.jsx)(d().sA,{id:"siteSettingsEditor.publishSeoChanges.confirmation",defaultMessage:"Successfully updated the SEO settings"})}))}})}function P(e){x().A.setState({...x().A.state,settingOpen:e})}function B(){x().A.setState({...x().A.state,settingOpen:"initial"})}function R(e){S().A.setState({...S().A.state,siteSettingContentType:e})}function D(e){var t,n,i;const{siteRootBlockStore:s,permissionItem:o,from:a,sudoModeStore:r}=e,l=s.getSiteStore(),d=null==l?void 0:l.getHeader(),c=(null==d||null===(t=d.customItems)||void 0===t?void 0:t.map((e=>e.blockId)))||[];x().A.setState({settingOpen:"initial",permissionItem:o,from:a,sudoModeStore:r,faviconUrl:(null==l?void 0:l.getFaviconUrl())||null,previewImageUrl:(null==l?void 0:l.getPreviewImageUrl())||null,hideBreadcrumbs:null==d?void 0:d.hideBreadcrumbs,hideLikeButton:null==d?void 0:d.hideLikeButton,hideSearch:null==d?void 0:d.hideSearch,hideShare:null==d?void 0:d.hideShare,hideWatermark:null==d?void 0:d.hideWatermark,enableDuplicateAsTemplate:o.allow_duplicate,customHeaderBlockIds:c,googleAnalyticsId:null==l?void 0:l.getGoogleAnalyticsId(),theme:null==l||null===(n=l.getSettings())||void 0===n?void 0:n.theme,hideUpsellBanner:null==l||null===(i=l.getSettings())||void 0===i?void 0:i.hideUpsellBanner})}async function L(e){var t;const{environment:n,store:i,siteRootBlockStore:a}=e,r=k({environment:n,siteRootBlockStore:a}),l=null==r?void 0:r.getType();if(!r||"form"===l)return;const c=x().A.getState(),u={},g=function(e,t){var n,i,s,o,a,r,l,d,c;const u=E(e.customHeaderBlockIds,null===(n=t.getHeader())||void 0===n?void 0:n.customItems);return e.faviconUrl!==(t.getFaviconUrl()||null)||e.previewImageUrl!==(t.getPreviewImageUrl()||null)||u||e.hideBreadcrumbs!==(null===(i=t.getHeader())||void 0===i?void 0:i.hideBreadcrumbs)||e.hideSearch!==(null===(s=t.getHeader())||void 0===s?void 0:s.hideSearch)||e.hideShare!==(null===(o=t.getHeader())||void 0===o?void 0:o.hideShare)||e.hideLikeButton!==(null===(a=t.getHeader())||void 0===a?void 0:a.hideLikeButton)||e.hideWatermark!==(null===(r=t.getHeader())||void 0===r?void 0:r.hideWatermark)||e.googleAnalyticsId!==t.getGoogleAnalyticsId()||e.theme!==(null===(l=t.getSettings())||void 0===l?void 0:l.theme)||e.hideUpsellBanner!==(null===(d=t.getSettings())||void 0===d?void 0:d.hideUpsellBanner)||(null===(c=e.permissionItem)||void 0===c?void 0:c.allow_duplicate)!==e.enableDuplicateAsTemplate&&e.permissionItem&&e.from}(c,r);if(!g)return;p().m({message:w.savingSiteSettings});const{serverCommitResult:m}=v().createAndCommit({userAction:"publishSite.updateSiteSettingsInEditor",environment:n,canUndo:!0,perform:e=>{if(r&&r.isDefined()){var t,i;(r.getFaviconUrl()||null)!==c.faviconUrl&&(v().applyOperation({transaction:e,store:r,operation:r.getModel().ops.updateFaviconUrl({faviconUrl:c.faviconUrl,currentUserId:n.currentUser.id})}),u.favicon=c.faviconUrl);(r.getPreviewImageUrl()||null)!==c.previewImageUrl&&(v().applyOperation({transaction:e,store:r,operation:r.getModel().ops.updatePreviewImageUrl({previewImageUrl:c.previewImageUrl,currentUserId:n.currentUser.id})}),u.preview_image=c.previewImageUrl);const s=r.getHeader();let o=s;const a=E(c.customHeaderBlockIds,null==s?void 0:s.customItems);a&&(o={...o,customItems:a},u.custom_headers=a.map((e=>e.blockId))),(null==s?void 0:s.hideBreadcrumbs)!==c.hideBreadcrumbs&&(o={...o,hideBreadcrumbs:c.hideBreadcrumbs},u.hide_breadcrumbs=c.hideBreadcrumbs),(null==s?void 0:s.hideLikeButton)!==c.hideLikeButton&&(o={...o,hideLikeButton:c.hideLikeButton},u.hide_like_button=c.hideLikeButton),(null==s?void 0:s.hideSearch)!==c.hideSearch&&(o={...o,hideSearch:c.hideSearch},u.hide_search=c.hideSearch),(null==s?void 0:s.hideShare)!==c.hideShare&&(o={...o,hideShare:c.hideShare},u.hide_share=c.hideShare),(null==s?void 0:s.hideWatermark)!==c.hideWatermark&&(o={...o,hideWatermark:c.hideWatermark},u.hide_watermark=c.hideWatermark),o&&s!==o&&v().applyOperation({transaction:e,store:r,operation:r.getModel().ops.updateHeader({header:o,currentUserId:n.currentUser.id})});r.getGoogleAnalyticsId()!==c.googleAnalyticsId&&(v().applyOperation({transaction:e,store:r,operation:r.getModel().ops.updateGoogleAnalyticsId({googleAnalyticsId:c.googleAnalyticsId,currentUserId:n.currentUser.id})}),u.google_analytics_id=c.googleAnalyticsId);(null===(t=r.getSettings())||void 0===t?void 0:t.theme)!==c.theme&&(v().applyOperation({transaction:e,store:r,operation:r.getModel().ops.updateTheme({theme:c.theme,currentUserId:n.currentUser.id})}),u.theme=c.theme);(null===(i=r.getSettings())||void 0===i?void 0:i.hideUpsellBanner)!==c.hideUpsellBanner&&v().applyOperation({transaction:e,store:r,operation:{pointer:r.pointer,command:"update",path:["settings"],args:{hideUpsellBanner:c.hideUpsellBanner}}})}}});try{await m}catch{return p().V(),void s().D6({label:(0,j.jsx)(d().sA,{id:"siteSettingsEditor.publishChanges.failure",defaultMessage:"Something went wrong, please try again later"})})}if((null===(t=c.permissionItem)||void 0===t?void 0:t.allow_duplicate)!==c.enableDuplicateAsTemplate&&c.permissionItem&&c.from){const e=(0,o().Yi)(c.from);if(!(await(0,h().Hc)({oldPermissionItem:c.permissionItem,newPermissionItem:{...c.permissionItem,allow_duplicate:c.enableDuplicateAsTemplate},wasInherited:e!==i.id,environment:n,store:i,sudoModeStore:c.sudoModeStore,location:"published_site_settings"})))return p().V(),void s().D6({label:(0,j.jsx)(d().sA,{id:"siteSettingsEditor.publishChanges.failure",defaultMessage:"Something went wrong, please try again later"})});u.enable_duplicate_as_template=c.enableDuplicateAsTemplate}p().V(),(0,A().Kz)(n,{settings_changed:u}),s().D6({label:(0,j.jsx)(d().sA,{id:"siteSettingsEditor.publishChanges.confirmation",defaultMessage:"Changes published"})})}function E(e,t){const n=e.map((e=>({type:"block",blockId:e})));if((t||0!==n.length)&&(!t||!(0,c().n4)(n,t)))return n}function O(e){x().A.setState({...x().A.state,faviconUrl:e})}function N(e){x().A.setState({...x().A.state,previewImageUrl:e})}function F(e){x().A.setState({...x().A.state,hideLikeButton:e})}function U(e){x().A.setState({...x().A.state,hideBreadcrumbs:e})}function z(e){x().A.setState({...x().A.state,hideSearch:e})}function K(e){x().A.setState({...x().A.state,hideWatermark:e})}function V(e){x().A.setState({...x().A.state,hideShare:e})}function q(e){x().A.setState({...x().A.state,enableDuplicateAsTemplate:e})}function W(e){const t=x().A.state.customHeaderBlockIds.concat([e]);x().A.setState({...x().A.state,customHeaderBlockIds:t})}function G(e){const t=x().A.state.customHeaderBlockIds.filter((t=>t!==e));x().A.setState({...x().A.state,customHeaderBlockIds:t})}function H(e){x().A.setState({...x().A.state,googleAnalyticsId:e})}function Y(e){x().A.setState({...x().A.state,theme:e})}async function $(e){const{environment:t,spaceStore:n,query:i,siteRootBlockId:s}=e;if(!n)return;const o=await u().callApi({eventName:"searchPagesInSite",environment:t,data:{query:i,spaceId:n.id,filters:l().N2({isDeletedOnly:!1,navigableBlockContentOnly:!0,excludeTemplates:!0,editedBy:[],ancestors:[s],inTeams:[]}),sort:{field:"relevance"},limit:10,source:"sites_custom_header_builder_search"}});return"failed"!==o.type?o.data:void 0}async function Q(e){const{environment:t,blockStore:n,slug:o}=e,a=await u().callApi({eventName:"updatePublicPageSlug",environment:t,data:{spaceId:n.getSpaceId(),blockId:n.id,slug:o,clientVersion:i().A.version}});if("success"!==a.type)return{error:a};s().D6({label:(0,j.jsx)(d().sA,{id:"customSlugInput.updateSuccess.toast",defaultMessage:"Successfully updated URL for this page"})})}function Z(e){x().A.setState({...x().A.state,hideUpsellBanner:e})}function X(e){const{environment:t,store:n,pageVisitSource:i}=e,s=b().R({store:n,pageVisitSource:i});(0,f().L)({environment:t,url:s})}function J(e){const{environment:t,siteStore:n,embedSettings:i}=e;v().createAndCommit({userAction:"embedSite.updateEmbedSettings",environment:t,canUndo:!0,perform:e=>{g().zv({store:n.getSettingsStore(),data:{embedSettings:i},transaction:e})}})}},534606:(e,t,n)=>{n.d(t,{a:()=>s});var i=()=>n(44551);async function s(){return i().electronApi&&i().electronApi.isMainTab?i().electronApi.isMainTab():!i().electronApi||!i().electronApi.isMainWindow||i().electronApi.isMainWindow()}},536612:(e,t,n)=>{n.d(t,{A:()=>s});class i extends(()=>n(959180))().A{}const s=new i},540459:(e,t,n)=>{n.d(t,{G:()=>r});n(296540);var i=()=>n(160432),s=()=>n(26697),o=()=>n(69708),a=n(474848);function r(e){const{tooltip:t,disabled:n,onClick:r}=e;return(0,a.jsx)(s().m,{disableTooltip:!Boolean(t),renderTooltip:()=>t,render:e=>(0,a.jsx)(i().A,{colorPalette:"blue",size:"lg",style:{marginInlineStart:8,borderRadius:6,paddingInlineStart:12,paddingInlineEnd:12},disabled:n,onClick:r,...e,children:(0,a.jsx)(o().sA,{id:"shareMenu.inviteButton.invite",defaultMessage:"Invite"})})})}},541146:(e,t,n)=>{n.r(t),n.d(t,{OutlinerDropdownMenuButton:()=>de,useSortActions:()=>fe});n(898992),n(354520),n(803949),n(581454);var i=n(296540),s=()=>n(564884),o=()=>n(907258),a=()=>n(755531),r=()=>n(59226),l=()=>n(248140),d=()=>n(726637),c=()=>n(484714),u=()=>n(792485),p=()=>n(590526),g=()=>n(401497),m=()=>n(440375),f=()=>n(718827),h=()=>n(250910),y=()=>n(807449),v=()=>n(546926),b=()=>n(890492),S=()=>n(736847),x=()=>n(582684),M=()=>n(349679),A=()=>n(126617),j=()=>n(212727),w=()=>n(813197),I=()=>n(617668),k=()=>n(946065),T=()=>n(955104),C=()=>n(69708),_=()=>n(100622),P=()=>n(534177),B=()=>n(636714),R=()=>n(12956),D=()=>n(267271),L=()=>n(899963),E=()=>n(439549),O=()=>n(664713),N=()=>n(396301),F=()=>n(957606),U=()=>n(288157),z=()=>n(644914),K=()=>n(655923),V=()=>n(112282),q=()=>n(384944),W=()=>n(575143),G=()=>n(47373),H=()=>n(547149),Y=()=>n(923455),$=n(474848);const Q=(0,C().YK)({move:{id:"useMoveSidebarAction.title.moveSection",defaultMessage:"Move section"},moveUp:{id:"useMoveSidebarAction.option.moveUp",defaultMessage:"Move up"},moveDown:{id:"useMoveSidebarAction.option.moveDown",defaultMessage:"Move down"}});var Z=()=>n(226627),X=()=>n(484392),J=()=>n(599813),ee=()=>n(804666),te=()=>n(76726),ne=()=>n(229508),ie=()=>n(465031);const se=(0,C().YK)({removeFromSidebar:{id:"useRemoveSidebarSectionAction.removeFromSidebar",defaultMessage:"Remove from sidebar"},removeFromSidebarCaption:{id:"useRemoveSidebarSectionAction.removeFromSidebar.caption",defaultMessage:"You can always access all {sectionName} pages in the Library"},removeFromSidebarCaptionPrivate:{id:"useRemoveSidebarSectionAction.removeFromSidebar.caption.private",defaultMessage:"You can always access all Private pages in the Library"},removeFromSidebarCaptionShared:{id:"useRemoveSidebarSectionAction.removeFromSidebar.caption.shared",defaultMessage:"You can always access all Shared pages in the Library"},removeFromSidebarCaptionFavorites:{id:"useRemoveSidebarSectionAction.removeFromSidebar.caption.favorites",defaultMessage:"You can always access all Favorited pages in the Library"},removeFromSidebarCaptionNotionApps:{id:"useRemoveSidebarSectionAction.removeFromSidebar.caption.notionApps",defaultMessage:"You can manage Notion apps from settings at any time."}});function oe(e,t){switch(t){case"private":return e.formatMessage(se.removeFromSidebarCaptionPrivate);case"shared":return e.formatMessage(se.removeFromSidebarCaptionShared);case"favorites":return e.formatMessage(se.removeFromSidebarCaptionFavorites);case"myMeetings":return e.formatMessage(se.removeFromSidebarCaption,{sectionName:"Meetings"});default:return e.formatMessage(se.removeFromSidebarCaption,{sectionName:(0,X().A)(t)})}}var ae=()=>n(852678),re=()=>n(465960);const le=(0,C().YK)({manual:{id:"outlinerDropdownMenuButton.sort.manual",defaultMessage:"Manual"},lastEdited:{id:"outlinerDropdownMenuButton.sort.lastEdited",defaultMessage:"Last edited"}});function de(e){const{type:t,spaceViewStore:n}=e,o=(0,c().v3)(),a=(0,g().IS)((()=>({button:{display:"flex",alignItems:"center",justifyContent:"center",height:20,width:20,borderRadius:4}})),[]),r=(0,i.useCallback)((()=>{ae().A.setState({open:!0}),function(e,t){const{outliner_type:n}=t;(0,s().u)({environment:e,event:{eventName:"open_outliner_section_menu",eventProperties:{outliner_type:n,...(0,z().hX)({environment:e})}}})}(o,{outliner_type:N().BP[t]})}),[o,t]),l=(0,i.useCallback)((()=>{ae().A.setState({open:!1})}),[]),u=(0,C().tz)().formatMessage({id:"outlinerDropdownMenuButton.ariaLabel",defaultMessage:"Open menu"});return n?(0,$.jsx)(h().A,{popupType:h().z.Popup,alignmentToOrigin:"start",renderOrigin:e=>(0,$.jsx)(f().Ay,{style:a.button,ariaLabel:u,...e,children:(0,$.jsx)(y().I,{icon:A().ellipsisSmallIcon,size:"sm",colorVariant:d().A.isMobile?"tertiary":"secondary"})}),onClick:r,onClose:l,render:e=>(0,$.jsx)(me,{type:t,spaceViewStore:n,onClose:()=>{e.close()}}),originGap:2}):null}const ce=(0,C().YK)({sort:{id:"outlinerDropdownMenu.sort",defaultMessage:"Sort"},truncationLimit:{id:"outlinerDropdownMenu.truncationLimit",defaultMessage:"Show"},addTeam:{id:"outlinerDropdownMenu.addTeam",defaultMessage:"New teamspace"}}),ue=(0,C().YK)({label:{id:"outlinerDropdownMenu.setupExperience.label",defaultMessage:"Setup experience [dev]"},production:{id:"outlinerDropdownMenu.setupExperience.production",defaultMessage:"🏭 Production"},productionDescription:{id:"outlinerDropdownMenu.setupExperience.productionDescription",defaultMessage:"Current custom agent setup experience for production users."},development:{id:"outlinerDropdownMenu.setupExperience.development",defaultMessage:"🛠️ Development"},developmentDescription:{id:"outlinerDropdownMenu.setupExperience.developmentDescription",defaultMessage:"Work in progress experience that “flippy” (chat side-by-side with custom agent settings) and custom agent self-setup and testing."},wildWest:{id:"outlinerDropdownMenu.setupExperience.wildWest",defaultMessage:"🤠 Wild west"},wildWestDescription:{id:"outlinerDropdownMenu.setupExperience.wildWestDescription",defaultMessage:"“Flippy” UX and self-setup using script agent."}}),pe=["production","development","wild_west"],ge={production:{custom_agent_flippy_layout:!1,agent_thread_tools:!1,agent_script_agent:!1,agent_script_agent_advanced:!1,custom_agent_setup_mode_tool:!1},development:{custom_agent_flippy_layout:!0,agent_thread_tools:!1,agent_script_agent:!1,agent_script_agent_advanced:!1,custom_agent_setup_mode_tool:!0},wild_west:{custom_agent_flippy_layout:!0,agent_thread_tools:!1,custom_agent_setup_mode_tool:!1,agent_script_agent:!0,agent_script_agent_advanced:!1}};function me(e){const{type:t,spaceViewStore:n,onClose:s}=e,a=(0,c().v3)(),d=(0,p().O$)(o().AppStoreCurrentUserSettingsStore),f=(0,C().tz)(),h=(0,g().IS)((()=>({rightText:{fontSize:12,color:_().Tj.text.secondary}})),[]),A=(0,p().K8)((()=>(0,N().RQ)({spaceViewStore:n,type:t,userSettingsStore:d})),[n,t,d]),O=A.sortOption,z=A.truncationLimit,X="shared"===t,ae=(0,U().wu)(),de=(0,U().Km)(),me=X||"private"===t||"teamspaces"===t||"agents"===t||"meetings_today"===t||"myMeetings"===t||"favorites"===t&&ae||"recents"===t&&de,ye="private"===t||"shared"===t,ve=!(0,p().O$)(m().l),be=(0,p().K8)((()=>{const{sidebarSpaceStore:e}=o().default.state;return!!e&&(0,F().sx)({environment:a,spaceStore:e})}),[a]),Se=ve&&"teamspaces"===t&&be,xe=fe({type:t,onSelect:s,spaceViewStore:n,outlinerLocation:"sidebar"}),Me=function(e){const{type:t,spaceViewStore:n,onSelect:i,enableLibrarySidebarSections:s}=e,a=(0,p().O$)(o().AppStoreCurrentUserSettingsStore),r=(0,c().v3)(),l=(0,g().IS)((()=>({right:{width:16}})),[]),d=(0,p().K8)((()=>(0,N().RQ)({type:t,spaceViewStore:n,userSettingsStore:a}).truncationLimit),[t,n,a]),u="recents"===t?k().AQ.filter((e=>e!==k().xz)):k().AQ;return u.map((e=>(0,D().Ls)({key:e.toString(),displayName:void 0,analyticsName:e.toString(),validators:[],closeParentMenu:!0,action:()=>{H().createAndCommit({userAction:"OutlinerDropdownMenuButton.setTruncationLimit",environment:r,canUndo:!0,perform:i=>{E().c2({environment:r,transaction:i,spaceViewStore:n,update:{type:"truncationLimit",value:e},sectionType:t})}}),T().u4({name:"update_sidebar_section_option",args:{option:"show",type:t}}),L().nT(r,{outliner_type:N().BP[t],option:e,before_option:d,are_library_sidebar_sections_enabled:s}),i()},render:t=>(0,$.jsx)(W().A,{...t,title:(0,$.jsx)(he,{limit:e,withItems:!0}),right:d===e&&(0,$.jsx)(y().I,{icon:M().checkmarkSmallIcon,size:"sm"}),rightStyle:l.right})})))}({type:t,onSelect:s,spaceViewStore:n,enableLibrarySidebarSections:ae}),Ae=function(e){const{onSelect:t}=e,n=(0,r().X)("custom_agent_flippy_layout"),s=(0,r().X)("agent_thread_tools"),o=(0,r().X)("agent_script_agent"),a=(0,r().X)("agent_script_agent_advanced"),d=(0,r().X)("custom_agent_setup_mode_tool"),c=(0,C().tz)(),u=(0,i.useMemo)((()=>{for(const e of pe){const{custom_agent_flippy_layout:t,agent_thread_tools:i,agent_script_agent:r,custom_agent_setup_mode_tool:l,agent_script_agent_advanced:c}=ge[e];if(t===n&&i===s&&r===o&&l===d&&c===a)return e}}),[s,n,o,d,a]),p=(0,g().IS)((()=>({right:{width:16}})),[]),m=(0,i.useCallback)((e=>{switch(e){case"production":return c.formatMessage(ue.production);case"development":return c.formatMessage(ue.development);case"wild_west":return c.formatMessage(ue.wildWest);default:return(0,P().HB)(e)}}),[c]),f=(0,i.useCallback)((e=>{switch(e){case"production":return c.formatMessage(ue.productionDescription);case"development":return c.formatMessage(ue.developmentDescription);case"wild_west":return c.formatMessage(ue.wildWestDescription);default:return(0,P().HB)(e)}}),[c]);return pe.map((e=>(0,D().Ls)({key:e,displayName:void 0,analyticsName:e,validators:[],closeParentMenu:!0,action:()=>{(0,P().WP)(ge[e]).forEach((([e,t])=>{l().A.updateLocalOverrideGate(e,t)})),t()},render:t=>(0,$.jsx)(W().A,{...t,title:m(e),caption:f(e),shouldWrapCaption:!0,right:u===e&&(0,$.jsx)(y().I,{icon:M().checkmarkSmallIcon,size:"sm"}),rightStyle:p.right})})))}({onSelect:s}),je="agents"===t&&!1,we=function(e){const{type:t,onSelect:n}=e,i=(0,p().O$)(o().AppStoreSidebarSpaceStore),s=(0,p().O$)(o().AppStoreSidebarSpaceViewStore),{currentUserRootStore:a,currentUserStore:r}=(0,p().K8)((()=>({currentUserRootStore:o().default.state.currentUserRootStore,currentUserStore:o().default.state.currentUserStore})),[]),l=(0,C().tz)(),d=(0,Y().Rx)(),c=(null==d?void 0:d.sidebarOrder)??[],u=(0,p().K8)((()=>(0,G().i3)({spaceStore:i,spaceViewStore:s,userRootStore:a,currentUserStore:r})),[i,a,r,s]),g=(0,N().KP)({sidebarOrder:c,sidebarState:d,showLockedSidebar:u});if(!s)return[];const m=g.indexOf(t),f=0===m,h=m===g.length-1,y=(null==d?void 0:d.shownSidebarSectionCount)??0;return["moveUp","moveDown"].map((e=>{const i=Q[e];return(0,D().Ls)({key:e,displayName:void 0,analyticsName:i.defaultMessage,validators:[()=>y>1],closeParentMenu:!0,action:({environment:i})=>{const o=function({sidebarSection:e,selectedMoveOption:t,sidebarOrder:n,visibleSidebarOrder:i}){const s=[...n],o=n.indexOf(e),a=i.indexOf(e);if("moveUp"===t&&a>0){const t=i[a-1];s[n.indexOf(t)]=e,s[o]=t}if("moveDown"===t&&a<i.length-1){const t=i[a+1];s[n.indexOf(t)]=e,s[o]=t}return s}({sidebarSection:t,selectedMoveOption:e,sidebarOrder:c,visibleSidebarOrder:g});H().createAndCommit({userAction:`useMoveSidebarAction.${e}`,environment:i,canUndo:!0,perform:e=>{q().zv({store:s,data:{sidebar_order:o},transaction:e})}}),L().ub(i,{section:t,previous_order:c,new_order:o,from:"outliner_section_menu"}),n()},render:t=>{const n="moveUp"===e&&f||"moveDown"===e&&h,s="moveUp"===e?V().arrowStraightUpIcon:K().arrowStraightDownIcon;return(0,$.jsx)(W().A,{...t,disabled:n,disabledFeedback:n,title:l.formatMessage(i),svg:s})}})}))}({type:t,onSelect:s}),Ie=function(e){const{type:t,onSelect:n}=e,i=(0,c().v3)(),s=(0,ne().a)(),o=(0,C().tz)(),a=(0,U().wu)(),r=(0,p().K8)((()=>{var e;if(!a)return;if(!((0,ee().a0)(t)||"teamspaces"===t&&(0,U().a1)()))return;const n=Z().L.fromSpaceViewStore(null==s||null===(e=s.getSpaceStore())||void 0===e?void 0:e.getSpaceIdCreator(),s,t);return null!=n&&n.isDefined()?n:void 0}),[a,s,t]),l=(0,p().K8)((()=>null==r?void 0:r.getSectionType()),[r]);if("notion_apps"===t){const e=se.removeFromSidebar;return[(0,D().Ls)({key:"removeFromSidebar",displayName:e,analyticsName:e.defaultMessage,validators:[],closeParentMenu:!0,action:()=>{ie().nQ(i),n()},render:t=>(0,$.jsx)(W().A,{...t,shouldWrapCaption:!0,title:o.formatMessage(e),caption:o.formatMessage(se.removeFromSidebarCaptionNotionApps),svg:J().xMarkIcon})})]}if(!r||!l)return[];const d=se.removeFromSidebar;return[(0,D().Ls)({key:"removeFromSidebar",displayName:d,analyticsName:d.defaultMessage,validators:[],closeParentMenu:!0,action:()=>{(0,te().rx)({environment:i,eventProperties:{visibility_after_change:"hidden",section_type:l,from:"outliner_section_menu"}}),H().createAndCommit({userAction:"useRemoveSidebarSectionAction.removeFromSidebar",environment:i,canUndo:!0,perform:e=>{const t=r.getPropertiesStore().getKeyStore("hidden");q().KY({transaction:e,store:t,value:!0})}}),n()},render:e=>(0,$.jsx)(W().A,{...e,shouldWrapCaption:!0,title:o.formatMessage(d),caption:oe(o,t),svg:J().xMarkIcon})})]}({type:t,onSelect:s}),ke=ye||me||we.length>0,Te=[(0,R().u)({key:"sort",displayName:ce.sort,analyticsName:ce.sort.defaultMessage,validators:[()=>ye],svg:x().arrowUpDownIcon,right:f.formatMessage(le[O]),rightStyle:h.rightText,subActions:()=>[(0,D().gy)({key:"sort",render:e=>(0,$.jsx)(S().A,{...e}),actions:xe})]}),(0,R().u)({key:"truncationLimit",displayName:ce.truncationLimit,analyticsName:ce.truncationLimit.defaultMessage,validators:[()=>me],svg:w().L,right:(0,$.jsx)(he,{limit:z}),rightStyle:h.rightText,subActions:()=>[(0,D().gy)({key:"truncationLimit",render:e=>(0,$.jsx)(S().A,{...e}),actions:Me})]}),...we,(0,R().u)({key:"setupExperience",displayName:ue.label,analyticsName:ue.label.defaultMessage,validators:[()=>je],svg:j().gearIcon,width:420,subActions:()=>[(0,D().gy)({key:"setupExperience",render:e=>(0,$.jsx)(S().A,{...e}),actions:Ae})]})],Ce=[(0,D().gy)({key:"all",render:e=>(0,$.jsx)(S().A,{...e}),actions:Te}),(0,D().gy)({key:"removeFromSidebar",render:e=>(0,$.jsx)(S().A,{...e,topBorder:ke,topBorderExtendToEdge:ke}),actions:Ie}),(0,D().gy)({key:"addTeam",render:e=>(0,$.jsx)(S().A,{...e}),actions:[(0,D().Ls)({key:"addTeam",displayName:ce.addTeam,analyticsName:ce.addTeam.defaultMessage,validators:[()=>Se],svg:I().plusIcon,closeParentMenu:!0,action:()=>{(0,re().vn)("sidebar_team_section"),s()}})]})],_e=(0,u().S)();return(0,$.jsx)(b().A,{menuType:v().gu.Popup,minWidth:220,children:(0,$.jsx)(B().A,{context:{blocks:[],environment:a,publicEditMode:void 0,pageContext:_e},sections:Ce,initialFocus:void 0})})}function fe(e){const{type:t,spaceViewStore:n,onSelect:i,outlinerLocation:s}=e,l=(0,c().v3)(),d=(0,C().tz)(),{sidebarSpaceStore:u,currentUserSettingsStore:m}=(0,p().K8)((()=>({sidebarSpaceStore:(0,a().S)(),currentUserSettingsStore:o().default.state.currentUserSettingsStore})),[]),f=l.currentUser.id,h=(0,r().X)("sidebar_add_new_pages_to_bottom"),v=(0,p().K8)((()=>(0,N().RQ)({type:t,spaceViewStore:n,userSettingsStore:m}).sortOption),[t,n,m]),b=(0,g().IS)((()=>({right:{width:16}})),[]);return["manual","lastEdited"].map((e=>{const o=le[e];return(0,D().Ls)({key:e,displayName:void 0,analyticsName:o.defaultMessage,validators:[],closeParentMenu:!0,action:async()=>{H().createAndCommit({userAction:"OutlinerDropdownMenuButton.setSortOption",environment:l,canUndo:!0,perform:i=>{E().c2({environment:l,transaction:i,spaceViewStore:n,update:{type:"sortOption",value:e},sectionType:t})}}),"manual"===e&&"shared"===t&&!h&&f&&u&&await O().Z({environment:l,spaceId:u.id,userId:f}),T().u4({name:"update_sidebar_section_option",args:{option:"sort",type:t}}),L().Rf(l,{outliner_type:N().BP[t],outliner_location:s,option:e}),i()},render:t=>(0,$.jsx)(W().A,{...t,title:d.formatMessage(o),right:v===e&&(0,$.jsx)(y().I,{icon:M().checkmarkSmallIcon,size:"sm"}),rightStyle:b.right})})}))}function he(e){const{withItems:t}=e,n=(0,k().Fl)(e.limit);return t?(0,$.jsx)(C().sA,{id:"outlinerDropdownMenuButton.truncationLimit",defaultMessage:"{limit} items",values:{limit:n}}):(0,$.jsx)("span",{children:n})}},542371:(e,t,n)=>{n.d(t,{A:()=>i});class i extends(()=>n(757695))().Store{getInitialState(){}}},552945:(e,t,n)=>{n.d(t,{g:()=>f});n(944114),n(296540);var i=()=>n(907258),s=()=>n(590526),o=()=>n(401497),a=()=>n(249046),r=()=>n(265060),l=()=>n(26697),d=()=>n(842599),c=()=>n(13966),u=()=>n(69708),p=()=>n(235921),g=()=>n(620641),m=n(474848);function f(e){const{joinableSpaces:t,formSpaceId:n,isReimaginedStyles:f,joinContext:h="onboarding"}=e,y=(0,o().IS)((()=>({firstOrMiddleSection:{marginBottom:25},helpButton:{cursor:"pointer"}})),[]),v=(0,s().K8)((()=>{var e,t;const{onboardingData:n}=p().A.state,s=(null==n||null===(e=n.userStore)||void 0===e?void 0:e.getEmail())??(null===(t=i().default.state.currentUserStore)||void 0===t?void 0:t.getEmail());return s?(0,d().zN)(s):void 0}),[]),b=[],S=[];let x;for(const i of t)n&&i.id===n?x=i:i.guestPageIds.length>0?b.push(i):S.push(i);return(0,m.jsxs)(m.Fragment,{children:[x?(0,m.jsx)(g().E,{joinableSpaces:[x],title:(0,m.jsx)(u().sA,{defaultMessage:"Join where form was created",id:"workspaceDiscovery.formResponseWorkspace.title"}),styles:y.firstOrMiddleSection,isReimaginedStyles:f,joinContext:h}):void 0,b.length>0?(0,m.jsx)(g().E,{joinableSpaces:b,title:(0,m.jsx)(u().sA,{defaultMessage:"Shared pages",id:"workspaceDiscovery.sharedWorkspaces.title"}),styles:y.firstOrMiddleSection,isReimaginedStyles:f,joinContext:h}):void 0,S.length>0?(0,m.jsx)(g().E,{joinableSpaces:S,title:(0,m.jsxs)(a().Ye,{alignItems:"center",gap:4,children:[(0,m.jsx)(u().sA,{defaultMessage:"Suggested workspaces",id:"workspaceDiscovery.suggestedSpaces.title"}),(0,m.jsx)(l().m,{renderTooltip:()=>(0,m.jsx)(u().sA,{defaultMessage:"Workspaces with {emailDomain} as a trusted email domain",id:"workspaceDiscovery.suggestedSpaces.tooltip",values:{emailDomain:v}}),placement:"bottom",render:e=>(0,m.jsx)("div",{style:y.helpButton,...e,children:(0,m.jsx)(r().Q,{iconGroup:c().H,variantName:"small",colorVariant:"secondary"})})})]}),isReimaginedStyles:f,joinContext:h}):void 0]})}},555367:(e,t,n)=>{n.r(t),n.d(t,{SidebarTeamModal:()=>Yn});n(581454);var i=n(296540),s=()=>n(664594),o=()=>n(907258),a=()=>n(265618),r=()=>n(782482),l=()=>n(726637),d=()=>n(484714),c=()=>n(590526),u=()=>n(401497),p=()=>n(611648),g=()=>n(107975),m=()=>n(882722),f=()=>n(981535),h=()=>n(699143),y=()=>n(970236),v=()=>n(493552),b=()=>n(463438),S=()=>n(505412),x=()=>n(69708),M=()=>n(100622),A=()=>n(496603),j=()=>n(534177),w=()=>n(284371),I=()=>n(946141),k=()=>n(957606),T=()=>n(632709),C=()=>n(465960),_=()=>n(341974),P=()=>n(345578),B=(n(944114),()=>n(933922)),R=()=>n(31511),D=()=>n(406094),L=()=>n(547149),E=()=>n(605685),O=()=>n(43450);function N(e){return!(0,O().R)(e)}var F=()=>n(976519),U=()=>n(211825),z=()=>n(418426),K=()=>n(655784),V=()=>n(235741),q=()=>n(388926),W=()=>n(144707),G=()=>n(755531),H=()=>n(47373),Y=(n(898992),n(354520),()=>n(135168)),$=()=>n(278238),Q=()=>n(273900),Z=()=>n(68263),X=()=>n(854150),J=()=>n(347160),ee=()=>n(213525),te=()=>n(898808),ne=()=>n(26697),ie=()=>n(404905),se=()=>n(396896),oe=()=>n(302501),ae=n(474848);function re(e){const{icon:t,label:n,name:i,tag:s,style:o}=e,a=(0,u().IS)((()=>({container:{display:"flex",flexDirection:"row",alignItems:"center",gap:10,...o},labelContainer:{display:"flex",flexDirection:"column",...w().RC,marginInlineStart:5},name:{minWidth:30}})),[o]);return(0,ae.jsxs)("div",{style:a.container,children:[t,(0,ae.jsxs)("div",{style:a.labelContainer,children:[(0,ae.jsxs)(se().fI,{gap:6,alignItems:"center",children:[(0,ae.jsx)(ie().j,{style:a.name,children:i}),s]}),n?(0,ae.jsx)(oe().A,{isSmall:!0,isSecondaryColor:!1,isMultiline:!0,children:(0,ae.jsx)(ie().j,{children:n})}):void 0]})]})}function le(e){const{iconComponent:t,label:n,name:i,permissionRoleSelectComponent:s,tag:o,tooltip:a,style:r}=e,l=(0,u().IS)((()=>({permissionRow:{display:"flex",flexDirection:"row",fontSize:14,width:"100%",minHeight:36,justifyContent:"space-between",alignItems:"center",...r}})),[r]);return(0,ae.jsxs)("div",{style:l.permissionRow,children:[(0,ae.jsx)(re,{icon:t,name:i,tag:o,label:n,style:{minWidth:200,marginInlineEnd:6}}),(0,ae.jsx)(ne().m,{textWrap:!0,style:{width:210},disableTooltip:!a,placement:"left",renderTooltip:()=>a,render:e=>(0,ae.jsx)("span",{...e,children:s})})]})}const de=12,ce=20;function ue(e){return(0,ae.jsxs)(h().Y1,{gap:10,children:[(0,ae.jsx)(v().D,{styleKey:"bodySemibold",colorVariant:"primary",children:e.title}),(0,ae.jsx)(pe,{...e})]})}function pe({rows:e,hideDividers:t=!1}){const n=(0,u().IS)((()=>({list:{listStyle:"none",padding:0,margin:0},listItem:{paddingTop:de,paddingBottom:de}})),[]);return(0,ae.jsx)("ul",{style:n.list,children:e.map(((e,s)=>(0,ae.jsxs)(i.Fragment,{children:[!t&&s>0?(0,ae.jsx)(q().A,{size:1}):void 0,(0,ae.jsx)("li",{style:n.listItem,children:e},s)]},s)))})}function ge(e){const{teamStore:t}=e,n=(0,d().v3)(),s=(0,x().tz)(),{teamGuestPermissionItem:o,teamPermissions:a}=(0,c().K8)((()=>({teamGuestPermissionItem:t.getTeamGuestsPermission(),teamPermissions:t.getPermissionItems()||[]})),[t]),r=N(t),l=(0,c().K8)((()=>(0,Y().f)(t)),[t]),p=(0,i.useMemo)((()=>[{role:"editor",disabledInfo:{isDisabled:!0,disabledMessage:s.formatMessage({id:"teamPermissionsSettings.teamspace.guest.disabledPermissionitem.description",defaultMessage:"Teamspace guests can't have full access."})}},{role:"read_and_write",disabledInfo:void 0},{role:"comment_only",disabledInfo:void 0},{role:"reader",disabledInfo:void 0}]),[s]),g=(0,u().IS)((()=>({button:{fontSize:12.5,marginInlineEnd:0,color:M().Tj.text.secondary}})),[]),m=o&&(0,ae.jsx)(J().Ay,{role:o.role,table:X().yK,spaceStore:l,type:"explicit_team_guest_permission",upgradeButtonName:"team_permission_item",disabled:r,buttonStyle:g.button,availableRoleItems:p,onChange:async e=>{if(a.filter((t=>((0,Z().B2)(t)||(0,Z().Ds)(t))&&(0,Q().dI)(e,t.role))).length>0){if(!(await(0,ee().fT)()))return}L().createAndCommit({userAction:"TeamGuestsPermissionRow.permissionComponent",environment:n,canUndo:!0,perform:i=>{C().HU({environment:n,teamStore:t,newRole:e,transaction:i,permissionsToClear:[]})}})}}),f=(0,c().K8)((()=>t.getName()),[t]),h=(0,c().K8)((()=>t.getIcon()),[t]),y=h&&$().T8(h.icon)?$().VA(h.icon):"gray",v=h?{...h,icon:`/icons/user-circle_${y}.svg`}:void 0,b=(0,ae.jsx)(te().x,{disabled:!0,store:t,size:ce,icon:v});return m?(0,ae.jsx)(le,{permissionRoleSelectComponent:m,iconComponent:b,name:me(f)}):null}function me(e){return e?(0,ae.jsx)(x().sA,{defaultMessage:"Teamspace guests",id:"TeamMembersTopSection.permissionItem.guest.defaultAccessTeamSpaceName",values:{teamName:e}}):(0,ae.jsx)(x().sA,{defaultMessage:"Teamspace guests",id:"TeamMembersTopSection.permissionItem.guest.defaultAccessWithoutTeamspaceName"})}n(672577);function fe(e){const{teamStore:t}=e,n=(0,d().v3)(),i=(0,x().tz)(),{teamPermissionItem:s,teamPermissions:o}=(0,c().K8)((()=>({teamPermissionItem:t.getTeamPermission(),teamPermissions:t.getPermissionItems()||[]})),[t]),a=(0,c().K8)((()=>(0,Y().f)(t)),[t]),r=N(t),l=(0,c().K8)((()=>{var e;const n=null===(e=t.getPermissionItems())||void 0===e?void 0:e.find((e=>"space_permission"===e.type)),s=i.formatMessage({id:"teamPermissionsSettings.teamspace.disabledPermissionitem.description",defaultMessage:"Teamspace members can't have lower permissions than workspace members"});function o(e){return n&&e!==n.role&&(0,Q().$q)(e,n.role)===n.role&&!t.isDefault()?{role:e,disabledInfo:{isDisabled:!0,disabledMessage:s}}:{role:e,disabledInfo:void 0}}return[o("editor"),o("read_and_write"),o("comment_only"),o("reader")]}),[i,t]),u=s&&(0,ae.jsx)(J().Ay,{role:s.role,table:X().yK,type:(0,Z().gl)(s)?"explicit_team_permission":"team_permission",spaceStore:a,upgradeButtonName:"team_permission_item",disabled:r,buttonStyle:{fontSize:12.5,marginInlineEnd:0,color:M().Tj.text.secondary},availableRoleItems:l,onChange:async e=>{const i=o.filter((t=>((0,Z().B2)(t)||(0,Z().Ds)(t))&&(0,Q().dI)(e,t.role)));if(i.length>0){if(!(await(0,ee().fT)()))return}L().createAndCommit({userAction:"TeamMembersPermissionRow.permissionComponent",environment:n,canUndo:!0,perform:s=>{C().xp({environment:n,teamStore:t,newRole:e,transaction:s,permissionsToClear:i})}})}}),p=(0,c().K8)((()=>t.getName()),[t]),g=(0,ae.jsx)(te().x,{disabled:!0,store:t,size:ce});return(0,ae.jsx)(le,{permissionRoleSelectComponent:u,iconComponent:g,name:he(p)})}function he(e){return e?(0,ae.jsx)(x().sA,{defaultMessage:"Teamspace members",id:"TeamMembersTopSection.permissionItem.defaultAccessTeamSpaceName"}):(0,ae.jsx)(x().sA,{defaultMessage:"Teamspace members",id:"TeamMembersTopSection.permissionItem.defaultAccessWithoutTeamspaceName"})}var ye=()=>n(106702),ve=()=>n(849255),be=()=>n(798880),Se=()=>n(350824),xe=()=>n(187820),Me=()=>n(453697),Ae=()=>n(466797);const je=ce,we=16;function Ie({ownerStores:e,teamStore:t,isSmall:n=!1}){const i=n?je:Ae().Ev,s=n?10:we,o=(0,u().IS)((()=>({container:{position:"relative",width:i,height:i},teamBadge:{position:"absolute",bottom:-5,insetInlineEnd:-3,background:M().Tj.background.elevated,padding:.75,borderRadius:"0.25em"}})),[i]),{teamName:a,teamIcon:r}=(0,c().K8)((()=>({teamName:t.getName(),teamIcon:t.getIcon()})),[t]),l=e=>(0,ae.jsx)(xe().B6,{disabled:!0,title:a,icon:r,isEmptyPage:!1,size:e,iconRecordCategory:"teamspace"});return 0===e.length?l(i):(0,ae.jsxs)("div",{style:o.container,children:[(0,ae.jsx)(ke,{isSmall:n,store:e[0]}),(0,ae.jsx)("div",{style:o.teamBadge,children:l(s)})]})}function ke({store:e,isSmall:t=!1,style:n={}}){const i=t?je:Ae().Ev,s=(0,u().IS)((()=>({icon:{width:i,height:i,borderRadius:i,boxShadow:M().Tj.avatarBoxShadow,...n}})),[i,n]);return(0,ae.jsx)("div",{style:s.icon,children:(0,ae.jsx)(Me().A,{avatarShouldShowShadow:!0,userStore:e,size:i})})}function Te(e){const{teamStore:t,teamOwnerIds:n}=e,i=(0,c().K8)((()=>t.getName()),[t]),s=(0,c().K8)((()=>t.getTeamOwnerPermission()),[t]),o=(0,c().K8)((()=>(0,Y().f)(t)),[t]),a=(0,ye().$)(),r=(0,c().K8)((()=>a?n.map((e=>ve().L.createChildStore(a,{table:be().oo,id:e}))):[]),[a,n]);return(0,ae.jsx)(le,{tooltip:(0,ae.jsx)(x().sA,{id:"TeamOwnersPermissionRow.teamspaceOwnersRowTooltip",defaultMessage:"Teamspace owners have full access to teamspace pages by default"}),permissionRoleSelectComponent:(0,ae.jsx)(J().Ay,{spaceStore:o,role:"editor",table:X().yK,type:s&&(0,Z().nl)(s)?"explicit_team_owner_permission":"team_owner_permission",upgradeButtonName:"team_owner_permission_item",disabled:!0,buttonStyle:{fontSize:12.5,color:M().Tj.text.secondary,marginInlineEnd:0},availableRoleItems:Se().KG}),iconComponent:(0,ae.jsx)(Ie,{teamStore:t,ownerStores:r,isSmall:!0}),name:Ce(i)})}function Ce(e){return e?(0,ae.jsx)(x().sA,{defaultMessage:"Teamspace owners",id:"TeamOwnersPermissionRow.permissionItem.teamspaceOwnersAccessToggleName"}):(0,ae.jsx)(x().sA,{defaultMessage:"Teamspace owners",id:"TeamOwnersPermissionRow.permissionItem.teamspaceOwnersAccessToggleNameWithoutTeamName"})}var _e=()=>n(574359),Pe=()=>n(807449),Be=()=>n(642557);const Re=["none","reader","comment_only","read_and_write","editor"],De=["reader","comment_only","read_and_write"],Le=["reader","comment_only","read_and_write","editor"],Ee=["editor"];function Oe(e){const t=function({teamId:e,permissions:t}){var n,i;const s=(null===(n=t.find((e=>(0,Z().Lg)(e))))||void 0===n?void 0:n.role)??"none",o=(null===(i=t.find((t=>(0,Z().gl)(t)&&t.team_id===e)))||void 0===i?void 0:i.role)??s,a=t.find((e=>(0,Z().un)(e)));return{spacePermission:{type:"space_permission",role:s},teamMemberPermission:{type:"explicit_team_permission",team_id:e,role:o},teamOwnerPermission:{type:"explicit_team_owner_permission",team_id:e,role:"editor"},...a&&{teamGuestPermission:{type:"explicit_team_guest_permission",team_id:e,role:a.role}}}}({teamId:e.id,permissions:e.permissions??[]}),{spacePermission:n,teamMemberPermission:i}=t,s={visibility:["team_members","space_members"],space_member_join_access:["invite_only","self_join"],invite_access:["team_members","team_owners"]},o={spacePermission:Fe({roles:Re,currentRole:i.role}),teamGuestPermission:De,teamMemberPermission:Ne({roles:Le,currentRole:n.role}),teamOwnerPermission:Ee},{visibility:a,space_member_join_access:r}=e.settings;return"team_members"===a&&(s.space_member_join_access=["invite_only"],o.spacePermission=["none"]),"self_join"===r&&(s.visibility=["space_members"],s.invite_access=["team_members"],o.spacePermission=o.spacePermission.filter((e=>"none"!==e))),e.is_default&&(o.teamMemberPermission=[i.role],o.spacePermission=[i.role]),{settingsOptions:s,permissionItemRoleOptions:o,currentTeamPermissionItems:t}}function Ne({roles:e,currentRole:t}){return e.filter((e=>(0,Q().Pr)(e,t)))}function Fe({roles:e,currentRole:t}){return e.filter((e=>(0,Q().Y1)(e,t)))}var Ue=()=>n(579627);function ze(e){const{teamStore:t}=e,n=(0,d().v3)(),i=(0,c().O$)(o().AppStoreSidebarSpaceStore),{iconComponent:s,spaceName:a}=(0,c().K8)((()=>{if(!i)return{iconComponent:void 0,spaceName:void 0};const e=(0,_e().G)(n,i);return{iconComponent:(0,ae.jsx)(te().x,{disabled:!0,store:i,size:ce}),spaceName:e}}),[i,n]);return(0,ae.jsx)(le,{permissionRoleSelectComponent:(0,ae.jsx)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:(0,ae.jsx)(Ve,{teamStore:t})}),iconComponent:s,name:Ke(a)})}function Ke(e){return e?(0,ae.jsx)(x().sA,{defaultMessage:"Everyone else in {spaceName}",id:"TeamMembersTopSection.permissionItem.defaultAccessSpaceName",values:{spaceName:e}}):(0,ae.jsx)(x().sA,{defaultMessage:"Everyone else in the workspace",id:"TeamMembersTopSection.permissionItem.defaultAccessWithoutSpaceName"})}function Ve(e){const{teamStore:t}=e,n=(0,d().v3)(),i=(0,c().K8)((()=>t.getSpacePermission()||{type:"space_permission",role:"none"}),[t]),s=(0,c().K8)((()=>(0,Y().f)(t)),[t]),o=N(t),a=(0,c().K8)((()=>{const e=t.getSettingsStore().getValue();if(e)return Oe({id:t.id,permissions:t.getPermissionItems(),settings:e,is_default:t.isDefault()})}),[t],{useDeepEqual:!0});if(!a)return null;const r=a.permissionItemRoleOptions.spacePermission;if(1===r.length&&"none"===r[0])return(0,ae.jsx)(ne().m,{renderTooltip:()=>(0,ae.jsx)(x().sA,{id:"teamPermissionsSettings.privateTeam.noAccessTooltip",defaultMessage:"Private teamspaces can only be accessed or joined by invitation"}),render:e=>(0,ae.jsxs)("div",{style:{display:"flex",alignItems:"center",maxWidth:170,gap:4,paddingInlineEnd:8},...e,children:[(0,ae.jsx)(Pe().I,{icon:Be().lockSmallIcon,size:"sm",colorPalette:"red",colorVariant:"accentPrimary"}),(0,ae.jsx)(v().D,{styleKey:"captionRegular",colorPalette:"red",colorVariant:"accentPrimary",children:(0,ae.jsx)(x().sA,{id:"teamPermissionsSettings.privateTeam.noAccessLabel",defaultMessage:"No access • Invite only"})})]})});{const e=A().Ul(r,(e=>-Z().TE[e])).map((e=>({role:e})));return(0,ae.jsx)(J().Ay,{spaceStore:s,role:i.role,table:X().yK,type:"space_permission",upgradeButtonName:"space_permission_item",disabled:o||1===r.length,buttonStyle:{fontSize:12,marginInlineEnd:0,color:M().Tj.text.secondary},availableRoleItems:e,onChange:e=>{const s={...i,role:e};L().createAndCommit({userAction:"TeamSpacePermissionRow.permissionComponent",environment:n,canUndo:!0,perform:e=>{Ue().bo({environment:n,store:t,permissionItems:[s],transaction:e})}})}})}}function qe({teamStore:e}){const t=(0,c().K8)((()=>e.isDefault()),[e]),n=(0,c().K8)((()=>e.getOwnerUserIds()),[e]),i=(0,c().K8)((()=>{const e=(0,G().S)();if(!e)return!1;return!(null==e?void 0:e.getDisableTeamGuests())&&(!t&&(0,H().Qd)())}),[t]),s=(0,u().IS)((()=>({container:{marginInlineStart:15,marginInlineEnd:7,paddingBottom:4,paddingTop:4}})),[]);return(0,ae.jsxs)("div",{style:s.container,children:[(0,ae.jsx)(Te,{teamStore:e,teamOwnerIds:n},"0"),(0,ae.jsx)(fe,{teamStore:e},"1"),i?(0,ae.jsx)(ge,{teamStore:e},"2"):void 0,t?void 0:(0,ae.jsx)(ze,{teamStore:e},"3")]})}function We({teamStore:e}){const t=(0,d().v3)(),n=(0,c().K8)((()=>e.getName()),[e]),s=(0,u().IS)((()=>({accessButton:{border:"none"},permissions:{border:`1px solid ${M().Tj.border.secondaryTranslucent}`,borderRadius:4},divider:{marginInlineStart:15,marginInlineEnd:15,width:"auto",borderColor:`${M().Tj.border.secondaryTranslucent}`}})),[]),o=(0,i.useCallback)(((i,s)=>{C().qH({environment:t,accessLevel:i,isDefault:s,store:e,teamName:n,from:"sidebar_team_modal"})}),[t,e,n]),a=(0,c().K8)((()=>e.getTeamAccessLevel()),[e]);return(0,ae.jsxs)("div",{style:s.permissions,children:[(0,ae.jsx)(W().u,{teamStore:e,currentAccessLevel:a,onChange:o,style:s.accessButton},"visibility"),(0,ae.jsx)(q().A,{size:1,style:s.divider}),(0,ae.jsx)(qe,{teamStore:e},"permissions")]})}function Ge(e){const{title:t,caption:n,right:i,rightTooltip:s}=e,o=(0,u().IS)((()=>({root:{display:"flex",alignItems:"center",width:"100%"},title:{fontSize:14,marginInlineEnd:8,flexGrow:1},caption:{marginTop:1,width:"95%",marginBottom:5}})),[]);return(0,ae.jsxs)("div",{style:o.root,children:[(0,ae.jsxs)("div",{style:o.title,children:[t,n?(0,ae.jsx)(v().D,{styleKey:"captionRegular",colorVariant:"secondary",style:o.caption,children:n}):void 0]}),(0,ae.jsx)(ne().m,{placement:"top",alignment:"start",disableTooltip:!s,renderTooltip:()=>s,render:e=>(0,ae.jsx)("span",{...e,children:i})})]})}const He=(0,x().YK)({noDescription:{id:"TeamSettingsGeneral.generalSettings.noDescription",defaultMessage:"No description"}});function Ye({teamStore:e}){const t=(0,u().IS)((()=>({container:{maxWidth:"none",marginInlineStart:4}})),[]);return(0,ae.jsxs)(h().Y1,{gap:30,style:t.container,children:[(0,ae.jsx)($e,{teamStore:e}),(0,ae.jsx)(We,{teamStore:e}),(0,ae.jsx)(Ze,{teamStore:e})]})}function $e({teamStore:e}){const t=(0,x().tz)(),n=(0,d().v3)(),s=N(e),[o,a]=(0,i.useState)(void 0),[r]=(0,c().K8)((()=>[e.getDescription()??""]),[e]),l=(0,u().IS)((()=>({input:{width:"100%"}})),[]);return(0,ae.jsxs)(h().Y1,{gap:10,children:[(0,ae.jsx)(v().D,{styleKey:"captionRegular",colorVariant:"secondary",children:(0,ae.jsx)(x().sA,{id:"TeamSettingsGeneral.generalSettings.description.title",defaultMessage:"Description"})}),(0,ae.jsx)(Qe,{value:void 0===o?r:o,onBlurValue:t=>{(t=>{const i=null==t?void 0:t.trim();e&&r.trim()!==i&&L().createAndCommit({userAction:"TeamSettingsGeneral.updateDescription",environment:n,canUndo:!0,perform:t=>{C().n7({store:e,update:{description:i},transaction:t})}})})(t)},onChangeValue:e=>{a(e)},disabled:s,placeholder:t.formatMessage(He.noDescription),textarea:!0,autosize:!0,inputStyle:l.input,maxlength:S().z})]})}function Qe(e){const{onBlurValue:t,onChangeValue:n,...s}=e,[o,a]=(0,i.useState)(!1);return(0,ae.jsx)(B().A,{capture:o,render:e=>(0,ae.jsx)(R().A,{...s,onFocus:e=>{a(!0)},onBlur:e=>{a(!1),t(e.target.value)},onChange:e=>{null==n||n(e.target.value)},overrideDefaultWidth:!0,...e})})}function Ze({teamStore:e}){const[t,n]=(0,c().K8)((()=>[e.getName(),e.isArchived()]),[e]),i=(0,O().R)(e),s=(0,U().G)(e);if(void 0===t||!s)return null;const o=[(0,ae.jsx)(Xe,{teamStore:e},"leave")];return i&&(n?o.push((0,ae.jsx)(Je,{teamStore:e,teamName:t},"restore")):o.push((0,ae.jsx)(et,{teamStore:e},"archive"))),(0,ae.jsx)(ue,{title:(0,ae.jsx)(x().sA,{id:"sidebarTeamModalSettingsScreen.manageTeamspace.title",defaultMessage:"Manage teamspace"}),rows:o,hideDividers:!0})}function Xe({teamStore:e}){const t=(0,O().R)(e),n=(0,d().v3)(),s=(0,z().$)(e),o=(0,i.useCallback)((async()=>{await C().JC({environment:n,teamStore:e,from:"sidebar_team_modal",userGroupsInTeam:s})}),[n,e,s]),a=(0,ae.jsx)(x().sA,{id:"teamJoinLeaveButton.leaveTeam.enabledTooltip",defaultMessage:"Click to leave teamspace"}),r=(0,K().v)({teamStore:e}),l=Boolean(r),c=l?r:a;return(0,ae.jsx)(Ge,{title:(0,ae.jsx)(x().sA,{id:"teamBrowser.teamCard.button.leaveTeam",defaultMessage:"Leave teamspace"}),caption:(0,ae.jsx)(x().sA,{id:"teamBrowser.teamCard.button.leaveTeamDescription",defaultMessage:"Removes teamspace from your sidebar"}),rightTooltip:c,right:(0,ae.jsx)(D().A,{onClick:o,disabled:l,disabledFeedback:l,colorPalette:t?void 0:"red",children:(0,ae.jsx)(v().D,{colorPalette:t?void 0:"red",children:(0,ae.jsx)(x().sA,{id:"teamBrowser.teamCard.button.leaveTeam",defaultMessage:"Leave teamspace"})})})})}function Je(e){const t=(0,d().v3)(),n=(0,c().K8)((()=>(0,k().mN)(e.teamStore)),[e.teamStore]);return(0,ae.jsx)(Ge,{title:(0,ae.jsx)(x().sA,{id:"sidebarTeamModalSettingsScreen.dangerZone.restoreTeamButton",defaultMessage:"Restore teamspace"}),caption:(0,ae.jsx)(x().sA,{id:"sidebarTeamModalSettingsScreen.dangerZone.restoreTeamCaption",defaultMessage:"Restoring this teamspace will add it to the sidebar for all teamspace members that were previously added."}),right:(0,ae.jsx)(D().A,{onClick:async()=>await(async({teamStore:e,teamName:n})=>{await C().Q8({environment:t,teamStore:e,teamName:n,from:"sidebar_team_modal"})})({teamName:e.teamName,teamStore:e.teamStore}),disabled:!n,children:(0,ae.jsx)(x().sA,{id:"sidebarTeamModalSettingsScreen.dangerZone.restoreTeamButton",defaultMessage:"Restore teamspace"})})})}function et(e){const{teamStore:t}=e,n=(0,d().v3)(),i=(0,c().K8)((()=>t.getSpaceStore()),[t]),s=(0,F().q)({teamId:t.id,spaceStore:i}),o=(0,E().c)(),a=s&&!o.canArchive;return(0,ae.jsx)(Ge,{title:(0,ae.jsx)(x().sA,{id:"teamSettingsSecurity.dangerZone.archiveTeamButton",defaultMessage:"Archive teamspace"}),caption:(0,ae.jsx)(x().sA,{id:"sidebarTeamModalSettingsScreen.dangerZone.archiveTeamDescription",defaultMessage:"Removes teamspace from the sidebar for all members"}),rightTooltip:a?(0,V().P)(o):void 0,right:(0,ae.jsx)(D().A,{colorPalette:"red",disabled:a,disabledFeedback:a,onClick:async()=>{a||await C().mm({environment:n,teamStore:t,from:"sidebar_team_modal"})},children:(0,ae.jsx)(v().D,{colorPalette:"red",children:(0,ae.jsx)(x().sA,{id:"teamSettingsSecurity.dangerZone.archiveTeamButton",defaultMessage:"Archive teamspace"})})})})}var tt=()=>n(160432),nt=()=>n(344417),it=()=>n(986863),st=()=>n(205618),ot=()=>n(931956);function at({teamStore:e}){const t=(0,x().tz)(),n=(0,c().K8)((()=>T().A.state.memberFilterQuery),[]),i=(0,c().uB)(void 0,st().A),s=(0,ot().X)(e);return(0,ae.jsxs)(h().Y1,{gap:6,direction:"horizontal",children:[(0,ae.jsx)(R().A,{placeholder:t.formatMessage({id:"teamPermissionsInviteWithModal.filterMembersInput.placeholder",defaultMessage:"Search members"}),value:n,onChange:e=>{T().A.setState({...T().A.state,memberFilterQuery:e.target.value,limitMembers:!0})},left:(0,ae.jsx)(Pe().I,{icon:nt().magnifyingGlassSmallIcon,colorVariant:"secondary",size:"sm"}),showClearButton:!0}),(0,ae.jsx)(it().u,{teamStore:e,permissionsInviteStore:i,origin:(0,ae.jsx)(ne().m,{placement:"top",alignment:"end",textWrap:!0,renderTooltip:()=>s?(0,ae.jsx)(x().sA,{id:"teamPermissionsInviteWithModal.addMembers.tooltip",defaultMessage:"Add members and groups"}):(0,ae.jsx)(x().sA,{id:"teamPermissionsInviteWithModal.addMembersNoPermissions.tooltip",defaultMessage:"You do not have permissions to add members to this teamspace"}),render:e=>(0,ae.jsx)(tt().A,{colorPalette:"blue",disabled:!s,size:"lg",onClick:()=>{i.setState({...i.state,modalOpen:!0})},...e,children:(0,ae.jsx)(x().sA,{id:"teamPermissionsInviteWithModal.openModal",defaultMessage:"Add members"})})})})]})}var rt=()=>n(98126),lt=()=>n(442672),dt=()=>n(230711),ct=()=>n(59226),ut=()=>n(165241),pt=()=>n(408895),gt=()=>n(134217),mt=(n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),()=>n(848538)),ft=()=>n(763824),ht=()=>n(534619),yt=()=>n(576737),vt=()=>n(169626);const bt=["owner","member","team_level_guest"],St=["group","user"];class xt extends(()=>n(461924))().o{constructor({teamStore:e,currentUserStore:t,environment:i,members:s,initialQuery:o,initialSort:a,intl:r,canAddMembers:l,shouldUseEdgeCache:d,limit:c,rawTeamMembership:u}){super(void 0),this.teamStore=void 0,this.rawTeamMembership=void 0,this.environment=void 0,this.query=void 0,this.intl=void 0,this.canAddMembers=void 0,this.limit=void 0,this.currentPage=0,this.filteredAndSortedMembers=[],this.membersToAdd=[],this.innerListSource=void 0,this.currentUserStore=void 0,this.isLoadingMore=!1,this.isRefreshing=!1,this.teamStore=e,this.environment=i,this.query=o,this.sort=a,this.intl=r,this.canAddMembers=l,this.limit=c??20,this.currentUserStore=t,this.rawTeamMembership=u;const p=mt().v1.filter((e=>"restricted_member"!==e));e.isDefault()&&(this.innerListSource=d?new(n(585428).e)({users:[],environment:this.environment,spaceId:this.teamStore.getSpaceId()??"",initialMembershipFilter:p,initialQuery:this.query,initialSort:{field:"name_normalized",direction:"asc"},limit:this.limit}):new(yt().z)({users:s,initialMembershipFilter:p,initialSort:{field:"name_normalized",direction:"asc"},initialQuery:this.query,limit:this.limit})),this.refresh()}async applySearch(e){return this.query&&0!==this.query.length?(await(0,ft().lX)(e,25,(async e=>{if("user"===e.entity_type){const t=this.currentUserStore?ve().L.createChildStore(this.currentUserStore,{table:be().oo,id:e.user_id}):void 0;await(null==t?void 0:t.load())}})),(0,n(778078).Ay)(this.query,e,(e=>{if("user"===e.entity_type){const t=this.currentUserStore?ve().L.createChildStore(this.currentUserStore,{table:be().oo,id:e.user_id}):void 0;return[(null==t?void 0:t.getName())??"",(null==t?void 0:t.getEmail())??""].filter(Boolean).join(" ")}{const t=vt().h.getGroup(e.group_id);return(null==t?void 0:t.getName())??""}}),{minScore:1e3})):e}async applySort(e){return this.sort?"name"===this.sort.column?(await(0,ft().lX)(e,25,(async e=>{if("user"===e.entity_type){const t=this.currentUserStore?ve().L.createChildStore(this.currentUserStore,{table:be().oo,id:e.user_id}):void 0;await(null==t?void 0:t.load())}})),e.sort(((e,t)=>{var n;const i=Mt({member:e,parentStore:this.currentUserStore})??"",s=Mt({member:t,parentStore:this.currentUserStore})??"";if(i===s)return 0;const o=i<s?-1:1;return null!==(n=this.sort)&&void 0!==n&&n.sortedAscending?o:-o}))):"role"===this.sort.column?e.sort(((e,t)=>{const n=e.type,i=t.type,s=bt.indexOf(n)-bt.indexOf(i);var o;if(0!==s)return null!==(o=this.sort)&&void 0!==o&&o.sortedAscending?-s:s;const a=e.entity_type,r=t.entity_type,l=St.indexOf(a)-St.indexOf(r);return 0!==l?l:0})):void(0,j().HB)(this.sort.column):e}async getMembersToAdd(){if(0===this.query.length||!this.canAddMembers)return[];let e=[];this.teamStore.isDefault()||(e=await ht().searchSpaceUsers({environment:this.environment,query:this.query,membersOnly:!0,limit:5}));const t=ht().searchSpaceGroups({query:this.query,intl:this.intl}),n=[...e,...t],i=new Set(this.filteredAndSortedMembers.map(At));return n.filter((e=>!i.has("group_id"in e?e.group_id:e.id))).slice(0,5)}async setSort(e){var t,n;if((null===(t=this.sort)||void 0===t?void 0:t.column)!==(null==e?void 0:e.column)||(null===(n=this.sort)||void 0===n?void 0:n.sortedAscending)!==(null==e?void 0:e.sortedAscending)){var i,s;if(this.currentPage=0,this.sort=e,"name"!==e.column||e.sortedAscending)await(null===(i=this.innerListSource)||void 0===i?void 0:i.setSort({field:"name_normalized",direction:"asc"}));else await(null===(s=this.innerListSource)||void 0===s?void 0:s.setSort({field:"name_normalized",direction:"desc"}));await this.refresh()}}async setQuery(e){var t;this.query!==e&&(this.currentPage=0,this.query=e,await(null===(t=this.innerListSource)||void 0===t?void 0:t.setQuery(e)),await this.refresh())}async fetch(){var e;const t=this.currentPage*this.limit,n=t+this.limit,i=[...this.filteredAndSortedMembers.map((e=>({type:"joined",value:e}))),...this.membersToAdd.map((e=>({type:"to_add",value:e})))],s=i.slice(t,n),o=Boolean(n<i.length||(null===(e=this.innerListSource)||void 0===e?void 0:e.rowsStore.state.hasMore));return Promise.resolve({rows:s,hasMore:o})}async loadMore(){if(!this.isLoadingMore){if(this.isLoadingMore=!0,this.currentPage++,this.teamStore.isDefault()){var e;await(null===(e=this.innerListSource)||void 0===e?void 0:e.loadMore());const t=this.getTeamMembershipForDefaultTeam(),n=await this.applySearch(t);this.filteredAndSortedMembers=await this.applySort(n),this.membersToAdd=await this.getMembersToAdd()}await super.loadMore(),this.isLoadingMore=!1}}async refresh(){if(this.isRefreshing)return;this.isRefreshing=!0,this.currentPage=0;let e=[];var t;this.teamStore.isDefault()?(await(null===(t=this.innerListSource)||void 0===t?void 0:t.refresh()),e=this.getTeamMembershipForDefaultTeam()):e=this.rawTeamMembership;const n=await this.applySearch(e);this.filteredAndSortedMembers=await this.applySort(n),this.membersToAdd=await this.getMembersToAdd(),await super.refresh(),this.isRefreshing=!1}async setVisibleMembers(e){this.teamStore.isDefault()&&this.innerListSource instanceof yt().z&&await this.innerListSource.setUsers(e),await this.refresh()}getTeamMembershipForDefaultTeam(){var e;const t=(null===(e=this.innerListSource)||void 0===e||null===(e=e.rowsStore.state.rows)||void 0===e?void 0:e.map((e=>e.id)))??[];if(void 0===this.rawTeamMembership)return[];const n=[],i=new Set;for(const o of this.rawTeamMembership)"team_level_guest"!==o.type&&n.push(o),"user"!==o.entity_type||"member"!==o.type&&"owner"!==o.type||i.add(o.user_id);const s=new Set(t);for(const o of s)i.has(o)||n.push({type:"member",entity_type:"user",user_id:o});return n}}function Mt({member:e,parentStore:t}){let n;if("user"===e.entity_type){const i=t?ve().L.createChildStore(t,{table:be().oo,id:e.user_id}):void 0;n=(null==i?void 0:i.getName())??(null==i?void 0:i.getEmail())}else{var i;n=null===(i=vt().h.getGroup(e.group_id))||void 0===i?void 0:i.getName()}return function(e){return null==e?void 0:e.normalize("NFKD").toLowerCase().replace(/\p{Diacritic}/gu,"")}(n)}function At(e){switch(e.entity_type){case"user":return e.user_id;case"group":return e.group_id;default:(0,j().HB)(e)}}var jt=()=>n(852273),wt=()=>n(187174),It=()=>n(921997);const kt=100;function Tt(e){const{teamStore:t,query:n,sort:s,limit:o}=e,a=(0,x().tz)(),r=(0,d().v3)(),l=(0,ye().$)(),u=(0,ot().X)(t),p=(0,ct().X)("fetch_team_membership_from_server"),g=(0,c().K8)((()=>t.getSpaceStore()),[t]),{members:m,loading:f}=function({teamStore:e,spaceId:t,enabled:n=!0}){const s=(0,d().v3)(),o=e.id,[{value:a,status:r,error:l},c]=(0,wt().Yb)((async()=>{if(!n||!t||!o)return;const e=await s.api.callCellCompatibleApi({eventName:"getEntitiesInTeam",environment:s,data:{teamId:o,spaceId:t},cellNavigation:{spaceId:t}});return"success"===e.type?e.data.entities:void 0}),[s,o,t,n]),u=(0,i.useRef)(null),p=(0,i.useRef)(null),g=(0,i.useRef)(c);g.current=c;const m=(0,i.useCallback)((({value:e,passThroughData:t})=>{null!=e&&u.current!==e&&(u.current=e,Array.isArray(t)&&!t.includes(o)||(p.current&&clearTimeout(p.current),p.current=setTimeout((()=>{p.current=null,g.current()}),kt)))}),[o]);return(0,i.useEffect)((()=>{if(!n||!t||!o)return;const e=jt().Ay.addListener((0,It().um)(t),void 0,m,void 0,s);return()=>{p.current&&(clearTimeout(p.current),p.current=null),u.current=null,e&&jt().Ay.removeListener(e,s)}}),[n,t,s,m,o]),{members:a,loading:n&&"pending"===r,error:l}}({teamStore:t,spaceId:null==g?void 0:g.id,enabled:p}),h=(0,c().K8)((()=>p?m??[]:t.getRawMembership()),[p,m,t]),y=(0,c().K8)((()=>(0,pt().M)({spaceId:null==g?void 0:g.id,userId:null==l?void 0:l.id,enforceIdsCheck:!1,debugFrom:"useTeamMembersListSource"})),[g,l]),v=(0,c().K8)((()=>ut().i({userId:null==l?void 0:l.id,spaceId:null==g?void 0:g.id,debugFrom:"useTeamMembersListSource"})),[null==l?void 0:l.id,null==g?void 0:g.id]),b=(0,c().K8)((()=>{if(v||!y||!g||!l)return[];return(0,gt().Ye)(y).map((e=>{var n,i;const s=ve().L.createChildStore(l,{table:be().oo,id:e.userId}),o=(0,dt().dp)(g,e.userId);return{id:e.userId,email:(null==s?void 0:s.getEmail())??"",space_id:t.getSpaceId()??"",name:(null==s?void 0:s.getName())??"",profile_photo:null==s||null===(n=s.getModel())||void 0===n?void 0:n.profile_photo,membership_type:null==o?void 0:o.getMembershipType(),onboarding_completed:null==s||null===(i=s.getModel())||void 0===i?void 0:i.onboarding_completed,first_joined_space_time:e.firstJoinedSpaceTime??Date.now()}}))}),[t,y,l,g,v]),S=(0,c().K8)((()=>{if(y&&l&&(!p||!f))return new xt({members:b,teamStore:t,currentUserStore:l,environment:r,initialQuery:n,initialSort:s,limit:o,intl:a,shouldUseEdgeCache:v,canAddMembers:u,rawTeamMembership:h})}),[r,v,a,l,p,f,h]),M=b;return(0,i.useEffect)((()=>{null==S||S.setVisibleMembers(M)}),[S,M]),(0,i.useEffect)((()=>{null==S||S.setSort(s)}),[S,s]),(0,i.useEffect)((()=>{null==S||S.setQuery(n)}),[S,n]),S}var Ct=()=>n(96689),_t=()=>n(695608),Pt=()=>n(358075),Bt=()=>n(173783),Rt=()=>n(313171),Dt=()=>n(820635),Lt=(n(16280),()=>n(792057)),Et=()=>n(483226),Ot=()=>n(250910),Nt=()=>n(118307),Ft=()=>n(546926),Ut=()=>n(631524),zt=()=>n(890492),Kt=()=>n(81068),Vt=()=>n(663639),qt=()=>n(736847),Wt=()=>n(854705),Gt=()=>n(176983),Ht=()=>n(789586),Yt=()=>n(308228),$t=(n(737550),()=>n(706021)),Qt=()=>n(468006),Zt=()=>n(499764),Xt=()=>n(112698),Jt=()=>n(528093);function en(e){var t;const{teamStore:n,memberInfo:s,permissionItem:o,memberName:a,onMenuItemClicked:r,isPermissionOverridden:l}=e,p=(0,d().v3)(),g=(0,x().tz)(),m=(0,i.useMemo)((()=>new(Nt().A)),[]),f=(0,c().K8)((()=>n.getTeamPermission()),[n]),h=(0,c().K8)((()=>(0,Y().f)(n)),[n]),y=null==h?void 0:h.id,v=(0,Jt()._)({name:"custom_teamspace_permissions",spaceId:y,userId:null==p||null===(t=p.currentUser)||void 0===t?void 0:t.id}),b=(0,O().R)(n),S=!(0,$t().e2)(v)&&!l||!b,A=(0,c().K8)((()=>{if(null==n||!n.isDefined())return;const e=g.formatMessage({id:"teamMemberPermissionRoleSelect.member.permissionitem.description",defaultMessage:"You can't give less access than the teamspace default. Lower teamspace members’ access to enable this option."}),t=(0,ae.jsx)(x().sA,{id:"teamMemberPermissionRoleSelect.permissionItem.defaultTag",defaultMessage:"default"});return["editor","read_and_write","comment_only","reader"].map((function(i){const s=(null==f?void 0:f.role)===i?t:void 0;return(0,Q().or)({teamValue:{id:n.id,permissions:n.getPermissionItems()},permissionRole:i})?{role:i,disabledInfo:{isDisabled:!0,disabledMessage:e},tag:s}:{role:i,tag:s}}))}),[f,g,n]);const j=(0,u().IS)((()=>({overrideTitle:{display:"flex",alignItems:"center",justifyContent:"space-between",height:28},roleSelectButton:{marginInlineEnd:0,fontSize:12,color:M().Tj.text.secondary,visibility:l?void 0:"hidden"},disabledItem:{color:M().Tj.text.tertiary}})),[l]),w=(0,ae.jsxs)("div",{style:j.overrideTitle,children:[(0,ae.jsx)(x().sA,{id:"TeamMemberOwnerSelect.permissionsOverride",defaultMessage:"Custom permissions"}),null!=v&&v.upsell&&!l?(0,ae.jsx)(Xt().B,{upsell:null==v?void 0:v.upsell,analyticsName:"team_member_permission_override",desktopStyle:{marginInlineStart:8,marginInlineEnd:12}}):(0,ae.jsx)(J().Ay,{spaceStore:h,role:"owner"===s.type?"none":o.role,table:X().yK,type:"user"===s.entity_type?"user_permission":"group_permission",upgradeButtonName:"user"===s.entity_type?"user_permission_item":"group_permission_item",disabled:S,buttonStyle:j.roleSelectButton,availableRoleItems:A,header:(0,ae.jsx)(oe().A,{isSmall:!0,isSecondaryColor:!0,style:{fontWeight:600,marginInlineStart:16,marginTop:8},children:(0,ae.jsx)(x().sA,{id:"teamMemberPermissionRoleSelect.permissionOverride.menuHeader",defaultMessage:"Select custom role"})}),onChange:e=>{"none"!==e&&(!function(e){Lt().ui({message:(0,ae.jsx)(x().sA,{id:"teamMemberPermissionSettings.permissionSwitcher.confirmation.message",defaultMessage:"Are you sure you want to change {name}’s role to {role}?",values:{name:a,role:(0,Zt().qZ)(e).toLowerCase()}}),description:(0,ae.jsx)(x().sA,{id:"teamMemberPermissionSettings.permissionSwitcher.confirmation.description",defaultMessage:"This change won’t apply to any restricted pages in the teamspace."}),showCancel:!0,keepFocus:!1,handleCancel:Lt().zw,items:[{label:(0,ae.jsx)(x().sA,{id:"teamMemberPermissionSettings.permissionSwitcher.accept",defaultMessage:"Change access"}),color:"red",onAccept:async()=>{const{serverCommitResult:t}=L().createAndCommit({userAction:"TeamMemberPermissionRoleSelect.handleRoleSelect",environment:p,canUndo:!0,perform:t=>{C().b4({memberInfo:s,teamStore:n,transaction:t,environment:p,permissionRole:e})}});await t,n.isDefault()&&(n.getMembershipDefinedOnTeam().some((e=>(0,Qt().Q6)(e,s)))||await C().Zd({environment:p,teamStore:n,teamMemberInfos:[s],isSettingDefaultTeam:!0,createNewTeamFlowId:void 0}))}}]})}(e),r&&r())},buttonPopupStore:m,placementToOrigin:"right",alignmentToOrigin:"end"})]});return(0,ae.jsx)(ne().m,{placement:S?"right":"left",textWrap:!0,renderTooltip:()=>S&&!b?(0,ae.jsx)(x().sA,{id:"teamMemberPermissionRoleSelect.permissionOverride.buttonTooltip.disabled",defaultMessage:"You must be a teamspace owner to set custom permission level"}):(0,ae.jsx)(x().sA,{id:"teamMemberPermissionRoleSelect.permissionOverride.buttonTooltip",defaultMessage:"Set a custom permission level for all pages in this teamspace"}),render:e=>(0,ae.jsx)(Kt().A,{...e,focused:!1,disabled:S,style:S?j.disabledItem:{},onClick:()=>m.setState({open:!0}),title:w,isChecked:l})})}function tn({teamStore:e,memberInfo:t,permissionItem:n,memberName:i,isPermissionOverridden:s,spaceRole:a,disabled:r}){const l=(0,c().uB)(void 0,Nt().A),u=(0,d().v3)(),p=(0,c().O$)(o().AppStoreSidebarSpaceStore),g=(0,ye().$)(),m=(0,c().K8)((()=>{const e=null==g?void 0:g.userId;return"user"===t.entity_type&&t.user_id===e}),[null==g?void 0:g.userId,t]),f=()=>l.setState({...l.state,open:!1}),h=(0,O().R)(e),y=(0,Ht().P)({name:"team_self_promotion",spaceId:null==p?void 0:p.id,userId:null==g?void 0:g.userId}),v=(0,c().K8)((()=>{const{sidebarSpaceStore:e}=o().default.state;return Boolean(null==e?void 0:e.canAdmin())}),[]),b=(0,c().K8)((()=>{const{ownerUserIds:t,ownerGroupIds:n}=e.getAllOwnerIds();return t.length+n.length}),[e]),S=(0,z().$)(e),M=0===b,A=async n=>{f();const i="owner"===n?(0,ae.jsx)(x().sA,{defaultMessage:"owner",id:"teamMemberPermissionSettings.upgradeGuestConfirmation.roleLabelOwner"}):(0,ae.jsx)(x().sA,{defaultMessage:"member",id:"teamMemberPermissionSettings.upgradeGuestConfirmation.roleLabelMember"});if("team_level_guest"!==t.type||"owner"!==n&&"member"!==n)if("owner"===n){if("user"===t.entity_type||"group"===t.entity_type){const n=async()=>{const{serverCommitResult:n}=L().createAndCommit({userAction:"TeamMemberOwnerSelect.handleOwnerMenuItemClicked",environment:u,canUndo:!0,perform:n=>{C().D6({environment:u,memberInfo:t,teamStore:e,transaction:n})}});await n},i=async()=>{await C().z9({environment:u,teamStore:e,spaceStore:p,from:"team_settings_members",action:"upgradeToOwner"})};M&&m?Lt().ui({message:(0,ae.jsx)(x().sA,{id:"teamMemberPermissionSettings.upgradeOwnerForUnownedTeamConfirmation.message",defaultMessage:"Are you sure you want to become a teamspace owner? You can become the teamspace owner since there are no other owners and you are a workspace admin."}),showCancel:!0,keepFocus:!1,handleCancel:Lt().zw,items:[{label:(0,ae.jsx)(x().sA,{id:"teamMemberPermissionSettings.upgradeOwnerForUnownedTeamConfirmation.accept",defaultMessage:"Become teamspace owner"}),color:"blue",onAccept:async()=>{await n()}}]}):m&&y&&v?await i():await n()}}else m&&h?Lt().ui({message:(0,ae.jsx)(x().sA,{id:"teamMemberPermissionSettings.removeSelfTeamOwner.confirmation.message",defaultMessage:"Are you sure you want to remove yourself as a teamspace owner? You’ll no longer be able to edit teamspace settings and permissions."}),showCancel:!0,keepFocus:!1,handleCancel:Lt().zw,items:[{label:(0,ae.jsx)(x().sA,{id:"teamMemberPermissionSettings.permissionSwitcher.accept",defaultMessage:"Change access"}),color:"red",onAccept:w}]}):await w();else Lt().ui({message:(0,ae.jsx)(x().sA,{id:"teamMemberPermissionSettings.upgradeGuestConfirmationWithOtherTeamspaces.message",defaultMessage:"Are you sure you want to upgrade this user to a teamspace {memberOrOwner}? They will also be added to the workspace as a member, and they will become a member in their other teamspaces.",values:{memberOrOwner:i}}),showCancel:!0,keepFocus:!1,handleCancel:Lt().zw,items:[{label:(0,ae.jsx)(x().sA,{id:"teamMemberPermissionSettings.upgradeGuestConfirmation.accept",defaultMessage:"Add to workspace"}),color:"blue",onAccept:async()=>{if(p){const{serverCommitResult:i}=L().createAndCommit({userAction:"TeamMemberOwnerSelect.handleOwnerMenuItemClicked",environment:u,canUndo:!0,perform:i=>{C().Nd({environment:u,userId:t.user_id,teamStore:e,transaction:i,spaceStore:p,newTeamRole:n})}});await i}}}]})},w=async()=>{if("owner"!==t.type||"user"!==t.entity_type&&"group"!==t.entity_type){if("member"===t.type){const{serverCommitResult:n}=L().createAndCommit({userAction:"TeamMemberOwnerSelect.handleSetMemberAccept",environment:u,canUndo:!0,perform:n=>{C().P8({environment:u,memberInfo:t,teamStore:e,transaction:n})}});await n}}else{const{serverCommitResult:n}=L().createAndCommit({userAction:"TeamMemberOwnerSelect.handleSetMemberAccept",environment:u,canUndo:!0,perform:n=>{C().qS({memberInfo:t,teamStore:e,transaction:n,environment:u})}});await n}},I=async()=>{const{entity_type:n}=t;switch(f(),n){case"group":const i=vt().h.getGroup(t.group_id);if(!i)throw new Error("Permission group not found in space.");C().BQ({environment:u,teamStore:e,group:i});break;case"user":await C().fy({environment:u,teamStore:e,userId:t.user_id,from:"team_settings_member_table",userGroupsInTeam:S});break;default:(0,j().HB)(n)}};return(0,ae.jsx)(Ot().A,{buttonPopupStore:l,placementToOrigin:"bottom",renderOrigin:e=>(0,ae.jsx)(sn,{buttonPopupEvents:e,isPermissionOverridden:s,permissionItem:n,memberInfo:t,disabled:r}),render:()=>(0,ae.jsx)(nn,{teamStore:e,isPermissionOverridden:s,memberInfo:t,permissionItem:n,memberName:i,numberOfOwners:b,isMemberCurrentUser:m,onMenuItemClicked:A,onRemoveClicked:I,onSubMenuItemClicked:f,spaceRole:a}),popupType:Ot().z.Popup})}function nn({teamStore:e,isPermissionOverridden:t,memberInfo:n,permissionItem:i,memberName:s,numberOfOwners:o,isMemberCurrentUser:a,onRemoveClicked:r,onMenuItemClicked:l,onSubMenuItemClicked:d,spaceRole:p}){const g=(0,c().K8)((()=>(0,Y().f)(e)),[e]),f=(0,c().K8)((()=>!Boolean(null==g?void 0:g.getSettingsStore().getKeyStore("disable_team_guests").getValue())&&(0,H().Qd)()),[g]),h=(0,c().K8)((()=>e.isDefault()),[e]),y=(0,Gt().J)(g),v=(0,c().K8)((()=>Boolean((null==g?void 0:g.canAdmin())&&(0,Et().OX)())),[g]),b=(0,O().R)(e),S=(0,ot().X)(e),x=(0,c().K8)((()=>(0,k().TI)()),[]),j=1===o,I=0===o,T=(0,u().IS)((()=>({actionMenu:{marginTop:-4},removeButton:{color:M().Tj.red.text.accentPrimary},overrideLabel:{paddingInlineStart:10,color:M().Tj.text.secondary,fontSize:12,fontWeight:w().Wy.regular}})),[]),C=(e,t,n)=>(0,Yt().W)({isCurrentUserTeamOwner:b,role:e,isDefaultTeam:h,userIsSpaceAdmin:Boolean(y),userIsEnterpriseWorkspaceOwner:v,originalTeamMemberInfo:t,onlyHasOneOwner:j,isUnowned:I,isMemberCurrentUser:a,canCurrentUserAddTeamMembers:n,isRoleForRestrictedMember:"restricted_member"===p,canRMsBeTeamOwners:x}),_=(e,n)=>{const{isDisabled:i,disabledReason:s}=C(e,n,S);return{key:e,action:()=>l(e),render:o=>{const a=!t&&n.type===e;return(0,ae.jsx)(ne().m,{disableTooltip:!i,placement:"right",textWrap:!0,renderTooltip:()=>s,render:t=>(0,ae.jsx)("span",{...t,children:(0,ae.jsx)(Kt().A,{...o,disabled:i,disabledFeedback:i,title:(0,ae.jsx)(on,{type:e}),caption:rn(e),shouldWrapCaption:!0,isChecked:a})})})}}},P=h&&"user"===n.entity_type,B="group"!==n.entity_type&&f,R=[{key:"teamRoles",items:A().oE([_("owner",n),_("member",n),B?_("team_level_guest",n):void 0,ln({onRemoveClicked:r,styles:T,...C("none",n,S),isMemberInDefaultTeam:P}),..."owner"===n.type||I?[]:[{key:"divider",action:()=>{},render:()=>(0,ae.jsx)(q().A,{size:10})},{key:"permissions_override",action:()=>{},render:o=>(0,ae.jsx)("span",{...o,children:(0,ae.jsx)(en,{teamStore:e,memberInfo:n,permissionItem:i,memberName:s,onMenuItemClicked:d,isPermissionOverridden:t})})}]]),render:e=>(0,ae.jsx)(qt().A,{...e,topBorder:0!==e.index})}];return(0,ae.jsx)(zt().A,{className:m().yw8,menuType:Ft().gu.Popup,width:280,children:(0,ae.jsx)(Vt().A,{type:Vt().O.Vertical,initialFocus:void 0,sections:R})})}function sn({buttonPopupEvents:e,disabled:t,isPermissionOverridden:n,permissionItem:i,memberInfo:s}){const o=(0,u().IS)((()=>({label:{color:M().Tj.text.primary,fontSize:12.5,fontWeight:w().Wy.regular},overrideLabel:{color:M().Tj.text.secondary,fontSize:12,fontWeight:w().Wy.regular}})),[]),a=function(e,t,n){if(t&&n)return function(e){switch(e){case"none":return(0,ae.jsx)(x().sA,{id:"TeamMemberOwnerSelect.roleName.none",defaultMessage:"No access"});case"reader":return(0,ae.jsx)(x().sA,{id:"TeamMemberOwnerSelect.roleName.reader",defaultMessage:"Can view"});case"comment_only":return(0,ae.jsx)(x().sA,{id:"TeamMemberOwnerSelect.roleName.comment_only",defaultMessage:"Can comment"});case"content_only_editor":return(0,ae.jsx)(x().sA,{id:"TeamMemberOwnerSelect.roleName.content_only_editor",defaultMessage:"Can edit content"});case"membership_admin":case"read_and_write":return(0,ae.jsx)(x().sA,{id:"TeamMemberOwnerSelect.roleName.read_and_write",defaultMessage:"Can edit"});case"editor":return(0,ae.jsx)(x().sA,{id:"TeamMemberOwnerSelect.roleName.editor",defaultMessage:"Full access"});default:(0,j().HB)(e)}}(n);return an(e)}(s.type,n,i.role);return(0,ae.jsxs)(Ut().p,{disabled:t,iconTrailing:t?void 0:{icon:Wt().arrowChevronSingleDownFillSmallIcon,size:"xs",colorVariant:"tertiary"},...e,children:[n?(0,ae.jsxs)("span",{style:o.overrideLabel,children:[(0,ae.jsx)(x().sA,{id:"TeamMemberOwnerSelect.roleName.custom",defaultMessage:"Custom"}),(0,ae.jsx)("span",{style:{marginInlineStart:5,marginInlineEnd:5},children:"•"})]}):void 0,(0,ae.jsx)("span",{style:o.label,children:a})]})}function on({type:e}){const t=an(e);return(0,ae.jsx)("div",{children:(0,ae.jsx)("span",{children:t})})}function an(e){switch(e){case"owner":case"member":case"team_level_guest":return(0,ae.jsx)(x().sA,{...k().Y7[e].label});case"none":return;default:(0,j().HB)(e)}}function rn(e){switch(e){case"owner":case"member":case"team_level_guest":return(0,ae.jsx)(x().sA,{...k().Y7[e].caption});case"none":return;default:(0,j().HB)(e)}}function ln({styles:e,isDisabled:t,disabledReason:n,onRemoveClicked:i}){return{key:"remove",action:i,render:i=>(0,ae.jsx)(ne().m,{disableTooltip:!t,placement:"right",textWrap:!1,renderTooltip:()=>n,render:n=>(0,ae.jsx)("span",{...n,children:(0,ae.jsx)(Kt().A,{...i,style:e.removeButton,disabled:t,disabledFeedback:!0,title:(0,ae.jsx)(x().sA,{id:"TeamMemberOwnerSelect.remove",defaultMessage:"Remove"})})})})}}function dn(e){const{type:t,store:n,permissionItem:i,memberInfo:s}=e,a=(0,d().v3)(),r=(0,x().tz)(),l="group"===t?e.permissionGroup:void 0,p="user"===t?e.userStore:void 0,g=(0,c().O$)(o().AppStoreSidebarSpaceStore),m=(0,c().K8)((()=>{var e;switch(t){case"group":const n=s.group_id,i=vt().h.getGroupData(n);return null!=i&&i.membershipTypes.includes("restricted_member")?"restricted_member":"member";case"user":const o=s.user_id;return(null===(e=(0,dt().sE)(g,o))||void 0===e?void 0:e.getMembershipType())??"none";default:(0,j().HB)(t)}}),[t,s,g]),f=(0,O().R)(n),h=(0,ot().X)(n),y=(0,c().K8)((()=>null==g?void 0:g.canEditMembership()),[g]),v=(0,c().K8)((()=>{const e=a.currentUser.id,t=n.getSettingsStore().getValue();return!!(null!=g&&g.isDefined()&&n.isDefined()&&t&&e)&&(0,k().zC)({environment:a,teamStore:n,spaceStore:g})}),[a,g,n]),b=(0,c().K8)((()=>{const e=n.getPermissionItems()||[];switch(s.entity_type){case"group":return Boolean(e.find((e=>(0,Z().Ds)(e)&&e.group_id===s.group_id)));case"user":return Boolean(e.find((e=>(0,Z().B2)(e)&&e.user_id===s.user_id)));default:return!1}}),[s,n]),{name:S,label:A,icon:w,isSelfUserPermission:I}=(0,c().K8)((()=>{const e=a.currentUser.id;switch(t){case"group":return cn({permissionGroup:l,spaceId:null==g?void 0:g.id});case"user":return function({intl:e,userStore:t,currentUserId:n}){var i;const s=void 0!==n&&(null==t||null===(i=t.getModel())||void 0===i?void 0:i.id)===n;return{name:(0,_t().c6)(e,null==t?void 0:t.getModel()),label:null==t?void 0:t.getEmail(),icon:(0,ae.jsx)(Me().A,{avatarShouldShowShadow:!0,userStore:t,size:32}),isSelfUserPermission:s}}({intl:r,userStore:p,currentUserId:e});default:(0,j().HB)(t)}}),[a.currentUser.id,t,l,null==g?void 0:g.id,r,p]),T=(0,ae.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:(0,ae.jsx)(tn,{teamStore:n,memberInfo:s,memberName:S,permissionItem:i,isPermissionOverridden:b,disabled:h&&"member"===s.type?!f&&b:!f&&!v||"team_level_guest"===s.type&&!y,spaceRole:m})}),C=(0,u().IS)((()=>({row:{minHeight:52},pill:{marginInlineStart:6,height:17},titleYouIndicator:{color:M().Tj.text.secondary}})),[]),_=(0,ae.jsxs)("div",{style:{display:"flex",gap:4},children:[S,I?(0,ae.jsx)("span",{style:C.titleYouIndicator,children:(0,ae.jsx)(x().sA,{id:"specificTeamMemberPermissionRow.displayName.youIndicator",defaultMessage:"(You)"})}):void 0]}),P=(0,ae.jsxs)(ae.Fragment,{children:["group"===t?(0,ae.jsx)("div",{style:C.pill,children:w}):void 0,(0,mt().LF)(m)?(0,ae.jsx)(Pt().l,{role:m}):(0,mt().GN)(m)?(0,ae.jsx)(Rt().L,{}):void 0]});return(0,ae.jsx)(le,{style:C.row,tag:P,permissionRoleSelectComponent:T,iconComponent:"group"===t?(0,ae.jsx)(Bt().A,{size:32}):w,name:_,label:A})}function cn({spaceId:e,permissionGroup:t}){var n;const{name:i,icon:s}=t,o=(null===(n=vt().h.getGroupData(t.group_id))||void 0===n?void 0:n.memberCount)??0;return{name:i||(0,ae.jsx)(x().sA,{id:"teamPermissionSettings.untitled",defaultMessage:"Untitled"}),label:(0,ae.jsx)(ne().m,{placement:"bottom",alignment:"start",disableTooltip:0===o,renderTooltip:()=>(0,ae.jsx)(Dt().Q,{group:t,limit:10,noMembersMessage:void 0}),render:e=>(0,ae.jsxs)("div",{...e,children:[(0,ae.jsx)(x().sA,{id:"teamPermissionSettings.group",defaultMessage:"Group"})," • ",(0,ae.jsx)(x().sA,{id:"teamPermissionSettings.numberOfMembers",defaultMessage:"{groupSize, plural, one {{groupSize} member} other {{groupSize} members}}",values:{groupSize:o}})]})}),icon:s&&(0,ae.jsx)(xe().B6,{bucket:"public",disabled:!0,onChange:()=>{},isEmptyPage:!1,title:i,size:18,icon:s&&e?{icon:s,pointer:{table:Ct().NX,id:e}}:void 0}),isSelfUserPermission:!1}}var un=()=>n(128933),pn=()=>n(278729),gn=()=>n(617668),mn=()=>n(259524),fn=()=>n(224701);function hn({teamStore:e,...t}){const n=(0,d().v3)(),s=(0,c().K8)((()=>e.getSpaceStore()),[e]),o=(0,c().K8)((()=>null==s?void 0:s.id),[s]),a=(0,x().tz)(),r=(0,c().K8)((()=>{if(!s)return!1;if("memberToAdd"in t){const{memberToAdd:e}=t,n=pn().V.createChildStore(s,mt().i1({userId:e.id,spaceId:s.id}));return Boolean(n.isRestrictedMember())}{var e;const{groupToAdd:n}=t;return Boolean(null===(e=vt().h.getGroupData(n.getGroupId()))||void 0===e||null===(e=e.membershipTypes)||void 0===e?void 0:e.includes("restricted_member"))}}),[t,s]),l=(0,dt().U2)(s),p=(0,c().K8)((()=>{const t=null==l?void 0:l.userId,n=null==l?void 0:l.getMembershipType();return!(s&&t&&n)||!!r&&!(0,mn()._X)({roleThatCanAddRestrictedMembersToTeamspaces:s.getSetting("roles_that_can_add_restricted_members_to_teamspaces"),spaceUserRole:n,isTeamOwner:e.canAdmin()})}),[r,s,e,l]),g=(0,u().IS)((()=>({container:{display:"flex",flexDirection:"row",lineHeight:1.2,fontSize:14,width:"100%",minHeight:52,justifyContent:"space-between",alignItems:"center"},pill:{marginInlineStart:6,height:17}})),[]),m=(0,i.useCallback)((e=>{un().D6({label:(0,ae.jsx)(x().sA,{id:"SpecificTeamMemberToAddRow.team_invite_failure",defaultMessage:"Failed to add {userOrGroupName}",values:{userOrGroupName:e}})})}),[]),f=(0,i.useCallback)((async(t,i)=>{await C().Zd({environment:n,teamMemberInfos:[t],teamStore:e,isSettingDefaultTeam:!1,createNewTeamFlowId:void 0})?await fn().x(n):m(i)}),[n,m,e]),h=(0,i.useCallback)(((e,t)=>f({type:"member",entity_type:"user",user_id:e.id},t)),[f]),y=(0,i.useCallback)(((e,t)=>f({type:"member",entity_type:"group",group_id:e.group_id},t)),[f]),v=(0,c().K8)((()=>{if("groupToAdd"in t)return cn({spaceId:o,permissionGroup:t.groupToAdd})}),[o,t]);if("memberToAdd"in t){const{memberToAdd:e}=t,n=(0,_t().c6)(a,e);return(0,ae.jsxs)("div",{style:g.container,children:[(0,ae.jsx)(re,{icon:(0,ae.jsx)(Me().A,{userValue:e,size:32}),name:n,tag:r?(0,ae.jsx)(Rt().L,{}):void 0,label:e.email}),(0,ae.jsx)(yn,{onClickHandler:()=>{h(e,n)},disabled:p})]})}{if(!o||!v)return(0,ae.jsx)(ae.Fragment,{});const{groupToAdd:e}=t,n=(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsx)("div",{style:g.pill,children:v.icon}),r?(0,ae.jsx)(Rt().L,{}):void 0]});return(0,ae.jsxs)("div",{style:g.container,children:[(0,ae.jsx)(re,{icon:(0,ae.jsx)(Bt().A,{size:32}),name:v.name,label:v.label,tag:n}),(0,ae.jsx)(yn,{onClickHandler:()=>{y(e,v.name)},disabled:p})]})}}function yn(e){const{onClickHandler:t,disabled:n}=e;return(0,ae.jsx)(ne().m,{disableTooltip:!n,placement:"left",renderTooltip:()=>(0,ae.jsx)(x().sA,{id:"SpecificTeamMemberToAddRow.addMemberButton.disabledTooltip",defaultMessage:"You do not have permission to add restricted members to this teamspace."}),render:e=>(0,ae.jsx)(Ut().p,{colorPalette:"blue",onClick:t,iconLeading:gn().plusIcon,disabled:n,disabledFeedback:n,...e,children:(0,ae.jsx)(x().sA,{id:"SpecificTeamMemberToAddRow.addMemberButton.text",defaultMessage:"Add"})})})}var vn=()=>n(886358),bn=()=>n(107023);function Sn({sortType:e,onChangeSortType:t}){const n=(0,u().IS)((()=>({container:{display:"flex",justifyContent:"space-between"}})),[]),i=t=>t===e.column?e.sortedAscending?"ascending":"descending":"none",s=n=>{const i=n===e.column&&!e.sortedAscending;t({column:n,sortedAscending:i})};return(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsxs)("div",{style:n.container,children:[(0,ae.jsx)(xn,{title:(0,ae.jsx)(x().sA,{id:"TeamPermissionsListHeader.nameColumn",defaultMessage:"Name"}),sortedType:i("name"),onClick:()=>s("name")}),(0,ae.jsx)(xn,{title:(0,ae.jsx)(x().sA,{id:"TeamPermissionsListHeader.roleColumn",defaultMessage:"Role"}),sortedType:i("role"),onClick:()=>s("role")})]}),(0,ae.jsx)(q().A,{size:1})]})}function xn({sortedType:e,title:t,onClick:n}){const i=(0,u().IS)((()=>({button:{color:M().Tj.text.secondary,fontSize:12,padding:0},buttonHover:{background:"unset"}})),[]);return(0,ae.jsx)(Ut().p,{style:i.button,hoveredStyle:i.buttonHover,onClick:n,iconLeading:"ascending"===e?{icon:bn().arrowStraightUpFillSmallIcon,size:"xs",colorVariant:"secondary"}:"descending"===e?{icon:vn().arrowStraightDownFillSmallIcon,size:"xs",colorVariant:"secondary"}:void 0,children:t})}function Mn({store:e}){const t=(0,u().IS)((()=>({container:{display:"block",overflow:"hidden"},noResult:{fontSize:w().J.UIRegular.desktop,color:M().Tj.text.secondary,marginTop:8}})),[]),[n,s]=(0,i.useState)({column:"role",sortedAscending:!1}),o=(0,c().K8)((()=>T().A.state.memberFilterQuery),[]),a=Tt({teamStore:e,query:o,sort:n,limit:30}),r=(0,c().K8)((()=>null==a?void 0:a.rowsStore.state.rows),[a]),l=(0,ye().$)(),d=(0,i.useMemo)((()=>null==r?void 0:r.findIndex((e=>"to_add"===e.type))),[r]),p=(0,i.useCallback)(((e,t)=>t===d||0===t&&"joined"===e.type?82:52),[d]),g=Boolean(null==o?void 0:o.trim().length),m=r&&r.length>0;return!a||void 0===r?(0,ae.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,ae.jsx)(rt().k,{})}):(0,ae.jsxs)("div",{style:t.container,children:[(0,ae.jsx)(q().A,{size:1}),m?void 0:(0,ae.jsx)("div",{style:t.noResult,children:(0,ae.jsx)(x().sA,{id:"TeamPermissionsList.search.zeroState",defaultMessage:"No members or groups found"})}),m?(0,ae.jsx)(lt().u,{listSource:a,style:{overflow:"hidden"},renderRow:(t,i)=>(0,ae.jsxs)(ae.Fragment,{children:[0===i&&"joined"===t.type?(0,ae.jsx)(oe().A,{isSmall:!0,style:{height:30,alignContent:"end"},children:g?(0,ae.jsx)(x().sA,{id:"TeamPermissionsList.search.inThisTeam",defaultMessage:"In this teamspace"}):(0,ae.jsx)(Sn,{sortType:n,onChangeSortType:s})}):void 0,i===d?(0,ae.jsx)(oe().A,{isSmall:!0,style:{height:30,alignContent:"end"},children:(0,ae.jsx)(x().sA,{id:"TeamPermissionsList.search.notInTeam",defaultMessage:"Not in teamspace"})}):void 0,"joined"===t.type?(0,ae.jsx)(An,{teamStore:e,currentUserStore:l,memberInfo:t.value}):(0,ae.jsx)(jn,{teamStore:e,memberToAdd:t.value}),(0,ae.jsx)(q().A,{size:1})]}),estimateSize:p}):void 0]})}function An({teamStore:e,currentUserStore:t,memberInfo:n}){const i=(0,c().K8)((()=>(0,k().mo)({currentUserStore:t,teamStore:e,member:n})),[t,e,n]);return i?(0,ae.jsx)(dn,{store:e,...i}):null}function jn({teamStore:e,memberToAdd:t}){return"group_id"in t?(0,ae.jsx)(hn,{teamStore:e,groupToAdd:t}):(0,ae.jsx)(hn,{teamStore:e,memberToAdd:t})}function wn({teamStore:e}){return(0,ae.jsxs)(h().Y1,{gap:20,children:[(0,ae.jsx)(at,{teamStore:e}),(0,ae.jsx)(Mn,{store:e})]})}var In=()=>n(249046),kn=()=>n(287188),Tn=()=>n(84262),Cn=()=>n(709062),_n=()=>n(271476),Pn=()=>n(704658),Bn=()=>n(908375),Rn=()=>n(528295),Dn=()=>n(812941);function Ln({teamStore:e}){const t=(0,c().K8)((()=>e.getSettingsStore().getValue()),[e]),n=(0,c().K8)((()=>{const t=e.getSettingsStore().getValue();if(t)return Oe({id:e.id,permissions:e.getPermissionItems(),settings:t,is_default:e.isDefault()})}),[e]);if(!t||!n)return null;const i=[(0,ae.jsx)(On,{teamStore:e,hasMultiInviteAccessOptions:1===n.settingsOptions.invite_access.length,inviteAccess:t.invite_access},"invite"),(0,ae.jsx)(En,{teamStore:e,disablePageEdits:t.disable_team_page_edits},"editSidebar"),(0,ae.jsx)(Nn,{teamStore:e},"toggleInviteLink")];return(0,ae.jsx)(ue,{title:(0,ae.jsx)(x().sA,{id:"TeamSettingsSecurity.teamspaceSettingsTitle",defaultMessage:"Teamspace Security"}),rows:i})}function En(e){const{teamStore:t,disablePageEdits:n}=e,s=(0,d().v3)(),o=N(t),a=(0,c().K8)((()=>{var e;return(null===(e=t.getTeamPermission())||void 0===e?void 0:e.role)??"none"}),[t]),r=(0,i.useCallback)((e=>{L().createAndCommit({userAction:"teamsHelpers.changeTeamSetting",environment:s,canUndo:!0,perform:n=>{C().WC({environment:s,store:t,update:{disable_team_page_edits:e},transaction:n})}})}),[s,t]),l=(0,Z().p2)(a),u=[{option:!0,label:(0,ae.jsx)(x().sA,{id:"TeamSettingsPermissions.whoCanEditTeamPages.teamOwners.title",defaultMessage:"Only teamspace owners"}),action:()=>r(!0)}];return l&&u.push({option:!1,label:(0,ae.jsx)(x().sA,{id:"TeamSettingsPermissions.whoCanEditTeamPages.teamMembersAndOwners.title",defaultMessage:"Any teamspace member"}),action:()=>r(!1)}),(0,ae.jsx)(Ge,{title:(0,ae.jsx)(x().sA,{id:"TeamSettingsPermissions.whoCanEditTeamPages.title",defaultMessage:"Who can edit teamspace sidebar"}),caption:(0,ae.jsx)(x().sA,{id:"TeamSettingsPermissions.whoCanEditTeamPages.caption",defaultMessage:"Adding, removing, or re-ordering sidebar pages"}),rightTooltip:l?void 0:(0,ae.jsx)(x().sA,{id:"TeamSettingsPermissions.settingSelect.whoCanEditTeamPages.teamMemberPermissionTooltip",defaultMessage:"Change member permissions to Can edit or Full access to allow teamspace members to edit the sidebar"}),right:(0,ae.jsx)(Fn,{disabled:o||!l,currentOption:!l||Boolean(n),allOptions:u})})}function On(e){const{teamStore:t,hasMultiInviteAccessOptions:n,inviteAccess:s}=e,o=(0,O().R)(t),a=(0,d().v3)(),r=(0,i.useCallback)((e=>{L().createAndCommit({userAction:"team.setInviteAccess",environment:a,canUndo:!0,perform:n=>{C().WC({environment:a,store:t,update:{invite_access:e},transaction:n})}})}),[a,t]),l=!o||n;return(0,ae.jsx)(Ge,{title:(0,ae.jsx)(x().sA,{id:"TeamSettingsPermissions.whoCanInviteTeamMembers.title",defaultMessage:"Who can invite or remove teamspace members"}),rightTooltip:l&&o&&(0,ae.jsx)(x().sA,{id:"TeamSettingsPermissions.whoCanInviteTeamMembersDisabled.caption",defaultMessage:"Change access level to Closed or Private to restrict who can invite teamspace members"}),right:(0,ae.jsx)(Fn,{disabled:l,currentOption:s,allOptions:[{option:"team_members",label:(0,ae.jsx)(x().sA,{id:"TeamSettingsPermissions.whoCanInviteTeamspaceMembers.teamMembersAndOwners.title",defaultMessage:"Any teamspace member"}),action:()=>r("team_members")},{option:"team_owners",label:(0,ae.jsx)(x().sA,{id:"TeamSettingsPermissions.whoCanInviteTeamMembers.teamOwners.title",defaultMessage:"Only teamspace owners"}),action:()=>r("team_owners")}]})})}function Nn(e){const{teamStore:t}=e,n=(0,d().v3)(),i=(0,c().K8)((()=>(0,k().FQ)(t)),[t]),s=N(t),o=(0,u().IS)((()=>({container:{display:"flex",justifyContent:"space-between"},subtitle:{marginBottom:5},switcher:{marginTop:5}})),[]);return(0,ae.jsxs)("div",{style:o.container,children:[(0,ae.jsxs)("div",{children:[(0,ae.jsx)(oe().A,{children:(0,ae.jsx)(x().sA,{id:"TeamsecuritySection.inviteLink.label",defaultMessage:"Invite Link"})}),(0,ae.jsx)(oe().A,{isSmall:!0,style:o.subtitle,children:(0,ae.jsx)(x().sA,{id:"TeamsecuritySection.inviteLink.description",defaultMessage:"Only users who can invite members can see the invite link"})})]}),(0,ae.jsx)("div",{style:o.switcher,children:(0,ae.jsx)(kn().A,{disabled:s,on:!i,onClick:()=>{L().createAndCommit({userAction:"team.setInviteAccess",environment:n,canUndo:!0,perform:e=>{C().WC({environment:n,store:t,update:{disable_invite_link:!i},transaction:e})}})}})})]})}function Fn(e){const{currentOption:t,allOptions:n,disabled:i}=e,s=(0,u().IS)((()=>({buttonStyle:{fontSize:12.5,color:M().Tj.text.secondary}})),[]),o=n.find((e=>e.option===t));return o?(0,ae.jsx)(Ot().A,{disablePopup:i,popupType:Ot().z.Popup,alignmentToOrigin:"end",renderOrigin:e=>(0,ae.jsx)(Ut().p,{style:s.buttonStyle,disabled:i,iconTrailing:i?void 0:{icon:Wt().arrowChevronSingleDownFillSmallIcon,size:"xs",colorVariant:"tertiary"},...e,children:o.label}),render:e=>{const i=[{key:"options",render:e=>(0,ae.jsx)(qt().A,{...e}),items:n.map((n=>{const i={key:n.option.toString(),render:e=>(0,ae.jsx)(Kt().A,{...e,title:n.label,caption:n.caption,isChecked:t===n.option}),action:()=>{n.action(),e.close()}};return i}))}];return(0,ae.jsx)(zt().A,{menuType:Ft().gu.Popup,minWidth:150,children:(0,ae.jsx)(Vt().A,{type:Vt().O.Vertical,initialFocus:void 0,sections:i})})}}):null}function Un({teamStore:e}){return(0,ae.jsxs)(h().Y1,{gap:30,children:[(0,ae.jsx)(Ln,{teamStore:e}),(0,ae.jsx)(zn,{teamStore:e}),(0,ae.jsx)(Dn().A,{helpCenterLocation:"settingsAndPermissions",analyticsFrom:"teams_learn_more_team_settings_security",message:(0,ae.jsx)(x().sA,{id:"teamSettingsSecurity.learnMore",defaultMessage:"Learn about teamspace security"})})]})}function zn({teamStore:e}){const t=(0,c().K8)((()=>e.getSpaceStore()),[e]),n=(0,s().T)(),i=(0,Rn().Z)(),o=(0,ct().X)("restricted_members_enabled"),a=(0,ct().X)("teamspaces_disable_restricted_members_setting"),{organizationOverrides:r}=(0,_n().n)({spaceId:null==t?void 0:t.id}),l=(0,c().K8)((()=>({disable_public_access:{spaceIsDisabled:(null==t?void 0:t.getDisablePublicAccess())??!1,teamIsDisabled:e.getDisablePublicAccess(),isControlledByOrganization:Boolean(r.disable_public_access),forceDisabled:!1},disable_export:{spaceIsDisabled:(null==t?void 0:t.getDisableExport())??!1,teamIsDisabled:e.getDisableExport(),isControlledByOrganization:Boolean(r.disable_export),forceDisabled:!1},disable_guests:{spaceIsDisabled:(null==t?void 0:t.getDisableGuests())??!1,teamIsDisabled:e.getDisableGuests(),isControlledByOrganization:Boolean(r.disable_guests),forceDisabled:e.getDisableRestrictedMembers()},disable_restricted_members:{spaceIsDisabled:void 0,teamIsDisabled:e.getDisableRestrictedMembers(),isControlledByOrganization:!1,forceDisabled:!1}})),[t,e,r]),d=(0,O().R)(e),u=(0,c().K8)((()=>(null==t?void 0:t.canAdmin())??!1),[t]);if(!t)return null;if(!n)return null;const p=(0,ae.jsx)(Vn,{teamStore:e,settingName:"disable_public_access",title:(0,ae.jsx)(x().sA,{id:"teamSettingsSecurity.setting.shareTitleAWTLUpdate",defaultMessage:"Disable publishing sites, forms, and public links"}),spaceAndTeamSettings:l.disable_public_access,isSpaceAdmin:u,isTeamOwner:d,hasAdvancedSecurityFeature:i}),g=(0,ae.jsx)(Vn,{teamStore:e,settingName:"disable_guests",title:(0,ae.jsx)(x().sA,{id:"teamSettingsSecurity.setting.guestTitle",defaultMessage:"Disable guests"}),spaceAndTeamSettings:l.disable_guests,isSpaceAdmin:u,isTeamOwner:d,hasAdvancedSecurityFeature:i}),m=(0,ae.jsx)(Vn,{teamStore:e,settingName:"disable_export",title:(0,ae.jsx)(x().sA,{id:"teamSettingsSecurity.setting.exportTitle",defaultMessage:"Disable export"}),spaceAndTeamSettings:l.disable_export,isSpaceAdmin:u,isTeamOwner:d,hasAdvancedSecurityFeature:i}),f=(0,ae.jsx)(Vn,{teamStore:e,settingName:"disable_restricted_members",title:(0,ae.jsx)(x().sA,{id:"teamSettingsSecurity.setting.restrictedMembersTitle",defaultMessage:"Disable restricted members"}),spaceAndTeamSettings:l.disable_restricted_members,isSpaceAdmin:u,isTeamOwner:d,hasAdvancedSecurityFeature:i}),h=o&&a?[p,g,f,m]:[p,g,m],y=(0,ae.jsx)(x().sA,{id:"TeamSettingsSecurity.pageSettingsTitle",defaultMessage:"Page Security"});return(0,ae.jsx)(ue,{title:y,rows:h})}function Kn(e){return e?"disable":"allow"}function Vn(e){const{teamStore:t,settingName:n,title:o,spaceAndTeamSettings:a,isSpaceAdmin:r,isTeamOwner:l,hasAdvancedSecurityFeature:p}=e,g=(0,d().v3)(),m=(0,s().T)(),f=()=>p||a.teamIsDisabled,h=(0,c().K8)((()=>(0,Y().f)(t)),[t]),y=null==h?void 0:h.id,v=!f()&&r,b=(0,u().IS)((()=>({upsellWrap:{cursor:v?"pointer":void 0}})),[v]),S=(0,i.useCallback)((e=>{const{teamIsDisabled:n,spaceIsDisabled:i}=a,s=!n;C().$L({environment:g,store:t,settingName:e,newTeamSettingValue:Kn(s),spaceSettingValue:void 0===i?void 0:Kn(i)})}),[g,t,a]),M=(0,Jt()._)({name:"team_security_settings",spaceId:y,userId:m}),A=(0,Tn().wy)(null==M?void 0:M.upsell)?(0,ae.jsx)(Pn().UpgradeButton,{display:"text",source:"team_security_settings",upsell:null==M?void 0:M.upsell,width:"hug",size:"small",postUpgradeCallback:()=>{S(n)},spaceStore:h}):void 0,j=(0,ae.jsx)(x().sA,{id:"teamSettingsSecurity.setting.enterpriseGateToggleTooltip",defaultMessage:"Upgrade to Enterprise Plan to change security settings"}),w=a.isControlledByOrganization||a.forceDisabled,I=a.isControlledByOrganization?(0,Cn().C_)():(0,ae.jsx)(x().sA,{id:"teamSettingsSecurity.setting.disableGuestsLockedTooltip",defaultMessage:"Must enable restricted members to enable guests."}),k=(0,ae.jsx)(Ge,{title:(0,ae.jsxs)(In().Ye,{gap:4,children:[o,f()?void 0:A]}),caption:(()=>{const e=a.spaceIsDisabled,t=a.teamIsDisabled;if(e)return t?(0,ae.jsx)(x().sA,{id:"teamSettingsSecurity.basedOnWorkspaceSettings",defaultMessage:"Based on <underline>workspace settings</underline>",values:{underline:e=>(0,ae.jsx)("span",{style:{textDecoration:"underline"},children:e})}}):(0,ae.jsx)(x().sA,{id:"teamSettingsSecurity.overridesWorkspaceSettings",defaultMessage:"Overriding <underline>workspace setting</underline>",values:{underline:e=>(0,ae.jsx)("span",{style:{textDecoration:"underline"},children:e})}})})(),rightTooltip:!f()&&j,right:(0,ae.jsx)(kn().A,{on:a.teamIsDisabled,disabled:!(()=>{if(!f())return!1;if(!l)return!1;if(a.isControlledByOrganization)return!1;if(a.forceDisabled)return!1;return!(a.spaceIsDisabled&&a.teamIsDisabled)||r})(),onClick:()=>S(n),isLocked:w,lockedTooltip:I})});return(0,Tn().wy)(null==M?void 0:M.upsell)?(0,ae.jsx)(Bn().c,{upsell:M.upsell,source:"team_security_settings",spaceStore:h,children:({handleClick:e})=>(0,ae.jsx)("div",{style:b.upsellWrap,onClick:e,role:"button",tabIndex:0,children:k})}):k}var qn=()=>n(192940),Wn=()=>n(15144),Gn=()=>n(376254);function Hn({teamStore:e}){const t=(0,c().K8)((()=>T().A.state.tab),[]);if(void 0===t)return null;switch(t){case T().p.General:return(0,ae.jsx)(Ye,{teamStore:e});case T().p.Members:return(0,ae.jsx)(wn,{teamStore:e});case T().p.Security:return(0,ae.jsx)(Un,{teamStore:e});default:(0,j().HB)(t)}}function Yn(){const e=(0,d().v3)(),t=(0,x().tz)(),n=(0,c().O$)(o().AppStoreSidebarSpaceStore),i=(0,c().O$)(o().AppStoreSidebarSpaceViewStore),a=(0,u().IS)((()=>({modal:{width:l().A.isMobile?"auto":630,height:l().A.isMobile?"auto":640,maxWidth:"calc(100vw - 100px)",maxHeight:"calc(100vh - 100px)",borderRadius:5,overflow:"auto"},modalWrap:{userSelect:"none",WebkitUserSelect:"none",height:"100%"},innerWrap:{width:"100%",height:"100%",display:"flex",flexDirection:"column"},tabBar:{display:"flex",width:void 0,flexGrow:0,flexShrink:0,paddingInline:36,background:M().Tj.gray.background.primary},scroller:{flexGrow:1,paddingTop:20},contentWrap:{margin:"0px 36px 20px"}})),[]),{open:h,tab:y,teamId:v}=(0,c().K8)((()=>{const{open:e,tab:t}=T().A.state,n=T().A.getTeamStore();return{open:e,tab:t,teamId:null==n?void 0:n.id}}),[]),S=(0,s().T)(),w=(0,f().C)({userId:S,spaceStore:n,teamId:v??""});if(!n||!i||!w)return null;const k=[T().p.General,T().p.Members,T().p.Security];return(0,ae.jsx)(g().a,{open:h,ariaLabel:t.formatMessage({id:"sidebarTeamModal.modalLabel",defaultMessage:"Teamspace settings"}),innerStyle:a.modal,onDismiss:()=>{T().A.reset()},render:()=>h?(0,ae.jsx)("div",{className:m().kYU,style:{height:"100%"},children:(0,ae.jsx)("div",{style:a.modalWrap,children:(0,ae.jsx)(r().N,{debugName:"SidebarTeamModal",capture:!0,onBackspace:A().D_,onLeft:A().D_,onRight:A().D_,onSelectAll:A().D_,onRedo:A().D_,onUndo:A().D_,onCut:A().D_,onCopy:A().D_,onPaste:A().D_,onKeypress:A().D_,onDelete:A().D_,onTab:A().D_,children:(0,ae.jsxs)("div",{style:a.innerWrap,children:[(0,ae.jsx)($n,{teamStore:w}),(0,ae.jsx)(b().LZ,{tabs:k.map((e=>function(e,t){switch(e){case T().p.General:return(0,ae.jsx)(x().sA,{id:"sidebarTeamModalTab.option.general",defaultMessage:"General"});case T().p.Members:return(0,ae.jsx)(x().sA,{id:"sidebarTeamModalTab.option.members",defaultMessage:"Members"});case T().p.Security:return(0,ae.jsx)(x().sA,{id:"sidebarTeamModalTab.option.security",defaultMessage:"Security"});default:(0,j().HB)(e)}}(e))),selectedIndex:(0,j().O9)(y)?k.indexOf(y):1,onChange:t=>{h&&(I().Vg(e,{store:w,tab_old_value:y??T().p.General,tab_new_value:k[t]}),T().A.update((e=>e.open?{...e,tab:k[t]}:e)))},tabStyle:{marginInlineStart:-8},style:a.tabBar,tabTitleStyle:{marginInlineStart:8,marginInlineEnd:8}}),(0,ae.jsx)(Gn().H,{type:p().A.Y,style:a.scroller,children:(0,ae.jsx)("div",{style:a.contentWrap,children:(0,ae.jsx)(Hn,{teamStore:w})})})]})})})}):null})}function $n({teamStore:e}){const t=(0,x().tz)(),n=(0,d().v3)(),s=(0,qn().h)(e),o=N(e),[r,l]=(0,i.useState)(void 0),[p,g]=(0,i.useState)(void 0),m=(0,c().K8)((()=>(null==e?void 0:e.getName())||""),[e]),f=(0,c().K8)((()=>e.getRawMembership()),[e]),b=(0,c().K8)((()=>null==e?void 0:e.getSettings()),[e]),A=(0,u().IS)((()=>({header:{padding:"34px 36px 20px",background:M().Tj.gray.background.primary},titleWithMetadata:{minWidth:0},icon:{marginInlineEnd:12},input:{fontSize:22,fontWeight:w().Wy.semibold,background:"inherit",boxShadow:"none",paddingInline:"5px",marginInlineStart:"-5px",minWidth:0,width:void 0},innerInput:{textOverflow:"ellipsis"}})),[]),j=(0,i.useCallback)((t=>{e&&(0,C().qq)({store:e,environment:n,icon:t,source:"TeamSettings"})}),[e,n]);return(0,ae.jsxs)(h().Y1,{direction:"horizontal",style:A.header,children:[(0,ae.jsx)(te().x,{disabled:o,store:e,size:48,style:A.icon,onChange:j}),(0,ae.jsxs)(h().Y1,{direction:"vertical",style:A.titleWithMetadata,children:[(0,ae.jsxs)(h().Y1,{direction:"horizontal",width:"fill",children:[(0,ae.jsx)(Qe,{value:r?r.trim():m,style:A.input,inputStyle:A.innerInput,onBlurValue:e=>{l(e)},onChangeValue:i=>{l(i),(i=>{const s=null==i?void 0:i.trim();s.length>S().Q?g(t.formatMessage(a().q.team_name_too_long,{maxTeamNameLength:S().Q})):(g(void 0),""!==s&&e&&s!==m&&L().createAndCommit({userAction:"TeamSettings.updateName",environment:n,canUndo:!0,perform:t=>{(0,C().n7)({store:e,update:{name:s},transaction:t})}}))})(i)},disabled:o,placeholder:"Acme Labs",autosize:!0}),(0,ae.jsxs)(h().Y1,{direction:"horizontal",width:"fill",children:[(0,k().tM)(b)?(0,ae.jsx)(P().A,{}):void 0,(0,k().A2)({membership:f})?(0,ae.jsx)(y().E,{content:(0,ae.jsx)(x().sA,{id:"sidebarTeamModalTab.unownedBadge",defaultMessage:"Unowned"})}):void 0,(0,ae.jsx)("div",{style:{flexGrow:1}}),(0,ae.jsx)(_().TeamJoinLeaveButton,{teamStore:e,onLeavingTeam:()=>T().A.reset(),from:"sidebar_team_modal",navigateToTeamHomeOnJoin:!1})]})]}),p?(0,ae.jsx)(Wn().R,{id:"team-name-validation-error",error:p}):void 0,(0,ae.jsx)(v().D,{styleKey:"captionRegular",colorVariant:"secondary",children:(0,ae.jsx)(x().sA,{id:"sidebarTeamModal.teamCaption.members",defaultMessage:"{numberOfMembers} {numberOfMembers, plural, one {member} other {members}}",values:{numberOfMembers:s}})})]})]})}},559089:(e,t,n)=>{n.d(t,{$:()=>r});var i=()=>n(148307),s=()=>n(165358),o=()=>n(229833),a=()=>n(534177);async function r(e){if("none"!==e)try{const t=function(e){switch(e){case"bell":return i().A.sounds.aiMeetingNotes.notificationBellMp3;case"blip":return i().A.sounds.aiMeetingNotes.notificationBlipMp3;case"tap":return i().A.sounds.aiMeetingNotes.notificationTapMp3;default:(0,a().HB)(e)}}(e),n=new Audio(t);n.onerror=e=>{s().log({level:"warning",from:"playNotificationSound",type:"audioLoadError",error:(0,o().convertErrorToLog)(e)})},await n.play()}catch(t){s().log({level:"warning",from:"playNotificationSound",type:"audioPlaybackError",error:(0,o().convertErrorToLog)(t)})}}},562866:(e,t,n)=>{n.d(t,{$c:()=>l,Xd:()=>r,aI:()=>a,cx:()=>o,uf:()=>s});var i=()=>n(79926);const s={RequestMembersModal:new(i().O2)("RequestMembersModal",(()=>Promise.all([n.e(75134),n.e(35530),n.e(9773),n.e(36556),n.e(55373),n.e(36192),n.e(40537),n.e(71562),n.e(96346),n.e(44711),n.e(53321),n.e(51220),n.e(16471),n.e(37353),n.e(37571),n.e(29151),n.e(40118),n.e(50397),n.e(27992),n.e(63452),n.e(66249),n.e(92845),n.e(87249),n.e(79022),n.e(44854),n.e(87017),n.e(34877),n.e(46414),n.e(11676),n.e(61165),n.e(47668),n.e(94522),n.e(44584),n.e(24587),n.e(67494),n.e(3651),n.e(38293),n.e(40992),n.e(88455),n.e(64556),n.e(33893),n.e(91793),n.e(55162),n.e(71003),n.e(32370),n.e(26264),n.e(36437),n.e(50363),n.e(42660),n.e(44590),n.e(55113),n.e(85071),n.e(7914),n.e(25588),n.e(68637),n.e(23640),n.e(72252),n.e(93134),n.e(12452),n.e(52871),n.e(29351),n.e(18825),n.e(71853),n.e(93049),n.e(22582),n.e(18636),n.e(87289),n.e(16060),n.e(34281),n.e(48376),n.e(35279),n.e(80229),n.e(77754),n.e(71309),n.e(47431),n.e(42056),n.e(16866),n.e(77282)]).then(n.bind(n,123350)))),GoogleImportsInviteWithModal:new(i().O2)("GoogleImportsInviteWithModal",(()=>Promise.all([n.e(55162),n.e(42056),n.e(51226)]).then(n.bind(n,720193)))),MicrosoftImportsInviteWithModal:new(i().O2)("MicrosoftImportsInviteWithModal",(()=>Promise.all([n.e(55162),n.e(42056),n.e(64981)]).then(n.bind(n,72468)))),InviteDropdownMenuItemLabel:new(i().O2)("InviteDropdownMenuItemLabel",(()=>n.e(25171).then(n.bind(n,726799)))),personPropertyInviteActions:new(i().O2)("personPropertyInviteActions",(()=>Promise.all([n.e(55162),n.e(42056),n.e(57613)]).then(n.bind(n,980270))))},o=(0,i()._h)(s.RequestMembersModal,(e=>e.RequestMembersModal)),a=(0,i()._h)(s.GoogleImportsInviteWithModal,(e=>e.GoogleImportsInviteWithModal)),r=(0,i()._h)(s.MicrosoftImportsInviteWithModal,(e=>e.MicrosoftImportsInviteWithModal)),l=(0,i()._h)(s.InviteDropdownMenuItemLabel,(e=>e.InviteDropdownMenuItemLabel))},565711:(e,t,n)=>{n.r(t),n.d(t,{iconDefinition:()=>s,personCropCircleBadgeExclamationPointFillIcon:()=>o});n(296540);var i=n(474848);const s={viewBox:"0 0 20 20",fittedViewBox:"0.5 2.37 17.12 17.13",svg:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{d:"M2.375 10a7.625 7.625 0 1 1 5.992 7.45c.151-.456.233-.944.233-1.45a4.58 4.58 0 0 0-.966-2.82A4.8 4.8 0 0 1 10 12.561c1.754 0 3.298.934 4.087 2.332A6.375 6.375 0 1 0 3.78 11.406q-.643.032-1.23.227A7.7 7.7 0 0 1 2.375 10"}),(0,i.jsx)("path",{d:"M4 12.5a3.5 3.5 0 0 0-1.137.189A3.502 3.502 0 0 0 4 19.5a3.5 3.5 0 1 0 0-7m.031.906c.345 0 .625.28.625.625v2a.625.625 0 1 1-1.25 0v-2c0-.345.28-.625.625-.625m-.625 4.471a.625.625 0 1 1 1.25-.004.625.625 0 0 1-1.25.004M10 5.125c-.95 0-1.723.393-2.245 1.044-.51.635-.75 1.474-.75 2.346s.24 1.71.75 2.346c.522.65 1.295 1.044 2.245 1.044s1.723-.394 2.245-1.044c.51-.635.75-1.474.75-2.346s-.24-1.711-.75-2.346c-.522-.65-1.294-1.044-2.245-1.044"})]})},o=(0,n(340498).wt)("personCropCircleBadgeExclamationPointFill",s,"fill")},568999:(e,t,n)=>{n.d(t,{g:()=>i});const i=(0,n(340498).xh)("checkmarkCircle",{default:{loader:()=>n.e(44032).then(n.bind(n,671089))},small:{loader:()=>n.e(44032).then(n.bind(n,833243))},fill:{loader:()=>n.e(44032).then(n.bind(n,209969))},fillSmall:{loader:()=>n.e(44032).then(n.bind(n,450424))}},["check","mark","tick","confirm","approve"])},572080:(e,t,n)=>{n.r(t),n.d(t,{SpaceSettings:()=>Og});var i=n(296540),s=()=>n(933922),o=()=>n(59226),a=()=>n(484714),r=()=>n(852507),l=()=>n(590526),d=()=>n(401497),c=()=>n(929219),u=()=>n(107975),p=()=>n(882722),g=()=>n(741615),m=()=>n(983610),f=()=>n(807449),h=()=>n(553034),y=()=>n(795523),v=()=>n(69708),b=()=>n(746970),S=()=>n(278768),x=()=>n(209660),M=()=>n(804411),A=()=>n(664594),j=()=>n(242422),w=()=>n(165241),I=(n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(803949),()=>n(314709)),k=()=>n(675133),T=()=>n(792057),C=()=>n(604995),_=()=>n(416845),P=()=>n(348564),B=()=>n(824862),R=()=>n(798880),D=()=>n(769864),L=()=>n(106628),E=()=>n(230357),O=()=>n(757695);class N extends O().Store{getInitialState(){return{spaceId:void 0,allUserIds:new Set,allBotIds:new Set,removedUserIds:new Set,removedBotIds:new Set}}isUserOrBotRemoved(e){return Boolean(e&&(this.state.removedUserIds.has(e)||this.state.removedBotIds.has(e)))}}const F=new N;class U extends O().Store{getInitialState(){return{cachedResponses:{}}}getCursor(e,t,n){if(n<=1||this.state.spaceId!==e)return;const i=(0,E()._)(t);if(this.state.filterStr!==i)return;const s=this.state.cachedResponses[n-1];return"success"===s.status?null==s?void 0:s.nextCursor:void 0}startLoading(e,t){this.updateResultHelper(e,t,{status:"loading"})}updateLoadedResult(e,t,n){this.updateResultHelper(e,t,{...n,status:"success",loadedAt:Date.now()})}updateError(e,t){this.updateResultHelper(e,t,{status:"error"})}updateResultHelper(e,t,n){const i=(0,E()._)(t);1!==t.pageNum&&this.state.spaceId===e&&this.state.filterStr===i?this.setState({spaceId:e,filterStr:i,cachedResponses:{...this.state.cachedResponses,[t.pageNum]:{...n}}}):this.setState({spaceId:e,filterStr:i,cachedResponses:{[t.pageNum||1]:{...n}}})}}const z=new U,K=(0,v().YK)({loadCurrentAuditLogError:{id:"auditlog.error.loadCurrentAuditLogError",defaultMessage:"Failed to load audit logs"}});async function V(e){const{environment:t,spaceId:n,excludeCurrentUsers:i}=e,s=await D().callApi({eventName:"getHistoricalAuditLogUsers",environment:t,data:{spaceId:n,excludeCurrentUsers:i}});return"success"!==s.type?[]:s.data.results}async function q(e){const{environment:t,spaceId:n,shouldUseEdgeCache:i}=e;if(F.getState().spaceId!==n&&F.reset(),!n)return;const s=await L().T.searchActions.load(),[o,a]=await Promise.all([i?{userIds:[],botIds:await s.getSpaceBotIds({environment:t})}:s.searchSpaceActorIds({environment:t,membersOnly:!1}),V({environment:t,spaceId:n,excludeCurrentUsers:i})]),r={spaceId:n,allUserIds:new Set,allBotIds:new Set,removedUserIds:new Set,removedBotIds:new Set};o.userIds.forEach((e=>{r.allUserIds.add(e)})),o.botIds.forEach((e=>{r.allBotIds.add(e)})),a.forEach((e=>{var t;(t=e.actorId)!==B().eR.id&&t!==R().BF.id&&t!==R().mc.id||r.allUserIds.has(e.actorId)?e.actorType!==R().oo||r.allUserIds.has(e.actorId)?e.actorType!==B().GP||r.allBotIds.has(e.actorId)||(r.allBotIds.add(e.actorId),r.removedBotIds.add(e.actorId)):(r.allUserIds.add(e.actorId),r.removedUserIds.add(e.actorId)):r.allUserIds.add(e.actorId)})),F.setState(r)}var W=()=>n(652399),G=()=>n(416504),H=()=>n(42583),Y=()=>n(817865),$=()=>n(582094),Q=()=>n(322976),Z=()=>n(46413),X=(n(354520),n(581454),()=>n(457205)),J=()=>n(849255),ee=()=>n(764880),te=()=>n(313491),ne=()=>n(253673),ie=()=>n(448693),se=()=>n(848401),oe=()=>n(457688),ae=()=>n(47373),re=()=>n(30731),le=n(474848);function de(e){const{parentStore:t,auditLogHistoricalUserStore:n,selectedActors:s,onChange:o}=e,r=(0,v().tz)(),l=(0,a().v3)(),d=(0,ae().ke)(),[c,u]=(0,i.useState)(new Set(s.map(re().Ht))),p=d?(0,le.jsx)(v().sA,{id:"auditlogActorFilter.titleWithAgents",defaultMessage:"Users/Agents"}):(0,le.jsx)(v().sA,{id:"auditlogActorFilter.title",defaultMessage:"User"}),g=(0,i.useCallback)((()=>{const e=Array.from(c).map(re().Hl).filter((e=>void 0!==e));o(e)}),[c,o]),m=(0,i.useCallback)((()=>{const e=s.map(re().Ht);u(new Set(e))}),[s]),f=(0,i.useCallback)((e=>{"applyButton"!==e?m():g()}),[g,m]);return(0,le.jsx)(Q().A,{mode:Q().C.Pill,title:p,icon:ne().personIcon,items:Array.from(c),hasItemsSelected:(null==s?void 0:s.length)>0,onChange:e=>{u(new Set(e))},renderFooter:!0,allowApplyBatchSelection:!0,keepInputOnItemConfirm:!0,onMenuDismiss:f,labelText:{title:p,tokenInputPlaceholder:d?r.formatMessage({defaultMessage:"Search user or agent...",id:"auditlogActorFilter.searchActor.placeholderWithAgents"}):r.formatMessage({defaultMessage:"Search user...",id:"auditlogActorFilter.searchActor.placeholder"}),resultSectionTitle:d?r.formatMessage({defaultMessage:"Select users or agents",id:"auditlogActorFilter.searchActor.resultsTitleWithAgents"}):r.formatMessage({defaultMessage:"Select users",id:"auditlogActorFilter.searchActor.resultsTitle"}),componentDebugName:"SearchActorFilter"},performRequest:e=>async function({args:e,auditLogHistoricalUserStore:t,selectedActors:n,environment:i}){const{query:s}=e,{allUserIds:o,allBotIds:a,spaceId:r}=t.getState(),l=100,d=await L().T.searchActions.load(),c=w().i({userId:i.currentUser.id,spaceId:r,debugFrom:"performRequest"});let u;if(c&&j().default.checkGate({gateName:"edge_cache_audit_log"})&&r){const e=j().default.getConfigKey("email_alias_migration","mode"),t=await D().callApi({eventName:"listUsers",environment:i,data:{cursor:void 0,membershipFilter:void 0,limit:l,sort:"name_normalized",sortDirection:"asc",query:s,spaceId:r,includeAliasSearch:(0,te().K)(e)}});let n=[];"success"===t.type&&(n=t.data.users.map((e=>e.id))),u=await d.searchActorsById({environment:i,query:s,userIds:[...n,...o],botIds:[...a]})}else u=await d.searchActorsById({environment:i,query:s,userIds:[...o],botIds:[...a]});const p=[...u.users.map((e=>`notion_user:${e.id}`)),...u.bots.map((e=>`bot:${e.id}`))];if(s.length>0)return p.slice(0,l);const g=n.map(re().Ht),m=new Set(g),f=p.filter((e=>!m.has(e)));return[...g,...f].slice(0,Math.max(g.length,l))}({args:e,auditLogHistoricalUserStore:n,selectedActors:s,environment:l}),renderResultMenuItem:(e,i)=>{var s;const o=pe(e,t);return(0,le.jsx)(ce,{...i,item:e,tempActorSelections:c,showRemovedBadge:n.isUserOrBotRemoved(null===(s=o.asActor)||void 0===s?void 0:s.id),actor:o,intl:r})},renderToken:(e,n)=>(0,le.jsx)(ue,{item:e,handlers:n,tempActorSelections:c,parentStore:t}),renderFilter:()=>null,renderItemForSummary:()=>null,addItemLabel:null,focused:!1})}const ce=(0,i.forwardRef)(((e,t)=>{const{item:i,tempActorSelections:s,showRemovedBadge:o,actor:a}=e;return(0,le.jsx)(oe().A,{...e,ref:t,actor:a,useEmailAsTooltip:!0,isChecked:s.has(i),badge:o?(0,le.jsx)(n(970236).E,{content:(0,le.jsx)(v().sA,{id:"auditlogActorFilter.removed_user",defaultMessage:"Removed"})}):null})}));function ue({item:e,handlers:t,tempActorSelections:n,parentStore:i}){const s=1===n.size,o=(0,l().K8)((()=>pe(e,i)),[i,e]);return o?(0,le.jsx)(ie().Ay,{format:se().mI.Small,showRemoveButton:!0,isSingle:s,onClickRemove:t.onRemove,actor:o,shouldShrink:!0,hasPersonHoverCard:!1},e):null}function pe(e,t){const n=(0,re().Hl)(e);return n?"notion_user"===n.actorType?(0,ee().MR)(function(e,t){return J().L.createChildStore(t,{table:R().oo,id:e}).getModel()}(n.actorId,t)):(0,ee().oC)(function(e,t){return X().v.createChildStore(t,{table:B().GP,id:e}).getModel()}(n.actorId,t)):(0,ee().MR)(void 0)}ce.displayName="ResultMenuItem";var ge=()=>n(312607),me=()=>n(896198);const fe=(0,v().YK)({auditLogNotSupportedDateRangeError:{id:"auditLog.dateTimeRangeMenu.notSupportedDateRange",defaultMessage:"Audit Log retains events from the past year."}});function he(e){const{spaceStore:t,relatedFilterText:n,onClearRelatedFilterText:i}=e,s=(0,v().tz)(),[o,a]=(0,l().$y)(E().A),[r,d,c]=(0,l().$y)(F),u=(0,l().uB)(void 0,Z().D),p=(0,l().uB)(void 0,Z().D),g=(0,C().ah)((0,G().P)());return(0,le.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:4},children:[(0,le.jsx)(Y().A,{mode:Q().C.Pill,focused:!1,title:(0,le.jsx)(v().sA,{id:"auditlogDateFilter.title",defaultMessage:"Date"}),icon:H().D,value:o.timeRange,showButtons:"footer",onChange:e=>{a({...o,timeRange:e,pageNum:1})},minDate:g.minus({years:1}),maxDate:g.endOf("day"),customErrorMessage:e=>{if(e===$().$.NOT_SUPPORTED)return s.formatMessage(fe.auditLogNotSupportedDateRangeError)}}),(0,le.jsx)(de,{parentStore:t,auditLogHistoricalUserStore:c,selectedActors:o.actors,onChange:e=>{a({...o,actors:e,pageNum:1})}}),(0,le.jsx)(ge().A,{lastSelectionStore:u,componentStore:p,onChange:e=>{a({...o,actions:e,pageNum:1})}}),o.rootRequestId?(0,le.jsx)(me().o,{eventText:n,onRemove:()=>{a({...o,rootRequestId:void 0,pageNum:1}),null==i||i()}}):null]})}var ye=()=>n(284371),ve=()=>n(8178);function be(){return(0,le.jsx)(ve().A,{large:!0,style:{marginBottom:0,paddingBottom:0,fontSize:16,fontWeight:ye().Wy.medium,display:"flex",justifyContent:"space-between"},children:(0,le.jsx)("div",{style:{gap:8,display:"flex"},children:(0,le.jsx)(v().sA,{id:"auditlog.title",defaultMessage:"Audit log"})})})}var Se=()=>n(366951),xe=()=>n(726637),Me=()=>n(718827),Ae=()=>n(940148),je=()=>n(26697),we=()=>n(302501),Ie=()=>n(326346),ke=()=>n(735230);function Te(e){const{auditLogEntry:t,spaceStore:n}=e,s=(0,v().tz)(),a=(0,o().X)("automations_attribution_ui"),r=(0,o().X)("mcp_actor_audit_logs_enabled"),c=(0,l().K8)((()=>(0,re().OR)(t,n,s,a,r)),[n,t,s,a,r]),u=(0,l().K8)((()=>{var e,t;if(c)return(null===(e=c.actorStore)||void 0===e?void 0:e.getDisplayName(s))??(null===(t=c.avatar)||void 0===t?void 0:t.name)}),[c,s]),p=(0,l().K8)((()=>{var e,t;if(c)return(null===(e=c.actorStore)||void 0===e?void 0:e.getDetail())??(null===(t=c.avatar)||void 0===t?void 0:t.email)}),[c]),g=(0,i.useMemo)((()=>{if(t.actor.actorType===R().oo){var e;const n=null===(e=t.actor.meta)||void 0===e?void 0:e.spaceRole;if(n)return(0,P().jH)(n)}}),[t]),m=(0,d().IS)((()=>({container:{display:"block",width:"100%",paddingBlock:6}})),[]),f=(0,i.createRef)();return(0,le.jsx)(je().m,{disableTooltip:Ce(f.current),renderTooltip:()=>(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)("div",{children:u}),(0,le.jsx)("div",{children:p})]}),placement:"bottom",render:e=>(0,le.jsx)("div",{...e,style:m.container,children:(0,le.jsx)(ke().A,{...c,spaceRole:g})})})}function Ce(e){return!!e&&(e.scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth)}var _e=()=>n(617842);const Pe={id:"actor",headerTitle:(0,le.jsx)(v().sA,{id:"auditlog.logTable.userColumn.header",defaultMessage:"User"}),renderCell:e=>(0,le.jsx)(Te,{spaceStore:e.spaceStore,auditLogEntry:e.auditLogEntry}),widthData:{width:30},sortable:!1},Be={id:"event",headerTitle:(0,le.jsx)(v().sA,{id:"auditlog.logTable.eventColumn.header",defaultMessage:"Event"}),renderCell:e=>{const t=`event-${e.auditLogEntry.actionName}-${e.id}`;return(0,le.jsx)(n(17297).m,{auditLogEntry:e.auditLogEntry,id:t,isRelatedFilterEnabled:e.isRelatedFilterEnabled,isRelatedFilterActive:e.isRelatedFilterActive,onRequestRelatedFilter:e.onApplyRelatedFilter})},widthData:{width:40},sortable:!1},Re={id:"dateTimeAndMenu",headerTitle:(0,le.jsx)(v().sA,{id:"auditlog.logTable.dateColumn.header",defaultMessage:"Date"}),renderCell:e=>{const t=`actor-${e.auditLogEntry.actionName}-${e.id}`,i=`event-${e.auditLogEntry.actionName}-${e.id}`,s=`datetime-${e.auditLogEntry.actionName}-${e.id}`;return(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(n(829351).V,{auditLogEntry:e.auditLogEntry,id:s}),(0,le.jsx)(Oe,{auditLogEntry:e.auditLogEntry,ids:{actorColumnId:t,eventColumnId:i,dateTimeColumnId:s}})]})},widthData:{width:25},sortable:!0},De=[Pe,Be,Re];function Le(e){const{searchResponse:t,spaceStore:n,onRelatedFilterSelected:s}=e,[a,r]=(0,l().$y)(E().A),d=t.results||[],c=t.hasMoreResults,u=Boolean(d.length),p=e=>{const t={...a,pageNum:e};r(t)},g=(0,i.useMemo)((()=>(0,Ae().rC)({columnRenderInfo:De,containerMarginTop:0})),[]),m=(0,o().X)("audit_log_filter_request_id"),f=(0,i.useCallback)(((e,t)=>{m&&(r({...a,rootRequestId:e,pageNum:1}),null==s||s(t))}),[a,m,s,r]),h=d.map(((e,t)=>{var i;const s=null===(i=e.requestMetadata)||void 0===i||null===(i=i.rootRequestContextId)||void 0===i?void 0:i.requestId;return{id:t.toString(),auditLogEntry:e,spaceStore:n,isRelatedFilterEnabled:m&&Boolean(s),isRelatedFilterActive:Boolean(a.rootRequestId),onApplyRelatedFilter:f,isClickable:!1}})),y=(0,i.useCallback)((()=>{const e=a.sortOrder===P().K7.CreatedOldest?P().K7.CreatedNewest:P().K7.CreatedOldest;r({...a,sortOrder:e,pageNum:1})}),[a,r]),b=(0,i.useMemo)((()=>({column:Re,sortAscending:a.sortOrder===P().K7.CreatedOldest})),[a]);return(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(Ae().WE,{hideHeaderRowPadding:!0,showRowBorders:!0,columnRenderInfo:De,rows:h,sortState:b,onSortStateChanged:y,renderNoRowsComponent:Ee,styles:g}),u?(0,le.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:10},children:[(0,le.jsx)(_e().M,{onClick:()=>{p(a.pageNum-1)},disabled:1===a.pageNum,children:(0,le.jsx)(v().sA,{id:"auditlog.logTable.previousPage",defaultMessage:"Previous"})}),(0,le.jsx)(_e().M,{disabled:!c,onClick:()=>{p(a.pageNum+1)},children:(0,le.jsx)(v().sA,{id:"auditlog.logTable.nextPage",defaultMessage:"Next"})})]}):null]})}function Ee(){return(0,le.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"40vh",flexDirection:"column"},children:[(0,le.jsx)("div",{children:(0,le.jsx)(we().A,{isSecondaryColor:!0,style:{fontWeight:500},children:(0,le.jsx)(v().sA,{id:"auditlog.logTable.noResults",defaultMessage:"No results"})})}),(0,le.jsx)(we().A,{isSecondaryColor:!0,children:(0,le.jsx)(v().sA,{id:"auditlog.logTable.noResultsHelpText",defaultMessage:"Try different filters. Logs may take some time to show up."})})]})}function Oe(e){const{auditLogEntry:t,ids:i}=e,s=(0,l().K8)((()=>(0,ae().Qd)()),[]),o=Ie().Gb,r=(0,v().tz)(),c=(0,a().v3)(),u=(0,d().IS)((()=>({container:{display:"flex",alignItems:"center",justifyContent:"flex-end",width:"100%"},button:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:28,borderRadius:6}})),[]);return(0,le.jsx)(je().m,{delayThreshold:80,placement:"bottom",render:e=>(0,le.jsx)("div",{style:u.container,...e,children:(0,le.jsx)(Me().Ay,{style:u.button,onClick:async e=>{const[a,l]=await Promise.all([(0,n(692031).r)(),(0,n(212497).jd)()]);let d=(0,Ie().ZM)({auditLogEntry:t,intl:r,getAuditLogEventText:(u=i.eventColumnId,e=>{var t;return null===(t=document.getElementById(u))||void 0===t?void 0:t.textContent}),isTeamGuestsEnabled:s,csvColumnNames:o});var u;l({environment:c,stringValue:d,copiedMessage:a.copiedToClipboard})},children:(0,le.jsx)(f().I,{icon:n(536583).d,size:"sm",colorVariant:"secondary"})})}),renderTooltip:()=>(0,le.jsx)(v().sA,{id:"AuditLogSettings.copyAuditLogEvent",defaultMessage:"Copy row"})})}function Ne(e){const{spaceStore:t}=e,n=(0,a().v3)(),s=null==t?void 0:t.id,o=(0,A().T)(),[r,d]=(0,i.useState)(),[c]=(0,l().$y)(z),[u]=(0,l().$y)(E().A),p=(0,E()._)(u)!==c.filterStr?void 0:c.cachedResponses[u.pageNum];(0,i.useEffect)((()=>{s&&async function(e){var t,n;const{environment:i,spaceId:s}=e,o=E().A.getState();z.startLoading(s,o);const{sortOrder:a,pageSize:r,pageNum:l}=o,d={spaceId:s,limit:r,cursor:z.getCursor(s,o,l),filters:{timeRange:{starting:o.timeRange.starting?C().C6.toUnixMs(o.timeRange.starting):void 0,ending:o.timeRange.ending?C().C6.toUnixMs(o.timeRange.ending):void 0},...(null===(t=o.actors)||void 0===t?void 0:t.length)>0?{actors:o.actors}:void 0,...(null===(n=o.actions)||void 0===n?void 0:n.length)>0?{actions:o.actions}:void 0,...o.rootRequestId?{rootRequestContextId:o.rootRequestId}:void 0},sort:a||P().K7.CreatedNewest},c=await D().callCellCompatibleApi({eventName:"searchAuditLog",environment:i,data:d,cellNavigation:{spaceId:d.spaceId}});if("success"!==c.type)if(z.updateError(s,o),(0,_().op4)(c.body)){const e=(0,I().H)(k().A.getIntl(),c);T().f1(e)}else T().f1(k().A.formatMessage(K.loadCurrentAuditLogError));else z.updateLoadedResult(s,o,c.data)}({environment:n,spaceId:s})}),[n,s,u]);const g=(0,l().K8)((()=>j().default.checkGate({gateName:"edge_cache_audit_log"})&&w().i({userId:o,spaceId:s,debugFrom:"AuditLogSettings"})),[o,s]);return(0,i.useEffect)((()=>{q({environment:n,spaceId:s,shouldUseEdgeCache:g})}),[n,s,g]),(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(be,{}),(0,le.jsxs)("div",{style:{justifyContent:"space-between",display:"flex",paddingTop:12,paddingBottom:12},children:[(0,le.jsx)(he,{spaceStore:t,relatedFilterText:r,onClearRelatedFilterText:()=>d(void 0)}),(0,le.jsx)(W().A,{parentStore:t})]}),"loading"===(null==p?void 0:p.status)?(0,le.jsx)(Se().A,{}):void 0,"success"===(null==p?void 0:p.status)?(0,le.jsx)(Le,{searchResponse:p,spaceStore:t,onRelatedFilterSelected:e=>d(e)}):void 0]})}var Fe=()=>n(79926);const Ue=new(Fe().O2)("collectionDebugSettings",(()=>n.e(26403).then(n.bind(n,917682)))),ze=(0,Fe()._h)(Ue,(e=>e.CollectionDebugSettings));var Ke=()=>n(223034),Ve=()=>n(907258),qe=()=>n(396896),We=()=>n(493552),Ge=()=>n(187174),He=()=>n(96689),Ye=()=>n(908928),$e=()=>n(94871),Qe=()=>n(404141),Ze=()=>n(964556),Xe=()=>n(843878);const Je=(0,v().YK)({title:{id:"spaceConnectionsSettings.title",defaultMessage:"Connections"},description:{id:"spaceConnectionsSettings.description",defaultMessage:"Set up and manage the apps you connect with Notion"},error:{id:"spaceIntegrationSettings.error",defaultMessage:"Something went wrong…"}});const et=function({spaceStore:e,organizationOverrides:t}){const s=(0,a().v3)(),o=(0,l().O$)(Ve().AppStoreSidebarSpaceStore),r=(0,l().K8)((()=>(0,n(511393).h)(s)),[s]),[d,c]=(0,i.useState)(!1),u=(0,i.useCallback)((e=>{c(e)}),[]);(0,i.useEffect)((()=>(Qe().Ay.setHideCloseButton(d),()=>{Qe().Ay.setHideCloseButton(!1)})),[d]),(0,i.useEffect)((()=>{r||x().Ow({currentTab:"members"})}),[r]);const[{value:p,error:g,status:m}]=(0,Ge().Yb)((()=>async function(e,t){const n=await Promise.all([Ye().Ju({environment:e,table:He().NX,id:t,type:"guest"}),Ze().refreshExternalIntegrationStore({environment:e}),$e().refreshComplianceIntegrationStore({environment:e})]);return{guestBotIds:n[0].botIds}}(s,e.id)),[e.id,s]),f="resolved"===m||"rejected"===m;return r&&o?(0,le.jsxs)(Xe().Ay,{contentPaddingLeftRight:d?0:void 0,contentPaddingTopBottom:d?0:void 0,children:[d?void 0:(0,le.jsxs)(qe().VP,{gap:4,marginBottom:16,children:[(0,le.jsx)(We().D,{styleKey:"titleLgSemibold",colorVariant:"primary",children:(0,le.jsx)(v().sA,{...Je.title})}),(0,le.jsx)(We().D,{styleKey:"bodyLgRegular",colorVariant:"secondary",children:(0,le.jsx)(v().sA,{...Je.description})})]}),(0,le.jsx)(n(378765).A,{loaded:f,spinnerSize:"sm",showSpinnerTimeout:600,children:g?(0,le.jsx)("div",{children:(0,le.jsx)(v().sA,{...Je.error})}):p?(0,le.jsx)(n(483979).Ay,{...p,organizationOverrides:t,onBreadcrumbViewChange:u}):null})]}):null};var tt=()=>n(313633);const nt=new(Fe().O2)("ExperimentSettings",(()=>Promise.all([n.e(23930),n.e(7717)]).then(n.bind(n,137341)))),it=(0,Fe()._h)(nt,(e=>e.ExperimentSettings));var st=()=>n(739793),ot=()=>n(755531),at=()=>n(388926),rt=()=>n(534177),lt=()=>n(778450),dt=()=>n(63728),ct=()=>n(192359);var ut=()=>n(232930),pt=()=>n(419860),gt=()=>n(882462),mt=()=>n(920198),ft=()=>n(72234),ht=()=>n(229508),yt=()=>n(559089),vt=()=>n(702723);const bt=(0,v().YK)({notificationSoundLabel:{id:"notificationSettings.aiMeetingNotesSound.label",defaultMessage:"Meeting notification sound"},notificationSoundDescription:{id:"notificationSettings.aiMeetingNotesSound.description",defaultMessage:"Sound to play for scheduled meeting notifications"},soundBell:{id:"notificationSettings.aiMeetingNotesSound.bell",defaultMessage:"Bell"},soundBlip:{id:"notificationSettings.aiMeetingNotesSound.blip",defaultMessage:"Blip"},soundTap:{id:"notificationSettings.aiMeetingNotesSound.tap",defaultMessage:"Tap"},soundNone:{id:"notificationSettings.aiMeetingNotesSound.none",defaultMessage:"No sound"}});function St(){const e=(0,a().v3)(),t=(0,mt().L)(),n=(0,ht().a)(),i=(0,l().K8)((()=>{var e;return(null==n||null===(e=n.getSettingsStore())||void 0===e||null===(e=e.getKeyStore("ai_meeting_notes_notification_sound"))||void 0===e?void 0:e.getValue())??"blip"}),[n]);return(0,le.jsx)(vt().A,{spaceStore:t,type:"dropdown",currentOption:i,options:[{key:"none",label:(0,le.jsx)(v().sA,{...bt.soundNone})},{key:"blip",label:(0,le.jsx)(v().sA,{...bt.soundBlip})},{key:"bell",label:(0,le.jsx)(v().sA,{...bt.soundBell})},{key:"tap",label:(0,le.jsx)(v().sA,{...bt.soundTap})}],onSelectOption:t=>{ft().zv(e,t),(0,yt().$)(t)},title:(0,le.jsx)(v().sA,{...bt.notificationSoundLabel}),caption:(0,le.jsx)(v().sA,{...bt.notificationSoundDescription})})}var xt=()=>n(699143),Mt=()=>n(100622),At=()=>n(677169),jt=()=>n(208993),wt=()=>n(890494);const It=17,kt=(0,Fe()._h)(new(Fe().O2)("inAppMeetingActivityStageTooltip",(()=>Promise.all([n.e(75134),n.e(49021),n.e(6039),n.e(39005),n.e(86518)]).then(n.bind(n,771398)))),(e=>e.InAppMeetingActivityStageTooltip));function Tt(){var e;const t=(0,a().v3)(),n=(0,l().O$)(Ve().AppStoreSidebarSpaceStore),s=null===(e=(0,At().m)())||void 0===e?void 0:e.botId,[o,r]=(0,i.useState)(null),c=!Boolean(s),u=(0,l().K8)((()=>{var e;return(null===(e=Ve().AppStoreSidebarSpaceViewStore.state)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.disabled_in_app_meeting_activity_stages)??{}}),[]),p=(0,i.useMemo)((()=>[{activityType:"upcoming",label:Ct.joinVideoConferencingLabel,isLocked:c},{activityType:"transcription",label:Ct.activelyTranscribingLabel,isLocked:!1},{activityType:"summarization",label:Ct.summarizingMeetingNoteLabel,isLocked:c}]),[c]),g=(0,d().IS)((()=>({header:{marginBottom:6},headerDescription:{marginBottom:12},rowContainer:{paddingTop:It,paddingBottom:It},lastRowContainer:{marginBottom:-It},rowSeparator:{borderBottom:`1px solid ${Mt().Tj.border.secondary}`}})),[]);return(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(ve().A,{style:g.header,children:(0,le.jsx)(v().sA,{...Ct.inAppMeetingActivitySettingsHeader})}),(0,le.jsx)(We().D,{styleKey:"bodySmRegular",colorVariant:"secondary",style:g.headerDescription,children:(0,le.jsx)(v().sA,{...Ct.inAppMeetingActivitySettingsDescription})}),p.map(((e,s)=>(0,le.jsxs)(i.Fragment,{children:[s>0?(0,le.jsx)("div",{style:g.rowSeparator}):void 0,(0,le.jsx)("div",{style:{...g.rowContainer,...s===p.length-1?g.lastRowContainer:{}},onMouseEnter:()=>r(e.activityType),onMouseLeave:()=>r(null),children:(0,le.jsx)(vt().A,{spaceStore:n,type:"toggle",isLocked:e.isLocked,lockedTooltip:(0,le.jsx)(v().sA,{...Ct.noConnectedCalendarTooltip}),isOn:!e.isLocked&&!Boolean(null==u?void 0:u[e.activityType]),onToggle:()=>{ft().mD({environment:t,stage:e.activityType})},title:(0,le.jsxs)(xt().Y1,{direction:"horizontal",gap:10,align:"center-left",children:[(0,le.jsx)(wt().A,{number:s+1}),(0,le.jsxs)(xt().Y1,{direction:"horizontal",gap:6,align:"center-left",children:[(0,le.jsx)(v().sA,{...e.label}),(0,le.jsx)(jt().W,{tooltipTitle:(0,le.jsx)(kt,{activityType:e.activityType}),forceVisibleState:o===e.activityType})]})]})},e.activityType)})]},e.activityType)))]})}const Ct=(0,v().YK)({inAppMeetingActivitySettingsHeader:{id:"aiSettings.inAppMeetingActivitySettingsHeader",defaultMessage:"Live meeting activity"},inAppMeetingActivitySettingsDescription:{id:"aiSettings.inAppMeetingActivitySettingsDescription",defaultMessage:"Configure which in-app popups appear throughout your video conferencing and AI meeting notes experience"},joinVideoConferencingLabel:{id:"aiSettings.inAppMeetingActivity.joinVideoConferencing.label",defaultMessage:"Join video conferencing and start transcribing"},activelyTranscribingLabel:{id:"aiSettings.inAppMeetingActivity.startTranscribing.label",defaultMessage:"Actively transcribing"},summarizingMeetingNoteLabel:{id:"aiSettings.inAppMeetingActivity.summarizingMeetingNote.label",defaultMessage:"Summarizing meeting note"},noConnectedCalendarTooltip:{id:"aiSettings.inAppMeetingActivity.noConnectedCalendarTooltip",defaultMessage:"Connect a calendar to enable this feature"}});var _t=()=>n(406094),Pt=()=>n(502492),Bt=()=>n(597755);function Rt(){const{isElectron:e,isMac:t,isWindows:n}=(0,a().Y0)(),s=(0,a().v3)(),o=(0,l().O$)(dt().l),r=(0,mt().L)();(0,i.useEffect)((()=>{e||!t&&!n||null!==o||(0,lt().e)(s)}),[e,t,n,o,s]);const d=(0,i.useCallback)((()=>{const e=(0,Bt().Vr)(window.location.href,"notifications");window.open(Pt().$J({httpUrl:e,protocol:xe().A.protocol}))}),[]);return e||xe().A.isMobile||!t&&!n?null:null!==o&&o?(0,le.jsx)(vt().A,{spaceStore:r,title:(0,le.jsx)(v().sA,{id:"desktopPushNotificationSetting.title",defaultMessage:"Desktop app push notifications"}),caption:(0,le.jsx)(v().sA,{id:"desktopPushNotificationSetting.caption",defaultMessage:"Configure push notification settings in the Notion desktop app."}),type:"custom",disableSettingsItemClick:!0,customButton:(0,le.jsx)(_t().A,{size:"lg",onClick:d,children:(0,le.jsx)(v().sA,{id:"desktopPushNotificationSetting.openAppButton",defaultMessage:"Open desktop app"})})}):null}n(672577);var Dt=()=>n(365917),Lt=()=>n(770063),Et=()=>n(617871),Ot=()=>n(402904),Nt=()=>n(384944),Ft=()=>n(547149),Ut=()=>n(347306),zt=()=>n(963550),Kt=()=>n(250910),Vt=()=>n(546926),qt=()=>n(890492),Wt=()=>n(81068),Gt=()=>n(663639),Ht=()=>n(736847),Yt=()=>n(324254),$t=()=>n(617668),Qt=()=>n(973647),Zt=()=>n(510683);function Xt(e){const{currentExternalAuthentication:t,externalAuthentications:n,spaceId:s,spaceViewStore:o}=e,r=(0,a().v3)(),c=(0,a().Y0)(),u=(0,l().K8)((()=>Dt().A.integrations.state.find((e=>e.id===Et().wi))),[]),p=(0,d().IS)((()=>({popupContainer:{display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:14,marginTop:12},dropdownButtonContainer:{display:"flex",alignItems:"center",minWidth:0,padding:"0px 8px",borderRadius:4,marginInlineStart:8},currentValueLabel:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",flex:1}})),[]);let g;g=c.isPhone?{menuType:Vt().gu.ActionSheet}:{menuType:Vt().gu.Popup,width:280,maxHeight:"50vh"};const m=i.useCallback((e=>n.map(((n,i)=>({key:n.id,items:[{key:n.id,action:()=>{e.close(),Jt({environment:r,spaceViewStore:o,currentExternalBotId:null==t?void 0:t.parent_id,selectedExternalBotId:n.parent_id})},render:e=>(0,le.jsx)(Wt().A,{...e,title:n.account_name||"Discord Account",isChecked:n.id===(null==t?void 0:t.id)})}],render:e=>(0,le.jsx)(Ht().A,{...e,title:n.account_name||"Discord Account",topBorder:0!==i})})))),[null==t?void 0:t.id,null==t?void 0:t.parent_id,r,n,o]),h=i.useCallback((e=>u?[{key:"disable-notification",items:[{key:"disable-discord-notification",action:()=>{e.close(),function(e){const{environment:t,spaceViewStore:n}=e;Ft().createAndCommit({userAction:"NotificationsAndPersonalSettings.DiscordNotificationsAccountSetting",environment:t,canUndo:!0,perform:e=>{Nt().zv({store:n.getSettingsStore(),data:{notify_discord:null},transaction:e})}})}({environment:r,spaceViewStore:o})},render:e=>(0,le.jsx)(Wt().A,{...e,title:(0,le.jsx)(v().sA,{id:"personalDiscordNotificationsAccountDropdownButton.disableNotification.label",defaultMessage:"Off"}),isChecked:void 0===t})}],render:e=>(0,le.jsx)(Ht().A,{...e,topBorder:m.length>0})},{key:"create-new-auth",items:[{key:"connect",render:e=>(0,le.jsx)(Wt().A,{...e,icon:(0,le.jsx)(f().I,{icon:$t().plusIcon}),title:(0,le.jsx)(v().sA,{id:"database.viewSettings.notificationsTab.discord.addNewAccount.label",defaultMessage:"Add new account"})}),action:async()=>{var e;const t=await Zt().Jq({environment:r,integration:u,spaceId:s,from:"notifications_and_settings"});if(Qt().Q.isFail(t))return;const n=null===(e=t.value.externalAuthentication)||void 0===e?void 0:e.parent_id;n&&Jt({environment:r,spaceViewStore:o,currentExternalBotId:void 0,selectedExternalBotId:n})}}],render:e=>(0,le.jsx)(Ht().A,{...e,topBorder:!0})}]:[]),[t,r,m.length,s,o,u]),y=function(e){const{currentExternalAuthentication:t}=e;if(!t)return null;const n=t.account_name||"Discord Account";return n}(e);return(0,le.jsx)("div",{style:p.popupContainer,children:(0,le.jsx)(Kt().A,{popupType:Kt().z.Popup,alignmentToOrigin:"end",render:e=>(0,le.jsx)(qt().A,{...g,children:(0,le.jsx)(Gt().A,{type:Gt().O.Vertical,initialFocus:0,sections:[...m(e),...h(e)]})}),renderOrigin:e=>(0,le.jsxs)(Me().Ay,{...e,style:p.dropdownButtonContainer,children:[(0,le.jsx)("div",{style:p.currentValueLabel,children:y||(0,le.jsx)(v().sA,{id:"DiscordNotificationsPersonalSettingsAccountPicker.accountDropdown.selectPlaceholder",defaultMessage:"Off"})}),(0,le.jsx)("span",{style:{marginInlineStart:8},children:(0,le.jsx)(f().I,{icon:Yt().arrowChevronSingleDownSmallIcon,size:"xs",colorVariant:"tertiary"})})]})})})}function Jt(e){const{environment:t,spaceViewStore:n,selectedExternalBotId:i,currentExternalBotId:s}=e,o=n.getSettingsStore(),a=o.getKeyStore("notify_discord").getValue();if(s!==i){const e=!s||Boolean(null==a?void 0:a.notify_discord_enabled),n=!s||Boolean(null==a?void 0:a.allow_discord_ai_usage);Ft().createAndCommit({userAction:"NotificationsAndPersonalSettings.DiscordNotificationsAccountSetting",environment:t,canUndo:!0,perform:t=>{Nt().zv({store:o,data:{notify_discord:{external_bot_id:i,notify_discord_enabled:e,allow_discord_ai_usage:n}},transaction:t})}})}}function en(e){const t=(0,a().v3)(),{target:n}=e,s=(0,l().O$)(Ve().AppStoreSidebarSpaceViewStore),o=(0,l().O$)(Ve().AppStoreSidebarSpaceStore),r=(0,l().O$)(Dt().A.externalAuthentications),d=(0,l().K8)((()=>r.filter((e=>e.integration_id===Et().wi))),[r]),c=(0,l().K8)((()=>{var e;const t=null==s||null===(e=s.getSettings())||void 0===e||null===(e=e.notify_discord)||void 0===e?void 0:e.external_bot_id;if(!t)return;const n=d.find((e=>e.parent_id===t));if(n)return n;if(!s)return;const i=(0,Lt().v3)(s,{id:t,table:Ot().As}),o=i.id,a=i.getKeyStore("parent_id").getValue(),r=i.getKeyStore("account_name").getValue();return o&&a&&void 0!==r?{id:o,parent_id:a,account_name:r}:void 0}),[s,d]),u=(0,l().K8)((()=>{var e;const t=null==s||null===(e=s.getSettingsStore())||void 0===e||null===(e=e.getKeyStore("notify_discord"))||void 0===e?void 0:e.getValue();switch(n){case"notify_discord_enabled":return c&&(null==t?void 0:t.notify_discord_enabled)||!1;case"allow_discord_ai_usage":return(null==t?void 0:t.allow_discord_ai_usage)||!1;case"notify_discord":return!1;default:(0,rt().HB)(n)}}),[s,n,c]),p=(0,i.useCallback)((()=>{if(s){const e=!u,i=s.getSettingsStore();let o=i.getKeyStore("notify_discord").getValue();if(!o)return;"notify_discord_enabled"===n?(o[n]=e,e||o.allow_discord_ai_usage||(o=void 0),Ft().createAndCommit({userAction:"DiscordNotificationsSetting.onToggle",environment:t,canUndo:!0,perform:e=>{Nt().zv({store:i,data:{notify_discord:o},transaction:e})}})):"allow_discord_ai_usage"===n&&(o[n]=e,Ft().createAndCommit({userAction:"DiscordNotificationsSetting.onToggle",environment:t,canUndo:!0,perform:e=>{Nt().zv({store:i,data:{notify_discord:o},transaction:e})}}))}}),[t,s,u,n]);return s&&o?"notify_discord"===n?(0,le.jsx)(vt().A,{spaceStore:o,type:"custom",title:(0,le.jsx)(zt().A,{target:n}),caption:c?(0,le.jsx)(v().sA,{id:"notificationSettings.discordNotificationsSettings.serverSelected.description",defaultMessage:"Receive notifications in {discordServerName} about mentions and comments.",values:{discordServerName:(0,le.jsx)("span",{style:{fontWeight:"bold"},children:c.account_name})}}):(0,le.jsx)(Ut().A,{target:n}),customButton:(0,le.jsx)(Xt,{currentExternalAuthentication:c,externalAuthentications:d,spaceId:o.id,spaceViewStore:s})}):c?(0,le.jsx)(vt().A,{spaceStore:o,title:(0,le.jsx)(zt().A,{target:n}),caption:(0,le.jsx)(Ut().A,{target:n}),type:"toggle",isOn:u,onToggle:p}):null:null}var tn=()=>n(690197),nn=()=>n(865464),sn=()=>n(537296),on=()=>n(388450);function an(){const{isElectron:e,isElectronMac:t,desktopAppId:n,isMac:s,isWindows:r}=(0,a().Y0)(),d=(0,a().v3)(),c=(0,l().K8)((()=>(0,ot().S)()),[]),u=(0,l().O$)(dt().l);(0,i.useEffect)((()=>{e||!s&&!r||null!==u||(0,lt().e)(d)}),[e,s,r,u,d]);const p=(0,o().X)("navigate_to_desktop_setting_in_browser_enabled")&&!e&&!xe().A.isMobile&&(s||r)&&!0===u,g=(0,o().X)("show_discord_notion_ai_option"),m=(0,l().K8)((()=>(0,gt().Z5)({spaceStore:c})),[c]),f=(0,pt().l)(),h=(0,o().X)("in_app_activity_renderer")&&!xe().A.isMobile,y=(0,l().K8)((()=>{const i=(0,gt().fb)({spaceStore:c});return function(e){const{isMobile:t,isElectron:n,isElectronMac:i,desktopAppId:s,featureGateChecks:{showSlackNotificationSetting:o,showNotionActivityNotificationsToSlackSetting:a,showUpcomingMeetingNotificationSetting:r}}=e,l=!t&&n,d=l&&i&&Boolean(s),c=l,u=n&&(0,ct().M5)();return[t?{key:"notify_mobile",renderSettingsItem:()=>(0,le.jsx)(nn().L,{target:"notify_mobile"})}:void 0,l?{key:"notify_desktop",renderSettingsItem:()=>(0,le.jsx)(nn().L,{target:"notify_desktop"})}:void 0,u?{key:"disable_ai_meeting_notes_audio_process_detection_notification",renderSettingsItem:()=>(0,le.jsx)(nn().L,{target:"disable_ai_meeting_notes_audio_process_detection_notification"})}:void 0,n&&r?{key:"disable_ai_meeting_notes_upcoming_meeting_notification",renderSettingsItem:()=>(0,le.jsx)(nn().L,{target:"disable_ai_meeting_notes_upcoming_meeting_notification"})}:void 0,n&&r?{key:"ai_meeting_notes_notification_sound",renderSettingsItem:()=>(0,le.jsx)(St,{})}:void 0,d?{key:"desktop_badge",renderSettingsItem:()=>(0,le.jsx)(nn().L,{target:"desktop_badge"})}:void 0,c?{key:"send_test_notification",renderSettingsItem:()=>(0,le.jsx)(nn().L,{target:"send_test_notification"})}:void 0,o&&!a?{key:"notify_slack",renderSettingsItem:()=>(0,le.jsx)(on().R,{target:"notify_slack"})}:void 0].filter(rt().O9)}({isMobile:xe().A.isMobile,isElectron:e,isElectronMac:t,desktopAppId:n,featureGateChecks:{showSlackNotificationSetting:i,showNotionActivityNotificationsToSlackSetting:m,showUpcomingMeetingNotificationSetting:f}})}),[e,c,t,n,m,f]),b=function(e){const{showInAppMeetingActivitySettings:t}=e;if(!t)return[];return[{key:"in_app_meeting_activity",renderSettingsItem:()=>(0,le.jsx)(Tt,{})}]}({showInAppMeetingActivitySettings:h}),S=(0,l().K8)((()=>{var e;const t=(0,gt().fb)({spaceStore:c});return function(e){const{isSlackNotificationSettingEnabled:t,showSlackNotificationSetting:n,showNotionActivityNotificationsToSlackSetting:i}=e;if(!n||!i)return[];return[{key:"notify_slack",renderSettingsItem:()=>(0,le.jsx)(on().R,{target:"notify_slack"})},t?{key:"notify_slack_all_activity",renderSettingsItem:()=>(0,le.jsx)(on().R,{target:"notify_slack_all_activity"})}:void 0,t?{key:"notify_slack_mention",renderSettingsItem:()=>(0,le.jsx)(on().R,{target:"notify_slack_mention"})}:void 0].filter(rt().O9)}({isSlackNotificationSettingEnabled:Boolean(null===(e=Ve().default.state.sidebarSpaceViewStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.notify_slack),showSlackNotificationSetting:t,showNotionActivityNotificationsToSlackSetting:m})}),[m,c]),x=(0,l().K8)((()=>{var e;if(!j().default.checkGate({gateName:"enable_discord_account_connection"}))return[];return function(e){const{isDiscordNotificationSettingEnabled:t,showDiscordNotionAiOption:n}=e;return[{key:"notify_discord",renderSettingsItem:()=>(0,le.jsx)(en,{target:"notify_discord"})},t?{key:"notify_discord_enabled",renderSettingsItem:()=>(0,le.jsx)(en,{target:"notify_discord_enabled"})}:void 0,t&&n?{key:"allow_discord_ai_usage",renderSettingsItem:()=>(0,le.jsx)(en,{target:"allow_discord_ai_usage"})}:void 0].filter(rt().O9)}({isDiscordNotificationSettingEnabled:Boolean(null===(e=Ve().default.state.sidebarSpaceViewStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.notify_discord),showDiscordNotionAiOption:g})}),[g]),M=(0,l().K8)((()=>{var e;return function(e){const{showNotifyEmailAlwaysSetting:t}=e;return[{key:"notify_email",renderSettingsItem:()=>(0,le.jsx)(nn().L,{target:"notify_email"})},t?{key:"notify_email_always",renderSettingsItem:()=>(0,le.jsx)(nn().L,{target:"notify_email_always"})}:void 0,{key:"notify_email_digest",renderSettingsItem:()=>(0,le.jsx)(nn().L,{target:"notify_email_digest"})},{key:"notify_home_digest_email",renderSettingsItem:()=>(0,le.jsx)(nn().L,{target:"notify_home_digest_email"})},{key:"marketing_emails",renderSettingsItem:()=>(0,le.jsx)(nn().L,{target:"marketing_emails"})}].filter(rt().O9)}({showNotifyEmailAlwaysSetting:(null===(e=Ve().default.state.sidebarSpaceViewStore)||void 0===e?void 0:e.getNotifyEmail())||!1})}),[]),A=(0,l().K8)((()=>d.WindowSizeStore.state.paddingBottomCSS),[d.WindowSizeStore]);return(0,le.jsxs)(Xe().Ay,{children:[y.length>0?(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(ve().A,{large:!xe().A.isMobile,divider:"full",children:(0,le.jsx)(v().sA,{id:"notificationSettings.notificationsSection.title.v2",defaultMessage:"Push notifications"})}),(0,le.jsx)(sn().U,{items:y}),(0,le.jsx)(at().A,{size:48,isHidden:!0})]}):void 0,p?(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(ve().A,{large:!xe().A.isMobile,divider:"full",children:(0,le.jsx)(v().sA,{id:"notificationSettings.desktopNotificationsSection.title",defaultMessage:"Desktop notifications"})}),(0,le.jsx)(Rt,{}),(0,le.jsx)(at().A,{size:48,isHidden:!0})]}):void 0,b.length>0?(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(ve().A,{large:!xe().A.isMobile,divider:"full",children:(0,le.jsx)(v().sA,{id:"notificationSettings.inAppNotificationsSection.title",defaultMessage:"In-app notifications"})}),(0,le.jsx)(sn().U,{items:b}),(0,le.jsx)(at().A,{size:48,isHidden:!0})]}):void 0,m?(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(ve().A,{large:!xe().A.isMobile,divider:"full",children:(0,le.jsx)(v().sA,{id:"notificationSettings.slackNotificationsSection.title",defaultMessage:"Slack notifications"})}),(0,le.jsx)(sn().U,{items:S}),(0,le.jsx)(at().A,{size:48,isHidden:!0})]}):void 0,x.length>0?(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(ve().A,{large:!xe().A.isMobile,divider:"full",children:(0,le.jsx)(v().sA,{id:"notificationSettings.discordNotificationsSection.title",defaultMessage:"Discord notifications"})}),(0,le.jsx)(sn().U,{items:x}),(0,le.jsx)(at().A,{size:48,isHidden:!0})]}):void 0,(0,le.jsx)(ve().A,{large:!xe().A.isMobile,divider:"full",children:(0,le.jsx)(v().sA,{id:"notificationSettings.emailNotificationsSection.title",defaultMessage:"Email notifications"})}),(0,le.jsx)(sn().U,{items:M}),(0,le.jsx)(at().A,{size:48,isHidden:!0}),(0,le.jsx)("div",{style:{marginTop:4,marginBottom:xe().A.isMobile?A:void 0},children:(0,le.jsx)(tn().A,{title:(0,le.jsx)(v().sA,{id:"myNotificationSettings.helpButton.caption",defaultMessage:"Learn about notifications"}),href:(0,ut().x)("guides.notificationSettings"),analyticsFrom:"notifications_settings"})})]})}var rn=()=>n(782649),ln=()=>n(706024),dn=()=>n(723085),cn=()=>n(854150),un=()=>n(496603);const pn="teamColumn",gn="ownersColumn",mn="AccessLevelColumn",fn="lastUpdatedColumn",hn="contextMenuColumn",yn=[pn,mn,fn],vn="filterAccessAny",bn="filterAccessOnlyOpen",Sn="filterAccessOnlyClosed",xn="filterAccessOnlyPrivate",Mn="filterOwnerAny",An="filterOwnerShowOrphaned",jn="filterOwnerById";class wn extends O().Store{getInitialState(){return{searchQuery:"",sortColumn:fn,sortAscending:!1,showOnlyArchivedTeams:!1,filterByOwner:{type:Mn},filterAccess:vn,showTeamsWithSecurityOverrides:!1}}}const In=new wn;var kn=()=>n(465960);var Tn=()=>n(435761),Cn=()=>n(132813),_n=()=>n(812941),Pn=()=>n(284230),Bn=()=>n(98126),Rn=()=>n(160432),Dn=()=>n(31511),Ln=()=>n(344417),En=()=>n(753363),On=()=>n(946141),Nn=()=>n(56394),Fn=()=>n(933117);function Un({selectItems:e,currentSelectedItem:t,onChange:n,icon:i}){const s=(0,d().IS)((()=>({filterWrap:{marginInlineEnd:0}})),[]);return(0,le.jsx)(Fn().A,{items:e,getKey:e=>e.key,selectedItem:t,onSelect:n,renderItem:e=>(0,le.jsx)(Wt().A,{title:e.value.name,...e,isChecked:t.key===e.value.key}),renderOrigin:e=>(0,le.jsx)(Nn().A,{...e,title:t.originName??t.name,on:!t.showFilterAsOffWhenSelected,icon:i,wrapStyle:s.filterWrap})})}const zn={[vn]:{key:vn,name:(0,le.jsx)(v().sA,{id:"manageTeamsAccessFilter.accessFilter.filterAllTeams",defaultMessage:"Any"}),originName:(0,le.jsx)(v().sA,{id:"manageTeamsAccessFilter.accessSelectPlaceolder",defaultMessage:"Access"}),showFilterAsOffWhenSelected:!0},[bn]:{key:bn,name:(0,le.jsx)(v().sA,{id:"manageTeamsAccessFilter.accessFilter.filterOpenTeams",defaultMessage:"Open"})},[Sn]:{key:Sn,name:(0,le.jsx)(v().sA,{id:"manageTeamsAccessFilter.accessFilter.filterClosedTeams",defaultMessage:"Closed"})},[xn]:{key:xn,name:(0,le.jsx)(v().sA,{id:"manageTeamsAccessFilter.accessFilter.filterPrivateTeams",defaultMessage:"Private"})}},Kn=un().oE([zn[vn],zn[bn],zn[Sn],zn[xn]]);function Vn({manageTeamsStore:e}){const t=(0,a().v3)(),n=(0,l().K8)((()=>e.state.filterAccess),[e]),s=(0,i.useCallback)((n=>{e.update((e=>({...e,filterAccess:n.key}))),On().hj(t,{filter:"access",value:n.key})}),[e,t]),o=zn[n];return(0,le.jsx)(Un,{selectItems:Kn,currentSelectedItem:o,onChange:s,icon:(0,le.jsx)(f().I,{icon:En().keyIcon})})}var qn=()=>n(934999);const Wn="showArchived",Gn="hideArchived",Hn={[Gn]:{key:Gn,name:(0,le.jsx)(v().sA,{id:"manageTeamsArchivedFilter.archivedFilter.hideArchivedTeams",defaultMessage:"Active"}),originName:(0,le.jsx)(v().sA,{id:"manageTeamsArchivedFilter.archivedSelectPlaceolder",defaultMessage:"Active"}),showFilterAsOffWhenSelected:!0},[Wn]:{key:Wn,name:(0,le.jsx)(v().sA,{id:"manageTeamsArchivedFilter.archivedFilter.showArchivedTeams",defaultMessage:"Archived"})}};function Yn({manageTeamsStore:e}){const t=(0,a().v3)(),n=(0,l().K8)((()=>e.state.showOnlyArchivedTeams),[e]),s=[Hn[Gn],Hn[Wn]],o=(0,i.useCallback)((n=>{e.update((e=>({...e,showOnlyArchivedTeams:n.key===Wn}))),On().hj(t,{filter:"archived",value:n.key})}),[e,t]),r=Hn[n?Wn:Gn];return(0,le.jsx)(Un,{selectItems:s,currentSelectedItem:r,onChange:o,icon:(0,le.jsx)(f().I,{icon:qn().archiveBoxIcon})})}n(430670);var $n=()=>n(42466),Qn=()=>n(695608);const Zn="ShowTeamsWithNoOwnersId";function Xn({teamStores:e,manageTeamsStore:t}){const n=(0,a().v3)(),s=(0,l().K8)((()=>t.state.filterByOwner),[t]),o=function(e){switch(e.type){case Mn:return;case jn:return e.id;case An:return Zn;default:(0,rt().HB)(e)}}(s),r=(0,mt().L)(),d=(0,v().tz)(),c=(0,l().K8)((()=>{const t=e.flatMap((e=>e.getOwnerUserIds()));return un().sb(t)}),[e]),u=(0,i.useCallback)((e=>{const i=e[e.length-1];let s;s=i===o||void 0===i?{type:Mn}:i===Zn?{type:An}:{type:jn,id:i},t.update((e=>({...e,filterByOwner:s}))),On().hj(n,{filter:"owner",value:s.type})}),[o,t,n]),p=(0,Fe().fJ)(L().T.searchActions),g=(0,i.useCallback)((async({query:e})=>{if(!r||"resolved"!==p.status)return[];const t=p.value,i=(await t.searchUsers({environment:n,query:e,parentStore:r,userIds:c})).map((e=>e.id));return""===e?[Zn,...i]:i}),[r,c,p.status,p.value,n]),m=(0,i.useCallback)(((e,t)=>{if(!r)return null;if(e===Zn)return(0,le.jsx)(Wt().A,{...t,title:(0,le.jsx)(v().sA,{id:"manageTeamsOwnerFilter.noOwnersFilterOption",defaultMessage:"No owners"}),isChecked:s.type===An,className:"notranslate"});const n=J().L.createChildStore(r,{table:$n().oo9,id:e}).getModel();return n?(0,i.createElement)(oe().A,{...t,key:e,actor:n,isChecked:o===e}):null}),[r,o,s.type]),f=(0,l().K8)((()=>{if(!r||s.type!==jn)return;const e=J().L.createChildStore(r,{table:$n().oo9,id:s.id}).getModel();return e?(0,Qn().c6)(d,e):void 0}),[s,d,r]);let h;return h=s.type===An?(0,le.jsx)(v().sA,{id:"manageTeamsOwnerFilter.filterTitle.onlyOrphanedTeams",defaultMessage:"Owner: None"}):f?(0,le.jsx)(v().sA,{id:"manageTeamsOwnerFilter.filterTitle.withSpecifiedOwner",defaultMessage:"Owner: {teamOwnerName}",values:{teamOwnerName:f}}):(0,le.jsx)(v().sA,{id:"manageTeamsOwnerFilter.filterTitle.unset",defaultMessage:"Owner"}),(0,le.jsx)(Q().A,{mode:Q().C.Pill,title:h,disabled:0===e.length,icon:ne().personIcon,items:un().oE([o]),hasItemsSelected:(0,rt().O9)(o),onChange:u,labelText:{title:h,tokenInputPlaceholder:d.formatMessage({defaultMessage:"Search teamspace owner...",id:"manageTeamsOwnerFilter.searchOwner.placeholder"}),resultSectionTitle:d.formatMessage({defaultMessage:"Select users",id:"manageTeamsOwnerFilter.searchOwner.resultsTitle"}),componentDebugName:"ManageTeamsSearchOwnerFilter"},performRequest:g,renderResultMenuItem:m,renderToken:()=>null,renderFilter:()=>null,renderItemForSummary:()=>null,addItemLabel:null,focused:!1})}var Jn=()=>n(15936);const ei="showAll",ti="showTeamsWithSecurityOverrides",ni={[ei]:{key:ei,name:(0,le.jsx)(v().sA,{id:"ManageTeamsSecurityOverridesFilter.showAllOption",defaultMessage:"Show all"}),originName:(0,le.jsx)(v().sA,{id:"ManageTeamsSecurityOverridesFilter.showAllPlaceholder",defaultMessage:"Security"}),showFilterAsOffWhenSelected:!0},[ti]:{key:ti,name:(0,le.jsx)(v().sA,{id:"ManageTeamsSecurityOverridesFilter.showTeamsWithSecurityOverrides",defaultMessage:"Has overrides"})}};function ii({manageTeamsStore:e}){const t=(0,a().v3)(),n=(0,l().K8)((()=>e.state.showTeamsWithSecurityOverrides),[e]),s=[ni[ei],ni[ti]],o=(0,i.useCallback)((n=>{e.setState({...e.state,showTeamsWithSecurityOverrides:n.key===ti}),On().hj(t,{filter:"securityOverrides",value:n.key})}),[e,t]),r=ni[n?ti:ei];return(0,le.jsx)(Un,{selectItems:s,currentSelectedItem:r,onChange:o,icon:(0,le.jsx)(f().I,{icon:Jn().checkmarkShieldIcon})})}const si=16,oi=5;function ai({manageTeamsStore:e,teamStores:t}){const n=(0,d().IS)((()=>({container:{display:"flex",alignItems:"center",marginTop:20,flexWrap:"wrap",gap:`${si}px ${oi}px`},searchContainer:{maxWidth:250,marginInlineEnd:"auto"},dropdownContainer:{display:"flex",alignContent:"stretch",flexWrap:"wrap",gap:`${si}px ${oi}px`}})),[]),s=(0,l().K8)((()=>e.state.searchQuery),[e]),o=(0,i.useCallback)((t=>{e.update((e=>({...e,searchQuery:t})))}),[e]);return(0,le.jsxs)("div",{style:n.container,children:[(0,le.jsx)(ri,{style:n.searchContainer,onChange:o,value:s}),(0,le.jsxs)("div",{style:n.dropdownContainer,children:[(0,le.jsx)(Yn,{manageTeamsStore:e}),(0,le.jsx)(Xn,{teamStores:t,manageTeamsStore:e}),(0,le.jsx)(Vn,{manageTeamsStore:e}),(0,le.jsx)(ii,{manageTeamsStore:e})]})]})}function ri({style:e,value:t,onChange:n}){const s=(0,v().tz)(),o=(0,d().IS)((()=>({input:{boxShadow:Mt().Tj.inputBoxShadow,borderRadius:100,fontSize:12},searchIcon:{marginInlineEnd:2,flexGrow:0,flexShrink:0}})),[]),a=(0,i.useCallback)((e=>n(e.target.value)),[n]);return(0,le.jsx)(Dn().A,{placeholder:s.formatMessage({defaultMessage:"Search teamspaces...",id:"manageTeamsFilterRow.searchFilter.placeholder"}),style:{...o.input,...e},value:t,onChange:a,left:(0,le.jsx)(f().I,{icon:Ln().magnifyingGlassSmallIcon,size:"sm",colorVariant:"secondary",style:o.searchIcon}),format:"small",showClearButton:!0})}n(908872);var li=()=>n(106702),di=()=>n(402014),ci=()=>n(404905),ui=()=>n(416783),pi=()=>n(631524),gi=()=>n(403733),mi=()=>n(468006),fi=()=>n(778078),hi=()=>n(632709),yi=()=>n(609679),vi=()=>n(869190),bi=()=>n(824160),Si=(n(16280),()=>n(383036)),xi=()=>n(528093);function Mi({teamStore:e,accessLevel:t,isTeamOwner:i,isArchivedTeam:s,onChangeAccessLevel:o,width:a}){const r=function(e){return(0,l().K8)((()=>e.isDefault()),[e])}(e),c=(0,A().T)(),u=(0,l().K8)((()=>(0,n(135168).f)(e)),[e]),p=null==u?void 0:u.id,g=(0,xi()._)({spaceId:p,userId:c,name:"private_teamspaces"}),m=(0,n(449304).Z)({teamStore:e,onChange:o,isDefault:r,privateTeamspacesFeatureAvailability:g}),{handleClick:f}=(0,n(408543).C)({upsell:null==g?void 0:g.upsell,source:"team_security_settings",spaceStore:u}),h=r?"default":t,y=m.find((e=>e.key===h)),b=!i||s||Boolean(null==y?void 0:y.disableAllOptionsTooltip);let S;b&&(null!=y&&y.disableAllOptionsTooltip||!i?S=(0,le.jsx)(v().sA,{id:"manageTeamsAccessCell.onlyTeamOwnersCanChangeAccessLevel",defaultMessage:"Only teamspace owners can change teamspace access levels"}):s&&(S=(0,le.jsx)(v().sA,{id:"manageTeamsAccessCell.archivedTeamCannotChangeAccessLevel",defaultMessage:"Cannot change access level for archived team"})));const x=(0,d().IS)((()=>{const e=Mt().Tj.text.tertiary;return{selectButton:{paddingInlineStart:8,marginInlineStart:-8,maxWidth:a},label:{...b&&{color:e},fontSize:ye().J.UIRegular.desktop,fontWeight:ye().Wy.regular},tooltip:{width:200}}}),[b,a]);if(!y)throw new Error(`Selected access level is not an option found in team access level option: ${h}`);return(0,le.jsx)(Fn().A,{items:m,getKey:e=>e.key,selectedItem:y,onSelect:e=>"private"===e.key&&null!=g&&g.upsell?f():e.onSelect(),renderItem:e=>(0,le.jsx)(je().m,{textWrap:!0,style:x.tooltip,placement:"bottom",disableTooltip:!e.value.tooltip,renderTooltip:()=>e.value.tooltip,render:t=>(0,le.jsx)(Wt().A,{title:e.value.title,...(0,Si().A)(e,t)})}),disabled:b,renderOrigin:e=>(0,le.jsx)(je().m,{textWrap:!0,style:x.tooltip,disableTooltip:!S,renderTooltip:()=>S,alignment:"center",placement:"left",render:t=>(0,le.jsx)(pi().p,{style:x.selectButton,disabled:b,...(0,Si().A)(e,t),iconTrailing:{icon:n(854705).arrowChevronSingleDownFillSmallIcon,size:"xs",colorVariant:b?"tertiary":"secondary"},children:(0,le.jsx)(ci().j,{style:x.label,children:y.level})})})})}var Ai=()=>n(453697);function ji({teamOwnerIds:e,manageTeamsStore:t}){const s=(0,v().tz)(),o=(0,mt().L)(),{userIds:a,groupIds:r}=e,c=(0,i.useMemo)((()=>[...a,...r]),[r,a]),{userStore:u,groupStore:p}=(0,l().K8)((()=>{if(!o)return{userStore:void 0,groupStore:void 0};const{filterByOwner:e}=t.state;let i=a[0]||r[0];if(e.type===jn){const t=e.id;c.includes(t)&&(i=t)}return i?a.includes(i)?{userStore:(0,n(384100).z)({userId:i,spaceStore:o}),groupStore:void 0}:{userStore:void 0,groupStore:(0,n(510473).E)({groupId:i,spaceStore:o})}:{userStore:void 0,groupStore:void 0}}),[r,t,c,a,o]),g=(0,l().K8)((()=>null!=u&&u.isDefined()?(0,Qn().c6)(s,u.getModel()):null!=p&&p.isDefined()?p.getName():void 0),[u,p,s]),m=(0,d().IS)((()=>({container:{display:"flex",alignItems:"center",fontSize:ye().J.UIRegular.desktop,overflow:"hidden"},userAvatar:{paddingInlineEnd:6},nMoreOwnersText:{paddingInlineStart:3,color:Mt().Tj.text.secondary},noOwners:{marginInlineEnd:8,color:Mt().Tj.text.tertiary},userName:{flexShrink:1}})),[]);return c.length<1?(0,le.jsx)("div",{style:m.noOwners,children:(0,le.jsx)(v().sA,{id:"manageTeamsOwnersCell.noOwners",defaultMessage:"No owners"})}):(0,le.jsxs)("div",{style:m.container,children:[(0,le.jsx)(Ai().A,{style:m.userAvatar,avatarShouldShowShadow:!0,userStore:u,size:20}),(0,le.jsx)(ci().j,{style:m.userName,children:g}),c.length>1?(0,le.jsx)("div",{style:m.nMoreOwnersText,children:(0,le.jsx)(v().sA,{id:"manageTeamsOwnersCell.nMoreOwnersLabel",defaultMessage:"+{numAdditionalOwners}",values:{numAdditionalOwners:c.length-1}})}):void 0]})}const wi=[pn,gn,mn,fn,hn],Ii={[mn]:{headerTitle:(0,le.jsx)(v().sA,{id:"manageTeamsTable.columnTitle.access",defaultMessage:"Access"}),renderCell:({data:e,environment:t})=>(0,le.jsx)(Mi,{teamStore:e.store,accessLevel:e.accessLevel,isTeamOwner:e.isCurrentUserOwnerOfTeam,isArchivedTeam:e.isArchivedTeam,onChangeAccessLevel:(n,i)=>kn().qH({environment:t,store:e.store,accessLevel:n,isDefault:i,teamName:e.name,from:"manage_teams_table"}),width:90}),colWidth:{width:90},hasClickableContents:!0},[pn]:{headerTitle:(0,le.jsx)(v().sA,{id:"manageTeamspacesTable.columnTitle.teamspace",defaultMessage:"Teamspace"}),renderCell:({data:e})=>(0,le.jsx)(ki,{teamStore:e.store,isArchivedTeam:e.isArchivedTeam,name:e.name}),colWidth:{minWidth:30,widthPercent:35}},[gn]:{headerTitle:(0,le.jsx)(v().sA,{id:"manageTeamsTable.columnTitle.owners",defaultMessage:"Owners"}),renderCell:({data:e,manageTeamsStore:t})=>(0,le.jsx)(ji,{teamOwnerIds:e.owners,manageTeamsStore:t}),colWidth:{minWidth:60,widthPercent:25}},[fn]:{headerTitle:(0,le.jsx)(v().sA,{id:"manageTeamsTable.columnTitle.updated",defaultMessage:"Updated"}),renderCell:({data:e})=>e.lastUpdated&&(0,le.jsx)(Ti,{lastUpdatedMillis:e.lastUpdated}),colWidth:{minWidth:50,widthPercent:15}},[hn]:{headerTitle:void 0,renderCell:({data:e})=>(0,le.jsx)(n(569047).OutlinerTeamOverflow,{teamId:e.store.id,from:"manage_teams_table"}),colWidth:{width:30},hasClickableContents:!0}};function ki({teamStore:e,name:t,isArchivedTeam:i}){const s=(0,n(211825).G)(e),o=(0,d().IS)((()=>({container:{display:"flex",alignItems:"center",overflow:"hidden"},teamIcon:{marginInlineEnd:12},nameAndMembersContainer:{display:"flex",flexDirection:"column",minWidth:0},nameAndArchivedPillContainer:{display:"flex"},nameText:{lineHeight:"18px",fontWeight:ye().Wy.regular},smallText:{fontSize:n(115512).Kw,color:Mt().Tj.text.secondary,fontWeight:ye().Wy.regular},archivedTag:{marginInlineStart:5}})),[]),a=`${(0,n(192940).h)(e)}`;return(0,le.jsxs)("div",{style:o.container,children:[(0,le.jsx)(n(898808).x,{style:o.teamIcon,size:28,store:e,disabled:!0}),(0,le.jsxs)("div",{style:o.nameAndMembersContainer,children:[(0,le.jsxs)("div",{style:o.nameAndArchivedPillContainer,children:[(0,le.jsx)(ci().j,{style:o.nameText,children:t}),i?(0,le.jsx)(bi().A,{desktopStyle:o.archivedTag,mobileStyle:o.archivedTag,children:(0,le.jsx)(v().sA,{id:"manageTeamsTable.archivedTag",defaultMessage:"Archived"})}):void 0]}),(0,le.jsxs)(ci().j,{style:o.smallText,children:[(0,le.jsx)(v().sA,{id:"manageTeamsTableColumnData.numMembersLabel",defaultMessage:"{numMembers, plural, one {1 member} other {{numMembers} members}}",values:{numMembers:a}}),s?(0,le.jsxs)(le.Fragment,{children:[" • ",(0,le.jsx)(v().sA,{id:"manageTeamsTableColumnData.joinedLabel",defaultMessage:"Joined"})]}):void 0]})]})]})}function Ti({lastUpdatedMillis:e}){return(0,le.jsx)(ci().j,{children:(0,vi().W_)(e,"very_short",yi().locale)})}function Ci({teamStores:e,manageTeamsStore:t}){const n=(0,a().v3)(),s=(0,li().$)(),{sortAscending:o,sortColumn:r}=(0,l().K8)((()=>{const{sortAscending:e,sortColumn:n}=t.state;return{sortAscending:e,sortColumn:n}}),[t]),c=(0,l().K8)((()=>(null==s?void 0:s.id)?un().oE(e.map((e=>{if(!e.canRead()||!e.isReady())return;const{ownerUserIds:t,ownerGroupIds:n}=e.getAllOwnerIds();return{store:e,name:e.getName()??"",owners:{userIds:t,groupIds:n},isCurrentUserOwnerOfTeam:Boolean(e.canAdmin()),hasSecurityOverrides:e.hasSecurityOverrides(),accessLevel:e.getTeamAccessLevel(),isArchivedTeam:(0,mi().Sh)({archived_by:e.getArchivedBy()}),lastUpdated:e.getLastEditedTime()}}))):[]),[null==s?void 0:s.id,e]),u=(0,l().K8)((()=>{const{showOnlyArchivedTeams:e,filterByOwner:n,showTeamsWithSecurityOverrides:i,filterAccess:s}=t.state;return c.filter((t=>e?t.isArchivedTeam:!t.isArchivedTeam)).filter((e=>!i||e.hasSecurityOverrides)).filter((e=>{if(s===bn&&"open"!==e.accessLevel)return!1;if(s===Sn&&"closed"!==e.accessLevel)return!1;if(s===xn&&"private"!==e.accessLevel)return!1;switch(n.type){case An:return e.owners.userIds.length+e.owners.groupIds.length===0;case jn:return[...e.owners.userIds,e.owners.groupIds].includes(n.id);case Mn:return!0;default:(0,rt().HB)(n)}}))}),[t,c]),p=(0,l().K8)((()=>{const{sortAscending:e,sortColumn:n}=t.state;return function({data:e,sortColumn:t,sortAscending:n}){const i=[n?"asc":"desc"],s=[n?"desc":"asc"];switch(t){case pn:return un().My(e,(e=>e.name),s);case mn:return un().My(e,(e=>cn().nJ.indexOf(e.accessLevel)),i);case fn:return un().My(e,(e=>e.lastUpdated),i);default:(0,rt().HB)(t)}}({data:u,sortAscending:e,sortColumn:n})}),[t,u]),g=(0,l().K8)((()=>(0,fi().Ay)(t.state.searchQuery,p,(e=>e.name))),[t,p]),m=(0,i.useCallback)((e=>kn().F2({environment:n,teamId:e,tab:hi().p.Members,from:"manage_teams_table"})),[n]),f=(0,d().IS)((()=>({container:{marginTop:17,tableLayout:"fixed",borderCollapse:"collapse",width:"100%",minWidth:wi.reduce(((e,t)=>e+Oi(Ii[t].colWidth)+Li),0)},tableHeaderRow:{borderTop:`1px solid ${Mt().Tj.border.primary}`,borderBottom:`1px solid ${Mt().Tj.border.primary}`},noTeamsLabel:{marginTop:15,marginBottom:40,textAlign:"center"}})),[]),h=(0,i.useCallback)((e=>{const{sortColumn:i,sortAscending:s}=t.state,o=e===i&&!s;t.setState({...t.state,sortAscending:o,sortColumn:e}),On().xl(n,{sortBy:e,sortOrder:s?"ascending":"descending"})}),[t,n]),y=(0,i.useCallback)((()=>{t.reset()}),[t]);return(0,le.jsxs)(le.Fragment,{children:[(0,le.jsxs)("table",{style:f.container,children:[(0,le.jsx)("thead",{children:(0,le.jsx)("tr",{style:f.tableHeaderRow,children:wi.map((e=>(0,le.jsx)(Pi,{column:e,onSortableColumnClick:h,sortAscending:o,sortColumn:r},`header_${e}`)))})}),(0,le.jsxs)("tbody",{children:[(0,le.jsx)("tr",{children:wi.map((e=>(0,le.jsx)("td",{},`padding_row_${e}`)))}),g.map((e=>(0,le.jsx)(_i,{onShowTeamSettings:m,teamData:e,manageTeamsStore:t},`${e.store.id}_row`)))]})]}),(0,le.jsx)(Ri,{style:f.noTeamsLabel,numItemsAfterFilter:g.length,numItemsBeforeFilter:e.length,onResetFilters:y})]})}function _i({teamData:e,manageTeamsStore:t,onShowTeamSettings:n}){const[s,o]=(0,i.useState)(!1),a=(0,i.useCallback)((()=>o(!0)),[]),r=(0,i.useCallback)((()=>o(!1)),[]),l=(0,i.useCallback)((t=>{Di(t,(()=>n(e.store.id)))}),[n,e.store.id]),c=!e.isArchivedTeam,u=(0,d().IS)((()=>({teamRow:{cursor:c?"pointer":"default",borderBottom:`1px solid ${Mt().Tj.border.primary}`}})),[c]);return(0,le.jsx)("tr",{onMouseLeave:c?r:void 0,onMouseEnter:c?a:void 0,style:u.teamRow,onClick:c?l:void 0,children:wi.map((n=>(0,le.jsx)(Bi,{isRowHovered:s,teamData:e,columnData:Ii[n],manageTeamsStore:t},`${e.store.id}_${n}`)))})}function Pi({column:e,onSortableColumnClick:t,sortColumn:n,sortAscending:i}){const s=Ii[e],o=(0,d().IS)((()=>({th:Ni(s),innerDiv:{display:"flex",alignItems:"center",minWidth:Oi(s.colWidth),height:32},text:{fontSize:ye().J.UISmall.desktop,fontWeight:ye().Wy.regular,color:Mt().Tj.text.secondary},sortButton:{color:Mt().Tj.text.secondary,padding:5,margin:-5,overflow:"hidden",maxWidth:"100%"}})),[s]),a=(0,le.jsx)(ci().j,{style:o.text,children:s.headerTitle}),r=(l=e,yn.includes(l)?(0,le.jsx)(pi().p,{iconTrailing:(()=>{if(e===n)return{icon:gi().arrowStraightDownSmallIcon,size:"xxs",style:i?{transform:"rotate(180deg)"}:void 0}})(),style:o.sortButton,onClick:()=>t(e),size:"xs",children:a}):a);var l;return(0,le.jsx)("th",{style:o.th,children:(0,le.jsx)("div",{style:o.innerDiv,children:r})})}function Bi({teamData:e,columnData:t,isRowHovered:n,manageTeamsStore:i}){const s=(0,a().v3)(),o=(0,d().IS)((()=>({td:{...Ni(t),...n&&{background:Mt().Tj.buttonHoveredBackground}},innerDiv:{minWidth:Oi(t.colWidth),fontSize:ye().J.UIRegular.desktop,color:Mt().Tj.text.primary,height:56,display:"flex",alignItems:"center"}})),[t,n]),r=Di,l=Boolean(t.hasClickableContents);return(0,le.jsx)("td",{style:o.td,children:(0,le.jsx)("div",{style:o.innerDiv,onClick:l?r:void 0,children:t.renderCell({environment:s,data:e,manageTeamsStore:i})})})}function Ri({style:e,numItemsBeforeFilter:t,numItemsAfterFilter:n,onResetFilters:i}){if(0!==n)return null;let s;return s=0!==t?(0,le.jsx)(v().sA,{id:"manageTeamsTable.emptyManageTeamTableDisclaimer.teamsFilteredOut",defaultMessage:"Could not find any teamspaces. <linkbutton>Reset your filters</linkbutton>",values:{linkbutton:e=>(0,le.jsx)(ui().V,{onClick:i,children:e})}}):(0,le.jsx)(v().sA,{id:"manageTeamsTable.emptyManageTeamTableDisclaimer.noTeamsExist",defaultMessage:"Could not find any teamspaces."}),(0,le.jsx)(we().A,{isSmall:!0,style:e,children:s})}function Di(e,t){(0,di().SQ)(e,di().y$.Click,t)}const Li=10,Ei={paddingInlineStart:Li/2,paddingInlineEnd:Li/2};function Oi(e){return"minWidth"in e?e.minWidth:e.width}function Ni(e){let t={};return t="width"in e.colWidth?{width:e.colWidth.width}:{width:`${e.colWidth.widthPercent}%`,minWidth:e.colWidth.minWidth},{...Ei,...t}}function Fi({}){const e=(0,l().uB)(In),t=(0,d().IS)((()=>({container:{marginTop:8},header:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:8},subheader:{display:"flex",flexDirection:"column",flexShrink:1,overflow:"hidden"}})),[]),n=(0,l().O$)(Ve().AppStoreSidebarSpaceStore),{teams:s,isLoading:o}=(0,Tn().rV)({spaceStore:n}),a=(0,Tn().gc)({teams:s,spaceStore:n}).map((e=>e.store)),r=(0,i.useCallback)((()=>kn().vn("workspace_settings")),[]);return(0,le.jsxs)("div",{style:t.container,children:[(0,le.jsxs)(ve().A,{large:!xe().A.isMobile,style:t.header,small:!0,children:[(0,le.jsxs)("div",{style:t.subheader,children:[(0,le.jsx)(v().sA,{id:"manageTeamsBrowser.title",defaultMessage:"Manage teamspaces"}),(0,le.jsx)(we().A,{isSmall:!0,style:{marginTop:3},children:(0,le.jsx)(v().sA,{id:"manageTeamsBrowser.subtitle",defaultMessage:"Manage all teamspaces you have access to here"})})]}),(0,le.jsx)(Rn().A,{colorPalette:"blue",onClick:r,size:"lg",className:p().e6S,children:(0,le.jsx)(v().sA,{id:"manageTeamsBrowser.newTeamButton.text",defaultMessage:"New teamspace"})})]}),o?(0,le.jsx)(Bn().k,{}):(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(ai,{teamStores:a,manageTeamsStore:e}),(0,le.jsx)(Ci,{teamStores:a,manageTeamsStore:e})]})]})}var Ui=()=>n(885067);function zi(){return(0,le.jsx)(ve().A,{large:!xe().A.isMobile||void 0,divider:xe().A.isMobile?void 0:"full",children:(0,le.jsx)(v().sA,{id:"teamsWorkspaceSettings.title",defaultMessage:"Teamspace settings"})})}function Ki(){const e=(0,a().v3)(),t=(0,l().O$)(Ve().AppStoreSidebarSpaceStore),n=(0,l().uB)(void 0,Cn().A),s=(0,l().K8)((()=>t&&n.getValueForSpace(t)),[t,n]),o=(0,l().K8)((()=>(0,ae().Qd)()),[]),r=(null==s?void 0:s.disableTeamCreation)??!1,d=(null==s?void 0:s.disableTeamGuests)??!1,c=void 0===s,u=(0,i.useCallback)((()=>{t&&s&&async function({newSettingValue:e,environment:t,workspaceSecuritySettings:n,spaceStore:i}){const s="allowTeamCreation"===e?(0,le.jsx)(v().sA,{id:"manageTeamsHelpers.confirmChangeSecuritySetting.allowTeamCreation",defaultMessage:"Allow all members of this workspace to create teamspaces?"}):(0,le.jsx)(v().sA,{id:"manageTeamsHelpers.confirmChangeSecuritySetting.workspaceOwners.disableTeamCreation",defaultMessage:"Limit teamspace creation to only workspace owners?"}),{accept:o}=await T().Gh({message:s});!!o&&ln().V(t,{securitySettingsState:{...n,disableTeamCreation:"disableTeamCreation"===e},spaceStore:i})}({newSettingValue:r?"allowTeamCreation":"disableTeamCreation",environment:e,spaceStore:t,workspaceSecuritySettings:s})}),[t,r,e,s]);return(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(Ui().y,{disabled:c,onChange:u,title:(0,le.jsx)(v().sA,{id:"teamWorkspacesSettings.disableTeamCreation.workspaceOwners.title",defaultMessage:"Limit teamspace creation to only workspace owners"}),description:(0,le.jsx)(v().sA,{id:"teamWorkspacesSettings.disableTeamCreation.workspaceOwners.caption",defaultMessage:"Only allow workspace owners to create teamspaces"}),selected:r}),(0,le.jsx)(at().A,{size:34}),o?(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(Ui().y,{disabled:c,onChange:async function(){if(t&&s){if(!Boolean(s.disableTeamGuests)){const{accept:e}=await T().Gh({message:(0,le.jsx)(v().sA,{id:"teamWorkspacesSettings.disableTeamGuests.confirmDisable.message",defaultMessage:"Are you sure you want to disable teamspace guests?"}),description:(0,le.jsx)(v().sA,{id:"teamWorkspacesSettings.disableTeamGuests.confirmDisable.description",defaultMessage:"This action will remove all teamspace guests from the workspace."}),acceptLabel:(0,le.jsx)(v().sA,{id:"teamWorkspacesSettings.disableTeamGuests.confirmDisable.acceptButton",defaultMessage:"Disable and remove teamspace guests"})});if(!e)return}ln().V(e,{securitySettingsState:{...s,disableTeamGuests:!s.disableTeamGuests},spaceStore:t})}},title:(0,le.jsx)(v().sA,{id:"teamWorkspacesSettings.disableTeamGuests.workspaceOwners.title",defaultMessage:"Allow teamspace owners to add teamspace guests"}),description:(0,le.jsx)(v().sA,{id:"teamWorkspacesSettings.disableTeamGuests.workspaceOwners.caption",defaultMessage:"This will allow teamspace owners with membership admin permissions to add teamspace guests. Disabling will remove all teamspace guests."}),selected:!d}),(0,le.jsx)(at().A,{size:34})]}):void 0]})}function Vi({spaceStore:e}){const t=(0,d().IS)((()=>({learnMoreLinkContainer:{paddingTop:6,paddingBottom:20}})),[]),n=(0,a().v3)(),s=(0,i.useCallback)((async({addedTeams:t,removedTeams:i})=>{e&&await async function({addedTeams:e,removedTeams:t,environment:n,spaceStore:i}){return!!i.isDefined()&&await kn().FE({addedStores:e.map((({metadata:e})=>dn().h.createChildStore(i,{table:cn().yK,id:e.id,spaceId:i.id}))),removedStores:t.map((({metadata:e})=>dn().h.createChildStore(i,{table:cn().yK,id:e.id,spaceId:i.id}))),environment:n,spaceStore:i,createNewTeamFlowId:void 0,from:"workspace_settings"})}({environment:n,addedTeams:t,removedTeams:i,spaceStore:e})}),[e,n]),{teams:o,isLoading:r}=(0,Tn().Qs)({spaceStore:e}),l=0===o.length?null:(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(Pn().A,{spaceStore:e,unarchivedTeamsMetadata:o,onUpdate:s,description:(0,le.jsx)(we().A,{isSmall:!0,isMultiline:!0,children:(0,le.jsx)(v().sA,{id:"teamsWorkspaceSettings.defaultTeams.caption",defaultMessage:"Choose teamspaces that all new and current workspace members will automatically join"})})}),(0,le.jsx)(at().A,{size:34})]});return(0,le.jsxs)(Xe().Ay,{children:[(0,le.jsx)(zi,{}),(0,le.jsx)(_n().A,{helpCenterLocation:"settingsAndPermissions",analyticsFrom:"teams_learn_more_workspace_settings",containerStyle:t.learnMoreLinkContainer}),r?null:(0,le.jsxs)(le.Fragment,{children:[l,(0,le.jsx)(Ki,{}),(0,le.jsx)(Fi,{})]})]})}var qi=()=>n(960521),Wi=()=>n(300474),Gi=()=>n(72897);function Hi(){const e=(0,a().v3)(),t=(0,l().O$)(Ve().AppStoreCurrentUserSettingsStore),n=(0,Wi().r)(),s=(0,mt().L)(),o=(0,l().K8)((()=>{var e;return n&&(null==t||null===(e=t.getSettings())||void 0===e||null===(e=e.beta_ai_co_editing_settings)||void 0===e||null===(e=e[n])||void 0===e?void 0:e.autocorrect)}),[t,n])??!1,r=(0,i.useCallback)((async()=>{n&&t&&await Gi().setCoEditingSetting({environment:e,userSettingsStore:t,spaceId:n,active:!o})}),[e,o,t,n]),d=(0,le.jsx)(v().sA,{id:"aiCoEditingSettings.title",defaultMessage:"AI Co-editor"}),c=(0,le.jsx)(v().sA,{id:"aiCoEditingSettings.caption",defaultMessage:"Notion AI checks for writing suggestions and fixes errors as you type."});return(0,le.jsx)(vt().A,{spaceStore:s,title:d,caption:c,isOn:o,type:"toggle",onToggle:r})}var Yi=()=>n(44551);function $i(e){var t;null===Yi().electronApi||void 0===Yi().electronApi||null===(t=Yi().electronApi.setGlobalShortcutsEnabled)||void 0===t||t.call(Yi().electronApi,e)}var Qi=()=>n(402390),Zi=()=>n(170163),Xi=()=>n(815912);function Ji(){const e=(0,a().v3)(),t=(0,mt().L)(),[n,s]=(0,i.useState)(!1);(0,r().w)((()=>{const t=(0,Xi().$)({userId:e.currentUser.id});s(t)}));const o=(0,i.useCallback)((()=>{const t=!n;(0,Xi().B)({userId:e.currentUser.id,value:t}),s(t)}),[e.currentUser.id,n]),l=(0,le.jsx)(v().sA,{id:"textDirectionControlsSetting.title",defaultMessage:"Always show text direction controls"}),d=(0,le.jsx)(v().sA,{id:"textDirectionControlsSetting.caption",defaultMessage:"Show options to change text direction (LTR/RTL) in the editor menu, even when your language is left-to-right."});return(0,le.jsx)(vt().A,{spaceStore:t,title:l,caption:d,isOn:n,type:"toggle",onToggle:o})}var es=()=>n(114912),ts=()=>n(506731),ns=()=>n(789148),is=()=>n(942906);function ss(){const e=(0,a().v3)(),t=(0,v().tz)(),n=(0,l().O$)(Ve().AppStoreCurrentUserSettingsStore),i=(0,mt().L)(),{currentTimeZone:s,auto_update_disabled:o}=(0,l().K8)((()=>{const e=null==n?void 0:n.getSettings();return{currentTimeZone:null!=e&&e.time_zone&&(0,ns().PJ)(null==e?void 0:e.time_zone)?e.time_zone:void 0,auto_update_disabled:null==e?void 0:e.disable_auto_set_timezone}}),[n]),r=!o||!s;return n?(0,le.jsx)(vt().A,{spaceStore:i,type:"timezonePicker",currentTimeZone:s,title:(0,le.jsx)(v().sA,{id:"dateAndTimeSettings.timeZone.title",defaultMessage:"Timezone"}),caption:(0,le.jsx)(v().sA,{id:"dateAndTimeSettings.timeZone.caption",defaultMessage:"Current timezone setting."}),renderOrigin:e=>(0,le.jsx)(es()._,{focused:!1,disabled:r,buttonStyle:{width:void 0,margin:0},title:s?(0,ts().Dy)(t,s):(0,le.jsx)(v().sA,{id:"dateAndTimeSettings.timeZone.error",defaultMessage:"Error finding timezone"}),...e}),disabled:r,onSelect:t=>{is().Lj({environment:e,userSettingsStore:n,timeZone:t})}}):null}function os(){const e=(0,a().v3)(),t=(0,l().O$)(Ve().AppStoreCurrentUserSettingsStore),n=(0,mt().L)(),s=(0,l().K8)((()=>{var e;return null==t||null===(e=t.getSettings())||void 0===e?void 0:e.disable_auto_set_timezone}),[t])??!1,o=(0,i.useCallback)((t=>{const n=!s;is().W2({environment:e,userSettingsStore:t,disableAutoSetTimezone:n}),n||is().xw({environment:e,userSettingsStore:t})}),[e,s]),r=(0,le.jsx)(v().sA,{id:"dateAndTimeSettings.autoTimeZone.title",defaultMessage:"Set timezone automatically using your location"}),d=(0,le.jsx)(v().sA,{id:"dateAndTimeSettings.autoTimeZone.caption",defaultMessage:"Reminders, notifications and emails are delivered based on your time zone."});return(t&&(0,le.jsx)(vt().A,{spaceStore:n,title:r,caption:d,type:"toggle",isOn:!s,onToggle:()=>o(t)}))??null}var as=()=>n(571997),rs=(n(737550),()=>n(165358)),ls=()=>n(229833);const ds=function(e){const[t,s]=i.useState([]),[o,r]=i.useState([]),c=(0,a().v3)(),u=(0,l().uB)(void 0,n(118307).A),g=(0,d().IS)((()=>({plainButton:{paddingInlineStart:8,paddingInlineEnd:8,marginInlineStart:-8}})),[]);function m(e){return o.some((t=>t.code===e.code))}(0,i.useEffect)((()=>{const e=c.SpellCheckService;e&&(e.getAvailableLanguages().then(s).catch((e=>{rs().log({level:"error",from:"SpellcheckerLanguagesPicker",type:"getAvailableLanguages",error:(0,ls().convertErrorToLog)(e)})})),e.getLanguages().then(r).catch((e=>{rs().log({level:"error",from:"SpellcheckerLanguagesPicker",type:"getLanguages",error:(0,ls().convertErrorToLog)(e)})})))}),[c]),(0,i.useEffect)((()=>{const e=c.SpellCheckService;if(!e)return;const t=o.map((({code:e})=>e));e.setLanguages(t)}),[o,c.SpellCheckService]);const h=o.length>0?o.slice(0,3).map((({name:e})=>e)).join(", ")+(o.length>3?"…":""):(0,le.jsx)(v().sA,{id:"languageRegionSettings.spellchecker.picker.label",defaultMessage:"Select languages"});return(0,le.jsx)(Kt().A,{popupType:Kt().z.Popup,buttonPopupStore:u,renderOrigin:e=>(0,le.jsx)(pi().p,{style:g.plainButton,...e,iconTrailing:{icon:Yt().arrowChevronSingleDownSmallIcon,colorVariant:"tertiary",size:"xs"},children:h}),placementToOrigin:"bottom",alignmentToOrigin:"start",render:e=>{const i=[{key:"spellcheckerlanguages",render:e=>(0,le.jsx)(Ht().A,{...e,topBorder:0!==e.index}),items:t.map((e=>{const t={key:e.code,render:t=>function(e){const t=e.language.name||e.language.code;return(0,le.jsx)(Wt().A,{...e.props,title:(0,le.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,le.jsx)("div",{style:{marginInlineEnd:0},children:t})}),shouldWrapCaption:!0,right:m(e.language)?(0,le.jsx)(f().I,{icon:n(450424).checkmarkCircleFillSmallIcon,size:"xs"}):void 0})}({language:e,props:t}),action:()=>{m(e)?r(o.filter((t=>t.code!==e.code))):r([...o,e])}};return t}))}],s={menuType:Vt().gu.Popup,width:240};return(0,le.jsx)(qt().A,{className:p().jtA,...s,children:(0,le.jsx)(Gt().A,{type:Gt().O.Vertical,initialFocus:void 0,sections:i})})}})};const cs=function(e){const t=(0,a().v3)();return t.device.isElectron&&t.device.isWindows?(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(at().A,{size:24,isHidden:!0}),(0,le.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%",height:"auto"},children:(0,le.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",width:"100%"},children:[(0,le.jsxs)("div",{style:{flex:1},children:[(0,le.jsx)(we().A,{children:(0,le.jsx)(v().sA,{id:"languageRegionSettings.spellchecker.label",defaultMessage:"Spellchecker languages"})}),(0,le.jsx)(we().A,{isSmall:!0,isMultiline:!0,style:{width:"80%"},children:(0,le.jsx)(v().sA,{id:"languageSettings.spellcheckerSwitcher.subtitle",defaultMessage:"Change the languages used by the spellchecker."})})]}),(0,le.jsx)(ds,{})]})})]}):null};function us(){const e=(0,l().O$)(Ve().AppStoreCurrentUserSettingsStore),t=(0,l().K8)((()=>{var t;return(null==e||null===(t=e.getSettings())||void 0===t?void 0:t.preferred_locale)||Qi().q}),[e]),n=(0,o().X)("editor_basic_rtl");if(!e)return null;const i=[{key:"timezone-auto",renderSettingsItem:()=>(0,le.jsx)(os,{})},{key:"timezone-manual",renderSettingsItem:()=>(0,le.jsx)(ss,{})}].filter(rt().O9);return xe().A.isMobile?(0,le.jsxs)("div",{style:{paddingTop:48},children:[(0,le.jsx)(ve().A,{large:!0,divider:"full",children:(0,le.jsx)(v().sA,{id:"languageSettings.languageSection.title",defaultMessage:"Language & region"})}),(0,le.jsx)(as().o,{locale:t,userSettingsStore:e}),(0,le.jsx)(Zi().A,{})]}):(0,le.jsxs)("div",{style:{paddingTop:48},children:[(0,le.jsx)(ve().A,{large:!0,divider:"full",children:(0,le.jsx)(v().sA,{id:"languageSettings.languageAndTimeSection.title",defaultMessage:"Language & Time"})}),(0,le.jsx)(as().o,{locale:t,userSettingsStore:e}),n?(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(at().A,{size:18,isHidden:!0}),(0,le.jsx)(Ji,{})]}):null,(0,le.jsx)(cs,{}),(0,le.jsx)(at().A,{size:18,isHidden:!0}),(0,le.jsx)(Zi().A,{}),(0,le.jsx)(at().A,{size:18,isHidden:!0}),(0,le.jsx)(sn().U,{items:i})]})}var ps=()=>n(475553),gs=()=>n(75435),ms=()=>n(20022);function fs(){const e=(0,l().K8)((()=>{var e;return null===(e=gs().A.state.preferences)||void 0===e?void 0:e.onStartup}),[]),t=(0,mt().L)();if(!e)return null;const n=[{key:"continue",label:(0,le.jsx)(v().sA,{id:"OnDesktopAppStartupSetting.continue.label",defaultMessage:"Continue where you left off"})},{key:"default_page",label:(0,le.jsx)(v().sA,{id:"OnDesktopAppStartupSetting.defaultPage.label",defaultMessage:"Your default page"})}];return(0,le.jsx)(vt().A,{spaceStore:t,title:(0,le.jsx)(v().sA,{id:"onStartup.title",defaultMessage:"On startup"}),caption:(0,le.jsx)(v().sA,{id:"onStartup.description",defaultMessage:"Choose what to show when the Notion app starts."}),type:"dropdown",currentOption:e,options:n,onSelectOption:e=>{ms().Zq.setPreference("onStartup",e)}})}var hs=()=>n(420844);const ys=function(){const e=(0,l().K8)((()=>{var e;return null===(e=gs().A.state.preferences)||void 0===e?void 0:e.onStartup}),[]),t=(0,a().v3)(),i=(0,hs().OC)({environment:t}),s=[...xe().A.isMobile||!Array.isArray(i)?n(415622).Pc:i,e?{key:"on-startup",renderSettingsItem:()=>(0,le.jsx)(fs,{})}:void 0,{key:"default-page",renderSettingsItem:()=>(0,le.jsx)(n(993342).A,{})}].filter(rt().O9);return(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(ve().A,{large:!0,divider:"full",children:xe().A.isMobile?(0,le.jsx)(v().sA,{id:"desktopAppStartupSettings.settingsSection.title",defaultMessage:"Startup"}):(0,le.jsx)(v().sA,{id:"desktopAppSettings.settingsSection.title",defaultMessage:"Desktop app"})}),(0,le.jsx)(sn().U,{items:s}),(0,le.jsx)(at().A,{size:48,isHidden:!0})]})};var vs=()=>n(678894),bs=()=>n(704444),Ss=()=>n(680977);const xs=function(){const e=(0,a().v3)(),t=(0,l().O$)(Ve().AppStoreCurrentUserSettingsStore),n=(0,mt().L)(),s=(0,l().K8)((()=>{var e;return null==t||null===(e=t.getSettings())||void 0===e?void 0:e.profile_discoverable}),[t])??!0,o=(0,i.useCallback)((n=>{const i=!s;Ft().createAndCommit({userAction:"ProfileDIscoverabilitySettings.onToggleOption",environment:e,canUndo:!0,perform:e=>{t&&(0,Ss().m)({userSettingsStore:t,data:{profile_discoverable:i},transaction:e})}})}),[e,s,t]),r=(0,le.jsx)(v().sA,{id:"profileDiscoverabilitySettings.title",defaultMessage:"Profile discoverability"}),d=(0,le.jsx)(v().sA,{id:"profileDiscoverabilitySettings.caption",defaultMessage:"Users with your email can see your name and profile picture when inviting you to a new workspace. <inlinelink>Learn more</inlinelink>.",values:{inlinelink:e=>(0,le.jsx)(ui().V,{external:!0,href:(0,ut().x)("guides.profileSettings"),onClick:e=>{e.stopPropagation()},children:e})}});return(0,le.jsx)(vt().A,{spaceStore:n,title:r,caption:d,isOn:s,type:"toggle",onToggle:()=>o(t)})};const Ms=(0,n(410058).k)((function({passwordRequestStore:e,userEmailDomainSettings:t,billingData:s}){const{isPhone:o,isElectron:d,isMobileNative:c,isAndroid:u,isTablet:p}=(0,a().Y0)(),g=(0,a().v3)(),m=(0,hs().jo)(),f=(0,l().uB)(void 0,vs().A);(0,r().l)((()=>{M().Q(g,f)}));const h=(0,l().K8)((()=>f.state.accountSettings),[f]),y=Boolean((0,ps().y)()),b=(0,l().K8)((()=>n(383070).zD.isAiEnabled()&&j().default.checkGate({gateName:"ai_co_editing"})&&!p),[p]),S=(0,l().K8)((()=>xe().A.isMobile&&e?(0,hs().xF)({isPhone:o,isMobileNative:c,isAndroid:u,showOfflineSettings:y,passwordRequestStore:e,userEmailDomainSettings:t,billingData:s,accountSettings:h}):m),[o,c,u,y,e,t,h,s,m]);(0,i.useEffect)((()=>(d&&$i(!1),()=>{d&&$i(!0)})),[d]);const x=[{key:"ai-co-editing",renderSettingsItem:()=>(0,le.jsx)(Hi,{})}],A=[(0,l().K8)((()=>(0,bs().y)(g)),[g])?{key:"cookies",renderSettingsItem:()=>(0,le.jsx)(bs().S,{})}:void 0,{key:"view-history",renderSettingsItem:()=>(0,le.jsx)(n(991627).L,{})},{key:"profile-discoverability",renderSettingsItem:()=>(0,le.jsx)(xs,{})}].filter(rt().O9);return(0,le.jsxs)(Xe().Ay,{children:[(0,le.jsx)(ve().A,{large:!xe().A.isMobile,divider:"full",children:(0,le.jsx)(v().sA,{id:"preferences.settingsSection.title",defaultMessage:"Preferences"})}),(0,le.jsx)(sn().U,{items:S}),(0,le.jsx)(us,{}),(0,le.jsx)(at().A,{size:48,isHidden:!0}),(0,le.jsx)(ys,{}),b?(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(ve().A,{large:!xe().A.isMobile,divider:"full",children:(0,le.jsx)(v().sA,{id:"notificationAndPersonalSettings.aiSection.title",defaultMessage:"Notion AI"})}),(0,le.jsx)(sn().U,{items:x}),(0,le.jsx)(at().A,{size:48,isHidden:!0})]}):null,(0,le.jsx)(ve().A,{large:!xe().A.isMobile,divider:"full",children:(0,le.jsx)(v().sA,{id:"mySettings.privacySection.title",defaultMessage:"Privacy"})}),(0,le.jsx)(sn().U,{items:A})]})}));var As=()=>n(271084),js=()=>n(408895),ws=()=>n(134217),Is=()=>n(317182);function ks({users:e,spaceStore:t,extraColumns:n,initialSort:s,tableStyle:o}){const[a,r]=(0,i.useState)(s),c=(0,v().tz)(),u=(0,d().IS)((()=>({iconButton:{color:Mt().Tj.text.secondary,marginInlineStart:-6}})),[]);function p(e,t){return(0,le.jsx)(pi().p,{disabled:!t.sortable,iconTrailing:t.sortable&&a&&a.column===e?(n=a.asc,{icon:gi().arrowStraightDownSmallIcon,size:"xxs",style:n?{transform:"rotate(180deg)"}:void 0}):void 0,ignoreLocalHoverState:!0,onClick:()=>{!function(e){r({column:e,asc:(null==a?void 0:a.column)===e&&!(null!=a&&a.asc)})}(e)},size:"xs",style:u.iconButton,children:t.title},e);var n}const g=(0,i.useMemo)((()=>({title:(0,le.jsx)(v().sA,{id:"spacePermissionsSettings.userTable.userColumn.header",defaultMessage:"User"}),style:{width:"60%"},sortable:!0,renderer:e=>(0,le.jsx)(ke().A,{actorStore:e}),getValue:e=>e.getDisplayName(c)})),[c]),m=(0,i.useMemo)((()=>({name:g,...n})),[n,g]),f=un().HP(m).map((e=>({key:e,header:p(e,m[e]),style:m[e].style}))),h=(0,l().K8)((()=>{const n=e.map((e=>J().L.createChildStore(t,{table:R().oo,id:e.userId}))).filter((e=>e.isDefined()));return a?n.sort(((e,t)=>{const n=m[a.column].getValue(e),i=m[a.column].getValue(t),s=n<i?-1:n>i?1:0;return a.asc?s:-1*s})):n}),[e,t,m,a]);return(0,le.jsx)(Is().A,{columns:f,rows:h.map((e=>{const t=Object.values(m).map(((t,n)=>t.renderer?t.renderer(e):(0,le.jsx)(i.Fragment,{children:t.getValue(e)},n)));return{key:e.id,columns:t}})),tableStyle:o})}function Ts(e){const{spaceStore:t}=e,n=(0,A().T)(),{isOnline:i,subscriptionDataStoreData:s,userSimilarityData:o,visibleUsersLoaded:a,visibleUsers:r}=(0,l().K8)((()=>{const e=(0,js().M)({spaceId:t.id,userId:n,enforceIdsCheck:!1,debugFrom:"UserSimilarityScores"}),i=e?(0,ws().Be)(e):[],s=un().Si(i.map((e=>J().L.createChildStore(t,{table:R().oo,id:e.userId}).isReady())));return{isOnline:c().A.state.online,subscriptionDataStoreData:e,userSimilarityData:As().k.state||{},visibleUsersLoaded:s,visibleUsers:i}}),[t,n]);if(!i)return(0,le.jsx)(we().A,{isSmall:!0,style:{textAlign:"center"},children:(0,le.jsx)(v().sA,{id:"spacePermissionsSettings.offlineMessage",defaultMessage:"Please go online to manage members."})});if(!s||!a)return(0,le.jsx)(Bn().A,{style:{marginTop:"calc(50%",marginInlineEnd:"-",marginBottom:"1em)",marginInlineStart:"auto"}});const d={style:{},title:(0,le.jsx)(le.Fragment,{children:"Similarity Score"}),sortable:!0,renderer:e=>{var t;return(0,le.jsx)(le.Fragment,{children:(null===(t=o[e.id])||void 0===t?void 0:t.toFixed(3))||0})},getValue:e=>o[e.id]||0};return(0,le.jsxs)("div",{style:{width:"100%"},children:[(0,le.jsx)(ve().A,{large:!0,divider:"full",style:{marginBottom:16,paddingBottom:4,display:"flex"},children:"User Similarity Scores"}),(0,le.jsx)(ks,{users:r,spaceStore:t,extraColumns:{similarityColumn:d},initialSort:{column:"similarityColumn",asc:!1},tableStyle:{borderTop:void 0}})]})}var Cs=()=>n(680074),_s=()=>n(687601),Ps=()=>n(523347),Bs=()=>n(552945),Rs=()=>n(799836),Ds=()=>n(523996);function Ls(){const e=(0,a().v3)(),t=(0,v().tz)(),[n,s]=(0,i.useState)(!0),[o,r]=(0,i.useState)(!1),c=(0,l().K8)((()=>Ds().jF.getJoinableSpaces(t)),[t]),u=(0,l().K8)((()=>Ds().jF.state.allDiscoverableWorkspacesCount),[]);(0,i.useEffect)((()=>{let t=!1;return(async()=>{r(!1),Ds().jF.setState({sort:{type:"recommended",order:"asc"},searchQuery:"",discoverableWorkspaces:[],allDiscoverableWorkspacesCount:0});const n=await e.api.callApi({eventName:"getJoinableSpaces",environment:e,data:{excludeUnactionableSpaces:!0}});if(!t){if("success"===n.type){const e=Ve().default.state.currentUserRootStore,t=e?(0,_s().md)({results:n.data.results,userRootStore:e,isNewUserFlow:!1}):n.data.results;Ds().jF.setState({sort:{type:"recommended",order:"asc"},searchQuery:"",discoverableWorkspaces:t,allDiscoverableWorkspacesCount:t.length}),r(!1)}else r(!0);s(!1)}})(),()=>{t=!0}}),[e]);const p=(0,d().IS)((()=>({container:{display:"flex",flexDirection:"column",gap:12},header:{display:"flex",alignItems:"center",gap:8},headerIcon:{height:48,width:48,background:Mt().Tj.background.primary,borderRadius:8,display:"flex",alignItems:"center",justifyContent:"center"},headerText:{display:"flex",flexDirection:"column",gap:4},tableContainer:{background:Mt().Tj.background.primary,borderRadius:16,paddingTop:12,paddingBottom:20},commandBar:{marginBottom:16},divider:{height:1,background:Mt().Tj.border.primary,marginTop:0,marginBottom:8},statusText:{color:Mt().Tj.text.secondary}})),[]);let g;return g=n&&0===c.length?(0,le.jsx)(We().D,{styleKey:"bodyMedium",style:p.statusText,children:(0,le.jsx)(v().sA,{id:"workspaceDiscovery.loading",defaultMessage:"Loading workspaces..."})}):o?(0,le.jsx)(We().D,{styleKey:"bodyMedium",style:p.statusText,children:(0,le.jsx)(v().sA,{id:"workspaceDiscovery.error",defaultMessage:"We couldn’t load available workspaces right now."})}):0===u?(0,le.jsx)(We().D,{styleKey:"bodyMedium",style:p.statusText,children:(0,le.jsx)(v().sA,{id:"workspaceDiscovery.noSearchResults.message",defaultMessage:"No workspaces found"})}):(0,le.jsxs)("div",{style:p.tableContainer,children:[(0,le.jsx)("div",{style:p.commandBar,children:(0,le.jsx)(Ps().e,{isReimaginedStyles:!1,isInSettingsModal:!0})}),(0,le.jsx)(Bs().g,{joinableSpaces:c,formSpaceId:void 0,isReimaginedStyles:!1,joinContext:"settings"})]}),(0,le.jsx)(Xe().Ay,{children:(0,le.jsxs)("div",{style:p.container,children:[(0,le.jsx)("div",{style:p.header,children:(0,le.jsxs)("div",{style:p.headerText,children:[(0,le.jsx)(We().D,{styleKey:"titleSmMedium",colorVariant:"primary",children:(0,le.jsx)(v().sA,{defaultMessage:"Collaborate with teammates",id:"workspaceDiscovery.title.collaborateWithTeammates"})}),(0,le.jsx)(We().D,{styleKey:"bodySmRegular",colorVariant:"secondary",textOverflow:"ellipsis",children:(0,le.jsx)(v().sA,{defaultMessage:"{numSpaces, plural, one {{numSpaces} workspace} other {{numSpaces} workspaces}}",id:"workspaceDiscovery.subtitle",values:{numSpaces:u}})})]})}),(0,le.jsx)("div",{style:p.divider}),g]})})}const Es={settingsTab:new(Fe().O2)("customEmojiSettings",(()=>n.e(10408).then(n.bind(n,656301))))},Os=(0,Fe()._h)(Es.settingsTab,(e=>e.CustomEmojiSettings)),Ns=new(Fe().O2)("SitesSettingsTab",(async()=>await Promise.all([n.e(25700),n.e(78171)]).then(n.bind(n,238544)))),Fs=(0,Fe()._h)(Ns,(e=>e.SitesSettingsTab)),Us=new(Fe().O2)("designPreviews",(()=>n.e(23754).then(n.bind(n,159003)))),zs=(0,Fe()._h)(Us,(e=>e.DesignPreviews));var Ks=()=>n(328384),Vs=()=>n(352442),qs=()=>n(448835),Ws=()=>n(346),Gs=()=>n(274041),Hs=()=>n(463438),Ys=()=>n(340498);const $s={viewBox:"0 0 20 20",fittedViewBox:"3.12 3.12 16.38 16.38",svg:(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)("path",{d:"M3.125 5.25c0-1.174.951-2.125 2.125-2.125h9.5c1.174 0 2.125.951 2.125 2.125v.7H3.125zm0 1.8h13.75v4.433a4.6 4.6 0 0 0-5.392 5.392H5.25a2.125 2.125 0 0 1-2.125-2.125zm5.717 2.487a.694.694 0 1 0 0-1.389.694.694 0 0 0 0 1.389m.695 1.62a.694.694 0 1 0-1.39 0 .694.694 0 0 0 1.39 0m-.695 3.01a.695.695 0 1 0 0-1.39.695.695 0 0 0 0 1.39m3.01-5.324a.694.694 0 1 0-1.39 0 .694.694 0 0 0 1.39 0m-.695 3.009a.694.694 0 1 0 0-1.389.694.694 0 0 0 0 1.389m.695 1.62a.694.694 0 1 0-1.39 0 .694.694 0 0 0 1.39 0m1.62-3.935a.694.694 0 1 0 0-1.389.694.694 0 0 0 0 1.389m-6.25 1.62a.694.694 0 1 0-1.389 0 .694.694 0 0 0 1.39 0m-.694 3.01a.695.695 0 1 0 0-1.39.695.695 0 0 0 0 1.39m7.639-3.01a.694.694 0 1 0-1.39 0 .694.694 0 0 0 1.39 0"}),(0,le.jsx)("path",{d:"M16 19.5a3.5 3.5 0 1 1 0-7 3.5 3.5 0 0 1 0 7m-.656-4.094H14a.625.625 0 0 0 0 1.25h1.969c.345 0 .625-.28.625-.625v-2a.625.625 0 0 0-1.25 0z"})]})},Qs=(0,Ys().wt)("calendarBadgeClockFill",$s,"fill");var Zs=()=>n(781016);const Xs={viewBox:"0 0 20 20",fittedViewBox:"2.37 4.12 15.25 11.75",svg:(0,le.jsx)("path",{d:"M2.375 6.25c0-1.174.951-2.125 2.125-2.125h11c1.174 0 2.125.951 2.125 2.125v1.5H2.375zM15 6.55a.55.55 0 1 0 0-1.1h-1.437a.55.55 0 0 0 0 1.1zM2.375 8.75h15.25v2.5H2.375zM15.55 10a.55.55 0 0 0-.55-.55h-1.437a.55.55 0 0 0 0 1.1H15a.55.55 0 0 0 .55-.55M2.375 12.25v1.5c0 1.174.951 2.125 2.125 2.125h11a2.125 2.125 0 0 0 2.125-2.125v-1.5zM15 14.55h-1.437a.55.55 0 0 1 0-1.1H15a.55.55 0 1 1 0 1.1"})},Js=(0,Ys().wt)("serverRackFill",Xs,"fill");var eo=()=>n(942292),to=()=>n(287882),no=()=>n(706021),io=()=>n(979340),so=()=>n(303470),oo=()=>n(394888),ao=()=>n(624090),ro=()=>n(236262),lo=()=>n(484595),co=()=>n(106261);const uo=(0,v().YK)({deleteFromTrashLayoutTitle:{defaultMessage:"Auto-delete from Trash",id:"updateRetentionWindowModal.layoutTitle.deleteFromTrash."},deleteFromTrashTitle:{defaultMessage:"Auto-delete from Trash",id:"updateRetentionWindowModal.title.deleteFromTrash"},deleteFromTrashDescription:{defaultMessage:"Customize how long pages stay in Trash before being automatically deleted",id:"updateRetentionWindowModal.description.deleteFromTrash"},deleteFromTrashDefaultOptionTitle:{defaultMessage:"30 days, then delete from Trash",id:"updateRetentionWindowModal.defaultOption.title.deleteFromTrash"},deleteFromTrashDefaultOptionDescription:{defaultMessage:"Pages deleted from Trash are retained for an additional period of time. Retained pages can be restored by workspace owners",id:"updateRetentionWindowModal.defaultOption.description.deleteFromTrash"},deleteFromTrashImmediateEffect:{defaultMessage:"Reducing this retention setting may lead to pages being deleted from Trash immediately. Please type your workspace name to continue",id:"updateRetentionWindowModal.immediateEffect.deleteFromTrash"},purgeLayoutTitle:{defaultMessage:"Retaining deleted pages",id:"updateRetentionWindowModal.layoutTitle.purge"},purgeTitle:{defaultMessage:"Retaining deleted pages",id:"updateRetentionWindowModal.title.purge"},purgeDescription:{defaultMessage:"Pages deleted from Trash are retained for a period of time. Only workspace owners can view and restore retained pages.",id:"updateRetentionWindowModal.description.purge"},purgeDefaultOptionTitle:{defaultMessage:"30 days, then permanently delete",id:"updateRetentionWindowModal.defaultOption.title.purge"},purgeDefaultOptionDescription:{defaultMessage:"Pages are removed from Notion’s servers and cannot be restored",id:"updateRetentionWindowModal.defaultOption.description.purge"},purgeImmediateEffect:{defaultMessage:"Reducing the retain period could lead to pages being deleted from Notion server. Please type your workspace name to continue ",id:"updateRetentionWindowModal.immediateEffect.purge"}});const po=(0,v().YK)({days:{defaultMessage:"days",id:"customRetentionWindow.relativeDates.days"},years:{defaultMessage:"years",id:"customRetentionWindow.relativeDates.years"}}),go=(0,v().YK)({inputPlaceholder:{defaultMessage:"...",id:"customRetentionWindow.timeNum.inputPlaceholder"}}),mo=(0,rt().uv)(to().Vl).map((e=>({key:e,label:(0,le.jsx)(we().A,{children:k().A.formatMessage(po[e])})})));function fo(e){const{isDropdownEnabled:t,timeNumString:n,timeUnit:i,setTimeNumString:s,setTimeUnit:o,spaceStore:a}=e,r=(0,v().tz)(),l=(0,d().IS)((()=>({dropdownRow:{display:"flex"},input:{width:70,marginInlineEnd:4,marginInlineStart:6},dropdown:{marginTop:0,marginBottom:0,marginInlineEnd:4,borderRadius:4,border:`1px solid ${Mt().Tj.border.secondaryTranslucent}`}})),[]);return(0,le.jsxs)("span",{style:l.dropdownRow,children:[(0,le.jsx)(Dn().A,{style:l.input,value:n,onChange:e=>s(e.target.value),placeholder:r.formatMessage(go.inputPlaceholder),disabled:!t}),(0,le.jsx)(vt().m,{spaceStore:a,buttonStyle:l.dropdown,disabled:!t,type:"dropdown",currentOption:i,options:mo,onSelectOption:e=>t&&o(e)})]})}const ho=(0,v().YK)({invalidNumber:{defaultMessage:"Please enter a valid number",id:"updateRetentionWindow.error.invalidNumber"},outOfRangeTrash:{defaultMessage:"Pages can’t be in Trash for longer than 10 years",id:"updateRetentionWindow.error.outOfRangeTrash"},outOfRangeRetained:{defaultMessage:"Pages can’t be retained for longer than 10 years",id:"updateRetentionWindow.error.outOfRangeRetained"},lowerBoundTrash:{defaultMessage:"Pages can’t be in Trash for less than 1 day",id:"updateRetentionWindow.error.lowerBoundTrash"},lowerBoundRetained:{defaultMessage:"Pages can’t be retained for less than 1 day",id:"updateRetentionWindow.error.lowerBoundRetained"}});function yo({spaceStore:e,isSelected:t,retentionType:n,hasChosenRetentionWindow:s,currentRetentionWindowInSeconds:o,errorMessage:a,onNextRetentionWindowInSecondsChange:r,onClick:l,setErrorMessage:c,style:u}){const p=(0,v().tz)(),g=(0,d().IS)((()=>({rowStyles:{display:"flex",fontSize:14,background:t?Mt().Tj.blue.background.primaryTranslucent:"inherit",...u,alignItems:"flex-start",flexFlow:"column"},centeredRow:{display:"flex",flexFlow:"row",alignItems:"center"},errorMessageStyle:{marginTop:8,width:"100%",display:"flex",paddingInlineStart:28,color:Mt().Tj.red.text.accentPrimary,fontWeight:ye().Wy.regular}})),[u,t]),[m,f]=(0,i.useState)((0,to().sV)(o)),[h,y]=(0,i.useState)(`${(0,to().Uw)(o,m)}`),b=Number(h)*to().Vl[m],S=!s&&t;return(0,i.useEffect)((()=>{r(b)}),[r,b]),(0,i.useEffect)((()=>{if(t){if(void 0===h)return void c(p.formatMessage(ho.invalidNumber));const e=parseInt(h);if(isNaN(e)||e.toString()!==h)return void c(p.formatMessage(ho.invalidNumber));const t=to().Vl[m]*e;if(t>to().J1){const e="delete_from_trash"===n?ho.outOfRangeTrash:ho.outOfRangeRetained;return void c(p.formatMessage(e))}if(t<to().PL){const e="delete_from_trash"===n?ho.lowerBoundTrash:ho.lowerBoundRetained;return void c(p.formatMessage(e))}c(void 0)}}),[h,m,t,c,p,n]),(0,le.jsxs)(pi().p,{style:g.rowStyles,onClick:l,children:[(0,le.jsxs)("div",{style:g.centeredRow,children:[(0,le.jsx)(lo().A,{isSelected:t}),(0,le.jsx)(we().A,{style:g.centeredRow,children:"delete_from_trash"===n?(0,le.jsx)(v().sA,{defaultMessage:"<dropdownpicker></dropdownpicker>, then delete from trash",id:"updateRetentionWindowModal.custom.deleteFromTrash",values:{dropdownpicker:t=>(0,le.jsx)(fo,{spaceStore:e,isDropdownEnabled:S,timeNumString:h,timeUnit:m,setTimeNumString:y,setTimeUnit:f})}}):(0,le.jsx)(v().sA,{defaultMessage:"<dropdownpicker></dropdownpicker>, then permanently delete",id:"updateRetentionWindowModal.custom.permanentlyDelete",values:{dropdownpicker:t=>(0,le.jsx)(fo,{spaceStore:e,isDropdownEnabled:S,timeNumString:h,timeUnit:m,setTimeNumString:y,setTimeUnit:f})}})})]}),a?(0,le.jsx)(we().A,{style:g.errorMessageStyle,children:a}):null]})}const vo=(0,v().YK)({invalidWorkspaceName:{id:"updateRetentionWindow.error.invalidWorkspaceName",defaultMessage:"Must type in workspace name correctly"}});function bo({isOpen:e,closeModal:t,currentRetentionWindowInSeconds:n,spaceStore:s,retentionType:o,onSaveRetentionWindow:r}){const c=(0,v().tz)(),u=(0,a().v3)(),p=(0,d().IS)((()=>({contentStyle:{display:"flex",flexFlow:"column",alignItems:"center",paddingTop:24,paddingInlineStart:15,paddingInlineEnd:15},headerStyle:{display:"flex",flexFlow:"column",alignItems:"center",marginBottom:16},headerTitleStyle:{fontWeight:ye().Wy.semibold,fontSize:17,marginBottom:8},headerDescriptionStyle:{width:"100%",textAlign:"center",fontSize:14},defaultOptionStyle:{display:"flex",flexFlow:"column",paddingInlineStart:8},defaultOptionTitleStyle:{fontSize:13,fontWeight:ye().Wy.medium},defaultOptionDescriptionStyle:{width:350,fontSize:12,whiteSpace:"normal",lineHeight:"16px",fontWeight:ye().Wy.regular},iconStyle:{marginBottom:12},saveButtonStyles:{width:"100%",marginBottom:4,marginTop:16},errorMessageStyle:{marginTop:4,color:Mt().Tj.red.text.accentPrimary},cancelButtonStyles:{width:"100%",paddingTop:5,paddingBottom:5,display:"flex",justifyContent:"center",marginBottom:16,borderRadius:4},optionStyle:{width:"100%",height:void 0,marginBottom:4,paddingTop:8,paddingBottom:8,fontWeight:ye().Wy.medium,display:"flex",flexFlow:"row"},confirmationContainerStyle:{marginTop:16,width:"100%",paddingTop:14,paddingBottom:14,paddingInlineEnd:14,backgroundColor:Mt().Tj.palette.red[100],display:"flex",flexFlow:"column",alignItems:"center",borderRadius:4},confirmationDescription:{color:Mt().Tj.palette.red[800],fontSize:14,paddingBottom:6},confirmationContentStyle:{width:"90%"}})),[]),g=(0,l().K8)((()=>s.getName()),[s]),[m,h]=(0,i.useState)(void 0),[y,b]=(0,i.useState)(void 0===n),[x,M]=(0,i.useState)(n),A=y?void 0:x,[j,w]=(0,i.useState)(!1),[I,k]=(0,i.useState)(""),T=A===n||(0,rt().O9)(m),C=I!==g,_=(0,i.useCallback)((()=>{m||(S().kF(u,{type:o,value:A}),r(A),k(""),w(!1),t())}),[u,o,r,A,m,t]),P=(0,i.useCallback)((()=>{j?I===g?_():h(c.formatMessage(vo.invalidWorkspaceName)):!function({nextRetentionWindowValue:e,currentRetentionWindowValue:t,retentionType:n}){const i=So(t,n),s=So(e,n);if(s<i)return!0;return!1}({nextRetentionWindowValue:A,retentionType:o,currentRetentionWindowValue:n})?_():w(!0)}),[j,I,g,A,o,n,_,c]),B=(0,i.useCallback)((()=>{j||y||(w(!1),b(!0),h(void 0))}),[j,y,w,b,h]),R=(0,i.useCallback)((()=>{j||y&&(w(!1),b(!1))}),[j,y,w,b]),D=function(e){return(0,i.useMemo)((()=>"delete_from_trash"===e?{layoutTitle:uo.deleteFromTrashLayoutTitle,title:uo.deleteFromTrashTitle,description:uo.deleteFromTrashDescription,defaultOptionTitle:uo.deleteFromTrashDefaultOptionTitle,defaultOptionDescription:uo.deleteFromTrashDefaultOptionDescription,immediateEffect:uo.deleteFromTrashImmediateEffect}:"purge"===e?{layoutTitle:uo.purgeLayoutTitle,title:uo.purgeTitle,description:uo.purgeDescription,defaultOptionTitle:uo.purgeDefaultOptionTitle,defaultOptionDescription:uo.purgeDefaultOptionDescription,immediateEffect:uo.purgeImmediateEffect}:void(0,rt().HB)(e)),[e])}(o);return(0,le.jsx)(oo().s,{isOpen:e,onDismiss:t,areaConstraint:{width:{type:"max",length:460}},render:({displayMode:e})=>(0,le.jsx)(co().B,{displayMode:e,title:(0,le.jsx)(v().sA,{...D.layoutTitle}),children:(0,le.jsxs)("div",{style:p.contentStyle,children:[(0,le.jsxs)("div",{style:p.headerStyle,children:[(0,le.jsx)("div",{children:(0,le.jsx)(f().I,{icon:ro().trashIcon,size:36,colorVariant:"tertiary",style:p.iconStyle})}),(0,le.jsx)(we().A,{style:p.headerTitleStyle,children:(0,le.jsx)(v().sA,{...D.title})}),(0,le.jsx)(we().A,{style:p.headerDescriptionStyle,isSecondaryColor:!0,isMultiline:!0,children:(0,le.jsx)(v().sA,{...D.description})})]}),(0,le.jsxs)(pi().p,{style:p.optionStyle,onClick:B,children:[(0,le.jsx)(lo().A,{isSelected:y}),(0,le.jsxs)("div",{style:p.defaultOptionStyle,children:[(0,le.jsx)(we().A,{style:p.defaultOptionTitleStyle,children:(0,le.jsx)(v().sA,{...D.defaultOptionTitle})}),(0,le.jsx)(we().A,{isSecondaryColor:!0,isMultiline:!0,style:p.defaultOptionDescriptionStyle,children:(0,le.jsx)(v().sA,{...D.defaultOptionDescription})})]})]}),(0,le.jsx)(yo,{spaceStore:s,style:p.optionStyle,isSelected:!y,retentionType:o,hasChosenRetentionWindow:j,currentRetentionWindowInSeconds:n,errorMessage:m,onClick:R,onNextRetentionWindowInSecondsChange:M,setErrorMessage:h}),j?(0,le.jsxs)("div",{style:p.confirmationContainerStyle,children:[(0,le.jsx)(we().A,{isMultiline:!0,style:{...p.confirmationContentStyle,...p.confirmationDescription},children:(0,le.jsx)(v().sA,{...D.immediateEffect})}),(0,le.jsx)(Dn().A,{style:p.confirmationContentStyle,value:I,placeholder:g,onChange:e=>k(e.target.value)})]}):null,(0,le.jsx)(Rn().A,{colorPalette:"blue",onClick:P,disabled:j?C:T,style:p.saveButtonStyles,size:"lg",children:(0,le.jsx)(v().sA,{id:"updateRetentionWindowModal.save",defaultMessage:"Save"})}),(0,le.jsx)(Me().Ay,{onClick:t,style:p.cancelButtonStyles,children:(0,le.jsx)(we().A,{isSecondaryColor:!0,children:(0,le.jsx)(v().sA,{id:"updateRetentionWindowModal.cancel",defaultMessage:"Cancel"})})})]})})})}function So(e,t){return e||("delete_from_trash"===t?ao().I4:ao().qI)}function xo(e){const{spaceStore:t}=e,n=(0,a().v3)(),s=(0,xi()._)({name:"configurable_retention",spaceId:t.id,userId:n.currentUser.id}),[o,r]=i.useState({isOpen:!1,retentionType:"delete_from_trash"}),{saveDeleteFromTrashDelay:d,savePurgeDelay:c}=function({environment:e,spaceStore:t}){return{saveDeleteFromTrashDelay:(0,i.useCallback)((n=>{Ft().createAndCommit({userAction:"securitySettingsActions.saveDataRetentionSettings",environment:e,canUndo:!0,perform:e=>{Ft().applyOperation({store:t,operation:{pointer:t.pointer,path:["settings"],command:"update",args:{delete_from_trash_delay_seconds:n??null}},transaction:e})}})}),[t,e]),savePurgeDelay:(0,i.useCallback)((n=>{Ft().createAndCommit({userAction:"securitySettingsActions.saveDataRetentionSettings",environment:e,canUndo:!0,perform:e=>{Ft().applyOperation({store:t,operation:{pointer:t.pointer,path:["settings"],command:"update",args:{purge_delay_seconds:n??null}},transaction:e})}})}),[t,e])}}({environment:n,spaceStore:t}),{currentDeleteFromTrashDelayInSeconds:u,currentPurgeDelayInSeconds:p}=(0,l().K8)((()=>({currentDeleteFromTrashDelayInSeconds:(0,no().e2)(s)?t.getSettings().delete_from_trash_delay_seconds:void 0,currentPurgeDelayInSeconds:(0,no().e2)(s)?t.getSettings().purge_delay_seconds:void 0})),[t,s]);return(0,le.jsx)(Io,{updateModalState:o,setUpdateModalState:r,spaceStore:t,saveDeleteFromTrashDelay:d,savePurgeDelay:c,dataRetentionAvailability:s,currentDeleteFromTrashDelayInSeconds:u,currentPurgeDelayInSeconds:p})}function Mo(e){const{dataRetentionAvailability:t,spaceStore:n}=e,i=(0,d().IS)((()=>({bannerStyle:{borderRadius:4,padding:15,width:"100%",backgroundColor:Mt().Tj.blue.background.primaryTranslucent,flexFlow:(0,no().e2)(t)?"column":"row",display:"flex",overflow:"hidden"},bannerLabelStyle:{marginBottom:8}})),[t]);return!(0,no().e2)(t)&&null!=t&&t.upsell?(0,le.jsx)(Ao,{upsell:t.upsell,spaceStore:n}):(0,le.jsxs)("div",{style:i.bannerStyle,children:[(0,le.jsx)(we().A,{style:i.bannerLabelStyle,children:(0,le.jsx)(v().sA,{id:"securitySettings.dataRetention.disclaimer.title",defaultMessage:"How page deletion and retention works in Notion"})}),(0,le.jsx)(we().A,{style:i.bannerLabelStyle,isMultiline:!0,isSmall:!0,children:(0,le.jsx)(v().sA,{id:"securitySettings.dataRetention.disclaimer.description",defaultMessage:"A page can be moved to Trash by anyone with edit or full access. The page can then be restored or deleted. Workspace owners can customize whether pages in Trash are automatically deleted after a period of time, and how long deleted pages are retained on Notion’s servers."})}),(0,le.jsx)(tn().A,{title:(0,le.jsx)(ci().j,{children:(0,le.jsx)(v().sA,{defaultMessage:"Learn more about data retention in Notion",id:"securitySettings.dataRetention.learnMore"})}),buttonStyle:{maxWidth:"100%",overflow:"hidden"},href:(0,ut().x)("guides.customDataRetentionRules"),analyticsFrom:"security_settings"})]})}function Ao({upsell:e,spaceStore:t}){const n=(0,v().tz)();return"none"===e.type?null:(0,le.jsx)(so().w,{upsell:e,source:"space_settings_cdrr_settings",spaceStore:t,title:(0,le.jsx)(v().sA,{id:"securitySettings.dataRetention.upsellBanner.title",defaultMessage:"Customize your workspace’s data retention policy"}),description:(0,le.jsx)(v().sA,{id:"securitySettings.dataRetention.upsellBanner.description",defaultMessage:"Get the {planName} plan to unlock all settings",values:{planName:(0,io().u2)({product:e.product,intl:n})}}),icons:[{icon:Qs},{icon:eo().trashFillIcon},{icon:Js},{icon:Zs().clockFillIcon}]})}const jo=(0,v().YK)({eligible_to_purchase:{id:"securitySettings.dataRetention.deleteFromTrashUpgradeMessages.eligibleToPurchase",defaultMessage:"<highlight>Upgrade</highlight> to set Trash auto-deletion timing"},eligible_for_trial:{id:"securitySettings.dataRetention.deleteFromTrashUpgradeMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to set Trash auto-deletion timing"},sales_eligible:{id:"securitySettings.dataRetention.deleteFromTrashUpgradeMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to set Trash auto-deletion timing"},sales_assisted:{id:"securitySettings.dataRetention.deleteFromTrashUpgradeMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to set Trash auto-deletion timing"},eligible_to_request:{id:"securitySettings.dataRetention.deleteFromTrashUpgradeMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to set Trash auto-deletion timing"},not_eligible:{id:"securitySettings.dataRetention.deleteFromTrashUpgradeMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to set Trash auto-deletion timing"},request_pending:{id:"securitySettings.dataRetention.deleteFromTrashUpgradeMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to set Trash auto-deletion timing"}}),wo=(0,v().YK)({eligible_to_purchase:{id:"securitySettings.dataRetention.purgeUpgradeMessages.eligibleToPurchase",defaultMessage:"<highlight>Upgrade</highlight> to control Trash recovery period"},eligible_for_trial:{id:"securitySettings.dataRetention.purgeUpgradeMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to control Trash recovery period"},sales_eligible:{id:"securitySettings.dataRetention.purgeUpgradeMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to control Trash recovery period"},sales_assisted:{id:"securitySettings.dataRetention.purgeUpgradeMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to control Trash recovery period"},eligible_to_request:{id:"securitySettings.dataRetention.purgeUpgradeMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to control Trash recovery period"},not_eligible:{id:"securitySettings.dataRetention.purgeUpgradeMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to control Trash recovery period"},request_pending:{id:"securitySettings.dataRetention.purgeUpgradeMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to control Trash recovery period"}});function Io({updateModalState:e,setUpdateModalState:t,spaceStore:n,saveDeleteFromTrashDelay:i,savePurgeDelay:s,dataRetentionAvailability:o,currentDeleteFromTrashDelayInSeconds:a,currentPurgeDelayInSeconds:r}){const l=(0,v().tz)();return(0,le.jsxs)(le.Fragment,{children:[e.isOpen?(0,le.jsx)(bo,{isOpen:e.isOpen,closeModal:()=>t({...e,isOpen:!1}),spaceStore:n,currentRetentionWindowInSeconds:e.currentRetentionWindowInSeconds,retentionType:e.retentionType,onSaveRetentionWindow:"delete_from_trash"===e.retentionType?i:s}):void 0,(0,le.jsxs)(xt().Y1,{gap:48,children:[(0,le.jsxs)(xt().Y1,{gap:32,children:[(0,le.jsx)(vt().A,{spaceStore:n,type:"custom",upsellOptions:null!=o&&o.upsell?{upsell:o.upsell,analyticsName:"space_settings_cdrr_settings",customMessages:jo}:void 0,title:(0,le.jsx)(v().sA,{id:"securitySettings.dataRetention.deleteFromTrash.title",defaultMessage:"Once pages are moved to Trash, delete them after"}),caption:(0,le.jsx)(v().sA,{id:"securitySettings.dataRetention.deletedFromTrash.byline",defaultMessage:"Anyone with edit or full access will be able to restore or manually delete pages in Trash"}),customButton:(0,le.jsx)(_t().A,{size:"lg",disabled:!(0,no().e2)(o),onClick:()=>t({isOpen:!0,retentionType:"delete_from_trash",currentRetentionWindowInSeconds:a}),children:(0,le.jsx)(v().sA,{id:"securitySettings.dataRetention.deleteFromTrash.currentSetting",defaultMessage:"{duration}",values:{duration:(0,to().rN)(a,l)}})})}),(0,le.jsx)(vt().A,{spaceStore:n,type:"custom",upsellOptions:null!=o&&o.upsell?{upsell:o.upsell,analyticsName:"space_settings_cdrr_settings",customMessages:wo}:void 0,title:(0,le.jsx)(v().sA,{id:"securitySettings.dataRetention.purge.title",defaultMessage:"After pages are deleted from Trash, retain them for"}),caption:(0,le.jsx)(v().sA,{id:"securitySettings.dataRetention.purge.byline",defaultMessage:"During the retention period, only workspace owners can view or restore the page from Content search. After the retention period, the page will be permanently deleted from Notion’s servers"}),customButton:(0,le.jsx)(_t().A,{size:"lg",disabled:!(0,no().e2)(o),onClick:()=>t({isOpen:!0,retentionType:"purge",currentRetentionWindowInSeconds:r}),children:(0,le.jsx)(v().sA,{id:"securitySettings.dataRetention.deleteFromTrash.currentSetting",defaultMessage:"{duration}",values:{duration:(0,to().rN)(r,l)}})})})]}),(0,le.jsx)(Mo,{spaceStore:n,dataRetentionAvailability:o})]})]})}var ko=()=>n(681242),To=()=>n(682563);const Co={viewBox:"0 0 20 20",fittedViewBox:"4.12 2.37 11.75 15.25",svg:(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)("path",{d:"M10.6 11.334V10.6a.6.6 0 0 0-1.2 0v.734zm-.05 1.796a.55.55 0 1 1-1.1 0 .55.55 0 0 1 1.1 0"}),(0,le.jsx)("path",{d:"M6.25 2.375h3.7V6.25A2.05 2.05 0 0 0 12 8.3h3.875v7.2a2.125 2.125 0 0 1-2.125 2.125h-7.5A2.125 2.125 0 0 1 4.125 15.5v-11c0-1.174.951-2.125 2.125-2.125M10 9a1.6 1.6 0 0 0-1.6 1.6v.817a1 1 0 0 0-.6.917V14a1 1 0 0 0 1 1h2.4a1 1 0 0 0 1-1v-1.666a1 1 0 0 0-.6-.917V10.6A1.6 1.6 0 0 0 10 9"}),(0,le.jsx)("path",{d:"M15.253 6.619c.17.17.31.367.412.581H12a.95.95 0 0 1-.95-.95V2.585q.323.156.581.412z"})]})},_o=(0,Ys().wt)("lockDocFill",Co,"fill"),Po={viewBox:"0 0 20 20",fittedViewBox:"2.37 4.25 15.25 11.5",svg:(0,le.jsx)("path",{d:"M3 7.375h6.829a2.501 2.501 0 0 0 4.842 0H17a.625.625 0 1 0 0-1.25h-2.329a2.501 2.501 0 0 0-4.842 0H3a.625.625 0 1 0 0 1.25m14 6.5a.625.625 0 1 0 0-1.25h-6.829a2.5 2.5 0 0 0-4.842 0H3a.625.625 0 1 0 0 1.25h2.329a2.501 2.501 0 0 0 4.842 0z"})},Bo=(0,Ys().wt)("slidersFill",Po,"fill");var Ro=()=>n(84262),Do=()=>n(709062),Lo=()=>n(957606),Eo=()=>n(783192);function Oo({securitySettingsStore:e,spaceStore:t,organizationOverrides:n}){const i=(0,v().tz)(),s=(0,A().T)(),o=(0,xi()._)({name:"team_security_settings",spaceId:t.id,userId:s}),a=null==o?void 0:o.upsell;return(0,le.jsxs)(xt().Y1,{gap:32,children:[(0,le.jsx)(No,{upsell:a,spaceStore:t,securitySettingsStore:e,isControlledByOrganization:Boolean(n.disable_public_access)}),(0,le.jsx)(Fo,{upsell:a,spaceStore:t,securitySettingsStore:e}),(0,le.jsx)(Uo,{upsell:a,spaceStore:t,securitySettingsStore:e,isControlledByOrganization:Boolean(n.disable_move_to_space)}),(0,le.jsx)(zo,{upsell:a,spaceStore:t,securitySettingsStore:e,isControlledByOrganization:Boolean(n.disable_export)}),(0,Ro().wy)(a)?(0,le.jsx)(so().w,{upsell:a,source:"general_security_settings",spaceStore:t,title:(0,le.jsx)(v().sA,{id:"securitySettings.general.upsellBanner.title",defaultMessage:"Advanced controls for your workspace"}),description:(0,le.jsx)(v().sA,{id:"securitySettings.general.upsellBanner.description",defaultMessage:"Get the {planName} plan to unlock all settings",values:{planName:(0,io().u2)({product:a.product,intl:i})}}),icons:[{icon:_o},{icon:ko().checkmarkShieldFillIcon},{icon:To().gearFillIcon},{icon:Bo}]}):void 0]})}function No({securitySettingsStore:e,spaceStore:t,isControlledByOrganization:n,upsell:i}){const s=(0,a().v3)(),o=(0,l().K8)((()=>e.state.disablePublicAccess),[e]);return(0,le.jsx)(vt().A,{spaceStore:t,type:"toggle",isOn:o,isLocked:n,lockedTooltip:(0,Do().C_)(),onToggle:()=>{n||async function(e,t,n){const i=e.state.disablePublicAccess;if(!i){const{accept:e}=await T().Gh({message:(0,le.jsx)(v().sA,{id:"securitySAMLSettings.preventPublicSharing.confirmationModal.messageAWTLUpdate",defaultMessage:"Are you sure you want to disable publishing sites, forms, and public links?"}),description:(0,le.jsx)(v().sA,{id:"securitySAMLSettings.preventPublicSharing.confirmationModal.description",defaultMessage:"This will remove access for anyone who is not a member or guest of the workspace from all pages in this workspace."}),acceptLabel:(0,le.jsx)(v().sA,{id:"securitySAMLSettings.preventPublicSharing.confirmationModal.confirmButton.label",defaultMessage:"Yes"})});if(!e)return}(0,Eo().g)({disablePublicAccess:!i},e,t,n)}(e,t,s)},upsellOptions:i?{upsell:i,analyticsName:"disable_public_access",customMessages:Ko}:void 0,title:(0,le.jsx)(v().sA,{id:"securitySAMLSettings.securitySection.preventPublicSharing.labelAWTLUpdate",defaultMessage:"Disable publishing sites, forms, and public links"}),caption:(0,le.jsx)(v().sA,{id:"securitySAMLSettings.securitySection.preventPublicSharing.captionUpdatedAWTL",defaultMessage:"Disable the “Publish site” and “Anyone on the web with link” options in the Share menu on every page and form in this workspace"})})}function Fo({securitySettingsStore:e,spaceStore:t,upsell:n}){const i=(0,a().v3)(),s=(0,l().K8)((()=>e.state.disableSpacePageEdits),[e]);return(0,l().K8)((()=>(0,Lo().zI)({spaceStore:t})>0),[t])?null:(0,le.jsx)(vt().A,{spaceStore:t,type:"toggle",isOn:s,onToggle:()=>(0,Eo().v)({name:"disableSpacePageEdits",securitySettingsStore:e,spaceStore:t,environment:i}),upsellOptions:n?{upsell:n,analyticsName:"disable_space_page_edits",customMessages:Vo}:void 0,title:(0,le.jsx)(v().sA,{id:"securitySAMLSettings.securitySection.disableSpacePageEdits.label",defaultMessage:"Prevent members from editing the Workspace section"}),caption:(0,le.jsx)(v().sA,{id:"securitySAMLSettings.securitySection.disableSpacePageEdits.caption",defaultMessage:"Disable the ability for members to create, move, reorder, and delete top-level Workspace pages."})})}function Uo({upsell:e,spaceStore:t,securitySettingsStore:n,isControlledByOrganization:i}){const s=(0,a().v3)(),o=(0,l().K8)((()=>n.state.disableMoveToSpace),[n]);return(0,le.jsx)(vt().A,{spaceStore:t,type:"toggle",isOn:o,isLocked:i,lockedTooltip:(0,Do().C_)(),onToggle:()=>{i||(0,Eo().v)({name:"disableMoveToSpace",securitySettingsStore:n,spaceStore:t,environment:s})},upsellOptions:e?{upsell:e,analyticsName:"disable_move_to_space",customMessages:qo}:void 0,title:(0,le.jsx)(v().sA,{id:"securitySAMLSettings.securitySection.disableMovingPages.label",defaultMessage:"Disable duplicating pages to other workspaces"}),caption:(0,le.jsx)(v().sA,{id:"securitySAMLSettings.securitySection.disableMovingPages.caption",defaultMessage:"Prevent anyone from duplicating pages to other workspaces via the Move To or Duplicate To actions."})})}function zo({upsell:e,securitySettingsStore:t,spaceStore:n,isControlledByOrganization:i}){const s=(0,a().v3)(),o=(0,l().K8)((()=>t.state.disableExport),[t]);return(0,le.jsx)(vt().A,{spaceStore:n,type:"toggle",isOn:o,isLocked:i,lockedTooltip:(0,Do().C_)(),onToggle:()=>{i||(0,Eo().v)({name:"disableExport",securitySettingsStore:t,spaceStore:n,environment:s})},upsellOptions:e?{upsell:e,analyticsName:"disable_export",customMessages:Wo}:void 0,title:(0,le.jsx)(v().sA,{id:"securitySAMLSettings.securitySection.disableExport.label",defaultMessage:"Disable export"}),caption:(0,le.jsx)(v().sA,{id:"securitySAMLSettings.securitySection.disableExport.caption",defaultMessage:"Prevent anyone from exporting as Markdown, CSV, or PDF."})})}const Ko=(0,v().YK)({eligible_to_purchase:{id:"securitySettings.disablePublicAccess.upsellMessages.eligibleToPurchase",defaultMessage:"<highlight>Upgrade</highlight> to disable publishing sites, forms, and public links"},eligible_for_trial:{id:"securitySettings.disablePublicAccess.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to disable publishing sites, forms, and public links"},sales_eligible:{id:"securitySettings.disablePublicAccess.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to disable publishing sites, forms, and public links"},sales_assisted:{id:"securitySettings.disablePublicAccess.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to disable publishing sites, forms, and public links"},eligible_to_request:{id:"securitySettings.disablePublicAccess.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to disable publishing sites, forms, and public links"},not_eligible:{id:"securitySettings.disablePublicAccess.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to disable publishing sites, forms, and public links"},request_pending:{id:"securitySettings.disablePublicAccess.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to disable publishing sites, forms, and public links"}}),Vo=(0,v().YK)({eligible_to_purchase:{id:"securitySettings.disableSpacePageEdits.upsellMessages.eligibleToPurchase",defaultMessage:"<highlight>Upgrade</highlight> to disable the ability for members to create, move, reorder, and delete top-level Workspace pages"},eligible_for_trial:{id:"securitySettings.disableSpacePageEdits.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to disable the ability for members to create, move, reorder, and delete top-level Workspace pages"},sales_eligible:{id:"securitySettings.disableSpacePageEdits.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to disable the ability for members to create, move, reorder, and delete top-level Workspace pages"},sales_assisted:{id:"securitySettings.disableSpacePageEdits.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to disable the ability for members to create, move, reorder, and delete top-level Workspace pages"},eligible_to_request:{id:"securitySettings.disableSpacePageEdits.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to disable the ability for members to create, move, reorder, and delete top-level Workspace pages"},not_eligible:{id:"securitySettings.disableSpacePageEdits.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to disable the ability for members to create, move, reorder, and delete top-level Workspace pages"},request_pending:{id:"securitySettings.disableSpacePageEdits.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to disable the ability for members to create, move, reorder, and delete top-level Workspace pages"}}),qo=(0,v().YK)({eligible_to_purchase:{id:"securitySettings.disableMoveToSpace.upsellMessages.eligibleToPurchase",defaultMessage:"<highlight>Upgrade</highlight> to prevent users from duplicating pages to other workspaces via Move To or Duplicate To"},eligible_for_trial:{id:"securitySettings.disableMoveToSpace.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to prevent users from duplicating pages to other workspaces via Move To or Duplicate To"},sales_eligible:{id:"securitySettings.disableMoveToSpace.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to prevent users from duplicating pages to other workspaces via Move To or Duplicate To"},sales_assisted:{id:"securitySettings.disableMoveToSpace.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to prevent users from duplicating pages to other workspaces via Move To or Duplicate To"},eligible_to_request:{id:"securitySettings.disableMoveToSpace.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to prevent users from duplicating pages to other workspaces via Move To or Duplicate To"},not_eligible:{id:"securitySettings.disableMoveToSpace.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to prevent users from duplicating pages to other workspaces via Move To or Duplicate To"},request_pending:{id:"securitySettings.disableMoveToSpace.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to prevent users from duplicating pages to other workspaces via Move To or Duplicate To"}}),Wo=(0,v().YK)({eligible_to_purchase:{id:"securitySettings.disableExport.upsellMessages.eligibleToPurchase",defaultMessage:"<highlight>Upgrade</highlight> to prevent users from exporting as Markdown, CSV, or PDF"},eligible_for_trial:{id:"securitySettings.disableExport.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to prevent users from exporting as Markdown, CSV, or PDF"},sales_eligible:{id:"securitySettings.disableExport.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to prevent users from exporting as Markdown, CSV, or PDF"},sales_assisted:{id:"securitySettings.disableExport.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to prevent users from exporting as Markdown, CSV, or PDF"},eligible_to_request:{id:"securitySettings.disableExport.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to prevent users from exporting as Markdown, CSV, or PDF"},not_eligible:{id:"securitySettings.disableExport.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to prevent users from exporting as Markdown, CSV, or PDF"},request_pending:{id:"securitySettings.disableExport.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to prevent users from exporting as Markdown, CSV, or PDF"}});var Go=()=>n(564884),Ho=()=>n(259524),Yo=()=>n(966505),$o=function(e){return e[e.Keep=0]="Keep",e[e.Remove=1]="Remove",e}($o||{});function Qo(e){return(0,le.jsx)(u().a,{open:e.isOpen,onDismiss:e.onDismiss,render:()=>(0,le.jsx)(Zo,{...e})})}function Zo(e){const{onDismiss:t,onSave:n,guestCount:s}=e,[o,a]=(0,i.useState)($o.Keep),r=(0,d().IS)((()=>({container:{width:350,padding:30,borderRadius:5,height:400,alignItems:"center"},title:{fontFamily:ye().vc(yi().locale).sans,fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center"},subtitle:{fontFamily:ye().vc(yi().locale).sans,fontSize:14,fontWeight:300,lineHeight:"19px",margin:10,textAlign:"center"},radioContainer:{display:"flex",flexDirection:"column"},button:{justifyContent:"space-between",marginTop:10,height:70,borderRadius:5},buttonText:{display:"flex",flexDirection:"column"},optionSubtitle:{whiteSpace:"break-spaces"},actionButtonsContainer:{display:"flex",flexDirection:"column",marginTop:20},cancelButton:{justifyContent:"center",margin:"8px auto 0"}})),[]),l=(0,i.useCallback)((()=>{const e=o===$o.Keep;n(e)}),[n,o]);return(0,le.jsxs)("div",{style:r.container,children:[(0,le.jsx)(we().A,{style:r.title,children:(0,le.jsx)(v().sA,{id:"disableGuestsConfig.title",defaultMessage:"Disable inviting guests?"})}),(0,le.jsx)(we().A,{isSmall:!0,style:r.subtitle,isMultiline:!0,children:(0,rt().O9)(s)?(0,le.jsx)(v().sA,{id:"disableGuestsConfig.description",defaultMessage:"Your workspace currently has {guestCount, plural, one {1 guest} other {{guestCount} guests}}. You can choose to:",values:{guestCount:s}}):(0,le.jsx)(v().sA,{id:"disableGuestsConfig.description.noGuestCount",defaultMessage:"You are turning off guests in this workspace. You can choose to:"})}),(0,le.jsxs)("div",{style:r.radioContainer,children:[(0,le.jsxs)(_t().A,{size:"lg",onClick:()=>a($o.Keep),style:r.button,children:[(0,le.jsx)(lo().A,{isSelected:o===$o.Keep}),(0,le.jsxs)("div",{style:r.buttonText,children:[(0,le.jsx)(we().A,{children:(0,le.jsx)(v().sA,{id:"disableGuestsConfig.keepExistingGuests.title",defaultMessage:"Keep existing guests"})}),(0,le.jsx)(we().A,{isSmall:!0,isMultiline:!0,style:r.optionSubtitle,children:(0,le.jsx)(v().sA,{id:"disableGuestsConfig.keepExistingGuests.description",defaultMessage:"Guests will still be able to access the pages they’ve been invited to"})})]})]}),(0,le.jsxs)(_t().A,{size:"lg",onClick:()=>a($o.Remove),style:r.button,children:[(0,le.jsx)(lo().A,{isSelected:o===$o.Remove}),(0,le.jsxs)("div",{style:r.buttonText,children:[(0,le.jsx)(we().A,{children:(0,le.jsx)(v().sA,{id:"disableGuestsConfig.removeExistingGuests.title",defaultMessage:"Remove existing guests"})}),(0,le.jsx)(we().A,{isSmall:!0,isMultiline:!0,style:r.optionSubtitle,children:(0,le.jsx)(v().sA,{id:"disableGuestsConfig.removeExistingGuests.description",defaultMessage:"All guests will be removed from your workspace"})})]})]})]}),(0,le.jsxs)("div",{style:r.actionButtonsContainer,children:[(0,le.jsx)(Rn().A,{colorPalette:"blue",size:"lg",onClick:l,children:(0,le.jsx)(v().sA,{id:"disableGuestsModal.saveChanges",defaultMessage:"Disable inviting guests"})}),(0,le.jsx)(pi().p,{onClick:t,style:r.cancelButton,children:(0,le.jsx)(v().sA,{id:"disableGuestsModal.cancel",defaultMessage:"Cancel"})})]})]})}var Xo=()=>n(637573),Jo=()=>n(687111),ea=()=>n(973189),ta=()=>n(817045);function na({onDismiss:e,onSubmit:t}){return(0,le.jsx)(ta().S,{onSubmit:t,onCancel:e,headerText:(0,le.jsx)(v().sA,{id:"disablePermissionGroupsForRestrictedMembersModal.title",defaultMessage:"Disable permission groups for restricted members?"}),bylineText:(0,le.jsx)(v().sA,{id:"disablePermissionGroupsForRestrictedMembersModal.description",defaultMessage:"Disabling permission groups for restricted members will remove all current restricted members in permission groups"}),submitText:(0,le.jsx)(v().sA,{id:"disablePermissionGroupsForRestrictedMembersModal.button.save",defaultMessage:"Confirm"})})}var ia=()=>n(718191);function sa({securitySettingsStore:e,spaceStore:t,organizationOverrides:n}){const i=(0,A().T)(),s=(0,g().lh)({spaceId:t.id}),a=(0,l().O$)(e),r=(0,xi()._)({name:"team_security_settings",spaceId:t.id,userId:i}),d=(0,xi()._)({name:"disable_public_access_requests",spaceId:t.id,userId:i}),c=e=>{if(!(0,Ro().e2)(r)&&!e)return null==r?void 0:r.upsell},u=a.disablePublicAccessRequests||null==d?void 0:d.upsell,p=(0,l().K8)((()=>j().default.checkGate({gateName:"allow_public_page_access_request",disableExposureLogging:!0})),[]),m=(0,o().X)("restricted_members_enabled"),f=(0,o().X)("space_permission_group_restricted_members_setting_enabled"),h=(0,l().K8)((()=>!1===t.getSetting("enable_permission_group_restricted_members")),[t]),y=m&&f||h;return(0,le.jsxs)(xt().Y1,{gap:32,children:[(0,le.jsx)(ua,{upsell:u,spaceStore:t,securitySettingsStore:e,publicAccessRequestsExpEnabled:p}),(0,le.jsx)(la,{securitySettingsStore:e,spaceStore:t,upsell:c(a.disableGuests),publicAccessRequestsExpEnabled:p,isControlledByOrganization:Boolean(n.disable_guests)}),(0,le.jsx)(da,{securitySettingsStore:e,spaceStore:t,upsell:c(a.enableGuestInviteRequests),publicAccessRequestsExpEnabled:p,isControlledByOrganization:Boolean(n.enable_guest_invite_requests)}),(0,le.jsx)(ia().B,{spaceStore:t,securitySettingsStore:e,organizationOverrides:n}),(0,le.jsx)(ca,{securitySettingsStore:e,spaceStore:t,upsell:c(a.disableGuestPrivatePages),isControlledByOrganization:Boolean(n.disable_guest_can_create_private_pages),billingData:s}),m?(0,le.jsx)(oa,{spaceStore:t,securitySettingsStore:e}):null,m?(0,le.jsx)(aa,{spaceStore:t,securitySettingsStore:e}):null,y?(0,le.jsx)(ra,{spaceStore:t,securitySettingsStore:e}):null]})}function oa({securitySettingsStore:e,spaceStore:t}){const n=(0,a().v3)(),s=(0,xi()._)({name:"restricted_members",spaceId:t.id,userId:n.currentUser.id}),o=(0,l().K8)((()=>e.state.rolesThatCanAddRestrictedMembersToTeamspaces??"space_owner"),[e]),r=(0,i.useCallback)((i=>{(0,Eo().g)({rolesThatCanAddRestrictedMembersToTeamspaces:i},e,t,n)}),[e,t,n]);return(0,le.jsx)(vt().A,{spaceStore:t,type:"dropdown",disabled:!1,upsellOptions:null!=s&&s.upsell?{upsell:s.upsell,analyticsName:"roles_that_can_add_restricted_members_to_teamspaces",customMessages:pa}:void 0,currentOption:o,options:[{key:"space_owner",label:(0,le.jsx)(v().sA,{id:"spaceSettingsRequests.addRestrictedMembersToTeamspace.spaceOwner",defaultMessage:"Workspace owners"})},{key:"space_owner_and_team_owner",label:(0,le.jsx)(v().sA,{id:"spaceSettingsRequests.addRestrictedMembersToTeamspace.spaceOwnerAndTeamOwner",defaultMessage:"Workspace and Teamspace owners"})},{key:"member",label:(0,le.jsx)(v().sA,{id:"spaceSettingsRequests.addRestrictedMembersToTeamspace.member",defaultMessage:"Any member"})}],onSelectOption:r,title:(0,le.jsx)(v().sA,{id:"spaceSettingsRequests.addRestrictedMembersToTeamspace.title",defaultMessage:"Who can add restricted members to Teamspaces"}),caption:(0,le.jsx)(v().sA,{id:"spaceSettingsRequests.addRestrictedMembersToTeamspace.caption",defaultMessage:"Specifies which roles can add restricted members to Teamspaces"})})}function aa({securitySettingsStore:e,spaceStore:t}){const n=(0,a().v3)(),s=(0,xi()._)({name:"restricted_members",spaceId:t.id,userId:n.currentUser.id}),o=(0,l().K8)((()=>e.state.rolesThatCanAddRestrictedMembersToPages??Ho().Qb),[e]),r=(0,i.useCallback)((i=>{(0,Eo().g)({rolesThatCanAddRestrictedMembersToPages:i},e,t,n)}),[e,t,n]);return(0,le.jsx)(vt().A,{spaceStore:t,type:"dropdown",disabled:!1,upsellOptions:null!=s&&s.upsell?{upsell:s.upsell,analyticsName:"roles_that_can_add_restricted_members_to_pages",customMessages:ga}:void 0,currentOption:o,options:[{key:"space_owner",label:(0,le.jsx)(v().sA,{id:"spaceSettingsRequests.addRestrictedMembersToPages.spaceOwner",defaultMessage:"Workspace owners"})},{key:"member_with_admin_approval",label:(0,le.jsx)(v().sA,{id:"spaceSettingsRequests.addRestrictedMembersToPages.memberWithAdminApproval",defaultMessage:"Any member with admin approval"})},{key:"member",label:(0,le.jsx)(v().sA,{id:"spaceSettingsRequests.addRestrictedMembersToPages.member",defaultMessage:"Any member"})}],onSelectOption:r,title:(0,le.jsx)(v().sA,{id:"spaceSettingsRequests.addRestrictedMembersToPages.title",defaultMessage:"Who can add restricted members to pages"}),caption:(0,le.jsx)(v().sA,{id:"spaceSettingsRequests.addRestrictedMembersToPages.caption",defaultMessage:"Configures who can add restricted members to individual pages"})})}function ra({securitySettingsStore:e,spaceStore:t}){const n=(0,a().v3)(),[s,o]=(0,i.useState)(!1),r=(0,xi()._)({name:"restricted_members",spaceId:t.id,userId:n.currentUser.id}),d=(0,l().K8)((()=>e.state.enablePermissionGroupRestrictedMembers??!0),[e]),c=(0,i.useCallback)((()=>{const i=!(e.state.enablePermissionGroupRestrictedMembers??!0);!1===i?o(!0):(0,Eo().g)({enablePermissionGroupRestrictedMembers:i},e,t,n)}),[e,t,n]),u=(0,i.useCallback)((()=>(o(!1),(0,Eo().g)({enablePermissionGroupRestrictedMembers:!1},e,t,n),Promise.resolve())),[e,t,n]);return(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(vt().A,{spaceStore:t,type:"toggle",disabled:!1,upsellOptions:null!=r&&r.upsell?{upsell:r.upsell,analyticsName:"enable_permission_group_restricted_members",customMessages:ma}:void 0,isOn:d,onToggle:c,title:(0,le.jsx)(v().sA,{id:"spaceSettingsRequests.enablePermissionGroupRestrictedMembers.title",defaultMessage:"Allow restricted members to be added to permission groups"}),caption:(0,le.jsx)(v().sA,{id:"spaceSettingsRequests.enablePermissionGroupRestrictedMembers.caption",defaultMessage:"Enables adding restricted members to permission groups"})}),s?(0,le.jsx)(na,{onDismiss:()=>o(!1),onSubmit:u}):null]})}function la({securitySettingsStore:e,spaceStore:t,publicAccessRequestsExpEnabled:n,isControlledByOrganization:s,upsell:o}){const r=(0,a().v3)(),d=(0,l().O$)(e),c=(0,Xo().r)(),u=(0,l().K8)((()=>{const t=e.state.disableGuests,i=e.state.disablePublicAccessRequests;return!(t&&!i)&&(n&&!i)}),[n,e]),p=(0,i.useCallback)((()=>{s||function(e,t,n){const i=e.state.disableGuests,s=e.state.enableGuestInviteRequests;if(i)return void(0,Eo().g)({disableGuests:!i,...s&&{enableGuestInviteRequests:!s}},e,t,n);e.setState({...e.state,disableGuestsModalOpen:!0})}(e,t,r)}),[r,e,t,s]);return void 0===c?null:(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(vt().A,{spaceStore:t,type:"toggle",disabled:u,isOn:!d.disableGuests,isLocked:s,lockedTooltip:(0,Do().C_)(),onToggle:p,upsellOptions:o?{upsell:o,analyticsName:"disable_guests",customMessages:ha}:void 0,tooltipLabel:u?(0,le.jsx)(v().sA,{id:"securitySAMLSettings.guestsSection.disableGuests.disabled.label",defaultMessage:"Disable page access requests from non-members to disable this feature"}):void 0,title:(0,le.jsx)(v().sA,{id:"securitySAMLSettings.guestsSection.allowGuests.label",defaultMessage:"Allow members to invite guests to pages"}),caption:(0,le.jsx)(v().sA,{id:"securitySAMLSettings.guestsSection.disableGuests.caption",defaultMessage:"Your workspace currently has <gueststablink> {guestCount, plural, one {1 guest} other {{guestCount} guests}}</gueststablink>",values:{gueststablink:e=>(0,le.jsx)(ui().V,{onClick:e=>{e.stopPropagation(),Yo().Gq(r,{source_tab:Qe().Ay.state.currentTab,destination_tab:"members",destination_subtab:ea().d.Guests}),Qe().Ay.setState({...Qe().Ay.state,currentTab:"members",defaultSubtab:ea().d.Guests})},children:e}),guestCount:c}})}),(0,le.jsx)(Qo,{isOpen:Boolean(d.disableGuestsModalOpen),onDismiss:()=>{e.setState({...e.state,disableGuestsModalOpen:!1})},onSave:n=>{(0,Eo().g)({disableGuests:!0,keepExistingGuests:n},e,t,r),e.setState({...e.state,disableGuestsModalOpen:!1})},guestCount:c})]})}function da({securitySettingsStore:e,spaceStore:t,publicAccessRequestsExpEnabled:n,isControlledByOrganization:s,upsell:o}){const r=(0,a().v3)(),d=(0,l().K8)((()=>e.state.enableGuestInviteRequests),[e]),c=(0,l().K8)((()=>!e.state.disableGuests||n&&!e.state.disablePublicAccessRequests),[e,n]),u=(0,i.useCallback)((()=>{s||(0,Eo().v)({name:"enableGuestInviteRequests",securitySettingsStore:e,spaceStore:t,environment:r})}),[r,e,t,s]),p=(0,l().K8)((()=>(0,ws().dW)()),[]),g=(0,l().K8)((()=>!Boolean(o)&&!e.state.disableGuests),[e,o]);return(0,le.jsx)(vt().A,{spaceStore:t,type:"toggle",disabled:c,isOn:d,isLocked:s,lockedTooltip:(0,Do().C_)(),onToggle:u,upsellOptions:o?{upsell:o,analyticsName:"enable_guest_invite_requests",customMessages:va}:void 0,tooltipLabel:g?(0,le.jsx)(v().sA,{id:"securitySAMLSettings.guestsSection.enableGuestInviteRequests.disabled.label",defaultMessage:"Disable inviting guests to use this feature"}):void 0,title:(0,le.jsx)(v().sA,{id:"securitySAMLSettings.guestsSection.enableGuestInviteRequests.label",defaultMessage:"Allow members to request adding guests"}),caption:(0,le.jsx)(v().sA,{id:"securitySAMLSettings.guestsSection.enableGuestInviteRequests.caption",defaultMessage:"{hasRequestTab, select, true {Requests must be approved by a workspace owner. You can view all requests <requeststablink>here</requeststablink>} other {Requests must be approved by a workspace owner}}",values:{hasRequestTab:p,requeststablink:e=>(0,le.jsx)(ui().V,{onClick:e=>{e.stopPropagation(),Yo().Gq(r,{source_tab:Qe().Ay.state.currentTab,destination_tab:"members",destination_subtab:ea().d.Requests}),Qe().Ay.setState({...Qe().Ay.state,currentTab:"members",defaultSubtab:ea().d.Requests})},children:e})}})})}function ca(e){const{securitySettingsStore:t,spaceStore:n,upsell:s,isControlledByOrganization:o,billingData:r}=e,d=(0,a().v3)(),c=(0,l().K8)((()=>t.state.disableGuestPrivatePages),[t]),u=(0,l().K8)((()=>(0,Jo().H)()&&!(0,y().N8)(r)),[r]),p=(0,i.useCallback)((()=>{o||((0,Go().u)({environment:d,event:{eventName:"guest_with_private_pages_admin_settings_updated",eventProperties:{space_id:n.id,final_setting_value:c?"enabled":"disabled"}}}),(0,Eo().v)({name:"disableGuestPrivatePages",securitySettingsStore:t,spaceStore:n,environment:d}))}),[d,t,n,o,c]);return u?(0,le.jsx)(vt().A,{spaceStore:n,type:"toggle",disabled:!1,isOn:!c,isLocked:o,lockedTooltip:(0,Do().C_)(),onToggle:p,upsellOptions:s?{upsell:s,analyticsName:"disable_guest_private_pages",customMessages:ya}:void 0,title:(0,le.jsx)(v().sA,{id:"securitySAMLSettings.guestsSection.disableGuestPrivatePages.label",defaultMessage:"Allow guests to create private pages while their membership is pending"}),caption:(0,le.jsx)(v().sA,{id:"securitySAMLSettings.guestsSection.disableGuestPrivatePages.caption",defaultMessage:"If enabled, guests can create private pages after requesting membership to this workspace"})}):null}function ua({securitySettingsStore:e,spaceStore:t,publicAccessRequestsExpEnabled:n,upsell:i}){const s=(0,a().v3)(),o=(0,l().K8)((()=>e.state.disablePublicAccessRequests),[e]),r=(0,l().K8)((()=>{const n=!e.state.disablePublicAccessRequests,i=!n;return()=>{(0,Eo().g)({disablePublicAccessRequests:n,...i&&{disableGuests:!1,enableGuestInviteRequests:!1}},e,t,s)}}),[s,t,e]);return n?(0,le.jsx)(vt().A,{spaceStore:t,type:"toggle",isOn:!o,onToggle:r,upsellOptions:i?{upsell:i,analyticsName:"disable_public_access_requests",customMessages:fa}:void 0,title:(0,le.jsx)(v().sA,{id:"securitySAMLSettings.securitySection.disablePublicAccessRequests.label",defaultMessage:"Allow page access requests from non-members"}),caption:(0,le.jsx)(v().sA,{id:"securitySAMLSettings.securitySection.disablePublicAccessRequests.caption",defaultMessage:"This allows anyone with the link to a page to request access. Workspace members can always request access."})}):null}const pa=(0,v().YK)({eligible_to_purchase:{id:"securitySettings.restrictedMembersTeamspaceConfiguration.upsellMessages.eligibleToPurchase",defaultMessage:"<highlight>Upgrade</highlight> to customize who can add restricted members to Teamspaces"},eligible_for_trial:{id:"securitySettings.restrictedMembersTeamspaceConfiguration.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to customize who can add restricted members to Teamspaces"},sales_eligible:{id:"securitySettings.restrictedMembersTeamspaceConfiguration.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to customize who can add restricted members to Teamspaces"},sales_assisted:{id:"securitySettings.restrictedMembersTeamspaceConfiguration.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to customize who can add restricted members to Teamspaces"},eligible_to_request:{id:"securitySettings.restrictedMembersTeamspaceConfiguration.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to customize who can add restricted members to Teamspaces"},not_eligible:{id:"securitySettings.restrictedMembersTeamspaceConfiguration.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to customize who can add restricted members to Teamspaces"},request_pending:{id:"securitySettings.restrictedMembersTeamspaceConfiguration.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to customize who can add restricted members to Teamspaces"}}),ga=(0,v().YK)({eligible_to_purchase:{id:"securitySettings.restrictedMembersPageConfiguration.upsellMessages.eligibleToPurchase",defaultMessage:"<highlight>Upgrade</highlight> to customize who can add restricted members to pages"},eligible_for_trial:{id:"securitySettings.restrictedMembersPageConfiguration.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to customize who can add restricted members to pages"},sales_eligible:{id:"securitySettings.restrictedMembersPageConfiguration.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to customize who can add restricted members to pages"},sales_assisted:{id:"securitySettings.restrictedMembersPageConfiguration.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to customize who can add restricted members to pages"},eligible_to_request:{id:"securitySettings.restrictedMembersPageConfiguration.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to customize who can add restricted members to pages"},not_eligible:{id:"securitySettings.restrictedMembersPageConfiguration.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to customize who can add restricted members to pages"},request_pending:{id:"securitySettings.restrictedMembersPageConfiguration.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to customize who can add restricted members to pages"}}),ma=(0,v().YK)({eligible_to_purchase:{id:"securitySettings.restrictedMembersPermissionGroupConfiguration.upsellMessages.eligibleToPurchase",defaultMessage:"<highlight>Upgrade</highlight> to disable restricted members from being added to permission groups"},eligible_for_trial:{id:"securitySettings.restrictedMembersPermissionGroupConfiguration.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to disable restricted members from being added to permission groups"},sales_eligible:{id:"securitySettings.restrictedMembersPermissionGroupConfiguration.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to disable restricted members from being added to permission groups"},sales_assisted:{id:"securitySettings.restrictedMembersPermissionGroupConfiguration.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to disable restricted members from being added to permission groups"},eligible_to_request:{id:"securitySettings.restrictedMembersPermissionGroupConfiguration.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to disable restricted members from being added to permission groups"},not_eligible:{id:"securitySettings.restrictedMembersPermissionGroupConfiguration.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to disable restricted members from being added to permission groups"},request_pending:{id:"securitySettings.restrictedMembersPermissionGroupConfiguration.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to disable restricted members from being added to permission groups"}}),fa=(0,v().YK)({eligible_to_purchase:{id:"securitySettings.disablePublicAccessRequests.upsellMessages.eligibleToPurchase",defaultMessage:"<highlight>Upgrade</highlight> to disable the ability for anyone with the link to a page to request access"},eligible_for_trial:{id:"securitySettings.disablePublicAccessRequests.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to disable the ability for anyone with the link to a page to request access"},sales_eligible:{id:"securitySettings.disablePublicAccessRequests.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to disable the ability for anyone with the link to a page to request access"},sales_assisted:{id:"securitySettings.disablePublicAccessRequests.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to disable the ability for anyone with the link to a page to request access"},eligible_to_request:{id:"securitySettings.disablePublicAccessRequests.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to disable the ability for anyone with the link to a page to request access"},not_eligible:{id:"securitySettings.disablePublicAccessRequests.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to disable the ability for anyone with the link to a page to request access"},request_pending:{id:"securitySettings.disablePublicAccessRequests.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to disable the ability for anyone with the link to a page to request access"}}),ha=(0,v().YK)({eligible_to_purchase:{id:"securitySettings.disableGuests.upsellMessages.eligibleToPurchase",defaultMessage:"<highlight>Upgrade</highlight> to disable the ability for members to invite guests to pages"},eligible_for_trial:{id:"securitySettings.disableGuests.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to disable the ability for members to invite guests to pages"},sales_eligible:{id:"securitySettings.disableGuests.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to disable the ability for members to invite guests to pages"},sales_assisted:{id:"securitySettings.disableGuests.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to disable the ability for members to invite guests to pages"},eligible_to_request:{id:"securitySettings.disableGuests.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to disable the ability for members to invite guests to pages"},not_eligible:{id:"securitySettings.disableGuests.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to disable the ability for members to invite guests to pages"},request_pending:{id:"securitySettings.disableGuests.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to disable the ability for members to invite guests to pages"}}),ya=(0,v().YK)({eligible_to_purchase:{id:"securitySettings.disableGuestPrivatePages.upsellMessages.eligibleToPurchase",defaultMessage:"<highlight>Upgrade</highlight> to prevent guests from creating private pages"},eligible_for_trial:{id:"securitySettings.disableGuestPrivatePages.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to prevent guests from creating private pages"},sales_eligible:{id:"securitySettings.disableGuestPrivatePages.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to prevent guests from creating private pages"},sales_assisted:{id:"securitySettings.disableGuestPrivatePages.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to prevent guests from creating private pages"},eligible_to_request:{id:"securitySettings.disableGuestPrivatePages.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to prevent guests from creating private pages"},not_eligible:{id:"securitySettings.disableGuestPrivatePages.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to prevent guests from creating private pages"},request_pending:{id:"securitySettings.disableGuestPrivatePages.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to prevent guests from creating private pages"}}),va=(0,v().YK)({eligible_to_purchase:{id:"securitySettings.enableGuestInviteRequests.upsellMessages.eligibleToPurchase",defaultMessage:"<highlight>Upgrade</highlight> to let workspace members send guest requests to admins"},eligible_for_trial:{id:"securitySettings.enableGuestInviteRequests.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to let workspace members send guest requests to admins"},sales_eligible:{id:"securitySettings.enableGuestInviteRequests.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to let workspace members send guest requests to admins"},sales_assisted:{id:"securitySettings.enableGuestInviteRequests.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to let workspace members send guest requests to admins"},eligible_to_request:{id:"securitySettings.enableGuestInviteRequests.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to let workspace members send guest requests to admins"},not_eligible:{id:"securitySettings.enableGuestInviteRequests.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to let workspace members send guest requests to admins"},request_pending:{id:"securitySettings.enableGuestInviteRequests.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to let workspace members send guest requests to admins"}}),ba=["security","members_and_guests","data_retention"],Sa={security:(0,le.jsx)(v().sA,{id:"securityTabs.general.title",defaultMessage:"General"}),members_and_guests:(0,le.jsx)(v().sA,{id:"securityTabs.membersAndGuests.title",defaultMessage:"Members & guests"}),data_retention:(0,le.jsx)(v().sA,{id:"securityTabs.dataRetention.title",defaultMessage:"Data retention"})};function xa({securitySettingsStore:e,spaceStore:t,organizationOverrides:n}){const s=(0,a().v3)(),o=(0,l().K8)((()=>Qe().Ay.getState().defaultSubtab),[]),[r,d]=(0,i.useState)((()=>o&&(0,rt().Xk)(ba,o)?ba.indexOf(o):0)),c=(0,i.useCallback)((e=>{S()._J(s,{tab:ba[e]}),d(e)}),[d,s]),u=i.useMemo((()=>{switch(ba[r]){case"security":return(0,le.jsx)(Oo,{securitySettingsStore:e,spaceStore:t,organizationOverrides:n});case"members_and_guests":return(0,le.jsx)(sa,{securitySettingsStore:e,spaceStore:t,organizationOverrides:n});case"data_retention":return(0,le.jsx)(xo,{spaceStore:t})}}),[r,e,t,n]);return(0,le.jsxs)(Xe().Ay,{children:[(0,le.jsx)(ve().A,{large:!0,divider:"full",children:(0,le.jsx)(v().sA,{id:"securitySettings.securityAndData.title",defaultMessage:"Security & data"})}),(0,le.jsxs)(xt().Y1,{gap:28,children:[(0,le.jsx)(Hs().LZ,{tabs:ba.map((e=>Sa[e])),selectedIndex:r,onChange:c}),u]})]})}var Ma=()=>n(444133),Aa=()=>n(271476);class ja extends O().Store{getInitialState(){return{status:"unconfigured",emailDomains:[],domainVerifications:[],spaces:[],createAccount:!1,useMetadataUrl:!0}}}const wa=ja;var Ia=()=>n(309049),ka=()=>n(427508);function Ta({spaceStore:e}){return(0,le.jsx)(Xe().Ay,{children:(0,le.jsx)("div",{style:{padding:"16px 24px"},children:(0,le.jsx)(ka().Z,{spaceStore:e})})})}var Ca=()=>n(607528),_a=()=>n(611648),Pa=()=>n(806080),Ba=()=>n(376254);const Ra=(0,v().YK)({apply_credit:{id:"spaceSubscriptionBilling.applyCreditButton.label",defaultMessage:"Apply credit"},update:{id:"spaceSubscriptionBilling.updateButton.label",defaultMessage:"Update"},add:{id:"spaceSubscriptionBilling.addButton.label",defaultMessage:"Add"},apply:{id:"spaceSubscriptionBilling.apply.label",defaultMessage:"Apply"}});function Da(e){const t={marginInlineStart:18,marginInlineEnd:-4,fontWeight:ye().Wy.medium},{title:n,caption:i,buttonArgs:s}=e,o=(0,le.jsx)(v().sA,{...Ra[s.buttonPurpose]});return(0,le.jsxs)("div",{style:{display:"flex",alignItems:"center",fontSize:14},children:[(0,le.jsx)("div",{style:{marginInlineEnd:"auto"},children:n}),(0,le.jsx)("div",{style:{color:Mt().Tj.text.secondary},children:i}),(0,le.jsx)("div",{style:{minWidth:110,display:"flex",justifyContent:"flex-end"},children:s.showButton?(0,le.jsx)(pi().p,{colorPalette:"blue",onClick:s.onClick,style:t,children:o}):void 0})]})}var La=()=>n(795438);const Ea={workspaceBalance:(0,le.jsx)(v().sA,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.workspaceSubscriptionBalance.title",defaultMessage:"Workspace balance"}),applyCoupon:(0,le.jsx)(v().sA,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.applyCoupon.title",defaultMessage:"Apply coupon"}),discount:(0,le.jsx)(v().sA,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.discount.title",defaultMessage:"Discount"})};var Oa=()=>n(117637),Na=()=>n(517492);const Fa={height:"100%",padding:"36px 60px"},Ua={display:"flex",flexDirection:"column",height:"100%"};function za({spaceStore:e,billingData:t,billingEvents:n}){const i=(0,v().tz)();return(0,l().O$)(c().e)?(0,le.jsx)("div",{style:Ua,children:(0,le.jsxs)(Ba().H,{style:Fa,type:_a().A.Y,children:[(0,le.jsx)(ve().A,{large:!0,divider:"full",children:(0,le.jsx)(v().sA,{...La().D.billingTabTitle})}),(0,le.jsx)(Ka,{billingData:t}),(0,le.jsx)(Va,{}),(0,le.jsx)(Oa().g,{spaceStore:e,events:n,upcomingInvoiceData:void 0})]})}):(0,le.jsx)(Xe().Ay,{children:(0,le.jsx)(we().A,{isSmall:!0,style:{textAlign:"center"},children:i.formatMessage(Ca().DZ.offline)})})}function Ka({billingData:e}){const t=e.lockedCurrencyCode;if(!t)return null;const n=(0,y().o2)(e,t),i=-Math.min(0,n.amount);return(0,le.jsx)(Da,{title:Ea.workspaceBalance,caption:(0,le.jsx)("div",{children:(0,le.jsx)(Na().v,{cost:{amount:i,currencyCode:t},trailingZeroDisplay:"stripIfInteger"})}),buttonArgs:{showButton:!1,buttonPurpose:"apply_credit",onClick:Pa().lQ}})}function Va(){return(0,le.jsx)("div",{style:{flex:"none",marginTop:30}})}var qa=()=>n(415184),Wa=()=>n(479314),Ga=()=>n(543786),Ha=()=>n(249046),Ya=()=>n(287188),$a=()=>n(158115),Qa=()=>n(542564),Za=()=>n(14507),Xa=()=>n(881575),Ja=()=>n(685272),er=()=>n(196131),tr=()=>n(720665),nr=()=>n(773442);function ir({spaceStore:e,requestType:t}){const n=sr({spaceStore:e}),s=(0,a().v3)(),[{value:o=[]}]=(0,Ge().Yb)((async()=>{if(!n)return;const t=await D().callApi({eventName:"getAccessRequests",environment:s,data:{parentTable:"space",parentId:e.id,size:100,status:"pending"}});if("failed"===t.type)throw t.error;const i=t.data.accessRequestIds;return b().si(s,e,i)}),[e,s,n]),r=(0,l().K8)((()=>o.filter((e=>"pending"===e.accessRequest.status))),[o]),d=(0,nr().T)({spaceStore:e,requests:r}),c=(0,i.useMemo)((()=>(0,un().yU)(r,d??[]).filter((e=>{const[n,i]=e;return"member"===t&&"space_membership_request"===i||("guest"===t&&"guest_invite_request"===i||"member_or_guest"===t&&("guest_invite_request"===i||"space_membership_request"===i))})).map((([e])=>e))),[t,d,r]);return(0,un().oE)(c)}function sr({spaceStore:e}){return(0,l().K8)((()=>e.canEditMembership()&&(0,ae().x3)()),[e])}function or({requestType:e,spaceStore:t}){const n=ir({spaceStore:t,requestType:e});return(0,l().K8)((()=>{const{sidebarSpaceViewStore:t}=Ve().default.state;if(t)return n.filter((n=>{const i=function({requestType:e,sidebarSpaceViewStore:t}){var n,i;const s=Date.now()-10*tr().Gq,o="member"===e?null===(n=t.getSettings())||void 0===n?void 0:n.last_opened_member_request_tab:null===(i=t.getSettings())||void 0===i?void 0:i.last_opened_guest_request_tab;return o??s}({requestType:e,sidebarSpaceViewStore:t});return i<n.accessRequest.created_time})).length}),[e,n])}function ar({requestType:e,spaceStore:t}){const n=(0,a().v3)(),s=sr({spaceStore:t});(0,i.useEffect)((()=>{const{sidebarSpaceViewStore:t}=Ve().default.state;t&&s&&"member"!==e&&Ft().createAndCommit({userAction:"SpaceSettingsRequests.updateLastOpened",environment:n,canUndo:!0,perform:e=>{Ft().applyOperation({store:t,operation:{pointer:t.pointer,path:["settings","last_opened_guest_request_tab"],command:"set",args:Date.now()},transaction:e})}})}),[e,n,s]),(0,i.useEffect)((()=>()=>{const{sidebarSpaceViewStore:t}=Ve().default.state;t&&s&&"guest"!==e&&Ft().createAndCommit({userAction:"SpaceSettingsRequests.updateLastOpened",environment:n,canUndo:!0,perform:e=>{Ft().applyOperation({store:t,operation:{pointer:t.pointer,path:["settings","last_opened_member_request_tab"],command:"set",args:Date.now()},transaction:e})}})}),[e,n,s])}var rr=()=>n(568688);var lr=()=>n(704658),dr=()=>n(383716);const cr=4;function ur({securitySettingsStore:e,spaceStore:t}){const n=(0,v().tz)(),i=(0,d().IS)((()=>({horizontalScrollWrapper:{minWidth:750}})),[]);return(0,le.jsxs)(xt().Y1,{direction:"vertical",padding:"36px 60px",style:i.horizontalScrollWrapper,children:[(0,le.jsxs)(xt().Y1,{direction:"vertical",gap:16,children:[(0,le.jsx)(dr().n,{title:n.formatMessage(br.title)}),(0,le.jsxs)(xt().Y1,{direction:"horizontal",gap:14,children:[t?(0,le.jsx)(gr,{spaceStore:t}):void 0,t?(0,le.jsx)(mr,{spaceStore:t}):void 0]})]}),(0,le.jsx)(pr,{securitySettingsStore:e,spaceStore:t})]})}function pr({securitySettingsStore:e,spaceStore:t}){const n=(0,v().tz)(),{setPage:s}=(0,i.useContext)(Wa().K),o=(0,d().IS)((()=>({button:{paddingTop:3,paddingInlineEnd:0,paddingBottom:0,paddingInlineStart:0,height:"100%"},headerContainer:{marginTop:32}})),[]);return(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)("div",{style:o.headerContainer,children:(0,le.jsx)("span",{style:{fontSize:16,fontWeight:500},children:n.formatMessage(br.permissionsTitle)})}),(0,le.jsxs)(Qa().L,{children:[(0,le.jsx)(pi().p,{style:o.button,onClick:()=>s("people_invitation_settings"),ignoreLocalHoverState:!0,children:(0,le.jsx)(Xa().y,{title:n.formatMessage(br.membersAndGuestsSettingTitle),byline:n.formatMessage(br.memberAndGuestsSettingByline),onClick:()=>s("people_invitation_settings"),item:(0,le.jsx)(f().I,{icon:$a().arrowChevronSingleRightFillSmallIcon,size:"xs",colorVariant:"tertiary"})})}),(0,le.jsx)(fr,{securitySettingsStore:e,spaceStore:t})]})]})}function gr({spaceStore:e}){const t=(0,v().tz)(),{setPage:n}=(0,i.useContext)(Wa().K),{requestsSize:s,requestedUserStores:o,totalRequestedUsersSize:r}=function({spaceStore:e,userStoreLimit:t}){const{requests:n,isLoading:i}=(0,rr().I)({spaceId:e.id});return(0,l().K8)((()=>{let s=0;if(!n)return{requestsSize:s,requestedUserStores:[],totalRequestedUsersSize:0,isLoading:i};const o=new Set;for(const e of Object.values(n)){for(const t of e)o.add(t.created_by_id);s+=e.length}return{requestsSize:s,requestedUserStores:Array.from(o).slice(0,t).map((t=>J().L.createChildStore(e,{table:R().oo,id:t}))),totalRequestedUsersSize:o.size,isLoading:i}}),[e,n,i,t])}({spaceStore:e,userStoreLimit:cr}),d=(0,a().v3)();return(0,le.jsx)(Za().A,{headerText:t.formatMessage(br.upgradesTitle),mainText:(0,le.jsx)(v().sA,{id:"requestsHomePage.upgradeRequests.pending",defaultMessage:"{requestsSize} pending",values:{requestsSize:s}}),bottom:(0,le.jsx)(vr,{avatarProps:{users:o,totalMemberCount:r},requestsLength:s,pendingText:br.noPendingRequests}),onClick:()=>{n("upgrades"),(0,Go().u)({environment:d,event:{eventName:"request_tab_upgrades_clicked",eventProperties:{number_of_requests:s}}})}})}function mr({spaceStore:e}){const t=(0,v().tz)(),n=ir({spaceStore:e,requestType:"member_or_guest"}),i=new Set;for(const o of n)for(const{actor:e}of o.createdByActorsWithReason)i.add(e.id);const s=[...i].slice(0,cr).map((t=>J().L.createChildStore(e,{table:R().oo,id:t})));return(0,le.jsx)(Za().A,{headerText:t.formatMessage(br.peoplesTitle),mainText:(0,le.jsx)(v().sA,{id:"requestsHomePage.peopleRequests.pending",defaultMessage:"{requestsSize} pending",values:{requestsSize:n.length}}),bottom:(0,le.jsx)(vr,{avatarProps:n.length?{users:s,totalMemberCount:i.size}:void 0,requestsLength:n.length,pendingText:br.noGuestOrMemberRequests}),onClick:()=>{x().Ow({currentTab:"members",subtab:"requests"})}})}function fr({securitySettingsStore:e,spaceStore:t}){const n=(0,a().v3)(),i=(0,l().K8)((()=>e.state.disableMemberUpgradeRequests),[e]),s=(0,xi()._)({spaceId:t.id,name:"disable_member_upgrade_requests",userId:n.currentUser.id}),o=null==s?void 0:s.upsell;return(0,le.jsx)(Xa().y,{title:(0,le.jsx)(yr,{upsell:o,spaceStore:t}),byline:(0,le.jsx)(hr,{upsell:o,spaceStore:t}),item:(0,le.jsx)(Ya().A,{disabled:(0,Ro().wy)(null==s?void 0:s.upsell),on:!i,onClick:()=>{ln().X(n,{spaceStore:t,securitySettingsStore:e,fields:{disableMemberUpgradeRequests:!i}})}})})}function hr({upsell:e,spaceStore:t}){const n=(0,v().tz)();return(0,Ro().wy)(e)?(0,le.jsx)("div",{style:{marginInlineStart:-4},children:(0,le.jsx)(lr().UpgradeButton,{display:"text",upsell:e,source:"upgrade_requests_page",size:"small",customMessages:Sr,spaceStore:t})}):(0,le.jsx)(le.Fragment,{children:n.formatMessage(br.purchaseRequestsMemberSettingsByline)})}function yr({upsell:e,spaceStore:t}){const n=(0,v().tz)();return(0,le.jsx)(xt().Y1,{direction:"horizontal",gap:4,children:n.formatMessage(br.purchaseRequestsMemberSettingsTitle)})}function vr({avatarProps:e,requestsLength:t,pendingText:n}){const i=(0,v().tz)();return(0,le.jsxs)(Ha().wt,{justifyContent:"end",style:{minHeight:24},children:[e?(0,le.jsx)(Ja().t,{users:e.users,totalMemberCount:e.totalMemberCount,isLoading:!1}):void 0,t?void 0:(0,le.jsx)(We().D,{styleKey:"captionRegular",colorVariant:"tertiary",children:i.formatMessage(n)})]})}const br=(0,v().YK)({title:{id:"RequestsSettingsPage.title",defaultMessage:"Requests"},upgradesTitle:{id:"RequestsSettingsPage.UpgradesTileTitle",defaultMessage:"Upgrades"},peoplesTitle:{id:"RequestsSettingsPage.PeopleTileTitle",defaultMessage:"People"},permissionsTitle:{id:"RequestsSettingsPage.permissionsTitle",defaultMessage:"Permissions"},membersAndGuestsSettingTitle:{id:"RequestsSettingsPage.membersAndGuestsSettingTitle",defaultMessage:"Inviting guests and members"},memberAndGuestsSettingByline:{id:"RequestsSettingsPage.memberAndGuestsSettingByline",defaultMessage:"Configure who can send and approve member additions"},purchaseRequestsMemberSettingsTitle:{id:"RequestsSettingsPage.purchaseRequestsMemberSettingsTitle",defaultMessage:"Allow members to request upgrades"},purchaseRequestsMemberSettingsByline:{id:"RequestsSettingsPage.purchaseRequestsMemberSettingsByline",defaultMessage:"Users in your workspace can send purchase requests to the workspace owner"},noPendingRequests:{id:"RequestsSettingsPage.upgradeRequests.noPendingRequests",defaultMessage:"No upgrade requests"},noGuestOrMemberRequests:{id:"RequestsSettingsPage.peopleRequests.noGuestOrMemberRequests",defaultMessage:"No guest or member requests"}}),Sr=(0,v().YK)({eligible_to_purchase:{id:"RequestHomePage.upsellMessages.eligibleToPurchase",defaultMessage:"<highlight>Upgrade</highlight> to control whether users can send purchase requests to the workspace owner"},eligible_for_trial:{id:"RequestHomePage.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to control member upgrade requests"},sales_eligible:{id:"RequestHomePage.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to control member upgrade requests"},sales_assisted:{id:"RequestHomePage.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to control member upgrade requests"},eligible_to_request:{id:"RequestHomePage.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to control member upgrade requests"},request_pending:{id:"RequestHomePage.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to control member upgrade requests"}});function xr({spaceStore:e}){const t=(0,v().tz)(),{setPage:n}=(0,i.useContext)(Wa().K);return(0,le.jsxs)(xt().Y1,{height:"fill",direction:"vertical",gap:16,padding:"36px 60px",children:[(0,le.jsx)(dr().n,{title:t.formatMessage(Ar.title),goBack:()=>n("home")}),(0,le.jsx)(Mr,{spaceStore:e})]})}function Mr({spaceStore:e}){const t=(0,l().uB)(void 0,Cn().A);(0,r().w)((()=>{const n=t.getValueForSpace(e);n&&t.setState(n)}));const{organizationOverrides:n}=(0,Aa().n)({spaceId:e.id});return(0,le.jsx)(sa,{securitySettingsStore:t,spaceStore:e,organizationOverrides:n})}const Ar=(0,v().YK)({title:{id:"RequestsSettingPage.PeopleInvitationSettings.title",defaultMessage:"Inviting guests and members"}});var jr=()=>n(210198);function wr({spaceStore:e,securitySettingsStore:t}){const n=(0,l().K8)((()=>"requests"===Qe().Ay.state.currentTab&&Qe().Ay.state.defaultSubtab||"home"),[]),[s,o]=(0,i.useState)(n),a=(0,Ga().t)();return(0,le.jsx)(Wa().K.Provider,{value:{currentPage:s,setPage:o,isSalesEligible:a},children:(0,le.jsx)(Ir,{securitySettingsStore:t,spaceStore:e})})}function Ir({spaceStore:e,securitySettingsStore:t}){const{currentPage:n}=(0,i.useContext)(Wa().K);switch(n){case"home":return(0,le.jsx)(ur,{securitySettingsStore:t,spaceStore:e});case"people_invitation_settings":return(0,le.jsx)(xr,{spaceStore:e});case"upgrades":return(0,le.jsx)(jr().Z,{spaceStore:e});default:return null}}var kr=()=>n(973992),Tr=()=>n(329862);const Cr={VerifiedPagesSettings:new(Fe().O2)("VerifiedPagesSettings",(()=>Promise.all([n.e(40507),n.e(16006)]).then(n.bind(n,541616))))},_r=(0,Fe()._h)(Cr.VerifiedPagesSettings,(e=>e.VerifiedPagesSettings));var Pr=()=>n(194977),Br=()=>n(404302),Rr=()=>n(193620);var Dr=()=>n(726295),Lr=()=>n(483838),Er=()=>n(388521),Or=()=>n(85582),Nr=()=>n(450338),Fr=()=>n(258079);function Ur({spaceStore:e,filters:t,runNewSearch:n,setFilters:s,hasUserConfirmedAcknowledgement:o}){const r=function(e){const[t,n]=(0,i.useState)([]),s=(0,a().v3)(),o=(0,l().K8)((()=>(null==e?void 0:e.spaceStore)??(0,ot().S)()),[null==e?void 0:e.spaceStore]),r=(0,A().T)();return(0,i.useEffect)((()=>{!async function(){const e=await(0,Lo().S)({spaceStore:o,currentUserId:r,includeArchived:!1,minRoleOnTeamStores:"editor",environment:s});n(e)}()}),[o,r,s]),t}(),c=(0,d().IS)((()=>({container:{margin:"0 auto 14px"},filterPillsContainer:{width:"100%",display:"flex",flexWrap:"wrap",rowGap:4}})),[]);return(0,le.jsxs)("div",{style:c.container,children:[(0,le.jsx)(Rr().nv,{mode:Rr().Ke.Button,query:t.query,setQueryFilter:function(e){s({query:e},{runSearchAfter:!0})},disabled:!o}),o?(0,le.jsxs)("div",{style:c.filterPillsContainer,children:[(0,le.jsx)(Or().MC,{spaceStore:e,selectedPageStatus:t.pageStatus,setSelectedPageStatus:function(e){s({pageStatus:e})},onMenuClose:n}),(0,le.jsx)(Er().Z,{lastEditedTime:t.lastEditedTime,createdTime:t.createdTime,setLastEditedTime:function(e){s({lastEditedTime:e,createdTime:{starting:void 0,ending:void 0}},{runSearchAfter:!0})},setCreatedOnTime:function(e){s({createdTime:e,lastEditedTime:{starting:void 0,ending:void 0}},{runSearchAfter:!0})}}),(0,le.jsx)(Fr().j,{selectedTeamIds:t.teamIds,setSelectedTeamIds:function(e){s({teamIds:e})},onMenuClose:n,teamStores:r}),(0,le.jsx)(Nr().I,{spaceStore:e,sharedWithFilterItems:t.sharedWith,setSharedWithFilter:function(e){s({sharedWith:e})},runNewSearch:n,includeGroups:!0,includeGuests:!0,includeAgents:!0}),(0,le.jsx)(Dr().tE,{selectedAudience:t.audience,setSelectedAudience:function(e){s({audience:e})},onMenuClose:n,audienceValues:Br().p}),(0,le.jsx)(Lr().Q,{spaceStore:e,createdByFilterIds:t.createdBy,setCreatedByFilter:function(e){s({createdBy:e})},runNewSearch:n,includeGuests:!0})]}):null]})}var zr=()=>n(274570),Kr=()=>n(860814),Vr=()=>n(122078);const qr=(0,v().YK)({lastActivity:{id:"agentsFiltersSection.lastActivity",defaultMessage:"Last activity"},statusDisabled:{id:"agentsFiltersSection.status.disabled",defaultMessage:"Disabled"},statusActive:{id:"agentsFiltersSection.status.active",defaultMessage:"Active"},statusDeleted:{id:"agentsFiltersSection.status.deleted",defaultMessage:"Deleted"},statusPillTitle:{id:"agentsFiltersSection.status.pillTitle",defaultMessage:"Status"}});function Wr(e,t){switch(e){case"active":return t.formatMessage(qr.statusActive);case"disabled":return t.formatMessage(qr.statusDisabled);case"deleted":return t.formatMessage(qr.statusDeleted);default:(0,rt().HB)(e)}}function Gr(e){const{query:t,setQuery:n,queryPlaceholder:s,spaceStore:o,createdByIds:a,setCreatedByIds:r,createdTime:l,setCreatedOnTime:d,lastEditedTime:c,setLastEditedTime:u,sharedWith:p,setSharedWith:g,lastActivityTime:m,setLastActivityTime:f,status:h=[],setStatus:y,integrationTypes:b=[],setIntegrationTypes:S,mcpServerNames:x=[],setMcpServerNames:M,distinctMcpServers:A=[]}=e,j=(0,v().tz)(),w=(0,i.useMemo)((()=>new Set(["active","disabled","deleted"])),[]);return(0,le.jsxs)(qe().VP,{gap:8,children:[(0,le.jsx)(Rr().nv,{mode:Rr().Ke.Button,query:t,setQueryFilter:n,placeholderText:s}),(0,le.jsxs)(qe().fI,{gap:4,alignItems:"center",wrap:"wrap",children:[(0,le.jsx)(Nr().I,{spaceStore:o,sharedWithFilterItems:p,setSharedWithFilter:e=>g(e),runNewSearch:()=>{},includeGroups:!0,includeGuests:!0,includeAgents:!1}),(0,le.jsx)(Lr().Q,{spaceStore:o,createdByFilterIds:a,setCreatedByFilter:r,includeGuests:!0}),(0,le.jsx)(Er().Z,{lastEditedTime:c,createdTime:l,setLastEditedTime:u,setCreatedOnTime:d}),(0,le.jsx)(Y().A,{mode:Q().C.Pill,focused:!1,hideTime:!0,pillTitle:j.formatMessage(qr.lastActivity),title:j.formatMessage(qr.lastActivity),icon:zr().clockIcon,value:m,showButtons:"footer",onChange:e=>{f(e)}}),(0,le.jsx)(Kr().A,{allOptions:w,selectedOptions:h,setSelectedOption:y,getFormattedStringTitle:e=>Wr(e,j),getFormattedStringCaption:()=>"",getPillTitle:e=>{if(0===e.length)return j.formatMessage(qr.statusPillTitle);const t=e.map((e=>Wr(e,j)));return j.formatList(t,{type:"unit"})},pillIcon:zr().clockIcon}),(0,le.jsx)(Vr().I,{integrationTypes:b,setIntegrationTypes:S,mcpServerNames:x,setMcpServerNames:M,distinctMcpServers:A})]})]})}function Hr({spaceStore:e,filters:t,numRecordStores:n,hasUserConfirmedAcknowledgement:i,isCustomAgentsEnabled:s}){const o=(0,l().K8)((()=>e.getName()),[e]);return(0,le.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:24},children:[(0,le.jsx)(we().A,{isMultiline:!0,style:{marginBottom:20},isSecondaryColor:!0,children:(0,le.jsx)(v().sA,{...s?$r.descriptionDataRetentionPolicyAgents:$r.descriptionDataRetentionPolicy,values:{workspaceName:o,b:e=>(0,le.jsx)("b",{children:e}),link:e=>(0,le.jsx)(ui().V,{onClick:()=>Qe().Ay.setState({openedFrom:"content_search",open:!0,currentTab:"security",highlightedSetting:void 0,defaultSubtab:"data_retention"}),children:e})}})}),(0,le.jsx)(Pr().t,{spaceId:e.id,disabled:0===n||!i,filters:t})]})}const Yr=function({spaceStore:e,userStore:t}){const[s,a]=(0,i.useState)("pages"),[r,d]=(0,i.useState)(""),c=(0,ae().ke)(),u=(0,o().X)("admin_agents_content_search_tab"),p=(0,o().X)("notion_ai_settings_tab_v2"),g=c&&u&&!p,m=(0,v().tz)().formatMessage($r.agentsSearchPlaceholder);(0,i.useEffect)((()=>{g||"agents"!==s||a("pages")}),[g,s]);const f=(0,l().K8)((()=>{const e=Ve().default.state.sidebarSpaceViewStore,t=null==e?void 0:e.getSettings();return(null==t?void 0:t.admin_content_search_acknowledgement)??!1}),[]),{showSuggestions:h,loadNextPage:y,recordStores:b,loading:S,error:x,runNewSearch:M,filters:A,setFilters:j,refreshSearchResult:w}=(0,n(184546).p)({spaceStore:e,userStore:t,hasUserConfirmedAcknowledgement:f}),I=(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(Ur,{spaceStore:e,runNewSearch:M,setFilters:j,filters:A,hasUserConfirmedAcknowledgement:f}),(0,le.jsx)(n(326480).r,{loading:S,error:x,recordStores:b,loadNextPage:y,filters:A,setFilters:j,showSuggestions:h,runNewSearch:M,hasUserConfirmedAcknowledgement:f,refreshSearchResult:w})]}),[k,T]=(0,i.useState)([]),[C,_]=(0,i.useState)({starting:void 0,ending:void 0}),[P,B]=(0,i.useState)({starting:void 0,ending:void 0}),[R,D]=(0,i.useState)(),[L,E]=(0,i.useState)({starting:void 0,ending:void 0}),[O,N]=(0,i.useState)(["active","disabled"]),[F,U]=(0,i.useState)([]),[z,K]=(0,i.useState)([]),[V,q]=(0,i.useState)([]),W=(0,i.useCallback)((e=>{q(e)}),[]),G=(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(Gr,{query:r,setQuery:d,queryPlaceholder:m,spaceStore:e,createdByIds:k,setCreatedByIds:T,createdTime:C,setCreatedOnTime:_,lastEditedTime:P,setLastEditedTime:B,sharedWith:R,setSharedWith:D,lastActivityTime:L,setLastActivityTime:E,status:O,setStatus:N,integrationTypes:F,setIntegrationTypes:U,mcpServerNames:z,setMcpServerNames:K,distinctMcpServers:V}),(0,le.jsx)(n(786416).l,{spaceStore:e,searchQuery:r,createdByIds:k,createdTime:C,lastEditedTime:P,sharedWith:R,lastActivityTime:L,status:O,integrationTypes:F,mcpServerNames:z,onDistinctMcpServersChange:W})]}),H=g?[(0,le.jsx)(v().sA,{id:"adminContentSearchTab.subtab.pages",defaultMessage:"Pages"},"pages"),(0,le.jsx)(v().sA,{id:"adminContentSearchTab.subtab.agents",defaultMessage:"Agents"},"agents")]:[(0,le.jsx)(v().sA,{id:"adminContentSearchTab.subtab.pages",defaultMessage:"Pages"},"pages")],Y="pages"===s?0:1;return(0,le.jsxs)(Xe().Ay,{children:[(0,le.jsx)(ve().A,{large:!xe().A.isMobile||void 0,divider:xe().A.isMobile?void 0:"full",children:(0,le.jsx)(v().sA,{id:"adminContentSearchTab.title",defaultMessage:"Content search"})}),(0,le.jsx)(Hr,{spaceStore:e,numRecordStores:b.length,filters:A,hasUserConfirmedAcknowledgement:f,isCustomAgentsEnabled:g}),g?(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)("div",{style:{marginTop:8,marginBottom:14},children:(0,le.jsx)(Hs().LZ,{tabs:H,selectedIndex:Y,onChange:e=>a(0===e?"pages":"agents")})}),"pages"===s?I:G]}):I]})},$r=(0,v().YK)({descriptionDataRetentionPolicy:{id:"adminContentSearchTab.description.dataRetentionPolicy",defaultMessage:"Workspace owners can search for any page in <b>{workspaceName}</b>. This includes private pages and deleted pages retained per the <link>data retention policy</link>"},descriptionDataRetentionPolicyAgents:{id:"adminContentSearchTab.description.dataRetentionPolicy.agents",defaultMessage:"Workspace owners can search for any page or agent in <b>{workspaceName}</b>. This includes private pages and agents, and deleted pages retained per the <link>data retention policy</link>"},agentsSearchPlaceholder:{id:"adminContentSearchTab.agentsTable.filters.query.placeholder",defaultMessage:"Search by agent name"}});const Qr=function(e){const t=(0,d().IS)((()=>({style:{display:"flex",height:"100%",flexDirection:e.isReversed?"row-reverse":"row"},sidebarStyle:{height:"100%",background:Mt().Tj.background.secondaryTranslucent,flexGrow:0,flexShrink:0,width:240,overflowY:"auto"},childrenStyle:{flexGrow:1,position:"relative",zIndex:1,height:"100%",overflow:"hidden"}})),[e.isReversed]);return(0,le.jsxs)("div",{style:t.style,onMouseDown:e.onMouseDown,onClick:e.onClick,onDoubleClick:e.onDoubleClick,onContextMenu:e.onContextMenu,tabIndex:-1,role:"presentation",children:[(0,le.jsx)("div",{style:t.sidebarStyle,children:e.sidebar}),(0,le.jsx)("div",{style:t.childrenStyle,role:e.contentRole,"aria-labelledby":e.contentLabelledBy,id:e.contentId,children:e.children})]})};class Zr extends O().Store{getInitialState(){return{emailDomains:[],spaceCreation:"admins_only",settings:{}}}async updateValueForSpace(e){const{environment:t,spaceId:n,store:i}=e,s=await D().callApi({eventName:"getEmailDomainsForSpace",environment:t,data:{spaceId:n}});if("failed"===s.type)return void T().Qg(s);const{data:o}=s,a=Object.keys(o);return 0!==a.length?i.setState({emailDomains:a,spaceCreation:o[a[0]].spaceCreationEnum,settings:o[a[0]].settings}):i.setState(this.getInitialState()),i.state}}const Xr=Zr;var Jr=()=>n(615623);async function el(e){var t;const{environment:n,spaceId:i,store:s}=e;if(!(await(0,Jr().S)(n,{name:"saml",spaceId:i,userId:null===(t=Ve().default.state.currentUserStore)||void 0===t?void 0:t.id})))return s.reset(),{};const o=await D().callApi({eventName:"getSamlConfigForSpace",environment:n,data:{spaceId:i}});if("failed"===o.type)T().Qg(o);else if(o.data&&o.data.samlConfig){const e={...o.data.samlConfig,useMetadataUrl:!Boolean(o.data.samlConfig.idpMetadata)};return s.setState(e),o.data}return s.reset(),{}}const tl=(0,i.createContext)(null);function nl({spaceStore:e,samlConfigStore:t,domainSettingsStore:n,children:i}){const{loading:s,error:o,loaded:r}=function({spaceStore:e,samlConfigStore:t,domainSettingsStore:n}){const i=(0,a().v3)(),[{status:s,error:o}]=(0,Ge().Yb)((async()=>{const s=await el({environment:i,spaceId:e.id,store:t});return(0,_().USz)(s)?s:s.samlConfig?{samlResponse:s,domainResponse:await n.updateValueForSpace({environment:i,spaceId:e.id,store:n})}:{samlResponse:s,domainResponse:void 0}}),[i,t,e,n]);return{loading:"pending"===s,loaded:"resolved"===s,error:o}}({spaceStore:e,samlConfigStore:t,domainSettingsStore:n}),l={loadingSaml:s,errorSaml:o,loadedSaml:r};return(0,le.jsx)(tl.Provider,{value:l,children:i})}var il=()=>n(471095),sl=()=>n(179030),ol=()=>n(335260);var al=()=>n(104115);function rl({title:e,upsell:t,customMessages:n,spaceStore:i}){return(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(ve().A,{style:{fontWeight:ye().Wy.regular,display:"flex",alignItems:"center",marginBottom:0},children:e}),(0,le.jsx)("div",{style:{marginInlineStart:-4},children:(0,le.jsx)(lr().UpgradeButton,{source:"space_saml",upsell:t,display:"text",width:"hug",size:"small",customMessages:n,spaceStore:i})})]})}const ll=(0,v().YK)({eligible_to_purchase:{id:"identityAndProvisioning.claimWorkspaces.upsellMessages.eligibleToPurchase",defaultMessage:"<highlight>Upgrade</highlight> to claim workspaces with verified domains or set external domain requirements"},eligible_for_trial:{id:"identityAndProvisioning.claimWorkspaces.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to claim workspaces with verified domains or set external domain requirements"},sales_eligible:{id:"identityAndProvisioning.claimWorkspaces.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to claim workspaces with verified domains or set external domain requirements"},sales_assisted:{id:"identityAndProvisioning.claimWorkspaces.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to claim workspaces with verified domains or set external domain requirements"},eligible_to_request:{id:"identityAndProvisioning.claimWorkspaces.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to claim workspaces with verified domains or set external domain requirements"},not_eligible:{id:"identityAndProvisioning.claimWorkspaces.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to claim workspaces with verified domains or set external domain requirements"},request_pending:{id:"identityAndProvisioning.claimWorkspaces.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to claim workspaces with verified domains or set external domain requirements"}}),dl=(0,v().YK)({eligible_to_purchase:{id:"identityAndProvisioning.emailDomains.upsellMessages.eligibleToPurchase",defaultMessage:"<highlight>Upgrade</highlight> to verify email domain ownership for SSO and security features"},eligible_for_trial:{id:"identityAndProvisioning.emailDomains.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to verify email domain ownership for SSO and security features"},sales_eligible:{id:"identityAndProvisioning.emailDomains.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to verify email domain ownership for SSO and security features"},sales_assisted:{id:"identityAndProvisioning.emailDomains.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to verify email domain ownership for SSO and security features"},eligible_to_request:{id:"identityAndProvisioning.emailDomains.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to verify email domain ownership for SSO and security features"},not_eligible:{id:"identityAndProvisioning.emailDomains.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to verify email domain ownership for SSO and security features"},request_pending:{id:"identityAndProvisioning.emailDomains.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to verify email domain ownership for SSO and security features"}}),cl=(0,v().YK)({eligible_to_purchase:{id:"identityAndProvisioning.workspaceCreation.upsellMessages.eligibleToPurchase",defaultMessage:"<highlight>Upgrade</highlight> to customize who can create new workspaces"},eligible_for_trial:{id:"identityAndProvisioning.workspaceCreation.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to customize who can create new workspaces"},sales_eligible:{id:"identityAndProvisioning.workspaceCreation.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to customize who can create new workspaces"},sales_assisted:{id:"identityAndProvisioning.workspaceCreation.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to customize who can create new workspaces"},eligible_to_request:{id:"identityAndProvisioning.workspaceCreation.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to customize who can create new workspaces"},not_eligible:{id:"identityAndProvisioning.workspaceCreation.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to customize who can create new workspaces"},request_pending:{id:"identityAndProvisioning.workspaceCreation.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to customize who can create new workspaces"}}),ul=(0,v().YK)({eligible_to_purchase:{id:"identityAndProvisioning.customSessionDuration.upsellMessages.eligibleToPurchase",defaultMessage:"<highlight>Upgrade</highlight> to set managed user session duration before requiring re-authentication"},eligible_for_trial:{id:"identityAndProvisioning.customSessionDuration.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to set managed user session duration before requiring re-authentication"},sales_eligible:{id:"identityAndProvisioning.customSessionDuration.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to set managed user session duration before requiring re-authentication"},sales_assisted:{id:"identityAndProvisioning.customSessionDuration.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to set managed user session duration before requiring re-authentication"},eligible_to_request:{id:"identityAndProvisioning.customSessionDuration.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to set managed user session duration before requiring re-authentication"},not_eligible:{id:"identityAndProvisioning.customSessionDuration.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to set managed user session duration before requiring re-authentication"},request_pending:{id:"identityAndProvisioning.customSessionDuration.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to set managed user session duration before requiring re-authentication"}}),pl=(0,v().YK)({eligible_to_purchase:{id:"identityAndProvisioning.enableNotionMail.upsellMessages.eligibleToPurchase",defaultMessage:"<highlight>Upgrade</highlight> to enable Notion Mail for company domain members"},eligible_for_trial:{id:"identityAndProvisioning.enableNotionMail.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to enable Notion Mail for company domain members"},sales_eligible:{id:"identityAndProvisioning.enableNotionMail.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to enable Notion Mail for company domain members"},sales_assisted:{id:"identityAndProvisioning.enableNotionMail.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to enable Notion Mail for company domain members"},eligible_to_request:{id:"identityAndProvisioning.enableNotionMail.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to enable Notion Mail for company domain members"},not_eligible:{id:"identityAndProvisioning.enableNotionMail.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to enable Notion Mail for company domain members"},request_pending:{id:"identityAndProvisioning.enableNotionMail.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to enable Notion Mail for company domain members"}}),gl=(0,v().YK)({eligible_to_purchase:{id:"identityAndProvisioning.forcePasswordReset.upsellMessages.eligibleToPurchase",defaultMessage:"<highlight>Upgrade</highlight> to force password reset for all managed users on next login"},eligible_for_trial:{id:"identityAndProvisioning.forcePasswordReset.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to force password reset for all managed users on next login"},sales_eligible:{id:"identityAndProvisioning.forcePasswordReset.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to force password reset for all managed users on next login"},sales_assisted:{id:"identityAndProvisioning.forcePasswordReset.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to force password reset for all managed users on next login"},eligible_to_request:{id:"identityAndProvisioning.forcePasswordReset.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to force password reset for all managed users on next login"},not_eligible:{id:"identityAndProvisioning.forcePasswordReset.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to force password reset for all managed users on next login"},request_pending:{id:"identityAndProvisioning.forcePasswordReset.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to force password reset for all managed users on next login"}}),ml=(0,v().YK)({eligible_to_purchase:{id:"identityAndProvisioning.logoutUsers.upsellMessages.eligibleToPurchase",defaultMessage:"<highlight>Upgrade</highlight> to force log out managed users and require re-authentication"},eligible_for_trial:{id:"identityAndProvisioning.logoutUsers.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to force log out managed users and require re-authentication"},sales_eligible:{id:"identityAndProvisioning.logoutUsers.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to force log out managed users and require re-authentication"},sales_assisted:{id:"identityAndProvisioning.logoutUsers.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to force log out managed users and require re-authentication"},eligible_to_request:{id:"identityAndProvisioning.logoutUsers.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to force log out managed users and require re-authentication"},not_eligible:{id:"identityAndProvisioning.logoutUsers.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to force log out managed users and require re-authentication"},request_pending:{id:"identityAndProvisioning.logoutUsers.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to force log out managed users and require re-authentication"}}),fl=(0,v().YK)({eligible_to_purchase:{id:"identityAndProvisioning.managedUsers.upsellMessages.eligibleToPurchase",defaultMessage:"<highlight>Upgrade</highlight> to manage users with verified domains"},eligible_for_trial:{id:"identityAndProvisioning.managedUsers.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to manage users with verified domains"},sales_eligible:{id:"identityAndProvisioning.managedUsers.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to manage users with verified domains"},sales_assisted:{id:"identityAndProvisioning.managedUsers.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to manage users with verified domains"},eligible_to_request:{id:"identityAndProvisioning.managedUsers.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to manage users with verified domains"},not_eligible:{id:"identityAndProvisioning.managedUsers.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to manage users with verified domains"},request_pending:{id:"identityAndProvisioning.managedUsers.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to manage users with verified domains"}}),hl=(0,v().YK)({eligible_to_purchase:{id:"identityAndProvisioning.preventGrantingSupportAccess.upsellMessages.eligibleToPurchase",defaultMessage:"<highlight>Upgrade</highlight> to control managed users’ support access permissions"},eligible_for_trial:{id:"identityAndProvisioning.preventGrantingSupportAccess.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to control managed users’ support access permissions"},sales_eligible:{id:"identityAndProvisioning.preventGrantingSupportAccess.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to control managed users’ support access permissions"},sales_assisted:{id:"identityAndProvisioning.preventGrantingSupportAccess.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to control managed users’ support access permissions"},eligible_to_request:{id:"identityAndProvisioning.preventGrantingSupportAccess.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to control managed users’ support access permissions"},not_eligible:{id:"identityAndProvisioning.preventGrantingSupportAccess.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to control managed users’ support access permissions"},request_pending:{id:"identityAndProvisioning.preventGrantingSupportAccess.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to control managed users’ support access permissions"}}),yl=(0,v().YK)({eligible_to_purchase:{id:"identityAndProvisioning.preventMembersJoiningExternalSpaces.upsellMessages.eligibleToPurchase",defaultMessage:"<highlight>Upgrade</highlight> to control external workspace access for managed users"},eligible_for_trial:{id:"identityAndProvisioning.preventMembersJoiningExternalSpaces.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to control external workspace access for managed users"},sales_eligible:{id:"identityAndProvisioning.preventMembersJoiningExternalSpaces.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to control external workspace access for managed users"},sales_assisted:{id:"identityAndProvisioning.preventMembersJoiningExternalSpaces.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to control external workspace access for managed users"},eligible_to_request:{id:"identityAndProvisioning.preventMembersJoiningExternalSpaces.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to control external workspace access for managed users"},not_eligible:{id:"identityAndProvisioning.preventMembersJoiningExternalSpaces.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to control external workspace access for managed users"},request_pending:{id:"identityAndProvisioning.preventMembersJoiningExternalSpaces.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to control external workspace access for managed users"}}),vl=(0,v().YK)({eligible_to_purchase:{id:"identityAndProvisioning.preventProfileEdits.upsellMessages.eligibleToPurchase",defaultMessage:"<highlight>Upgrade</highlight> to control managed user profile editing permissions"},eligible_for_trial:{id:"identityAndProvisioning.preventProfileEdits.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to control managed user profile editing permissions"},sales_eligible:{id:"identityAndProvisioning.preventProfileEdits.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to control managed user profile editing permissions"},sales_assisted:{id:"identityAndProvisioning.preventProfileEdits.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to control managed user profile editing permissions"},eligible_to_request:{id:"identityAndProvisioning.preventProfileEdits.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to control managed user profile editing permissions"},not_eligible:{id:"identityAndProvisioning.preventProfileEdits.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to control managed user profile editing permissions"},request_pending:{id:"identityAndProvisioning.preventProfileEdits.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to control managed user profile editing permissions"}}),bl=(0,v().YK)({eligible_to_purchase:{id:"identityAndProvisioning.samlEnforce.upsellMessages.eligibleToPurchase",defaultMessage:"<highlight>Upgrade</highlight> to customize SAML SSO workspace access. Workspace owners retain password or passkey login options."},eligible_for_trial:{id:"identityAndProvisioning.samlEnforce.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to customize SAML SSO workspace access. Workspace owners retain password or passkey login options."},sales_eligible:{id:"identityAndProvisioning.samlEnforce.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to customize SAML SSO workspace access. Workspace owners retain password or passkey login options."},sales_assisted:{id:"identityAndProvisioning.samlEnforce.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to customize SAML SSO workspace access. Workspace owners retain password or passkey login options."},eligible_to_request:{id:"identityAndProvisioning.samlEnforce.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to customize SAML SSO workspace access. Workspace owners retain password or passkey login options."},not_eligible:{id:"identityAndProvisioning.samlEnforce.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to customize SAML SSO workspace access. Workspace owners retain password or passkey login options."},request_pending:{id:"identityAndProvisioning.samlEnforce.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to customize SAML SSO workspace access. Workspace owners retain password or passkey login options."}}),Sl=(0,v().YK)({eligible_to_purchase:{id:"identityAndProvisioning.saml.upsellMessages.eligibleToPurchase",defaultMessage:"<highlight>Upgrade</highlight> to enable SAML SSO login for users with verified domains"},eligible_for_trial:{id:"identityAndProvisioning.saml.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to enable SAML SSO login for users with verified domains"},sales_eligible:{id:"identityAndProvisioning.saml.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to enable SAML SSO login for users with verified domains"},sales_assisted:{id:"identityAndProvisioning.saml.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to enable SAML SSO login for users with verified domains"},eligible_to_request:{id:"identityAndProvisioning.saml.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to enable SAML SSO login for users with verified domains"},not_eligible:{id:"identityAndProvisioning.saml.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to enable SAML SSO login for users with verified domains"},request_pending:{id:"identityAndProvisioning.saml.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to enable SAML SSO login for users with verified domains"}}),xl=(0,v().YK)({eligible_to_purchase:{id:"identityAndProvisioning.scimTokens.upsellMessages.eligibleToPurchase",defaultMessage:"<highlight>Upgrade</highlight> to generate a token to configure SCIM"},eligible_for_trial:{id:"identityAndProvisioning.scimTokens.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to generate a token to configure SCIM"},sales_eligible:{id:"identityAndProvisioning.scimTokens.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to generate a token to configure SCIM"},sales_assisted:{id:"identityAndProvisioning.scimTokens.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to generate a token to configure SCIM"},eligible_to_request:{id:"identityAndProvisioning.scimTokens.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to generate a token to configure SCIM"},not_eligible:{id:"identityAndProvisioning.scimTokens.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to generate a token to configure SCIM"},request_pending:{id:"identityAndProvisioning.scimTokens.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to generate a token to configure SCIM"}});var Ml=()=>n(789586);function Al({spaceStore:e,samlConfigStore:t,domainSettingsStore:n}){const i=(0,A().T)(),s=(0,l().K8)((()=>e.id),[e]),o=(0,l().K8)((()=>t.state.emailDomains),[t]),a=(0,l().K8)((()=>"disabled"!==t.state.status&&"unconfigured"!==t.state.status),[t]),r=(0,Ml().P)({name:"domain_settings",spaceId:s,userId:i})??!1,d=function(e){const{samlConfigStore:t,spaceId:n}=e,i=(0,A().T)(),s=(0,Ml().P)({name:"saml",spaceId:n,userId:i});return(0,l().K8)((()=>t.state.emailDomains.length>0||s),[t,s])}({samlConfigStore:t,spaceId:s})??!1,c=(0,l().K8)((()=>d&&(!t.state.id||t.state.id===s)),[d,t,s]),u=(0,l().K8)((()=>n.state.emailDomains.length>0&&r),[n,r]);return{verifiedDomains:o,isSamlStatusEnabled:a,isSamlAvailable:d,isSamlEditable:c,isDomainSettingsAvailable:u}}var jl=()=>n(863330),wl=()=>n(612268),Il=()=>n(14892),kl=()=>n(965022);function Tl({spaceStore:e,samlConfigStore:t,disabled:n,renderOverrideAddDomainButton:s}){const o=(0,a().v3)(),r=(0,A().T)(),c=(0,xi()._)({name:"saml",spaceId:e.id,userId:r}),u=null==c?void 0:c.upsell,p=(0,l().uB)(void 0,Il().A),g=(0,d().IS)((()=>({flex:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",margin:"18px 0px"},button:{position:"relative",marginInlineStart:"auto",marginInlineEnd:0,opacity:n?.5:1}})),[n]),m=(0,le.jsx)(v().sA,{id:"identityAndProvisioning.emailDomainsSection.title",defaultMessage:"Verified domains"}),f=(0,le.jsx)(v().sA,{id:"identityAndProvisioning.emailDomainsSection.byline",defaultMessage:"Verify ownership of an email domain to access advanced security features including single sign-on."}),h=[...(0,l().K8)((()=>t.state.emailDomains.map(wl().vv)),[t]),...(0,l().K8)((()=>t.state.domainVerifications.filter((e=>!t.state.emailDomains.includes(e.domain))).sort(((e,t)=>e.createdAt-t.createdAt)).map(wl().W0)),[t])],y=(0,i.useCallback)((async()=>{await el({environment:o,spaceId:e.id,store:t})}),[o,e,t]),b=(0,i.useCallback)((async e=>{switch(e.type){case"verified":{const n=t.state.id;if(!n)throw new Error("Cannot remove verified domain without an existing SAMLConfig");return(0,kl().n)({onRequest:()=>D().callApi({eventName:"setSamlConfig",environment:o,data:{samlConfigId:n,removedEmailDomains:[e.domain]}}),onSuccess:async()=>{await y()}})}case"unverified":case"invalid":return(0,kl().n)({onRequest:()=>D().callApi({eventName:"deleteDomainVerificationCode",environment:o,data:{id:e.id}}),onSuccess:()=>y()})}}),[o,t,y]),S=(0,i.useCallback)((()=>(0,kl().n)({onRequest:()=>D().callApi({eventName:"setSamlConfig",environment:o,data:{samlConfigId:e.id,ownerId:e.id,ownerType:"space"}}),onSuccess:()=>y()})),[o,y,e]),x=(0,i.useCallback)((async()=>{await y()}),[y]);return(0,Ro().wy)(u)?(0,le.jsx)(rl,{spaceStore:e,title:m,upsell:u,customMessages:dl}):(0,le.jsx)(wl().Ay,{disabled:n,domains:h,onRemoveDomain:b,domainVerificationStore:p,verificationType:"saml_config",verificationTargetId:e.id,refreshDomains:x,onClickAddDomain:S,renderOverrideAddDomainButton:e=>s?s():(0,le.jsxs)("div",{style:g.flex,children:[(0,le.jsxs)("div",{children:[(0,le.jsx)(ve().A,{smallMarginBottom:!0,style:{fontWeight:ye().Wy.medium},children:m}),(0,le.jsx)(we().A,{isSmall:!0,isMultiline:!0,style:{marginBottom:4},children:f})]}),(0,le.jsx)("div",{children:(0,le.jsx)(pi().p,{colorPalette:"blue",style:g.button,iconLeading:{icon:jl().plusSmallIcon,size:"xs"},disabled:n,onClick:e,children:(0,le.jsx)(v().sA,{defaultMessage:"Add domain",id:"securitySAMLSettings.emailDomainsSection.addDomain"})})})]})})}function Cl({spaceStore:e,samlConfigStore:t,domainSettingsStore:n,domainSettingsUpsell:i}){const s=(0,v().tz)(),{isSamlEditable:o}=Al({spaceStore:e,samlConfigStore:t,domainSettingsStore:n}),a=(0,d().IS)((()=>({settingContainer:{margin:"18px 0"}})),[]);return(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(Tl,{disabled:!o,spaceStore:e,samlConfigStore:t}),(0,le.jsx)("div",{style:a.settingContainer,children:(0,le.jsx)(rl,{spaceStore:e,title:s.formatMessage(_l.workspaceCreationTitle),upsell:i,customMessages:cl})}),(0,le.jsx)("div",{style:a.settingContainer,children:(0,le.jsx)(rl,{spaceStore:e,title:s.formatMessage(_l.claimWorkspacesTitle),upsell:i,customMessages:ll})})]})}const _l=(0,v().YK)({workspaceCreationTitle:{id:"domainSettings.workspaceCreation.title",defaultMessage:"Workspace creation"},claimWorkspacesTitle:{id:"identityAndProvisioning.claimWorkspaces.title",defaultMessage:"Claim workspaces"}});var Pl=()=>n(564766);function Bl(e){const{samlConfigStore:t,spaceStore:n}=e;(0,d().IS)((()=>({container:{marginBottom:12},code:{fontFamily:"monospace"}})),[]),(0,l().K8)((()=>(0,Pl().J4)({samlConfigStatus:t.state.status,emailDomains:t.state.emailDomains,idp_metadata:t.state.idpMetadata,idp_metadata_url:t.state.idpMetadataUrl})),[t]),(0,l().K8)((()=>n.getSubscriptionTier()),[n]);return null}function Rl({spaceStore:e,managedUsersUpsell:t}){const n=(0,d().IS)((()=>({byline:{fontSize:14,fontWeight:ye().Wy.regular,color:Mt().Tj.text.secondary},helpButton:{marginTop:18,marginBottom:16},settingContainer:{margin:"18px 0"}})),[]),i=(0,v().tz)();return(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)("div",{children:(0,le.jsx)(we().A,{isSmall:!0,isMultiline:!0,style:n.byline,children:(0,le.jsx)(v().sA,{id:"identityAndProvisioning.managedUsers.byline",defaultMessage:"These settings apply to all users with a verified domain, even if they are not a member of this workspace."})})}),(0,le.jsx)(tn().A,{title:(0,le.jsx)(v().sA,{id:"identityAndProvisioning.managedUsers.helpButton",defaultMessage:"Learn about managed users"}),href:(0,ut().x)("guides.managedUsers"),style:n.helpButton,analyticsFrom:"managed_users_section"}),(0,le.jsx)("div",{style:n.settingContainer,children:(0,le.jsx)(rl,{spaceStore:e,title:i.formatMessage(Dl.manageUsersButtonTitle),upsell:t,customMessages:fl})}),(0,le.jsx)("div",{style:n.settingContainer,children:(0,le.jsx)(rl,{spaceStore:e,title:i.formatMessage(Dl.preventProfileEditsTitle),upsell:t,customMessages:vl})}),(0,le.jsx)("div",{style:n.settingContainer,children:(0,le.jsx)(rl,{spaceStore:e,title:i.formatMessage(Dl.preventMembersJoiningExternalSpacesTitle),upsell:t,customMessages:yl})}),(0,le.jsx)("div",{style:n.settingContainer,children:(0,le.jsx)(rl,{spaceStore:e,title:i.formatMessage(Dl.preventGrantingSupportAccessTitle),upsell:t,customMessages:hl})}),(0,le.jsx)("div",{style:n.settingContainer,children:(0,le.jsx)(rl,{spaceStore:e,title:i.formatMessage(Dl.customSessionDurationTitle),upsell:t,customMessages:ul})}),(0,le.jsx)("div",{style:n.settingContainer,children:(0,le.jsx)(rl,{spaceStore:e,title:i.formatMessage(Dl.logoutUsersTitle),upsell:t,customMessages:ml})}),(0,le.jsx)("div",{style:n.settingContainer,children:(0,le.jsx)(rl,{spaceStore:e,title:i.formatMessage(Dl.forcePasswordResetTitle),upsell:t,customMessages:gl})}),(0,le.jsx)("div",{style:n.settingContainer,children:(0,le.jsx)(rl,{spaceStore:e,title:i.formatMessage(Dl.enableNotionMailTitle),upsell:t,customMessages:pl})})]})}const Dl=(0,v().YK)({manageUsersButtonTitle:{id:"identityAndProvisioning.managedUsers.title",defaultMessage:"Managed users dashboard"},preventProfileEditsTitle:{id:"identityAndProvisioning.managedUsers.preventProfileEdits.title",defaultMessage:"Allow managed users to change profile information"},preventMembersJoiningExternalSpacesTitle:{id:"identityAndProvisioning.managedUsers.preventMembersJoiningExternalSpaces.title",defaultMessage:"External workspace access"},preventGrantingSupportAccessTitle:{id:"identityAndProvisioning.managedUsers.preventGrantingSupportAccess.title",defaultMessage:"Prevent managed users from granting support access"},customSessionDurationTitle:{id:"identityAndProvisioning.managedUsers.customSessionDuration.title",defaultMessage:"Session duration"},logoutUsersTitle:{id:"identityAndProvisioning.managedUsers.logoutAllUsers.title",defaultMessage:"Log out all users"},forcePasswordResetTitle:{id:"identityAndProvisioning.managedUsers.forcePasswordReset.title",defaultMessage:"Reset passwords for all users"},enableNotionMailTitle:{id:"identityAndProvisioning.managedUsers.enableNotionMail.title",defaultMessage:"Notion Mail"}});var Ll=()=>n(695115),El=()=>n(721479),Ol=()=>n(752860);function Nl({title:e,byline:t,settingItem:n,style:i}){const s=(0,d().IS)((()=>({settingContainer:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",...i||{}},settingLeft:{width:"60%"},settingTitle:{fontWeight:ye().Wy.regular},settingByline:{marginBottom:4}})),[i]);return(0,le.jsxs)("div",{style:s.settingContainer,children:[(0,le.jsxs)("div",{style:s.settingLeft,children:[(0,le.jsx)(ve().A,{smallMarginBottom:!0,style:s.settingTitle,children:e}),(0,le.jsx)(we().A,{isSmall:!0,isMultiline:!0,style:s.settingByline,children:t})]}),n]})}function Fl({title:e,byline:t,isOn:n,onToggle:i,disabled:s,tooltipForDisabled:o}){function a(){s||i()}return(0,le.jsx)(je().m,{placement:"top",alignment:"end",disableTooltip:!o||!s,renderTooltip:()=>o,render:i=>(0,le.jsx)("div",{...i,children:(0,le.jsx)(Nl,{title:e,byline:t,settingItem:(0,le.jsx)(Ya().A,{on:n,disabled:s,onClick:a})})})})}function Ul({samlConfigStore:e}){const t=(0,a().v3)();return{updateSamlIdpUrl:(0,i.useCallback)((async n=>{const i=e.state.id;if(!i)return!1;let s=!1;return await(0,kl().n)({onRequest:()=>D().callApi({eventName:"setSamlConfig",environment:t,data:{samlConfigId:i,idpMetadataUrl:n}}),onSuccess:()=>{s=!0,e.setState({...e.state,useMetadataUrl:!0,idpMetadataUrl:n,idpMetadata:void 0})}}),s}),[e,t]),updateSamlIdpXml:(0,i.useCallback)((async n=>{const i=e.state.id;if(!i)return!1;let s=!1;return await(0,kl().n)({onRequest:()=>D().callApi({eventName:"setSamlConfig",environment:t,data:{samlConfigId:i,idpMetadata:n}}),onSuccess:()=>{s=!0,e.setState({...e.state,useMetadataUrl:!1,idpMetadataUrl:void 0,idpMetadata:n})}}),s}),[e,t]),updateStatus:(0,i.useCallback)((n=>{const i=e.state.id;return i?(0,kl().n)({onRequest:()=>D().callApi({eventName:"setSamlConfig",environment:t,data:{samlConfigId:i,status:n}}),onSuccess:()=>{e.setState({...e.state,status:n})}}):Promise.resolve()}),[e,t]),updateCreateAccount:(0,i.useCallback)((n=>{const i=e.state.id;return i?(0,kl().n)({onRequest:()=>D().callApi({eventName:"setSamlConfig",environment:t,data:{samlConfigId:i,createAccount:n}}),onSuccess:()=>{e.setState({...e.state,createAccount:n})}}):Promise.resolve()}),[e,t])}}const zl=(0,v().YK)({learnMore:{id:"createAccountSetting.iconButton.ariaLabel",defaultMessage:"Learn more about automatic account creation"}});function Kl({spaceStore:e,samlConfigStore:t,disabled:n}){const{updateCreateAccount:i}=Ul({samlConfigStore:t}),s=(0,a().v3)(),o=(0,v().tz)(),r=(0,d().IS)((()=>({settingContainer:{margin:"18px 0"},settingsTitle:{display:"inline-flex",alignItems:"center"}})),[]),c=(0,l().K8)((()=>t.state.createAccount),[t]);return(0,le.jsx)("div",{style:r.settingContainer,children:(0,le.jsx)(Fl,{title:(0,le.jsxs)("div",{style:r.settingsTitle,children:[(0,le.jsx)(v().sA,{id:"identityAndProvisioning.createAccount.title",defaultMessage:"Automatic account creation"}),(0,le.jsx)(Ll().A,{icon:El().questionMarkCircleSmallIcon,ariaLabel:o.formatMessage(zl.learnMore),onClick:()=>(0,Ol().L)({environment:s,url:(0,ut().x)("guides.samlJIT")})})]}),byline:(0,le.jsx)(v().sA,{id:"identityAndProvisioning.createAccount.byline",defaultMessage:"Automatically create Notion accounts for new users who log in via SAML SSO"}),isOn:c,onToggle:async function(){await i(!t.state.createAccount)},disabled:n})})}function Vl({spaceStore:e,samlConfigStore:t,upsell:n}){const{updateStatus:i}=Ul({samlConfigStore:t}),s=(0,d().IS)((()=>({settingContainer:{margin:"18px 0"}})),[]),o=(0,le.jsx)(v().sA,{id:"identityAndProvisioning.accountAuth.title",defaultMessage:"Login method"}),a=(0,le.jsx)(v().sA,{id:"identityAndProvisioning.accountAuth.byline",defaultMessage:"Customize how users access workspaces that have SAML SSO enabled. Workspace owners can always log in with a password or passkey."}),r=(0,l().K8)((()=>"enforced"===t.state.status?"enforced":"enforced_for_domain"===t.state.status?"enforced_for_domain":"not_enforced"),[t]);if((0,Ro().wy)(n))return(0,le.jsx)("div",{style:s.settingContainer,children:(0,le.jsx)(rl,{spaceStore:e,title:o,upsell:n,customMessages:bl})});const c=[{key:"enforced",label:(0,le.jsx)(v().sA,{id:"identityAndProvisioning.accountAuth.option.enforced",defaultMessage:"Only SAML SSO"})},{key:"not_enforced",label:(0,le.jsx)(v().sA,{id:"identityAndProvisioning.accountAuth.option.notEnforced",defaultMessage:"Any method"})}];return"enforced_for_domain"===r?(0,le.jsx)("div",{style:s.settingContainer,children:(0,le.jsx)(vt().A,{spaceStore:e,disabled:!0,title:o,caption:a,type:"custom",customButton:(0,le.jsx)(pi().p,{disabled:!0,disabledFeedback:!0,children:(0,le.jsx)(v().sA,{id:"identityAndProvisioning.accountAuth.option.enforcedForDomain",defaultMessage:"Enforced for domain"})})})}):(0,le.jsx)("div",{style:s.settingContainer,children:(0,le.jsx)(vt().A,{spaceStore:e,title:o,caption:a,type:"dropdown",currentOption:r,options:c,onSelectOption:async function(e){"enforced"===e?await i("enforced"):"enforced_for_domain"===e?await i("enforced_for_domain"):await i("configured")}})})}var ql=()=>n(458118);function Wl({spaceStore:e,samlConfigStore:t,domainSettingsStore:n,isSamlStatusEnabled:s,upsell:o,disabled:a}){const[r,c]=(0,i.useState)(!1),[u,p]=(0,i.useState)({isOpened:!1,enableSamlOnSave:!1}),[g,m]=(0,i.useState)(!1),{updateStatus:f,updateSamlIdpUrl:h,updateSamlIdpXml:y}=Ul({samlConfigStore:t}),{verifiedDomains:b}=Al({spaceStore:e,samlConfigStore:t,domainSettingsStore:n}),S=(0,l().K8)((()=>({id:e.id,status:t.state.status,idpMetadataUrl:t.state.idpMetadataUrl,idpMetadata:t.state.idpMetadata,createAccount:t.state.createAccount,emailDomains:t.state.emailDomains,identityProvider:{provider:t.state.idpMetadataUrl||t.state.idpMetadata?"other":"no_entity_id"}})),[e.id,t]),x="unconfigured"===S.status,M=(0,d().IS)((()=>({configButton:{marginTop:14}})),[]),A=(0,le.jsx)(v().sA,{id:"identityAndProvisioning.samlToggle.title",defaultMessage:"Enable SAML SSO"}),j=(0,le.jsx)(v().sA,{id:"identityAndProvisioning.samlToggle.byline",defaultMessage:"Workspace members can log in with SAML SSO if their email address uses a verified domain."}),w=x?(0,le.jsx)(v().sA,{id:"identityAndProvisioning.editSamlConfig.enableSaml",defaultMessage:"Enable SAML"}):(0,le.jsx)(v().sA,{id:"identityAndProvisioning.editSamlConfig.saveChanges",defaultMessage:"Save changes"});async function I(e){try{m(!0),await f(e)}finally{m(!1)}}return(0,Ro().wy)(o)?(0,le.jsx)(rl,{spaceStore:e,title:A,upsell:o,customMessages:Sl}):(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(Fl,{title:A,byline:j,isOn:s,disabled:a||g,tooltipForDisabled:0===b.length?(0,le.jsx)(v().sA,{id:"identityAndProvisioning.samlToggle.disabledTooltipNoVerifiedDomains",defaultMessage:"Verify a domain to enable SAML."}):void 0,onToggle:async function(){if(a)return;const{useMetadataUrl:e,idpMetadata:n,idpMetadataUrl:i}=t.state,s=e&&i||!e&&n;switch(t.state.status){case"disabled":s?await I("configured"):p({isOpened:!0,enableSamlOnSave:!0});break;case"unconfigured":p({isOpened:!0,enableSamlOnSave:!0});break;case"configured":case"enforced":await I("disabled");break;case"enforced_for_domain":break;default:(0,rt().HB)(t.state.status)}}}),(0,le.jsx)(_t().A,{disabled:a,disabledFeedback:a,size:"lg",style:M.configButton,onClick:function(){a||p({isOpened:!0,enableSamlOnSave:!1})},children:(0,le.jsx)(v().sA,{id:"identityAndProvisioning.samlToggle.configure",defaultMessage:"Edit SAML SSO configuration"})}),u.isOpened?(0,le.jsx)(ql().N,{saveButtonText:w,onSave:async function(e){const{metadataUrl:n,metadataXml:i}=e;c(!0);let s=!1;if(n?s=await h(n):i&&(s=await y(i)),s){switch(t.state.status){case"disabled":u.enableSamlOnSave&&await f("configured");break;case"unconfigured":await f("configured");break;case"enforced":case"enforced_for_domain":case"configured":break;default:(0,rt().HB)(t.state.status)}p({isOpened:!1,enableSamlOnSave:!1}),c(!1)}else c(!1)},samlConfig:S,loading:r,onDismiss:()=>p({isOpened:!1,enableSamlOnSave:!1}),headerByline:(0,le.jsx)(v().sA,{id:"identityAndProvisioning.editSamlConfig.byline",defaultMessage:"Configure SAML SSO for your Notion workspace with your Identity Provider (IDP). <guidelink>Learn more</guidelink>.",values:{guidelink:e=>(0,le.jsx)(ui().V,{hoverColor:"blue",href:(0,ut().x)("guides.samlSettings"),external:!0,children:e})}})}):null]})}var Gl=()=>n(994877);const Hl={id:"name",headerTitle:(0,le.jsx)(v().sA,{id:"identityAndProvisioning.secondaryWorkspaces.table.name",defaultMessage:"Name"}),renderCell:e=>(0,le.jsx)(Jl,{space:e.space,isCurrentSpace:e.isCurrentSpace}),widthData:{width:50},sortable:!0},Yl={id:"memberCount",headerTitle:(0,le.jsx)(v().sA,{id:"identityAndProvisioning.secondaryWorkspaces.table.memberCount",defaultMessage:"Members"}),renderCell:e=>(0,le.jsx)(we().A,{children:(0,le.jsx)(v().sA,{id:"identityAndProvisioning.secondaryWorkspaces.table.members",defaultMessage:"{count} members",values:{count:e.space.memberCount}})}),widthData:{width:20},sortable:!0},$l={id:"createdAt",headerTitle:(0,le.jsx)(v().sA,{id:"identityAndProvisioning.secondaryWorkspaces.table.plan",defaultMessage:"Created at"}),renderCell:e=>{const t=e.space.createdTime;return(0,le.jsx)(we().A,{children:t?(0,vi().W_)(t,"medium",yi().locale):void 0})},widthData:{width:20},sortable:!0},Ql=[Hl,Yl,$l];function Zl({spaceStore:e,spaces:t}){const[n,s]=(0,i.useState)({column:Hl,sortAscending:!1}),o=(0,l().K8)((()=>t.map((t=>({id:t.id,isClickable:!1,isCurrentSpace:e.id===t.id,space:t})))),[t,e]),a=(0,i.useMemo)((()=>(0,Ae().rC)({columnRenderInfo:Ql,containerMarginTop:12})),[]);return(0,le.jsx)(Ae().WE,{hideHeaderRowPadding:!0,showRowBorders:!0,columnRenderInfo:Ql,rows:Xl(o,n),sortState:n,onSortStateChanged:s,renderNoRowsComponent:()=>(0,le.jsx)(we().A,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"},children:(0,le.jsx)(v().sA,{id:"identityAndProvisioning.secondaryWorkspaces.empty",defaultMessage:"No linked workspaces."})}),styles:a})}function Xl(e,{column:t,sortAscending:n}){let i=[];switch(t.id){case"name":i=un().Ul(e,(e=>e.space.name));break;case"createdAt":i=un().Ul(e,(e=>e.space.createdTime));break;case"memberCount":i=un().Ul(e,(e=>e.space.memberCount))}return n?i:i.reverse()}function Jl(e){const t=(0,d().IS)((()=>({container:{display:"flex",justifyContent:"center",alignItems:"center",gap:4}})),[]);return(0,le.jsxs)(we().A,{style:t.container,children:[e.space.name,e.isCurrentSpace?(0,le.jsx)(bi().A,{children:(0,le.jsx)(v().sA,{id:"identityAndProvisioning.secondaryWorkspaces.table.name.currentBadge",defaultMessage:"Current"})}):null]})}function ed({spaceStore:e,spaces:t}){const n=(0,a().v3)(),s=(0,d().IS)((()=>({settingContainer:{margin:"18px 0"}})),[]),o=(0,i.useCallback)((()=>{Gl().SI({environment:n,from:"saml_settings",prepopulatedContent:`Request to add or remove a workspace for SAML single sign-on on workspace ${e.id}.`})}),[e,n]),r=(0,l().K8)((()=>(0,io().bp)(e.getSubscriptionTier())),[e]);return(0,le.jsxs)("div",{style:s.settingContainer,children:[(0,le.jsx)(Nl,{title:(0,le.jsx)(v().sA,{id:"identityAndProvisioning.secondaryWorkspaces.title",defaultMessage:"Linked workspaces"}),byline:(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(v().sA,{id:"identityAndProvisioning.secondaryWorkspaces.description",defaultMessage:"This SAML SSO configuration applies to the following other workspaces"}),r?(0,le.jsxs)(le.Fragment,{children:[" ",(0,le.jsx)(v().sA,{id:"identityAndProvisioning.secondaryWorkspaces.contact",defaultMessage:"<contactlink>Contact support</contactlink> to add or remove a workspace.",values:{contactlink:e=>(0,le.jsx)(ui().V,{onClick:o,children:e})}})]}):void 0]}),settingItem:null}),(0,le.jsx)(Zl,{spaceStore:e,spaces:t})]})}function td({spaceStore:e,samlConfigStore:t,domainSettingsStore:n}){const{verifiedDomains:i,isSamlEditable:s,isSamlStatusEnabled:o}=Al({spaceStore:e,samlConfigStore:t,domainSettingsStore:n}),a=(0,A().T)(),r=(0,xi()._)({name:"saml",spaceId:e.id,userId:a}),d=null==r?void 0:r.upsell,c=(0,Ro().wy)(d)||!s||!o,u=(0,l().K8)((()=>t.state.spaces),[t]);return(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(tn().A,{title:(0,le.jsx)(v().sA,{id:"identityAndProvisioning.samlToggle.learnMore",defaultMessage:"Learn about SAML SSO"}),href:(0,ut().x)("guides.samlSettings"),style:{marginTop:18,marginBottom:16},analyticsFrom:"saml_settings"}),(0,le.jsx)(Wl,{disabled:!s||0===i.length,upsell:d,isSamlStatusEnabled:o,spaceStore:e,samlConfigStore:t,domainSettingsStore:n}),(0,le.jsx)(Vl,{upsell:d,spaceStore:e,samlConfigStore:t}),(0,le.jsx)(Kl,{disabled:c,spaceStore:e,samlConfigStore:t}),(0,le.jsx)(ed,{spaceStore:e,spaces:u})]})}var nd=()=>n(8741);function id({spaceStore:e,samlConfigStore:t,domainSettingsStore:n,organizationOnboardingInfo:s}){const o=(0,a().v3)(),r=(0,d().IS)((()=>({button:{margin:"4px 0px 16px",width:"fit-content",display:"flex",alignItems:"center",justifyContent:"center",gap:4}})),[]),{buttonLabel:c,onClick:u}=(0,al().gO)({environment:o,organizationOnboardingInfo:s}),p=(0,i.useCallback)((()=>(0,le.jsxs)(pi().p,{colorPalette:"blue",onClick:u,style:r.button,children:[c,(0,le.jsx)(f().I,{icon:nd().arrowDiagonalUpRightSmallIcon,size:"sm"})]})),[c,u,r.button]),g=(0,i.useCallback)((()=>(0,le.jsx)(Nl,{title:(0,le.jsx)(v().sA,{id:"identityAndProvisioning.emailDomainsSection.organization.title",defaultMessage:"Verified domains"}),byline:(0,le.jsx)(v().sA,{id:"identityAndProvisioning.emailDomainsSection.organization.byline",defaultMessage:"Verify ownership of an email domain to access advanced security features including single sign-on."}),settingItem:p()})),[p]),m=(0,l().K8)((()=>t.state.emailDomains.length+t.state.domainVerifications.length>0),[t]);return(0,le.jsxs)(qe().VP,{gap:16,children:[m?(0,le.jsx)(Tl,{disabled:!0,spaceStore:e,samlConfigStore:t,renderOverrideAddDomainButton:g}):g(),(0,le.jsx)(Nl,{title:(0,le.jsx)(v().sA,{id:"identityProvisioningSettings.saml.organization.title",defaultMessage:"Enable SAML SSO"}),byline:(0,le.jsx)(v().sA,{id:"identityProvisioningSettings.saml.organization.byline",defaultMessage:"Workspace members can log in with SAML SSO if their email address uses a verified email domain."}),settingItem:p()})]})}var sd=()=>n(68204),od=()=>n(859236);function ad({userStore:e,spaceStore:t,upsell:n}){const[s,o]=(0,i.useState)(void 0),r=(0,a().v3)(),d=(0,l().K8)((()=>function({botIds:e,spaceStore:t,environment:n}){if(void 0===e)return"Undefined";const i=e.map((e=>X().v.createChildStore(t,{table:B().GP,id:e,spaceId:t.id}))).filter((e=>e.isDefined()));if(i.some((e=>e.getCreatedByTable()===R().oo&&e.getCreatedById()===R().BF.id)))return"SpaceHasExistingToken";const s=i.some((e=>e.getCreatedByTable()===R().oo&&e.getCreatedById()===n.currentUser.id));if(s)return"UserHasExistingToken";return"Able"}({botIds:s,spaceStore:t,environment:r})),[s,r,t]),c=(0,le.jsx)(v().sA,{id:"identityAndProvisioning.scim.title",defaultMessage:"SCIM tokens"}),u=(0,le.jsx)(v().sA,{id:"identityAndProvisioning.scim.byline",defaultMessage:"Generate a token to configure SCIM."});return(0,Ro().wy)(n)?(0,le.jsx)(rl,{spaceStore:t,title:c,upsell:n,customMessages:xl}):(0,le.jsxs)("div",{children:[(0,le.jsx)(Nl,{title:c,byline:u,settingItem:(0,le.jsx)(sd().K,{onNewScimToken:e=>o((t=>[...t??[],e])),spaceStore:t,userStore:e,tokenCreationAbility:d})}),(0,le.jsx)(tn().A,{title:(0,le.jsx)(v().sA,{id:"securitySAMLSettings.SCIMSection.helpButton.label",defaultMessage:"Learn about SCIM"}),style:{marginTop:18,marginBottom:24},href:(0,ut().x)("guides.scim"),analyticsFrom:"scim_settings"}),(0,le.jsx)(od().A,{spaceStore:t,userStore:e,botIds:s,setBotIds:o})]})}var rd=()=>n(360007);function ld({userStore:e,spaceStore:t}){const n=(0,a().v3)(),i=(0,xi()._)({name:"scim",spaceId:t.id,userId:e.id}),s=null==i?void 0:i.upsell,o=(0,l().K8)((()=>Boolean(t.getSettings().are_scim_invite_emails_suppressed)),[t]),r=(0,Ro().wy)(s),c=(0,d().IS)((()=>({container:{display:"flex",flexDirection:"column",gap:r?0:16}})),[r]);return(0,le.jsxs)("div",{style:c.container,children:[(0,le.jsx)(ad,{upsell:s,userStore:e,spaceStore:t}),r?null:(0,le.jsx)(rd().S,{isEnabled:o,onToggle:()=>{(0,rd().i)({environment:n,spaceStore:t,areScimInviteEmailsSuppressed:!o})}})]})}var dd=()=>n(306044);function cd({userStore:e,spaceStore:t,samlConfigStore:n,domainSettingsStore:s}){const{organizationInfo:o,isOrganizationOwner:r}=(0,Aa().n)({spaceId:t.id}),{onboardingInfo:l}=function({spaceId:e,allowSecondaryWorkspace:t}){const n=(0,a().v3)(),{updateCacheWithRecordMap:s}=(0,i.useContext)(ol().N),[{status:o,value:r},l]=(0,Ge().Yb)((async()=>{const i=await D().callApi({eventName:"getOrganizationOnboardingInfo",environment:n,data:{spaceId:e,allowSecondaryWorkspace:t}});return"success"===i.type?(s({data:i.data}),i.data.result):"failed"===i.type?{onboardingStatus:"ineligible"}:(0,rt().HB)(i)}),[n,e,s,t]);return{loading:"pending"===o||"idle"===o,onboardingInfo:r,refresh:l}}({spaceId:t.id,allowSecondaryWorkspace:!0});return(0,le.jsx)(ud,{userStore:e,spaceStore:t,samlConfigStore:n,domainSettingsStore:s,organizationInfo:o,isOrganizationOwner:r,organizationOnboardingInfo:l})}function ud({userStore:e,spaceStore:t,samlConfigStore:n,domainSettingsStore:s,organizationInfo:o,isOrganizationOwner:a,organizationOnboardingInfo:r}){const u=(0,l().O$)(c().e),{loadingSaml:p,loadedSaml:g,errorSaml:m}=(0,i.useContext)(tl),f=void 0!==o,h=r&&("not_started"===r.onboardingStatus||"domain_verified"===r.onboardingStatus),y=f&&!a,b=r&&"ineligible"!==(null==r?void 0:r.onboardingStatus),S=(0,d().IS)((()=>({header:{marginTop:36},title:{display:"flex",alignItems:"center",gap:6}})),[]),x=(0,A().T)(),M=(0,xi()._)({name:"domain_settings",spaceId:t.id,userId:x}),j=(0,xi()._)({name:"managed_users",spaceId:t.id,userId:x}),w=null==M?void 0:M.upsell,I=null==j?void 0:j.upsell;return(0,i.useEffect)((()=>{u&&!p&&m&&T().c1(m.message)}),[m,p,u]),u?p?(0,le.jsx)(Xe().Ay,{centerContent:!0,children:(0,le.jsx)(Bn().k,{})}):m?null:g?(0,le.jsxs)(Xe().Ay,{children:[(0,le.jsx)(Bl,{samlConfigStore:n,spaceStore:t}),h?(0,le.jsx)(al().s,{organizationOnboardingInfo:r}):null,o&&!a?(0,le.jsx)(sl().l,{display:"inline",tint:"blue",staticIcon:il().lockFillIcon,label:(0,le.jsx)(v().sA,{id:"workspaceSettingsModal.organizationsBanner.member.title",defaultMessage:"Settings that can only be managed by organization owners have been moved to the organization console."}),description:(0,le.jsx)(v().sA,{id:"workspaceSettingsModal.organizationsBanner.member.tooltip",defaultMessage:"Verifying domains and managing accounts can only be done by organization owners. Organization owners can manage all workspaces in {organizationName}.",values:{organizationName:o.name}})}):null,(0,Ro().wy)(w)?(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(ve().A,{large:!0,divider:"full",children:(0,le.jsx)(v().sA,{id:"identityProvisioningSettings.domain.title",defaultMessage:"Domain management"})}),(0,le.jsx)(Cl,{spaceStore:t,samlConfigStore:n,domainSettingsStore:s,domainSettingsUpsell:w})]}):null,(0,Ro().wy)(I)?(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(ve().A,{large:!0,divider:"full",style:S.header,children:(0,le.jsx)(v().sA,{id:"identityProvisioningSettings.userManagement.title",defaultMessage:"User management"})}),(0,le.jsx)(Rl,{spaceStore:t,managedUsersUpsell:I})]}):null,y?null:b?(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(ve().A,{large:!0,divider:"full",style:"completed"===(null==r?void 0:r.onboardingStatus)?void 0:S.header,children:(0,le.jsxs)("div",{style:S.title,children:[(0,le.jsx)(v().sA,{id:"identityProvisioningSettings.saml.title",defaultMessage:"SAML single sign-on (SSO)"}),(0,le.jsx)(tn().A,{href:(0,ut().x)("guides.samlSettings"),analyticsFrom:"saml_settings"})]})}),(0,le.jsx)(id,{spaceStore:t,samlConfigStore:n,domainSettingsStore:s,organizationOnboardingInfo:r})]}):(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(ve().A,{large:!0,divider:"full",style:S.header,children:(0,le.jsx)(v().sA,{id:"identityProvisioningSettings.saml.title",defaultMessage:"SAML single sign-on (SSO)"})}),(0,le.jsx)(td,{spaceStore:t,samlConfigStore:n,domainSettingsStore:s})]}),(0,le.jsx)(ve().A,{large:!0,divider:"full",style:S.header,children:(0,le.jsx)(v().sA,{id:"identityProvisioningSettings.scim.title",defaultMessage:"SCIM provisioning"})}),(0,le.jsx)(ld,{userStore:e,spaceStore:t}),(0,le.jsx)(dd().K,{spaceStore:t})]}):null:(0,le.jsx)(Xe().Ay,{children:(0,le.jsx)(we().A,{isSmall:!0,isMultiline:!0,style:{textAlign:"center"},children:(0,le.jsx)(v().sA,{defaultMessage:"Please go online to manage identity and provisioning settings.",id:"identityProvisioningSettings.offline.message"})})})}function pd({userStore:e,spaceStore:t,samlConfigStore:n,domainSettingsStore:i}){return(0,le.jsx)(cd,{userStore:e,spaceStore:t,samlConfigStore:n,domainSettingsStore:i})}const gd=function({userStore:e,spaceStore:t,samlConfigStore:n,domainSettingsStore:i}){return(0,le.jsx)(nl,{spaceStore:t,samlConfigStore:n,domainSettingsStore:i,children:(0,le.jsx)(pd,{userStore:e,spaceStore:t,samlConfigStore:n,domainSettingsStore:i})})};var md=()=>n(230711),fd=()=>n(701763),hd=()=>n(709438),yd=()=>n(240865);function vd(){const e=(0,l().K8)((()=>{const{sidebarSpaceStore:e}=Ve().default.state;return e}),[]),t=(0,g().lh)({spaceId:null==e?void 0:e.id});return(0,l().K8)((()=>{if(!e)return!1;const n=(0,y().AI)(t);return(0,io().dL)(n)||(0,io().Pg)(n)}),[e,t])}var bd=()=>n(232461);function Sd(){const e=(0,l().O$)(Ve().AppStoreSidebarSpaceStore),t=(0,bd().J)(),n=(0,l().K8)((()=>{const t=null==e?void 0:e.getModel();if(!e||!t)return!1;const n=e.getSubscriptionTier();return"personal"===e.getPlanType()||"enterprise"!==n}),[e]);return!(!t||!n)}var xd=()=>n(169626),Md=()=>n(910609),Ad=()=>n(334992),jd=()=>n(769730),wd=()=>n(789180),Id=()=>n(8364),kd=()=>n(280838),Td=()=>n(499764);function Cd({spaceStore:e,spacePermissionsSettingsStore:t}){const n=(0,a().v3)(),{canEditMembership:i,isSpaceStoreDefined:s}=(0,l().K8)((()=>({canEditMembership:e.canEditMembership(),isSpaceStoreDefined:e.isDefined()})),[e]),o=n.currentUser.id,r=e.id,d=(0,xi()._)({name:"group_management",spaceId:r,userId:o}),c=i&&(0,no().e2)(d),u=(0,l().K8)((()=>0!==(0,Lo().zI)({spaceStore:e})),[e]),p=(0,l().K8)((()=>0!==(0,Td().Qo)()),[]);return s&&d?(0,le.jsxs)("div",{children:[(0,no().e2)(d)&&!p?(0,le.jsx)(we().A,{isMultiline:!0,style:{marginTop:17,marginBottom:17},children:u?(0,le.jsx)(v().sA,{id:"spacePermissionsSettings.groupsTab.captionWithTeamsV2",defaultMessage:"Set up groups to streamline page permissions from the share menu and manage teamspace members in bulk."}):(0,le.jsx)(v().sA,{id:"spacePermissionsSettings.groupsTab.caption",defaultMessage:"Set up groups to conveniently control page permissions from the share menu."})}):void 0,(0,le.jsx)(kd().r,{spaceStore:e,permissionsSettingsStore:t,canEdit:c,containerMarginTop:(0,no().e2)(d)?0:void 0,upsell:d.upsell})]}):null}var _d=()=>n(30537),Pd=()=>n(265060);const Bd=(0,Ys().xh)("personCropCircleBadgePlus",{default:{loader:()=>n.e(89509).then(n.bind(n,359713))},small:{loader:()=>n.e(89509).then(n.bind(n,845052))},fill:{loader:()=>n.e(89509).then(n.bind(n,845324))},fillSmall:{loader:()=>n.e(89509).then(n.bind(n,478419))}},["person","add","user","new","plus"]);var Rd=()=>n(980427),Dd=()=>n(496414),Ld=()=>n(618841),Ed=()=>n(592674),Od=()=>n(405331),Nd=()=>n(483226),Fd=()=>n(70899),Ud=()=>n(105062),zd=()=>n(101163),Kd=()=>n(252953),Vd=()=>n(567865),qd=()=>n(785606),Wd=()=>n(19575),Gd=()=>n(803025);const Hd=(0,v().YK)({infoTitle:{id:"spacePermissionsSettings.guestsTab.internalGuestBanner.title",defaultMessage:"Find teammates more easily by filtering to your workspace’s email domains"},infoDescription:{id:"spacePermissionsSettings.guestsTab.internalGuestBanner.description",defaultMessage:"Upgrade these guests to members for better collaboration and reduced page-by-page permissions."},emailDomainTooltip:{defaultMessage:"Your workspace’s email domains include allowed email domains, verified domains, and workspace owner email domains.",id:"spacePermissionsSettings.guestsTab.internalGuestBanner.tooltip"},overLimitTitle:{id:"spacePermissionsSettings.guestsTab.internalGuestBanner.overLimit.title",defaultMessage:"Your workspace is over the {limit}-guest limit"},upsellDescription:{id:"spacePermissionsSettings.guestsTab.internalGuestBanner.overLimit.upselldescription",defaultMessage:"Find teammates who are currently guests by filtering to your workspace’s email domains and upgrade them to members to continue collaborating. To get more guest seats, <upgradelink>upgrade your plan</upgradelink> or <saleslink>reach out to sales</saleslink>."},contactSalesDescription:{id:"spacePermissionsSettings.guestsTab.internalGuestBanner.overLimit.contactSales.description",defaultMessage:"Find teammates who are currently guests by filtering to your workspace’s email domains and upgrade them to members to continue collaborating. To get more guest seats, <saleslink>reach out to sales</saleslink>."},salesAssistedDescription:{id:"spacePermissionsSettings.guestsTab.internalGuestBanner.overLimit.salesAssisted.description",defaultMessage:"Find teammates who are currently guests by filtering to your workspace’s email domains and upgrade them to members to continue collaborating. To get more guest seats, reach out to your account manager."},nonAdminTooltip:{id:"spacePermissionsSettings.guestsTab.internalGuestBanner.overLimit.nonAdmin.tooltip",defaultMessage:"New users can continue to be added as members. To resume adding guests, contact your workspace owner to upgrade or remove existing guests from your workspace."}}),Yd={warning_upsell:{iconGroup:Kd().A,tint:"yellow",label:Hd.overLimitTitle,description:Hd.upsellDescription,tooltip:Hd.emailDomainTooltip},warning_contact_sales:{iconGroup:Kd().A,tint:"yellow",label:Hd.overLimitTitle,description:Hd.contactSalesDescription,tooltip:Hd.emailDomainTooltip},warning_sales_assisted:{iconGroup:Kd().A,tint:"yellow",label:Hd.overLimitTitle,description:Hd.salesAssistedDescription,tooltip:Hd.emailDomainTooltip},warning_nonadmin:{iconGroup:Kd().A,tint:"yellow",label:Hd.overLimitTitle,tooltip:Hd.nonAdminTooltip},info:{iconGroup:n(933266).h,tint:"gray",label:Hd.infoTitle,description:Hd.infoDescription,tooltip:Hd.emailDomainTooltip}};function $d({spaceStore:e,internalDomains:t,domainFilterValues:n,setDomainFilterValues:i}){const s=(0,wd().r1)({spaceStore:e}),o=t.length>0;if(!o)return null;const a=o&&s,r=(0,le.jsx)(Qd,{spaceStore:e});return a||r?(0,le.jsxs)(xt().Y1,{padding:"16px 0px",gap:16,children:[r,a?(0,le.jsx)(Zd,{internalDomains:t,domainFilterValues:n??[],setDomainFilterValues:i}):void 0]}):null}function Qd({spaceStore:e}){const t=function({spaceStore:e}){const t=(0,a().v3)(),n=(0,wd().r1)({spaceStore:e}),i=t.currentUser.id,s=e.id,o=(0,xi()._)({name:"internal_guests",spaceId:s,userId:i,amount:0}),r=(0,g().lh)({spaceId:s}),d=(0,y().AI)(r),c=(0,Gd().q)(),u=(0,l().K8)((()=>(0,Nd().RL)({currentSubscriptionTier:d,salesStatus:c})),[d,c]);if(!o)return null;return(0,no().N9)(o,{available:()=>n?{...Yd.info,messageValues:{}}:null,unavailable:({limit:e,upsell:t})=>n?"sales_assisted"===c?{...Yd.warning_sales_assisted,messageValues:{limit:e.total}}:"none"===t.type||"enterprise"===t.product&&!u?{...Yd.warning_contact_sales,messageValues:{limit:e.total,saleslink:e=>(0,le.jsx)(ui().V,{onClick:()=>(0,Wd().lK)({initialQuestion:"manage_guests",openedFrom:"people_guest_limit_banner"}),children:e})}}:"product"===t.type?{...Yd.warning_upsell,messageValues:{limit:e.total,saleslink:e=>(0,le.jsx)(ui().V,{onClick:()=>(0,Wd().lK)({initialQuestion:"manage_guests",openedFrom:"people_guest_limit_banner"}),children:e}),upgradelink:e=>(0,le.jsx)(ui().V,{onClick:()=>{Qe().Ay.setState({...Qe().Ay.state,currentTab:"plans",defaultSubtab:void 0})},children:e})}}:(0,rt().HB)(t):{...Yd.warning_nonadmin,messageValues:{limit:e.total}}})}({spaceStore:e});if(!t)return null;const n=(0,le.jsx)(je().m,{style:{width:250},textWrap:!0,renderTooltip:()=>(0,le.jsx)(v().sA,{...t.tooltip}),originGap:6,placement:"bottom",alignment:"start",render:e=>(0,le.jsx)("div",{style:{paddingInlineStart:3,display:"inline-block",verticalAlign:"text-bottom"},...e,children:(0,le.jsx)(f().I,{icon:El().questionMarkCircleSmallIcon,size:"sm"})})});return(0,le.jsx)(qd().I,{children:(0,le.jsx)(sl().l,{iconGroup:t.iconGroup,display:"inline",tint:t.tint,label:(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(v().sA,{...t.label,values:t.messageValues}),t.description?void 0:n]}),description:t.description&&(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(v().sA,{...t.description,values:t.messageValues}),n]})})})}function Zd({internalDomains:e,domainFilterValues:t,setDomainFilterValues:n}){const i=[...e.map((e=>({key:e.url,value:`${e.url}`,title:Xd({domain:`${e.url}`})}))),{key:"other",value:"other",title:Xd({domain:"other"})}];return(0,le.jsx)(Vd().uI,{pillIcon:Fd().U,pillTitle:t?(0,le.jsx)(v().sA,{id:"spacePermissionsSettings.guestsTab.internalDomainFilter.filtered",defaultMessage:"Email domain: {domainFilter}",values:{domainFilter:t.join(", ")}}):(0,le.jsx)(v().sA,{id:"spacePermissionsSettings.guestsTab.internalDomainFilter.placeholder",defaultMessage:"Email domain"}),selectedItems:t,setSelectedItems:e=>{n(e)},items:i})}function Xd({domain:e}){return(0,le.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:4},children:["other"===e?(0,le.jsx)(v().sA,{defaultMessage:"Other",id:"spacePermissionsSettings.guestsTab.internalDomainFilter.otherOptionLabel"}):`@${e}`,(0,le.jsx)(f().I,{icon:"other"===e?zd().globeSmallIcon:Ud().checkmarkShieldSmallIcon,size:"sm"})]})}var Jd=()=>n(128933),ec=()=>n(124092),tc=()=>n(842599);const nc={viewBox:"0 0 20 20",fittedViewBox:"1.68 2.37 17.29 15.26",svg:(0,le.jsx)("path",{d:"M5.326 3.617C5.946 2.844 6.863 2.375 8 2.375s2.055.47 2.675 1.242c.608.757.9 1.765.9 2.824s-.292 2.066-.9 2.824c-.62.772-1.538 1.241-2.675 1.241s-2.054-.469-2.674-1.241c-.608-.758-.9-1.766-.9-2.824 0-1.059.292-2.067.9-2.824M1.88 14.935C2.899 12.945 5.3 11.63 8 11.63s5.101 1.316 6.12 3.306c.361.706.199 1.421-.23 1.923-.412.48-1.06.767-1.74.767h-8.3c-.68 0-1.328-.287-1.74-.767-.429-.502-.591-1.217-.23-1.923m16.996-7.958a.625.625 0 0 0-1.072-.643L15.25 10.59l-1.435-1.675a.625.625 0 1 0-.95.814l2 2.333a.625.625 0 0 0 1.011-.085z"})},ic=(0,Ys().wt)("personCheckmarkFill",nc,"fill"),sc={viewBox:"0 0 20 20",fittedViewBox:"1.68 2.37 17.01 15.26",svg:(0,le.jsx)("path",{d:"M8 2.375c-1.137 0-2.054.47-2.674 1.242-.608.757-.9 1.765-.9 2.824s.292 2.066.9 2.824c.62.772 1.537 1.241 2.674 1.241s2.055-.469 2.675-1.241c.608-.758.9-1.766.9-2.824 0-1.059-.292-2.067-.9-2.824-.62-.773-1.538-1.242-2.675-1.242m0 9.255c-2.7 0-5.101 1.315-6.12 3.305-.361.706-.199 1.421.23 1.923.412.48 1.06.767 1.74.767h8.3c.68 0 1.328-.287 1.74-.767.429-.502.591-1.217.23-1.923C13.1 12.945 10.7 11.63 8 11.63m10.486-4.693a.625.625 0 0 1 0 .884L16.807 9.5l1.68 1.68a.625.625 0 1 1-.884.883l-1.68-1.68-1.68 1.68a.625.625 0 0 1-.883-.884L15.04 9.5l-1.68-1.68a.625.625 0 1 1 .884-.883l1.68 1.68 1.678-1.68a.625.625 0 0 1 .884 0"})},oc=(0,Ys().wt)("personXmarkFill",sc,"fill"),ac=5;function rc({request:e,shouldDisableInteraction:t,requestType:n,handleApprove:s,handleDecline:o}){const r=function({shouldDisableInteraction:e}){return(0,d().IS)((()=>({approveButton:{background:Mt().Tj.outlineBlueButtonHoveredBackground,color:Mt().Tj.blue.text.accentPrimary,fontWeight:510,fontSize:14,borderRadius:4,paddingInlineStart:10,paddingInlineEnd:10},declineButton:{marginInlineEnd:10,borderRadius:4,paddingInlineStart:10,paddingInlineEnd:10},container:{opacity:e?.5:1,display:"flex",width:"100%",justifyContent:"flex-end"}})),[e])}({shouldDisableInteraction:t}),[l,c]=(0,i.useState)(!1),u=(0,a().v3)(),p=(0,i.useCallback)((()=>{fd().jR(u,{from:`${n}_request`,button_name:"decline"}),o(e)}),[u,n,e,o]),g=(0,i.useCallback)((async()=>{c(!0),fd().jR(u,{from:`${n}_request`,button_name:"approve"}),await s(e),c(!1)}),[u,e,n,s]);return(0,le.jsxs)("div",{style:r.container,children:[(0,le.jsx)("div",{children:(0,le.jsx)(pi().p,{style:r.declineButton,onClick:p,disabled:t,children:(0,le.jsx)(v().sA,{id:"spaceSettings.peopleSection.requestsTable.Decline",defaultMessage:"Decline"})})}),(0,le.jsx)("div",{children:(0,le.jsx)(pi().p,{style:r.approveButton,onClick:g,isLoading:l,disabled:t,children:(0,le.jsx)(v().sA,{id:"spaceSettings.peopleSection.requestsTable.approve",defaultMessage:"Approve"})})})]})}var lc=()=>n(691298);function dc({isModalOpen:e,handleDismiss:t,handleConfirm:n,title:i,description:o,ctaText:a}){const{styles:r}=function(){const e=(0,d().eP)(),t=(0,d().IS)((()=>({modal:{width:300,overflow:"hidden",borderRadius:5},container:{display:"flex",paddingTop:20,paddingInlineEnd:20,paddingBottom:12,paddingInlineStart:20,flexDirection:"column",width:299,justifyContent:"center",alignItems:"flex-start",gap:20},iconAndTitle:{display:"flex",flexDirection:"column",alignItems:"center",gap:9,width:"100%"},iconContainer:{display:"flex",justifyContent:"center",alignItems:"center",width:36,height:36},icon:{color:Mt().Tj.icon.secondary,fontSize:24,fontWeight:510},title:{color:Mt().Tj.text.primary,textAlign:"center",fontSize:17,fontWeight:590,width:"100%",wordBreak:"break-word"},description:{color:Mt().Tj.text.secondary,textAlign:"center"},footer:{display:"flex",flexDirection:"column",gap:8,alignItems:"center",width:"100%"},declineButton:{height:32,padding:"0 12px",borderRadius:6,width:"100%",textAlign:"center",alignItems:"center",justifyContent:"center",background:Mt().Tj.red.background.accentPrimary},declineButtonHovered:{background:(0,Me().i)({color:Mt().Tj.red.background.accentPrimary,mode:e})},declineText:{fontWeight:590,color:Mt().Tj.text.inversePrimary},cancelButton:{display:"flex",height:24,padding:"0px 6px",justifyContent:"center",alignItems:"center",gap:4,textAlign:"center"}})),[e]);return{styles:t}}();return(0,lc().A)({shouldPreserveTextSelection:!0,shouldPreserveBlockSelection:!0,shouldRestoreSelection:!0}),(0,le.jsx)(u().a,{open:e,innerStyle:r.modal,showCloseIcon:!0,onDismiss:t,render:()=>(0,le.jsx)(s().A,{capture:!0,allowEsc:!0,render:()=>(0,le.jsxs)("div",{style:r.container,children:[(0,le.jsxs)("div",{style:r.iconAndTitle,children:[(0,le.jsx)("div",{style:r.iconContainer,children:(0,le.jsx)("div",{style:r.icon,children:(0,le.jsx)(f().I,{icon:oc,size:24})})}),(0,le.jsx)("div",{style:r.title,children:i})]}),(0,le.jsx)("div",{style:r.description,children:o}),(0,le.jsxs)("div",{style:r.footer,children:[(0,le.jsx)(pi().p,{style:r.declineButton,onClick:()=>{n(),t()},hoveredStyle:r.declineButtonHovered,children:(0,le.jsx)("div",{style:r.declineText,children:a})}),(0,le.jsx)(pi().p,{style:r.cancelButton,onClick:t,children:(0,le.jsx)("div",{children:(0,le.jsx)(v().sA,{id:"BulkDeclineConfirmationDialog.cancel",defaultMessage:"Cancel"})})})]})]})})})}function cc(e){const{isModalOpen:t,handleClickDecline:n,handleClickDismiss:s,requestType:o,requests:r}=e,d=function(e,t,n){const s=(0,a().v3)();return(0,i.useCallback)((()=>{n(),fd().jR(s,{from:"member"===e?"member_request":"guest_request",button_name:"dismiss_in_dialog",count:t.length})}),[n,s,t,e])}(o,r,s),c=(0,v().tz)(),u=(0,l().K8)((()=>{var e;return null===(e=r[0])||void 0===e||null===(e=e.createdByActorsWithReason[0])||void 0===e?void 0:e.actor.getDisplayName(c)}),[r,c]),p=(0,l().K8)((()=>{var e;return null===(e=r[0])||void 0===e?void 0:e.forActor.email}),[r]);return 0===r.length?null:(0,le.jsx)(dc,{isModalOpen:t,handleDismiss:d,handleConfirm:()=>n(r),title:(0,le.jsx)(v().sA,{id:"RequestBulkDeclineConfirmationDialog.title",defaultMessage:"Decline {numberOfRequests, plural, one {{requestType} request for {firstRequestEmail}} other {{numberOfRequests} {requestType} requests}}?",values:{numberOfRequests:r.length,requestType:o,firstRequestEmail:p}}),description:(0,le.jsx)(v().sA,{id:"RequestBulkDeclineConfirmationDialog.description",defaultMessage:"{numberOfRequests, plural, one {To add them as a {requestType} in the future, {inviter} must resubmit a request, or an admin must invite them} other {Requests must be resubmitted, or an admin must add them as {isMemberRequest, select, true {members} other {guests}} in the future}}.",values:{numberOfRequests:r.length,requestType:o,isMemberRequest:"member"===o,inviter:u}}),ctaText:(0,le.jsx)(v().sA,{id:"RequestBulkDeclineConfirmationDialog.decline",defaultMessage:"Decline"})})}var uc=()=>n(815585);function pc({createdByActorsWithReason:e,latestRequestTime:t}){return(0,le.jsx)("div",{style:{width:241,maxHeight:600,overflowY:"auto",whiteSpace:"pre-wrap",paddingTop:12,paddingInlineEnd:12,paddingBottom:12,paddingInlineStart:12},children:e.map((e=>(0,le.jsx)(gc,{createdByActorWithReason:e,latestRequestTime:t},e.actor.id)))})}function gc({createdByActorWithReason:e,latestRequestTime:t}){const{requestorName:n,reason:i,actor:s,styles:o}=function({createdByActorWithReason:e}){const{actor:t,reason:n}=e,i=(0,v().tz)(),s=(0,l().K8)((()=>t.getDisplayName(i)),[i,t]),o=(0,d().IS)((()=>({avatar:{width:24,height:24},metadata:{display:"flex",alignItems:"center",gap:6,flex:"1 0 0"},userName:{textOverflow:"ellipsis",fontSize:14,fontWeight:510,overflow:"hidden",width:100,whiteSpace:"nowrap"},timestamp:{color:Mt().Tj.text.tertiary,textAlign:"end",fontSize:12,fontWeight:400,lineHeight:"15px"},header:{display:"flex",alignItems:"center",gap:10},reason:{paddingInlineStart:30,fontSize:14,fontWeight:400,color:Mt().Tj.text.primary,display:"inline-block",overflowWrap:"break-word",inlineSize:200},noReason:{color:Mt().Tj.text.disabled}})),[]);return{requestorName:s,reason:n,actor:t,styles:o}}({createdByActorWithReason:e});return(0,le.jsxs)("div",{children:[(0,le.jsxs)("div",{style:o.header,children:[(0,le.jsx)(Ai().A,{hasTooltip:!0,userValue:s,style:o.avatar,size:24,avatarShouldShowShadow:!1}),(0,le.jsxs)("div",{style:o.metadata,children:[(0,le.jsx)("div",{style:o.userName,children:n}),(0,le.jsx)(we().A,{isSmall:!0,isSecondaryColor:!0,isMultiline:!0,style:o.timestamp,children:(0,uc().nl)(t)})]})]}),(0,le.jsx)("span",{style:o.reason,children:i||(0,le.jsx)("div",{style:o.noReason,children:(0,le.jsx)(v().sA,{id:"requestReasonContent.noReason",defaultMessage:"No message"})})})]})}function mc({request:e,shouldDisableInteraction:t,requestType:n}){const{styles:i,firstRequestorName:s,numberOfRequestors:o}=function({request:e,shouldDisableInteraction:t}){const n=(0,d().IS)((()=>({firstRequestorName:{opacity:t?.5:1,maxWidth:118,...ye().RC},buttonSuffix:{color:Mt().Tj.text.tertiary,paddingInlineStart:4},chevron:{width:10,marginInlineStart:4,fill:Mt().Tj.icon.secondary}})),[t]),i=(0,a().v3)(),s=(0,v().tz)(),o=(0,l().K8)((()=>{if(0===e.createdByActorsWithReason.length)return;return new(J().L)(i,{table:R().oo,id:e.createdByActorsWithReason[0].actor.id}).getDisplayName(s)}),[i,s,e.createdByActorsWithReason]);return{styles:n,firstRequestorName:o,numberOfRequestors:e.createdByActorsWithReason?e.createdByActorsWithReason.length:0}}({request:e,shouldDisableInteraction:t}),r=(0,a().v3)();return void 0===s||0===o?null:(0,le.jsx)(Kt().A,{popupType:Kt().z.Popup,onClick:()=>{fd().jR(r,{from:`${n}_request`,button_name:"open_requested_by"})},renderOrigin:e=>(0,le.jsx)(pi().p,{...e,disabled:t,iconTrailing:{icon:Yt().arrowChevronSingleDownSmallIcon,colorVariant:"secondary",size:"xs"},children:(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)("span",{style:i.firstRequestorName,title:s,children:s}),(0,le.jsx)("span",{style:i.buttonSuffix,children:o>1?(0,le.jsxs)("div",{children:["+",o-1]}):null})]})}),render:()=>(0,le.jsx)(pc,{createdByActorsWithReason:e.createdByActorsWithReason,latestRequestTime:e.accessRequest.created_time})})}n(944114);var fc=()=>n(312788),hc=()=>n(295633),yc=()=>n(584262),vc=()=>n(179034),bc=()=>n(305390),Sc=()=>n(597703),xc=()=>n(492414);function Mc({guestUserId:e,pageIds:t}){const{menuListItems:n,styles:s,noAccessPageCount:o}=function({guestUserId:e,pageIds:t}){const{navigate:n}=(0,i.useContext)(fc().E),s=(0,d().IS)((()=>({container:{width:300},chevron:{marginInlineStart:8,width:16,height:16}})),[]),o=(0,a().v3)(),{menuListItems:r,noAccessPageCount:c}=(0,l().K8)((()=>{let e=0;const i=[];return t.forEach((t=>{const s=new(hc().B)(o,{table:vc().ev,id:t});if(!s.canAdmin())return void(e+=1);const a={key:t,render:e=>(0,le.jsx)(bc().A,{...e,store:s}),action:()=>{const e=(0,xc().Ay)({store:s,fullyQualified:!1,pageVisitSource:yc().y8.LinkInPage});n({environment:o,url:e,openInNew:"tab"})}};i.push(a)})),{menuListItems:i,noAccessPageCount:e}}),[t,o,n]);return{menuListItems:r,styles:s,noAccessPageCount:c}}({guestUserId:e,pageIds:t});if(o>0){const e={key:"guest-pages-content-no-access-summary",render:e=>(0,le.jsx)(Sc().H,{...e,noAccessPageCount:o}),action:()=>{}};n.push(e)}return(0,le.jsx)("div",{style:s.container,children:(0,le.jsx)(Gt().A,{type:Gt().O.Vertical,initialFocus:void 0,sections:[{key:"pages",render:e=>(0,le.jsx)(Ht().A,{...e}),items:n}]})})}function Ac({from:e,guestUserId:t,pageIds:n,shouldDisableInteraction:i}){const{styles:s}=function({shouldDisableInteraction:e}){const t=(0,d().IS)((()=>({button:{opacity:e?.5:1},chevron:{width:10,marginInlineStart:4,fill:Mt().Tj.icon.secondary}})),[e]);return{styles:t}}({shouldDisableInteraction:i}),o=(0,a().v3)(),r=n.length;return 0===r?(0,le.jsx)(pi().p,{disabled:!0,style:s.button,children:(0,le.jsx)(v().sA,{id:"peopleSectionguestsTab.GuestPagesButton.noPages",defaultMessage:"No pages"})}):(0,le.jsx)(Kt().A,{popupType:Kt().z.Popup,onClick:()=>{fd().jR(o,{from:e,button_name:"open_pages"})},renderOrigin:e=>(0,le.jsx)(pi().p,{...e,style:s.button,iconTrailing:{icon:Yt().arrowChevronSingleDownSmallIcon,colorVariant:"secondary",size:"xs"},children:(0,le.jsx)(v().sA,{id:"GuestPagesButton.button",defaultMessage:"{numOfPages, plural, one {{numOfPages} page} other {{numOfPages} pages}}",values:{numOfPages:r}})}),disabled:i,render:()=>(0,le.jsx)(Mc,{pageIds:n,guestUserId:t})})}function jc({request:e,spaceStore:t,shouldDisableInteraction:n}){const{accessRequest:i,forActor:s}=e,o=function({accessRequest:e}){return(0,l().K8)((()=>e.isGuestInviteRequest()?e.getAttributes().permission_records_and_roles.map((e=>e.id)):[]),[e])}({accessRequest:i});return(0,le.jsx)(Ac,{pageIds:o,guestUserId:s.id,shouldDisableInteraction:n,from:"guest_request"})}function wc({spaceStore:e,request:t}){const{teamStores:i}=function({request:{accessRequest:e},spaceStore:t}){const{teams:n}=(0,Tn().Qs)({spaceStore:t}),i=(0,Tn().gc)({spaceStore:t,teams:n}).map((e=>e.store)),s=(0,l().K8)((()=>{var n,s;const o=i.filter((e=>e.isDefault())),a=null===(n=e.getAttributes())||void 0===n?void 0:n.origin_table,r=null===(s=e.getAttributes())||void 0===s?void 0:s.origin_id;if(a&&r){const e=dn().h.createChildStore(t,{table:cn().yK,id:r});o.includes(e)||o.push(e)}return o}),[e,t,i]);return{teamStores:s}}({request:t,spaceStore:e});return(0,le.jsx)(n(37625).RR,{teamsForMember:i})}function Ic({request:e,spaceStore:t}){const{relativeDate:n,email:i,userStore:s,styles:o}=function({request:{accessRequest:e,forActor:t},spaceStore:n}){const i=(0,d().IS)((()=>({container:{display:"flex",alignItems:"center",fontSize:ye().J.UIRegular.desktop,gap:10,flex:"1 0 0",maxWidth:50},userAvatar:{},title:{height:17,alignSelf:"stretch",fontSize:ye().J.UIRegular.desktop,fontStyle:"normal",fontWeight:510,lineHeight:"18px",maxWidth:160,...ye().RC},subtitle:{height:17,alignSelf:"stretch",fontSize:ye().J.UISmall.desktop,fontStyle:"normal",fontWeight:400,lineHeight:"15px",color:Mt().Tj.text.secondary,maxWidth:160,...ye().RC}})),[]),s=J().L.createChildStore(n,{table:R().oo,id:t.id}),o=(0,l().K8)((()=>s.getEmail()),[s]),a=(0,v().tz)(),r=(0,l().K8)((()=>e.created_time),[e]),c=C().KQ(r,(0,G().P)()),u=(0,vi().ZF)({value:c,date_format:"relative",userTimeZone:(0,G().P)(),intl:a,allowRelativeDates:!0});return{email:o,styles:i,userStore:s,relativeDate:u}}({request:e,spaceStore:t});return(0,le.jsxs)("div",{style:o.container,children:[(0,le.jsx)(Ai().A,{style:o.userAvatar,userStore:s,size:28}),(0,le.jsxs)("div",{children:[(0,le.jsx)("div",{style:o.title,title:i,children:i}),(0,le.jsx)("div",{style:o.subtitle,title:n,children:n})]})]})}var kc=()=>n(177711);function Tc({spaceStore:e,requests:t,requestType:n,domainFilterValues:s,internalDomains:o}){const r=(0,a().v3)(),[c,u]=(0,i.useState)(ac),[p,g]=(0,i.useState)({column:Cc,sortAscending:!0}),m=(0,l().K8)((()=>kc().A.state.searchQuery),[]),[h,y]=(0,i.useState)([]),{rows:b,hasMore:S}=function({spaceStore:e,requestType:t,requests:n,searchQuery:i,domainFilters:s=[],internalDomains:o=[],limit:a,selectedRowIds:r,sortState:d}){const c=(0,l().K8)((()=>n.map((n=>{const i=J().L.createChildStore(e,{table:R().oo,id:n.forActor.id});return{id:n.accessRequest.id,spaceStore:e,isClickable:!1,request:n,requestType:t,email:i.getEmail(),shouldDisableInteraction:r.includes(n.accessRequest.id)}}))),[e,t,n,r]),u=(0,un().oE)(s),p=c.filter((e=>{var t;const n=e.email?(0,tc().zN)(e.email):void 0,s=(0,er().C7)(e.email,o);return!(i&&(null===(t=e.email)||void 0===t||!t.includes(i)))&&(!(u.length>0)||u.some((e=>"other"===e?!s:n===e)))})),g=function(e,{sortAscending:t}){const n=(0,un().Ul)(e,(e=>e.email));t||n.reverse();return n}(p,d),m=g.length>a;return{rows:g.slice(0,a),hasMore:m}}({spaceStore:e,requestType:n,requests:t,domainFilters:(0,un().oE)(s),internalDomains:o,searchQuery:m,limit:c,sortState:p,selectedRowIds:h}),x=(0,i.useMemo)((()=>t.filter((e=>h.includes(e.accessRequest.id)))),[t,h]),[M,A]=(0,i.useState)(!1),[j,w]=(0,i.useState)(void 0),I=!b.some((e=>h.includes(e.id))),k=(0,i.useCallback)((async()=>{A(!0),fd().jR(r,{from:`${n}_request`,button_name:"bulk_approve",count:x.length});const t=await Dc({environment:r,spaceStore:e,requests:x.map((e=>e.accessRequest)),requestType:n,status:"approved"});A(!1),t&&y([])}),[r,e,x,n]),T=(0,i.useCallback)((()=>{fd().jR(r,{from:`${n}_request`,button_name:"bulk_decline",count:x.length}),w(x)}),[r,n,w,x]),C=(0,i.useCallback)((()=>w(void 0)),[w]),_=function({requestType:e,onClickApprove:t,onClickDecline:n}){return"member"===e?[Cc,_c,Bc,Rc({onClickApprove:t,onClickDecline:n})]:[Cc,Pc,Bc,Rc({onClickApprove:t,onClickDecline:n})]}({requestType:n,onClickApprove:t=>Dc({environment:r,spaceStore:e,requests:[t.accessRequest],requestType:n,status:"approved"}),onClickDecline:e=>w([e])}),P=(0,d().IS)((()=>({container:{paddingBottom:30},headerContainer:{display:"flex",justifyContent:"space-between"},titleContainer:{display:"flex",alignItems:"center",gap:6,alignSelf:"stretch",fontSize:"14px",fontStyle:"normal",fontWeight:510,minHeight:30,paddingTop:10},titleNumber:{color:Mt().Tj.text.tertiary},actionsContainer:{display:"flex",borderRadius:6,border:`1px solid ${Mt().Tj.border.primary}`,boxShadow:"0px 2px 12px 0px rgba(29, 27, 22, 0.06)"},actionLeftButton:{borderStartStartRadius:4,borderStartEndRadius:0,borderEndEndRadius:0,borderEndStartRadius:4,paddingInlineStart:10,paddingInlineEnd:0,height:30},buttonContainerApprove:{display:"flex",paddingTop:0,paddingInlineEnd:12,paddingBottom:0,paddingInlineStart:0,justifyContent:"center",alignItems:"center",gap:4,alignSelf:"stretch",color:Mt().Tj.blue.text.accentPrimary},buttonContainerDecline:{display:"flex",paddingTop:0,paddingInlineEnd:12,paddingBottom:0,paddingInlineStart:10,justifyContent:"center",alignItems:"center",gap:4,alignSelf:"stretch",color:Mt().Tj.text.secondary},buttonIcon:{width:20,height:20,paddingTop:1,flexDirection:"column",justifyContent:"center",alignItems:"center",gap:10},buttonText:{fontSize:14,fontWeight:510},buttonDivider:{width:1,background:Mt().Tj.border.secondary},actionRightButton:{borderStartStartRadius:0,borderStartEndRadius:4,borderEndEndRadius:4,borderEndStartRadius:0,paddingInlineStart:0,paddingInlineEnd:0,height:30},noRowContainer:{display:"flex",height:32,padding:"0px 4px",alignItems:"center",borderBottom:`1px solid ${Mt().Tj.border.primary}`},noRowText:{color:Mt().Tj.text.secondary,fontSize:14,fontWeight:400,textAlign:"center"}})),[]),B=function(e){return(0,i.useMemo)((()=>({...(0,Ae().rC)({columnRenderInfo:e,containerMarginTop:0})})),[e])}(_);return 0===t.length?null:(0,le.jsxs)("div",{style:P.container,children:[(0,le.jsxs)("div",{style:P.headerContainer,children:[(0,le.jsxs)("div",{style:P.titleContainer,children:[(0,le.jsx)("div",{children:(0,le.jsx)(v().sA,{id:"peopleSectionMembersTab.memberRequests.title",defaultMessage:"Requests"})}),(0,le.jsx)("span",{style:P.titleNumber,children:t.length})]}),h.length>0&&!I?(0,le.jsxs)("div",{style:P.actionsContainer,children:[(0,le.jsx)(ec().p,{style:P.actionLeftButton,onClick:k,isLoading:M,children:(0,le.jsxs)("div",{style:P.buttonContainerApprove,children:[(0,le.jsx)("div",{style:P.buttonIcon,children:(0,le.jsx)(f().I,{icon:ic})}),(0,le.jsx)("div",{style:P.buttonText,children:(0,le.jsx)(v().sA,{id:"spaceSettings.peopleSection.requestsTable.bulkApprove",defaultMessage:"Approve {numberOfRequests, plural, one {1 request} other {{numberOfRequests} requests}}",values:{numberOfRequests:h.length}})})]})}),(0,le.jsx)("div",{style:P.buttonDivider}),(0,le.jsx)(ec().p,{style:P.actionRightButton,onClick:T,isLoading:!1,children:(0,le.jsxs)("div",{style:P.buttonContainerDecline,children:[(0,le.jsx)("div",{style:P.buttonIcon,children:(0,le.jsx)(f().I,{icon:oc})}),(0,le.jsx)("div",{style:P.buttonText,children:(0,le.jsx)(v().sA,{id:"spaceSettings.peopleSection.requestsTable.bulkDecline",defaultMessage:"Decline"})})]})})]}):void 0]}),(0,le.jsx)("div",{style:{marginTop:4},children:(0,le.jsx)(Ae().WE,{allowHorizontalScroll:!0,setStickyHeaderRow:!0,maxHeight:500,columnRenderInfo:_,rows:b,showRowBorders:!0,hideHeaderRowPadding:!0,sortState:p,onSortStateChanged:g,renderNoRowsComponent:()=>(0,le.jsx)("div",{style:P.noRowContainer,children:(0,le.jsx)("div",{style:P.noRowText,children:(0,le.jsx)(v().sA,{id:"peopleSectionRequestTable.emptySearch",defaultMessage:"No search results"})})}),styles:B,getStyleForRow:e=>{if(e.shouldDisableInteraction)return{backgroundColor:"rgba(35, 131, 226, 0.07)"}},loadMoreMethod:S?{type:"button",onLoadMore:()=>u(c+ac)}:void 0,multiselect:t.length>0?{header:{isDisabled:0===b.length,isSelected:h.length>0&&h.length===b.length,onClick:()=>{h.length===b.length?(y([]),fd().Y1(r,{from:`${n}_request`,action:"deselect_all",row_count:h.length})):(y(b.map((e=>e.id))),fd().Y1(r,{from:`${n}_request`,action:"select_all",row_count:b.length}))}},row:{getDisabledState:e=>!1,getSelectedState:e=>h.includes(e.id),onClick:e=>{y((t=>t.includes(e.id)?(fd().Y1(r,{from:`${n}_request`,action:"deselect_row",row_count:1}),t.filter((t=>t!==e.id))):(fd().Y1(r,{from:`${n}_request`,action:"select_row",row_count:1}),t.concat(e.id))))}}}:void 0})}),(0,le.jsx)(cc,{isModalOpen:(0,rt().O9)(j),requestType:n,requests:j??[],handleClickDecline:async t=>{await Dc({environment:r,spaceStore:e,requests:t.map((e=>e.accessRequest)),requestType:n,status:"rejected"})&&y([]),w(void 0)},handleClickDismiss:C})]})}const Cc={id:"user",headerTitle:(0,le.jsx)("div",{style:{fontSize:14},children:(0,le.jsx)(v().sA,{id:"peopleSectionRequestsTable.user",defaultMessage:"User"})}),renderCell:e=>(0,le.jsx)(Ic,{request:e.request,spaceStore:e.spaceStore}),widthData:{width:219},sortable:!0},_c={id:"teamspaces",headerTitle:(0,le.jsx)("div",{style:{paddingInlineStart:8,fontSize:14},children:(0,le.jsx)(v().sA,{id:"peopleSectionRequestsTable.teamspaces",defaultMessage:"Teamspaces"})}),renderCell:e=>(0,le.jsx)(wc,{spaceStore:e.spaceStore,request:e.request}),widthData:{width:175},sortable:!1},Pc={id:"pages",headerTitle:(0,le.jsx)("div",{style:{paddingInlineStart:8,fontSize:14,minWidth:175,textAlign:"start"},children:(0,le.jsx)(v().sA,{id:"peopleSectionRequestsTable.pages",defaultMessage:"Access"})}),renderCell:e=>(0,le.jsx)(jc,{request:e.request,spaceStore:e.spaceStore,shouldDisableInteraction:e.shouldDisableInteraction}),widthData:{width:175},sortable:!1},Bc={id:"requestBy",headerTitle:(0,le.jsx)("div",{style:{paddingInlineStart:8,fontSize:14,minWidth:160,textAlign:"start"},children:(0,le.jsx)(v().sA,{id:"peopleSectionRequestsTable.requestBy",defaultMessage:"Requested by"})}),renderCell:e=>(0,le.jsx)(mc,{request:e.request,shouldDisableInteraction:e.shouldDisableInteraction,requestType:e.requestType}),widthData:{width:120},sortable:!1};function Rc({onClickApprove:e,onClickDecline:t}){return{id:"actions",headerTitle:(0,le.jsx)("div",{style:{minWidth:155}}),renderCell:n=>(0,le.jsx)(rc,{request:n.request,shouldDisableInteraction:n.shouldDisableInteraction,requestType:n.requestType,handleApprove:e,handleDecline:t}),widthData:{width:100},sortable:!1}}async function Dc({environment:e,spaceStore:t,requests:n,requestType:i,status:s}){if(0===n.length)return!0;let o;if("member"===i){const i=n.filter((e=>"guest_invite_request"!==e.getType())),a=n.filter((e=>"guest_invite_request"===e.getType())),r=await b().p4({environment:e,store:t,requests:i,status:s,from:"requests_center"}),l=await b().KB({environment:e,store:t,requests:a,status:s,from:"requests_center"});o={failedUsers:r.failedUsers.concat(l.failedUsers),resolvedUsers:r.resolvedUsers.concat(l.resolvedUsers)}}else"guest"===i?o=await b().aV({environment:e,requests:n,status:s,from:"requests_center"}):(0,rt().HB)(i);const a=function({requestType:e,result:{resolvedUsers:t,failedUsers:n},status:i}){if("guest"===e&&"approved"===i&&t.length>0)return{label:(0,le.jsx)(v().sA,{id:"PeopleSectionRequestsTable.bulkApproveToast.guests",defaultMessage:"Approved {numberOfSuccesses, plural, one {guest request for {userEmail}} other {{numberOfSuccesses} guest requests}}",values:{numberOfSuccesses:t.length,userEmail:t[0].getEmail()}})};if("guest"===e&&"approved"===i&&n.length>0)return{label:(0,le.jsx)(v().sA,{id:"PeopleSectionRequestsTable.bulkApproveToast.guests.failed",defaultMessage:"Failed approve {numberOfRequests, plural, one {guest request for {userEmail}} other {{numberOfRequests} guest requests}}, please try again.",values:{numberOfRequests:n.length,userEmail:n[0].getEmail()}})};if("guest"===e&&"rejected"===i&&t.length>0)return{label:(0,le.jsx)(v().sA,{id:"PeopleSectionRequestsTable.bulkDeclineToast.guests.success",defaultMessage:"Declined {numberOfSuccesses, plural, one {guest request for {userEmail}} other {{numberOfSuccesses} guest requests}}",values:{numberOfSuccesses:t.length,userEmail:t[0].getEmail()}})};if("guest"===e&&"rejected"===i&&n.length>0)return{label:(0,le.jsx)(v().sA,{id:"PeopleSectionRequestsTable.bulkDeclineToast.guests.failed",defaultMessage:"Failed decline {numberOfSuccesses, plural, one {guest request for {userEmail}} other {{numberOfSuccesses} guest requests}}, please try again.",values:{numberOfSuccesses:n.length,userEmail:n[0].getEmail()}})};if("member"===e&&"approved"===i&&t.length>0)return{label:(0,le.jsx)(v().sA,{id:"PeopleSectionRequestsTable.bulkApproveToast.members.success",defaultMessage:"Approved {numberOfRequests, plural, one {member request for {userEmail}} other {{numberOfRequests} member requests}}",values:{numberOfRequests:t.length,userEmail:t[0].getEmail()}})};if("member"===e&&"approved"===i&&n.length>0)return{label:(0,le.jsx)(v().sA,{id:"PeopleSectionRequestsTable.bulkApproveToast.members.failed",defaultMessage:"Failed to approve {numberOfRequests, plural, one {member request for {userEmail}} other {{numberOfRequests} member requests}}, please try again.",values:{numberOfRequests:n.length,userEmail:n[0].getEmail()}})};if("member"===e&&"rejected"===i&&t.length>0)return{label:(0,le.jsx)(v().sA,{id:"PeopleSectionRequestsTable.bulkDeclineToast.members.success",defaultMessage:"Declined {numberOfRequests, plural, one {member request for {userEmail}} other {{numberOfRequests} member requests}}",values:{numberOfRequests:t.length,userEmail:t[0].getEmail()}})};if("member"===e&&"rejected"===i&&n.length>0)return{label:(0,le.jsx)(v().sA,{id:"PeopleSectionRequestsTable.bulkDeclineToast.members.failed",defaultMessage:"Failed to decline {numberOfRequests, plural, one {member request for {userEmail}} other {{numberOfRequests} member requests}}, please try again.",values:{numberOfRequests:n.length,userEmail:n[0].getEmail()}})};return}({requestType:i,result:o,status:s});return a&&Jd().D6(a),0===o.failedUsers.length}var Lc=()=>n(874832),Ec=()=>n(911259),Oc=()=>n(35588),Nc=()=>n(848538),Fc=()=>n(205224),Uc=()=>n(874099),zc=()=>n(118789),Kc=()=>n(314907),Vc=()=>n(278238),qc=()=>n(589407);class Wc extends O().Store{getInitialState(){return{isModalOpen:!1,guests:[],handleClickDecline:()=>{}}}}const Gc=new Wc;function Hc({userId:e,spaceStore:t,shouldDisableInteraction:n}){const{environment:s,styles:o,isSubscribed:r,handleConvertToMemberClick:c,handleRemoveClick:u}=function({userId:e,spaceStore:t,shouldDisableInteraction:n}){const s=(0,d().eP)(),o=(0,d().IS)((()=>({container:{width:"100%",display:"flex",justifyContent:"flex-end",opacity:n?.5:1},button:{display:"flex",width:24,height:24,justifyContent:"center",alignItems:"center",gap:10,paddingInlineStart:0,paddingInlineEnd:0},upgradeButton:{paddingTop:0,paddingBottom:0,width:257},removeMenuDivider:{paddingTop:4,paddingBottom:4,borderTop:`1px solid ${Mt().Tj.border.secondary}`},removeButton:{width:257,paddingTop:0,paddingBottom:0,color:Vc().l8[s].red}})),[n,s]),r=(0,l().K8)((()=>t.id),[t]),c=(0,Kc().E)({spaceId:r}),u=(0,a().v3)(),p=(0,i.useCallback)((()=>{const n=J().L.createChildStore(t,{table:R().oo,id:e}),i=c?"member":"owner";Fc().P({environment:u,guestUserStore:n,membershipType:i,spaceStore:t,origin:"guest_pages_popup"})}),[c,t,u,e]),g=(0,i.useCallback)((()=>{Gc.setState({...Gc.state,isModalOpen:!0,guests:[e],handleClickDecline:()=>{fd().jR(u,{from:"guest",button_name:"confirm_in_dialog",count:1});const n=J().L.createChildStore(t,{table:R().oo,id:e});Fc().D({environment:u,guestUserStore:n,spaceStore:t})}})}),[t,u,e]);return{environment:u,styles:o,isSubscribed:c,handleConvertToMemberClick:p,handleRemoveClick:g}}({userId:e,spaceStore:t,shouldDisableInteraction:n});return(0,le.jsx)("div",{style:o.container,children:(0,le.jsx)(Kt().A,{popupType:Kt().z.Popup,renderOrigin:e=>(0,le.jsx)(pi().p,{style:o.button,...e,children:(0,le.jsx)(f().I,{icon:qc().ellipsisIcon,colorVariant:"secondary"})}),onClick:()=>{fd().jR(s,{from:"guest",button_name:"actions"})},disabled:n,render:()=>(0,le.jsx)("div",{children:(0,le.jsx)(Gt().A,{type:Gt().O.Vertical,initialFocus:void 0,sections:[{key:"upgrade",render:e=>(0,le.jsx)(Ht().A,{...e}),items:[{key:"upgrade",render:e=>(0,le.jsx)(Wt().A,{...e,buttonStyle:o.upgradeButton,icon:(0,le.jsx)(f().I,{icon:Ec().arrowInCircleUpIcon}),title:(0,le.jsx)(v().sA,{id:"peopleSectionguestsTab.upgradeToAdmin",defaultMessage:"Upgrade to {isSubscribed, select, true {member} other {admin}}",values:{isSubscribed:r}})}),action:()=>{c(),fd().jR(s,{from:"guest",button_name:"upgrade"})}}]},{key:"remove",render:e=>(0,le.jsx)(Ht().A,{...e,style:o.removeMenuDivider}),items:[{key:"remove",render:e=>(0,le.jsx)(Wt().A,{...e,buttonStyle:o.removeButton,icon:(0,le.jsx)(f().I,{icon:Oc()._}),title:(0,le.jsx)(v().sA,{id:"peopleSectionguestsTab.remove",defaultMessage:"Remove from workspace"})}),action:()=>{u(),fd().jR(s,{from:"guest",button_name:"remove"})}}]}]})})})})}function Yc(){const{isModalOpen:e,handleClickDecline:t,handleDismiss:n,guests:s,firstGuestName:o}=function(){const{isModalOpen:e,guests:t,handleClickDecline:n}=(0,l().K8)((()=>{const{isModalOpen:e,guests:t,handleClickDecline:n}=Gc.state;return{isModalOpen:e,guests:t,handleClickDecline:n}}),[]),s=(0,v().tz)(),o=(0,l().K8)((()=>{const{sidebarSpaceStore:e}=Ve().default.state;if(0===t.length||!e)return;return J().L.createChildStore(e,{table:R().oo,id:t[0]}).getDisplayName(s)}),[t,s]),r=(0,a().v3)(),d=(0,i.useCallback)((()=>{Gc.reset(),fd().jR(r,{from:"guest",button_name:"confirm_in_dialog",count:t.length})}),[r,t]);return{isModalOpen:e,guests:t,firstGuestName:o,handleClickDecline:n,handleDismiss:d}}();return 0===s.length?null:(0,le.jsx)(dc,{isModalOpen:e,handleDismiss:n,handleConfirm:t,title:(0,le.jsx)(v().sA,{id:"GuestBulkRemoveConfirmationDialog.title",defaultMessage:"Remove {numberOfGuests, plural, one {{firstGuestName}} other {{numberOfGuests} guests}} from the workspace?",values:{numberOfGuests:s.length,firstGuestName:o}}),description:(0,le.jsx)(v().sA,{id:"GuestBulkRemoveConfirmationDialog.description",defaultMessage:"They will lose access to all shared pages. To add them as a guest in the future, a request must be submitted, or an admin must invite them."}),ctaText:(0,le.jsx)(v().sA,{id:"GuestBulkRemoveConfirmationDialog.remove",defaultMessage:"Remove"})})}function $c({userId:e,guestPageIds:t,shouldDisableInteraction:n}){return(0,le.jsx)(Ac,{pageIds:t,guestUserId:e,shouldDisableInteraction:n,from:"guest"})}var Qc=()=>n(299895);function Zc({spaceStore:e,domainFilterValues:t,internalDomains:n}){const s=sr({spaceStore:e}),o=(0,wd().r1)({spaceStore:e}),r=(0,d().IS)((()=>({titleContainer:{display:"flex",alignItems:"center",gap:6,alignSelf:"stretch",fontSize:"14px",fontStyle:"normal",fontWeight:510,height:32},emptyMessage:{display:"flex",height:32,padding:"0px 4px",alignItems:"center",borderBottom:`1px solid ${Mt().Tj.border.primary}`},headerContainer:{display:"flex",justifyContent:s&&o?"space-between":"flex-end"},actionsContainer:{display:"flex",borderRadius:6,border:`1px solid ${Mt().Tj.border.primary}`,boxShadow:"0px 2px 12px 0px rgba(29, 27, 22, 0.06)"},actionLeftButton:{borderStartStartRadius:4,borderStartEndRadius:0,borderEndEndRadius:0,borderEndStartRadius:4,paddingInlineStart:10,paddingInlineEnd:12,height:30},buttonDivider:{width:1,background:Mt().Tj.border.secondary},actionRightButton:{borderStartStartRadius:0,borderStartEndRadius:4,borderEndEndRadius:4,borderEndStartRadius:0,paddingInlineStart:10,paddingInlineEnd:12,height:30}})),[s,o]),c=(0,l().K8)((()=>kc().A.state.searchQuery),[]),[u,p]=(0,i.useState)({by:Xc.id,asc:!1}),g=(0,i.useMemo)((()=>({field:"user"===u.by?"name_normalized":"type",direction:u.asc?"asc":"desc"})),[u]),m=(0,zc().n)({query:c??"",sort:g,filter:Nc().nc,limit:30}),f=(0,l().K8)((()=>{var e;return null==m||null===(e=m.rowsStore.state.rows)||void 0===e?void 0:e.filter((e=>{var i;if(void 0===t||0===t.length)return!0;const s=null===(i=e.email)||void 0===i?void 0:i.split("@")[1];return null==t?void 0:t.some((e=>"other"===e?!(null!=n&&n.some((e=>e.url===s))):s===e))}))}),[t,n,m]),h=(0,wd().k4)({spaceStore:e}),y=(0,a().v3)(),[b,S]=(0,i.useState)(new Set),x=(0,i.useMemo)((()=>{const e=void 0!==f&&b.size>0&&b.size===f.length;return h?{header:{isDisabled:void 0===f||0===f.length,isSelected:e,onClick:()=>{void 0!==f&&(e?(S(new Set),fd().Y1(y,{from:"guests",action:"deselect_all",row_count:b.size})):(S(new Set(f.map((e=>e.id)))),fd().Y1(y,{from:"guests",action:"select_all",row_count:f.length})))}},row:{getDisabledState:()=>!1,getSelectedState:e=>b.has(e.id),onClick:e=>{S((t=>{if(t.has(e.id)){fd().Y1(y,{from:"guests",action:"deselect_row",row_count:1});const n=new Set(t);return n.delete(e.id),n}return fd().Y1(y,{from:"guests",action:"select_row",row_count:1}),new Set(t).add(e.id)}))}}}:void 0}),[h,f,b,y]),M=(0,l().K8)((()=>e.id),[e]),A=(0,Kc().E)({spaceId:M}),j=(0,i.useCallback)((()=>{fd().jR(y,{from:"guest",button_name:"bulk_upgrade",count:b.size}),b.forEach((t=>{const n=J().L.createChildStore(e,{table:R().oo,id:t}),i=A?"member":"owner";Fc().P({environment:y,guestUserStore:n,membershipType:i,spaceStore:e,origin:"guest_actions"})})),S(new Set)}),[b,y,A,e]),w=(0,i.useCallback)((()=>{fd().jR(y,{from:"guest",button_name:"bulk_remove",count:b.size}),Gc.setState({...Gc.state,isModalOpen:!0,guests:Array.from(b),handleClickDecline:()=>{fd().jR(y,{from:"guest",button_name:"confirm_in_dialog",count:b.size}),b.forEach((t=>{const n=J().L.createChildStore(e,{table:R().oo,id:t});Fc().D({environment:y,guestUserStore:n,spaceStore:e})})),S(new Set)}})}),[b,y,e]),I=!(null!=f&&f.some((e=>b.has(e.id)))),{columns:k,transformRow:T}=function({users:e,spaceStore:t,internalDomains:n,selectedGuestIds:s,environment:o,canEditMembership:a}){const[r,l]=(0,i.useState)({});(0,Ge().Yb)((async()=>{if(!e)return;if(!a)return;const n=t.id,i=e.map((e=>e.id)),s=await D().callCellCompatibleApi({eventName:"getGuestPagesForUserIds",environment:o,data:{spaceId:n,guestUserIds:i,includeRecordMap:!0},cellNavigation:{cellId:void 0,spaceId:n}});"success"===s.type&&l((e=>{const t={...e};for(const o of i){var n;t[o]=(null===(n=s.data.guestIdToPages[o])||void 0===n?void 0:n.pageIds)??[]}return t}))}),[t,o,e,a]);const d=(0,i.useCallback)((e=>{const i=e.email.split("@")[1],o=n.some((e=>e.url===i));if("page_guest"===((0,md().dp)(t,e.id).getMembershipType()??e.membership_type))return{id:e.id,spaceStore:t,shouldDisableInteraction:s.has(e.id),guestPageIds:r[e.id],isInternalGuest:o}}),[t,n,r,s]),c=(0,i.useMemo)((()=>a?[Xc,Jc,eu]:[Xc]),[a]);return{columns:c,transformRow:d}}({users:f,spaceStore:e,internalDomains:n,selectedGuestIds:b,environment:y,canEditMembership:h});return(0,le.jsxs)(le.Fragment,{children:[(0,le.jsxs)("div",{style:r.headerContainer,children:[s&&o?(0,le.jsx)("div",{style:r.titleContainer,children:(0,le.jsx)("span",{children:(0,le.jsx)(v().sA,{id:"peopleSectionguestsTab.activeguests.title",defaultMessage:"Active"})})}):void 0,b.size>0&&!I?(0,le.jsxs)("div",{style:r.actionsContainer,children:[(0,le.jsx)(pi().p,{style:r.actionLeftButton,onClick:j,iconLeading:Ec().arrowInCircleUpIcon,colorPalette:"blue",children:(0,le.jsx)(v().sA,{id:"spaceSettings.peopleSection.guestsTable.bulkUpgrade",defaultMessage:"Upgrade {numberOfRequests, plural, one {1 guest} other {{numberOfRequests} guests}} to {isSubscribed, select, true {member} other {admin}}",values:{numberOfRequests:b.size,isSubscribed:A}})}),(0,le.jsx)("div",{style:r.buttonDivider}),(0,le.jsx)(pi().p,{style:r.actionRightButton,onClick:w,iconLeading:Oc()._,colorPalette:"red",children:(0,le.jsx)(v().sA,{id:"spaceSettings.peopleSection.guestsTable.bulkDecline",defaultMessage:"Remove from workspace"})})]}):void 0]}),(0,le.jsxs)("div",{style:{marginTop:s&&o?4:-1,height:"100%"},children:[(0,le.jsx)(Uc().M,{columns:k,rows:f,listSource:m,transformRow:T,sort:u,onSortChange:p,estimatedRowHeight:42,allowHorizontalScroll:!0,renderEmpty:()=>(0,le.jsx)(we().A,{isSmall:!0,style:r.emptyMessage,children:(0,le.jsx)(v().sA,{id:"peopleSectionGuestsTab.emptySearch",defaultMessage:"No search results"})}),multiselect:x}),(0,le.jsx)(Yc,{})]})]})}const Xc={id:"user",headerTitle:(0,le.jsx)("div",{style:{fontSize:14},children:(0,le.jsx)(v().sA,{id:"peopleSectionGuestsTab.user",defaultMessage:"User"})}),renderCell:e=>(0,le.jsx)(Qc().A,{userId:e.id,spaceStore:e.spaceStore,isInternalGuest:e.isInternalGuest}),widthData:{widthPercent:35,minWidth:250},sortable:!0},Jc={id:"access",headerTitle:(0,le.jsx)("div",{style:{fontSize:14},children:(0,le.jsx)(v().sA,{id:"peopleSectionGuestsTab.access",defaultMessage:"Access"})}),headerCellPadding:"0 0 0 8px",renderCell:e=>void 0!==e.guestPageIds?(0,le.jsx)($c,{userId:e.id,guestPageIds:e.guestPageIds,shouldDisableInteraction:e.shouldDisableInteraction}):(0,le.jsx)(Lc().P,{style:{width:60,height:12,borderRadius:4,marginInlineStart:8}}),widthData:{widthPercent:55,minWidth:180},sortable:!1},eu={id:"actions",headerTitle:void 0,renderCell:e=>(0,le.jsx)(Hc,{userId:e.id,spaceStore:e.spaceStore,shouldDisableInteraction:e.shouldDisableInteraction}),widthData:{widthPercent:10,minWidth:50},sortable:!1},tu=(0,v().YK)({updatingPermissions:{id:"spacePermissionsSettings.updatePermissionsMessage",defaultMessage:"Updating…"}});function nu(){Dd().m({message:tu.updatingPermissions})}function iu(){Dd().V()}function su({spaceStore:e,spacePermissionsSettingsStore:t}){const[n,s]=(0,i.useState)(),o=(0,a().v3)(),r=(0,Xo().r)()??0,d=(0,l().K8)((()=>{const t=Ed().A.getData(o,{spaceId:e.id});return t?t.filter((e=>e.hasGuests)).map((e=>e.domain)):[]}),[o,e]),c=sr({spaceStore:e}),u=(0,wd().r1)({spaceStore:e}),p=ir({spaceStore:e,requestType:"guest"});return ar({requestType:"guest",spaceStore:e}),(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)($d,{spaceStore:e,internalDomains:d,domainFilterValues:n,setDomainFilterValues:s}),c&&u?(0,le.jsx)(Tc,{requests:p,spaceStore:e,requestType:"guest",domainFilterValues:n,internalDomains:d}):void 0,r>0?(0,le.jsx)(Zc,{spaceStore:e,domainFilterValues:n??[],internalDomains:d}):(0,le.jsx)("div",{children:(0,le.jsx)(ou,{spacePermissionsSettingsStore:t})})]})}function ou({spacePermissionsSettingsStore:e}){const t=(0,d().IS)((()=>({container:{marginTop:32,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",minHeight:296,width:"100%",border:`1px dashed ${Mt().Tj.palette.gray[300]}`,borderRadius:4,padding:16,gap:12},icon:{width:24,height:24}})),[]),n=(0,l().O$)(Ve().AppStoreSidebarSpaceStore),i=(0,bd().J)();return(0,le.jsxs)("div",{style:t.container,children:[(0,le.jsx)(Pd().Q,{iconGroup:Bd,variantName:"fill",style:t.icon}),(0,le.jsx)(We().D,{styleKey:"bodyMedium",children:(0,le.jsx)(v().sA,{id:"spaceSettings.people.guestsTab.noGuests",defaultMessage:"No guests yet"})}),i?(0,le.jsx)(au,{spaceStore:n,spacePermissionsSettingsStore:e}):void 0]})}function au(e){const{spaceStore:t,spacePermissionsSettingsStore:n}=e,i=(0,d().IS)((()=>({origin:{padding:"12px",height:32},importListButton:{height:28,borderRadius:4,border:void 0,width:"100%"},importListButtonContainer:{padding:"0 6px",alignItems:"center"}})),[]),s=(0,a().v3)();if(!t)return null;const o=(0,Ld().A)({onInviteClick:nu,onInviteComplete:iu,buttonStyle:i.importListButton,buttonContainerStyle:i.importListButtonContainer,spacePermissionsSettingsStore:n,shouldAddMembers:!1});return(0,le.jsx)(Kt().A,{popupType:_d().n.Popup,alignmentToOrigin:"center",placementToOrigin:"bottom",render:()=>(0,le.jsx)(Od().A,{importListItems:o}),renderOrigin:e=>(0,le.jsx)(_t().A,{style:i.origin,...e,onClick:()=>{e.onClick(),Rd().V(s,{source:"guests_tab"})},children:(0,le.jsx)(v().sA,{id:"spaceSettings.people.guestsTab.importContacts",defaultMessage:"Import contacts"})})})}var ru=()=>n(238838),lu=()=>n(569397),du=()=>n(97835);function cu({isPrimary:e,leftIcon:t,rightIcon:n,onClick:i,content:s,style:o,titleStyle:a}){const r=(0,d().IS)((()=>({container:{display:"flex",width:"100%",padding:8,justifyContent:"flex-start",alignItems:"center",borderRadius:8,background:Mt().Tj.background.secondary,...o},iconContainer:{display:"flex",width:20,height:20,paddingTop:1,flexDirection:"column",alignItems:"center",justifyContent:"center",gap:10},title:{display:"flex",fontSize:14,fontWeight:500,color:e?Mt().Tj.text.primary:Mt().Tj.text.secondary,paddingInlineStart:6,paddingInlineEnd:2,height:18,cursor:i?"pointer":"default",width:"100%",...a},ctaIconContainer:{display:"flex",width:16,height:16,paddingTop:1,flexDirection:"column",alignItems:"center",gap:10,paddingInlineStart:2,paddingInlineEnd:0,cursor:i?"pointer":"default"}})),[i,e,o,a]);return(0,le.jsxs)("div",{style:r.container,children:[t?(0,le.jsx)("div",{style:r.iconContainer,onClick:i,children:t}):void 0,(0,le.jsx)("div",{style:r.title,onClick:i,children:s}),n?(0,le.jsx)("div",{style:r.ctaIconContainer,onClick:i,children:n}):void 0]})}function uu({currentTab:e}){const t=(0,d().IS)((()=>({icon:{fontSize:14,fontWeight:510,cursor:"pointer"},ctaIcon:{fontSize:12,fontWeight:510}})),[]),n=(0,a().v3)(),s=(0,i.useCallback)((()=>{Qe().Ay.setState({...Qe().Ay.state,currentTab:"security",defaultSubtab:"members_and_guests"}),fd().pf(n,{current_tab:e})}),[n,e]);return(0,i.useEffect)((()=>{fd().W2(n,{current_tab:e})}),[n,e]),(0,le.jsx)(cu,{leftIcon:(0,le.jsx)(f().I,{icon:du().inviteMemberIcon,colorVariant:"secondary",style:t.icon}),content:(0,le.jsx)(v().sA,{id:"PeopleSectionSecurityBanner.title",defaultMessage:"Some invite settings have moved, make changes in Security tab"}),rightIcon:(0,le.jsx)(f().I,{icon:lu().arrowStraightRightSmallIcon,colorVariant:"secondary",style:t.ctaIcon}),onClick:s})}var pu=()=>n(566910),gu=()=>n(406533);const mu=3;function fu({spaceStore:e,internalDomains:t}){const{environment:n,tableStyles:s,sortState:o,setSortState:r,selectedRowIds:c,setSelectedRowIds:u,rows:p,searchQuery:g,canEditMembership:h,columnRenderInfo:y,guestsCount:b,onClickApprove:S,isSubscribed:x}=function({spaceStore:e,internalDomains:t}){const n=(0,a().v3)(),s=(0,A().T)(),o=(0,wd().k4)({spaceStore:e}),r=(0,i.useMemo)((()=>o?[vu,bu,Su]:[vu]),[o]),d=(0,i.useMemo)((()=>({...(0,Ae().rC)({columnRenderInfo:r,containerMarginTop:0})})),[r]),c=(0,l().K8)((()=>r[0]),[r]),[u,p]=(0,i.useState)({column:c,sortAscending:!0}),[g,f]=(0,i.useState)([]),h=(0,v().tz)(),y=(0,l().K8)((()=>kc().A.state.searchQuery),[]),b=(0,l().K8)((()=>e.id),[e]),S=(0,Kc().E)({spaceId:b}),[x,M]=(0,i.useState)([]),[I,k]=(0,i.useState)(new Set),[T,C]=(0,i.useState)({}),_=(0,l().K8)((()=>w().i({userId:s,spaceId:e.id,debugFrom:"useSuggestionsTableData"})),[s,e.id]),P=(0,i.useRef)(void 0);(0,Ge().Yb)((async()=>{var i;if(!_)return;P.current&&P.current.abort(),P.current=new AbortController;const s=j().default.getConfigKey("email_alias_migration","mode"),o=await D().callApi({eventName:"listUsers",environment:n,data:{cursor:void 0,membershipFilter:"guests",limit:mu+I.size,sort:"name_normalized",sortDirection:"asc",query:y??"",spaceId:e.id,includeDomains:t.map((e=>e.url)),includeAliasSearch:(0,te().K)(s)},abortSignal:null===(i=P.current)||void 0===i?void 0:i.signal});if(P.current=void 0,"success"===o.type){const e=o.data.users;M(e.filter((e=>!I.has(e.id))).slice(0,mu).map((e=>e.id)))}}),[n,t,y,_,e.id,I]);const B=(0,l().K8)((()=>{if(_)return[];const e=m().subscriptionDataStoreInstance.state;return e?(0,ws().oe)(e).map((e=>e.userId)):[]}),[_]);(0,Ge().Yb)((async()=>{const t=_?x:B,i=await D().callCellCompatibleApi({eventName:"getGuestPagesForUserIds",environment:n,data:{spaceId:e.id,guestUserIds:t,includeRecordMap:!0},cellNavigation:{cellId:void 0,spaceId:e.id}});"success"===i.type&&C((e=>{const n={...e};for(const o of t){var s;n[o]=(null===(s=i.data.guestIdToPages[o])||void 0===s?void 0:s.pageIds)??[]}return n}))}),[_,n,e.id,x,B]);const L=(0,l().K8)((()=>_?x.map((t=>{const n=J().L.createChildStore(e,{table:R().oo,id:t}),i=n.getEmail();return{spaceStore:e,id:t,guestPageIds:T[t],email:i,userName:n.getDisplayName(h),guestUserStore:n,shouldDisableInteraction:g.includes(t),isClickable:!1,isInternalGuest:!0,isSubscribed:S,setUpgradedGuestIds:k}})):B.map((n=>{const i=J().L.createChildStore(e,{table:R().oo,id:n}),s=i.getEmail(),o=null==s?void 0:s.split("@")[1],a=t.some((e=>e.url===o));return{spaceStore:e,id:n,guestPageIds:T[n]??[],email:s,userName:i.getDisplayName(h),guestUserStore:i,shouldDisableInteraction:g.includes(n),isClickable:!1,isInternalGuest:a,isSubscribed:S}})).filter((e=>{if(y){var t;if(!((null===(t=e.email)||void 0===t?void 0:t.includes(y))||e.userName.includes(y)))return!1}return e.isInternalGuest})).slice(0,mu)),[_,x,e,t,T,h,g,S,B,y]),E=(0,i.useCallback)((()=>{fd().jR(n,{from:"guest_suggestions",button_name:"bulk_upgrade",count:g.length}),g.forEach((t=>{const i=J().L.createChildStore(e,{table:R().oo,id:t}),s=S?"member":"owner";Fc().P({environment:n,guestUserStore:i,membershipType:s,spaceStore:e,origin:"suggested_guest_table"})})),k((e=>{const t=new Set(e);for(const n of g)t.add(n);return t})),f([])}),[g,n,S,e]),O=!L.some((e=>g.includes(e.id)));return{environment:n,tableStyles:d,sortState:u,setSortState:p,selectedRowIds:g,setSelectedRowIds:f,rows:L,searchQuery:y,isApproveButtonLoading:!1,canEditMembership:o,columnRenderInfo:r,isSubscribed:S,shouldHideActions:O,guestsCount:L.length,onClickApprove:E}}({spaceStore:e,internalDomains:t}),M=(0,v().tz)(),I=function(){const e=(0,d().IS)((()=>({suggestions:{transition:"opacity 1s",marginTop:12},suggestionsHidden:{transition:"opacity 1s",opacity:0},titleContainer:{display:"flex",alignItems:"center",gap:6,alignSelf:"stretch",fontSize:"14px",fontStyle:"normal",fontWeight:510,height:32},titleNumber:{color:Mt().Tj.text.tertiary},emptyMessage:{display:"flex",height:32,padding:"0px 4px",alignItems:"center",borderBottom:`1px solid ${Mt().Tj.border.primary}`},emptyDivider:{height:1,backgroundColor:Mt().Tj.border.secondary},headerContainer:{display:"flex",justifyContent:"space-between",alignItems:"center"},suggestionsMenu:{width:265},learnMoreMenuItem:{color:Mt().Tj.text.secondary},learnMoreSection:{paddingTop:4,paddingBottom:4,borderTop:`1px solid ${Mt().Tj.border.secondary}`},optionsContainer:{display:"flex",alignItems:"center"},actionsContainer:{display:"flex",borderRadius:6,border:`1px solid ${Mt().Tj.border.primary}`,boxShadow:"0px 2px 12px 0px rgba(29, 27, 22, 0.06)"}})),[]);return e}(),[k,T]=(0,i.useState)(!0),C=(0,i.useCallback)((()=>{(0,Ol().L)({environment:n,url:(0,ut().x)("guides.invitePerson")})}),[n]);if(0===t.length)return null;if(0===p.length)return null;if(!k)return null;const _=c.length>0;return(0,le.jsxs)("div",{style:k?I.suggestions:I.suggestionsHidden,children:[(0,le.jsxs)("div",{style:I.headerContainer,children:[(0,le.jsxs)("div",{style:I.titleContainer,children:[(0,le.jsx)("span",{children:(0,le.jsx)(v().sA,{id:"peopleSectionguestsTab.suggestions.title",defaultMessage:"Suggestions"})}),(0,le.jsx)("span",{style:I.titleNumber,children:b})]}),(0,le.jsx)("div",{style:I.optionsContainer,children:_?(0,le.jsx)("div",{style:I.actionsContainer,children:(0,le.jsx)(pi().p,{onClick:S,iconLeading:Ec().arrowInCircleUpIcon,colorPalette:"blue",children:(0,le.jsx)(v().sA,{id:"spaceSettings.peopleSection.guestsTable.bulkUpgrade",defaultMessage:"Upgrade {numberOfRequests, plural, one {1 guest} other {{numberOfRequests} guests}} to {isSubscribed, select, true {member} other {admin}}",values:{numberOfRequests:c.length,isSubscribed:x}})})}):(0,le.jsx)(Kt().A,{popupType:Kt().z.Popup,renderOrigin:e=>(0,le.jsx)(Ll().A,{icon:qc().ellipsisIcon,ariaLabel:M.formatMessage({id:"peopleSectionSuggestionsTable.ellipsisButton.ariaLabel",defaultMessage:"More"}),style:{height:24,width:24},iconStyle:{width:20,height:20},...e}),onClick:()=>{fd().jR(n,{from:"guest_suggestions",button_name:"upgrade"})},render:()=>(0,le.jsx)("div",{children:(0,le.jsx)(Gt().A,{type:Gt().O.Vertical,initialFocus:void 0,style:I.suggestionsMenu,sections:[{key:"hide_suggestions",render:e=>(0,le.jsx)(Ht().A,{...e}),items:[{key:"hide_suggestions",render:e=>(0,le.jsx)(Wt().A,{...e,icon:(0,le.jsx)(f().I,{icon:pu().e}),title:(0,le.jsx)(v().sA,{id:"peopleSectionguestsTab.hideSuggestions",defaultMessage:"Hide Suggestions"})}),action:()=>{T(!1),fd().jR(n,{from:"guest_suggestions",button_name:"hide_suggestions"})}}]},{key:"learn_more",render:e=>(0,le.jsx)(Ht().A,{...e,style:I.learnMoreSection}),items:[{key:"learn_more",render:e=>(0,le.jsx)(Wt().A,{...e,icon:(0,le.jsx)(f().I,{icon:gu().questionMarkCircleIcon}),title:(0,le.jsx)(v().sA,{id:"peopleSectionguestsTab.learnMore",defaultMessage:"Learn more"}),style:I.learnMoreMenuItem}),action:()=>{C(),fd().jR(n,{from:"guest_suggestions",button_name:"suggestions_learn_more"})}}]}]})})})})]}),(0,le.jsx)("div",{style:{marginBottom:36,marginTop:4},children:(0,le.jsx)(Ae().WE,{allowHorizontalScroll:h,setStickyHeaderRow:!0,columnRenderInfo:y,rows:xu(p,o),showRowBorders:!0,hideHeaderRowPadding:!0,sortState:o,onSortStateChanged:r,renderNoRowsComponent:()=>(0,le.jsx)(we().A,{isSmall:!0,style:I.emptyMessage,children:g?(0,le.jsx)(v().sA,{id:"peopleSectionGuestsTab.emptySearch",defaultMessage:"No search results"}):(0,le.jsx)(v().sA,{id:"peopleSectionGuestsTab.emptyRow",defaultMessage:"No guests"})}),styles:s,multiselect:h?{header:{isDisabled:0===p.length,isSelected:c.length>0&&c.length===p.length,onClick:()=>{c.length===p.length?(u([]),fd().Y1(n,{from:"guest_suggestions",action:"deselect_all",row_count:c.length})):(u(p.map((e=>e.id))),fd().Y1(n,{from:"guest_suggestions",action:"select_all",row_count:p.length}))}},row:{getDisabledState:()=>!1,getSelectedState:e=>c.includes(e.id),onClick:e=>{u((t=>t.includes(e.id)?(fd().Y1(n,{from:"guest_suggestions",action:"deselect_row",row_count:1}),t.filter((t=>t!==e.id))):(fd().Y1(n,{from:"guest_suggestions",action:"select_row",row_count:1}),t.concat(e.id))))}}}:void 0})})]})}function hu(){return(0,le.jsx)("div",{children:(0,le.jsx)(v().sA,{id:"peopleSectionguestsTab.suggestions.reason.approvedEmailDomain",defaultMessage:"Approved email domain"})})}function yu({spaceStore:e,upgradeMember:t,guestUserStore:n,disabled:s}){const o=(0,d().eP)(),r=(0,a().v3)(),[l,c]=(0,i.useState)(!1);return(0,le.jsx)(pi().p,{disabled:s,style:{background:Mt().Tj.blue.background.secondaryTranslucent,color:Mt().Tj.blue.text.accentPrimary,fontWeight:510,fontSize:14,borderRadius:4,paddingTop:4,paddingBottom:4,paddingInlineStart:12,paddingInlineEnd:12,marginInlineStart:24,...s&&{color:Mt().Tj.blue.text.disabled}},hoveredStyle:{background:(0,Me().i)({color:Mt().Tj.blue.background.secondaryTranslucent,mode:o})},onClick:async()=>{c(!0),fd().jR(r,{from:"guest_suggestions",button_name:"upgrade"}),await t({environment:r,spaceStore:e,guestUserStore:n}),c(!1)},isLoading:l,children:(0,le.jsx)(v().sA,{id:"spaceSettings.peopleSection.suggestionsTable.upgrade",defaultMessage:"Upgrade"})})}const vu={id:"user",headerTitle:(0,le.jsx)("div",{style:{fontSize:14},children:(0,le.jsx)(v().sA,{id:"peopleSectionGuestsTab.guest",defaultMessage:"User"})}),renderCell:e=>(0,le.jsx)(Qc().A,{userId:e.id,spaceStore:e.spaceStore,isInternalGuest:e.isInternalGuest,isForSuggestionsTable:!0}),widthData:{width:210},sortable:!0},bu={id:"access",headerTitle:(0,le.jsx)("div",{style:{paddingInlineStart:8,fontSize:14},children:(0,le.jsx)(v().sA,{id:"peopleSectionGuestsTab.access",defaultMessage:"Access"})}),renderCell:e=>(0,le.jsx)("div",{style:{display:"flex"},children:void 0!==e.guestPageIds?(0,le.jsx)($c,{userId:e.id,guestPageIds:e.guestPageIds,shouldDisableInteraction:e.shouldDisableInteraction}):(0,le.jsx)(Lc().P,{style:{width:60,height:12,borderRadius:4,marginInlineStart:8}})}),widthData:{width:120},sortable:!1},Su={id:"reason",headerTitle:(0,le.jsx)("div",{style:{fontSize:14},children:(0,le.jsx)(v().sA,{id:"peopleSectionguestsTab.suggestions.reason",defaultMessage:"Reason"})}),renderCell:e=>(0,le.jsxs)("div",{style:{display:"flex",width:"100%",justifyContent:"space-between",alignItems:"center"},children:[(0,le.jsx)(hu,{}),(0,le.jsx)(yu,{upgradeMember:async t=>{var n;await Fc().P({origin:"suggested_guest_table",membershipType:e.isSubscribed?"member":"owner",...t}),null===(n=e.setUpgradedGuestIds)||void 0===n||n.call(e,(t=>{const n=new Set(t);return n.add(e.id),n}))},spaceStore:e.spaceStore,guestUserStore:e.guestUserStore,disabled:e.shouldDisableInteraction})]}),widthData:{width:256},sortable:!1};function xu(e,{sortAscending:t}){const n=un().Ul(e,(e=>e.email));return t||n.reverse(),n}var Mu=()=>n(590977);function Au({spaceStore:e,spacePermissionsSettingsStore:t}){const n=(0,a().v3)(),i=(0,l().K8)((()=>{const t=Ed().A.getData(n,{spaceId:e.id});return(null==t?void 0:t.filter((e=>e.hasMembers)).map((e=>e.domain)))??[]}),[n,e]),s=sr({spaceStore:e}),o=(0,wd().r1)({spaceStore:e}),r=ir({spaceStore:e,requestType:"member"});ar({requestType:"member",spaceStore:e});const c=function({spaceStore:e,internalDomains:t}){const n=(0,a().v3)(),i=(0,A().T)(),[{value:s}]=(0,Ge().Yb)((async()=>{if(0===t.length)return!1;let s=!1;if(w().i({userId:i,spaceId:e.id,debugFrom:"useShouldShowSuggestions"})){const i=j().default.getConfigKey("email_alias_migration","mode"),o=await D().callApi({eventName:"listUsers",environment:n,data:{cursor:void 0,membershipFilter:"guests",limit:1,spaceId:e.id,includeDomains:t.map((e=>e.url)),includeAliasSearch:(0,te().K)(i)}});if("success"!==o.type)return!1;s=o.data.users.length>0}else{const n=m().subscriptionDataStoreInstance.state;if(!n)return!1;s=(0,ws().oe)(n).map((t=>J().L.createChildStore(e,{table:R().oo,id:t.userId}).getModel())).some((e=>(0,er().JD)(e,t)))}return e.canEditMembership()&&s&&"enterprise"!==e.getSubscriptionTier()}),[n,i,t,e]);return s??!1}({spaceStore:e,internalDomains:i}),u=s&&0!==r.length,p=u||c,g=(0,d().IS)((()=>({titleContainer:{display:"flex",alignItems:"center",gap:6,alignSelf:"stretch",fontSize:"14px",fontStyle:"normal",fontWeight:510,height:32}})),[]);return(0,le.jsxs)(le.Fragment,{children:[c&&!u?(0,le.jsx)(fu,{spaceStore:e,internalDomains:i}):void 0,u?(0,le.jsxs)("div",{style:{paddingTop:16,paddingBottom:16},children:[o?(0,le.jsx)(uu,{currentTab:"members"}):void 0,(0,le.jsx)(Tc,{requests:r,spaceStore:e,requestType:"member"})]}):void 0,p?(0,le.jsx)("div",{style:g.titleContainer,children:(0,le.jsx)(v().sA,{id:"peopleSectionMembersTab.activeMembers.title",defaultMessage:"Active"})}):void 0,(0,le.jsx)("div",{style:{marginTop:p?4:-1},children:(0,le.jsx)(Mu().Hw,{spaceStore:e,spacePermissionsSettingsStore:t})}),c&&u?(0,le.jsx)(fu,{spaceStore:e,internalDomains:i}):void 0]})}var ju=()=>n(395546),wu=()=>n(971736),Iu=()=>n(775281);function ku({recentRecoverableUser:e,spaceStore:t,hasCustomAgentsFeature:n}){const{environment:s,styles:o,handleReprovisionPagesToUserChange:r,handleReprovisionWorkflowsToUserChange:l,userId:c,selectedTransferPagesUser:u,selectedTransferWorkflowsUser:p}=function({recentRecoverableUser:e,spaceStore:t}){const n=(0,d().IS)((()=>({container:{display:"flex",width:"100%",justifyContent:"flex-end"},button:{display:"flex",width:24,height:24,justifyContent:"center",alignItems:"center",gap:10,paddingInlineStart:0,paddingInlineEnd:0},removeMenuDivider:{borderTop:Mt().Tj.border.secondary},upgradeIcon:{width:17,height:17}})),[]),s=(0,a().v3)(),[o,r]=(0,i.useState)(),[l,c]=(0,i.useState)(),u=(0,i.useCallback)((async(n,i)=>{r(i);await(0,Iu().FH)({environment:s,spaceStore:t,fromUserId:n,toUserId:i,contentType:"pages",messages:(0,Iu().vy)(),onSuccess:()=>{e.privatePagesCount=0,kc().A.setState({...kc().A.state,recentRecoverableUsers:[...kc().A.state.recentRecoverableUsers.filter((e=>e.userId!==n)),e]})}})||r(void 0)}),[s,t,e]),p=(0,i.useCallback)((async(n,i)=>{c(i);await(0,Iu().FH)({environment:s,spaceStore:t,fromUserId:n,toUserId:i,contentType:"workflows",messages:(0,Iu().$x)(),onSuccess:()=>{e.workflowsCount=0,kc().A.setState({...kc().A.state,recentRecoverableUsers:[...kc().A.state.recentRecoverableUsers.filter((e=>e.userId!==n)),e]})}})||c(void 0)}),[s,t,e]);return{environment:s,styles:n,handleReprovisionPagesToUserChange:u,handleReprovisionWorkflowsToUserChange:p,userId:e.userId,selectedTransferPagesUser:o,selectedTransferWorkflowsUser:l}}({recentRecoverableUser:e,spaceStore:t});if(!c)return null;const g=e.privatePagesCount>0,m=n&&e.workflowsCount>0;return g||m?(0,le.jsx)("div",{style:o.container,children:(0,le.jsx)(Kt().A,{popupType:Kt().z.Popup,onClick:()=>{fd().jR(s,{from:"recently_left",button_name:"actions"})},renderOrigin:e=>(0,le.jsx)(pi().p,{style:o.button,...e,children:(0,le.jsx)(f().I,{icon:qc().ellipsisIcon,colorVariant:"secondary"})}),render:()=>{const e=[];return g&&e.push({key:"transfer",render:e=>(0,le.jsx)(wu().A,{mode:Q().C.Button,focused:!1,title:(0,le.jsx)(v().sA,{id:"spacePermissionsSettings.reprovision.toUser.pages.title",defaultMessage:"Transfer private pages"}),parentStore:t,userIds:u?[u]:[],onChange:([e])=>{r(c,e)}}),action:()=>{fd().jR(s,{from:"recently_left",button_name:"open_transfer_pages"})}}),m&&e.push({key:"transfer_workflows",render:e=>(0,le.jsx)(wu().A,{mode:Q().C.Button,focused:!1,title:(0,le.jsx)(v().sA,{id:"spacePermissionsSettings.reprovision.toUser.workflows.title",defaultMessage:"Transfer private agents"}),parentStore:t,userIds:p?[p]:[],onChange:([e])=>{l(c,e)}}),action:()=>{fd().jR(s,{from:"recently_left",button_name:"open_transfer_workflows"})}}),(0,le.jsx)("div",{children:(0,le.jsx)(Gt().A,{type:Gt().O.Vertical,initialFocus:void 0,sections:[{key:"transfer",render:e=>(0,le.jsx)(Ht().A,{...e,style:o.removeMenuDivider}),items:e}]})})}})}):null}function Tu({spaceStore:e,recentRecoverableUsers:t}){return(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)("div",{style:{paddingTop:16,paddingBottom:16},children:(0,le.jsx)(cu,{leftIcon:(0,le.jsx)(f().I,{icon:ju().infoCircleSmallIcon,size:"sm",colorVariant:"secondary"}),content:(0,le.jsx)(v().sA,{id:"peopleSectionReprovisioningTab.settingsDeeplinkBannerTitle",defaultMessage:"People left the workspace in the past 30 days and had private pages appear here"})})}),(0,le.jsx)(Cu,{recentRecoverableUsers:t,spaceStore:e})]})}function Cu({spaceStore:e,recentRecoverableUsers:t}){const n=(0,xi()._)({name:"custom_agents",spaceId:e.id,userId:void 0}),s="available"===(null==n?void 0:n.type),{rows:o,sortState:a,setSortState:r,tableStyles:c}=function({recentRecoverableUsers:e,spaceStore:t,hasCustomAgentsFeature:n}){const s=(0,i.useMemo)((()=>Eu(n)),[n]),o=(0,i.useMemo)((()=>(0,Ae().rC)({columnRenderInfo:s,containerMarginTop:0})),[s]),[a,r]=(0,i.useState)({column:s[0],sortAscending:!0}),d=(0,l().K8)((()=>e.map((e=>{const i=J().L.createChildStore(t,{table:R().oo,id:e.userId});return{spaceStore:t,reprovisioningUser:e,email:i.getEmail(),id:e.userId,isClickable:!1,hasCustomAgentsFeature:n}}))),[t,e,n]);return{rows:d,sortState:a,setSortState:r,tableStyles:o}}({recentRecoverableUsers:t,spaceStore:e,hasCustomAgentsFeature:s}),u=(0,d().IS)((()=>({noRowContainer:{display:"flex",height:32,padding:"0px 4px",alignItems:"center",borderBottom:`1px solid ${Mt().Tj.border.primary}`}})),[]),p=(0,i.useMemo)((()=>Eu(s)),[s]);return(0,le.jsx)("div",{style:{marginTop:4},children:(0,le.jsx)(Ae().WE,{setStickyHeaderRow:!0,maxHeight:500,columnRenderInfo:p,rows:Ou(o,a),showRowBorders:!0,hideHeaderRowPadding:!0,sortState:a,onSortStateChanged:r,allowHorizontalScroll:!0,setStickyHeaderColumn:!0,renderNoRowsComponent:()=>(0,le.jsx)(we().A,{isSmall:!0,style:u.noRowContainer,children:(0,le.jsx)(v().sA,{id:"peopleSectionReprovisioningTab.noUser",defaultMessage:"No recent left user"})}),styles:c})})}const _u={id:"user",headerTitle:(0,le.jsx)("div",{style:{fontSize:14},children:(0,le.jsx)(v().sA,{id:"peopleSectionReprovisioningTab.user",defaultMessage:"User"})}),renderCell:e=>(0,le.jsx)(Qc().A,{userId:e.reprovisioningUser.userId,spaceStore:e.spaceStore}),widthData:{width:220},sortable:!0},Pu={id:"pageCount",headerTitle:(0,le.jsx)("div",{style:{fontSize:14},children:(0,le.jsx)(v().sA,{defaultMessage:"Private pages",id:"peopleSectionReprovisioningTab.privatePages"})}),renderCell:e=>(0,le.jsx)(we().A,{isSmall:!0,children:e.reprovisioningUser.privatePagesCount}),widthData:{width:100},sortable:!1},Bu={id:"workflowCount",headerTitle:(0,le.jsx)("div",{style:{fontSize:14},children:(0,le.jsx)(v().sA,{defaultMessage:"Private agents",id:"peopleSectionReprovisioningTab.agents"})}),renderCell:e=>(0,le.jsx)(we().A,{isSmall:!0,children:e.reprovisioningUser.workflowsCount}),widthData:{width:80},sortable:!1},Ru={id:"leftTime",headerTitle:(0,le.jsx)("div",{style:{fontSize:14},children:(0,le.jsx)(v().sA,{defaultMessage:"Left workspace",id:"peopleSectionReprovisioningTab.leftTime"})}),renderCell:e=>(0,le.jsx)(Du,{userLeftTime:e.reprovisioningUser.userLeftTime}),widthData:{width:100},sortable:!1};function Du({userLeftTime:e}){const t=(0,v().tz)(),n=(0,l().K8)((()=>{const n=C().KQ(e,(0,G().P)());return(0,vi().ZF)({value:n,date_format:"relative",userTimeZone:(0,G().P)(),intl:t,allowRelativeDates:!0})}),[e,t]);return(0,le.jsx)(we().A,{isSmall:!0,children:n})}const Lu={id:"actions",headerTitle:"",renderCell:e=>(0,le.jsx)(ku,{recentRecoverableUser:e.reprovisioningUser,spaceStore:e.spaceStore,hasCustomAgentsFeature:e.hasCustomAgentsFeature}),widthData:{width:100},sortable:!1};function Eu(e){const t=[_u,Pu];return e&&t.push(Bu),t.push(Ru,Lu),t}function Ou(e,{sortAscending:t}){const n=un().Ul(e,(e=>e.email));return t||n.reverse(),n}var Nu=()=>n(792071),Fu=()=>n(437607),Uu=()=>n(380030),zu=()=>n(34303),Ku=()=>n(953414),Vu=()=>n(176983),qu=()=>n(656144);function Wu({spaceStore:e}){const t=(0,v().tz)(),{styles:n,shouldEnableExportGuests:s,handleExportGuestsClick:o}=function({spaceStore:e}){const t=(0,v().tz)(),n=(0,a().v3)(),s=(0,Vu().J)(e),o=(0,A().T)(),r=null==e?void 0:e.id,l=(0,Ml().P)({name:"export_members",spaceId:r,userId:o}),c=(0,d().IS)((()=>({button:{display:"flex",width:28,height:28,justifyContent:"center",gap:10,alignItems:"center"},buttonIcon:{width:20,height:20,fontSize:16,fontStyle:"normal",flexDirection:"column",flexShrink:0,fontWeight:510,fill:Mt().Tj.icon.secondary}})),[]),u=s&&!0===l,p=(0,i.useCallback)((()=>{qu().li({spaceStore:e,intl:t,environment:n})}),[n,t,e]);return{styles:c,shouldEnableExportGuests:u,handleExportGuestsClick:p}}({spaceStore:e});return s?(0,le.jsx)(je().m,{render:e=>(0,le.jsx)(Ll().A,{style:n.button,onClick:o,icon:Ku().e,size:"md",ariaLabel:t.formatMessage({id:"exportGuestsButton.label",defaultMessage:"Export guests as CSV"}),...e}),renderTooltip:()=>t.formatMessage({id:"exportGuestsButton.label",defaultMessage:"Export guests as CSV"})}):null}var Gu=()=>n(404694),Hu=()=>n(201941),Yu=()=>n(964899),$u=()=>n(347930),Qu=()=>n(562866),Zu=()=>n(317025),Xu=()=>n(406999);function Ju({spaceStore:e,origin:t,requestFrom:n,inviteFrom:s}){const o=(0,i.useMemo)((()=>(0,Xu().nc)()),[]),r=(0,Gu().V)(),d=(0,Hu().u)(),{shouldShowRequestMemberButton:c,canEditMembership:u}=(0,l().K8)((()=>({shouldShowRequestMemberButton:!e.canEditMembership()&&!e.getDisableMembershipRequests()&&(0,ae().x3)(),canEditMembership:e.canEditMembership()})),[e]),p=(0,l().K8)((()=>e.id),[e]),g=(0,Kc().E)({spaceId:p}),m=(0,bd().J)(),f=(0,i.useCallback)((()=>{const e=(0,v().YK)({updatingPermissions:{id:"spacePermissionsSettings.updatePermissionsMessage",defaultMessage:"Updating…"}});Dd().m({message:e.updatingPermissions})}),[]),h=(0,i.useCallback)((()=>{Dd().V()}),[]),y=(0,a().v3)(),b=(0,i.useCallback)((()=>{(0,Zu().qU)(y)}),[y]);return c?(0,le.jsx)(Qu().cx,{spaceStore:e,analyticsFrom:n,origin:t?(0,le.jsx)("div",{onClick:b,children:t}):(0,le.jsx)(Rn().A,{colorPalette:"blue",size:"lg",onClick:b,children:(0,le.jsx)(v().sA,{id:"inviteUserButton.requestMemberLabel",defaultMessage:"Add members"})})}):(0,le.jsx)(Yu().n,{step:"collaborate_add_member",isFullWidth:!1,showContentOverlays:!1,inAppCalloutStore:r,teamIds:d,children:(0,le.jsx)($u().H,{disabled:!u,targetStore:e,spaceStore:e,onInviteClick:f,onInviteComplete:h,isSubscribed:g,membersOnly:!1,upgradeButtonName:"space_permission_settings",shouldGrow:!1,enableInviteDropdown:m,permissionsInviteStore:o,origin:t,analyticsFrom:s})})}function ep({spaceStore:e,currentTab:t,spacePermissionsSettingsStore:n}){return(0,i.useEffect)((()=>()=>{kc().A.reset()}),[]),(0,le.jsxs)("div",{style:{display:"flex",height:34,paddingBottom:0,justifyContent:"flex-end",alignItems:"center",gap:10},children:[(0,le.jsxs)("div",{style:{display:"flex",height:28,justifyContent:"flex-end",alignItems:"center",gap:4},children:[(0,le.jsx)(zu().A,{handleSearchQueryChange:e=>{kc().A.setState({...kc().A.state,searchQuery:e}),t===ea().d.Groups&&n.setState({...n.state,groupsFilter:e??""})},isSearchBarAlwaysOpen:!1,currentTab:t}),t===ea().d.Guests?(0,le.jsx)(Wu,{spaceStore:e}):null]}),(0,le.jsx)("div",{children:(0,le.jsx)(tp,{spaceStore:e,currentTab:t,spacePermissionsSettingsStore:n})})]})}function tp({spaceStore:e,currentTab:t,spacePermissionsSettingsStore:n}){const{canUseGroups:s,canCreateGroups:o,handleCreateGroupClick:r,shouldShowRequestMemberButtion:d,canEditMembership:c}=function({spaceStore:e,currentTab:t,spacePermissionsSettingsStore:n}){const s=(0,wd().zh)(),o=(0,wd().k4)({spaceStore:e}),r=(0,a().v3)(),d=(0,i.useCallback)((()=>{Ft().createAndCommit({userAction:"PeopleSectionGroupsTab.handleCreateGroupClick",environment:r,canUndo:!0,perform:t=>{const i=(0,Uu().n)({spaceStore:e,transaction:t}),s=null==i?void 0:i.getGroupId();if(i&&s){n.setState({...n.state,editingNameGroupId:s,groupNameInputValue:""});const e=Nu().Bj6.fromValue(Fu().n,i.getValue());xd().h.addGroup(s,{group:e,memberCount:0,membershipTypes:[]})}}})}),[r,e,n]),c=(0,l().K8)((()=>!e.canEditMembership()&&!e.getDisableMembershipRequests()&&(0,ae().x3)()),[e]),u=(0,wd().k4)({spaceStore:e});return{canUseGroups:s,canCreateGroups:o,shouldShowRequestMemberButtion:c,canEditMembership:u,handleCreateGroupClick:d}}({spaceStore:e,currentTab:t,spacePermissionsSettingsStore:n});return t===ea().d.Groups&&s?o?(0,le.jsx)(je().m,{renderTooltip:()=>!o&&(0,le.jsx)(v().sA,{id:"spacePermissionsSettings.groupsTab.groupCreationInsufficientPermissions",defaultMessage:"Only membership admins and workspace owners can add a permission group."}),render:e=>(0,le.jsx)(Rn().A,{colorPalette:"blue",size:"lg",onClick:r,...e,children:(0,le.jsx)(v().sA,{id:"spacePermissionsSettings.groupsTab.createGroupButton.label",defaultMessage:"Create a group"})})}):null:d||c?(0,le.jsx)(Ju,{spaceStore:e,requestFrom:"space_settings_add_members",inviteFrom:"space_settings_add_members"}):null}var np=()=>n(965511);function ip({spaceStore:e}){const t=(0,l().O$)(m().subscriptionDataStoreInstance),n=(0,Md().o)({spaceId:null==e?void 0:e.id}),s=(0,l().uB)(void 0,ea().A),o=vd();return(0,i.useEffect)((()=>{o&&s.setState({...s.state,currentTab:ea().d.Guests})}),[s,o]),e&&t?(0,le.jsxs)(Xe().Ay,{children:[(0,le.jsx)(ru().gz,{spaceStore:e}),(0,le.jsx)(ru().K,{spaceStore:e,inviteLinkCode:n,spacePermissionsSettingsStore:s}),(0,le.jsx)(op,{subscriptionData:t,spaceStore:e,spacePermissionsSettingsStore:s})]}):(0,le.jsx)(sp,{})}function sp(){return(0,le.jsx)(Xe().Ay,{centerContent:!0,children:(0,le.jsx)(Bn().k,{})})}function op({subscriptionData:e,spaceStore:t,spacePermissionsSettingsStore:n}){var s;(0,i.useEffect)((()=>{if(Qe().Ay.state.open&&"members"===Qe().Ay.state.currentTab&&Qe().Ay.state.defaultSubtab){const e=Qe().Ay.state.defaultSubtab!==ea().d.Requests?Qe().Ay.state.defaultSubtab:ea().d.Members;n.setState({...n.state,currentTab:e})}}),[n]);const{memberCount:o,recentRecoverableUsers:r,currentTab:c,canReprovisionContent:u,tabs:p,currentTabs:m,environment:f,billingData:h}=function({subscriptionData:e,spaceStore:t,spacePermissionsSettingsStore:n}){const i=(0,a().v3)(),s=(0,yd().V)()??1,o=(0,Xo().r)(),r=(0,A().T)(),c=(0,md().V_)({spaceStore:t,userId:r}),u=(0,jd().x)({spaceUserMembershipType:c});(0,wd().rl)({spaceStore:t,subscriptionData:e});const p=(0,l().K8)((()=>{const{recentRecoverableUsers:e}=kc().A.state;return e.filter((e=>e.privatePagesCount>0))}),[]),m=(0,l().K8)((()=>n.state.currentTab),[n]),f=(0,wd().t1)({spaceStore:t,subscriptionData:e}),h=or({spaceStore:t,requestType:"guest"}),y=or({spaceStore:t,requestType:"member"}),b=(0,d().IS)((()=>({activeTabStyle:{color:Mt().Tj.text.primary},inactiveTabStyle:{color:Mt().Tj.text.tertiary},redDot:{background:Mt().Tj.red.icon.accentPrimary,marginInlineStart:6,marginTop:6}})),[]),S=(0,l().K8)((()=>{const e=xd().h.state.permissionGroupsAndMemberCounts.size;return void 0===s?{}:{[ea().d.Members]:(0,le.jsx)(lp,{text:(0,le.jsx)("div",{children:(0,le.jsx)(v().sA,{id:"spacePermissionsSettings.membersTab.title",defaultMessage:"Members"})}),number:u?s:void 0,isCurrentTab:m===ea().d.Members,styles:b,unread:(y??0)>0}),[ea().d.Guests]:(0,le.jsx)(lp,{text:(0,le.jsx)(v().sA,{id:"spacePermissionsSettings.guestsTab.title",defaultMessage:"Guests"}),number:u?o:void 0,isCurrentTab:m===ea().d.Guests,styles:b,unread:(h??0)>0}),[ea().d.Groups]:(0,le.jsx)(lp,{text:(0,le.jsx)(v().sA,{id:"spaceBasicSettings.groupsTab.title",defaultMessage:"Groups"}),number:u?e:void 0,isCurrentTab:m===ea().d.Groups,styles:b}),[ea().d.Reprovisioning]:(0,le.jsx)(lp,{text:(0,le.jsx)(v().sA,{id:"spaceBasicSettings.reprovisioningTab.title",defaultMessage:"Recently left"}),number:u?p.length:void 0,isCurrentTab:m===ea().d.Reprovisioning,styles:b}),[ea().d.Requests]:(0,le.jsx)(v().sA,{id:"spaceBasicSettings.requestsTab.title",defaultMessage:"Requests"}),[ea().d.Contacts]:(0,le.jsx)(lp,{text:(0,le.jsx)(v().sA,{id:"spaceBasicSettings.contactsTab.title",defaultMessage:"Contacts"}),isCurrentTab:m===ea().d.Contacts,styles:b})}}),[s,o,m,b,y,h,p.length,u]),x=(0,g()._3)({spaceId:t.id}),M=vd(),j=Sd(),w=rp({canReprovisionContent:f,hideGroupsTab:!1,showGuestTabFirst:M,showContactsTab:j}),I=w.map((e=>S[e]));return{billingData:x,memberCount:s,recentRecoverableUsers:p,currentTab:m,canReprovisionContent:f,tabs:I,currentTabs:w,environment:i}}({subscriptionData:e,spaceStore:t,spacePermissionsSettingsStore:n}),y=(0,Ad().h)(t),b=(0,g().Q7)(t.id,h,o),S=y&&c===ea().d.Members&&(null==h?void 0:h.subscription),x=vd(),M=Sd();return(0,le.jsxs)("div",{style:{paddingInlineStart:2,paddingInlineEnd:2},children:[(0,le.jsx)(Hs().LZ,{tabs:p,selectedIndex:m.indexOf(c),onChange:e=>function({newSelectedIndex:e,environment:t,spacePermissionsSettingsStore:n,currentTab:i,canReprovisionContent:s,hideGroupsTab:o,showGuestTabFirst:a,showContactsTab:r}){const l=rp({canReprovisionContent:s,hideGroupsTab:o,showGuestTabFirst:a,showContactsTab:r})[e];switch(l){case ea().d.Members:fd().K4(t,{tab:"members"});break;case ea().d.Groups:fd().K4(t,{tab:"groups"});break;case ea().d.Guests:fd().K4(t,{tab:"guests"});break;case ea().d.Reprovisioning:fd().K4(t,{tab:"reprovisioning"});break;case ea().d.Requests:fd().K4(t,{tab:"requests"});break;case ea().d.Contacts:fd().K4(t,{tab:"contacts"});break;default:(0,rt().HB)(l)}i===ea().d.Requests&&l!==ea().d.Requests&&Ia().A.reset();n.setState({...n.state,currentTab:l})}({newSelectedIndex:e,environment:f,spacePermissionsSettingsStore:n,currentTab:c,canReprovisionContent:u,hideGroupsTab:!1,showGuestTabFirst:x,showContactsTab:M}),style:{paddingInlineEnd:0,marginTop:-6,marginInlineStart:-12,paddingInlineStart:4,width:"calc(100% + 12px)"},tabTitleStyle:{fontSize:16,fontWeight:400},tabBorderStyle:{insetInlineStart:0,insetInlineEnd:0},hideTabBorder:!0,right:(0,le.jsx)(ep,{spaceStore:t,currentTab:c,spacePermissionsSettingsStore:n})}),S?(0,le.jsx)("div",{style:{marginTop:20,marginInlineEnd:0,marginBottom:20,marginInlineStart:0},children:(0,le.jsx)(np().x,{quantityOfPaidSeats:b,quantityOfSpaceMembers:o,nextBillingDate:(null===(s=h.subscription)||void 0===s?void 0:s.currentPeriodEnd.toLocaleString({month:"short",day:"numeric",year:"numeric"}))??""})}):null,(0,le.jsx)(ap,{currentTab:c,spaceStore:t,spacePermissionsSettingsStore:n,recentRecoverableUsers:r})]})}function ap({currentTab:e,spaceStore:t,spacePermissionsSettingsStore:n,recentRecoverableUsers:i}){switch(e){case ea().d.Members:return(0,le.jsx)(Au,{spaceStore:t,spacePermissionsSettingsStore:n});case ea().d.Guests:return(0,le.jsx)(su,{spaceStore:t,spacePermissionsSettingsStore:n});case ea().d.Groups:return(0,le.jsx)(Cd,{spaceStore:t,spacePermissionsSettingsStore:n});case ea().d.Reprovisioning:return(0,le.jsx)(Tu,{spaceStore:t,recentRecoverableUsers:i});case ea().d.Contacts:return(0,le.jsx)(Id().x,{spaceStore:t});default:return null}}function rp({canReprovisionContent:e,hideGroupsTab:t,showGuestTabFirst:n,showContactsTab:i}){return n?[ea().d.Guests,ea().d.Members,...t?[]:[ea().d.Groups],...e?[ea().d.Reprovisioning]:[],...i?[ea().d.Contacts]:[]]:[ea().d.Members,ea().d.Guests,...t?[]:[ea().d.Groups],...e?[ea().d.Reprovisioning]:[],...i?[ea().d.Contacts]:[]]}function lp({text:e,number:t,isCurrentTab:n,unread:i,styles:s}){return(0,le.jsxs)("div",{style:{display:"flex",fontSize:ye().J.UIRegular.desktop,fontWeight:ye().Wy.medium,lineHeight:"18px",...n?s.activeTabStyle:s.inactiveTabStyle},children:[e,t&&t>0?(0,le.jsx)("div",{style:{fontSize:ye().J.UIRegular.desktop,lineHeight:"18px",paddingInlineStart:4,...s.inactiveTabStyle},children:t}):void 0,i?(0,le.jsx)(hd().m,{style:s.redDot,size:6}):void 0]})}var dp=()=>n(206267),cp=()=>n(76590),up=()=>n(307212),pp=()=>n(301608),gp=()=>n(84593);const mp="last_90_days";function fp(e){const{currentFilter:t,onChangeFilter:n}=e,i=pp().CA.map((e=>({key:e,value:e,title:(0,le.jsx)(v().sA,{...pp().jy[e]}),shortTitle:(0,le.jsx)(v().sA,{...pp().jy[e]}),wrapCaption:!1})));return(0,le.jsx)(gp().G0,{pillTitle:(0,le.jsx)(v().sA,{id:"organizationConsole.analytics.filters.timeRange.title",defaultMessage:"Time range"}),pillIcon:H().D,shouldHidePrefix:!0,selectedItem:t,setSelectedItem:e=>{n(e??mp)},items:i,shouldUseCheck:!0,selectionRequired:!0})}var hp=()=>n(198039),yp=()=>n(591779),vp=()=>n(714953),bp=()=>n(286387),Sp=()=>n(661923),xp=()=>n(89849),Mp=()=>n(177148),Ap=()=>n(249117),jp=()=>n(655546),wp=()=>n(997583),Ip=()=>n(155712),kp=()=>n(20953);const Tp=640;function Cp({data:e,loading:t,error:n,daysFilter:s,setDaysFilter:o}){const r=(0,v().tz)(),[l,c]=(0,wp().z)(),u=(0,d().IS)((()=>({title:{fontWeight:ye().Wy.medium,fontSize:16,marginBlock:"8px 4px",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:1},titleText:{flexShrink:1},infoIcon:{marginInlineStart:4,flexShrink:0},container:{display:"flex",flexDirection:"column",gap:16},titleContainer:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:16},cardContainer:{justifyContent:"flex-start",gap:18},cardTextContainer:{alignItems:"flex-start"}})),[]),{pageViews:p,uniquePageViews:g,pagesCreated:m,pageEdits:f}=e,h=(0,a().v3)(),y=(0,i.useCallback)((e=>{cp().Y5(h,{daysFilter:e}),o(e)}),[h,o]);return(0,le.jsxs)("div",{style:u.container,ref:l,children:[(0,le.jsxs)("div",{style:u.titleContainer,children:[(0,le.jsxs)(we().A,{style:u.title,children:[(0,le.jsx)("div",{style:u.titleText,children:(0,le.jsx)(v().sA,{id:"workspaceAnalytics.content.contentEngagement.title",defaultMessage:"Content engagement"})}),(0,le.jsx)(je().m,{placement:"bottom",render:e=>(0,le.jsx)(tn().A,{...e,href:(0,ut().x)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:u.infoIcon}),renderTooltip:()=>"all_time"!==s?(0,le.jsx)(v().sA,{id:"settings.workspaceAnalytics.contentTab.contentEngagement.tooltip.lastDays",defaultMessage:"Activity on all workspace pages (includes private and shared) over the {dateRange}",values:{dateRange:r.formatMessage(pp().Yr[s])}}):(0,le.jsx)(v().sA,{id:"settings.workspaceAnalytics.contentTab.contentEngagement.tooltip.allTime",defaultMessage:"All time activity on all pages in the workspace (includes private and shared)"})})]}),(0,le.jsx)(kp().Z,{currentFilter:s,onChangeFilter:y,hideAllTime:!0})]}),(0,le.jsxs)(Ap().xA,{gap:16,children:[(0,le.jsx)(Ap().LX,{row:1,col:1,children:(0,le.jsx)(Ip().a,{style:u.cardContainer,textStyles:u.cardTextContainer,loading:t,error:n,icon:xp().eyeIcon,iconSize:"xl",title:(0,le.jsx)(v().sA,{id:"workspaceAnalytics.content.contentEngagement.totalViews",defaultMessage:"{pageViews} total views",values:{pageViews:(0,le.jsx)(jp()._,{abbreviateNumber:c<Tp,num:p})}}),byline:(0,le.jsx)(we().A,{isSecondaryColor:!0,children:(0,le.jsx)(v().sA,{id:"workspaceAnalytics.content.contentEngagement.uniqueViews",defaultMessage:"{uniquePageViews, plural, one {{uniquePageViews} unique page viewed} other {{uniquePageViews} unique pages viewed}}",values:{uniquePageViews:(0,le.jsx)(jp()._,{abbreviateNumber:c<Tp,num:g})}})})})}),(0,le.jsx)(Ap().LX,{row:1,col:2,children:(0,le.jsx)(Ip().a,{style:u.cardContainer,textStyles:u.cardTextContainer,loading:t,error:n,icon:Mp().Y,iconSize:"xl",title:(0,le.jsx)(v().sA,{id:"workspaceAnalytics.content.contentEngagement.pagesCreated",defaultMessage:"{pagesCreated} pages created",values:{pagesCreated:(0,le.jsx)(jp()._,{abbreviateNumber:c<Tp,num:m})}}),byline:(0,le.jsx)(we().A,{isSecondaryColor:!0,children:(0,le.jsx)(v().sA,{id:"workspaceAnalytics.content.contentEngagement.pageEdits.byline",defaultMessage:"{pageEdits} edits",values:{pageEdits:(0,le.jsx)(jp()._,{abbreviateNumber:c<Tp,num:f})}})})})})]})]})}var _p=()=>n(274800);const Pp={query:"",createdBy:[],lastEditedTime:{starting:void 0,ending:void 0},createdTime:{starting:void 0,ending:void 0},teamIds:[]},Bp={field:"pageViews",direction:"desc"},Rp=up().Jb,Dp={filters:Pp,sort:Bp,timeRange:Rp,navigableBlockIds:[],analyticsByPageId:new Map,numPagesLoaded:0,paginationToken:void 0,hasNextPage:!0,loading:!1,error:void 0,shouldReRunSearch:!1};function Lp({spaceStore:e,teamStores:t,timeRange:n,filters:i,runNewSearch:s,setFilters:o,setTimeRange:a}){const r=(0,v().tz)(),{teams:c}=(0,Tn().Qs)({spaceStore:e}),u=(0,Tn().gc)({spaceStore:e,teams:c}).map((e=>e.store)),p=(0,l().K8)((()=>t??u),[t,u]),g=(0,d().IS)((()=>({container:{width:"100%",margin:"0 auto 14px"},filterPillsContainer:{width:"100%",display:"flex",flexWrap:"wrap",rowGap:4,alignItems:"center"},timeRangeContainer:{display:"flex",alignItems:"center",justifyContent:"center",gap:4,borderInlineEnd:`1px solid ${Mt().Tj.border.primary}`,marginInlineEnd:12,paddingInlineEnd:6}})),[]);return(0,le.jsxs)("div",{style:g.container,children:[(0,le.jsx)(Rr().nv,{mode:Rr().Ke.OnChange,query:i.query,setQueryFilter:function(e){o({query:e},{runSearchAfter:!0})},placeholderText:r.formatMessage(Rr().Jj.titleOnlyPlaceholder)}),(0,le.jsxs)("div",{style:g.filterPillsContainer,children:[(0,le.jsxs)("div",{style:g.timeRangeContainer,children:[(0,le.jsx)(we().A,{isSecondaryColor:!0,children:(0,le.jsx)(v().sA,{id:"settings.workspaceAnalytics.contentTab.timeRange",defaultMessage:"Views from"})}),(0,le.jsx)(kp().Z,{currentFilter:n,onChangeFilter:a,hideAllTime:!0})]}),(0,le.jsx)(Fr().j,{selectedTeamIds:i.teamIds,setSelectedTeamIds:function(e){o({teamIds:e})},onMenuClose:s,teamStores:p}),(0,le.jsx)(Lr().Q,{spaceStore:e,createdByFilterIds:i.createdBy,setCreatedByFilter:function(e){o({createdBy:e})},runNewSearch:s,includeGuests:!1}),(0,le.jsx)(Er().Z,{lastEditedTime:i.lastEditedTime,createdTime:i.createdTime,setLastEditedTime:function(e){o({lastEditedTime:e,createdTime:{starting:void 0,ending:void 0}},{runSearchAfter:!0})},setCreatedOnTime:function(e){o({createdTime:e,lastEditedTime:{starting:void 0,ending:void 0}},{runSearchAfter:!0})}})]})]})}function Ep({spaceStore:e,teamStores:t,contentEngagement:n}){var s;const o=(0,yp().ZC)(e.id),r=(0,i.useRef)(!1),{loadNextPage:c,navigableBlockStores:u,analyticsByPageId:p,runNewSearch:g,setFilters:m,setTimeRange:f,timeRange:h,filters:y,sort:v,setSort:b,loading:S,error:x}=function({spaceStore:e}){const t=(0,a().v3)(),[n,s]=(0,i.useState)(Dp),o=(0,i.useRef)(Pp),r=(0,i.useRef)(Bp),l=(0,i.useRef)(Rp),d=(0,i.useCallback)((async({fetchFromFirstPage:i,ignoreSearchInputComparison:a})=>{const d=!un().n4(n.filters,o.current)||!un().n4(n.sort,r.current)||!un().n4(n.timeRange,l.current);if(!a&&!d)return;o.current=n.filters,r.current=n.sort,l.current=n.timeRange;let c=n.loading,u=n.error,p=n.hasNextPage,g=n.paginationToken;if(i&&(s((e=>({...Dp,filters:e.filters,timeRange:e.timeRange,sort:e.sort}))),c=Dp.loading,u=Dp.error,p=Dp.hasNextPage,g=Dp.paginationToken),!p||c)return;if(u)return;s((e=>({...e,loading:!0})));const m=await D().callApi({eventName:"loadContentAnalytics",environment:t,data:{spaceId:e.id,sort:n.sort,titleQuery:n.filters.query,filters:{inTeams:n.filters.teamIds,lastEditedTime:(0,re().ES)(n.filters.lastEditedTime),createdTime:(0,re().ES)(n.filters.createdTime),createdBy:n.filters.createdBy},timeRange:n.timeRange,startCursor:g}});if("failed"===m.type)return void s((e=>({...e,loading:!1,error:m.error})));const f=m.data.results;s((e=>{const t=[],n=new Set(e.navigableBlockIds),i=new Map(e.analyticsByPageId);for(const o of f){const e=o.id,s=o.analytics;n.has(e)||(t.push(e),i.set(e,s))}const s=[...e.navigableBlockIds,...t];return{...e,navigableBlockIds:s,analyticsByPageId:i,loading:!1,error:void 0,numPagesLoaded:e.numPagesLoaded+1,paginationToken:m.data.nextCursor,hasNextPage:Boolean(m.data.nextCursor)}}))}),[t,e,n.filters,n.sort,n.timeRange,n.loading,n.error,n.hasNextPage,n.paginationToken]),c=(0,i.useMemo)((()=>n.navigableBlockIds.map((e=>new(hc().B)(t,{id:e,table:vc().ev})))),[n.navigableBlockIds,t]);(0,i.useEffect)((()=>{n.shouldReRunSearch&&(s((e=>({...e,shouldReRunSearch:!1}))),d({fetchFromFirstPage:!0,ignoreSearchInputComparison:!1}))}),[n.shouldReRunSearch,d]);const u=(0,i.useCallback)((async()=>{n.shouldReRunSearch||await d({fetchFromFirstPage:!1,ignoreSearchInputComparison:!0})}),[n.shouldReRunSearch,d]),p=(0,i.useCallback)((async e=>{await d({fetchFromFirstPage:!0,ignoreSearchInputComparison:e||!1})}),[d]),g=(0,i.useCallback)(((e,n)=>{s((t=>({...t,filters:{...t.filters,...e},...null!=n&&n.runSearchAfter?{shouldReRunSearch:null==n?void 0:n.runSearchAfter}:void 0})));for(const i of(0,rt().uv)(e))un().n4(e[i],Pp[i])||cp().Tm(t,{filter:i,value:"createdBy"===i||"teamIds"===i?e[i]:void 0})}),[t]),m=(0,i.useCallback)((e=>{s((t=>({...t,timeRange:e,shouldReRunSearch:!0}))),cp().$s(t,{daysFilter:e})}),[t]),f=(0,i.useCallback)((e=>{s((t=>({...t,sort:e,shouldReRunSearch:!0}))),cp().PH(t,{column:e.field,isAscending:"asc"===e.direction})}),[t]);return{filters:n.filters,sort:n.sort,timeRange:n.timeRange,analyticsByPageId:n.analyticsByPageId,loading:n.loading,error:n.error,navigableBlockStores:c,loadNextPage:u,runNewSearch:p,setFilters:g,setTimeRange:m,setSort:f}}({spaceStore:e}),M=(0,d().IS)((()=>({container:{display:"flex",flexDirection:"column",gap:16}})),[]),A=(0,l().K8)((()=>{const t=j().default.checkGate({gateName:"allow_space_member_to_export_analytics"});return Boolean(e.canAdmin())||t&&e.canRead()}),[e]),w=(0,i.useMemo)((()=>void 0!==o&&e.id!==o),[e.id,o]);(0,i.useEffect)((()=>{r.current&&!w||(g(!0),r.current=!0)}),[g,w]);const I=(0,l().K8)((()=>e.getName()),[e]);if("NotFoundError"===(null==n||null===(s=n.error)||void 0===s?void 0:s.name))return(0,le.jsx)(bp().H,{type:"empty",spaceName:I});const k={...y,daysFilter:h,lastEditedTime:(0,re().ES)(y.lastEditedTime),createdTime:(0,re().ES)(y.createdTime)};return(0,le.jsxs)("div",{style:M.container,children:[(0,le.jsx)(Cp,{data:n.data,loading:n.loading,error:n.error,daysFilter:n.daysFilter,setDaysFilter:n.setDaysFilter}),(0,le.jsx)(Op,{canExport:A,filters:k}),(0,le.jsx)(Lp,{spaceStore:e,teamStores:t,runNewSearch:g,setFilters:m,filters:y,timeRange:h,setTimeRange:f}),(0,le.jsx)(_p().Q,{navigableBlockStores:u,analyticsByPageId:p,runNewSearch:g,sort:v,setSort:b,loadNextPage:c,loading:S,error:x})]})}function Op(e){const t=(0,v().tz)(),n=(0,d().IS)((()=>({sectionTitle:{fontWeight:ye().Wy.semibold,fontSize:16},sectionTitleSection:{display:"flex",flexFlow:"row",alignItems:"center"},helpInfo:{marginInlineStart:4},wrapper:{display:"flex",flexDirection:"row",justifyContent:"space-between",marginTop:12},exportButton:{marginInlineStart:5}})),[]),{canExport:i,filters:s}=e,{daysFilter:o}=s,a=(0,le.jsxs)("div",{style:n.sectionTitleSection,children:[(0,le.jsx)(we().A,{style:n.sectionTitle,children:(0,le.jsx)(v().sA,{id:"settings.workspaceAnalytics.contentTab.allPages.title",defaultMessage:"Pages"})}),(0,le.jsx)(je().m,{placement:"bottom",render:e=>(0,le.jsx)(tn().A,{...e,href:(0,ut().x)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:n.helpInfo}),renderTooltip:()=>"all_time"!==o?(0,le.jsx)(v().sA,{id:"settings.workspaceAnalytics.contentTab.pages.tooltip.lastDays",defaultMessage:"Activity from the {dateRange} on pages you have access to",values:{dateRange:t.formatMessage(pp().Yr[o])}}):(0,le.jsx)(v().sA,{id:"settings.workspaceAnalytics.contentTab.pages.tooltip.allTime",defaultMessage:"All time activity on pages you have access to in the workspace"})})]});return(0,le.jsxs)("div",{style:n.wrapper,children:[a,i?(0,le.jsx)(vp().L,{style:n.exportButton,analyticsType:Sp().e.Content,filters:s}):void 0]})}var Np=()=>n(105819),Fp=()=>n(922189),Up=()=>n(461197);const zp=640;function Kp({data:e,loading:t,error:n,daysFilter:s,setDaysFilter:o}){const r=(0,v().tz)(),c=(0,a().v3)(),{organizationOwnerRecordCache:u}=(0,i.useContext)(ol().N),p=(0,d().IS)((()=>({title:{fontWeight:ye().Wy.medium,fontSize:16,marginBlock:"9px 4px",display:"flex",alignItems:"center",overflow:"hidden"},titleText:{...ye().RC,flexShrink:1},helpInfo:{marginInlineStart:4},container:{display:"flex",flexDirection:"column",gap:16},titleContainer:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:16},overviewCard:{width:"fit-content"}})),[]),[g,m]=(0,wp().z)(),{pageViews:f,uniquePageViews:h,pageEdits:y,topPages:b}=e,S=(0,l().K8)((()=>b.map((({pageId:e,pageViews:t})=>({store:new(hc().B)(c,{id:e,table:vc().ev},{inMemoryRecordCache:u}),caption:(0,le.jsx)(v().sA,{id:"workspaceAnalytics.overview.contentEngagement.caption.pageView",defaultMessage:"{pageViews} views",values:{pageViews:(0,le.jsx)(jp()._,{abbreviateNumber:!1,num:t})}})})))),[c,b,u]),x=(0,i.useCallback)((e=>{o(e),cp().n_(c,{filter:"content_engagement",daysFilter:e})}),[c,o]);return(0,le.jsxs)("div",{style:p.container,ref:g,children:[(0,le.jsxs)("div",{style:p.titleContainer,children:[(0,le.jsxs)(we().A,{style:p.title,children:[(0,le.jsx)("div",{style:p.titleText,children:(0,le.jsx)(v().sA,{id:"workspaceAnalytics.overview.contentEngagement.title",defaultMessage:"Content engagement"})}),(0,le.jsx)(je().m,{placement:"bottom",render:e=>(0,le.jsx)(tn().A,{...e,href:(0,ut().x)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:p.helpInfo}),renderTooltip:()=>"all_time"!==s?(0,le.jsx)(v().sA,{id:"settings.workspaceAnalytics.overviewTab.contentEngagement.tooltip.lastDays",defaultMessage:"Activity on all pages in the workspace over the {dateRange}",values:{dateRange:r.formatMessage(pp().Yr[s])}}):(0,le.jsx)(v().sA,{id:"settings.workspaceAnalytics.overviewTab.contentEngagement.tooltip.allTime",defaultMessage:"All time activity on all pages in the workspace"})})]}),(0,le.jsx)(kp().Z,{currentFilter:s,onChangeFilter:x,hideAllTime:!0})]}),(0,le.jsxs)(Ap().xA,{gap:16,children:[(0,le.jsx)(Ap().LX,{row:1,col:1,colEnd:3,children:(0,le.jsx)(Ip().a,{loading:t,error:n,icon:xp().eyeIcon,textStyles:p.overviewCard,title:(0,le.jsx)(v().sA,{id:"workspaceAnalytics.overview.contentEngagement.views",defaultMessage:"{pageViews} total views",values:{pageViews:(0,le.jsx)(jp()._,{abbreviateNumber:m<zp,num:f})}})})}),(0,le.jsx)(Ap().LX,{row:2,col:1,colEnd:3,children:(0,le.jsx)(Ip().a,{loading:t,error:n,icon:Fp().personCircleFillIcon,textStyles:p.overviewCard,title:(0,le.jsx)(v().sA,{id:"workspaceAnalytics.overview.contentEngagement.uniqueViews",defaultMessage:"{uniquePageViews, plural, one {{uniquePageViews} unique page viewed} other {{uniquePageViews} unique pages viewed}}",values:{uniquePageViews:(0,le.jsx)(jp()._,{abbreviateNumber:m<zp,num:h})}})})}),(0,le.jsx)(Ap().LX,{row:3,col:1,colEnd:3,children:(0,le.jsx)(Ip().a,{loading:t,error:n,icon:Np().pencilLineIcon,textStyles:p.overviewCard,title:(0,le.jsx)(v().sA,{id:"workspaceAnalytics.overview.contentEngagement.pageEdits",defaultMessage:"{pageEdits} edits",values:{pageEdits:(0,le.jsx)(jp()._,{abbreviateNumber:m<zp,num:y})}})})}),(0,le.jsx)(Ap().LX,{row:1,rowEnd:4,col:3,colEnd:5,children:(0,le.jsx)(Up().N,{loading:t,error:n,title:(0,le.jsx)(v().sA,{id:"workspaceAnalytics.overview.contentEngagement.popularPages",defaultMessage:"Most popular pages"}),items:S})})]})]})}var Vp=()=>n(550848);function qp({onUserTabFilterChange:e,spaceStore:t,contentEngagement:n,userEngagement:i}){var s,o;const a=(0,d().IS)((()=>({container:{display:"flex",flexDirection:"column",gap:24}})),[]),r=(0,l().K8)((()=>t.getName()),[t]);if("NotFoundError"===(null===(s=n.error)||void 0===s?void 0:s.name)||"NotFoundError"===(null===(o=i.error)||void 0===o?void 0:o.name))return(0,le.jsx)(bp().H,{type:"empty",spaceName:r});return(0,le.jsxs)("div",{style:a.container,children:[(0,le.jsx)(Vp().R,{data:i.data,loading:i.loading,error:i.error,daysFilter:i.daysFilter,setDaysFilter:function(t){e({graphFilter:"all_time"===t?"last_90_days":t}),i.setDaysFilter(t)}}),(0,le.jsx)(Kp,{data:n.data,loading:n.loading,error:n.error,daysFilter:n.daysFilter,setDaysFilter:n.setDaysFilter})]})}var Wp=()=>n(970381),Gp=()=>n(436860);const Hp={[Sp().e.Overview]:(0,le.jsx)(v().sA,{id:"workspaceAnalyticsTabs.overview.title",defaultMessage:"Overview"}),[Sp().e.Users]:(0,le.jsx)(v().sA,{id:"workspaceAnalyticsTabs.members.title",defaultMessage:"Members"}),[Sp().e.Content]:(0,le.jsx)(v().sA,{id:"workspaceAnalyticsTabs.content.title",defaultMessage:"Content"}),[Sp().e.Search]:(0,le.jsx)(v().sA,{id:"workspaceAnalyticsTabs.search.title",defaultMessage:"Search"}),[Sp().e.AI]:(0,le.jsx)(v().sA,{id:"workspaceAnalyticsTabs.ai.title",defaultMessage:"AI"})};function Yp(e){const{currentTab:t,spaceAnalyticsStoreState:n,onUserTabFilterChange:i,spaceStore:s,aiAnalyticsDateRange:o}=e;switch(t){case Sp().e.Content:return(0,le.jsx)(Ep,{spaceStore:s,contentEngagement:e.contentEngagementData});case Sp().e.Users:return(0,le.jsx)(Gp().A,{spaceStore:s,usersTabData:n.usersTabData,onUserTabFilterChange:i,userEngagement:e.userEngagementData});case Sp().e.Overview:return(0,le.jsx)(qp,{contentEngagement:e.contentEngagementData,userEngagement:e.userEngagementData,spaceStore:s,onUserTabFilterChange:i});case Sp().e.Search:return(0,le.jsx)(Wp().A,{spaceStore:s});case Sp().e.AI:return(0,le.jsx)(hp().q,{spaceStore:s,dateRange:o,surface:"workspace"});default:(0,rt().HB)(t)}}const $p=function({spaceStore:e}){const t=(0,d().IS)((()=>({headingStyle:{fontSize:16,fontWeight:ye().Wy.medium,display:"flex",justifyContent:"space-between"},title:{display:"flex",alignItems:"center"},helpInfo:{marginInlineStart:4},tabsStyle:{paddingInlineStart:0,paddingInlineEnd:0,marginTop:-6,marginBottom:14,position:"sticky",top:-40,paddingTop:8,backgroundColor:Mt().Tj.background.primary,zIndex:10}})),[]),s=(0,a().v3)(),r=(0,A().T)(),c=(0,l().K8)((()=>Qe().Ay.state.sessionId),[]),u=(0,n(760379).r)({surface:"workspace"}),p=(0,n(992211).M)({spaceId:e.id}),g=(0,n(724481)._)({spaceStore:e,userId:r}),[m,f]=(0,l().$y)(Sp().A),[h,y]=(0,i.useState)(mp),b=(0,l().K8)((()=>Boolean(null==e?void 0:e.getSettings().disable_page_analytics)),[e]),S=(0,l().K8)((()=>null==e?void 0:e.getName()),[e]),x=(0,o().X)("ai_analytics_space"),M=(0,i.useCallback)((async t=>{await up().OJ({environment:s,spaceStore:e,currentTab:m.currentTab,currentSpaceId:m.currentSpaceId,usersTabData:m.usersTabData,setState:f,graphFilter:t.graphFilter,tableFilter:t.tableFilter})}),[s,e,m,f]),j=(0,i.useCallback)((e=>{y(e),u({customization:"time_range_changed",time_range_chosen:e})}),[u]),w=(0,l().K8)((()=>{const t=Boolean(null==e?void 0:e.canAdmin()),n=[];return t&&n.push(Sp().e.Overview,Sp().e.Users),n.push(Sp().e.Content),x&&t&&null!=e&&e.isAiEnabledOnSpace()&&n.push(Sp().e.AI),t&&n.push(Sp().e.Search),n}),[e,x]),I=w.length>1,k=m.currentTab||w[0],T=(0,i.useCallback)((e=>{cp().AW(s,{tab:k,surface:"workspace",analytics_tab_session_id:m.analyticsTabSessionId,analytics_tab_session_time_start:m.analyticsTabSessionStartTime,settings_session_id:c});const t=dp().JW(),n=Date.now();cp().Wt(s,{tab:e,surface:"workspace",analytics_tab_session_id:t,analytics_tab_session_time_start:n,settings_session_id:c});const i={...m,currentTab:e,analyticsTabSessionId:t,analyticsTabSessionStartTime:n};f(i)}),[f,m,s,k,c]);(0,i.useEffect)((()=>{!async function(){const t=e.id;t&&Sp().A.shouldRefreshState(t)&&(k===Sp().e.Users?await M({graphFilter:"last_90_days",tableFilter:"last_90_days"}):k===Sp().e.Content||k===Sp().e.Overview||k===Sp().e.Search||k===Sp().e.AI||(0,rt().HB)(k))}()}));const C=(0,i.useCallback)((()=>{(0,Ol().L)({environment:s,url:(0,ut().x)("guides.workspaceAnalytics")})}),[s]),_=w.map((e=>Hp[e])),P=b?(0,le.jsx)(bp().H,{type:"disabled",spaceName:S}):(0,le.jsxs)(le.Fragment,{children:[I?(0,le.jsx)(Hs().LZ,{tabs:_,selectedIndex:w.indexOf(k),onChange:e=>{T(w[e])},style:t.tabsStyle,right:k===Sp().e.AI?(0,le.jsx)(fp,{currentFilter:h,onChangeFilter:j}):void 0}):void 0,Yp({currentTab:k,spaceAnalyticsStoreState:m,onUserTabFilterChange:M,spaceStore:e,contentEngagementData:p,userEngagementData:g,aiAnalyticsDateRange:h})]});return(0,le.jsxs)(Xe().Ay,{children:[(0,le.jsxs)(ve().A,{large:!0,style:t.headingStyle,children:[(0,le.jsxs)("div",{style:t.title,children:[(0,le.jsx)(v().sA,{id:"settings.workspaceAnalytics.title",defaultMessage:"Workspace analytics"}),(0,le.jsx)(je().m,{placement:"right",render:e=>(0,le.jsx)(tn().A,{...e,href:(0,ut().x)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:t.helpInfo}),renderTooltip:()=>(0,le.jsx)(v().sA,{id:"settings.workspaceAnalytics.dataDisclaimerTooltip",defaultMessage:"Data available from the start date of your Enterprise Plan up to the last 365 days"})})]}),(0,le.jsx)(_t().A,{size:"sm",onClick:C,iconLeading:{icon:El().questionMarkCircleSmallIcon,size:"sm"},children:(0,le.jsx)(v().sA,{id:"workspaceAnalytics.title.helpButton",defaultMessage:"Learn more"})})]}),P]})};var Qp=()=>n(438139);const Zp=new(Fe().O2)("SpaceProfileSettings",(()=>n.e(30001).then(n.bind(n,510586)))),Xp=(0,Fe()._h)(Zp,(e=>e.SpaceProfileSettings));var Jp=()=>n(785125),eg=()=>n(804773),tg=()=>n(201794),ng=()=>n(86269),ig=()=>n(569288),sg=()=>n(90907),og=()=>n(207207),ag=()=>n(889074),rg=()=>n(835607),lg=()=>n(127361),dg=()=>n(807778);var cg=()=>n(471327);function ug(e){const t=(0,a().v3)(),{onView:n}=e,s=(0,v().tz)();(0,i.useEffect)((()=>{n(t)}),[t,n]);const o=s.formatMessage({id:"settingsPrompt.learnMore.button",defaultMessage:"Learn more"});return(0,le.jsxs)("div",{children:[(0,le.jsx)(at().A,{size:0}),(0,le.jsx)(cg().X,{icon:e.icon,title:e.title,description:e.descriptionMessage,onDismiss:e.onDismiss,primaryAction:{text:e.buttonText,onClick:t=>(e.onDismiss(),e.onClick(t)),ariaLabel:e.buttonAriaLabel},secondaryAction:{icon:El().questionMarkCircleSmallIcon,text:o,ariaLabel:o,onClick:e.onClickLearnMore}})]})}var pg=()=>n(171347);function gg(){const e=(0,l().O$)(Ve().AppStoreSidebarSpaceStore);return e?(0,le.jsx)(mg,{spaceStore:e}):null}function mg({spaceStore:e}){const t=(or({spaceStore:e,requestType:"guest"})??0)+(or({spaceStore:e,requestType:"member"})??0),n=(0,d().IS)((()=>({container:{position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",insetInlineEnd:6,top:6},badge:{top:-3,insetInlineEnd:-5}})),[]);return 0===t?null:(0,le.jsx)("div",{style:n.container,children:(0,le.jsx)(pg().$,{count:t,style:n.badge})})}var fg=()=>n(881738),hg=()=>n(925720),yg=()=>n(278223);function vg(e,t,n){const{disablePublicAccess:i,disableGuests:s,disableMoveToSpace:o,disableExport:a,disableSpacePageEdits:r,disablePublicAccessRequests:l,disableTeamCreation:d,disableMembershipRequests:c,disableExternalMembershipRequests:u,disableGuestMembershipRequests:p,disableTeamGuests:g,disableGuestPrivatePages:m,enableGuestInviteRequests:f,enableAiTraining:h,zeroRetentionEnabled:y,disableMemberUpgradeRequests:v,rolesThatCanAddRestrictedMembersToTeamspaces:b,rolesThatCanAddRestrictedMembersToPages:S,enablePermissionGroupRestrictedMembers:x}=e.state;Ft().createAndCommit({userAction:"SpaceSettings.attemptCloseCurrentTab",environment:n,canUndo:!0,perform:e=>{(0,hg().l)({environment:n,disablePublicAccess:i,disableGuests:s,disableMoveToSpace:o,disableExport:a,disableSpacePageEdits:r,disablePublicAccessRequests:l,transaction:e,spaceStore:t,disableTeamCreation:d,disableMembershipRequests:c,disableExternalMembershipRequests:u,disableGuestPrivatePages:m,disableGuestMembershipRequests:p,disableTeamGuests:g,enableGuestInviteRequests:f,enableAiTraining:Boolean(h),zeroRetentionEnabled:Boolean(y),disableMemberUpgradeRequests:Boolean(v),rolesThatCanAddRestrictedMembersToTeamspaces:b,rolesThatCanAddRestrictedMembersToPages:S,enablePermissionGroupRestrictedMembers:x})}})}function bg(){E().A.reset(),z.reset()}async function Sg(e){const{onAcceptOrCancel:t,environment:n,spaceStore:i,spaceBasicSettingsStore:s,spaceProfileSettingsStore:o,securitySettingsStore:a}=e,{currentUserStore:r,currentUserSettingsStore:l}=Ve().default.state;if(!r||!l)throw new Error("No user or settings store.");const d=(0,le.jsx)(v().sA,{id:"spaceSettings.closeSettingsDialog.confirmationMessage",defaultMessage:"Your changes have not been saved. Save changes?"}),c=(0,le.jsx)(v().sA,{id:"spaceSettings.closeSettingsDialog.confirmationButton.label",defaultMessage:"Yes"}),u=(0,le.jsx)(v().sA,{id:"spaceSettings.closeSettingsDialog.cancelationButton.label",defaultMessage:"No"}),{currentTab:p}=Qe().Ay.state;if("profile"===p){if(!un().n4(o.state,o.getValueForUser(r,l,k().A.getIntl()))){const{profilePhoto:e,name:i,startDayOfWeek:s}=o.state;return i?T().ui({message:d,showCancel:!0,keepFocus:!0,items:[{label:(0,le.jsx)(v().sA,{id:"spaceSettings.closeSettingsDialog.updateSettingsButton.label",defaultMessage:"Update"}),color:"blue",onAccept:()=>{Ft().createAndCommit({userAction:"SpaceSettings.attemptCloseCurrentTab",environment:n,canUndo:!0,perform:t=>{const{currentUserStore:n}=Ve().default.state;if(n&&fg().b({userStore:n,data:{name:i,profilePhoto:e},transaction:t}),l){const e=l.getSettings();(null==e?void 0:e.start_day_of_week)!==s&&(0,Ss().m)({userSettingsStore:l,data:{start_day_of_week:s},transaction:t})}}}),t()}}],handleCancel:()=>{t()}}):T().f1((0,le.jsx)(v().sA,{id:"profileSettings.personalInfoSection.nameMissing.message",defaultMessage:"Please fill in name."})),!0}t()}else if("settings"===p&&i.canEdit()){const e=!un().n4(a.state,a.getValueForSpace(i)),o=!un().n4(s.state,s.getValueForSpace(i));if(e||o){const{accept:r}=await T().Gh({message:d,acceptLabel:c,cancelLabel:u});return r?(o&&(0,yg().E)({environment:n,spaceStore:i,spaceBasicSettingsStore:s}),e&&vg(a,i,n),t()):t(),!0}t()}else if("audit_log"===p)bg(),t();else if("analytics"===p)Sp().A.reset(),t();else if("plans"===p&&i.canAdmin()){const e=a.getValueForSpace(i);!un().n4(a.state,a.getValueForSpace(i))&&e&&(a.setState(e),vg(a,i,n)),t()}else t();return!1}var xg=()=>n(334600);function Mg({tab:e}){const t=(0,a().v3)(),n=(0,l().O$)(Ve().AppStoreSidebarSpaceStore);return(0,l().K8)((()=>"members"===e&&t.device.isDesktop&&(null==n?void 0:n.canEditMembership())&&(0,ae().x3)()&&!(0,ae().bW)()&&Ia().A.state.count>0),[e,t,n])?(0,le.jsx)(hd().m,{color:Mt().Tj.red.icon.accentPrimary}):null}function Ag({tab:e,spaceStore:t,onTabClick:n}){const s=(0,v().tz)(),{itemRef:o,onKeyDown:a,onFocus:r,isTabbable:u}=(0,eg().e)(),p=(0,l().K8)((()=>t.id),[t]),m=(0,g().lh)({spaceId:p}),h=(0,l().K8)((()=>Qe().Ay.state.currentTab===e),[e]),b=(0,l().K8)((()=>(0,xg().Op)(e,t)),[t,e]),S=Boolean((0,ps().y)()),x=(0,l().K8)((()=>!function(e,t){return!!c().A.state.online||!(!t||!["offline","mobile_native"].includes(e))}(e,S)),[e,S]),M=(0,li().$)(),A=(0,l().K8)((()=>null==M?void 0:M.getFullName(s)),[M,s]),j=(0,i.useMemo)((()=>function({currentUserStore:e,userFullName:t}){return{icon:(0,le.jsx)(Ai().A,{size:22,hasTooltip:!0,avatarShouldShowShadow:!0,userStore:e,style:{display:"flex",alignItems:"center",justifyContent:"center",lineHeight:0}}),title:t??(0,le.jsx)(v().sA,{id:"spaceSettings.sidebar.personalSettingsSection.userDetails.title",defaultMessage:"Me"})}}({currentUserStore:M,userFullName:A})),[M,A]),{animationState:w,animationTriggers:I}=(0,ng().lP)(),k=(0,i.useMemo)((()=>function({isSubscribed:e,animationState:t,disabled:n}){return e?{icon:ag().O,title:La().D.explorePlansTabTitle}:{icon:(0,le.jsx)(f().I,{type:"animated",icon:ig().C,animationState:t,size:"sm",colorPalette:"blue",colorVariant:n?"disabled":"accentPrimary"}),title:(0,le.jsx)(We().D,{styleKey:"bodyMedium",colorPalette:"blue",colorVariant:n?"disabled":"accentPrimary",children:(0,le.jsx)(v().sA,{...La().D.upgradePlanTabTitle})})}}({isSubscribed:(0,y().Fq)(m),animationState:w,disabled:x})),[m,w,x]),T=(0,l().K8)((()=>(0,ae().Qd)()),[]),C=(0,l().K8)((()=>(0,ae().bW)()),[]),_=(0,i.useMemo)((()=>function({enablePeopleSection:e,enableTeamspaceGuests:t}){return{icon:rg().F,title:t||e?La().D.peopleTabTitle:La().D.membersTabTitle,badge:e?(0,le.jsx)(gg,{}):null}}({enablePeopleSection:C,enableTeamspaceGuests:T})),[C,T]),{icon:P,title:B,badge:R}=(0,i.useMemo)((()=>{if((0,xg()._i)(e))switch(e){case"profile":return j;case"plans":return k;case"members":return _}return xg().WD[e]}),[e,j,k,_]),D=(0,d().eP)(),L=(0,d().IS)((()=>({title:{...x||h||"light"!==D?{}:{color:lg().Tk.gray[100]}},button:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingInline:6,paddingTop:4,paddingBottom:4,borderRadius:6,height:28,...h?{background:Mt().Tj.background.tertiaryTranslucent}:{}},buttonContent:{display:"flex",alignItems:"center",gap:8,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},pressedStyle:{background:Mt().Tj.buttonHoveredBackground}})),[x,h,D]);return b?(0,le.jsxs)(Me().Ay,{...I,ref:o,onKeyDown:a,onFocus:r,disallowTabbing:!u,role:"tab","aria-selected":h,"aria-controls":h?`settings-tabpanel-${e}`:void 0,id:`settings-tab-${e}`,disabled:x,hovered:h,ignoreLocalPressedState:!0,pressed:!1,pressedStyle:L.pressedStyle,style:L.button,onClick:t=>{if(h)return null;n(e)},testId:`settings-tab-${e}`,children:[(0,le.jsxs)("div",{style:L.buttonContent,children:[(0,le.jsx)(jg,{icon:P,disabled:x,isSelected:h}),(0,le.jsx)(We().D,{styleKey:"bodyMedium",colorVariant:x?"disabled":h?"primary":"secondary",style:L.title,children:B&&"object"==typeof B&&"defaultMessage"in B?(0,le.jsx)(v().sA,{...B}):B})]}),(0,le.jsxs)(qe().fI,{gap:2,alignItems:"center",children:[R,(0,le.jsx)(Mg,{tab:e})]})]}):null}function jg(e){const{icon:t,disabled:n,isSelected:i}=e;return(0,le.jsx)("div",{style:{width:24,height:24,flexShrink:0,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,Ys().lE)(t)?(0,le.jsx)(f().I,{icon:t,colorVariant:n?"disabled":i?"primary":"secondary"}):t})}function wg({spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:s,renderBelowPrompt:r}){const d=(0,a().v3)(),c=(0,v().tz)(),u=(0,l().K8)((()=>function(e){var t,n;const{sidebarSpaceViewStore:i,sidebarSpaceStore:s,currentUserStore:o}=Ve().default.state;if(!s||!(0,xg().Op)("analytics",s))return!1;if(null==o||!o.id)return!1;if(null==s||!s.isDefined())return!1;const a=null==i?void 0:i.getSettings();return"dismissed"!==(null==a||null===(t=a.space_analytics_settings_prompt)||void 0===t?void 0:t.status)&&"hidden"!==(null==a||null===(n=a.space_analytics_settings_prompt)||void 0===n?void 0:n.status)&&(ft().OV(e),!0)}(d)),[d]),p=(0,l().K8)((()=>Qe().Ay.state.sessionId),[]),g=(0,l().O$)(Ve().AppStoreSidebarSpaceStore),m=(0,l().K8)((()=>null==g?void 0:g.canAdmin()),[g]),f=(0,l().K8)((()=>function(e,t){var n,i;const{sidebarSpaceViewStore:s,sidebarSpaceStore:o,currentUserStore:a}=Ve().default.state;if(null==a||!a.id)return!1;if(null==o||!o.isDefined())return!1;const r=null==s?void 0:s.getSettings();return!("dismissed"===(null==r||null===(n=r.passkey_settings_prompt)||void 0===n?void 0:n.status)||"hidden"===(null==r||null===(i=r.passkey_settings_prompt)||void 0===i?void 0:i.status)||!t.state.accountSettings.hasPassword||t.state.accountSettings.hasPasskeys||(ft().mj(e),0))}(d,n)),[d,n]),h=(0,o().X)("passkey_nudges");if(u){const o=m?(0,le.jsx)(v().sA,{id:"enterpriseSpaceAnalyticsSettingsPrompt.caption.workspaceOwner",defaultMessage:"Explore how members are engaging with this workspace, common searches that are made, and content engagement metrics with workspace analytics."}):(0,le.jsx)(v().sA,{id:"enterpriseSpaceAnalyticsSettingsPrompt.caption.member",defaultMessage:"See how your content is performing by reviewing metrics like number of views or unique visitors using workspace analytics."});return(0,le.jsx)(ug,{onDismiss:()=>ft().Jm(d),onClick:()=>{Sg({onAcceptOrCancel:()=>{Qe().Ay.setState({...Qe().Ay.state,currentTab:"analytics",defaultSubtab:void 0}),s.reset(),S().Y7(d,{tab:"analytics",settings_session_id:p}),ft().p$(d)},environment:d,spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:n,securitySettingsStore:i})},onView:e=>{"enterprise"===(null==g?void 0:g.getSubscriptionTier())&&ft().p$(e)},onClickLearnMore:()=>{const e=(0,ut().x)("guides.workspaceAnalytics");(0,Ol().L)({environment:d,url:e})},descriptionMessage:o,title:(0,le.jsx)(v().sA,{id:"enterpriseSpaceAnalyticsSettingsPrompt.title",defaultMessage:"New workspace analytics"}),buttonText:(0,le.jsx)(v().sA,{id:"enterpriseSpaceAnalyticsSettingsPrompt.cta",defaultMessage:"View metrics"}),buttonAriaLabel:c.formatMessage({id:"enterpriseSpaceAnalyticsSettingsPrompt.cta",defaultMessage:"View metrics"}),icon:og().magnifyingGlassIcon})}return h&&f?(0,le.jsx)(ug,{onClick:()=>{Sg({onAcceptOrCancel:()=>{Qe().Ay.setState({...Qe().Ay.state,open:!0,currentTab:"profile",defaultSubtab:void 0,highlightedSetting:Qe().rF.Passkey}),S().Y7(d,{tab:"profile",settings_session_id:p})},environment:d,spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:n,securitySettingsStore:i})},onView:ft().VW,onDismiss:()=>ft().VI(d),onClickLearnMore:()=>{const e=(0,ut().x)("guides.passkeys");(0,Ol().L)({environment:d,url:e})},descriptionMessage:(0,le.jsx)(v().sA,{id:"passkeySettingsPrompt.description",defaultMessage:"Set up a passkey for faster, safer log-ins."}),title:(0,le.jsx)(v().sA,{id:"passkeySettingsPrompt.title",defaultMessage:"Enable passkeys for better protection"}),buttonText:(0,le.jsx)(v().sA,{id:"passkeySettingsPrompt.button.label",defaultMessage:"Enable passkeys"}),buttonAriaLabel:c.formatMessage({id:"passkeySettingsPrompt.button.ariaLabel",defaultMessage:"Enable passkeys"}),icon:sg().lockIcon}):r}function Ig({title:e,children:t}){return(0,le.jsxs)(qe().VP,{gap:2,alignItems:"stretch",children:[(0,le.jsx)("div",{style:{paddingInline:8,paddingTop:6,paddingBottom:6,textOverflow:"ellipsis",overflow:"hidden"},children:(0,le.jsx)(We().D,{styleKey:"captionMedium",colorVariant:"tertiary",children:e})}),t]})}function kg({spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:s,securitySettingsStore:r,spaceDomainSettingsStore:d,workspaceDiscoveryEligibility:c}){const u=(0,a().v3)(),p=(0,g().lh)({spaceId:e.id}),m=(0,l().K8)((()=>Qe().Ay.state.currentTab),[]),f=(0,md().U2)(e),{membershipType:h,isWorkspaceOwner:b}=(0,l().K8)((()=>({membershipType:null==f?void 0:f.getMembershipType(),isWorkspaceOwner:(null==f?void 0:f.isWorkspaceOwner())??!1})),[f]),x=(0,y().et)(p),M=function(e,t){const n=(0,A().T)(),i=(0,l().K8)((()=>(0,js().M)({spaceId:t.id,userId:n,enforceIdsCheck:!1,debugFrom:"SpaceSettings.useShouldRenderBillingTab"})),[n,t.id]),s=(0,g()._3)({spaceId:t.id});return!(!i||!s||e||!((0,y().Fq)(s)||s.paymentMethod||i.hasPaidNonzero))}(x,e),w=(0,l().K8)((()=>e.canAdmin()),[e]),I=function(){const e=(0,mt().L)(),t=(0,g().lh)({spaceId:null==e?void 0:e.id});return(0,l().K8)((()=>{if(!e)return!1;const n=e.canAdmin(),i=(0,y().AI)(t);return!xe().A.isMobile&&n&&(0,io().jR)(i)}),[t,e])}(),k=!xe().A.isMobile&&(0,Nc().V2)({minimumType:"member",membershipType:h}),T=(0,Nc().V2)({minimumType:"member",membershipType:h}),C=(0,ps().y)(),_=function(e){const t=(0,o().X)("mobile_native_plan_upgrade_tab_kill_switch"),n=(0,o().X)("samsung_disable_all_upgrades"),i=(0,tg().T)("isInstalledFromSamsungAppStore"),s=(0,tg().T)("isSamsungPreload");return!(e.device.isMobileNative&&(t||!s&&!i||n))}(u),P=(0,o().X)("notion_ai_settings_tab_v2"),B=(0,dg().QH)(),R=(0,dg().Yv)()&&(B||b)&&!P,[D,L,E,O,N]=(0,l().K8)((()=>{const e=(0,n(141966).l5)();return[e,e,e,e&&j().default.checkGate({gateName:"download_for_offline"}),e||j().default.checkGate({gateName:"design_previews_enabled"})]}),[]),F=(0,Ws().kg)(),U=(0,l().K8)((()=>{const t=n(423219).A.getData(u,{spaceId:e.id}),i=t&&(null==t?void 0:t.pointers.length)>0;return!xe().A.isMobile&&((0,n(87878).wA)({spaceStore:e})||i)}),[u,e]);(0,lc().A)({shouldPreserveTextSelection:!0,shouldPreserveBlockSelection:!0,shouldRestoreSelection:!0});const z=(0,l().K8)((()=>(0,n(470928).Ur)({environment:u,spaceStore:e})),[u,e]),K=(0,Nc().V2)({minimumType:"member",membershipType:h}),V=(0,Vu().J)(e),q=(0,l().K8)((()=>e.isAiEnabledOnSpace()),[e]),W=(0,o().X)("notion_ai_workspace_settings")&&(V||q),G=(0,n(109113).H)(),H=(0,l().K8)((()=>(0,n(311337).y)(u)),[u]),Y=(0,i.useCallback)((n=>{Sg({onAcceptOrCancel:()=>{Qe().Ay.setState({...Qe().Ay.state,currentTab:n,defaultSubtab:void 0}),d.reset(),S().Y7(u,{tab:n,settings_session_id:Qe().Ay.state.sessionId})},environment:u,spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:s,securitySettingsStore:r})}),[u,r,t,d,s,e]);return(0,le.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",overflow:"hidden",height:"100%"},children:[(0,le.jsx)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",paddingTop:8,paddingBottom:8,paddingInlineStart:8,paddingInlineEnd:8,gap:2,overflowY:"auto"},children:(0,le.jsx)(eg().Y,{direction:"vertical",children:(0,le.jsxs)("div",{role:"tablist","aria-orientation":"vertical",style:{display:"flex",flexDirection:"column",gap:12},children:[(0,le.jsxs)(Ig,{title:(0,le.jsx)(v().sA,{id:"spaceSettings.sidebar.personalSettingsSection.title",defaultMessage:"Account"}),children:[(0,le.jsx)(Ag,{spaceStore:e,onTabClick:Y,tab:"profile"}),(0,le.jsx)(Ag,{spaceStore:e,onTabClick:Y,tab:"user_settings"}),(0,le.jsx)(Ag,{spaceStore:e,onTabClick:Y,tab:"notifications"}),T?(0,le.jsx)(Ag,{spaceStore:e,onTabClick:Y,tab:"connected_apps"}):void 0,C?(0,le.jsx)(Ag,{spaceStore:e,onTabClick:Y,tab:"offline"}):void 0]}),(0,le.jsxs)(Ig,{title:(0,le.jsx)(v().sA,{id:"spaceSettings.sidebar.workspaceSettingsSection.title",defaultMessage:"Workspace"}),children:[(0,le.jsx)(Ag,{spaceStore:e,onTabClick:Y,tab:"settings"}),(0,le.jsx)(Ag,{spaceStore:e,onTabClick:Y,tab:"members"}),(0,le.jsx)(Ag,{spaceStore:e,onTabClick:Y,tab:"teams"}),G?null:(0,le.jsx)(Ag,{spaceStore:e,onTabClick:Y,tab:"security"}),G?null:(0,le.jsx)(Ag,{spaceStore:e,onTabClick:Y,tab:"identity_provisioning"}),k?(0,le.jsx)(Ag,{spaceStore:e,onTabClick:Y,tab:"analytics"}):void 0,xe().A.isMobile?void 0:(0,le.jsx)(Ag,{spaceStore:e,onTabClick:Y,tab:"admin_content_search"}),xe().A.isMobile?void 0:(0,le.jsx)(Ag,{spaceStore:e,onTabClick:Y,tab:"audit_log"}),x?(0,le.jsx)(Ag,{spaceStore:e,onTabClick:Y,tab:"subscription"}):void 0,W?(0,le.jsx)(Ag,{spaceStore:e,onTabClick:Y,tab:"ai"}):void 0,z?(0,le.jsx)(Ag,{spaceStore:e,onTabClick:Y,tab:"verified_pages"}):void 0,K?(0,le.jsx)(Ag,{spaceStore:e,onTabClick:Y,tab:"public_pages"}):void 0,U?(0,le.jsx)(Ag,{spaceStore:e,onTabClick:Y,tab:"custom_emoji"}):void 0,(0,le.jsx)(Ag,{spaceStore:e,onTabClick:Y,tab:"integrations"}),xe().A.isMobile||H?void 0:(0,le.jsx)(Ag,{spaceStore:e,onTabClick:e=>{Y(e);const t=dp().JW();n(191227).A.setState({flowId:t}),n(559926).kY(u,{from:"settings",flowId:t})},tab:"imports"}),I?(0,le.jsx)(Ag,{spaceStore:e,onTabClick:Y,tab:"requests"}):null,M?(0,le.jsx)(Ag,{spaceStore:e,onTabClick:Y,tab:"billing"}):null,R?(0,le.jsx)(Ag,{spaceStore:e,onTabClick:Y,tab:"ai_usage_dashboard"}):null,c.shouldShowTab?(0,le.jsx)(Ag,{spaceStore:e,onTabClick:Y,tab:"workspace_discovery"}):void 0,_?(0,le.jsx)(Ag,{spaceStore:e,onTabClick:Y,tab:"plans"}):null]}),D?(0,le.jsxs)(Ig,{title:(0,le.jsx)(v().sA,{id:"spaceSettings.sidebar.developmentSettingsSection.title",defaultMessage:"Development"}),children:[L?(0,le.jsx)(Ag,{spaceStore:e,onTabClick:Y,tab:"experiments"}):void 0,F?(0,le.jsx)(Ag,{spaceStore:e,onTabClick:Y,tab:"performance_toolbar"}):void 0,E?(0,le.jsx)(Ag,{spaceStore:e,onTabClick:Y,tab:"user_similarity_scores"}):void 0,L?(0,le.jsx)(Ag,{spaceStore:e,onTabClick:Y,tab:"collection_debug"}):void 0,O?(0,le.jsx)(Ag,{spaceStore:e,onTabClick:Y,tab:"offline_mode_debug"}):void 0,D&&u.device.isMobileNative&&u.device.isAndroid?(0,le.jsx)(Ag,{spaceStore:e,onTabClick:Y,tab:"mobile_native"}):void 0]}):void 0,N?(0,le.jsx)(Ig,{title:(0,le.jsx)(v().sA,{id:"spaceSettings.sidebar.qaSettingsSection.title",defaultMessage:"QA"}),children:N?(0,le.jsx)(Ag,{spaceStore:e,onTabClick:Y,tab:"design_previews"}):void 0}):void 0]})})}),(0,le.jsx)(wg,{spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:s,securitySettingsStore:r,spaceDomainSettingsStore:d,renderBelowPrompt:w?(0,le.jsx)(n(204486).Zy,{currentSettingsTab:m}):null})]})}const Tg=i.memo(kg);function Cg(){const e=(0,a().v3)(),{isAndroid:t,isMobileNative:n}=e.device,s=(0,i.useCallback)((()=>{e.mobileNative&&e.mobileNative.openInternalSettings()}),[e]);return i.useEffect((()=>{n&&t&&e.mobileNative&&s()}),[n,t,e.mobileNative,s]),(0,le.jsx)("div",{style:{padding:16,textAlign:"center"},children:(0,le.jsx)(v().sA,{id:"mobileNativeSettings.opening",defaultMessage:"Opening Internal Settings..."})})}function _g({spaceStore:e,userStore:t}){const s=(0,a().v3)(),o=(0,v().tz)(),{open:c,currentTab:g,openedFrom:m,upsellType:f,sessionId:h}=(0,l().K8)((()=>{const{open:e,currentTab:t,openedFrom:n,upsellType:i,sessionId:s}=Qe().Ay.state;return{open:e,currentTab:t,openedFrom:n,upsellType:i,sessionId:s}}),[]),y=(0,l().uB)(void 0,n(194763).A),x=(0,l().uB)(void 0,vs().A),A=(0,l().uB)(void 0,Cn().A),j=(0,l().uB)(void 0,wa),w=(0,l().uB)(void 0,Xr);(0,r().l)((()=>{const t=A.getValueForSpace(e);t&&A.setState(t)})),(0,r().l)((()=>{M().Q(s,x)})),(0,i.useEffect)((()=>{c&&S().bt(s,{tab:g,from:m,upsell_type:f,settings_session_id:h})}),[c]);const I=(0,i.useCallback)((()=>{n(224701).x(s),bg(),b().Wy({environment:s,spaceId:e.id,canAdmin:e.canAdmin()})}),[s,e]),k=(0,i.useCallback)((()=>{Sg({onAcceptOrCancel:()=>{Qe().Ay.setState({...Qe().Ay.state,open:!1,sessionId:void 0}),n(760183).A.reset(),w.reset(),bg(),Ia().A.reset()},environment:s,spaceStore:e,spaceBasicSettingsStore:y,spaceProfileSettingsStore:x,securitySettingsStore:A})}),[s,e,y,x,A,w]),T=(0,d().IS)((()=>({modalInner:{width:1150,maxWidth:"calc(100vw - 100px)",height:"calc(100% - 100px)",overflow:"hidden",borderRadius:12,maxHeight:715}})),[]);return(0,le.jsx)(u().a,{ariaLabel:o.formatMessage({id:"spaceSettings.dialogLabel",defaultMessage:"Settings & members"}),open:c,innerStyle:T.modalInner,onOpen:I,onDismiss:k,render:()=>(0,le.jsx)(Eg,{spaceStore:e,userStore:t,spaceBasicSettingsStore:y,spaceProfileSettingsStore:x,securitySettingsStore:A,samlSettingsStore:j,spaceDomainSettingsStore:w,onModalDismiss:k}),className:p().w7$})}function Pg({spaceStore:e}){const t=(0,l().K8)((()=>(0,ae().bW)()),[]),n=(0,l().K8)((()=>Ia().A.state.count),[]);return t?(0,le.jsx)(ip,{spaceStore:e}):(0,le.jsx)(Ma().A,{spaceStore:e,unreadAccessRequests:n})}function Bg({spaceStore:e}){const t=(0,a().v3)(),n=(0,l().O$)(m().subscriptionDataStoreInstance),i=(0,g()._3)({spaceId:e.id}),s=(0,l().K8)((()=>Tr().A.getData(t,{spaceId:e.id})),[e,t]),o=(0,l().K8)((()=>kr().L.getData(t,{spaceId:e.id})??[]),[e,t]);if(i){if((0,y().Fq)(i)){const t=ws().BA(n);return t?(0,le.jsx)(Ca().tN,{spaceStore:e,billingData:i,upcomingInvoiceData:s,customerData:t,billingEvents:o}):null}return(0,le.jsx)(za,{spaceStore:e,billingData:i,billingEvents:o})}return null}function Rg(){const e=(0,l().K8)((()=>(0,Vs().LB)()),[]),t=(0,l().K8)((()=>(0,Vs().jw)()),[]);return(0,le.jsx)(Xe().Ay,{children:(0,le.jsx)(Ks().A,{genericImporterEnabled:e,zipImporterEnabled:t})})}function Dg({spaceProfileSettingsStore:e,billingData:t}){const n=(0,y().eh)(t,"student");return(0,le.jsx)(Xp,{isEducationPlan:n,spaceProfileSettingsStore:e})}function Lg(){const e=(0,d().IS)((()=>({container:{display:"flex",flexDirection:"column",alignItems:"center",gap:6}})),[]);return(0,le.jsx)(Xe().Ay,{centerContent:!0,children:(0,le.jsxs)("div",{style:e.container,children:[(0,le.jsx)(f().I,{icon:h().C,size:"lg",colorVariant:"secondary"}),(0,le.jsx)(Jp().g,{isSecondaryColor:!0})]})})}function Eg({spaceStore:e,userStore:t,spaceBasicSettingsStore:n,spaceProfileSettingsStore:d,securitySettingsStore:u,samlSettingsStore:p,spaceDomainSettingsStore:m,onModalDismiss:f}){const{organizationOverrides:h}=(0,Aa().n)({spaceId:e.id}),y=(0,o().X)("settings_modal_close_button"),v=(0,l().K8)((()=>Qe().Ay.state.hideCloseButton??!1),[]),b=y&&!v,S=Boolean((0,ps().y)()),M=(0,l().O$)(c().e),A=(0,l().K8)((()=>Qe().Ay.state.currentTab),[]),w=function(e){const t=(0,a().v3)(),n=(0,l().K8)((()=>"professional"===(0,Cs().FX)()),[]),i=(0,l().K8)((()=>e.canRead()),[e]),s=(0,o().X)("should_request_joinable_spaces_for_workspace_discovery_surface"),r=n&&i&&s,[{value:d,status:c}]=(0,Rs().P)({environment:t,skipServerFetch:!r}),u=Boolean(null==d?void 0:d.hasJoinableSpaces),p=r&&u,g=(0,l().K8)((()=>!!p&&"on"===j().default.getEligibleGroup({experimentId:"workspace_discovery_show_in_settings",defaultGroup:"control"})),[p]);return{shouldShowTab:p&&g,isLoading:"pending"===c&&r}}(e);(0,i.useEffect)((()=>{if(!(0,xg().Op)(A,e)){const t=x().Yp(e);x().Ow({currentTab:t})}}),[A,e]),(0,i.useEffect)((()=>{if(!w.isLoading&&"workspace_discovery"===A&&!w.shouldShowTab){const t=x().Yp(e);x().Ow({currentTab:t})}}),[A,e,w.isLoading,w.shouldShowTab]),(0,r().w)((()=>{S&&!M&&"offline"!==A&&x().Ow({currentTab:"offline"})}));const I=(0,g()._3)({spaceId:e.id}),k=(0,l().K8)((()=>function(e){const{currentTab:t,spaceStore:n,userStore:i,spaceBasicSettingsStore:s,spaceProfileSettingsStore:o,securitySettingsStore:a,samlSettingsStore:r,spaceDomainSettingsStore:l,organizationOverrides:d,billingData:c,workspaceDiscoveryEligibility:u}=e,p={profile:()=>(0,le.jsx)(Dg,{spaceProfileSettingsStore:o,billingData:c}),notifications_and_settings:()=>(0,le.jsx)(st().A,{isMobile:!1,isMobileNative:!1,billingData:c}),user_settings:()=>(0,le.jsx)(Ms,{billingData:c}),notifications:()=>(0,le.jsx)(an,{}),language_and_region:()=>(0,le.jsx)(us,{}),connected_apps:()=>(0,le.jsx)(qi().e,{location:"settings-page",spaceStore:n}),offline:()=>(0,le.jsx)(qs().bG,{}),settings:()=>(0,le.jsx)(Qp().Co,{spaceStore:n,billingData:c,spaceBasicSettingsStore:s,securitySettingsStore:a,organizationOverrides:d}),requests:()=>(0,le.jsx)(wr,{securitySettingsStore:a,spaceStore:n}),workspace_discovery:()=>u.shouldShowTab?(0,le.jsx)(Ls,{}):null,teams:()=>(0,le.jsx)(Vi,{spaceStore:n}),members:()=>(0,le.jsx)(Pg,{spaceStore:n}),analytics:()=>(0,le.jsx)($p,{spaceStore:n}),plans:()=>(0,le.jsx)(qa().o3,{}),billing:()=>(0,le.jsx)(Bg,{spaceStore:n}),ai_usage_dashboard:()=>(0,le.jsx)(Ta,{spaceStore:n}),subscription:()=>(0,le.jsx)(Xe().Ay,{children:(0,le.jsx)(rn().L,{})}),security:()=>(0,le.jsx)(xa,{securitySettingsStore:a,spaceStore:n,organizationOverrides:d}),identity_provisioning:()=>(0,le.jsx)(gd,{spaceStore:n,userStore:i,samlConfigStore:r,domainSettingsStore:l}),admin_content_search:()=>(0,le.jsx)(Yr,{spaceStore:n,userStore:i}),integrations:()=>(0,le.jsx)(et,{spaceStore:n,userStore:i,organizationOverrides:d}),audit_log:()=>(0,le.jsx)(Xe().Ay,{children:(0,le.jsx)(Ne,{spaceStore:n})}),imports:()=>(0,le.jsx)(Rg,{}),sites:()=>(0,le.jsx)(Fs,{spaceStore:n}),public_pages:()=>(0,le.jsx)(Gs().fh,{spaceStore:n}),custom_emoji:()=>(0,le.jsx)(Os,{spaceStore:n}),verified_pages:()=>(0,le.jsx)(_r,{spaceStore:n}),experiments:()=>(0,le.jsx)(Xe().Ay,{children:(0,le.jsx)(it,{})}),performance_toolbar:()=>(0,le.jsx)(Xe().Ay,{children:(0,le.jsx)(Ws().dt,{})}),user_similarity_scores:()=>(0,le.jsx)(Xe().Ay,{children:(0,le.jsx)(Ts,{spaceStore:n})}),collection_debug:()=>(0,le.jsx)(Xe().Ay,{children:(0,le.jsx)(ze,{})}),offline_mode_debug:()=>(0,le.jsx)(Xe().Ay,{children:(0,le.jsx)(qs().Pz,{})}),ai:()=>(0,le.jsx)(Xe().Ay,{children:(0,le.jsx)(Ke().KZ,{spaceStore:n,billingData:c,securitySettingsStore:a})}),design_previews:()=>(0,le.jsx)(Xe().Ay,{children:(0,le.jsx)(zs,{})}),mobile_native:()=>(0,le.jsx)(Xe().Ay,{children:(0,le.jsx)(Cg,{})})};return(0,xg().Op)(t,n)?p[t]:()=>null}({currentTab:A,spaceStore:e,userStore:t,spaceBasicSettingsStore:n,spaceProfileSettingsStore:d,securitySettingsStore:u,samlSettingsStore:p,spaceDomainSettingsStore:m,organizationOverrides:h,billingData:I,workspaceDiscoveryEligibility:w})),[A,p,u,n,m,d,e,t,h,I,w]),T=(0,l().K8)((()=>!function(e,t){return!!c().A.state.online||!(!t||!["offline","mobile_native"].includes(e))}(A,S)),[A,S]);return(0,le.jsx)(s().A,{capture:!0,allowEsc:!0,render:t=>(0,le.jsxs)(Qr,{sidebar:(0,le.jsx)(Tg,{spaceStore:e,spaceBasicSettingsStore:n,spaceProfileSettingsStore:d,securitySettingsStore:u,spaceDomainSettingsStore:m,workspaceDiscoveryEligibility:w}),contentId:`settings-tabpanel-${A}`,contentLabelledBy:`settings-tab-${A}`,contentRole:"tabpanel",...t,children:[T?(0,le.jsx)(Lg,{}):k(),b?(0,le.jsx)(tt().A,{onClick:f}):null]})})}const Og=i.memo(_g)},580993:(e,t,n)=>{n.d(t,{U:()=>i});const i=(0,n(340498).xh)("lock",{default:{loader:()=>Promise.resolve().then(n.bind(n,90907))},small:{loader:()=>Promise.resolve().then(n.bind(n,642557))},fill:{loader:()=>Promise.resolve().then(n.bind(n,471095))},fillSmall:{loader:()=>Promise.resolve().then(n.bind(n,338862))}},["lock","closed","secure","padlock","privacy"])},603533:(e,t,n)=>{function i(){return 330}n.d(t,{W:()=>i})},603596:(e,t,n)=>{n.d(t,{Z:()=>b});var i=n(296540),s=()=>n(383036),o=()=>n(26697),a=()=>n(591779),r=()=>n(69708),l=()=>n(267271),d=()=>n(574036);var c=()=>n(598101),u=()=>n(968913),p=()=>n(959462),g=()=>n(12314),m=n(474848);const f=(0,r().YK)({name:{id:"action.availableOffline.name",defaultMessage:"Available offline"}});function h(e){return(0,u().DJ)(e)&&(0,u().Bd)(e)?n(671089).checkmarkCircleIcon:(0,u().DJ)(e)&&(0,u().SS)(e)?n(129852).exclamationMarkCircleIcon:n(973238).arrowInCircleDownIcon}function y(e){return(0,u().DJ)(e)}function v(e){return(0,u().Bd)(e)&&!y(e)}const b=(0,l().Ls)({key:"available offline",action:({analyticsFrom:e,blocks:t,environment:i})=>n(547149).createAndCommit({userAction:"actionRegistry.createToggleAction",environment:i,canUndo:!0,perform:()=>{const s=t[0];n(22472).lX({store:s,environment:i,analyticsFrom:e}).catch((()=>{}))}}),analyticsName:f.name.defaultMessage,closeParentMenu:!1,displayName:f.name,render:(e,t)=>{var i;const s=t.blocks[0],o=null===(i=t.pageContext)||void 0===i?void 0:i.spaceStore;return(0,m.jsx)(S,{icon:h(s.id),isChecked:y(s.id),isLoading:(a=s.id,void 0===p().A.state.offlinePages||(0,u().B1)(a)&&p().A.state.isSlowWrite),isOffline:!n(929219).A.state.online,listItemProps:e,showAutosyncTooltip:v(s.id),spaceStore:o});var a},validators:[(0,n(963335).S)("download_for_offline"),(0,n(422155).or)([n(929084).b,n(918871).w]),n(514779).M,(0,c().A)((function(e){const t=(0,n(876338).$)(e.pageContext);return(0,n(272509).I)(t)})),(0,c().A)(n(9402).P),(0,c().A)(n(340814).v),(0,c().A)(n(234347)._),(0,c().A)(n(395763).i)]});function S(e){const{icon:t,isChecked:c,isLoading:u,isOffline:p,listItemProps:h,showAutosyncTooltip:y,spaceStore:v}=e,b=(0,n(810312).EW)(),S=(0,i.useRef)(null),x=(0,g().pO)(),M=(0,n(590526).K8)((()=>"unavailable"===(null==b?void 0:b.type)&&!c),[null==b?void 0:b.type,c]),A=(0,a().lW)(y,200,((e,t)=>e===t)),j=(0,a().lW)(M,200,((e,t)=>e===t)),w=(0,a().lW)(u,n(79926)._M,((e,t)=>e===t)),I=({toggleIsDisabled:e})=>({disabled:e,disabledFeedback:e,icon:(0,m.jsx)(l().u5,{icon:t,isLoading:w}),on:c,title:(0,m.jsx)(r().sA,{...f.name})}),k=({toggleIsDisabled:e})=>(0,m.jsx)(o().m,{disableTooltip:!A,placement:"right",render:t=>(0,m.jsx)(d().A,{...(0,s().A)(h,t),...I({toggleIsDisabled:e})}),renderTooltip:()=>(0,m.jsx)(r().sA,{...l().AY.autoSyncedOfflinePageTooltip})});return p?k({toggleIsDisabled:!0}):x?(0,m.jsxs)("div",{ref:S,children:[(0,m.jsx)(d().A,{...h,...I({toggleIsDisabled:!1})}),(0,m.jsx)(g().qo,{originRef:S})]}):j?(0,m.jsx)(o().m,{allowHover:!0,placement:"right",textWrap:!0,render:e=>(0,m.jsx)(d().A,{...(0,s().A)(h,e),...I({toggleIsDisabled:!0})}),renderTooltip:e=>{const t=null==b?void 0:b.upsell;return(0,m.jsx)("div",{...e,children:(0,m.jsxs)(n(699143).Y1,{direction:"vertical",gap:4,style:{maxWidth:200},children:[t&&"product"===t.type?(0,m.jsx)(n(704658).UpgradeButton,{source:"offline_mode_settings",upsell:t,display:"text",width:"hug",size:"small",textColor:"inversePrimary",spaceStore:v}):null,(0,m.jsx)(n(493552).D,{colorVariant:"inverseSecondary",children:(0,m.jsx)(r().sA,{id:"action.availableOffline.abuseCapTooltip",defaultMessage:"Get an unlimited number of offline pages in your workspace"})})]})})}}):k({toggleIsDisabled:M})}},607810:(e,t,n)=>{n.d(t,{s:()=>a});var i=n(296540),s=()=>n(120997),o=n(474848);const a=i.memo((function({area:e,viewsMainTabId:t,children:a,className:r,style:l}){const{layoutBuilderModuleSelectionStore:d,layoutStore:c}=(0,n(937199).LH)(),u=(0,i.useCallback)((()=>{const n=d.state;if(null==n||!n.isDragging)return;const i=n.moduleId,o=c.getModuleById(i);o&&(0,s().p)(o,e)&&("page_main"===e&&c.isTabbedPageLayout()||d.setState({...n,draggingModuleFinalArea:{..."views_main_tab_modules"===e?{area:e,viewsMainTabId:t}:{area:e}}}))}),[e,d,c,t]),p=(0,i.useCallback)((()=>{const t=d.state;if(null==t||!t.isDragging)return;const n=t.moduleId,i=c.getModuleById(n);i&&(0,s().p)(i,e)&&d.setState({...t,draggingModuleFinalArea:t.draggingModuleInitialArea})}),[e,d,c]);return(0,o.jsx)("div",{onMouseEnter:u,onMouseLeave:p,className:r,style:l,children:a})}))},618841:(e,t,n)=>{n.d(t,{C:()=>u,A:()=>c});n(296540);var i=()=>n(562866),s=()=>n(79926);const o=new(s().O2)("SlackImportsInviteWithModal",(async()=>await n.e(68117).then(n.bind(n,559183)))),a=(0,s()._h)(o,(e=>e.SlackImportsInviteWithModal));var r=()=>n(803557),l=()=>n(437487),d=n(474848);function c(e){const{onInviteClick:t,onInviteComplete:n,buttonStyle:s,buttonContainerStyle:o,spacePermissionsSettingsStore:r,shouldAddMembers:l=!0}=e;return[{key:"slack_imports",render:()=>(0,d.jsx)(a,{inviteOrigin:"space_setting_slack_dropdown",canEditPermission:!0,onInviteClick:t,onInviteComplete:n,buttonLabel:(0,d.jsx)(i().$c,{type:"slack"}),buttonStyle:s,buttonContainerStyle:o,spacePermissionsSettingsStore:r,shouldAddMembers:l}),action:()=>{}},{key:"google_imports",render:()=>(0,d.jsx)(i().aI,{inviteOrigin:"space_setting_google_dropdown",canEditPermission:!0,onInviteClick:t,onInviteComplete:n,buttonLabel:(0,d.jsx)(i().$c,{type:"google"}),buttonStyle:s,buttonContainerStyle:o,spacePermissionsSettingsStore:r,shouldAddMembers:l}),action:()=>{}},{key:"microsoft_imports",render:()=>(0,d.jsx)(i().Xd,{inviteOrigin:"space_setting_microsoft_dropdown",canEditPermission:!0,onInviteClick:t,onInviteComplete:n,buttonLabel:(0,d.jsx)(i().$c,{type:"microsoft"}),spacePermissionsSettingsStore:r,shouldAddMembers:l}),action:()=>{}}]}function u(e){const{onClickAuthenticated:t,hideChevronIcon:n,containerStyle:s,buttonStyle:o,flowId:a}=e;return[{key:"slack_imports",render:()=>(0,d.jsx)(r().Xx,{onClickAuthenticated:({isAfterImportConnection:e})=>t(l().NL.Slack,!e),title:(0,d.jsx)(i().$c,{type:"slack"}),containerStyle:s,buttonStyle:o,from:"share_menu",inviteOrigin:"page_share_modal",flowId:a,loadContacts:!0,hideChevronIcon:n}),action:()=>{}},{key:"google_imports",render:()=>(0,d.jsx)(r().KG,{onClickAuthenticated:({isAfterImportConnection:e})=>t(l().NL.Google,!e),containerStyle:s,buttonStyle:o,from:"share_menu",inviteOrigin:"page_share_modal",flowId:a,loadContacts:!0,hideChevronIcon:n,buttonLabel:(0,d.jsx)(i().$c,{type:"google"})}),action:()=>{}},{key:"microsoft_imports",render:()=>(0,d.jsx)(r().PX,{onClickAuthenticated:({isAfterImportConnection:e})=>t(l().NL.Microsoft,!e),buttonLabel:(0,d.jsx)(i().$c,{type:"microsoft"}),from:"share_menu",inviteOrigin:"page_share_modal",loadContacts:!0,hideChevronIcon:n}),action:()=>{}}]}},620641:(e,t,n)=>{n.d(t,{E:()=>Y});n(944114),n(898992),n(672577),n(581454);var i=n(296540),s=()=>n(590526),o=()=>n(401497),a=()=>n(15258),r=()=>n(718827),l=()=>n(249046),d=()=>n(807449),c=()=>n(265060),u=()=>n(493552),p=()=>n(15785);const g=(0,n(340498).xh)("arrowStraightUp",{default:{loader:()=>n.e(72925).then(n.bind(n,112282))},small:{loader:()=>n.e(72925).then(n.bind(n,4688))},fill:{loader:()=>n.e(72925).then(n.bind(n,892936))},fillSmall:{loader:()=>n.e(72925).then(n.bind(n,107023))}},["arrow","right","direction","next","forward"]);var m=()=>n(390635),f=()=>n(792071),h=()=>n(72135),y=()=>n(96689),v=()=>n(69708),b=()=>n(100622),S=()=>n(284371),x=()=>n(187820),M=()=>n(453697),A=()=>n(317182),j=()=>n(79430),w=()=>n(235921),I=()=>n(523996),k=(n(354520),()=>n(484714)),T=()=>n(128933),C=()=>n(302996),_=()=>n(373399),P=()=>n(118307),B=()=>n(406094),R=()=>n(631524),D=()=>n(617668),L=()=>n(534663),E=()=>n(258467),O=n(474848);function N(e){const{joinableSpace:t,joinableSpaceIndex:n,isReimaginedStyles:a,joinContext:r="onboarding"}=e,{joinabilityStatus:l}=t,d="settings"===r,c="ADDED_AS_PAGE_GUEST"===l||"ADDED_AS_TEAMSPACE_GUEST"===l,u=(0,k().v3)(),p=(0,s().uB)(void 0,P().A),g=(0,o().IS)((()=>({actionButton:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",gap:4,height:32,width:"fit-content",fontSize:14,fontWeight:S().Wy.medium,paddingInlineStart:8,paddingInlineEnd:10,paddingTop:4,paddingBottom:4,marginInlineEnd:24},requestAccessButton:{paddingInlineStart:8,marginInlineEnd:24},reimaginedRequestAccessButton:{paddingInlineStart:8}})),[]),m=(0,i.useCallback)((async()=>{const e=I().jF.state.discoverableWorkspaces;if(u.currentUser.id){if(d&&"CAN_JOIN"===l){await(0,_().y)({environment:u,spaceId:t.id,userId:u.currentUser.id,joinableSpacesViewType:"workspace_discovery_table"});const n=e.filter((e=>e.id!==t.id));return I().jF.setState({...I().jF.state,discoverableWorkspaces:n,allDiscoverableWorkspacesCount:n.length}),void T().D6({label:(0,O.jsx)(v().sA,{id:"workspaceDiscovery.joinedSpace.success",defaultMessage:"Joined workspace"})})}if(d&&("CAN_REQUEST"===l||c)){const n=new(C().SpaceStore)(u,{table:y().NX,id:t.id});await(0,E().k7)({environment:u,inviteeUserId:u.currentUser.id,spaceStore:n});const i=e.map((e=>e.id===t.id?{...e,joinabilityStatus:"PENDING_REQUEST"}:e));return I().jF.setState({...I().jF.state,discoverableWorkspaces:i}),void T().D6({label:(0,O.jsx)(v().sA,{id:"workspaceDiscovery.requestAccess.success",defaultMessage:"Access requested"})})}await(0,L().N)({environment:u,result:t,index:n,joinableSpaces:e,buttonPopupStore:p,joinableSpaceViewType:"workspace_discovery_table"})}}),[u,t,n,p,d,c,l]);return a?(0,O.jsx)(R().p,{onClick:m,disabled:"PENDING_REQUEST"===l,colorPalette:"blue",disabledFeedback:"PENDING_REQUEST"===l,children:(0,O.jsx)(F,{joinabilityStatus:l})}):(0,O.jsx)(B().A,{style:g.actionButton,disabled:"PENDING_REQUEST"===l,onClick:m,iconLeading:{icon:D().plusIcon,colorVariant:"tertiary"},children:(0,O.jsx)(F,{joinabilityStatus:l})})}function F({joinabilityStatus:e}){switch(e){case"CAN_JOIN":return(0,O.jsx)(v().sA,{id:"workspaceDiscovery.joinSpaceButton.label",defaultMessage:"Join workspace"});case"CAN_REQUEST":case"ADDED_AS_PAGE_GUEST":case"ADDED_AS_TEAMSPACE_GUEST":return(0,O.jsx)(v().sA,{id:"workspaceDiscovery.requestAccessButton.label",defaultMessage:"Request access"});case"PENDING_REQUEST":return(0,O.jsx)(v().sA,{id:"workspaceDiscovery.accessRequestedForSpaceButton.label",defaultMessage:"Access requested"});default:return null}}const U=24,z={paddingInlineStart:U},K=1300,V=1100,q=1680,W=[{key:I().w1,header:(0,O.jsx)(v().sA,{defaultMessage:"Workspace",id:"workspaceDiscovery.joinableSpaces.nameColumnHeader.label"}),style:{width:"30%"}},{key:I().fH,header:(0,O.jsx)(v().sA,{defaultMessage:"Creator",id:"workspaceDiscovery.joinableSpaces.creatorColumnHeader.label"}),style:{width:"20%"}},{key:I().qZ,header:(0,O.jsx)(v().sA,{defaultMessage:"Members",id:"workspaceDiscovery.joinableSpaces.membersColumnHeader.label"}),style:{width:"20%"}},{key:"join",header:null,style:{width:"30%"}}],G=[{key:I().w1,header:(0,O.jsx)(v().sA,{defaultMessage:"Workspace",id:"workspaceDiscovery.joinableSpaces.nameColumnHeader.label"}),style:{width:"42%"}},{key:I().fH,header:(0,O.jsx)(v().sA,{defaultMessage:"Creator",id:"workspaceDiscovery.joinableSpaces.creatorColumnHeader.label"}),style:{width:"24%"}},{key:I().qZ,header:(0,O.jsx)(v().sA,{defaultMessage:"Members",id:"workspaceDiscovery.joinableSpaces.membersColumnHeader.label"}),style:{width:"14%"}},{key:"join",header:null,style:{width:"20%"}}],H=[{key:I().w1,header:(0,O.jsx)(v().sA,{defaultMessage:"Workspace",id:"workspaceDiscovery.joinableSpaces.nameColumnHeader.label"}),style:{width:"45%"}},{key:I().fH,header:(0,O.jsx)(v().sA,{defaultMessage:"Creator",id:"workspaceDiscovery.joinableSpaces.creatorColumnHeader.label"}),style:{width:"27%"}},{key:"join",header:null,style:{width:"28%"}}];function Y(e){const{joinableSpaces:t,title:n,styles:i,isReimaginedStyles:s,joinContext:o="onboarding"}=e,a="settings"===o;return(0,O.jsxs)(l().wt,{gap:22,style:i,children:[(0,O.jsx)(u().D,{styleKey:"bodyMedium",colorVariant:"primary",style:s||a?void 0:z,children:n}),(0,O.jsx)($,{joinableSpaces:t,isReimaginedStyles:s,joinContext:o})]})}function $(e){const{joinableSpaces:t,isReimaginedStyles:n,joinContext:o}=e,{columns:a,rows:r}=function(e){const{joinableSpaces:t,isReimaginedStyles:n,joinContext:o}=e,a=(0,s().K8)((()=>{var e;const{onboardingData:t}=w().A.state;return null==t||null===(e=t.userRootStore)||void 0===e?void 0:e.getSpaceViewStores().map((e=>e.getSpaceStore()))}),[]),{isNarrowScreen:r,isWideScreen:d}=ie(o),c=(0,s().K8)((()=>t.map(((e,t)=>{const{id:i,name:s,spaceIcon:d,createdBy:c,totalMemberCount:u,guestPageIds:p,requiredAuthStep:g}=e,m=null==a?void 0:a.find((e=>(null==e?void 0:e.id)===i)),f=[(0,O.jsx)(X,{spaceId:i,name:s,spaceIcon:d,spaceStore:m,sharedPageIds:p,requiredAuthStep:g,isReimaginedStyles:n,joinContext:o},`${i}-name`),(0,O.jsx)(ee,{createdBy:c,isReimaginedStyles:n,joinContext:o},`${i}-creator`)];return r||f.push((0,O.jsx)(te,{totalMemberCount:u,isReimaginedStyles:n,joinContext:o},`${i}-members-count`)),f.push((0,O.jsx)(l().wt,{alignItems:"flex-end",children:(0,O.jsx)(N,{joinableSpace:e,joinableSpaceIndex:t,isReimaginedStyles:n,joinContext:o})},`${i}-join`)),{key:i,columns:f}}))),[t,a,r,n,o]),u=r?H:d?W:G,p=(0,s().K8)((()=>I().jF.state.sort),[]),g=(0,i.useCallback)((e=>{if("join"===e)return;const t=p;let n="asc";t.type===e&&(n="asc"===t.order?"desc":"asc"),I().jF.setState({...I().jF.state,sort:{type:e,order:n}})}),[p]),m=u.map((e=>({key:e.key,header:(0,O.jsx)(Q,{column:e,joinContext:o,sortType:p.type,sortOrder:p.order,onSortableColumnClick:g,isReimaginedStyles:n}),style:e.style})));return{columns:m,rows:c}}({joinableSpaces:t,isReimaginedStyles:n,joinContext:o}),d=ne({isReimaginedStyles:n,joinContext:o});return(0,O.jsx)(A().A,{columns:a,rows:r,tableStyle:d.tableContainer,rowHoveredStyle:n?void 0:d.tableRowHoveredStyle,hideTopBorderForHeader:!0,hideBottomBorderForLastRow:!0,rowStyle:({rowIndex:e})=>n&&0!==e?d.row:void 0})}function Q(e){const{column:t,joinContext:n,sortType:i,sortOrder:s,onSortableColumnClick:o,isReimaginedStyles:a}=e,l="settings"===n,{header:d}=t;return"join"===t.key?null:(0,O.jsxs)(r().Ay,{style:{display:"flex",gap:4,alignItems:"center",width:"fit-content",padding:l?"2px 4px":void 0,borderRadius:l?4:void 0,marginInlineStart:a||l?0:U},onClick:()=>o(t.key),children:[d,i===t.key?(0,O.jsx)(Z,{sortOrder:s}):void 0]})}function Z(e){const{sortOrder:t}=e;return(0,O.jsx)(c().Q,{iconGroup:"asc"===t?p().u:g,variantName:"small",overrideSize:e=>e-4})}function X(e){const{spaceId:t,name:n,spaceIcon:i,spaceStore:s,sharedPageIds:o,requiredAuthStep:a,isReimaginedStyles:r,joinContext:c}=e,p=o.length>0,g=ne({isReimaginedStyles:r,joinContext:c}),f={maxWidth:p?"65%":"85%",...S().RC};return(0,O.jsxs)(l().Ye,{alignItems:"center",gap:4,style:g.columnLeftPadding,children:[(0,O.jsx)(x().B6,{icon:J(t,i),title:n,iconRecordCategory:"workspace",disabled:!0,bucket:"public",isEmptyPage:!1,size:24,emojiSize:24,style:g.spaceIcon,iconBoxStyles:g.spaceIconBox,placeholderStyle:g.spaceIconPlaceholder}),(0,O.jsx)("div",{style:f,children:(0,O.jsx)(u().D,{styleKey:r?"bodyMedium":"bodyRegular",colorVariant:r?"primary":"secondary",children:n})}),"required-saml-auth"===(null==a?void 0:a.type)?(0,O.jsx)("div",{style:g.lockIconContainer,children:(0,O.jsx)(d().I,{icon:m().shieldLockFillIcon,size:"sm"})}):null,(0,O.jsx)(j().R,{spaceStore:s,pageIds:o},`${t}-pages`)]})}function J(e,t){return t?{pointer:{table:y().NX,id:e},icon:t}:void 0}function ee(e){const{createdBy:t,isReimaginedStyles:n,joinContext:i}=e,s=(0,v().tz)(),o=null==t?void 0:t.profile_photo,a=(null==t?void 0:t.name)??s.formatMessage(f().Fvx.messages.anonymousPlaceholder),{isNarrowScreen:r}=ie(i),d=ne({isReimaginedStyles:n,joinContext:i}),c={maxWidth:r?"55%":"80%",...S().RC};return(0,O.jsxs)(l().Ye,{alignItems:"center",gap:8,style:d.columnLeftPadding,children:[o?(0,O.jsx)(M().A,{avatar:{name:a,avatarUrl:o},size:24,avatarShouldShowShadow:!1,isOffline:!1}):void 0,(0,O.jsx)(u().D,{styleKey:"bodyRegular",style:c,children:a})]})}function te(e){const{totalMemberCount:t,isReimaginedStyles:n,joinContext:i}=e,s=(0,v().tz)(),o=ne({isReimaginedStyles:n,joinContext:i});return(0,O.jsx)("div",{style:o.columnLeftPadding,children:(0,O.jsx)(u().D,{styleKey:"bodyRegular",style:o.memberCount,children:(0,O.jsx)(v().sA,{defaultMessage:"{totalMemberCount, plural, one {{totalMemberCount} member} other {{totalMemberCount} members}}",id:"workspaceDiscovery.joinableSpaces.membersCount",values:{totalMemberCount:(0,h().ZV)(t,"number_with_commas",s)}})})})}function ne(e){const{isReimaginedStyles:t,joinContext:n}=e,i="settings"===n;return(0,o().IS)((()=>({tableContainer:{fontSize:14,color:b().Tj.text.secondary,cursor:"default",tableLayout:"fixed"},tableRowHoveredStyle:{background:b().Tj.background.secondary},columnLeftPadding:{paddingInlineStart:i?0:t?void 0:U},spaceIcon:{borderRadius:6,fontSize:S().J.UISmall.desktop,fontWeight:S().Wy.light},spaceIconBox:{borderRadius:6},spaceIconPlaceholder:{fontWeight:500},memberCount:{maxWidth:"90%",...S().RC},lockIconContainer:{display:"grid",justifyContent:"center",alignItems:"center"},row:{borderTop:"none"}})),[t,i])}function ie(e){const t=(0,a().lW)();return(0,i.useMemo)((()=>{const n=t.width;return n<("settings"===e?V:K)?{isNarrowScreen:!0,isWideScreen:!1}:n>q?{isNarrowScreen:!1,isWideScreen:!0}:{isNarrowScreen:!1,isWideScreen:!1}}),[t.width,e])}},622311:(e,t,n)=>{n.d(t,{E:()=>s});n(898992),n(823215);var i=()=>n(499764);function s(e){return e.blocks.every((t=>Boolean(i().qb(e.environment,t,t.getSpaceStore()))))}},630223:(e,t,n)=>{n.d(t,{E:()=>o});n(16280);var i=n(296540),s=()=>n(943101);function o(e){const{children:t,onSizeChange:n}=e,o=(0,i.useRef)(null),a=(0,s().wY)(o);(0,i.useEffect)((()=>{n&&a&&n(a)}),[a,n]);const r=i.Children.only(t);return i.cloneElement(r,{ref:o})}},630230:(e,t,n)=>{n.d(t,{i:()=>s});n(296540);const i={viewBox:"0 0 20 20",fittedViewBox:"3.23 3.23 13.54 13.54",svg:(0,n(474848).jsx)("path",{d:"M7.491 8.375 3.418 4.302a.625.625 0 0 1 .884-.884L8.375 7.49V4a.625.625 0 0 1 1.25 0v5c0 .345-.28.625-.625.625H4a.625.625 0 1 1 0-1.25zm4.137 4.137v3.491a.625.625 0 1 1-1.25 0v-5c0-.345.28-.625.625-.625h5a.625.625 0 1 1 0 1.25h-3.491l4.07 4.07a.625.625 0 0 1-.884.884z"})},s=(0,n(340498).wt)("arrowCollapse",i,"default")},637096:(e,t,n)=>{n.d(t,{W:()=>c});var i=n(296540),s=()=>n(907258),o=()=>n(484714),a=()=>n(590526),r=()=>n(365917),l=()=>n(40970),d=()=>n(645200);function c(e){const{collectionContextStore:t,entrypoint:n}=e,c=(0,o().v3)(),u=(0,a().O$)(s().AppStoreSidebarSpaceStore),p=(0,a().O$)(r().X);return(0,i.useCallback)((()=>{const e=t.collectionViewStore(),i=t.collectionStore(),s=null==i?void 0:i.getParentBlockStore();e&&i&&s&&u&&(l().tC(c,{is_calendar_connected:p,collection_id:i.id,collection_view_id:e.id,collection_view_block_id:s.id,entrypoint:n}),d().Op({environment:c,collectionViewStore:e,spaceStore:u,from:"openInCalendarButton"}))}),[c,t,u,p,n])}},648526:(e,t,n)=>{n.d(t,{K:()=>i});const i="1.375em"},654856:(e,t,n)=>{n.d(t,{A:()=>p});n(581454);var i=n(296540),s=()=>n(726637),o=()=>n(590526),a=()=>n(352321),r=()=>n(69708),l=()=>n(743260),d=()=>n(299545),c=()=>n(417555),u=n(474848);const p=function(e){const{origin:t,permissionsInviteStore:p,store:g,handleClickRemoveToken:m,handleInputChange:f,handleInputSubmit:h,right:y,focus:v,handleFocus:b}=e,S=(0,o().K8)((()=>0!==(0,n(499764).Qo)()),[]),x="share_menu"===t||"add_members"===t,M="add_members"===t,[A,j]=(0,o().$y)(p),w=(0,n(484714).v3)(),{device:I}=w,k=(0,r().tz)(),{tokenQuery:T}=A,C=(0,n(101749).N)(g),_=A.inviteTargets.map((e=>{const t="newUser"===e.type?e.value.email:`${e.type}-${e.value.id}`,s=(0,l().yi)(e),o="newUser"===e.type||"existingUser"===e.type?e.value.email:void 0,a=s?C:void 0,d={key:t,target:e,onClickRemove:m,shouldWrap:x,showInfoIcon:Boolean(a)};return x&&o?(0,u.jsx)(n(26697).m,{placement:"top",disableTooltip:M,renderTooltip:()=>s?a||(0,u.jsx)(r().sA,{defaultMessage:"{email} will be invited as a guest",id:"ContextualInvite.permissions_invites.guest.tooltip",values:{email:o}}):o,render:n=>(0,i.createElement)("span",{...n,key:t},(0,u.jsx)(c().A,{...d,backgroundColor:(0,l().qv)(e)}))},t):(0,i.createElement)(c().A,{...d,key:t})})),P=0===A.inviteTargets.length;return(0,u.jsx)(a().Ay,{focus:s().A.isMobile?void 0:v,focusInitial:s().A.isMobile,focusAfterAnimation:!0,onClick:()=>{s().A.isMobile||null==b||b()},format:a().le.Share,value:T,onChange:f,type:"email",tokens:_,disabled:!1,autoComplete:"off",placeholder:x?S?k.formatMessage({defaultMessage:"Add people, groups, or emails…",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithTeams"}):k.formatMessage({defaultMessage:"Add emails or people",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithoutBots"}):(0,d().Yu)(g)||(0,d().nw)(g)?k.formatMessage({id:"inviteUserModal.searchInput.placeholder",defaultMessage:"Search name or emails"}):k.formatMessage({id:"permissionsInvite.searchInput.placeholder",defaultMessage:"Search emails, names, or groups"}),onRemoveLastToken:()=>{const e={...A};e.inviteTargets=e.inviteTargets.slice(0,-1),j(A)},right:y,inputFullWidth:!0,inputAndTokenWrapRightStyle:{paddingTop:s().A.isMobile||"add_members"===t?0:P?7:6,paddingBottom:s().A.isMobile||x?0:4},onEmptySubmit:()=>h(),dontShowBorderBottom:I.isAndroid,showBorder:x,...!x&&{style:{padding:"10px  9px 4px 9px"}},...x&&{style:{borderRadius:4,paddingTop:P?3:0,paddingBottom:0,...v&&{background:"none"}}}})}},669548:(e,t,n)=>{n.d(t,{w:()=>p});n(16280),n(18107),n(967357),n(898992),n(737550);var i=()=>n(907258),s=()=>n(388821),o=()=>n(179034),a=()=>n(37450),r=()=>n(807700),l=()=>n(644854),d=()=>n(544198),c=()=>n(594794),u=()=>n(863168);function p(e){var t,n;const{environment:p,createBlockItem:g,from:m,inMemoryRecordCache:f,transaction:h,selection:y}=e;if(!g.templateRootBlockId||!g.createTemplate)throw new Error("Invalid createBlock item.");const v=(y.length>0?y[0].getSpaceId():void 0)??e.spaceId??(null===(t=i().default.state.mainEditorCurrentBlockStore)||void 0===t?void 0:t.getSpaceId()),b=v?p.idCreator.getSpaceIdCreatorSync(v):void 0,S=y.some((e=>(0,r().l)(e))),x=g.createTemplate(p),{targetBlockStore:M}=(0,l().initializeTemplate)({environment:p,sourceBlockId:g.templateRootBlockId,targetBlockPointer:(0,c().zP)({environment:p,table:o().ev,spaceId:v}),sourceBlockSubtree:(0,s().partialRecordMapToRecordMap)(x),targetRecordCache:f,transaction:h,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!S,spaceIdCreator:b});null===(n=g.postCreateCallback)||void 0===n||n.call(g,M,p,h);const[A]=y;if(u().eY({environment:p,store:M,transaction:h,previousStore:A}),m&&g.blockType){var j;const e=g.collectionViewType,t="full_page"===e,n=0!==y.length?null===(j=y[0])||void 0===j?void 0:j.getParentCollectionIdUpToTwoLevels():void 0;let i,s,o,r;if("chart"===e){var w,I;const e=null===(w=M.getCollectionViewStores())||void 0===w?void 0:w.at(0);i=null==e||null===(I=e.getChartConfig())||void 0===I?void 0:I.type,s=null==e?void 0:e.getChartPlaceholderType()}if("form_editor"===e){var k;const e=null===(k=M.getCollectionViewStores())||void 0===k?void 0:k.at(0),t=null==e?void 0:e.getFormBlockStore();o=null==t?void 0:t.id,r=null==e?void 0:e.id}const{collectionId:l,ownedCollectionCount:c,linkedCollectionCount:u}=(0,d().P)(M,{skipPages:!1}),f={from:m,collection_id:l,owned_collection_count:c,linked_collection_count:u,view_type:"inline"===e||"full_page"===e?"table":e,is_toggleable:g.isToggleable,automation_id:M.getAutomationId(),new_page_id:"page"===g.blockType?M.id:void 0,creating_block_id:M.id,parent_collection_id:n,is_full_screen:t,chart_type:"placeholder"===i?s:i,is_chart_placeholder:"placeholder"===i,form_id:o,view_id:r},h=g.blockType;a().tP(h)?a().vH(p,{...f,type:h,collection_id:l||""}):a().vH(p,{...f,type:h})}return M}},676870:(e,t,n)=>{n.d(t,{EN:()=>s,Ex:()=>o,NZ:()=>a,T6:()=>r,kW:()=>l});var i=()=>n(564884);function s(e,t){(0,i().u)({environment:e,event:{eventName:"open_publish_modal",eventProperties:t}})}function o(e,t){(0,i().u)({environment:e,event:{eventName:"change_domain",eventProperties:t}})}function a(e,t){(0,i().u)({environment:e,event:{eventName:"update_seo_settings",eventProperties:t}})}function r(e,t){(0,i().u)({environment:e,event:{eventName:"page_unpublish",eventProperties:t}})}function l(e,t){(0,i().u)({environment:e,event:{eventName:"page_publish",eventProperties:t}})}},677169:(e,t,n)=>{n.d(t,{m:()=>o});var i=()=>n(590526),s=()=>n(110573);function o(){return(0,i().O$)(s().E)}},681242:(e,t,n)=>{n.r(t),n.d(t,{checkmarkShieldFillIcon:()=>s,iconDefinition:()=>i});n(296540);const i={viewBox:"0 0 20 20",fittedViewBox:"3.02 2.12 13.95 15.75",svg:(0,n(474848).jsx)("path",{d:"M9.698 2.196a.68.68 0 0 1 .604 0l1.89.945a7.4 7.4 0 0 0 3.32.784h.788c.373 0 .675.302.675.675v6.933a5.18 5.18 0 0 1-3.137 4.756l-3.572 1.531a.68.68 0 0 1-.532 0l-3.573-1.53a5.18 5.18 0 0 1-3.136-4.757V4.6c0-.373.302-.675.675-.675h.788c1.152 0 2.29-.268 3.32-.784zm3.178 5.782a.625.625 0 1 0-1.072-.643L9.25 11.59 7.814 9.916a.625.625 0 0 0-.949.814l2 2.333a.625.625 0 0 0 1.01-.085z"})},s=(0,n(340498).wt)("checkmarkShieldFill",i,"fill")},681621:(e,t,n)=>{n.r(t),n.d(t,{iconDefinition:()=>i,textTranslateSmallIcon:()=>s});n(296540);const i={viewBox:"0 0 16 16",fittedViewBox:"0.34 3.54 15.31 8.91",svg:(0,n(474848).jsx)("path",{d:"M11.946 4.174a.625.625 0 1 0-1.25 0v.648H7.619a.625.625 0 1 0 0 1.25h5.169c-.258.64-.722 1.487-1.466 2.381a10 10 0 0 1-1.075-1.564.625.625 0 0 0-1.095.603c.322.585.753 1.228 1.312 1.883A13 13 0 0 1 7.9 11.284a.625.625 0 0 0 .621 1.084 14.2 14.2 0 0 0 2.8-2.084c.756.727 1.68 1.443 2.801 2.084a.625.625 0 0 0 .622-1.084 13 13 0 0 1-2.564-1.91c1.06-1.242 1.663-2.445 1.936-3.302h.909a.625.625 0 1 0 0-1.25h-3.079zm-6.624 5.852.737 2.015a.625.625 0 0 0 1.174-.43l-2.6-7.109a.877.877 0 0 0-1.646 0l-2.599 7.11a.625.625 0 1 0 1.174.429l.736-2.015zm-.457-1.25h-2.11L3.81 5.891z"})},s=(0,n(340498).wt)("textTranslateSmall",i,"small")},682563:(e,t,n)=>{n.r(t),n.d(t,{gearFillIcon:()=>s,iconDefinition:()=>i});n(296540);const i={viewBox:"0 0 20 20",fittedViewBox:"2.83 2.82 14.36 14.36",svg:(0,n(474848).jsx)("path",{d:"M15.76 5.73c.12.16.12.39 0 .56l.01-.01-.74 1.05c-.11.16-.12.35-.05.52l.09.21c.07.18.22.31.4.34l1.25.22c.21.03.37.19.4.4.05.32.07.64.07.96V10c0 .36-.03.71-.08 1.05-.03.21-.2.36-.4.4l-1.27.22a.52.52 0 0 0-.4.33l-.09.21a.51.51 0 0 0 .04.52l.73 1.03c.12.17.13.4 0 .57-.19.26-.4.5-.63.74h-.01c-.25.25-.51.48-.79.69a.48.48 0 0 1-.56 0l-1.05-.74a.54.54 0 0 0-.52-.05l-.21.09a.53.53 0 0 0-.34.4l-.22 1.25c-.03.21-.19.37-.4.4-.32.05-.64.07-.96.07h-.02c-.36 0-.71-.03-1.05-.08a.49.49 0 0 1-.4-.4l-.22-1.27a.52.52 0 0 0-.33-.4l-.21-.09a.51.51 0 0 0-.52.04l-1.03.73a.48.48 0 0 1-.57 0c-.25-.19-.49-.4-.72-.64h-.01c-.25-.25-.48-.51-.69-.79a.48.48 0 0 1 0-.56L5 12.67c.11-.15.12-.34.05-.51l-.09-.21a.53.53 0 0 0-.4-.34l-1.25-.22a.47.47 0 0 1-.4-.4c-.05-.32-.07-.64-.07-.96v-.02c0-.36.03-.71.08-1.05.03-.21.2-.36.4-.4l1.27-.22a.52.52 0 0 0 .4-.33l.09-.21a.51.51 0 0 0-.04-.52l-.73-1.03a.48.48 0 0 1 0-.57c.19-.26.4-.5.63-.74h.01c.25-.26.51-.48.79-.69a.48.48 0 0 1 .56 0l1.05.74c.15.11.34.12.51.05l.21-.09a.53.53 0 0 0 .34-.4l.22-1.25c.03-.21.19-.37.4-.4.32-.05.64-.07.96-.07h.02c.36 0 .71.03 1.05.08.21.03.36.2.4.4l.22 1.27c.03.19.16.33.33.4l.21.09c.17.08.37.07.52-.04l1.03-.73c.17-.12.4-.13.57 0 .25.19.49.4.72.64h.01c.25.25.48.51.69.79M12.08 10c0-1.15-.93-2.08-2.08-2.08S7.92 8.85 7.92 10s.93 2.08 2.08 2.08 2.08-.93 2.08-2.08"})},s=(0,n(340498).wt)("gearFill",i,"fill")},687039:(e,t,n)=>{n.d(t,{Ay:()=>r,VH:()=>o});n(898992),n(803949),n(814603),n(147566),n(198721);var i=n(296540),s=n(474848);const o={"en-US":"en","ja-JP":"ja","ko-KR":"ko","fr-FR":"fr","de-DE":"de","pt-BR":"pt-BR","es-ES":"es-ES"};function a(e){return e.src?(0,s.jsx)("img",{alt:"",style:e.style,src:e.src}):null}const r=i.forwardRef((function(e,t){var o;const r=i.useRef(e);r.current=e;const l=i.useRef(void 0),[d,c]=i.useState(Boolean(e.customPlayButton)),[u,p]=i.useState(!1);i.useEffect((()=>{let t,n=!0;const i=()=>{const s=window.Vimeo;if(!s||!n)return;const o=document.getElementById(e.src);if(o)try{var a,d;if(t=new s.Player(o,{logging:!1}),l.current=t,!n||!t)return;t.on("play",(e=>{var t,n;c(!1),null===(t=(n=r.current).onPlay)||void 0===t||t.call(n,e)})),t.on("pause",(e=>{var t,n;null===(t=(n=r.current).onPause)||void 0===t||t.call(n,e)})),t.on("ended",(e=>{var t,n;null===(t=(n=r.current).onEnd)||void 0===t||t.call(n,e)})),null===(a=(d=r.current).onPlayerReady)||void 0===a||a.call(d,t),t.on("timeupdate",(e=>{var t,n;null===(t=(n=r.current).onTimeUpdate)||void 0===t||t.call(n,e)}))}catch(u){}else setTimeout(i,50)};if(window.Vimeo)i();else{const e=document.createElement("script");e.src="https://player.vimeo.com/api/player.js",e.onload=i,document.body.appendChild(e)}return()=>{if(n=!1,l.current=void 0,t)try{t.off("play"),t.off("pause"),t.off("ended"),t.off("timeupdate")}catch(e){}}}),[e.src]);const g=i.useCallback((()=>{const e=l.current;e&&(p(!0),e.play().catch((e=>{n(165358).log({level:"error",from:"VimeoVideoPlayer",type:"vimeo_play_failed",error:e})})))}),[]),m=function(e,t){const i=new URL(e);return(0,(()=>n(534177))().WP)(t).forEach((([e,t])=>{void 0!==t&&i.searchParams.set(e,String(t))})),i.toString()}(e.src,{texttrack:e.defaultTextTrack,playsinline:!1,dnt:(null===(o=e.options)||void 0===o?void 0:o.dnt)??!0,...e.options}),f=(0,n(401497).IS)((()=>({innerStyle:{position:"absolute",top:0,insetInlineStart:0,width:"100%",height:"100%",border:0,boxShadow:`0 1px 0 0 ${n(100622).Tj.border.secondary}`},customPlayButtonOverlay:{position:"absolute",top:0,width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"rgba(0, 0, 0, 0.4)",opacity:u?0:1,transition:"opacity 0.15s ease-out",pointerEvents:u?"none":"auto"}})),[u]);return(0,s.jsxs)(n(25500).A,{ratio:e.aspectRatioOverride??9/16,children:[(0,s.jsx)(a,{style:{...f.innerStyle,...e.preloadThumbnailStyle},src:e.preloadThumbnailSrc}),(0,s.jsx)("iframe",{ref:t,id:e.src,className:e.className,allowFullScreen:!0,src:m,style:{...f.innerStyle,...e.style}}),d&&e.customPlayButton?(0,s.jsx)("div",{style:f.customPlayButtonOverlay,children:(0,s.jsx)(n(160432).A,{onClick:g,size:"lg",colorPalette:"blue",children:e.customPlayButton})}):void 0]})}))},687110:(e,t,n)=>{n.r(t),n.d(t,{PageAnalyticsPageOptOut:()=>x,TopbarPageAnalyticsOptOutMenu:()=>S,TopbarPageAnalyticsOptOutMenuStore:()=>b});n(296540);var i=()=>n(664594),s=()=>n(907258),o=()=>n(135168),a=()=>n(726637),r=()=>n(484714),l=()=>n(590526),d=()=>n(127833),c=()=>n(30537),u=()=>n(396896),p=()=>n(416783),g=()=>n(69708),m=()=>n(72234),f=()=>n(232930),h=()=>n(443002),y=()=>n(702723),v=n(474848);const b=n(757695).Store.createValue({isOpen:!1,rect:void 0},{name:"TopbarPageAnalyticsOptOutMenuStore"});function S(){const e=(0,l().K8)((()=>b.state.isOpen),[]),t=(0,l().K8)((()=>b.state.rect),[]),n=(0,l().O$)(s().AppStoreMainEditorCurrentBlockStore);return n?(0,v.jsx)(d().zD,{popupType:a().A.isMobile?c().n.SlideUp:c().n.Popup,alignmentToOrigin:"center",open:e,render:()=>(0,v.jsx)("div",{style:{minWidth:360,padding:16},children:(0,v.jsxs)(u().VP,{gap:16,children:[(0,v.jsx)("div",{style:{fontSize:16,fontWeight:500},children:(0,v.jsx)(g().sA,{id:"TopbarPageAnalyticsOptOutMenu.heading",defaultMessage:"Privacy settings"})}),(0,v.jsx)(x,{store:n})]})}),originRect:t,onDismiss:()=>b.setState({isOpen:!1,rect:void 0})}):null}function x(e){const t=(0,r().v3)(),n=(0,i().T)(),{settings:s,spaceStore:a}=(0,l().K8)((()=>{const i=(0,o().f)(e.store);if(!i||!n)return{settings:void 0,spaceStore:void 0};const s=(0,h().H)({spaceStore:i,userId:n,environment:t});return{settings:null==s?void 0:s.getSettings(),spaceStore:i}}),[e.store,t,n]),d=(0,l().K8)((()=>{const t=null==s?void 0:s.page_analytics_opt_out_list;return null==t?void 0:t.includes(e.store.id)}),[s,e.store.id]);return(0,v.jsx)(y().A,{spaceStore:a,type:"dropdown",alignmentToOrigin:"end",currentOption:d?"do_not_record":"record",options:[{key:"record",label:(0,v.jsx)(g().sA,{id:"page_analytics.opt_out.record",defaultMessage:"Allow"})},{key:"do_not_record",label:(0,v.jsx)(g().sA,{id:"page_analytics.opt_out.do_not_record",defaultMessage:"Don’t allow"})}],onSelectOption:n=>{"do_not_record"===n?m().Oy(t,e.store.id):m().F3(t,e.store.id)},title:(0,v.jsx)(g().sA,{id:"page_analytics.opt_out.title",defaultMessage:"Show your view history"}),caption:(0,v.jsx)(g().sA,{id:"page_analytics.opt_out.caption",defaultMessage:"Page editors can see your view history for this page. <inlinelink>Learn more</inlinelink>.",values:{inlinelink:e=>(0,v.jsx)(p().V,{external:!0,href:(0,f().x)("guides.pageAnalytics"),children:e})}})})}},687633:(e,t,n)=>{n.d(t,{u:()=>s});var i=()=>n(314529);function s(e,t){(0,i().DO_NOT_USE_trackLegacy)(e,"template_gallery_public_page_topbar_click",t,{dontWait:!0})}},695689:(e,t,n)=>{n.d(t,{P:()=>i});const i=(0,n(69708).YK)({request:{id:"upgradeRequest.inAppRequests.request",defaultMessage:"Request"},pending:{id:"upgradeRequest.inAppRequests.requestPending",defaultMessage:"Pending"},approved:{id:"upgradeRequest.inAppRequests.requestApproved",defaultMessage:"Approved"},declined:{id:"upgradeRequest.inAppRequests.requestDeclined",defaultMessage:"Declined"},requestPendingTooltip:{id:"upgradeRequest.inAppRequests.requestPendingTooltip",defaultMessage:"You’ve already sent a request to your workspace owners"}})},701751:(e,t,n)=>{n.d(t,{p:()=>o});n(296540);var i=n(474848);const s={viewBox:"0 0 20 20",fittedViewBox:"3.97 1.94 14.91 15.66",svg:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{d:"M10.55 12.808a1.35 1.35 0 1 0-1.1 0v1.242a.55.55 0 1 0 1.1 0z"}),(0,i.jsx)("path",{d:"M15.4 1.95a3.48 3.48 0 0 0-3.48 3.48v1.92H6.4a2.425 2.425 0 0 0-2.425 2.425v5.4A2.425 2.425 0 0 0 6.4 17.6h7.2a2.425 2.425 0 0 0 2.425-2.425v-5.4A2.425 2.425 0 0 0 13.6 7.35h-.43V5.43a2.23 2.23 0 1 1 4.46 0v2.095a.625.625 0 1 0 1.25 0V5.43a3.48 3.48 0 0 0-3.48-3.48M5.225 9.775c0-.649.526-1.175 1.175-1.175h7.2c.649 0 1.175.526 1.175 1.175v5.4c0 .649-.526 1.175-1.175 1.175H6.4a1.175 1.175 0 0 1-1.175-1.175z"})]})},o=(0,n(340498).wt)("lockOpen",s,"default")},703875:(e,t,n)=>{n.d(t,{N:()=>o,V:()=>s});var i=()=>n(314529);function s(e){(0,i().DO_NOT_USE_trackLegacy)(e,"view_public_site_click")}function o(e,t){(0,i().DO_NOT_USE_trackLegacy)(e,"share_menu_tab_click",t)}},709906:(e,t,n)=>{n.d(t,{aj:()=>U,pJ:()=>V,B2:()=>K,Sg:()=>W,_4:()=>q,X:()=>_});n(296540);var i=()=>n(736847),s=()=>n(584262),o=()=>n(75756),a=n(474848);const r={viewBox:"0 0 20 20",fittedViewBox:"2.87 2.37 13 15.25",directional:!0,svg:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("path",{d:"M6.25 2.375A2.125 2.125 0 0 0 4.125 4.5v3.625h1.25V4.5c0-.483.392-.875.875-.875h7.5c.483 0 .875.392.875.875v11a.875.875 0 0 1-.875.875h-7.5a.875.875 0 0 1-.875-.875v-3.625h-1.25V15.5c0 1.174.951 2.125 2.125 2.125h7.5a2.125 2.125 0 0 0 2.125-2.125v-11a2.125 2.125 0 0 0-2.125-2.125z"}),(0,a.jsx)("path",{d:"M12.442 9.558a.625.625 0 0 1 0 .884l-2.5 2.5a.625.625 0 0 1-.884-.884l1.408-1.408H3.5a.625.625 0 0 1 0-1.25h7.016L9.058 7.942a.625.625 0 1 1 .884-.884z"})]})},l=(0,n(340498).wt)("arrowRightIntoRectangle",r,"default");var d=()=>n(589407),c=()=>n(864896);function u(e){(0,n(314529).DO_NOT_USE_trackLegacy)(e,"public_page_topbar_menu_sign_up_log_in_click",{},{dontWait:!0})}var p=()=>n(911909);n(898992),n(823215);var g=()=>n(622311);function m(e){const{environment:t}=e,i=t.RouterStore.state.route;return(0,n(651784).bh)(i)}var f=()=>n(514779),h=()=>n(775584);var y=()=>n(918871),v=()=>n(49533),b=()=>n(440902),S=()=>n(598101);n(18107),n(967357);var x=()=>n(578872);var M=()=>n(492414),A=()=>n(35889),j=()=>n(599364),w=()=>n(267271),I=()=>n(73926);const k=(0,n(69708).YK)({signUpOrLogInName:{id:"action.signUpOrlogIn.name",defaultMessage:"Sign up or log in"},shareLinkName:{id:"action.shareLink.name",defaultMessage:"Share link"},editPageName:{id:"action.editPage.name",defaultMessage:"Edit"},commentPageName:{id:"action.commentPage.name",defaultMessage:"Comment"},duplicatePageName:{id:"action.duplicatePage.name",defaultMessage:"Duplicate"},backtoNotionName:{id:"action.backtoNotion.name",defaultMessage:"Back to Notion"},topbarMobileMoreActionsMenu:{id:"action.topBarSiteMoreMobileActions.name",defaultMessage:"More"},search:{id:"topbar.publicPage.searchButton.label",defaultMessage:"Search"},reportFormName:{id:"action.reportForm.name",defaultMessage:"Report form"},viewOriginalPageName:{id:"action.viewOriginalPage.name",defaultMessage:"View original page"}}),T=(0,w().Ls)({key:"log in",displayName:k.signUpOrLogInName,analyticsName:k.signUpOrLogInName.defaultMessage,svg:l,validators:[(0,S().A)(f().M),function(e){const t=e.blocks.at(0);return!!t&&!x().hn(t)},(0,S().A)(m)],closeParentMenu:!0,action:async({environment:e})=>{u(e),await n(729283).VE(e,{utmContent:"sign_up_or_log_in",nextRoute:n(427704).JZ.login})}}),C=(0,w().Ls)({key:"view original page",displayName:k.viewOriginalPageName,analyticsName:k.viewOriginalPageName.defaultMessage,svg:n(47218).arrowExpandDiagonalBottomLeftToTopRightIcon,validators:[m],closeParentMenu:!0,action:({blocks:e})=>{const t=(0,M().Ay)({store:e[0],preferPublicLink:!0,pageVisitSource:s().y8.EmbedPublicPageViewOriginal,disableSlug:!0,embedded:!1});window.open(`${t}`,"_blank")}}),_=(0,w().Ls)({key:"report form",displayName:k.reportFormName,analyticsName:k.reportFormName.defaultMessage,svg:n(748054).M,validators:[g().E,n(59411).k],closeParentMenu:!0,action:({environment:e,blocks:t})=>{A().Hi(e,t[0].id)}}),P=(0,w().Ls)({key:"ios share link",displayName:k.shareLinkName,analyticsName:k.shareLinkName.defaultMessage,svg:c().Y,validators:[b().v,y().w,n(808565).u],closeParentMenu:!0,action:({blocks:e,environment:t})=>{const n=e[0],i=n.getNavigableBlockStore();if(i){const e=(0,M().Ay)({store:i,scrollToBlockId:i.id===n.id?void 0:n.id,fullyQualified:!0,pageVisitSource:s().y8.NativeShareLink,embedded:!1});t.mobileNative&&t.mobileNative.share(e)}}}),B=(0,w().Ls)({key:"web share link",displayName:k.shareLinkName,analyticsName:k.shareLinkName.defaultMessage,svg:c().Y,validators:[b().v,function({environment:{device:e}}){return e.isMobileBrowser}],closeParentMenu:!0,action:async({blocks:e})=>{const t=e[0],n=t.getNavigableBlockStore();if(n){const e=(0,M().Ay)({store:n,scrollToBlockId:n.id===t.id?void 0:t.id,fullyQualified:!0,pageVisitSource:s().y8.NativeShareLink,embedded:!1});try{await navigator.share({url:e})}catch{}}}}),R=(0,w().Ls)({key:"android share link",displayName:k.shareLinkName,analyticsName:k.shareLinkName.defaultMessage,svg:n(93460).b,validators:[b().v,y().w,n(875855).m],closeParentMenu:P.closeParentMenu,action:P.action}),D=(0,w().Fw)({key:"copy link",displayName:w().AY.copyLinkName,analyticsName:w().AY.copyLinkName.defaultMessage,svg:n(742852).linkIcon,shortcuts:["copyLinkToBlock"],validators:[f().M,b().v,(0,S().A)(y().w),(0,S().A)(v()._)],closeParentMenu:!0,track:{actionName:"copy_block_link"},lazyDependencyKeys:["clipboardActions"],action:(e,{environment:t,blocks:i},s)=>{const o=(0,n(231536).Y)("clipboardActions");o&&o.copyLinkToBlock({environment:t,blockStore:i[0],callback:e})}}),L=(0,w().Ls)({key:"edit page",displayName:k.editPageName,analyticsName:k.editPageName.defaultMessage,svg:n(105819).pencilLineIcon,validators:[(0,S().A)(p().JK),b().v,v()._,function(e){return!n(440375).l.state&&(!!e.blocks.every((e=>e.canEdit()))&&!!(0,g().E)(e))},(0,S().A)((function(e){return e.blocks.every((t=>{var i;return"edit"===(null===(i=n(619206).A.getMode(e.environment,t,t.getSpaceStore()))||void 0===i?void 0:i.permission)}))})),h().F],closeParentMenu:!0,action:({environment:e,blocks:t})=>{A().T7(e,t[0].id)}}),E=(0,w().Ls)({key:"comment page",displayName:k.commentPageName,analyticsName:k.commentPageName.defaultMessage,svg:n(49621).h,validators:[(0,S().A)(p().JK),b().v,v()._,n(930545).tm,(0,S().A)(f().M),h().F],closeParentMenu:!0,action:({environment:e,blocks:t})=>{A().aL(e,t[0].id)}}),O=(0,w().Ls)({key:"fork page",displayName:k.duplicatePageName,analyticsName:k.duplicatePageName.defaultMessage,svg:n(764781).V,validators:[b().v,h().F,v()._,function(e){return e.blocks.every((e=>n(499764).K1(e)))}],closeParentMenu:!0,action:({blocks:e,originRect:t,environment:i})=>{n(835435).Ul({environment:i,store:e[0],originRect:t})}});function N(e){return(0,w().Ls)({key:"more actions menu",displayName:k.topbarMobileMoreActionsMenu,analyticsName:k.topbarMobileMoreActionsMenu.defaultMessage,svg:d().ellipsisIcon,validators:[b().v,h().F,v()._],closeParentMenu:!0,action:e})}const F=(0,w().Ls)({key:"back to my content",displayName:k.backtoNotionName,analyticsName:k.backtoNotionName.defaultMessage,svg:n(182183).notionTintableIcon,validators:[f().M,h().F],closeParentMenu:!0,action:({environment:e},t)=>{const{currentUserRootStore:i,currentUserSettingsStore:o}=n(907258).default.state;i&&o&&(0,n(117484).t)({environment:e,userRootStore:i,userSettingsStore:o,pageVisitSource:s().y8.SwitchSpace})}}),U=(0,w().Ls)({key:"cookie settings",displayName:o().LS.cookieSettingsLabel,analyticsName:o().LS.cookieSettingsLabel.defaultMessage,validators:[(0,S().A)(n(733637).i),g().E],closeParentMenu:!1,render:e=>(0,a.jsx)(n(455215).A,{hasDismissButton:!1,renderOrigin:t=>{const{onClick:i,...s}=e;return(0,a.jsx)(n(575143).A,{...s,...t,title:n(675133).A.formatMessage(o().LS.cookieSettingsLabel),svg:n(212727).gearIcon})}}),action:()=>{}}),z=(0,w().Ls)({key:"search page",displayName:k.search,analyticsName:k.search.defaultMessage,svg:n(207207).magnifyingGlassIcon,validators:[b().v,h().F,v()._,function(e){const t=e.blocks.at(0);return!!t&&!x().Vg(t)}],closeParentMenu:!0,action:({environment:e})=>{n(321874)._N({environment:e,analyticsFrom:"public-page-topbar",isPublicPageSearch:!0})}});function K(e){return(0,w().gy)({key:"page",render:e=>(0,a.jsx)(i().A,{...e}),actions:[z,O,E,L,D,j().o,P,R,N(e)]})}function V(e){return(0,w().gy)({key:"page",render:e=>(0,a.jsx)(i().A,{...e}),actions:[B,P,R,N(e)]})}const q=[(0,w().gy)({key:"user",render:e=>(0,a.jsx)(i().A,{...e}),actions:[F,T,C]}),(0,w().gy)({key:"report page actions",render:e=>(0,a.jsx)(i().A,{...e}),actions:[I().H,_,U]})],W=[(0,w().gy)({key:"report page actions",render:e=>(0,a.jsx)(i().A,{...e}),actions:[I().H,U]})]},717162:(e,t,n)=>{n.d(t,{K0:()=>d,qw:()=>l});var i=()=>n(230711),s=()=>n(278729),o=()=>n(848538),a=()=>n(534177),r=()=>n(114871);function l(e){const{inviteTarget:t,spaceStore:n}=e,a=d(t);if(!a||"invalidUser"===t.type||"group"===t.type)return;if("newUser"===t.type){if((0,r().rP)(t)&&t.value.user_id){const e=s().V.createChildStore(n,(0,o().i1)({userId:t.value.user_id,spaceId:n.id}));if(e.isReady()){const t=function(e){return e.isPageGuest()?"guest":e.isRestrictedMember()?"restricted_member":e.isMember()?"member":void 0}(e);return{email:a,currentRole:t}}}return{email:a,currentRole:void 0}}const l=(0,i().dp)(n,t.value.id);if(!l.isReady())return;return{email:a,currentRole:l.isPageGuest()?"guest":l.isRestrictedMember()?"restricted_member":l.isMember()?"member":void 0}}function d(e){const{type:t}=e;switch(t){case"newUser":case"existingUser":return e.value.email;case"invalidUser":case"group":return;default:(0,a().HB)(t)}}},717250:(e,t,n)=>{n.d(t,{l:()=>i});const i="offline_mode_education_tooltip"},723931:(e,t,n)=>{n.r(t),n.d(t,{default:()=>M});var i=n(296540),s=()=>n(907258),o=()=>n(484714),a=()=>n(590526),r=()=>n(552712),l=()=>n(631524),d=()=>n(584262),c=()=>n(721479),u=()=>n(69708),p=()=>n(148024),g=()=>n(857783),m=()=>n(232930);class f extends(()=>n(757695))().Store{getInitialState(){return{open:!1}}}const h=new f;var y=()=>n(641001),v=n(474848);const b={fontSize:24,lineHeight:1.2,marginBottom:6,fontWeight:n(284371).Wy.bold,marginInlineEnd:"auto"},S={display:"flex",alignItems:"center",marginTop:8,marginBottom:18},x={padding:"24px 36px 24px",minWidth:300};const M=function(){const e=(0,a().O$)(h);return(0,v.jsx)(n(107975).a,{open:e.open,innerStyle:x,preventHideChildrenWhileOpening:!0,render:()=>(0,v.jsxs)(i.Fragment,{children:[(0,v.jsxs)("div",{style:S,children:[(0,v.jsx)("div",{style:b,children:(0,v.jsx)(u().sA,{id:"importModal.importButton.label",defaultMessage:"Import"})}),(0,v.jsx)(A,{})]}),(0,v.jsx)("div",{children:(0,v.jsx)(w,{modalState:e})})]}),onDismiss:j})};function A(){const e=(0,o().v3)();return(0,v.jsx)(r().N,{href:(0,m().x)("guides.import"),onClick:()=>p().FH(e,{from:"import"}),external:!0,children:(0,v.jsx)(l().p,{size:"sm",iconLeading:c().questionMarkCircleSmallIcon,colorPalette:"gray",children:(0,v.jsx)(u().sA,{id:"importModal.helpButton.label",defaultMessage:"Learn about importing"})})})}function j(){h.setState({open:!1})}function w({modalState:e}){const t=(0,o().v3)(),{mainEditorCurrentBlockStore:n,currentSpaceStore:i,currentSpaceViewStore:r,currentUserSettingsStore:l}=(0,a().K8)((()=>{const{mainEditorCurrentBlockStore:e,sidebarSpaceStore:t,sidebarSpaceViewStore:n,currentUserSettingsStore:i}=s().default.state;return{mainEditorCurrentBlockStore:e,currentSpaceStore:t,currentSpaceViewStore:n,currentUserSettingsStore:i}}),[]);return n&&i&&r&&l?(0,v.jsx)(y().A,{pageStore:e.open&&e.pageStore?e.pageStore:n,spaceStore:i,spaceViewStore:r,userSettingsStore:l,analyticsFrom:"modal",onComplete:e=>function(e,t){h.setState({open:!1}),g().uK({environment:t,store:e,pageVisitSource:d().y8.Import})}(e,t),readOnlyCreditButton:!1}):null}},730580:(e,t,n)=>{n.d(t,{V:()=>a});n(898992),n(823215);var i=()=>n(440375),s=()=>n(499764),o=()=>n(449195);function a(e){return!i().l.state&&e.blocks.every((t=>{if(s().QT(e.publicEditMode))return!1;const n=o().SE();return n?n.canEditCollection():t.canEdit()}))}},731120:(e,t,n)=>{n.d(t,{A:()=>i});class i extends(()=>n(757695))().Store{getInitialState(){return{isOpen:!1}}}},736026:(e,t,n)=>{n.d(t,{A:()=>s});class i extends(()=>n(757695))().Store{getInitialState(){return{open:!1}}}const s=new i},753397:(e,t,n)=>{n.d(t,{JN:()=>c,QB:()=>o,Sx:()=>a,Wt:()=>d,hR:()=>l,pT:()=>r,rU:()=>u});var i=()=>n(79926),s=()=>n(858038);const o=(0,i()._h)(s().U,(e=>e.GetNotifiedFor)),a=(0,i()._h)(s().U,(e=>e.UpdateSidebar)),r=(0,i()._h)(s().U,(e=>e.MobileInboxPopup)),l=(0,i()._h)(s().U,(e=>e.InboxActionsMenu)),d=(0,i()._h)(s().U,(e=>e.UnreadMentionsBadge)),c=(0,i()._h)(s().U,(e=>e.NotificationInboxPanelContent)),u=(0,i()._h)(s().U,(e=>e.AnimatedEmojiBadge))},754002:(e,t,n)=>{n.d(t,{_:()=>f});n(296540);var i=()=>n(484714),s=()=>n(590526),o=()=>n(401497),a=()=>n(611648),r=()=>n(911988),l=()=>n(917150),d=()=>n(127833),c=()=>n(30537),u=()=>n(100622),p=()=>n(132389),g=()=>n(111043),m=n(474848);function f(e){const{renderInner:t,innerStyle:n,onDismiss:f,onClosed:h,fullscreen:y}=e,v=(0,i().v3)(),b=(0,i().Y0)(),S=(0,s().K8)((()=>v.WindowSizeStore.isLandscape()),[v.WindowSizeStore]),x=(0,o().IS)((()=>{let e;return(y||S)&&(e="100%"),{popupStyle:{background:u().Tj.background.secondary,borderStartEndRadius:"24px",borderStartStartRadius:"24px",overflow:"hidden",width:"100%",height:e,display:"flex",alignItems:"center",justifyContent:"center"},scrollerStyle:{background:u().Tj.background.secondary,width:S?"80%":"100%",height:e,display:"flex",flexDirection:S?"row":"column",alignItems:"center",...n}}}),[S,n,y]),M=(0,s().K8)((()=>v.WindowSizeStore.getSafePaddingTopCSS(r().s1)),[v.WindowSizeStore]),A=(0,g().o)();return(0,m.jsx)(d().zD,{open:!0,hidesMobileNativeBottomBar:!0,preventBlockRenderQueueOnEnter:!0,popupType:c().n.SlideUp,onDismiss:f,onClosed:h,style:x.popupStyle,render:()=>(0,m.jsxs)(l()._,{type:S?a().A.Y:a().A.None,style:x.scrollerStyle,children:[(0,m.jsx)(p().A,{size:S?M:0}),t(),(0,m.jsx)(p().A,{size:A+(b.isMobileBrowser?32:0)})]})})}},755170:(e,t,n)=>{n.d(t,{S:()=>f,A:()=>h});var i=n(296540),s=()=>n(590526),o=()=>n(401497),a=()=>n(26697),r=()=>n(340498),l=()=>n(100622),d=()=>n(284371),c=()=>n(115512),u=()=>n(665579),p=()=>n(534177),g=n(474848);const m=function({additionalStyles:e,transitionMs:t,force:i,children:s}){const a=(0,n(827912).j)(),r=(0,o().IS)((()=>{let n;switch(i){case"forceShow":n=1;break;case"forceHide":n=0;break;case void 0:n=a?1:0;break;default:(0,p().HB)(i)}const s=(0,p().O9)(t)?t:200;return{hoverStyle:{opacity:n,visibility:1===n?"visible":"hidden",transition:`opacity ${s}ms ease-in, visibility ${s}ms ease-in`,...e}}}),[e,i,a,t]);return(0,g.jsx)("div",{style:r.hoverStyle,children:s})};function f({icon:e,title:t,tooltip:n,hasRightElement:i,iconContainerStyle:s}){const u=(0,o().IS)((()=>({panelTitleAndIcon:{display:"flex",alignItems:"center",fontSize:c().Kw,fontWeight:d().Wy.medium,color:l().Tj.text.secondary,fill:l().Tj.icon.secondary,flexShrink:0,maxWidth:i?200:"100%"},title:{...d().RC},panelIconContainer:{display:"flex",alignItems:"center",justifyContent:"center",width:r().Ev.sm,height:r().Ev.sm,marginInlineEnd:8,marginTop:1,...s}})),[s,i]);return t?(0,g.jsx)(a().m,{renderTooltip:()=>n,disableTooltip:!n,placement:"top",alignment:"start",render:n=>(0,g.jsxs)("div",{style:u.panelTitleAndIcon,...n,children:[(0,g.jsx)("div",{style:u.panelIconContainer,children:e}),(0,g.jsx)("span",{style:u.title,children:t})]})}):null}const h=function({children:e,title:t,icon:a,tooltip:r,iconContainerStyle:l,panelStyle:d,headerStyle:c,rightStyle:p,actions:h,right:y,disableRightFadeIn:v,disableActionsFadeIn:b,hideWrapStyle:S,actionsGap:x,userSelectOverride:M}){const A=(0,n(484714).WS)(),j=Boolean(t),w=Boolean(y),I=(0,s().uB)(void 0,n(620090).B),k=(0,s().uB)(void 0,n(1248)._),T=(0,i.useMemo)((()=>({isHoveredOnPanelStore:I,sizeStore:k})),[I,k]),C=(0,i.useCallback)((()=>I.setState(!0)),[I]),_=(0,i.useCallback)((()=>I.setState(!1)),[I]),P=(0,i.useCallback)((e=>{e.width<u().Xy?k.setState("narrow"):k.setState("wide")}),[k]),B=(0,o().eP)(),R=(0,o().IS)((()=>({tile:{userSelect:M??"none",WebkitUserSelect:M??"none"},panel:S?{}:{paddingInlineStart:12,paddingInlineEnd:12,...(0,u().V$)({isPhone:A,themeMode:B}),...d},headerContainer:{flexShrink:0,display:"flex",justifyContent:"space-between",alignItems:"center",height:32,paddingBottom:14,marginInlineStart:u().Fq,...c},rightActions:{display:"flex",flexDirection:"row",alignItems:"center"},actions:{display:"flex",alignItems:"center",gap:x??6,paddingInlineStart:6}})),[A,S,d,c,x,M,B]),D=(j||w)&&(0,g.jsxs)("div",{style:R.headerContainer,children:[(0,g.jsx)(f,{title:t,icon:a,tooltip:r,hasRightElement:w,iconContainerStyle:l}),w||h?(0,g.jsxs)("div",{style:R.rightActions,children:[w?(0,g.jsx)(m,{force:v?"forceShow":void 0,additionalStyles:p,children:y}):void 0,h?(0,g.jsx)(m,{force:b?"forceShow":void 0,additionalStyles:R.actions,children:h}):void 0]}):void 0]});return(0,g.jsx)(n(273923).R.Provider,{value:T,children:(0,g.jsxs)("div",{style:R.tile,onMouseEnter:C,onMouseLeave:_,children:[D,(0,g.jsx)(n(630223).E,{onSizeChange:P,children:(0,g.jsx)("div",{style:R.panel,children:e})})]})})}},757754:(e,t,n)=>{n.d(t,{AR:()=>U,q8:()=>V});var i=n(296540),s=()=>n(564884),o=()=>n(726637),a=()=>n(484714),r=()=>n(590526),l=()=>n(401497),d=()=>n(295633),c=()=>n(161588),u=()=>n(245720),p=()=>n(807449),g=()=>n(546926),m=()=>n(631524),f=()=>n(287188),h=()=>n(890492),y=()=>n(424400),v=()=>n(736847),b=()=>n(651124),S=()=>n(390066),x=()=>n(142015),M=()=>n(49621),A=()=>n(642557),j=n(474848);const w={viewBox:"0 0 16 16",fittedViewBox:"3.17 1.59 11.88 12.45",svg:(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("path",{d:"M8 8.1a1.125 1.125 0 0 0-.575 2.092v.958a.575.575 0 0 0 1.15 0v-.958A1.125 1.125 0 0 0 8 8.1"}),(0,j.jsx)("path",{d:"M12.2 1.6a2.846 2.846 0 0 0-2.846 2.846V5.8H5.2a2.025 2.025 0 0 0-2.025 2.025v4.2c0 1.118.907 2.025 2.025 2.025h5.6a2.025 2.025 0 0 0 2.025-2.025v-4.2A2.025 2.025 0 0 0 10.8 5.8h-.196V4.446a1.596 1.596 0 1 1 3.192 0v1.63a.625.625 0 1 0 1.25 0v-1.63A2.846 2.846 0 0 0 12.2 1.6M4.425 7.825c0-.428.347-.775.775-.775h5.6c.428 0 .775.347.775.775v4.2a.775.775 0 0 1-.775.775H5.2a.775.775 0 0 1-.775-.775z"})]})},I=(0,n(340498).wt)("lockOpenSmall",w,"small");var k=()=>n(358359),T=()=>n(728396),C=()=>n(69708),_=()=>n(100622),P=()=>n(284371),B=()=>n(334261),R=()=>n(384944),D=()=>n(449195),L=()=>n(821507),E=()=>n(970176),O=()=>n(557198),N=()=>n(547149),F=()=>n(867159);function U({blockStore:e,useBottomSheetStyling:t}){const n=(0,a().v3)(),s=(0,C().tz)(),{device:l}=n,d=(0,r().K8)((()=>e.isLockedForAllUsers()),[e]),p=(0,r().K8)((()=>c().$.isTemporarilyUnlocked({userId:e.userId,blockId:e.id})),[e.id,e.userId]),m=(0,r().K8)((()=>e.isLocked()),[e]),f=(0,r().K8)((()=>e.isExternalObjectInstancePageBlockStore()),[e]);let y;y=o().A.isMobile?{menuType:g().gu.Modal,right:t?void 0:(0,j.jsx)(C().sA,{...u().W.done}),onClickRight:B().VN,title:s.formatMessage({id:"customizePageMenu.mobileHeader.label",defaultMessage:"Customize page"})}:{menuType:g().gu.Popup,minWidth:300};const v=(0,i.useCallback)((()=>{p?c().$.relockBlock({userId:e.userId,blockId:e.id}):c().$.temporarilyUnlockBlock({userId:e.userId,blockId:e.id})}),[e.id,e.userId,p]);return(0,j.jsxs)(h().A,{...y,children:[d?(0,j.jsx)(H,{isTemporarilyUnlocked:p,onToggleLock:v}):void 0,(0,j.jsx)(K,{blockStore:e,locked:m,isSyncedCollection:f,device:l})]})}function z(e,t){const n=e.getFormat();if(!t)return{};return(0,S().L)(n,t,void 0,b().jf.Collection)}function K({isSyncedCollection:e,blockStore:t,locked:n,device:i}){const s=(0,r().K8)((()=>t.getSchema()),[t]),{store:a,format:l}=(0,r().K8)((()=>{const e=t.getAssociatedCollectionStore();if(!e)return{store:t,format:z(t,t.getSchema())};const n=e.getFormat(),i=e.getSchema();return{store:e,format:(0,S().L)(n,i,void 0,b().jf.Collection)}}),[t]),d=(0,r().K8)((()=>(0,D().vk)(l.page_section_visibility)),[l]),c=(0,r().K8)((()=>t.isCollectionView()),[t]),u=!(0,L().D1)(i),p=!o().A.isMobile&&!c;if(!s||!a)return null;const g=!e,m=u,f=p,h=!e,y={locked:n,store:a,format:l},x=(0,j.jsxs)(j.Fragment,{children:[m?(0,j.jsx)(q,{...y}):void 0,g?(0,j.jsx)(V,{shouldShowIconAndMargin:!0,...y}):void 0,f?(0,j.jsx)(W,{locked:n,blockStore:t}):void 0,h?(0,j.jsx)(G,{marginCommentsVisibility:d,...y}):void 0]});return(0,j.jsx)(v().A,{style:{opacity:n?.5:1},children:(0,j.jsx)("div",{style:{marginInlineStart:2},children:x})})}function V({locked:e,store:t,format:n,shouldShowIconAndMargin:s}){const o=(0,a().v3)(),c=(0,r().K8)((()=>t instanceof d().B?t.getAssociatedLayoutStore():t.getLayoutStore()),[t]),u=(0,r().K8)((()=>null==c?void 0:c.getLayoutType()),[c]),g=(0,D().z5)(n.page_section_visibility),m="section_show"===g,h=(0,i.useCallback)((()=>{const e="section_show"===g?"section_hide":"section_show";c&&u&&(0,T().U2)(u)&&(0,E().z)({layoutStore:c,moduleId:"discussions",environment:o}),B().OD({environment:o,pageSection:"comments",visibility:e,store:t,format:n})}),[o,n,g,t,c,u]),v=(0,l().IS)((()=>({switcherButtonContainer:{marginInlineEnd:s?4:0},menuItemLabel:{cursor:"pointer"}})),[s]);return(0,j.jsx)(y().Ay,{title:(0,j.jsx)("label",{htmlFor:"page-discussions-switcher",style:v.menuItemLabel,children:(0,j.jsx)(C().sA,{id:"customizePageMenu.pageSections.pageCommentsSwitcherTitle",defaultMessage:"Page discussions"})}),icon:s?(0,j.jsx)(p().I,{icon:M().h}):void 0,right:(0,j.jsx)(f().A,{disabled:e,on:m,onClick:h,inputId:"page-discussions-switcher"}),rightStyle:v.switcherButtonContainer})}function q({locked:e,store:t,format:n}){const{backlinksVisibility:i,updateBacklinksVisibility:s}=(0,O().Ap)({store:t,format:n});return(0,j.jsx)(y().Ay,{title:(0,j.jsx)(C().sA,{id:"customizePageMenu.pageSections.backlinksSwitcherTitle",defaultMessage:"Backlinks"}),icon:(0,j.jsx)(p().I,{icon:x().D}),right:(0,j.jsx)(F().p7,{currentVisibility:i,onSelect:s,disabled:e})})}function W({locked:e,blockStore:t}){const n=(0,l().IS)((()=>({switcherButtonContainer:{marginInlineEnd:4}})),[]),o=(0,a().v3)(),d=(0,r().K8)((()=>{var e;return"off"!==(null===(e=t.getModel())||void 0===e?void 0:e.getFloatingTableOfContentsState())}),[t]),c=(0,i.useCallback)((()=>{N().createAndCommit({userAction:"CustomizePageMenu.handleToggleLockClick",environment:o,canUndo:!0,perform:e=>{R().zv({store:t.getFormatStore(),data:{page_floating_table_of_contents:{state:d?"off":"minimal"}},transaction:e})}}),(0,s().u)({environment:o,event:{eventName:"edit_page_table_of_contents_toggle",eventProperties:{is_table_of_contents_on:!d}}})}),[t,o,d]);return(0,j.jsx)(y().Ay,{title:(0,j.jsx)(C().sA,{id:"action.floatingTableOfContents.name",defaultMessage:"Table of contents"}),icon:(0,j.jsx)(p().I,{icon:k().L}),right:(0,j.jsx)("div",{style:n.switcherButtonContainer,children:(0,j.jsx)(f().A,{disabled:e,on:d,onClick:c})})})}function G({marginCommentsVisibility:e,locked:t,store:n,format:i}){const s=(0,a().v3)();return(0,j.jsx)(y().Ay,{title:(0,j.jsx)(C().sA,{id:"customizePageMenu.pageSections.inlineCommentsTitle",defaultMessage:"Inline comments"}),icon:(0,j.jsx)(p().I,{icon:M().h}),right:(0,j.jsx)(F().J8,{currentVisibility:e,disabled:t,onSelect:e=>{B().OD({environment:s,pageSection:"margin_comments",visibility:e,store:n,format:i})}})})}function H({isTemporarilyUnlocked:e,onToggleLock:t}){return(0,j.jsxs)("div",{style:{fontSize:12,display:"flex",justifyContent:"center",alignItems:"center",borderTop:`1px solid ${_().Tj.border.secondaryTranslucent}`,borderBottom:`1px solid ${_().Tj.border.secondaryTranslucent}`,background:_().Tj.background.secondary,color:_().Tj.text.secondary,paddingTop:6,paddingBottom:6},children:[(0,j.jsx)("span",{style:{display:"inline-block",verticalAlign:"middle",paddingInlineEnd:6},children:e?(0,j.jsx)(p().I,{icon:I,size:"sm",colorVariant:"secondary"}):(0,j.jsx)(p().I,{icon:A().lockSmallIcon,size:"sm",colorVariant:"secondary"})}),(0,j.jsx)(C().sA,{id:"customizePageMenu.locked.header",defaultMessage:"Page is locked."}),(0,j.jsx)(m().p,{style:{fontSize:12,color:_().Tj.text.secondary,fontWeight:P().Wy.semibold,marginInlineStart:2,paddingInlineStart:4,paddingInlineEnd:4,height:20},onClick:t,children:e?(0,j.jsx)(C().sA,{id:"customizePageMenu.lock.label",defaultMessage:"Re-lock"}):(0,j.jsx)(C().sA,{id:"customizePageMenu.unlock.label",defaultMessage:"Unlock for me"})})]})}},763275:(e,t,n)=>{n.r(t),n.d(t,{CollectionTypedDatabaseMigrationModal:()=>le});var i=n(296540),s=()=>n(484714),o=()=>n(590526),a=()=>n(401497),r=()=>n(107975),l=()=>n(302501),d=()=>n(433337),c=()=>n(69708),u=()=>n(100622),p=()=>n(754002),g=()=>n(132389),m=()=>n(379830),f=(n(581454),()=>n(807449)),h=()=>n(148307),y=()=>n(462786),v=()=>n(855089),b=()=>n(284371),S=()=>n(96409),x=()=>n(854672),M=()=>n(755170),A=n(474848);const j=(0,c().YK)({dummyTask1:{id:"MyTasksWidgetPreview.dummyTask1",defaultMessage:"Set up sync with Lisa"},dummyTask2:{id:"MyTasksWidgetPreview.dummyTask2",defaultMessage:"Review design docs"},dummyTask3:{id:"MyTasksWidgetPreview.dummyTask3",defaultMessage:"Create color palette"},dummyTask4:{id:"MyTasksWidgetPreview.dummyTask4",defaultMessage:"Book flight to New York"},dummyTask5:{id:"MyTasksWidgetPreview.dummyTask5",defaultMessage:"Fix broken links"},dummyTask6:{id:"MyTasksWidgetPreview.dummyTask6",defaultMessage:"Upgrade database"},Blocked:{id:"MyTasksWidgetPreview.blockedStatus",defaultMessage:"Blocked"},"In Progress":{id:"MyTasksWidgetPreview.inProgressStatus",defaultMessage:"In Progress"},"Not Started":{id:"MyTasksWidgetPreview.notStartedStatus",defaultMessage:"Not Started"},locationIndicator:{id:"MyTasksWidgetPreview.locationIndicator",defaultMessage:"In"}});const w={Blocked:"red","In Progress":"blue","Not Started":"gray"};function I(){const e=C();return(0,A.jsx)(M().A,{title:(0,A.jsx)(c().sA,{id:"CollectionTypedDatabaseMigrationModal.AssignedToMePreview.Title",defaultMessage:"My tasks"}),tooltip:void 0,icon:(0,A.jsx)("div",{style:{paddingInlineStart:4},children:(0,A.jsx)(x().A,{type:"app_package_asset",size:18,icon:h().A.images.appPackages.taskDbIconSvg})}),children:(0,A.jsx)("div",{style:e.dummyAssignedToMe,children:(0,A.jsx)(k,{})})})}function k(){const e=function(e){return[{icon:"📅",taskName:e.formatMessage(j.dummyTask1),status:"Blocked",teamspace:"Eng",location:(0,A.jsx)(f().I,{icon:v().presentSmallIcon,size:"sm",style:{fill:"#448361"}})},{icon:"📚",taskName:e.formatMessage(j.dummyTask2),status:"In Progress",teamspace:"Design",location:(0,A.jsx)(f().I,{icon:y().q,size:"sm",style:{fill:"#CB912F"}})},{icon:"🎨",taskName:e.formatMessage(j.dummyTask3),status:"In Progress",teamspace:"Design",location:(0,A.jsx)(f().I,{icon:y().q,size:"sm",style:{fill:"#CB912F"}})},{icon:"🛫",taskName:e.formatMessage(j.dummyTask4),status:"Not Started",teamspace:"Eng",location:(0,A.jsx)(f().I,{icon:v().presentSmallIcon,size:"sm",style:{fill:"#448361"}})},{icon:"🚧",taskName:e.formatMessage(j.dummyTask5),status:"Not Started",teamspace:"Design",location:(0,A.jsx)(f().I,{icon:y().q,size:"sm",style:{fill:"#CB912F"}})},{icon:"👩‍💻",taskName:e.formatMessage(j.dummyTask6),status:"Not Started",teamspace:"Eng",location:(0,A.jsx)(f().I,{icon:v().presentSmallIcon,size:"sm",style:{fill:"#448361"}})}]}((0,c().tz)()).map(((e,t)=>(0,A.jsx)(T,{row:e},t)));return(0,A.jsx)("div",{style:{display:"flex",marginTop:4,paddingInlineEnd:16,flexDirection:"column"},children:e})}function T({row:e}){const t=(0,c().tz)(),n=C();return(0,A.jsxs)("div",{style:n.eachTask,children:[(0,A.jsxs)("div",{style:n.taskName,children:[(0,A.jsx)("span",{style:n.taskIcon,children:e.icon}),(0,A.jsx)(l().A,{style:n.taskTitle,children:e.taskName})]}),(0,A.jsx)("div",{style:n.taskStatus,children:(0,A.jsx)(S().X,{type:"status",value:t.formatMessage(j[e.status]),color:w[e.status],groupColor:void 0})}),(0,A.jsx)(g().A,{size:8}),(0,A.jsxs)("div",{style:n.location,children:[(0,A.jsx)("span",{style:n.locationIndicator,children:t.formatMessage(j.locationIndicator)}),(0,A.jsx)("div",{style:{...n.locationIcon,..."Design"===e.teamspace?{...n.designTeamspace}:{...n.engTeamspace}},children:e.location})]})]})}function C(){const e=(0,a().eP)();return(0,a().IS)((()=>({dummyAssignedToMe:{width:"60%",maxHeight:270,minHeight:90,paddingBottom:10},eachTask:{display:"flex",alignItems:"center",padding:4},taskName:{width:220,display:"flex",...b().RC},taskIcon:{fontSize:14,marginInlineEnd:8},taskTitle:{color:u().Tj.text.primary,fontSize:14,fontWeight:500},taskStatus:{display:"flex",width:130},location:{display:"flex",alignItems:"center"},locationIndicator:{color:u().Tj.text.secondary,marginInlineEnd:4,maxWidth:48,...b().RC},locationIcon:{display:"flex",justifyContent:"center",fontSize:14,height:18,width:18,borderRadius:4},designTeamspace:{backgroundColor:"light"===e?"#FBF3DB":"#5c3b23"},engTeamspace:{backgroundColor:"light"===e?"#E5F2E2":"#243d30"}})),[e])}n(898992),n(354520),n(803949),n(737550);var _=()=>n(250910),P=()=>n(546926),B=()=>n(124092),R=()=>n(160432),D=()=>n(890492),L=()=>n(81068),E=()=>n(663639),O=()=>n(736847),N=()=>n(489242),F=()=>n(41174),U=()=>n(852424),z=()=>n(324254),K=()=>n(833243),V=()=>n(617668),q=()=>n(340498),W=()=>n(128427),G=()=>n(812182),H=()=>n(962910),Y=()=>n(413955),$=()=>n(462106);const Q={[d().yx.Status]:["status","checkbox","select"]};function Z(e,t,n){const i=t.type,s=e in Q?Q[e]:[i];return Object.entries(n).filter((([e,t])=>{if(t)return s.includes(t.type)}))}var X=()=>n(895876),J=()=>n(39758),ee=()=>n(690197),te=()=>n(479554),ne=()=>n(696746),ie=()=>n(547149);function se(e){const{collectionContextStore:t,databaseType:n,containerStyle:r}=e,p=(0,s().v3)(),h=(0,c().tz)(),{isPhone:y}=(0,s().Y0)(),v=function(e){return(0,a().IS)((()=>({formTitle:{display:"inline-flex"},emojiTitle:{fontSize:36,marginInlineEnd:8},perPropertyInstruction:{color:u().Tj.text.secondary,fontSize:e?14:12,marginBottom:8},requiredPropertyError:{color:u().oZ.red,fontSize:e?14:12,marginInlineEnd:e?8:6},propertyMappingInstructions:{marginTop:6,marginBottom:24,fontSize:e?16:14,fontWeight:e?500:400},propertyMappingDropdown:{display:"flex",alignItems:"center"},chevronDownIconEnabled:{width:e?14:10,fill:u().Tj.icon.tertiary},propertyMappingTitle:{fontSize:e?16:14,color:u().Tj.text.tertiary},propertyMappingMenu:{borderRadius:6,border:`1px solid ${u().Tj.border.primary}`,boxShadow:"none"},propertyConversionCallout:{display:"flex",alignItems:"center",marginInlineStart:4,marginTop:3,color:u().Tj.text.tertiary},propertyIcon:{fill:u().Tj.darkTextColor},buttons:{marginBlockStart:e?"auto":void 0},submitMigrationButton:{display:"flex",height:e?36:32,fontSize:e?16:14},learnMore:{display:"flex",justifyContent:"center",marginTop:8,marginInlineStart:0,width:"100%"},learnMoreButton:{display:"inline-flex",justifyContent:"center",width:"100%",height:26},closeButton:{width:"100%",height:36,marginTop:8,display:"inline-flex",justifyContent:"center",fontSize:16,color:u().Tj.text.tertiary}})),[e])}(y),b=(0,a().DP)(),[S,x]=(0,i.useState)(!1),M=(0,o().K8)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getSchema()}),[t]),j=(0,o().K8)((()=>(0,$().Y)((0,Y().appConfigs)(),n)),[n]),w=(0,o().K8)((()=>{if(M&&j)return function(e,t){const n={};for(const[i,s]of Object.entries(e))if(i.startsWith("notion://")&&(null==s?void 0:s.type)){const e=Z(i,s,t);1===e.length&&(n[i]=e[0][0])}return n}(j,M)}),[j,M]),I=(0,i.useCallback)(((e,t)=>{const n=t.type;return Z(e,t,M??{}).map((([e,t])=>({key:e,title:null==t?void 0:t.name,icon:(0,A.jsx)(U().zB,{size:q().Ev.sm,style:v.propertyIcon,theme:b,icon:null==t?void 0:t.icon,type:(null==t?void 0:t.type)||n})})))}),[b,v.propertyIcon,M]),k=(0,o().K8)((()=>{const e=Object.keys(j||{}).filter((e=>void 0!==(null==j?void 0:j[e])&&e.startsWith("notion://"))),t=Object.fromEntries(e.map((e=>[e,void 0])));return Object.entries(j||{}).forEach((([e,n])=>{if(!n)return;const i=null==w?void 0:w[e];if(i)return void(t[e]=i);0===I(e,n).length&&(t[e]=N().Ul)})),t}),[j,w,I]),[T,C]=(0,i.useState)(k),Q=(0,i.useMemo)((()=>Object.entries(T).some((([e,t])=>{if(e===d().yx.Status){const e=null==M?void 0:M[t||""];if("checkbox"===(null==e?void 0:e.type)||"select"===(null==e?void 0:e.type))return!0}}))),[M,T]),se=(0,i.useCallback)((e=>{const t=null==j?void 0:j[e];if(!t)return null;const n=[...I(e,t),{key:N().Ul,title:h.formatMessage(oe.createNew),icon:(0,A.jsx)(f().I,{icon:V().plusIcon}),type:void 0}],i=T[e],s=null==M?void 0:M[i||""],o=!i&&S,a=e===d().yx.Status;let r=null;return i===N().Ul?r=(0,A.jsx)(f().I,{icon:V().plusIcon}):s&&(r=(0,A.jsx)(f().I,{icon:U().LE[null==s?void 0:s.type]})),(0,A.jsx)(_().A,{popupType:y?_().z.SlideUp:_().z.Popup,renderOrigin:t=>(0,A.jsxs)("div",{style:{marginBottom:24},children:[(0,A.jsx)(l().A,{isMultiline:!0,style:v.perPropertyInstruction,children:(0,A.jsx)(c().sA,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.PerPropertyInstructions",defaultMessage:"Pick the property that represents {propertyDescription}",values:{propertyDescription:h.formatMessage(ae[e])}})}),(0,A.jsx)(L().A,{disabled:1===n.length,disabledFeedback:!0,focused:!1,right:(0,A.jsxs)("div",{style:v.propertyMappingDropdown,children:[o?(0,A.jsx)("span",{style:v.requiredPropertyError,children:(0,A.jsx)(c().sA,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.RequiredPropertyError",defaultMessage:"Required"})}):void 0,(0,A.jsx)(f().I,{icon:z().arrowChevronSingleDownSmallIcon,size:"xs",colorVariant:"tertiary"})]}),rightStyle:{marginInlineEnd:y?14:8},icon:r,title:i===N().Ul?h.formatMessage(oe.createNew):s?s.name:h.formatMessage(oe.select),titleStyle:i?{display:"flex",alignItems:"center"}:v.propertyMappingTitle,style:{...v.propertyMappingMenu,...o?{borderColor:u().oZ.red}:{}},buttonStyle:{margin:0,width:"100%"},...t}),a&&Q?(0,A.jsx)(l().A,{isSmall:!0,isMultiline:!0,children:(0,A.jsx)("div",{style:v.propertyConversionCallout,children:(0,A.jsx)(c().sA,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.CheckboxSelectMappingInfo",defaultMessage:"This property will be converted to a Status property type."})})}):void 0]}),placementToOrigin:"bottom",alignmentToOrigin:"start",render:t=>{const i=[{key:"propertyOptions",render:e=>(0,A.jsx)(O().A,{...e,topBorder:0!==e.index}),items:n.map((n=>{const i={key:n.key,render:t=>(0,A.jsx)(L().A,{...t,icon:n.icon,title:n.title,isChecked:T[e]===n.key}),action:()=>{C({...T,[e]:n.key}),x(!1),t.close()}};return i}))}],s=y?{menuType:P().gu.ActionSheet}:{menuType:P().gu.Popup,width:250};return(0,A.jsx)(D().A,{...s,children:(0,A.jsx)(E().A,{type:E().O.Vertical,initialFocus:void 0,sections:i})})}},e)}),[j,I,h,v,T,M,S,Q,y]),re=(0,i.useCallback)((()=>{const e=t.collectionStore(),i=t.collectionViewBlockStore();e&&i&&(!function(e){return!Object.values(e).includes(void 0)}(T)?x(!0):ie().createAndCommit({userAction:"CollectionTypedDatabaseMigrationModal.migrateDatabase",environment:p,canUndo:!0,perform:s=>{var o;H().bC({environment:p,collectionViewBlockStore:i,collectionStore:e,databaseType:n,propertyMapping:{...T},typedPropertySchemas:{...j},transaction:s}),m().A.setState({isModalOpen:!1,collectionContextStore:void 0}),n===d().dC&&(J().e.locallyMutatedTasksDatabase=!0),(0,W().Y)({environment:p,database_type:n,property_mapping:T,collectionContextStore:t});const a=(0,ne().XH)("myTasks"),r=null==a||null===(o=a.getCollectionViewStores())||void 0===o?void 0:o[0],l=null==r?void 0:r.getCollectionSource();let c=F().mB;if("typed"===(null==l?void 0:l.type)){c=(l.aggregatedCollections?(0,F()._E)(l.aggregatedCollections):[]).length}const u=c>=F().mB;G().HK({id:"task_database_migration_toast",title:h.formatMessage({id:"CollectionTypedDatabaseMigrationModal.toast.title",defaultMessage:"Turned into task database"}),message:u?h.formatMessage({id:"CollectionTypedDatabaseMigrationModal.toast.messageAtLimit",defaultMessage:"You can now add it as a source for My tasks in Home."}):h.formatMessage({id:"CollectionTypedDatabaseMigrationModal.toast.message",defaultMessage:'Add to Home to see your assigned tasks in "My tasks"'}),presentationType:"persistent",icon:K().checkmarkCircleSmallIcon,iconColorPalette:"green",iconColorVariant:"accentPrimary",actions:u||!r?void 0:{primary:{title:h.formatMessage({id:"CollectionTypedDatabaseMigrationModal.toast.addToHome",defaultMessage:"Add to Home"}),onAction:()=>{(0,te().F)({environment:p,collectionViewStore:r,collectionPointerToAdd:e.pointer}),G().UW("task_database_migration_toast")}}}})}}))}),[t,T,p,n,j,h]);return(0,A.jsxs)("div",{style:r,children:[(0,A.jsxs)("div",{style:v.formTitle,children:[y?(0,A.jsx)("span",{style:v.emojiTitle,children:"📋"}):null,(0,A.jsx)(l().A,{style:v.propertyMappingInstructions,isMultiline:!0,children:(0,A.jsx)(c().sA,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.Title",defaultMessage:"Task databases require status, assignee, and due date properties."})})]}),y?(0,A.jsx)(g().A,{size:16}):null,Object.entries(k).map((([e,t])=>se(e))),(0,A.jsxs)("div",{style:v.buttons,children:[(0,A.jsx)(R().A,{colorPalette:"blue",style:v.submitMigrationButton,onClick:re,children:(0,A.jsx)(c().sA,{defaultMessage:"Turn into {type} database",id:"CollectionTypedDatabaseMigrationModal.ConfirmMigration.Title",values:{type:(0,X().$O)(n)}})}),y?(0,A.jsx)(B().p,{style:v.closeButton,onClick:()=>m().A.reset(),children:(0,A.jsx)(c().sA,{id:"CollectionTypedDatabaseMigrationModal.Close",defaultMessage:"Close"})}):(0,A.jsx)(ee().A,{title:(0,A.jsx)(c().sA,{id:"CollectionTypedDatabaseMigrationModal.Info",defaultMessage:"Learn about {type} databases",values:{type:(0,X().$O)(n)}}),analyticsFrom:"set_database_type",href:ne().hI,style:v.learnMore,buttonStyle:v.learnMoreButton})]})]})}const oe=(0,c().YK)({createNew:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.CreateNew",defaultMessage:"Create new"},select:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.SelectFieldPlaceholder",defaultMessage:"Select..."},taskStatus:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.TaskStatus",defaultMessage:"status"},taskAssignee:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.TaskAssignee",defaultMessage:"assignee"},taskDueDate:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.TaskDueDate",defaultMessage:"due date"}}),ae={[d().yx.Status]:oe.taskStatus,[d().yx.Assign]:oe.taskAssignee,[d().yx.DueDate]:oe.taskDueDate},re=32;function le(){const e=pe(),t=(0,s().Y0)(),n=(0,o().O$)(m().A);return n.isModalOpen?t.isPhone?(0,A.jsx)(p()._,{fullscreen:!0,innerStyle:e.phoneInner,renderInner:()=>(0,A.jsx)(ue,{collectionContextStore:n.collectionContextStore})}):(0,A.jsx)(r().a,{open:!0,onDismiss:()=>m().A.reset(),innerStyle:e.desktopInner,render:()=>(0,A.jsx)(ce,{collectionContextStore:n.collectionContextStore})}):null}const de=450;function ce(e){const t=pe();return(0,A.jsxs)("div",{style:{display:"flex",flexDirection:"column",position:"relative"},children:[(0,A.jsxs)("div",{style:t.title,children:[(0,A.jsx)("span",{style:t.emojiTitle,children:"📋"}),(0,A.jsx)(l().A,{isMultiline:!0,style:t.previewTitle,children:(0,A.jsx)(c().sA,{id:"CollectionTypedDatabaseMigrationModal.AssignedToMePreview.Description",defaultMessage:"See all your tasks across multiple databases in your personal Home."})})]}),(0,A.jsx)(g().A,{size:36}),(0,A.jsx)(I,{}),(0,A.jsx)(se,{collectionContextStore:e.collectionContextStore,databaseType:d().dC,containerStyle:t.form})]})}function ue(e){const t=pe();return(0,A.jsx)(se,{collectionContextStore:e.collectionContextStore,databaseType:d().dC,containerStyle:t.phoneForm})}function pe(){return(0,a().IS)((()=>({desktopInner:{width:768,height:de,padding:re},phoneInner:{width:"100%",height:"100%"},title:{display:"flex",maxWidth:"60%",alignItems:"center"},emojiTitle:{fontSize:36,marginInlineEnd:16},previewTitle:{color:u().Tj.text.primary,width:350,fontSize:17,fontWeight:500},form:{width:"45%",height:de,background:u().Tj.background.secondary,position:"absolute",top:-re,insetInlineEnd:-re,padding:re,zIndex:1,borderInlineStart:`1px solid ${u().Tj.border.primary}`,overflowY:"auto"},phoneForm:{display:"flex",flexDirection:"column",width:"100%",height:"100%",padding:re}})),[])}},766676:(e,t,n)=>{n.d(t,{C:()=>h});var i=n(296540),s=()=>n(933922),o=()=>n(726637),a=()=>n(484714),r=()=>n(590526),l=()=>n(543906),d=()=>n(107975),c=()=>n(404141),u=()=>n(300789),p=()=>n(51367),g=()=>n(131448),m=()=>n(736378),f=n(474848);function h(e){const{message:t}=e,n=(0,a().v3)(),h=(0,r().K8)((()=>!c().Ay.state.open&&!o().A.isMobile),[]),y=(0,r().K8)((()=>h&&g().default.isVisible(t.key)),[t,h]);(0,l().A)((()=>{p().DL(n,{callout_key:t.key,placement_key:"Modal"})}),y);const v=(0,i.useCallback)((()=>{p().Sq(n,{callout_key:t.key,dismiss_type:"modal_dismiss_clicked",placement_key:"Modal"}),u().OX(n,t)}),[n,t]),b=(0,i.useCallback)(((e,i)=>()=>{p().Y5(n,{callout_key:t.key,click_type:e,placement_key:"Modal"}),null==i||i()}),[n,t]);let S;var x;e.primary&&(S={...e.primary,onClick:b("primary_cta",null===(x=e.primary)||void 0===x?void 0:x.onClick)});let M;var A;e.secondary&&(M={...e.secondary,onClick:b("secondary_cta",null===(A=e.secondary)||void 0===A?void 0:A.onClick)});let j;var w;e.link&&(j={...e.link,onClick:b("learn_more",null===(w=e.link)||void 0===w?void 0:w.onClick)});return y?(0,f.jsx)(d().a,{open:!0,preventHideChildrenWhileOpening:!0,onDismiss:v,render:()=>(0,f.jsx)(s().A,{capture:!0,allowEsc:!0,render:()=>(0,f.jsx)(m().T,{...e,onDismiss:v,primary:S,secondary:M,link:j})})}):null}},773706:(e,t,n)=>{n.d(t,{T:()=>s});const i="ShowMentionInvite";function s(e){return`${i}-${e}`}},781016:(e,t,n)=>{n.r(t),n.d(t,{clockFillIcon:()=>s,iconDefinition:()=>i});n(296540);const i={viewBox:"0 0 20 20",fittedViewBox:"2.37 2.37 15.26 15.25",svg:(0,n(474848).jsx)("path",{d:"M2.375 10a7.625 7.625 0 1 1 15.25 0 7.625 7.625 0 0 1-15.25 0m8.25-4.275a.625.625 0 1 0-1.25 0v3.65H6.4a.625.625 0 1 0 0 1.25H10c.345 0 .625-.28.625-.625z"})},s=(0,n(340498).wt)("clockFill",i,"fill")},782473:(e,t,n)=>{n.d(t,{Nu:()=>a,Sw:()=>i,gO:()=>s,j$:()=>o});const i=220,s=24,o=-7,a=-3},787766:(e,t,n)=>{n.d(t,{Hc:()=>d,Io:()=>u,Mg:()=>g,S3:()=>r,X3:()=>l,dE:()=>p,iO:()=>c,vC:()=>m,vG:()=>a});n(944114),n(898992),n(803949);var i=()=>n(401497),s=()=>n(100622),o=()=>n(284371);function a(e){const{focus:t}=e;return(0,i().IS)((()=>({searchBar:{padding:16},inputStyle:{minWidth:60,width:"auto",borderStartStartRadius:4,borderStartEndRadius:4,fontSize:14,fontWeight:o().Wy.regular},inputOuterStyle:{padding:6,borderRadius:6,height:20,alignItems:"center",minHeight:32,background:s().Tj.palette.gray[30],...t&&{background:"none"}}})),[t])}function r(){return(0,i().IS)((()=>({selectAllSectionStyle:{display:"flex",flexDirection:"column",gap:2,paddingTop:8,paddingInlineEnd:0,paddingBottom:16,paddingInlineStart:0},sectionMenuItem:{paddingTop:12,paddingInlineEnd:0,paddingBottom:0,paddingInlineStart:2,display:"flex",flexDirection:"column",gap:2},dividerStyle:{margin:"0px 16px"},dividerInnerStyle:{borderBottom:`1px solid ${s().Tj.border.secondary}`},selectAllStyle:{display:"flex",fontSize:14,color:s().Tj.text.primary},totalCountsStyle:{paddingInlineStart:3,fontSize:14,color:s().Tj.text.tertiary}})),[])}function l(){return(0,i().IS)((()=>({footerStyle:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:60,paddingTop:12,paddingInlineEnd:16,paddingBottom:16,paddingInlineStart:16,borderTop:`1px solid ${s().Tj.border.secondary}`}})),[])}function d(){return(0,i().IS)((()=>({labelContainer:{display:"flex",alignItems:"center",color:s().oZ.uiLightBlack,gap:6},importListButton:{height:28,borderRadius:4,border:void 0,width:"100%"},importListButtonContainer:{padding:"0 6px",alignItems:"center"}})),[])}function c(){return(0,i().IS)((()=>({topContainer:{display:"flex",alignItems:"center",width:"100%",height:40,padding:"0 16px",borderBottom:`1px solid ${s().Tj.border.secondary}`},sendInviteLabel:{color:s().Tj.text.primary,fontSize:14,fontWeight:o().Wy.medium,textAlign:"start",verticalAlign:"top"}})),[])}function u(e,t){return(0,i().IS)((()=>({buttonContainer:{padding:"0 8px",...t},button:{height:32,borderRadius:4,border:`1px solid ${s().Tj.border.primary}`,...e}})),[e,t])}function p(e){const{filteredImportedContacts:t,inviteTargetsStore:n}=e,i=n.state.inviteTargets.length;return 0!==i&&i===t.length}function g(e){const{filteredImportedContacts:t}=e,n={};return t.forEach(((e,t)=>{const i=e.value.email[0].toUpperCase(),s=/^[A-Za-z]$/.test(i)?i:"#";n[s]||(n[s]=[]),n[s].push(e)})),n}function m(e){const{canEditPermission:t,isMobile:n,isEnterprise:i}=e;return!(n||i||!t)}},787804:(e,t,n)=>{n.d(t,{o:()=>s});var i=()=>n(711059);function s(e){const t=[4,9,0];return(0,i().isLessThanVersion)(e,t)}},799836:(e,t,n)=>{n.d(t,{P:()=>o});var i=()=>n(187174),s=()=>n(769864);function o({environment:e,skipServerFetch:t,includeTopSpaces:n=!1,limit:o}){return(0,i().Yb)((async()=>{if(t)return;const i=await s().callMainCellApi({eventName:"hasJoinableSpaces",environment:e,data:{includeTopSpaces:n,limit:o}});return"failed"!==i.type?i.data:void 0}),[e,t,n,o])}},803557:(e,t,n)=>{n.d(t,{KG:()=>a,PX:()=>r,Xx:()=>o});var i=()=>n(79926);const s={SlackImportContactsButton:new(i().O2)("SlackImportContactsButton",(()=>n.e(55901).then(n.bind(n,659126)))),GoogleImportContactsButton:new(i().O2)("GoogleImportContactsButton",(()=>n.e(37398).then(n.bind(n,97509)))),MicrosoftImportContactsButton:new(i().O2)("MicrosoftImportContactsButton",(()=>n.e(93629).then(n.bind(n,447078))))},o=(0,i()._h)(s.SlackImportContactsButton,(e=>e.default)),a=(0,i()._h)(s.GoogleImportContactsButton,(e=>e.GoogleImportContactsButton)),r=(0,i()._h)(s.MicrosoftImportContactsButton,(e=>e.MicrosoftImportContactsButton))},804643:(e,t,n)=>{n.d(t,{dl:()=>j,LV:()=>T});n(18107),n(944114),n(967357),n(898992),n(672577),n(296540);var i=()=>n(907258),s=()=>n(736847),o=()=>n(584262),a=()=>n(566534),r=()=>n(236262),l=()=>n(69708),d=()=>n(857783);var c=()=>n(49533);var u=()=>n(364859),p=()=>n(598101);n(823215);n(581454);async function g(e){const{blocks:t,transaction:s,environment:o}=e,{sidebarSpaceViewStore:a}=i().default.state;if(a)for(const i of t)n(722101).TF({parentStore:a.getSharedPagesStore(),childToRemoveStore:i,transaction:s});(0,n(332690).V)({environment:o,blocks:t}),await Promise.all(t.map((e=>n(769864).callApi({eventName:"leaveBlock",environment:o,data:{block:{id:e.id,spaceId:(0,n(161479).e)(e.pointer.spaceId)}}}))))}n(354520);function m({blockId:e,transaction:t,spaceViewStore:i}){const s=((null==i?void 0:i.getPublicShareLinkPages())??[]).filter((t=>t!==e)),o=null==i?void 0:i.getBookmarkedPageIds().filter((t=>t!==e));n(384944).zv({store:i,data:{public_share_link_pages:s,bookmarked_pages:o},transaction:t})}var f=()=>n(547149),h=()=>n(863687),y=()=>n(599364),v=()=>n(774411),b=()=>n(267271),S=()=>n(498002),x=n(474848);const M=(0,l().YK)({unpinName:{id:"action.unpin.name",defaultMessage:"Remove from sidebar"},leaveName:{id:"action.leave.name",defaultMessage:"Leave"},duplicateToName:{id:"action.duplicateTo.name",defaultMessage:"Duplicate to"},editFormName:{id:"action.editForm.name",defaultMessage:"Edit form"}}),A=(0,b().Ls)({key:"edit form",displayName:M.editFormName,analyticsName:M.editFormName.defaultMessage,svg:n(105819).pencilLineIcon,validators:[n(59411).k,function(e){var t;const{environment:n}=e,i=e.blocks.at(0);return!(!i||!i.isFormBlock())&&(n.currentUser.id===i.getCreatedById()&&Boolean(null===(t=i.getFormBlockParentBlockStore())||void 0===t?void 0:t.canEditCollection()))}],closeParentMenu:!0,action:({blocks:e,environment:t})=>{const n=e[0],i=n.getFormBlockParentBlockStore();var s;i&&d().uK({environment:t,store:i,collectionViewId:null===(s=n.getParentStore())||void 0===s?void 0:s.id,pageVisitSource:o().y8.FormInternalPage})}}),j=(0,b().Ls)({key:"delete block without shortcuts",displayName:b().AY.moveToTrashName,analyticsName:b().AY.moveToTrashName.defaultMessage,svg:r().trashIcon,isRed:!0,validators:[(0,n(422155).or)([c()._,function(e){const t=e.blocks.at(0);return Boolean((null==t?void 0:t.isType("copy_indicator"))&&Date.now()-t.getCreatedTime()>n(720665).nD)},n(416433).I]),n(929409).S,(0,p().A)(n(776594).x),(0,p().A)((0,n(419286).X)(n(700500).xd.externalObjectInstancePage)),(0,p().A)(n(467294).P),n(73330).z,(0,p().A)(n(339425).o),(0,p().A)(n(411960).P),(0,p().A)(n(10462).Z)],closeParentMenu:!0,track:{actionName:"move_to_trash"},render:(e,t,i)=>{const s=(0,n(609256).d)(t.blocks.at(0));return(0,x.jsx)(n(26697).m,{renderTooltip:()=>(0,x.jsx)("div",{style:{maxWidth:400,whiteSpace:"pre-wrap"},children:(0,x.jsx)(l().sA,{...b().AY.cannotDeleteBlockTooltip})}),render:()=>(0,x.jsx)(n(575143).A,{...e,title:(0,x.jsx)(l().sA,{...b().AY.moveToTrashName}),svg:r().trashIcon,isRed:!0,disabled:s,disabledFeedback:s,tooltipText:s?(0,x.jsx)(l().sA,{...b().AY.cannotDeleteBlockTooltip}):void 0})})},action:async(e,{blocks:t,environment:i},s)=>{await n(391214).Af({environment:i,blocks:t,shouldCheckSuggestEdit:!1,callback:e})}}),w=(0,b().Ls)({key:"leave shared page",displayName:M.leaveName,analyticsName:M.leaveName.defaultMessage,svg:a().U,validators:[n(467276).p,function(e){const{id:t}=e.environment.currentUser;return!!t&&e.blocks.every((e=>{const i=e.getPermissionItems();return(0,n(433847).lI)(i,t)}))},(0,p().A)(u().q)],closeParentMenu:!0,action:({blocks:e,environment:t})=>{f().createAndCommit({userAction:"actionRegistry.leaveSharedPage",environment:t,canUndo:!0,perform:n=>{g({environment:t,blocks:e,transaction:n})}})}}),I=(0,b().Ls)({key:"leave public share link shared page",displayName:M.leaveName,analyticsName:M.leaveName.defaultMessage,svg:a().U,validators:[u().q],closeParentMenu:!0,action:({blocks:e,environment:t})=>{var s,a,r;const{sidebarSpaceViewStore:l,currentUserSettingsStore:c,sidebarSpaceStore:u,mainEditorCurrentBlockStore:p}=i().default.state;if(!l||!c||!u)return;const g=null===(s=l.getSpaceStore())||void 0===s?void 0:s.id;if(!g)return;const h=n(90873).A.getSharedPagesState({spaceId:g,userId:c.id}),y=l.getPublicShareLinkPageStores().find((t=>t.id!==e[0].id)),v=null!=h&&null!==(a=h.currentPageIds)&&void 0!==a&&a[0]?n(295633).B.createChildStore(u.getPagesStore(),{table:n(179034).ev,id:null==h||null===(r=h.currentPageIds)||void 0===r?void 0:r[0],spaceId:u.id}):void 0;f().createAndCommit({userAction:"actionRegistry.leavePublicShareLinkSharedPage",environment:t,canUndo:!0,perform:t=>{m({blockId:e[0].id,transaction:t,spaceViewStore:l})}});(null==p?void 0:p.id)===e[0].id&&(y?d().uK({environment:t,store:y,pageVisitSource:o().y8.LeaveOrRemove}):v?d().uK({environment:t,store:v,pageVisitSource:o().y8.LeaveOrRemove}):(0,n(579191).k)(t))}}),k=(0,n(12956).u)({key:"duplicate to workspace",displayName:M.duplicateToName,analyticsName:M.duplicateToName.defaultMessage,svg:n(764781).V,validators:[c()._,n(333344).P,n(77295).K,(0,p().A)(n(116057).M),function(){const{sidebarSpaceStore:e}=i().default.state;return!!e&&!e.getDisableMoveToSpace()}],subActions:({blocks:e,environment:t})=>{const{currentUserRootStore:o}=i().default.state;if(!o)return[];const a=(0,n(135337).j)(o),r=[];for(const i of a){const s=i.getSpaceStore();if(!s)continue;const o=(0,n(574359).G)(t,s),a=s.getIcon();r.push({key:i.id,displayName:o||"",analyticsName:"Duplicate to workspace",searchName:o||"",closeParentMenu:!0,action:async()=>{await(0,n(213477).hh)({environment:t,sourceBlocks:e,destination:{type:"space",parent:(0,n(96689).n2)(s.id)},from:"fork_page.outliner_item",options:{addCopyName:!1,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0},navigateToTarget:!0,skipUserFacingMessages:!1,duplicateSubtreeGateName:"duplicate_subtree_cross_workspace_flows"})},render:e=>(0,x.jsx)(n(81068).A,{title:o,icon:(0,x.jsx)(n(187820).B6,{icon:a,isEmptyPage:!1,title:o,size:n(726637).A.isMobile?24:20,disabled:!0,iconRecordCategory:"workspace"}),...e})})}return[(0,b().gy)({key:"duplicate-to",render:e=>(0,x.jsx)(s().A,{...e}),actions:r})]}}),T=[n(354406).LQ,{key:"outliner organization actions",render:e=>(0,x.jsx)(s().A,{...e}),actions:[h()._J,h().wy,w,I]},{key:"outliner available offline action",render:e=>(0,x.jsx)(s().A,{...e}),actions:[n(603596).Z]},{key:"outliner primary actions",render:e=>(0,x.jsx)(s().A,{...e}),actions:[y().k,y().o,h().O5,h().tA,v().As,v().nK,v().J8,v().lb,k,A,n(22913).U,n(37689).tw,j]},{key:"turn page into",render:e=>(0,x.jsx)(s().A,{...e}),actions:[S().zk,S().wm,S().Js]},{key:"outliner navigation",render:e=>(0,x.jsx)(s().A,{...e}),actions:n(426928).YO}]},807926:(e,t,n)=>{n.d(t,{A:()=>s});class i extends(()=>n(757695))().Store{getInitialState(){return{open:!1}}}const s=new i},808565:(e,t,n)=>{function i({environment:{device:e}}){return e.isIOS}n.d(t,{u:()=>i})},809125:(e,t,n)=>{n.r(t),n.d(t,{default:()=>u});n(296540);var i=()=>n(907258),s=()=>n(726637),o=()=>n(590526),a=()=>n(30537),r=()=>n(796249),l=()=>n(712505),d=()=>n(757754),c=n(474848);const u=function(){const e=(0,o().O$)(r().A);return(0,c.jsx)(n(127833).zD,{popupType:s().A.isMobile?a().n.BottomSheet:a().n.Popup,bottomSheetInitialState:"half",alignmentToOrigin:"center",open:e.isOpen,render:()=>(0,c.jsx)(p,{useBottomSheetStyling:s().A.isMobile}),originRect:e.isOpen?e.rect:void 0,onDismiss:()=>n(334261).VN(),trapFocus:!0})};function p({useBottomSheetStyling:e}){const t=(0,o().K8)((()=>r().A.state.isOpen),[]),n=(0,o().K8)((()=>l().default.state.open&&l().default.state.targetStore||i().default.state.mainEditorCurrentBlockStore),[]);return t&&n?(0,c.jsx)(d().AR,{blockStore:n,useBottomSheetStyling:e}):null}},816013:(e,t,n)=>{n.d(t,{r:()=>i});const i=n(757695).Store.createValue({showConvertTooltip:!1,forceShow:!1},{name:"WikiPromoStore"})},817148:(e,t,n)=>{n.d(t,{A:()=>v});var i=n(296540),s=()=>n(590526),o=()=>n(792057),a=()=>n(153953),r=()=>n(834051),l=()=>n(302501),d=()=>n(433847),c=()=>n(69708),u=()=>n(100622),p=()=>n(579627),g=()=>n(247123),m=()=>n(574357);n(898992),n(823215);function f(e){return e.blocks.every((e=>e.isRestricted()))}var h=()=>n(598101),y=n(474848);const v=function({store:e}){const t=(0,n(484714).v3)(),v=(0,n(792485).S)(),b=(0,i.useMemo)((()=>({environment:t,blocks:[e],publicEditMode:void 0,pageContext:v})),[t,e,v]),S=(0,s().K8)((()=>(0,m().U)([f,(0,h().A)(n(158658).p)])(b)),[b]),x=(0,s().K8)((()=>(0,m().U)([n(267)._,(0,h().A)(n(77295).K)])(b)),[b]);return S?(0,y.jsx)("div",{style:{backgroundColor:u().Tj.sidebarSecondaryBackground,boxShadow:`0 -1px 0 ${u().Tj.border.secondaryTranslucent}`,marginTop:n(726637).A.isMobile?28:1},children:(0,y.jsxs)(n(718827).Ay,{disabled:!x,style:{padding:12},onClick:()=>async function(e,t){if(!e.isDefined())return;const n=e.getPermissionItems(),i=(0,a().K)(e),s=i?d().wD((0,r().E)(i)):[],l=d().Cd(e.getModel(),n,s),u={type:"restore",permissionChanges:l},{accept:m}=await o().Gh({message:(0,g().r6)(u),acceptLabel:(0,g().QU)(u),cancelLabel:(0,y.jsx)(c().sA,{id:"restrictedPermissionConfirmationModal.actionButton.close",defaultMessage:"Close"}),description:(0,y.jsx)(g().f2,{openState:u})});m&&p().YD({environment:t,store:e})}(e,t),children:[(0,y.jsx)(l().A,{isMultiline:!0,isSmall:!0,children:(0,y.jsx)(c().sA,{id:"blockMenuRestrictedMessage.label",defaultMessage:"You don’t have permission to edit this block because it is restricted."})}),x?(0,y.jsx)(l().A,{style:{marginTop:6,fontWeight:n(284371).Wy.semibold},children:(0,y.jsx)(c().sA,{id:"blockMenuRestrictedMessage.adminRestoreAction.label",defaultMessage:"Restore permissions"})}):void 0]})}):null}},853306:(e,t,n)=>{n.d(t,{A:()=>w});n(581454);var i=n(296540),s=()=>n(590526),o=()=>n(401497),a=()=>n(609679),r=()=>n(404905),l=()=>n(695115),d=()=>n(406094),c=()=>n(160432),u=()=>n(302501),p=()=>n(995847),g=()=>n(340498),m=()=>n(69708),f=()=>n(100622),h=()=>n(284371),y=()=>n(115512),v=()=>n(141333),b=()=>n(484595),S=n(474848);const x=20;function M({icon:e,iconStyle:t,title:r,subtitle:l,confirmText:p,confirmTextStyle:b="blue",radioButtonStyle:M="blue",confirmTextPerRadioOption:w,cancelText:I,hideCancelButton:k=!1,radioOptions:T,defaultSelectedRadioOption:C,onDismiss:_,onSelectRadio:P,onConfirm:B,width:R,footer:D}){var L;const[E,O]=(0,i.useState)(C??(null===(L=T[0])||void 0===L?void 0:L.key)),N=(0,s().uB)(void 0,n(150669).A),F=(0,s().K8)((()=>null==N?void 0:N.state.elementRef),[N]),U=(0,v().CR)(F),z=(0,v().yE)(F),K=(0,v().o7)(F),V=z>0,q=Math.ceil(z+K)<Math.floor(U),W=(0,i.useCallback)((e=>{e!==E&&(O(e),null==P||P(e))}),[P,E]),G=(0,i.useCallback)((()=>{B(E)}),[B,E]),H=(0,o().IS)((()=>{const e={marginInlineStart:-20,marginInlineEnd:-20,height:1,borderTop:`1px solid ${f().Tj.border.secondaryTranslucent}`,transition:"opacity 200ms"};return{container:{display:"flex",position:"relative",flexDirection:"column",justifyContent:"center",overflow:"hidden",width:`min(${R??400}px, calc(100vw - 40px))`,maxHeight:"80vh",padding:x,borderRadius:6,alignItems:"stretch"},icon:{width:g().Ev.xl,height:g().Ev.xl,fill:f().Tj.icon.secondary,marginBottom:10,...t},iconContainer:{width:"100%",display:"flex",justifyContent:"center"},title:{fontFamily:h().vc(a().locale).sans,fontSize:17,lineHeight:"22px",fontWeight:h().Wy.medium,textAlign:"center",marginBottom:14},subtitle:{fontFamily:h().vc(a().locale).sans,fontSize:y().vQ,lineHeight:y().G6,fontWeight:h().Wy.regular,marginTop:6,marginBottom:6,textAlign:"center"},radioContainer:{display:"flex",flexDirection:"column",gap:8},topDivider:{...e,opacity:V?1:0},bottomDivider:{...e,opacity:q?1:0},scroller:{marginInlineStart:-20,marginInlineEnd:-20,paddingInlineStart:x,paddingInlineEnd:x},actionButtonsContainer:{display:"flex",flexDirection:"column",marginTop:20},cancelButton:{marginTop:8,justifyContent:"center"},dismissButton:{position:"absolute",top:10,insetInlineEnd:10,zIndex:1}}}),[t,q,V,R]),Y=(null==w?void 0:w[E])??p;return(0,S.jsxs)("div",{style:H.container,children:[(0,S.jsx)("div",{style:H.dismissButton,children:(0,S.jsx)(A,{onClick:_})}),e?(0,S.jsx)("div",{style:H.iconContainer,children:e(H.icon)}):void 0,(0,S.jsx)(u().A,{isMultiline:!0,style:H.title,children:r}),l?(0,S.jsx)(u().A,{isSmall:!0,style:H.subtitle,isMultiline:!0,children:l}):void 0,T.length>0?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("div",{style:H.topDivider}),(0,S.jsx)(n(917150)._,{type:n(611648).A.Y,style:H.scroller,store:N,children:(0,S.jsx)("div",{style:H.radioContainer,children:T.map((e=>(0,S.jsx)(j,{radioItem:e,radioButtonStyle:M,isSelected:e.key===E,onSelectRadio:W,left:e.left},e.key)))})}),(0,S.jsx)("div",{style:H.bottomDivider})]}):void 0,(0,S.jsxs)("div",{style:H.actionButtonsContainer,children:["blue"===b?(0,S.jsx)(c().A,{colorPalette:"blue",size:"lg",onClick:G,children:Y}):"red"===b?(0,S.jsx)(c().A,{size:"lg",onClick:G,colorPalette:"red",children:Y}):(0,S.jsx)(d().A,{size:"lg",onClick:G,children:Y}),k?void 0:(0,S.jsx)(d().A,{size:"lg",onClick:_,style:H.cancelButton,children:I??(0,S.jsx)(m().sA,{id:"radioModal.cancel",defaultMessage:"Cancel"})})]}),D]})}function A({onClick:e}){const t=(0,m().tz)(),n=(0,o().IS)((()=>({button:{display:"flex",justifyContent:"center",alignItems:"center",width:24,height:24,borderRadius:"100%",background:f().Tj.lightGrayButtonBackground},buttonHovered:{background:f().Tj.lightGrayButtonHoveredBackground},buttonPressed:{background:f().Tj.lightGrayButtonPressedBackground}})),[]);return(0,S.jsx)(l().A,{style:n.button,hoveredStyle:n.buttonHovered,pressedStyle:n.buttonPressed,onClick:e,icon:p().xMarkSmallIcon,ariaLabel:t.formatMessage({id:"dismissButton.ariaLabel",defaultMessage:"Close"})})}function j({radioItem:e,isSelected:t,onSelectRadio:n,radioButtonStyle:i="blue",left:s}){const a=(0,o().IS)((()=>({button:{display:"flex",justifyContent:"space-between",gap:10,height:"auto",minHeight:70,borderRadius:8,paddingTop:12,paddingBottom:12,paddingInlineStart:14,paddingInlineEnd:14-b().p,border:void 0,boxShadow:t?`inset 0 0 0 1px ${"blue"===i?f().Tj.blue.icon.accentPrimary:f().Tj.red.icon.accentPrimary}`:`inset 0 0 0 1px ${f().Tj.border.primary}`},buttonText:{display:"flex",flexDirection:"column",gap:2,...h().RC},optionTitle:{fontWeight:h().Wy.medium},optionSubtitle:{whiteSpace:"break-spaces"},left:{display:"flex",alignItems:"center",justifyContent:"center"}})),[t,i]);return(0,S.jsxs)(d().A,{size:"lg",onClick:()=>n(e.key),style:a.button,children:[s?(0,S.jsx)("div",{style:a.left,children:s}):void 0,(0,S.jsxs)("div",{style:a.buttonText,children:[(0,S.jsx)(u().A,{style:a.optionTitle,children:(0,S.jsx)(r().j,{children:e.title})}),e.subtitle?(0,S.jsx)(u().A,{isSmall:!0,isMultiline:!0,style:a.optionSubtitle,children:e.subtitle}):void 0]}),(0,S.jsx)(b().A,{isSelected:t,radioButtonColor:i})]})}const w=i.memo(M)},856790:(e,t,n)=>{n.r(t),n.d(t,{default:()=>A,getSpaceViewMenuItems:()=>j});n(944114),n(296540);var i=()=>n(907258),s=()=>n(726637),o=()=>n(484714),a=()=>n(590526),r=()=>n(574359),l=()=>n(245720),d=()=>n(30537),c=()=>n(546926),u=()=>n(890492),p=()=>n(81068),g=()=>n(663639),m=()=>n(736847),f=()=>n(69708),h=()=>n(835435),y=(n(898992),n(354520),()=>n(496603));var v=()=>n(190207),b=()=>n(634596),S=()=>n(16205),x=()=>n(187820),M=n(474848);const A=function(){const e=(0,a().O$)(v().A);return(0,M.jsx)(n(127833).zD,{popupType:s().A.isMobile?d().n.SlideUp:d().n.Popup,open:e.open,render:()=>(0,M.jsx)(w,{}),originGap:8,onDismiss:h().Ew,originRect:e.originRect,enableRounding:!0})};function j(e,t){const{currentUserRootStore:n}=i().default.state;if(!n)return[];const{editableStores:o}=function(e){const t=y().hS(e.getSpaceViewStores(),(e=>e.getSpaceId())),n=t.filter((e=>{const t=e.getSpaceStore();return e.isReady()&&(null==t?void 0:t.isReady())})),i=n.filter((e=>{const t=e.getSpaceStore();return e.isReady()&&(null==t?void 0:t.isReady())&&t.canEdit()}));return{total:t.length,loaded:n.length,editable:i.length,editableStores:i}}(n),a=[];for(const i of o){const n=i.getSpaceStore();if(null!=n&&n.isReady()&&n.canEdit()){const o=(0,r().G)(e,n),l=n.getIcon();a.push({key:i.id,action:async()=>{await(0,S().CI)({environment:e,blockStore:t,spaceStore:n,spaceViewStore:i})},render:e=>(0,M.jsx)(p().A,{title:o,icon:(0,M.jsx)(x().B6,{icon:l,iconRecordCategory:"workspace",isEmptyPage:!1,title:o,size:s().A.isMobile?24:20,disabled:!0}),...e})})}}return a}function w(){const e=(0,o().v3)(),t=(0,a().O$)(v().A),n=(0,a().K8)((()=>i().default.state.currentUserRootStore),[]),r=(0,a().K8)((()=>t.store?j(e,t.store):[]),[e,t]);if(!t.open||!n)return null;const d=[{key:"spaces",render:e=>(0,M.jsx)(m().A,{title:s().A.isMobile?void 0:(0,M.jsx)(f().sA,{defaultMessage:"Choose a workspace",id:"duplicatePagePopup.chooseWorkspace.menuItem.title"}),...e}),items:r},{key:"logout",render:e=>(0,M.jsx)(m().A,{...e,topBorder:!0}),items:[{key:"logout",action:()=>b().ri(e),render:e=>(0,M.jsx)(I,{...e})}]}];let p;return p=s().A.isMobile?{menuType:c().gu.Modal,title:(0,M.jsx)(f().sA,{defaultMessage:"Choose a workspace",id:"duplicatePagePopup.choooseWorkspaceMobileMenu.title"}),right:(0,M.jsx)(f().sA,{...l().W.cancel}),onClickRight:h().Ew}:{menuType:c().gu.Popup},(0,M.jsx)(u().A,{...p,children:(0,M.jsx)(g().A,{type:g().O.Vertical,sections:d,initialFocus:1})})}function I(e){const t=(0,a().K8)((()=>{const{currentUserStore:e}=i().default.state;return(null==e?void 0:e.getEmail())||""}),[]);return(0,M.jsx)(p().A,{caption:(0,M.jsx)(f().sA,{defaultMessage:"Log out ({email})",id:"duplicatePagePopup.buttonMenuItem.logoutButton.label",values:{email:t}}),...e})}},858038:(e,t,n)=>{n.d(t,{U:()=>i});const i=new(n(79926).O2)("notifications",(()=>Promise.all([n.e(75134),n.e(35530),n.e(9773),n.e(36556),n.e(55373),n.e(36192),n.e(40537),n.e(71562),n.e(96346),n.e(44711),n.e(53321),n.e(51220),n.e(16471),n.e(37353),n.e(37571),n.e(29151),n.e(40118),n.e(50397),n.e(62475),n.e(3151),n.e(98629),n.e(49889),n.e(20108),n.e(27992),n.e(63452),n.e(66249),n.e(92845),n.e(87249),n.e(79022),n.e(44854),n.e(34877),n.e(46414),n.e(11676),n.e(61165),n.e(47668),n.e(94522),n.e(44584),n.e(24587),n.e(67494),n.e(3651),n.e(38293),n.e(40992),n.e(88455),n.e(64556),n.e(33893),n.e(91793),n.e(55162),n.e(71003),n.e(32370),n.e(26264),n.e(36437),n.e(50363),n.e(42660),n.e(44590),n.e(55113),n.e(85071),n.e(7914),n.e(25588),n.e(68637),n.e(23640),n.e(72252),n.e(93134),n.e(12452),n.e(52871),n.e(29351),n.e(18825),n.e(71853),n.e(93049),n.e(22582),n.e(18636),n.e(87289),n.e(16060),n.e(34281),n.e(48376),n.e(35279),n.e(80229),n.e(77754),n.e(71309),n.e(39986),n.e(47431),n.e(90880),n.e(14388),n.e(95768),n.e(90609),n.e(31106),n.e(7595),n.e(31478),n.e(59264),n.e(6893)]).then(n.bind(n,367241))))},863642:(e,t,n)=>{n.d(t,{f:()=>a,j:()=>o});var i=()=>n(757695);class s extends i().Store{getInitialState(){return{selectedTab:"home"}}setSelectedTab(e){this.setState({selectedTab:e})}}const o=new s,a=i().Store.createValue(n(749687).SIDEBAR_MIN_WIDTH,{name:"sidebarPreviousNonFullWidthStore"})},867159:(e,t,n)=>{n.d(t,{J8:()=>m,p7:()=>g});n(296540);var i=()=>n(726637),s=()=>n(401497),o=()=>n(250910),a=()=>n(631524),r=()=>n(324254),l=()=>n(69708),d=()=>n(100622),c=()=>n(74263),u=()=>n(26517),p=n(474848);function g(e){const{buttonPopupStore:t,disabled:n,currentVisibility:i}=e,s=(0,p.jsx)(l().sA,{...c().vG[i]});return(0,p.jsx)(f,{disabled:n,buttonPopupStore:t,currentVisibilityLabel:s,renderVisibilityLevelsMenu:t=>(0,p.jsx)(u().aj,{...e,onClose:()=>{var n;null===(n=e.onClose)||void 0===n||n.call(e),t.close()}})})}function m(e){const{buttonPopupStore:t,disabled:n,currentVisibility:i}=e,s=(0,p.jsx)(l().sA,{...c().PP[i]});return(0,p.jsx)(f,{disabled:n,buttonPopupStore:t,currentVisibilityLabel:s,renderVisibilityLevelsMenu:t=>(0,p.jsx)(u().f3,{...e,onClose:()=>{var n;null===(n=e.onClose)||void 0===n||n.call(e),t.close()}})})}function f(e){const{buttonPopupStore:t,currentVisibilityLabel:n,renderVisibilityLevelsMenu:l,disabled:c}=e,u=(0,s().IS)((()=>({currentVisibilityLabel:{color:d().Tj.text.secondary,paddingInlineEnd:4,height:i().A.isMobile?32:22}})),[]);return(0,p.jsx)(o().A,{popupType:i().A.isMobile?o().z.BottomSheet:o().z.Popup,bottomSheetInitialState:"half",buttonPopupStore:t,renderOrigin:e=>(0,p.jsx)(a().p,{style:u.currentVisibilityLabel,disabled:c,iconTrailing:{icon:r().arrowChevronSingleDownSmallIcon,colorVariant:"tertiary",size:"xs"},...e,children:n}),render:l})}},885067:(e,t,n)=>{n.d(t,{y:()=>a});n(296540);var i=()=>n(287188),s=()=>n(302501),o=n(474848);function a({title:e,description:t,disabled:n=!1,selected:a,onChange:r=(()=>{})}){return(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:()=>!n&&r(!a),children:[(0,o.jsxs)("div",{style:{fontSize:14,marginInlineEnd:8,flexGrow:1},children:[e,t?(0,o.jsx)(s().A,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:t}):void 0]}),(0,o.jsx)("div",{style:{marginTop:5},children:(0,o.jsx)(i().A,{on:a,disabled:n})})]})}},885400:(e,t,n)=>{n.d(t,{A:()=>l});var i=()=>n(401497),s=()=>n(340498),o=()=>n(558687),a=()=>n(182183),r=()=>n(100622);function l(e){const{style:t}=e,n=(0,i().eP)(),l=(0,i().IS)((()=>({notionLogo:{height:s().Ev.sm,width:s().Ev.sm,fill:r().Tj.icon.primary,...t}})),[t]);return"dark"===n?(0,o().notionIcon)(l.notionLogo):(0,a().notionTintableIcon)(l.notionLogo)}},887480:(e,t,n)=>{n.d(t,{Ay:()=>s().A,yQ:()=>a});var i=()=>n(79926),s=()=>n(853306);const o=new(i().O2)("radioModalRenderer",(()=>n.e(35818).then(n.bind(n,415995)))),a=(0,i()._h)(o,(e=>e.default))},905073:(e,t,n)=>{n.d(t,{z:()=>d});var i=()=>n(564884),s=()=>n(757695),o=()=>n(755125),a=()=>n(301809),r=()=>n(206267),l=()=>n(683021);function d(e){const{environment:t,blockStore:n,insertedTextBlockLocation:d,editSelection:c,getRectFromStore:u}=e,p=l().Ay.state;if(c({environment:t,store:n}),(0,a().e)({store:n.getBlockTitleStore()}),!p.open&&!t.device.isPhone){const e=n.getBlockTitleStore(),c=u(n),p=r().JW();c&&(l().Ay.setState({id:p,open:!0,isAddMenu:!0,collapsed:!0,textStore:e,oldTextValue:e.getValue(),oldSelection:{startIndex:0,endIndex:0},selectionRect:c,lettersAtLastResult:0,filter:"",temporaryInputDataStore:s().Store.createValue(void 0,{name:"temporaryInputData"}),insertedTextBlockLocation:d}),(0,o().clear)({environment:t}),(0,a().e)({store:e}),(0,i().u)({environment:t,event:{eventName:"open_slash_menu",eventProperties:{id:p,source:"add_button"}}}))}}},905246:(e,t,n)=>{n.r(t),n.d(t,{TopbarMoreButton:()=>B,messages:()=>R});var i=n(296540),s=()=>n(907258),o=()=>n(726637),a=()=>n(484714),r=()=>n(590526),l=()=>n(401497),d=()=>n(250910),c=()=>n(807449),u=()=>n(700500),p=()=>n(589407),g=()=>n(69708),m=()=>n(100622),f=()=>n(278634),h=()=>n(314529);var y=()=>n(33050),v=()=>n(544198),b=()=>n(12314),S=()=>n(440024),x=()=>n(448360),M=()=>n(816013),A=()=>n(404694),j=()=>n(734762),w=()=>n(148297),I=()=>n(681621),k=n(474848);function T(e){const{originRef:t}=e,n=(0,A().V)();return(0,k.jsx)(j().U,{calloutId:"ai_page_translation",inAppCalloutStore:n,children:(0,k.jsx)(w().k,{origin:t,placementToOrigin:"bottom",header:(0,k.jsxs)("div",{style:{display:"flex",fontSize:14,gap:12,paddingInlineStart:4,paddingInlineEnd:4},children:[(0,k.jsx)(c().I,{icon:I().textTranslateSmallIcon,size:"sm",colorPalette:"blue",colorVariant:"accentPrimary"}),(0,k.jsx)(g().sA,{id:"aiPageTranslationTooltip.header",defaultMessage:"You can always find translation in the top right menu"})]}),showPointer:!1,pointerOffset:6,content:null,onCloseClick:()=>{x().W.reset()},style:{width:300},onPrimaryButtonClick:()=>{x().W.reset()},nextButtonContent:(0,k.jsx)(g().sA,{id:"aiPageTranslationTooltip.dismiss",defaultMessage:"Got it"})})})}var C=()=>n(612900),_=()=>n(782473);function P({originRef:e}){const t=(0,A().V)();return(0,k.jsx)(j().U,{calloutId:"wiki_promo",inAppCalloutStore:t,children:(0,k.jsx)(w().k,{origin:e,placementToOrigin:"bottom",header:"Upgrade your existing wikis",content:"Look for the Turn into wiki action here",onCloseClick:()=>{M().r.reset()},pointerPosition:"98%",pointerLength:24,pointerOffset:-3,style:{width:_().Sw}})})}function B({buttonPopupStore:e,store:t,isLastButton:n,renderOrigin:c}){const p=(0,a().v3)(),{device:g}=p,[A,j]=(0,i.useState)(void 0),w=(0,i.useRef)(null),I=(0,i.useCallback)((()=>{M().r.reset(),x().W.reset(),(0,S().I)({environment:p});const e=w.current;e&&j(e.getBoundingClientRect()),function(e){(0,h().DO_NOT_USE_trackLegacy)(e,"open_more_menu")}(p)}),[w,p]),_=(0,r().K8)((()=>M().r.state.showConvertTooltip),[]),B=(0,r().O$)(x().W),R=(0,b().vP)(),D=(0,l().IS)((()=>({mobilePopupStyle:{borderRadius:12,backgroundColor:m().Tj.background.secondary}})),[]),O=(0,k.jsxs)(k.Fragment,{children:[_?(0,k.jsx)(P,{originRef:w}):B?(0,k.jsx)(T,{originRef:w}):R?(0,k.jsx)(b().QB,{originRef:w}):null,(0,k.jsx)(d().A,{popupType:o().A.isMobile?d().z.BottomSheet:d().z.Popup,buttonPopupStore:e,renderOrigin:c||(e=>(0,k.jsx)(E,{ref:w,buttonPopupEvents:e,isLastButton:n})),onClick:I,render:()=>(0,k.jsx)(y().P,{blockStore:t,onClickOriginRect:A,handleAccept:t=>function(e,t,n){const{mainEditorCurrentBlockStore:i}=s().default.state;if(i){const t=i.getType();if(t){const{collectionId:s,ownedCollectionCount:o,linkedCollectionCount:a}=(0,v().P)(i,{skipPages:!0});(0,f().N)(n,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"topbar_more_menu",block_id:i.id,block_type:t,is_toggleable:(0,u().Yt)(t,i.getFormat()),collection_id:s,owned_collection_count:o,linked_collection_count:a,parent_collection_id:i.getParentCollectionIdUpToTwoLevels(),form_id:i.getFirstFormIdInCollectionViewBlock()})}}e.closeParentMenu&&L(t)}(t,e,p),handleDismiss:()=>L(e)}),originGap:g.isElectronWindows?12:8,alignmentToOrigin:"end",forceInitialInbound:!0,style:o().A.isMobile?D.mobilePopupStyle:{width:256,maxHeight:"80vh"}})]}),N=(0,r().K8)((()=>s().default.state.inAppCalloutStore.getCalloutVisibility("ai_page_translation").canShow),[]);return B&&N?(0,k.jsx)(C().u,{shape:"square",borderRadius:6,children:O}):O}const R=(0,g().YK)({actions:{defaultMessage:"Actions",id:"topbar.actions"}});function D(e,t){const{device:i}=e;if(!o().A.isMobile){const{iconButton:{width:e,height:t}}=(0,n(863059).Hh)();return{display:"flex",alignItems:"center",justifyContent:"center",width:e,height:t,borderRadius:6}}const s=(0,n(978578).aD)().iconContainer;return t?{...s,marginInlineStart:i.isTablet?-6:void 0,marginInlineEnd:0}:{...s,marginInlineStart:i.isTablet?-6:void 0,marginInlineEnd:i.isTablet?-6:s.marginInlineEnd}}function L(e){e.setState({...e.state,open:!1})}const E=i.forwardRef((function({buttonPopupEvents:e,isLastButton:t},i){const s=(0,a().v3)(),{device:r}=s,l=(0,g().tz)();return(0,k.jsx)(n(26697).m,{renderTooltip:()=>s.currentUser.isLoggedIn()?(0,k.jsx)(g().sA,{defaultMessage:"Style, export, and more…",id:"topbarMoreButton.tooltip"}):(0,k.jsx)(g().sA,{defaultMessage:"More…",id:"topbarMoreButton.loggedOut.tooltip"}),placement:"bottom",originGap:r.isElectronWindows?10:void 0,delayThreshold:400,render:a=>(0,k.jsx)(n(718827).Ay,{ref:i,style:D(s,t),className:n(882722).ug9,ariaLabel:l.formatMessage(R.actions),...(0,n(383036).A)(e,a),children:o().A.isMobile?(0,k.jsx)(c().I,{icon:p().ellipsisIcon,colorVariant:"primary",size:"lg"}):(0,k.jsx)(c().I,{icon:p().ellipsisIcon,size:"lg",colorVariant:"primary"})})})}))},911909:(e,t,n)=>{n.d(t,{lY:()=>L,C$:()=>R,Cy:()=>D,c8:()=>N,mz:()=>E,lE:()=>O,JK:()=>B,i_:()=>_,K6:()=>P,pF:()=>F,ky:()=>U,Im:()=>z});var i=n(296540),s=()=>n(135168),o=()=>n(242422),a=()=>n(726637),r=()=>n(402014),l=()=>n(484714),d=()=>n(819121),c=()=>n(590526),u=()=>n(75435),p=()=>n(849255),g=()=>n(267956),m=()=>n(187174),f=()=>n(427704),h=()=>n(798880),y=()=>n(564884),v=()=>n(263470);var b=()=>n(329458),S=()=>n(729283),x=()=>n(44551);function M(){var e;null===x().electronApi||void 0===x().electronApi||null===(e=x().electronApi.toggleMaximized)||void 0===e||e.call(x().electronApi)}var A=()=>n(529543),j=()=>n(499764),w=()=>n(299545),I=()=>n(821507),k=()=>n(155723),T=()=>n(326589),C=()=>n(172079);function _(e){const{store:t,environment:n}=e,i=(0,s().f)(t),o=!t||(0,w()._C)(t),{id:a}=n.currentUser,r=a&&i?p().L.createChildStore(i,{table:h().oo,id:a}):void 0,l=!r||r.isReady();return o&&l}function P(e,t){return!a().A.isAdminMode&&(0,j().qb)(t,e,e.getSpaceStore())}function B(){return o().default.checkGate({gateName:"sites_deprecate_edit_and_comment_top_bar"})}f().JZ.signup,f().JZ.product;async function R(e){const{environment:t,route:n,openInNewTab:i}=e;!function(e){(0,y().u)({environment:e,event:{eventName:v().$,eventProperties:{}}})}(t),await S().NT(t,{utmContent:"sites_banner_cta",nextRoute:n,openInNewTab:i})}async function D(e){const{environment:t,route:n,openInNewTab:i}=e;(0,b().L)(t,{variant:"made_with_notion"}),await S().VE(t,{utmContent:"topbar_cta",nextRoute:n,openInNewTab:i})}async function L(e){const{environment:t,route:n,formId:i,spaceId:s,openInNewTab:o}=e;(0,b().L)(t,{variant:"made_with_notion"}),await S()._q(t,{utmContent:"topbar_cta",nextRoute:n,formId:i,spaceId:s,openInNewTab:o})}function E(e){var t;e.target!==e.currentTarget||null!==(t=u().A.state.preferences)&&void 0!==t&&t.isAlwaysOnTabBarEnabled||u().A.state.isShowingTabBar||(0,r().SQ)(e,r().y$.EditorDoubleClick,M)}function O(e){const t=e.target;t instanceof HTMLElement&&(0,d().p)(t)&&C().A.setState(!0)}function N(){C().A.setState(!1)}function F({device:e,route:t}){return"page"===t.name&&(0,I().aD)(e)}function U(){const e=(0,l().v3)(),[t,n]=(0,i.useState)(!1);return(0,i.useEffect)((()=>{!async function(){const t=await(0,A().getCookie)(e,"notion_client_deploy_preview");n(void 0!==t)}()}),[e]),t}function z(e){const{store:t}=e,n=(0,l().v3)(),[{status:i}]=(0,m().Yb)((async()=>await g().A.waitUntilLoaded()),[]);return(0,c().K8)((()=>{if(!t)return{shouldRenderPublicPageTopbar:!1,shouldRenderPublicShareLinkTopbar:!1,shouldRenderLoggedOutSidebarButton:!1,isLoading:!1};if(!_({store:t,environment:n})||"pending"===i)return{shouldRenderPublicPageTopbar:!1,shouldRenderPublicShareLinkTopbar:!1,shouldRenderLoggedOutSidebarButton:!1,isLoading:!0};const e=!n.currentUser.isLoggedIn(),s=P(t,n),o=!!s&&(0,T().g)();return{shouldRenderPublicPageTopbar:Boolean(s&&!o),shouldRenderPublicShareLinkTopbar:Boolean(o&&e),shouldRenderLoggedOutSidebarButton:(0,k().shouldShowLoggedOutPublicSharingSidebar)(n),isLoading:!1}}),[n,t,i])}},913687:(e,t,n)=>{n.d(t,{A:()=>i});const i=(0,n(69708).YK)({inputPlaceholder:{defaultMessage:"Property name",id:"database.viewSettings.propertyTab.propertyName"},autofillOffLabel:{defaultMessage:"Off",id:"database.viewSettings.propertyTab.autofillOffLabel"},autofillOnLabel:{defaultMessage:"On",id:"database.viewSettings.propertyTab.autofillOnLabel"},keptUpToDateWithNotionAITooltip:{defaultMessage:"Auto-updated by AI",id:"database.tableHeaderCell.tooltipAiAutofillDescription"},buttonPropertyErrorTooltip:{defaultMessage:"Button property has an error",id:"database.tableHeaderCell.tooltipButtonPropertyError"},offlineWarningFormula:{id:"database.tableHeaderCell.offlineWarning.formula",defaultMessage:"Formula results may not be accurate when offline"},offlineWarningAutoUpdate:{id:"database.tableHeaderCell.offlineWarning.autoUpdate",defaultMessage:"Content will not auto-update when offline"},usersAndGroups:{defaultMessage:"Users and groups",id:"database.personProperty.notifications.usersAndGroups"},usersOnly:{defaultMessage:"Users only",id:"database.personProperty.notifications.usersOnly"},none:{defaultMessage:"None",id:"database.personProperty.notifications.none"},itemNameSingular:{defaultMessage:"Singular",id:"database.viewSettings.propertyTab.itemName.singular"},itemNamePlural:{defaultMessage:"Plural",id:"database.viewSettings.propertyTab.itemName.plural"}})},936529:(e,t,n)=>{n.r(t),n.d(t,{default:()=>K});var i=n(296540),s=()=>n(933922),o=()=>n(726637),a=()=>n(484714),r=()=>n(590526),l=()=>n(401497),d=()=>n(929219),c=()=>n(792057),u=()=>n(807449),p=()=>n(416783),g=()=>n(31511),m=()=>n(546926),f=()=>n(406094),h=()=>n(890492),y=()=>n(424400),v=()=>n(663639),b=()=>n(736847),S=()=>n(15936),x=()=>n(69708);const M=["dmca_no_action"],A=(0,x().YK)({phishing_or_spam:{id:"reportPage.reportReasons.phishing_or_spam",defaultMessage:"Phishing or spam"},inappropriate_content:{id:"reportPage.reportReasons.inappropriate_content",defaultMessage:"Inappropriate content"},other_content_policy_violation:{id:"reportPage.reportReasons.other_content_policy_violation",defaultMessage:"Other"},dmca_no_action:{id:"reportPage.reportReasons.dmca_no_action",defaultMessage:"DMCA takedown request"}});var j=()=>n(100622),w=()=>n(496603),I=()=>n(284371),k=()=>n(769864),T=()=>n(201170),C=()=>n(907258),_=()=>n(161479);var P=()=>n(135552),B=()=>n(232930),R=()=>n(736026),D=()=>n(716583),L=()=>n(819121),E=()=>n(484595),O=n(474848);function N({name:e,title:t,caption:n,isSelected:s,onClick:a,disabled:r}){const[d,c]=(0,L().A)(),u=(0,l().IS)((()=>({root:{position:"relative",display:"flex",alignItems:"center",flex:1,fontSize:14,marginBottom:8,cursor:"pointer",opacity:r?.4:1,...c&&{boxShadow:j().Tj.buttonBlueFocusRing}},caption:{color:j().Tj.text.secondary,marginInlineStart:8},input:{position:"absolute",top:0,insetInlineStart:0,width:"100%",height:"100%",opacity:0}})),[r,c]),p=(0,i.useCallback)((()=>{r||a()}),[r,a]);return o().A.isMobile?(0,O.jsx)(y().Ay,{title:t,right:(0,O.jsx)(E().A,{isSelected:s}),onClick:p}):(0,O.jsxs)("label",{style:u.root,children:[(0,O.jsx)(E().A,{isSelected:s}),(0,O.jsx)("div",{children:t}),n?(0,O.jsx)("div",{style:u.caption,children:n}):void 0,(0,O.jsx)("input",{type:"radio",checked:s,disabled:r,name:e,onClick:p,style:u.input,ref:d})]})}var F=()=>n(690197),U=()=>n(327165);const z=(0,x().YK)({additionalInformationPlaceholder:{id:"reportPage.additionalInformation.placeholder",defaultMessage:"Please describe how this content violates our Content & Use Policy ({otherSelected, select, true {required} other {optional}})"},dialogLabel:{id:"reportPage.dialogLabel",defaultMessage:"Report page"}});const K=function(){const e=(0,x().tz)(),t=(0,r().K8)((()=>R().A.state.open),[]);return(0,O.jsx)(n(560729).A,{ariaLabel:e.formatMessage(z.dialogLabel),onDismiss:Z,render:()=>(0,O.jsx)(te,{}),isOpen:t})};function V(e){const{reason:t,additionalInformation:n}=e;return void 0!==t&&(!M.includes(t)&&!("other_content_policy_violation"===t&&!n))}function q(){const{state:e}=R().A;if(e.open){const{reason:t,additionalInformation:n}=e;return V({reason:t,additionalInformation:n})}return!1}function W({modalState:e}){const t=(0,x().tz)(),{reason:n}=e;return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(N,{title:(0,O.jsx)(x().sA,{id:"reportPageModal.reportReasons.phishing_or_spam",defaultMessage:"Phishing or spam"}),isSelected:"phishing_or_spam"===n,onClick:()=>R().A.setState({...e,reason:"phishing_or_spam"}),name:"report-page-modal"},"phishing_or_spam"),(0,O.jsx)(N,{title:t.formatMessage(A.inappropriate_content),isSelected:"inappropriate_content"===n,onClick:()=>R().A.setState({...e,reason:"inappropriate_content"}),name:"report-page-modal"},"inappropriate_content"),(0,O.jsx)(N,{title:t.formatMessage(A.dmca_no_action),isSelected:"dmca_no_action"===n,onClick:()=>R().A.setState({...e,reason:"dmca_no_action"}),name:"report-page-modal"},"dmca_no_action"),(0,O.jsx)(N,{title:(0,O.jsx)(x().sA,{id:"reportPageModal.reportReasons.other_content_policy_violation",defaultMessage:"Other"}),isSelected:"other_content_policy_violation"===n,onClick:()=>R().A.setState({...e,reason:"other_content_policy_violation"}),name:"report-page-modal"},"other_content_policy_violation")]})}async function G(e,t){const n=R().A.getState();if(!n.open)return;const{additionalInformation:i,reason:s}=n,o=function(){if(C().default.state.mainEditorCurrentBlockStore)return{id:C().default.state.mainEditorCurrentBlockStore.id,spaceId:(0,_().e)(C().default.state.mainEditorCurrentBlockStore.pointer.spaceId)}}();if(null==o||!o.id||!s||!V({reason:s,additionalInformation:i}))return void c().f1((0,O.jsx)(x().sA,{defaultMessage:"Something went wrong.",id:"reportPageModal.somethingWentWrong.label"}));const a=await k().callApi({eventName:"reportPage",environment:e,data:{reason:s,page:o,additionalInformation:i}});"failed"===a.type?c().Qg(a):(R().A.setState({open:!1}),c().rG({message:(0,O.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,O.jsx)(u().I,{icon:S().checkmarkShieldIcon,size:"xl"}),(0,O.jsx)("div",{style:{paddingTop:12,paddingBottom:8,textAlign:"center"},children:(0,O.jsx)(x().sA,{id:"reportPageModal.thanksForReporting",defaultMessage:"Thanks for reporting this page, our team will take a look."})})]})}))}function H(){return{width:"100%",background:j().Tj.popoverBackground,display:"block",padding:o().A.isMobile?16:"10px 12px",height:o().A.isMobile?150:130,marginTop:17,marginBottom:17,fontSize:o().A.isMobile?16:14}}function Y({isMobile:e=!1}){return(0,O.jsx)(x().sA,{defaultMessage:"This page is hosted by Notion. Use this form to submit a report if you believe this page violates <contentpolicylink>Notion’s content policy</contentpolicylink>.{br}{br}<clarification>This is not a contact form for the person or organization that authored this page</clarification>.",id:"reportPageModal.reportButton.description",values:{br:(0,O.jsx)("br",{}),contentpolicylink:(...t)=>(0,O.jsx)(F().A,{title:t,href:(0,B().x)("contentPolicy"),analyticsFrom:"report_page",style:{display:"inline",marginInlineStart:void 0},buttonStyle:{alignItems:"baseline",height:e?I().K_.UISmall.mobile:I().K_.UISmall.desktop,paddingInlineStart:"3px",paddingInlineEnd:"2px"},textSize:"small",isMobile:e}),clarification:(...e)=>(0,O.jsx)("i",{children:e})}})}function $(){return(0,O.jsx)(x().sA,{defaultMessage:"To submit a formal DMCA takedown request, please follow the instructions detailed in <dmcapolicylink>Notion’s official DMCA policy</dmcapolicylink>.",id:"reportPageModal.reportButton.dmcaInstructions",values:{dmcapolicylink:(...e)=>(0,O.jsx)(p().V,{external:!0,href:"https://www.notion.so/notion/DMCA-Policy-69d880bd37fe496a9b7c64ccc65e024d",children:e})}})}function Q(){return(0,O.jsx)("div",{style:{width:360,padding:24,fontSize:14,color:j().Tj.text.secondary},children:(0,O.jsx)(x().sA,{defaultMessage:"Please go online to make a report.",id:"reportPageModal.offlineMessage.description"})})}function Z(){T().lR()}function X(){return(0,l().IS)((()=>({reportPageExplanation:{color:j().Tj.text.tertiary,background:j().Tj.background.primary,border:`1px solid ${j().Tj.border.strong}`},reportPageBanner:{justifyContent:void 0,whiteSpace:"normal",display:"block",paddingTop:"7px",paddingBottom:"7px",marginBottom:"15px"},mobileDescription:{color:j().Tj.text.secondary,padding:"5px",fontSize:I().J.UISmall.mobile},modalTitle:{fontSize:16,marginBottom:12,fontWeight:I().Wy.medium}})),[])}function J({modalState:e}){const t=(0,a().v3)(),n=(0,x().tz)(),i=X();if(!e.open)return null;const{reason:s}=e,o={menuType:m().gu.Modal,title:(0,O.jsx)(x().sA,{id:"reportPageModal.mobile.title",defaultMessage:"Report page"}),right:(0,O.jsx)(x().sA,{id:"reportPageModal.closeButton.label",defaultMessage:"Close"}),onClickRight:Z};return(0,O.jsx)(h().A,{...o,children:(0,O.jsx)(v().A,{type:v().O.Vertical,initialFocus:void 0,sections:w().oE([{key:"help",render:({children:e,...t})=>(0,O.jsx)(b().A,{...t,disableMobilePadding:!0,mobileStyle:{marginTop:"20px"},children:e}),items:[{key:"help",render:()=>(0,O.jsx)(y().Ay,{title:(0,O.jsx)(Y,{isMobile:!0}),textWrapperStyle:i.mobileDescription,shouldWrapTitle:!0,right:(0,O.jsx)(O.Fragment,{}),onClick:()=>{}}),action:()=>{}}]},{key:"reportOptions",render:({children:e,...t})=>(0,O.jsx)(b().A,{...t,disableMobilePadding:!0,mobileStyle:{marginTop:"20px"},children:e}),items:[{key:"options",render:()=>(0,O.jsx)(W,{modalState:e}),action:()=>{}},{key:"additionalInfo",render:()=>s&&!M.includes(s)&&(0,O.jsx)(g().A,{textarea:!0,style:H(),focus:Boolean(e.reason),value:e.additionalInformation,placeholder:n.formatMessage(z.additionalInformationPlaceholder,{otherSelected:"other_content_policy_violation"===s}),onChange:t=>{R().A.setState({...e,additionalInformation:t.target.value})}}),action:()=>{}}]},"dmca_no_action"===s?{key:"explain_dmca",render:({children:e,...t})=>(0,O.jsx)(b().A,{...t,disableMobilePadding:!0,mobileStyle:{marginTop:"20px"},children:e}),items:[{key:"explain_dmca",render:()=>"dmca_no_action"===s&&(0,O.jsx)(y().Ay,{title:(0,O.jsx)($,{}),textWrapperStyle:{...i.mobileDescription,background:j().Tj.palette.yellow[100],color:j().Tj.palette.yellow[600],margin:"0px",padding:"10px 20px"},style:{display:"block"},shouldWrapTitle:!0,right:(0,O.jsx)(O.Fragment,{}),onClick:()=>{}}),action:()=>{}}]}:void 0,{key:"actions",render:({children:e,...t})=>(0,O.jsx)(b().A,{...t,disableMobilePadding:!0,mobileStyle:{marginTop:"20px"},children:e}),items:[{key:"submit",render:e=>{const{onClick:n,...i}=e,s=q();return(0,O.jsx)(U().A,{...i,disabled:!s,title:(0,O.jsx)("div",{style:{color:s?j().oZ.red:j().oZ.uiGray},children:(0,O.jsx)(x().sA,{id:"reportPageModal.reportButton.label",defaultMessage:"Report"})}),onClick:()=>G(t)})},action:()=>G(t)}]}])},"main list")})}function ee({modalState:e}){const t=(0,a().v3)(),n=(0,x().tz)(),i=X();if(!e.open)return null;const{reason:o}=e,r="dmca_no_action"===o;return(0,O.jsx)(s().A,{capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!1,render:()=>(0,O.jsxs)("div",{style:{width:360,padding:24,fontSize:14},children:[(0,O.jsx)("div",{style:i.modalTitle,children:(0,O.jsx)(x().sA,{id:"reportPageModal.title",defaultMessage:"Why are you reporting this page?"})}),(0,O.jsx)(D().A,{textSize:"small",styleKey:P().q.Yellow,style:r?i.reportPageBanner:{...i.reportPageExplanation,...i.reportPageBanner},children:r?(0,O.jsx)($,{}):(0,O.jsx)(Y,{})}),(0,O.jsx)("div",{children:(0,O.jsx)(W,{modalState:e})}),o&&!M.includes(o)?(0,O.jsx)(g().A,{textarea:!0,style:H(),focus:Boolean(e.reason),value:e.additionalInformation,placeholder:n.formatMessage(z.additionalInformationPlaceholder,{otherSelected:"other_content_policy_violation"===o}),onChange:t=>{R().A.setState({...e,additionalInformation:t.target.value})}}):void 0,(0,O.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:18},children:[(0,O.jsx)(f().A,{size:"lg",onClick:Z,style:{marginInlineEnd:12},children:(0,O.jsx)(x().sA,{id:"reportPageModal.cancelButton.label",defaultMessage:"Cancel"})}),(0,O.jsx)(f().A,{colorPalette:"red",size:"lg",onClick:()=>G(t),disabled:!q(),disabledFeedback:!0,children:(0,O.jsx)(x().sA,{id:"reportPageModal.reportButton.label",defaultMessage:"Report"})})]})]})})}function te(){const e=(0,r().O$)(d().e),t=(0,r().O$)(R().A);return e?t.open?o().A.isMobile?(0,O.jsx)(J,{modalState:t}):(0,O.jsx)(ee,{modalState:t}):null:(0,O.jsx)(Q,{})}},942292:(e,t,n)=>{n.r(t),n.d(t,{iconDefinition:()=>i,trashFillIcon:()=>s});n(296540);const i={viewBox:"0 0 20 20",fittedViewBox:"2.89 2.4 14.21 15.21",svg:(0,n(474848).jsx)("path",{d:"M6.386 3.925v1.464H3.523a.625.625 0 1 0 0 1.25h.897l.393 8.646A2.425 2.425 0 0 0 7.236 17.6h5.528a2.425 2.425 0 0 0 2.422-2.315l.393-8.646h.898a.625.625 0 1 0 0-1.25h-2.863V3.925c0-.842-.683-1.525-1.525-1.525H7.91c-.842 0-1.524.683-1.524 1.525M7.91 3.65h4.18c.15 0 .274.123.274.275v1.464H7.636V3.925c0-.152.123-.275.274-.275m.896 4.855v5.979a.55.55 0 1 1-1.1 0V8.505a.55.55 0 0 1 1.1 0m3.488 0v5.979a.55.55 0 0 1-1.1 0V8.505a.55.55 0 1 1 1.1 0"})},s=(0,n(340498).wt)("trashFill",i,"fill")},942906:(e,t,n)=>{n.d(t,{Lj:()=>r,W2:()=>l,xw:()=>a});var i=()=>n(416504),s=()=>n(547149),o=()=>n(680977);function a(e){const{environment:t,userSettingsStore:n}=e,s=n.getSettings(),o=null==s?void 0:s.time_zone,a=(0,i().P)();o!==a&&r({environment:t,userSettingsStore:n,timeZone:a})}function r(e){const{environment:t,userSettingsStore:n,timeZone:i}=e;s().createAndCommit({userAction:"checkUserTimeZoneAction.updateTimeZone",environment:t,canUndo:!0,perform:e=>{(0,o().m)({userSettingsStore:n,transaction:e,data:{time_zone:i}})},userId:n.id})}function l(e){const{environment:t,userSettingsStore:n,disableAutoSetTimezone:i}=e;s().createAndCommit({userAction:"checkUserTimeZoneAction.updateDisableAutoSetTimezone",environment:t,canUndo:!0,perform:e=>{(0,o().m)({userSettingsStore:n,transaction:e,data:{disable_auto_set_timezone:i}})},userId:n.id})}},946576:(e,t,n)=>{n.r(t),n.d(t,{default:()=>M});var i=n(296540),s=()=>n(484714),o=()=>n(401497),a=()=>n(631524),r=()=>n(160432),l=()=>n(75756),d=()=>n(69708),c=()=>n(100622),u=()=>n(284371),p=()=>n(204077),g=()=>n(991385),m=()=>n(799089),f=()=>n(455215),h=n(474848);function y(){const e=(0,s().v3)().currentUser.id;(0,i.useEffect)((()=>{if(!e)return;(0,g().S)(e);const t=window.setInterval((()=>{(0,g().S)(e)}),n(720665).nD);return()=>{window.clearInterval(t)}}),[e]);const t=(0,n(590526).K8)((()=>m().A.state.open),[]),o=x();return(0,h.jsx)(n(560729).A,{onDismiss:n(806080).lQ,render:()=>(0,h.jsx)("div",{style:o.modal,children:(0,h.jsxs)(n(249046).Ye,{flexDirection:"column",justifyContent:"center",alignItems:"center",children:[(0,h.jsx)("img",{style:o.image,src:n(148307).A.images.feedbackThankYouPng}),(0,h.jsx)("div",{style:o.title,children:(0,h.jsx)(d().sA,{id:"cookieModal.requestConsent.title",defaultMessage:"Set your cookie preferences"})}),(0,h.jsx)("div",{style:o.description,children:(0,l().Qq)(n(74464).i,"banner")}),(0,h.jsx)(v,{}),(0,h.jsx)(b,{}),(0,h.jsx)(S,{})]})}),isOpen:t})}function v(){const e=x(),t=(0,s().v3)();return(0,h.jsx)(r().A,{colorPalette:"blue",size:"lg",style:e.acceptAllButton,onClick:()=>{p().Vg(t,{necessary:!0,preference:!0,performance:!0,targeting:!0}),m().A.setState({open:!1}),p().wB()},children:(0,h.jsx)(d().sA,{...l().LS.acceptAllButtonLabel})})}function b(){const e=x(),t=(0,s().v3)();return(0,h.jsx)(a().p,{size:"lg",colorPalette:"gray",style:e.moreOptionsButton,onClick:()=>{p().Vg(t,{necessary:!0,preference:!1,performance:!1,targeting:!1}),m().A.setState({open:!1}),p().wB()},children:(0,h.jsx)(d().sA,{...l().LS.rejectAllButtonLabel})})}function S(){const e=x();return(0,h.jsx)(f().A,{hasDismissButton:!0,onDismiss:()=>{m().A.setState({open:!1})},renderOrigin:t=>(0,h.jsx)(a().p,{...t,size:"lg",colorPalette:"gray",style:e.moreOptionsButton,children:(0,h.jsx)(d().sA,{...l().LS.moreOptionsButtonLabel})})})}function x(){return(0,o().IS)((()=>({modal:{maxWidth:400,padding:24},image:{height:100},title:{marginTop:8,color:c().Tj.text.primary,fontWeight:u().Wy.semibold,fontSize:18},description:{color:c().Tj.text.secondary,textAlign:"center",fontSize:14,marginTop:8,marginBottom:18},acceptAllButton:{width:"100%",marginBottom:6},moreOptionsButton:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center"}})),[])}const M=i.memo(y)},953414:(e,t,n)=>{n.d(t,{e:()=>o});n(296540);var i=n(474848);const s={viewBox:"0 0 20 20",fittedViewBox:"4.12 2.37 11.75 15.25",svg:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{d:"M7.07 11.558a.625.625 0 0 1 .885 0l1.42 1.42V9.513a.625.625 0 1 1 1.25 0v3.467l1.42-1.42a.625.625 0 0 1 .884.883l-2.487 2.487a.625.625 0 0 1-.884 0l-2.487-2.487a.625.625 0 0 1 0-.884"}),(0,i.jsx)("path",{d:"M6.25 2.375A2.125 2.125 0 0 0 4.125 4.5v11c0 1.174.951 2.125 2.125 2.125h7.5a2.125 2.125 0 0 0 2.125-2.125V8.121c0-.563-.224-1.104-.622-1.502L11.63 2.997a2.13 2.13 0 0 0-1.502-.622zM5.375 4.5c0-.483.392-.875.875-.875H10V6.25a2 2 0 0 0 2 2h2.625v7.25a.875.875 0 0 1-.875.875h-7.5a.875.875 0 0 1-.875-.875zm8.741 2.75H12a1 1 0 0 1-1-1V4.134z"})]})},o=(0,n(340498).wt)("arrowPageDown",s,"default")},955450:(e,t,n)=>{n.d(t,{K:()=>d});var i=()=>n(135168),s=()=>n(59226),o=()=>n(484714),a=()=>n(590526),r=()=>n(106412),l=()=>n(583238);function d(e){const{collectionContextStore:t}=e,n=(0,o().v3)(),d=(0,r().Zp)(),c=(0,a().O$)(t.normalizedSchemaStore),u=(0,a().K8)((()=>t.collectionViewStore()),[t]),p=(0,a().K8)((()=>null==u?void 0:u.getType()),[u]),g=(0,s().X)("notion_calendar_db_integration_non_time_views"),m=(0,a().K8)((()=>t.isDashboardWidget()),[t]),f=(0,a().K8)((()=>{const e=t.collectionStore();return(0,l().JF)({environment:n,spaceStore:(0,i().f)(e),schema:c,collectionContextType:t.contextTypeFromStoreState,collectionViewType:p,enableForNonTimeBasedViews:g})}),[n,c,t,p,g]);return!m&&(Boolean(f)&&!(null!=d&&d.disablePageLinks))}},962036:(e,t,n)=>{n.d(t,{g:()=>u});n(296540);var i=()=>n(484714),s=()=>n(807449),o=()=>n(493552),a=()=>n(81068),r=()=>n(406533),l=()=>n(284371),d=()=>n(148024),c=n(474848);function u(e){const t=(0,i().v3)();return(0,c.jsx)(a().A,{focused:!1,href:e.href,external:!0,onClick:()=>d().FH(t,{from:e.analyticsFrom}),icon:(0,c.jsx)(s().I,{icon:r().questionMarkCircleIcon,colorVariant:"secondary"}),title:(0,c.jsx)(o().D,{colorPalette:"gray",colorVariant:"secondary",children:e.title}),style:l().RC})}},962763:(e,t,n)=>{n.d(t,{V:()=>o,h:()=>s});var i=()=>n(91669);function s(){i().z.setState({isOpen:!0})}function o(){i().z.setState({isOpen:!1})}},965142:(e,t,n)=>{n.d(t,{V:()=>s});class i extends(()=>n(757695))().Store{getInitialState(){return{isKeyboardShortcutsOpen:!1,toggleSource:void 0,openCount:0}}}const s=new i;(0,n(852832).exposeDebugValue)("keyboardShortcutsModalStore",s)},965731:(e,t,n)=>{n.r(t),n.d(t,{ConfigureViewsMainModuleAddViewButton:()=>h});n(898992),n(354520),n(581454);var i=n(296540),s=()=>n(484714),o=()=>n(590526),a=()=>n(30537),r=()=>n(81068),l=()=>n(663639),d=()=>n(736847),c=()=>n(898244),u=()=>n(69708),p=()=>n(339798),g=()=>n(937199),m=n(474848);const f=(0,u().YK)({relatedToDatabase:{defaultMessage:"Related to {database}",id:"pageLayout.configureViews.relatedToDatabase"},linkExistingDataSource:{defaultMessage:"Link existing data source",id:"pageLayout.configureViews.linkAnExistingDataSource"}}),h=i.memo((function(e){const{renderOrigin:t,onClose:r}=e,l=(0,s().v3)(),[d,u]=(0,i.useState)(!1),f=(0,i.useRef)(null),{layoutStore:h}=(0,g().LH)(),b=(0,i.useContext)(g().sf),S=null==b?void 0:b.moduleStateByIdStore,x=(0,o().K8)((()=>{var e;const t=h.getModuleByType("viewsMain");if(t)return null==S||null===(e=S.get(t.id))||void 0===e?void 0:e.collectionContextStore}),[h,S]),M=(0,i.useCallback)(((e,t)=>{x&&((0,n(180762).t)({environment:l,collectionContextStore:x,collectionViewId:e.id,isFullScreen:!1,isRootChild:!1,isInPeekRenderer:!1}),(0,n(447453).O)({collectionContextStore:x,collectionSettingsStore:x.settingsStore,closeOnEscape:!1}))}),[l,x]),A=(0,o().K8)((()=>{var e;const t=null===(e=h.getParentStore())||void 0===e?void 0:e.getModel();if((null==t?void 0:t.table)===n(519831).Vl)return t}),[h]),j=(0,o().K8)((()=>{const e=null==A?void 0:A.getNormalizedSchema();return Object.entries(e??{}).filter((([e,t])=>(0,n(534177).O9)(t)&&(0,c().nC)(t)&&t.property))}),[A]),w=(0,i.useCallback)((()=>{u(!1),null==r||r()}),[r]),I=(0,i.useCallback)((()=>{u(!0)}),[u]),k=(0,i.useMemo)((()=>n(757695).Store.createValue({open:!1,stack:[]},{name:"newViewsCreationMenuCollectionSettingsStore"})),[]),T=(0,i.useCallback)((()=>{const e=null==x?void 0:x.viewsModuleContextStore.getViewsModule();e&&p().R8({collectionSettingsStore:k,item:{type:"selectViewsModuleSource",module:e,onClose:r}})}),[null==x?void 0:x.viewsModuleContextStore,k,r]),C=(0,i.useCallback)((()=>{p().os({collectionSettingsStore:k})}),[k]),_=(0,i.useCallback)((()=>(0,m.jsx)(y,{setIsOpen:u,onClose:r,relations:j,setCurrentViewPointer:M,collectionModel:A,viewsMainModuleCollectionContextStore:x,openViewsCreationPopup:T})),[r,j,M,A,x,T]),P=(0,i.useCallback)((e=>t(e)),[t]);return x&&A?(0,m.jsxs)("div",{ref:f,children:[(0,m.jsx)(n(250910).A,{alignmentToOrigin:"center",popupType:a().n.Popup,onClose:w,onClick:I,open:d,render:_,renderOrigin:P,disablePopup:!0}),(0,m.jsx)(v,{buttonRef:f,viewsMainModuleCollectionContextStore:x,viewsCreationMenuCollectionSettingsStore:k,openViewsCreationPopup:T,closeViewsCreationPopup:C})]}):null})),y=i.memo((function(e){const{setIsOpen:t,onClose:o,relations:a,setCurrentViewPointer:p,collectionModel:h,viewsMainModuleCollectionContextStore:y,openViewsCreationPopup:v}=e,b=(0,s().v3)(),S=(0,n(401497).DP)(),{layoutStore:x,setModuleSelection:M}=(0,g().LH)(),A=(0,i.useMemo)((()=>{if(0!==a.length)return{key:0,items:[],render:e=>(0,m.jsx)(d().A,{...e,title:(0,m.jsx)(u().sA,{...f.relatedToDatabase,values:{database:null==h?void 0:h.getName()}}),children:a.map((([e,t])=>(0,m.jsx)(r().A,{title:null==t?void 0:t.name,icon:(0,m.jsx)(n(852424).zB,{size:n(340498).Ev.sm,theme:S,icon:null==t?void 0:t.icon,type:"relation"}),focused:!1,onClick:()=>{if(!y)return;const{viewsMainModule:i,collectionViewPointer:s}=(0,n(626318).ZX)({environment:b,layoutStore:x,relationPropertyId:(null==t?void 0:t.property)??e,targetCollectionPointer:(0,c().Nv)(t)??(null==h?void 0:h.pointer),viewName:null==t?void 0:t.name,viewIcon:null==t?void 0:t.icon});i&&M({type:"existing_module",moduleId:i.id,isDragging:!1}),s&&(n(908006).default.afterNextFlush((()=>{p(s,null==i?void 0:i.id),null==o||o()})),y&&(0,n(154017).b)({environment:b,view_type:"table",collectionContextStore:y,from:"viewsMain"}))}},e)))})}}),[y,h,b,x,o,a,p,M,S]),j=(0,i.useMemo)((()=>{const e=a.length>0;return{key:1,items:[],render:t=>(0,m.jsx)(d().A,{...t,topBorder:e,children:(0,m.jsx)(r().A,{title:(0,m.jsx)(u().sA,{...f.linkExistingDataSource}),icon:(0,m.jsx)(n(745266).h,{color:"regular",viewType:"table"}),onClick:v,focused:!1},"link_existing_database")})}}),[v,a.length]);return(0,m.jsx)(n(890492).A,{menuType:n(546926).gu.Popup,onClick:()=>t(!1),width:270,paddingBottom:2,children:(0,m.jsx)(l().A,{initialFocus:void 0,sections:[A,j].filter((e=>void 0!==e)),type:l().O.Vertical})})})),v=i.memo((function(e){var t;const{buttonRef:s,viewsMainModuleCollectionContextStore:r,viewsCreationMenuCollectionSettingsStore:l,closeViewsCreationPopup:d}=e,c=(0,o().K8)((()=>l.state.open),[l]),u=(0,i.useCallback)((()=>{d()}),[d]),p=(0,i.useCallback)((()=>(0,m.jsx)(n(523118)._,{context:n(527438).Bd.TopbarFilterPopup,collectionContextStore:r,collectionSettingsStore:l,hideDesktopHeader:!0})),[l,r]);return(0,m.jsx)(n(127833).zD,{open:c,trapFocus:!0,popupType:a().n.Popup,render:p,originRect:null===(t=s.current)||void 0===t?void 0:t.getBoundingClientRect(),alignmentToOrigin:"center",placementToOrigin:"bottom",enableOutsideClickDismiss:!0,originGap:4,onDismiss:u})}))},978578:(e,t,n)=>{n.d(t,{MS:()=>l,aD:()=>r,bu:()=>a,uO:()=>o,uZ:()=>d});var i=()=>n(911988),s=()=>n(100622);function o(e=!0,t=!1){return{flex:1,marginInlineStart:e?0:8,overflow:"hidden",marginInlineEnd:t?16:8,whiteSpace:"nowrap",height:"100%",minWidth:0,maxWidth:"100%",textOverflow:"ellipsis"}}const a=36;function r(){return{iconStyle:{height:26,width:26,fill:s().Tj.icon.primary},iconContainer:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",marginInlineEnd:14,color:s().Tj.icon.secondary,width:26},redesignedIconStyle:{height:24,width:24,fill:s().Tj.icon.primary},redesignedCircleIconContainer:{background:s().Tj.background.primary,color:s().Tj.icon.primary,display:"inline-flex",justifyContent:"center",alignItems:"center",borderRadius:18,width:a,height:a},redesignedCoverPhotoIconContainer:{background:s().Tj.background.primary,color:s().Tj.icon.primary,display:"inline-flex",justifyContent:"center",alignItems:"center",borderRadius:18,width:a,height:a,boxShadow:"0px 2px 4px -1px rgba(0, 0, 0, 0.06), 0px 14px 28px -6px rgba(0, 0, 0, 0.10)"}}}function l(e){const{WindowSizeStore:t}=e;return{marginTop:t.state.paddingTop,paddingInlineStart:t.getSafePaddingLeftPx(0),paddingInlineEnd:t.getSafePaddingRightPx(0)}}function d(e=i().s1,t=!0){const n=1/(window.devicePixelRatio||1);return{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",maxWidth:"100%",height:e,boxShadow:t?`0 ${n}px 0 ${s().Tj.border.secondaryTranslucent}`:"none",background:s().Tj.background.primary,transition:"box-shadow 300ms",WebkitUserSelect:"none",cursor:"pointer"}}},980357:(e,t,n)=>{n.d(t,{u:()=>s});n(296540);const i={viewBox:"0 0 16 16",fittedViewBox:"2.37 2.37 11.25 11.25",svg:(0,n(474848).jsx)("path",{d:"M4.25 2.375c-1.036 0-1.875.84-1.875 1.875v7.5c0 1.036.84 1.875 1.875 1.875h7.5c1.036 0 1.875-.84 1.875-1.875v-7.5c0-1.036-.84-1.875-1.875-1.875zM3.625 4.25c0-.345.28-.625.625-.625h7.5c.345 0 .625.28.625.625v7.5c0 .345-.28.625-.625.625h-7.5a.625.625 0 0 1-.625-.625z"})},s=(0,n(340498).wt)("squareSmall",i,"small")},980427:(e,t,n)=>{n.d(t,{V:()=>s});var i=()=>n(564884);function s(e,t){(0,i().u)({environment:e,event:{eventName:"open_import_contacts_dropdown",eventProperties:{source:t.source}}})}},989184:(e,t,n)=>{n.d(t,{Z:()=>s});n(296540);const i={viewBox:"0 0 16 16",fittedViewBox:"2.85 1.57 9.98 12.06",directional:!0,svg:(0,n(474848).jsx)("path",{d:"M7.442 1.758a.625.625 0 0 0-.884 0l-3.52 3.52a.625.625 0 1 0 .884.884l2.453-2.453V11.8c0 1.008.817 1.825 1.825 1.825h4a.625.625 0 1 0 0-1.25h-4a.575.575 0 0 1-.575-.575V3.709l2.453 2.453a.625.625 0 0 0 .884-.884z"})},s=(0,n(340498).wt)("arrowTurnLeftUpSmall",i,"small")},992757:(e,t,n)=>{n.r(t),n.d(t,{default:()=>R});var i=n(296540),s=()=>n(404694),o=()=>n(312788),a=()=>n(484714),r=()=>n(590526),l=()=>n(401497),d=()=>n(127833),c=()=>n(420802),u=()=>n(695115),p=()=>n(552712),g=()=>n(631524),m=()=>n(160432),f=()=>n(302501),h=()=>n(591779),y=()=>n(340498),v=n(474848);const b={viewBox:"0 0 16 16",fittedViewBox:"1.07 2.82 13.83 10.36",svg:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("path",{d:"M8.18 5.25a.5.5 0 0 1 .5.5v3.623l1.127-1.127a.5.5 0 0 1 .707.707l-2 2a.5.5 0 0 1-.63.065l-.077-.065-2-2a.5.5 0 0 1 .707-.707L7.68 9.412V5.75a.5.5 0 0 1 .5-.5"}),(0,v.jsx)("path",{d:"M8.35 2.825a5.173 5.173 0 0 1 5.172 5.051 2.856 2.856 0 0 1-1.477 5.299l-.032-.001H4.018a.8.8 0 0 1-.189-.025 3.134 3.134 0 0 1-.566-6.098A5.176 5.176 0 0 1 8.35 2.826m3.85 10.318.005-.001.012-.005zm-.379-1.19-.039.012.031-.01.034-.01zm-3.47-7.878a3.926 3.926 0 0 0-3.908 3.543l-.047.484-.478.074a1.886 1.886 0 0 0 .1 3.739l.086.009h7.88l.018-.001h.05a1.605 1.605 0 0 0 1.59-1.44l.008-.164c0-.67-.41-1.245-.995-1.486l-.41-.169.024-.443q.006-.115.006-.221c0-2.1-1.649-3.814-3.722-3.92z"})]})},S=(0,y().wt)("cloudArrowDownSmall",b,"small");var x=()=>n(995847),M=()=>n(651784),A=()=>n(69708),j=()=>n(284371),w=()=>n(579631),I=()=>n(778450),k=()=>n(597755),T=()=>n(112799),C=()=>n(346),_=()=>n(567121),P=()=>n(549721),B=()=>n(927080);function R(){const{navigate:e}=(0,i.useContext)(o().E),t=(0,a().v3)(),n=(0,A().tz)(),[b,R]=(0,i.useState)(!0),{isDesktopBrowser:D,os:L}=(0,a().Y0)(),E=(0,r().K8)((()=>t.RouterStore.state.route.name in M().b1),[t]),O=(0,s().V)(),N=(0,r().K8)((()=>O.getCalloutVisibility("desktop_preference_popup").canShow),[O]),F=t.currentUser.isLoggedIn(),U=(0,r().O$)(B().A),[z,K]=(0,i.useState)(!1),V=(0,r().K8)((()=>B().A.canPersistToLocalStorage()),[]),q=!z&&F&&void 0===U&&D&&("mac"===L||"windows"===L)&&E&&V&&N,[W,G]=(0,i.useState)(!1),H=q&&W,Y=(0,i.useRef)(!1);(0,i.useEffect)((()=>{q&&!Y.current&&((0,I().e)(t).then((e=>{G(e)})),Y.current=!0)}),[q,G,t,L]);const $=(0,h().ZC)(H);(0,i.useEffect)((()=>{H&&!$&&(w()._g(t),O.updateCalloutStatus({calloutId:"desktop_preference_popup",visible:!0,validateCanShow:!0}))}),[H,$,t,O]);const Q=(0,C().n_)(),Z=(0,T().E)(),X=(0,l().IS)((()=>({origin:{position:"fixed",insetInlineStart:"50%",top:"100%"},container:{bottom:20,padding:"8px 12px 12px",minWidth:300},header:{display:"flex",justifyContent:"space-between",alignItems:"center"},headerText:{fontSize:14,fontWeight:j().Wy.medium},appDownloadButton:{marginInlineStart:-5},actions:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:6},alwaysOpenLinks:{display:"flex",alignItems:"center"},alwaysOpenLinksLabel:{marginInlineStart:6},alwaysOpenLinksButton:{paddingInlineStart:12,paddingInlineEnd:12,height:34,marginInlineStart:12}})),[]);return(0,v.jsx)(d().zD,{popupType:d().nl.Popup,placementToOrigin:"bottom",alignmentToOrigin:"center",origin:(0,v.jsx)("div",{style:X.origin}),originGap:Q?-_().ls/2:0,disableMouseCapture:!0,open:H,style:X.container,render:()=>(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)("div",{style:X.header,children:[(0,v.jsx)(f().A,{style:X.headerText,children:(0,v.jsx)(A().sA,{id:"openInDesktopAppPopup.header",defaultMessage:"Open in Notion’s desktop app?"})}),(0,v.jsx)(u().A,{ariaLabel:n.formatMessage({id:"openInDesktopAppPopup.closeButton",defaultMessage:"Dismiss"}),icon:x().xMarkSmallIcon,iconStyle:{width:y().Ev.sm,height:y().Ev.sm},onClick:()=>{B().A.setState("never"),K(!0),w().e1(t)}})]}),(0,v.jsx)(p().N,{external:!0,onClick:()=>{Z.current&&(e({environment:t,url:Z.current,openInNew:"tab"}),w().co(t))},children:(0,v.jsx)(g().p,{colorPalette:"gray",size:"sm",style:X.appDownloadButton,iconLeading:S,children:(0,v.jsx)("span",{children:(0,v.jsx)(A().sA,{id:"openInDesktopAppPopup.appDownloadButton",defaultMessage:"Don’t have the app? Download"})})})}),(0,v.jsxs)("div",{style:X.actions,children:[(0,v.jsxs)("div",{style:X.alwaysOpenLinks,children:[(0,v.jsx)(c().S,{checked:b,size:16,onClick:()=>{R(!b)}}),(0,v.jsx)(f().A,{isInline:!0,style:X.alwaysOpenLinksLabel,children:(0,v.jsx)(A().sA,{id:"openInDesktopAppPopup.alwaysOpenLinksLabel",defaultMessage:"Always open in app",values:{strongtext:e=>(0,v.jsx)("strong",{children:e})}})})]}),(0,v.jsx)(m().A,{colorPalette:"blue",style:X.alwaysOpenLinksButton,onClick:()=>{B().A.setState(b?"always":"never"),K(!0),(0,P().e)({url:(0,k().PT)(window.location.href),environment:t}),w().SS(t,{always_open_in_app:b})},children:(0,v.jsx)(A().sA,{id:"openInDesktopAppPopup.openInAppButton",defaultMessage:"Open in app",values:{strongtext:e=>(0,v.jsx)("strong",{children:e})}})})]})]}),onClosed:()=>{O.updateCalloutStatus({calloutId:"desktop_preference_popup",visible:!1})}})}}}]);