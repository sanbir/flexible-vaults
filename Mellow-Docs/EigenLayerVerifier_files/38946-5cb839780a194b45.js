"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[38946],{44750:(e,t,o)=>{o.d(t,{Z:()=>C,p:()=>P});o(16280),o(581454),o(296540);var n=()=>o(564884),i=()=>o(484714),r=()=>o(590526),a=()=>o(401497),l=()=>o(675133),s=()=>o(663077),c=()=>o(898244),p=()=>o(100622),d=()=>o(534177),u=()=>o(339798),m=()=>o(736982),y=()=>o(403905),g=()=>o(547149),f=()=>o(239924),S=()=>o(101926),h=()=>o(513349),b=()=>o(922952),v=()=>o(913454),w=()=>o(204067),T=()=>o(272752),x=()=>o(362941),I=()=>o(960127),_=()=>o(342288),k=()=>o(902842),A=o(474848);function C({environment:e,template:t,isInSuggestedSection:o,collectionContextStore:n}){return{key:t.templateId,action:()=>{if(o)P({environment:e,template:t,collectionContextStore:n,suggestedFeatureAnalytics:void 0});else{const{collectionStore:o,collectionViewStore:i,collectionSettingsStore:r}=(0,T().i)(n);(0,h().UD)({template:t,environment:e,collectionStore:o,collectionViewStore:i,collectionSettingsStore:r,collectionContextStore:n})}},render:e=>(0,A.jsx)(M,{buttonMenuItemProps:e,template:t,isInSuggestedSection:o})}}function P({environment:e,collectionContextStore:t,template:o,suggestedFeatureAnalytics:i}){const r=t.collectionStore();if(!r)throw new Error("collectionStore not found");const a=r.getWorkflowTemplateId();i&&(0,n().u)({environment:e,event:{eventName:"suggested_feature_template_clicked",eventProperties:{origin:i.origin,selected_index:i.selectedIndex,template_ids_shown:i.shownTemplateIds,template_id_clicked:o.templateId,collection_template_id:a}}});const l=t.settingsStore;if((0,I().isWorkflowTemplateWithConfirmStep)(o))u().a2({collectionSettingsStore:l,item:{type:"confirmAddTemplate",template:o}});else if((0,s().Sz)(o)){const{relatedCollectionTemplateId:t}=o;!function({environment:e,template:t,collectionStore:o,relatedCollectionTemplateId:n}){var i;const r=null===(i=o.getParentBlockStore())||void 0===i?void 0:i.getParentStore();if(!r)throw new Error(`parentStore not found for ${o.id}`);if(!(0,b().u)(r))throw new Error(`Incorrect parent store: ${r.table} ${r.id}`);const a=v().globalWorkflowTemplates.fromIdOfType({templateId:n,type:"collection"});(0,f().openSelectedTemplateOnboardingModalForInAppFlows)({environment:e,template:a,origin:"suggested_feature_template",parentStore:r,navigateToOnFinish:"skip",relationInfos:[{type:"source",collectionStore:o,relationPropertyTemplate:t}],aiPrompt:void 0})}({environment:e,template:o,collectionStore:r,relatedCollectionTemplateId:t})}else g().createAndCommit({userAction:"FeatureTemplateMenuItem.addFeatureTemplateToTarget",environment:e,canUndo:!0,perform:s=>{S().ai({environment:e,transaction:s,collectionStore:r,template:o,logger:new(v().WorkflowTemplateLogger),origin:"suggested_feature"}),i&&(0,n().u)({environment:e,event:{eventName:"suggested_feature_template_added",eventProperties:{origin:i.origin,template_id_added:o.templateId,collection_template_id:a}}});const c=t.collectionViewStore();c&&h().UD({template:o,environment:e,collectionStore:r,collectionViewStore:c,collectionSettingsStore:l,collectionContextStore:t})}})}function M({buttonMenuItemProps:e,template:t,isInSuggestedSection:o}){const n=(0,a().IS)((()=>({iconContainer:{height:28,width:28,display:"flex",alignItems:"center",justifyContent:"center"},icon:{fill:p().Tj.icon.primary}})),[]),{collectionStore:s}=(0,T().V)(),u=(0,i().v3)(),g=(0,r().K8)((()=>(0,w().NU)({environment:u,collectionStore:s,templateId:t.templateId})),[u,s,t.templateId]),f=(0,r().K8)((()=>function({template:e,collectionStore:t}){const{type:o}=e;switch(o){case"property":const{value:n}=e;if((0,c().DQ)(n)){const o=function({templateId:e,propertyTemplateSchema:t,collectionStore:o}){const n=(0,w().S1)({collectionStore:o,templateId:e,instancePointerType:"property"});if(!n)return t.options??[];const i=o.getSchema()[n.id];if(!i||!(0,c().DQ)(i))return[];return i.options??[]}({templateId:e.templateId,propertyTemplateSchema:n,collectionStore:t}).map((e=>e.value));return(0,v().getWorkflowTemplateItemsCaption)(o)}return;case"collection_view":return`${l().A.formatMessage(y().X[e.value.type])} view`;case"compound":return;default:(0,d().HB)(o)}}({template:t,collectionStore:s})),[t,s]),S=(0,v().getWorkflowTemplateName)(t);return o?(0,A.jsx)(m().I,{buttonMenuItemProps:e,title:S,icon:(0,A.jsx)(k().n,{template:t}),right:(0,A.jsx)(_().z,{isAdded:g})}):(0,A.jsx)(m().I,{buttonMenuItemProps:e,title:S,caption:f,icon:(0,A.jsx)("div",{style:n.iconContainer,children:(0,A.jsx)(k().z,{template:t,iconStyle:n.icon})}),right:(0,A.jsx)(x()._,{})})}},200277:(e,t,o)=>{o.d(t,{$:()=>u,N:()=>p});o(944114),o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(354520),o(430670),o(581454);var n=()=>o(536095),i=()=>o(663077),r=()=>o(496603),a=()=>o(534177),l=()=>o(299545),s=()=>o(913454),c=()=>o(204067);function p(e,t){const o=(0,c().Xg)(e,t),n=new Set(function(e){const t=e.getParentBlockStore();if(null==t||!t.isDefined())return[];return(null==t?void 0:t.getCollectionViewStores().map((e=>e.getName())).filter(a().O9))??[]}(t));return function(e){const t=new Set(e.map((e=>e.templateId))),o=[];for(const n of e)o.push(...d(n).filter((e=>!t.has(e))).map((e=>s().globalWorkflowTemplates.fromId(e))).filter(i().bz).filter((e=>!(0,i().Sz)(e))));return o}(o).filter((e=>"collection_view"!==e.type||!n.has(e.value.name??"")))}function d(e){return"compound"===e.type||"collection"===e.type?e.value.templateItems.filter((e=>"optionalDefaultOn"===e.optionality||"optionalDefaultOff"===e.optionality)).map((e=>e.pointer)):[]}function u({persona:e,parentStore:t}){const o=e?(0,n().Qf)({persona:e}):[],i=s().globalWorkflowTemplates.allOfType({templateIds:o??[],type:"collection"}),a=r().hS(function({collectionTemplates:e,parentStore:t}){if(!t)return e;if((0,l().Yu)(t))return e;const o=(0,l().$R)(t)?t.getTeamPageStores():t.getContentStores(),n=new Set((0,r().oE)(o.flatMap((e=>e.getOwnedAndLinkedCollectionStores().map((e=>e.getWorkflowTemplateId()))??[])))),i=[],a=[];for(const r of e)n.has(r.templateId)?i.push(r):a.push(r);return[...a,...i]}({collectionTemplates:[...i,...s().globalWorkflowTemplates.allOfType({templateIds:(0,n().dj)(),type:"collection"})],parentStore:t}),(e=>e.templateId));return a}},272752:(e,t,o)=>{o.d(t,{V:()=>a,i:()=>l});var n=()=>o(590526),i=()=>o(220719),r=()=>o(908201);function a(){const e=(0,r().ET)(),{collectionStore:t,collectionViewStore:o,collectionSettingsStore:i}=(0,n().K8)((()=>l(e)),[e]);return{collectionStore:t,collectionViewStore:o,collectionSettingsStore:i,collectionContextStore:e}}function l(e){return{collectionStore:(0,i().o9)(e.collectionStore(),"collectionStore not found"),collectionViewStore:(0,i().o9)(e.collectionViewStore(),"collectionViewStore not found"),collectionSettingsStore:e.settingsStore}}},342288:(e,t,o)=>{o.d(t,{z:()=>c});o(296540);var n=()=>o(401497),i=()=>o(807449),r=()=>o(349679),a=()=>o(863330),l=()=>o(100622),s=o(474848);function c({isAdded:e}){const t=(0,n().IS)((()=>({circle:{height:24,width:24,borderRadius:50,display:"flex",alignItems:"center",justifyContent:"center",background:e?l().Tj.blue.background.secondary:l().Tj.gray.background.secondaryTranslucent}})),[e]);return(0,s.jsx)("div",{style:t.circle,children:e?(0,s.jsx)(i().I,{icon:r().checkmarkSmallIcon,size:"sm",colorPalette:"blue",colorVariant:"accentPrimary"}):(0,s.jsx)(i().I,{icon:a().plusSmallIcon,size:"sm",colorVariant:"secondary"})})}},362941:(e,t,o)=>{o.d(t,{_:()=>l});o(296540);var n=()=>o(401497),i=()=>o(807449),r=()=>o(158115),a=o(474848);function l(){const e=(0,n().IS)((()=>({icon:{marginInlineStart:6}})),[]);return(0,a.jsx)("span",{style:e.icon,children:(0,a.jsx)(i().I,{icon:r().arrowChevronSingleRightFillSmallIcon,size:"xs",colorVariant:"tertiary"})})}},513349:(e,t,o)=>{o.d(t,{Sj:()=>s,UD:()=>l});o(16280);var n=()=>o(339798),i=()=>o(180762),r=()=>o(204067);const a={property:function({template:e,collectionStore:t,collectionViewStore:i,collectionSettingsStore:a}){const l=(0,r().S1)({collectionStore:t,templateId:e.templateId,instancePointerType:"property"});if(!l)throw new Error(`No property instance found for property template ${e.templateId}`);const s=i.getType();n().a2({collectionSettingsStore:a,item:{type:"property",property:l.id,formatKey:s?o(651124).u9(s):void 0}})},collection_view:function({template:e,environment:t,collectionStore:o,collectionContextStore:n}){const i=(0,r().S1)({collectionStore:o,templateId:e.templateId,instancePointerType:"collection_view"});if(!i)throw new Error(`No collection view instance found for property template ${e.templateId}`);s({environment:t,collectionContextStore:n,collectionViewId:i.id})},compound:function(e){}};function l(e){a[e.template.type](e)}function s({environment:e,collectionContextStore:t,collectionViewId:o}){var r;(null===(r=t.collectionViewStore())||void 0===r?void 0:r.id)!==o&&(0,i().t)({environment:e,collectionContextStore:t,collectionViewId:o,isFullScreen:t.isFullScreenStore.state,isRootChild:t.isRootChildStore.state,isInPeekRenderer:t.isInPeekRendererStore.state}),n().a2({collectionSettingsStore:t.settingsStore,item:{type:"main"}})}},736982:(e,t,o)=>{o.d(t,{I:()=>d,h:()=>p});o(296540);var n=()=>o(726637),i=()=>o(401497),r=()=>o(81068),a=()=>o(100622),l=()=>o(284371),s=()=>o(115512),c=o(474848);function p(){return{padding:n().A.isMobile?"12px 2px":"6px",alignItems:"center"}}function d({buttonMenuItemProps:e,title:t,caption:o,icon:n,onClick:d,right:u,isDisabled:m}){const y=(0,i().IS)((()=>({menuItem:{display:"flex",...p(),opacity:m?.4:void 0},title:{fontSize:s().vQ,...l().RC},caption:{fontSize:s().Kw,overflow:"hidden",color:a().Tj.text.secondary,whiteSpace:"nowrap",textOverflow:"ellipsis"}})),[m]),g={};return d&&(g.onClick=d),(0,c.jsx)(r().A,{...e,style:y.menuItem,disabled:m,title:(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{style:y.title,children:t}),o?(0,c.jsx)("div",{style:y.caption,children:o}):void 0]}),icon:n,right:u,...g})}},878665:(e,t,o)=>{o.d(t,{d:()=>r});var n=o(296540),i=o(474848);const r=n.memo((function(e){const{caption:t,description:r,hideTooltipBeforeImageLoaded:a,imageContainerStyle:l,placement:s,render:c,showImage:p,tooltipDelayThreshold:d,tooltipImage:u,tooltipImageScale:m=1}=e,[y,g]=(0,n.useState)(!1),[f,S]=(0,n.useState)({width:0,height:0});(0,n.useEffect)((()=>{if(!u)return;const e=new Image;e.src=u,e.onload=()=>{S({width:"number"==typeof m?e.width*m:m.widthPx,height:"number"==typeof m?e.width*m:m.heightPx}),g(!0)}}),[u,m]);const h=(0,o(401497).IS)((()=>({tooltip:{whiteSpace:"break-spaces",width:"max-content",maxWidth:300},description:{fontWeight:"normal",color:o(100622).oZ.uiLightGray}})),[]),b=(0,n.useCallback)((()=>{const e=(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{children:t}),r?(0,i.jsx)("div",{style:h.description,children:r}):void 0]});return u&&y&&p?(0,i.jsx)(o(103448).A,{caption:e,imageURL:u,imageWidth:f.width,imageHeight:f.height,imageContainerStyle:l}):e}),[t,r,l,f.height,f.width,y,p,h.description,u]);return(0,i.jsx)(o(26697).m,{placement:s??"left",disableTooltip:void 0===t||!y&&a,delayThreshold:d,style:h.tooltip,render:c,renderTooltip:b})}))},938946:(e,t,o)=>{o.d(t,{il:()=>Ke,DZ:()=>ct,xv:()=>dt,Re:()=>Re,bj:()=>Ye,D1:()=>qe,b9:()=>$e,f1:()=>Xe,p1:()=>Ge,bi:()=>Le,Dm:()=>He,D9:()=>Fe,ds:()=>ze});o(944114),o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(823215),o(354520),o(672577),o(430670),o(803949),o(581454),o(737550);var n=o(296540),i=()=>o(564884),r=()=>o(664594),a=()=>o(907258),l=()=>o(135168),s=()=>o(265618),c=()=>o(59226),p=()=>o(726637),d=()=>o(383036),u=()=>o(484714),m=()=>o(590526),y=()=>o(401497),g=()=>o(929219),f=()=>o(365917),S=()=>o(874832),h=()=>o(118307),b=()=>o(807449),v=()=>o(695115),w=()=>o(26697),T=()=>o(81068),x=()=>o(736847),I=()=>o(433337),_=()=>o(489242),k=()=>o(536095),A=()=>o(663077),C=()=>o(716016),P=()=>o(898244),M=()=>o(713998),j=()=>o(455348),N=()=>o(852424),D=()=>o(617871),O=()=>o(412237),E=()=>o(344417),K=()=>o(721479),W=()=>o(340498),z=()=>o(706021),F=()=>o(470020),R=()=>o(69708),B=()=>o(100622),U=()=>o(496603),V=()=>o(534177),G=()=>o(284371),L=()=>o(267271),H=()=>o(769864),q=()=>o(896628),$=()=>o(67103),Y=()=>o(774952),X=()=>o(413955),Q=()=>o(374562),J=()=>o(235059);function Z(e){return"variants"in e&&(0,_().ec)(e.collectionUri)}var ee=()=>o(652079),te=()=>o(377093),oe=()=>o(908201),ne=()=>o(680288),ie=()=>o(551882),re=()=>o(13898),ae=()=>o(419357),le=()=>o(933117),se=()=>o(29554),ce=()=>o(68465),pe=()=>o(242422),de=()=>o(521488),ue=()=>o(148307),me=()=>o(252833);const ye=[D().ob,D().Hd,D().e1,D().io,D().k0,D().zG];var ge=()=>o(310001),fe=()=>o(470928),Se=()=>o(817126),he=()=>o(255824),be=()=>o(619206),ve=()=>o(991249),we=()=>o(112698),Te=()=>o(528093),xe=()=>o(408543),Ie=()=>o(704658),_e=()=>o(547149),ke=()=>o(44750),Ae=()=>o(902842),Ce=()=>o(913454),Pe=()=>o(204067),Me=()=>o(236248),je=()=>o(200277);var Ne=()=>o(339798),De=()=>o(334684),Oe=()=>o(878665),Ee=o(474848);const Ke=4,We=4;function ze({collectionContextStore:e,propertySchema:t,disableSuggestions:o,hasAiEnabled:r,showAiSuggestions:a,getFilteredSuggestedItemKeys:l,onAccept:s,iconStyle:c,buttonStyle:p,onAfterAccept:d,nameInput:f}){const S=(0,u().v3)(),h=(0,y().DP)(),b=(0,R().tz)(),v=(0,y().IS)((()=>({aiIconStyle:{fill:B().Tj.purple.icon.accentPrimary},defaultIconStyle:{fill:B().Tj.icon.primary}})),[]),w=(0,m().K8)((()=>{var t;const o=null===(t=e.collectionStore())||void 0===t||null===(t=t.getFormat())||void 0===t?void 0:t.app_config_uri;return o?(0,J().l)((0,X().appConfigs)(),o):void 0}),[e]);(0,Me().b)(e);const T=function(e){const t=(0,u().v3)();return(0,Me().b)(e),(0,m().K8)((()=>{const o=e.collectionStore();return o?(0,je().N)(t,o):[]}),[t,e])}(e),x=function({collectionContextStore:e,showAiSuggestions:t}){const o=(0,u().v3)(),i=(0,m().K8)((()=>{var t;const o=null===(t=e.collectionStore())||void 0===t?void 0:t.getSchema();return o?U().oE(Object.values(o).map((e=>null==e?void 0:e.name.toLocaleLowerCase()))):[]}),[e]),r=(0,n.useCallback)((e=>e.filter((e=>!i.includes(e.name.toLocaleLowerCase())))),[i]),a=(0,m().K8)((()=>{const t=e.collectionStore(),o=null==t?void 0:t.getFormat();if(null!=o&&o.ai_suggested_properties&&(null==o?void 0:o.ai_suggested_properties.length)>0)return r(null==o?void 0:o.ai_suggested_properties)}),[e,r]),[l,s]=(0,n.useState)(a||"loading"),c=(0,n.useRef)(!1);return(0,n.useEffect)((()=>{if(c.current||a)return;(async()=>{const t=e.collectionStore(),n=null==t?void 0:t.getSpaceId(),a=null==t?void 0:t.id,l=[];if(n&&a&&t.getName()){const e=await H().callCellCompatibleApi({eventName:"getAiSuggestedProperties",environment:o,data:{spaceId:null==t?void 0:t.getSpaceId(),collectionId:null==t?void 0:t.id,schema:U().oE(Object.values(t.getSchema())),collectionName:(0,se().r4)(t.getName(),t),numSuggestion:We},cellNavigation:{spaceId:n}});if("success"===e.type){const n=e.data.properties.filter((e=>!i.includes(e.name.toLocaleLowerCase())));l.push(...n),_e().createAndCommit({environment:o,perform:e=>{q().zA({stores:[t],update:{ai_suggested_properties:n},transaction:e})},canUndo:!0,userAction:"propertyType.generateAiSuggestion"})}}const c=r(l);s(c)})(),c.current=!0}),[e,o,l,t,a,i,r]),l}({collectionContextStore:e,showAiSuggestions:a}),k=(0,m().K8)((()=>(0,ce().QV)(e.collectionStore())),[e]),A=!(0,m().O$)(g().e),C=(0,m().K8)((()=>{if(t||o||A)return[];const n=T.filter((e=>(0,Ce().shouldShowInSuggestedProperties)(e))),i=e.collectionStore(),l=null==i?void 0:i.getSchema(),s=null==i?void 0:i.getFormat();if(w){const e=function({appConfig:e,collectionFormat:t,collectionSchema:o,hasAiEnabled:n}){if(!t||!o)return[];const i=e=>{const i=t.app_config_uri,r=j().u9.derivePropertyUris(o??{},t.app_uri_map);if(e.collectionUri!==i)return!1;let a=!0;e.uri===(0,Q().Jb)().uri&&r.has(I().yx.GithubPrsRelation)&&(a=!1);return e.dependencies.some((e=>"property"===e.type&&e.collectionUri===i&&(0,_().LE)(e.uri)&&!r.has(e.uri)))&&(!e.isAi||n)&&a},r={};e.allFeatures.forEach((t=>{Z(t)&&t.variants.every((t=>Boolean(e.allFeatures.find((e=>e.uri===t&&(0,ee().l)(e)&&i(e))))))&&(r[t.uri]=t.variants)}));const a=Object.values(r).flat(),l=e.allFeatures.filter((e=>(0,ee().l)(e)&&!a.find((t=>t===e.uri))?i(e):!!Z(e)&&Boolean(r[e.uri])));return l.sort(((e,t)=>Z(e)?-1:Z(t)?1:e.dependencies.length-t.dependencies.length))}({appConfig:w,collectionFormat:s,collectionSchema:l,hasAiEnabled:r});return(k?e.filter((e=>"notion://tasks/task_summary_feature"!==e.uri)):e).map((e=>({type:"typed",appConfigFeature:e})))}if(n.length>0)return n.map((e=>({type:"workflow",template:e})));if(a)return"loading"===x?"loading":x.map((e=>({type:"ai_suggestion",propertySchema:e})));if(!k){return function(e,t){const o=t?function(e){const t=new Set;for(const n in e){const i=e[n];if(i&&"ai_inference"in i){var o;const e=null===(o=i.ai_inference)||void 0===o?void 0:o.type;if(e)switch(e){case"custom":t.add("ai_custom_prompt");break;case"summarize":t.add("ai_summary");break;case"extract":t.add("ai_extract");break;case"translate":t.add("ai_translate")}}else i&&"select_ai_inference"in i&&t.add("ai_keywords")}return t}(t):new Set;return e.map((e=>({type:"derived_ai_property",propertyType:e}))).filter((e=>!st.includes(e.propertyType)||!o.has(e.propertyType)))}((0,ne().lO)({environment:S,collectionContextStore:e}),l)}return[]}),[t,o,T,w,a,k,r,x,S,e,A],{useDeepEqual:!0}),P=(0,n.useMemo)((()=>{if("loading"===C)return[];const e=C.filter((e=>"workflow"===e.type)).map((e=>Je(e.template.templateId)));return l(e).map(Ze)}),[C,l]);!function({collectionContextStore:e,shownTemplateIds:t,origin:o}){const r=(0,u().v3)(),a=(0,m().K8)((()=>{var t;return null===(t=e.collectionStore())||void 0===t?void 0:t.getWorkflowTemplateId()}),[e]),l=(0,n.useRef)(!1);(0,n.useEffect)((()=>{!l.current&&t.length>0&&((0,i().u)({environment:r,event:{eventName:"suggested_feature_templates_shown",eventProperties:{origin:o,collection_template_id:a,template_ids_shown:t}}}),l.current=!0)}))}({collectionContextStore:e,origin:"suggested_properties",shownTemplateIds:P});return(0,m().K8)((()=>"loading"===C?"loading":Object.fromEntries(C.map(((t,o)=>{switch(t.type){case"ai_suggestion":return[t.propertySchema.name.toLowerCase(),nt({collectionContextStore:e,propertyType:t.propertySchema.type,propertyName:t.propertySchema.name,disablePropertyTooltip:!0,intl:b,onAccept:s,isSuggestedProperty:!0,iconStyle:c,isOffline:A,buttonStyle:p})];case"typed":return[t.appConfigFeature.name.toLowerCase(),ot({appConfig:w,suggestedProperty:t.appConfigFeature,isDisabled:!1,environment:S,collectionContextStore:e,theme:h,iconStyle:c??v.defaultIconStyle,buttonStyle:p,onAfterAccept:d,nameInput:f})];case"workflow":return[(0,Ce().getWorkflowTemplateName)(t.template).toLowerCase(),tt({environment:S,template:t.template,collectionContextStore:e,iconStyle:c??v.defaultIconStyle,suggestedFeatureAnalytics:{origin:"suggested_properties",selectedIndex:P.indexOf(t.template.templateId),shownTemplateIds:P},buttonStyle:p,onAccept:d})];case"derived_ai_property":return[ne().dC[t.propertyType].toLowerCase(),nt({collectionContextStore:e,propertyType:t.propertyType,propertyName:ne().dC[t.propertyType],disablePropertyTooltip:!0,intl:b,iconStyle:v.aiIconStyle,onAccept:s,isSuggestedProperty:!0,isOffline:A,buttonStyle:p})]}})))),[w,e,S,b,C,h,s,P,c,v,A,p,d,f])}function Fe(e){const{filteredSuggestedPropertyItems:t,showAiSuggestions:o,hasSearchInput:i,disableSuggestions:r,isLoading:a,title:l,from:s,isListLayout:c=!1}=e,p=(0,y().IS)((()=>({loadingTitleStyle:{marginTop:8,marginBottom:0,paddingInlineStart:"tableHeader"===s?14:10},titleContainer:{display:"flex",alignItems:"center"},aiIcon:{display:"inline-flex",marginInlineEnd:6},desktopTitleStyleTableHeader:{fontSize:12,fontWeight:G().Wy.medium,color:B().Tj.text.secondary,marginInlineStart:3},desktopStyleTableHeader:c?{padding:"0 4px 6px",gap:2,display:"flex",flexDirection:"column"}:{padding:8,gap:2,display:"flex",flexDirection:"column",margin:0},shimmerContainer:{display:"flex",alignItems:"center",paddingInlineStart:12,paddingInlineEnd:8,gap:8,minHeight:"tableHeader"===s?35:27,maxWidth:192,minWidth:192},shimmerIcon:{width:16,height:16,borderRadius:3,flexShrink:0},shimmerText:{height:12,borderRadius:3}})),[s,c]),d=(0,n.useMemo)((()=>({key:"suggested",render:e=>(0,Ee.jsx)(x().A,{...e,title:(0,Ee.jsxs)("span",{style:p.titleContainer,children:[(0,Ee.jsx)(b().I,{icon:O().aiFaceSmallIcon,size:"sm",colorVariant:"secondary",style:p.aiIcon}),(0,Ee.jsx)(Y().c,{styleKey:"captionMedium"})]}),disableMobileBorders:!0,desktopTitleStyle:p.loadingTitleStyle,mobileTitleStyle:p.loadingTitleStyle}),items:Array.from({length:Ke},((e,t)=>{const o=["35%","42%","28%","48%"],n=o[t%o.length];return{key:`property-shimmer-${t}`,action:()=>{},render:()=>(0,Ee.jsxs)("div",{style:p.shimmerContainer,children:[(0,Ee.jsx)(S().P,{style:p.shimmerIcon}),(0,Ee.jsx)(S().P,{style:{...p.shimmerText,width:n}})]})}}))})),[p.titleContainer,p.aiIcon,p.loadingTitleStyle,p.shimmerContainer,p.shimmerIcon,p.shimmerText]);return(0,n.useMemo)((()=>r?{key:"suggested",render:()=>null,items:[]}:t.length?{key:"suggested",render:e=>(0,Ee.jsx)(x().A,{...e,title:l,desktopTitleStyle:"tableHeader"===s?p.desktopTitleStyleTableHeader:{},desktopStyle:"tableHeader"===s?p.desktopStyleTableHeader:{}}),items:t}:a&&o&&!i?d:{key:"suggested",render:()=>null,items:[]}),[r,t,i,a,o,d,l,s,p.desktopStyleTableHeader,p.desktopTitleStyleTableHeader])}function Re({environment:e,collectionContextStore:t,propertySchema:o,onAccept:i,section:r,iconStyle:a,buttonStyle:l}){const s=(0,R().tz)(),c=(0,m().K8)((()=>(0,ne().xm)({collectionContextStore:t,environment:e})),[t,e]),p=(0,n.useMemo)((()=>"all"===r?c:r.flatMap((e=>{switch(e){case"basic":return Be;case"advanced":return Ue;case"metadata":return Ve;default:(0,V().HB)(e)}})).filter((e=>c.includes(e)))),[r,c]),d=!(0,m().O$)(g().e);return(0,m().K8)((()=>Object.fromEntries(p.map((e=>{const n=(0,ne().GN)(s,e);return[n.toLowerCase(),nt({propertyType:e,propertyName:n,collectionContextStore:t,disablePropertyTooltip:!1,onAccept:i,intl:s,propertySchema:o,isSuggestedProperty:!1,iconStyle:a,isOffline:d,buttonStyle:l})]})))),[t,s,i,o,p,a,d,l])}const Be=["text","number","select","multi_select","status","date","person","file","checkbox","url","phone_number","email"],Ue=["relation","rollup","formula","button","auto_increment_id","place"],Ve=["created_time","last_edited_time","created_by","last_edited_by"];function Ge({iconStyle:e,buttonStyle:t,onAfterAccept:o}){const n=(0,R().tz)(),r=(0,u().v3)(),s=(0,oe().ET)(),p=(0,y().IS)((()=>({defaultIconStyle:{fill:B().Tj.icon.primary}})),[]),d=(0,m().K8)((()=>s.collectionStore()),[s]),g=(0,m().K8)((()=>(0,l().f)(d)),[d]),f=(0,Te()._)({name:"verified_pages",spaceId:null==g?void 0:g.id,userId:r.currentUser.id}),S="verification_upsell_item_collection_entrypoint",{handleClick:h}=(0,xe().C)({upsell:null==f?void 0:f.upsell,source:S,postUpgradeCallback:o,spaceStore:g}),b=(0,m().K8)((()=>(0,fe().$3)({environment:r,collectionStore:d})),[r,d]),v=(0,c().X)("archive_content"),w=(0,m().K8)((()=>{const l=function({environment:e,collectionContextStore:t,spaceStore:o}){var n;const i=null==o?void 0:o.getModel();if(!i||!(0,F().X)(i))return!1;const r=null===(n=t.collectionViewBlockStore())||void 0===n?void 0:n.isCollectionViewPageWithContent();if(r)return!1;const a=t.collectionStore();if(!a)return!1;if(a.isExternallyImportedAndSyncedCollection())return!1;const l=(0,Pe().NU)({environment:e,collectionStore:a,templateId:k().z$})||(0,Pe().NU)({environment:e,collectionStore:a,templateId:k().qz});if(l)return!1;return!0}({environment:r,collectionContextStore:s,spaceStore:null==d?void 0:d.getSpaceStore()});if(!l&&!b)return{};let c,u;v?(c=k().qz,u=$().Gl.contentStatusPropertyName):(c=k().z$,u=$().Gl.verificationPropertyName);const m=Ce().globalWorkflowTemplates.fromId(c),y=n.formatMessage(u);if(!(0,A().bz)(m))return{};const w=b&&void 0!==(null==f?void 0:f.upsell)?(0,Ee.jsx)(Ie().UpgradeButton,{display:"icon",upsell:f.upsell,source:S,spaceStore:g}):void 0;return{[m.templateId]:tt({environment:r,template:m,collectionContextStore:s,suggestedFeatureAnalytics:void 0,titleBadge:w,disabled:b,onAccept:()=>{var e,t;b?h():((0,i().u)({environment:r,event:{eventName:"page_verification_property_added",eventProperties:{space_id:null===(e=a().default.getState().sidebarSpaceStore)||void 0===e?void 0:e.id,collection_id:null===(t=s.collectionStore())||void 0===t?void 0:t.id}}}),null==o||o())},titleOverride:y,isUpsell:b,tooltip:n.formatMessage(v?pt.content_status:pt.verification),iconStyle:e??p.defaultIconStyle,buttonStyle:t})}}),[o,n,s,r,e,p.defaultIconStyle,t,d,f,b,h,v,g]);return w}function Le({searchProperties:e,titleText:t,desktopTitleStyle:o,desktopStyle:i,topBorder:r,inputStyle:a}){const{searchInput:l,showSearchInput:s,handleSearchInputChange:c,handleToggleSearchInput:d}=e,u=(0,R().tz)(),m=(0,n.useCallback)((e=>{e&&p().A.isMobile&&e.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})}),[]),g=(0,y().IS)((()=>({titleContainer:{display:"flex",alignItems:"center"},icon:{width:W().Ev.xs,height:W().Ev.xs},button:{width:20,height:20,margin:4}})),[]),f=(0,n.useMemo)((()=>(0,Ee.jsxs)("span",{style:g.titleContainer,children:[(0,Ee.jsx)("span",{children:t}),(0,Ee.jsx)(w().m,{placement:"top",renderTooltip:()=>(0,Ee.jsx)(R().sA,{id:"tableHeaderPropertyCreationMenu.searchTooltip",defaultMessage:"Search types"}),render:e=>(0,Ee.jsx)(v().A,{ariaLabel:u.formatMessage(ct.newSearchPlaceholder),icon:E().magnifyingGlassSmallIcon,iconStyle:g.icon,style:g.button,onClick:d,...e})})]})),[d,g,t,u]),S=(0,n.useCallback)((e=>{"ArrowLeft"!==e.key&&"ArrowRight"!==e.key||e.stopPropagation(),"ArrowDown"!==e.key&&"ArrowUp"!==e.key||e.currentTarget.blur()}),[]),h=(0,n.useMemo)((()=>({key:"search-input",render:e=>(0,Ee.jsx)(ae().Ay,{...e,ref:m,placeholder:u.formatMessage(ct.newSearchPlaceholder),value:l,onChange:c,autoFocus:!0,focusInitial:!0,style:a,preventCaptureArrowShortcuts:!0,onKeyDown:S}),action:()=>{}})),[m,c,l,a,u,S]);return(0,n.useMemo)((()=>({key:"search-input",render:e=>(0,Ee.jsx)(x().A,{...e,topBorder:r,title:f,desktopStyle:i,desktopTitleStyle:o}),items:s?[h]:[]})),[i,o,f,h,s,r])}function He({title:e,filteredStandardPropertyItems:t,key:o,desktopStyle:i,topBorder:r}){return(0,n.useMemo)((()=>t.length?{key:o,render:t=>(0,Ee.jsx)(x().A,{...t,topBorder:r,desktopStyle:i,title:e}),items:t}:{key:o,render:()=>null,items:[]}),[t,r,i,o,e])}function qe({collectionContextStore:e,propertySchema:t,propertyGroupId:o,buttonStyle:i,propertyName:a,onAfterAccept:s}){const d=(0,u().v3)(),y=(0,R().tz)(),S=(0,m().K8)((()=>f().A.bots.state),[]),h=(0,m().K8)((()=>e.collectionStore()),[e]),b=(0,m().K8)((()=>(null==h?void 0:h.getSchema())??{}),[h]),v=(0,m().K8)((()=>Boolean(null==h?void 0:h.isPageTreeCollection())),[h]),w=(0,m().K8)((()=>e.databaseTypeFromStoreState),[e]),T=(0,m().K8)((()=>(0,l().f)(e.collectionStore())),[e]),{canEditSpace:x,isSpaceAdmin:_}=(0,m().K8)((()=>T?{canEditSpace:null==T?void 0:T.canEdit(),isSpaceAdmin:null==T?void 0:T.canAdmin()}:{canEditSpace:!1,isSpaceAdmin:!1}),[T]),k=(0,m().K8)((()=>{if(void 0!==t)return;const e=function(e,t){if(!e)return[];const o=pe().default.checkGate({gateName:"cron_connected_relation"}),n=pe().default.checkGate({gateName:"connected_relation"}),i=pe().default.checkGate({gateName:"slack_connected_relation"}),r=e.getDatabaseType()===I().dC,a=f().A.state;if(!a.loaded)return[];const l=a.integrations,s={};if(!r){const e=l.find((e=>e.id===D().ob)),t=(0,Q().Jb)();var c;e&&(s[t.name]={name:t.name,pattern:de().Y,integration:e,tooltipImage:{img:ue().A.images.tooltips.properties.githubSyncPullStatusPng,scale:.5},description:t.description,canOnlyAdminAuth:{disabledPropertyTooltipMessage:null===(c=t.canOnlyAdminAuth)||void 0===c?void 0:c.disabledPropertyTooltipMessage}})}const p=[];if(t&&(p.push(D().Hd,D().e1,D().k0),i&&p.push(D().zG)),o&&p.push(D().io),p.forEach((e=>{const t=l.find((t=>t.id===e));if(null!=t&&t.info.original_url_patterns)for(const n of t.info.original_url_patterns){var o;null!==(o=n.additional_types)&&void 0!==o&&o.connectedRelation&&(s[n.name]||(s[n.name]={name:(0,me().Fe)({pattern:n,integration:t}),pattern:n,integration:t}))}})),!n)return Object.values(s);for(const u of l)if(u.info.original_url_patterns&&t&&![...ye,D().F6].includes(u.id))for(const e of u.info.original_url_patterns){var d;null!==(d=e.additional_types)&&void 0!==d&&d.connectedRelation&&(s[e.name]||(u.id===D().mn?s[u.name]={name:"Salesforce Object",pattern:e,integration:u}:s[e.name]={name:(0,me().Fe)({pattern:e,integration:u}),pattern:e,integration:u}))}return Object.values(s)}(h,x),o=(0,ge().Yn)(_);return e.sort(((e,t)=>o[e.integration.id]-o[t.integration.id])),e}),[h,t,x,_]),A=(0,m().K8)((()=>{var t;return null===(t=e.collectionStore())||void 0===t?void 0:t.getSpaceId()}),[e]),C=(0,r().T)(),P=(0,Se().Ld)({spaceId:A,userId:C}),j=(0,m().K8)((()=>Boolean(null==h?void 0:h.isSyncedCollection())),[h]),N=(0,he().a)(),O=!(0,m().O$)(g().e),E=(0,c().X)("upgrade_system_db_properties_automations"),K=(0,n.useMemo)((()=>{if(null!=k&&k.length&&!N&&!O)return Object.fromEntries(k.map((t=>{const{isDisabled:n,featureAvailability:r,propertyDisabledTooltip:l}=function({propertyConfig:e,databaseType:t,bots:o,isSpaceAdmin:n,isMobile:i,isWikiCollection:r,isSyncedCollection:a,schema:l,intl:s,featureAvailabilities:c}){const p="integration"in e?e.integration.id:e.integrationId;if(!p)return{isDisabled:!1};const d=c[p];if(d&&!(0,z().e2)(d))return{isDisabled:!1,featureAvailability:d};var u;if((0,M().iY)({isAuthed:Boolean(o.find((e=>e.integration_id===p))),isSpaceAdmin:n,isPropertyAdminAuthOnly:Boolean(e.canOnlyAdminAuth),isMobile:i}))return{isDisabled:!0,propertyDisabledTooltip:null===(u=e.canOnlyAdminAuth)||void 0===u?void 0:u.disabledPropertyTooltipMessage};if(p===D().ob){if(lt(l,D().ob))return{isDisabled:!0,propertyDisabledTooltip:s.formatMessage(ct.duplicateGithubPropertyTooltip)};if(r)return{isDisabled:!0,propertyDisabledTooltip:s.formatMessage(ct.wikiGithubPropertyTooltip)};if(a)return{isDisabled:!0,propertyDisabledTooltip:s.formatMessage(ct.syncedDatabaseGithubPropertyTooltip)}}else if(p===D().io){if(lt(l,D().io),t!==I().TC)return{isDisabled:!0,propertyDisabledTooltip:s.formatMessage(ct.nonMeetingsCronPropertyTooltip)};if(lt(l,D().io))return{isDisabled:!0,propertyDisabledTooltip:s.formatMessage(ct.duplicateCronEventPropertyTooltip)}}return{isDisabled:!1}}({propertyConfig:t,bots:S,isSpaceAdmin:_,environment:d,isWikiCollection:v,databaseType:w,isSyncedCollection:j,schema:b,intl:y,isMobile:p().A.isMobile,featureAvailabilities:P});return[t.name.toLowerCase(),it({connectedRelationProperty:t,isDisabled:n,propertyDisabledTooltip:l,environment:d,intl:y,collectionContextStore:e,propertyGroupId:o,featureAvailability:r,buttonStyle:i,propertyName:a,onAfterAccept:s,isNusEnabled:E,spaceStore:T})]})).filter(V().O9))}),[k,N,O,S,_,d,v,w,j,b,y,P,e,o,i,a,s,E,T]);return K}function $e(e){const{collectionContextStore:t,buttonStyle:o,onAfterAccept:i}=e,r=(0,u().v3)(),a=(0,R().tz)(),l=(0,m().K8)((()=>{var e;return(null===(e=t.collectionStore())||void 0===e?void 0:e.getSchema())??{}}),[t]),s=(0,c().X)("connected_relations_database_actions_enabled"),p=!(0,m().O$)(g().e),[d,y]=(0,n.useMemo)((()=>{if(!s)return[{},[]];const e={};for(const[n,s]of Object.entries(l)){if(!s||!(0,P().UU)(s))continue;const l=s.connectedRelation.integration_id;if(!l||!(0,D().KB)(l))continue;const c=rt({propertySchema:s,environment:r,intl:a,collectionContextStore:t,propertyId:n,integrationId:l,isOffline:p,buttonStyle:o,onAfterAccept:i});e[l]||(e[l]={}),e[l][s.name.toLowerCase()]=c}return[e,Object.values(e).flat()]}),[a,l,s,r,t,p,o,i]);return[d,y]}function Ye({filteredConnectedPropertyItems:e,hideTitle:t,desktopStyle:o}){const i=(0,R().tz)();return(0,n.useMemo)((()=>e.length?{key:"connected",render:e=>(0,Ee.jsx)(x().A,{...e,title:i.formatMessage(ct.connectedRelationSectionTitle),hideTitle:t,topBorder:t,desktopStyle:o}),items:e}:{key:"connected",render:()=>null,items:[]}),[e,t,o,i])}function Xe({filteredConnectedPropertyItemsPerIntegration:e}){const t=(0,R().tz)();return(0,n.useMemo)((()=>0===Object.keys(e).length?[{key:"existingConnectedRelations",render:()=>null,items:[]}]:Object.entries(e).map((([e,o])=>0===o.length?{key:e,render:()=>null,items:[]}:{key:e,render:o=>(0,Ee.jsx)("div",{style:{padding:4,gap:2,display:"flex",flexDirection:"column",margin:0},children:(0,Ee.jsx)(x().A,{...o,title:t.formatMessage(ct.existingConnectedRelationSectionTitle,{integrationName:(0,D().mi)(e)})})}),items:o}))),[e,t])}const Qe="workflow.";function Je(e){return`${Qe}${e}`}function Ze(e){return e.replace(Qe,"")}const et=n.memo((function({buttonMenuItemProps:e,title:t,titleBadge:i,tooltip:r,isDisabled:a,icon:l}){const[s,c]=(0,n.useState)(!1),p=(0,n.useCallback)((()=>{c(!0)}),[]),d=(0,n.useCallback)((()=>{c(!1)}),[]),u=(0,y().IS)((()=>({wrapper:{width:"100%"},container:{display:"inline-flex",alignItems:"center",justifyContent:"space-between",maxWidth:"100%",width:"100%",overflow:"hidden"},titleSection:{display:"inline-flex",flex:1,alignItems:"center",overflow:"hidden"},titleText:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",marginInlineEnd:4,opacity:a?.3:1},questionIcon:{opacity:s?1:0,transition:"opacity 200ms ease-in-out",cursor:"pointer",flexShrink:0,display:"flex",alignItems:"center"},iconWrapper:{opacity:a?.3:1}})),[s,a]);return(0,Ee.jsx)("div",{onMouseEnter:p,onMouseLeave:d,style:u.wrapper,children:(0,Ee.jsx)(T().A,{...e,disabled:a,disabledFeedback:!1,title:(0,Ee.jsxs)("div",{style:u.container,children:[(0,Ee.jsxs)("div",{style:u.titleSection,children:[(0,Ee.jsx)(o(302501).A,{style:u.titleText,children:t}),i]}),r?(0,Ee.jsx)(Oe().d,{showImage:!a,caption:r,render:e=>(0,Ee.jsx)("div",{role:"button",tabIndex:0,style:u.questionIcon,onClick:e=>e.stopPropagation(),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||e.stopPropagation()},...e,children:(0,Ee.jsx)(b().I,{icon:K().questionMarkCircleSmallIcon,size:"xs",colorVariant:"secondary",style:u.questionIcon})})}):void 0]}),icon:(0,Ee.jsx)("div",{style:u.iconWrapper,children:l})})})}));function tt({environment:e,template:t,collectionContextStore:o,suggestedFeatureAnalytics:n,titleBadge:i,titleOverride:r,isUpsell:a,onAccept:l,tooltip:s,iconStyle:c,buttonStyle:p,disabled:d}){const u=r||(0,Ce().getWorkflowTemplateName)(t);return{key:Je(t.templateId),searchKeys:[u],action:()=>{a||(0,ke().p)({environment:e,template:t,collectionContextStore:o,suggestedFeatureAnalytics:n}),null==l||l()},render:e=>(0,Ee.jsx)(et,{buttonMenuItemProps:{...e,buttonStyle:p},title:u,titleBadge:i,tooltip:s??void 0,isDisabled:d,icon:(0,Ee.jsx)(Ae().z,{template:t,size:16,iconStyle:c})})}}function ot({appConfig:e,suggestedProperty:t,isDisabled:o,propertyDisabledTooltip:n,environment:i,collectionContextStore:r,theme:a,iconStyle:l,buttonStyle:s,onAfterAccept:c,nameInput:p}){const u=r.collectionStore(),m=j().u9.derivePropertyUris((null==u?void 0:u.getSchema())??{},null==u?void 0:u.getPropertyMapping()),y=(e,t,n,i)=>{const r=n.dependencies.find((e=>{var t;return"property"===e.type&&e.collectionUri===(null==u||null===(t=u.getFormat())||void 0===t?void 0:t.app_config_uri)&&(0,_().LE)(e.uri)&&!m.has(e.uri)})),c=n.dependencies.find((e=>"property"===e.type&&(0,P().$M)(e.propertySchema)&&(0,P().om)(e.propertySchema)));if(r)return(0,Ee.jsx)(T().A,{...e,disabled:o,disabledFeedback:o,title:(0,Ee.jsxs)("div",{style:{display:"inline-flex",alignItems:"center"},children:[t,c?(0,Ee.jsx)(ie().A,{}):null,n.isNew?"notion://projects/tasks_with_sprints_feature"===n.uri&&(0,Ee.jsx)(re().A,{}):null]}),icon:(0,Ee.jsx)(N().zB,{type:r.propertySchema.type,theme:a,icon:i,size:W().Ev.sm,style:l}),style:s})},g=new(h().A);return{key:t.name,searchKeys:[t.name],render:o=>(0,Ee.jsx)(Oe().d,{showImage:!n,caption:n??t.description,render:n=>{if((0,ee().l)(t))return y({...(0,d().A)(o,n)},t.name,t,t.icon);{const a=U().oE(t.variants.map((t=>{const o=null==e?void 0:e.allFeatures.find((e=>e.uri===t));if(o&&(0,ee().l)(o))return o})));return(0,Ee.jsx)(le().A,{buttonPopupStore:g,items:a,getKey:e=>e.name,onSelect:async e=>{await te().h3({environment:i,feature:e,collectionContextStore:r,addFeatureFrom:"new_property",customPropertyName:p}),Ne().os({collectionSettingsStore:r.settingsStore}),null==c||c()},selectedItem:void 0,renderOrigin:e=>y({focused:Boolean(o.focused),...(0,d().A)(U().cJ(o,"onClick","focused"),(0,d().A)(n,e))},t.name,a[0],t.icon),renderItem:e=>(0,Ee.jsx)(T().A,{...e,title:e.value.name,shouldWrapCaption:!0,shouldWrapTitle:!0,style:s})})}}}),action:async()=>{(0,ee().l)(t)?(await te().h3({environment:i,feature:t,collectionContextStore:r,addFeatureFrom:"new_property",customPropertyName:p}),Ne().os({collectionSettingsStore:r.settingsStore})):g.setState({open:!0}),null==c||c()}}}function nt(e){const{collectionContextStore:t,propertySchema:o,propertyName:n,propertyType:i,disablePropertyTooltip:r,intl:a,onAccept:l,iconStyle:c,isSuggestedProperty:p,isOffline:d,buttonStyle:u}=e;return{key:n,searchKeys:[n,..."en"!==a.locale?[ne().Hp[i]]:[]],render:e=>{const l=o&&(null==o?void 0:o.type)===i,p=function({intl:e,collectionContextStore:t,propertyType:o,propertySchema:n,isOffline:i}){if(i&&(0,De().$)({propertyType:o,propertySchema:n,allowAIProperty:!1}))return e.formatMessage(L().AY.unavailableOfflineTooltip);if("auto_increment_id"===o){var r;if(null!=n&&n.type)return e.formatMessage(s().q.convert_to_auto_increment_id_property);const o=t.collectionStore();if(null==o?void 0:o.isPageTreeCollection())return e.formatMessage(s().q.wiki_forbidden_auto_increment_id_property);if(Boolean(null==o?void 0:o.isSyncedCollection()))return e.formatMessage(s().q.synced_database_forbidden_auto_increment_id_property);const i=o&&o.id,a=o&&o.getFormat(),l=o&&(null===(r=o.getSpaceStore())||void 0===r?void 0:r.id),c=o&&o.getSchema(),p=o&&o.getDeletedSchema();if(!(i&&a&&l&&c&&p))return;const d=o.getModel();if(d&&(0,C().N_)(d))return e.formatMessage(s().q.duplicate_auto_increment_id_property)}}({intl:a,collectionContextStore:t,propertyType:i,propertySchema:o,isOffline:d}),m=void 0!==p,y=!r&&pt.hasOwnProperty(i)?a.formatMessage(pt[i]):void 0;return(0,Ee.jsx)(at,{isChecked:l,buttonMenuItemProps:e,propertyName:n,propertyType:i,isDisabled:m,tooltip:p??y,iconStyle:c,buttonStyle:u})},action:()=>{l({propertyType:i,isSuggestedProperty:p,propertyName:n})}}}function it({connectedRelationProperty:e,isDisabled:t,propertyDisabledTooltip:o,environment:n,collectionContextStore:r,intl:a,propertyGroupId:s,featureAvailability:c,buttonStyle:p,propertyName:d,onAfterAccept:u,isNusEnabled:m,spaceStore:y}){const g=c&&!(0,z().e2)(c),f=g?m?(0,Ee.jsx)(Ie().UpgradeButton,{display:"icon",featureName:"collection_connected_property_github",source:"collection_connected_property",upsell:c.upsell,spaceStore:y}):(0,Ee.jsx)(we().B,{upsell:c.upsell,analyticsName:"collection_connected_property",disableTooltip:!0}):e.integration.id===D().mn&&(0,Ee.jsx)(re().A,{});return{key:e.name,searchKeys:[e.name],render:n=>(0,Ee.jsx)(at,{buttonMenuItemProps:n,propertyName:e.name,propertyType:"relation",isDisabled:t,tooltip:o,icon:e.integration.info.icon,buttonStyle:p,badge:f}),action:async()=>{if(g)(0,ve().K)(n,{from:"collection_connected_property",upsell:c.upsell,spaceStore:(0,l().f)(r.collectionStore())});else{if(e.integration.id===D().mn){const t=r.collectionStore();(0,i().u)({environment:n,event:{eventName:"salesforce_actions",eventProperties:{actionType:"navigate_to_object_selection",integrationId:e.integration.id,collectionId:null==t?void 0:t.id}}}),Ne().a2({collectionSettingsStore:r.settingsStore,item:{type:"connectedRelationDatabaseActions",source:"ConnectedRelationObjectSelection",integrationId:e.integration.id}})}else await te().XO({environment:n,connectedRelationProperty:e,collectionContextStore:r,intl:a,from:"new_property",propertyGroupId:s,propertyName:d});null==u||u()}}}}function rt(e){const{propertySchema:t,intl:o,collectionContextStore:n,propertyId:r,integrationId:a,isOffline:l,buttonStyle:s,onAfterAccept:c,environment:p}=e;return{key:r,searchKeys:[r],render:e=>(0,Ee.jsx)(at,{buttonMenuItemProps:e,propertyName:t.name,propertyType:"relation",icon:t.icon,isDisabled:l,tooltip:l?o.formatMessage(L().AY.unavailableOfflineTooltip):void 0,buttonStyle:s}),action:()=>{Ne().a2({collectionSettingsStore:n.settingsStore,item:{type:"connectedRelationDatabaseActions",source:"connectedRelationAddProperties",rootPropertyId:r,integrationId:a,rootPropertySchema:t,eventSource:"new_property_menu"}});const e=n.collectionStore();(0,i().u)({environment:p,event:{eventName:"salesforce_actions",eventProperties:{actionType:"add_properties_clicked",details:{source:"new_property_menu"},integrationId:a,collectionId:null==e?void 0:e.id}}}),null==c||c()}}}const at=n.memo((function(e){const{badge:t,buttonMenuItemProps:o,buttonStyle:i,icon:r,iconStyle:a,isChecked:l,isDisabled:s,propertyName:c,propertyType:p,tooltip:d,tooltipImage:u,tooltipImageScale:m}=e,[g,f]=(0,n.useState)(!1),S=(0,n.useCallback)((()=>{f(!0)}),[]),h=(0,n.useCallback)((()=>{f(!1)}),[]),v=(0,y().DP)(),w=(0,y().IS)((()=>({wrapper:{width:"100%"},container:{display:"inline-flex",alignItems:"center",justifyContent:"space-between",maxWidth:"100%",width:"100%",overflow:"hidden"},titleSection:{display:"inline-flex",flex:1,alignItems:"center",overflow:"hidden"},span:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",marginInlineEnd:4},questionIcon:{opacity:g?1:0,transition:"opacity 200ms ease-in-out",cursor:"pointer",flexShrink:0,display:"flex",alignItems:"center"},defaultIconStyle:{fill:B().Tj.icon.primary}})),[g]);return(0,Ee.jsx)("div",{onMouseEnter:S,onMouseLeave:h,style:w.wrapper,children:(0,Ee.jsx)(T().A,{...o,disabled:s,disabledFeedback:s,title:(0,Ee.jsxs)("div",{style:w.container,children:[(0,Ee.jsxs)("div",{style:w.titleSection,children:[(0,Ee.jsx)("span",{style:w.span,children:c}),t]}),d?(0,Ee.jsx)(Oe().d,{showImage:!s,caption:d,tooltipImage:s?void 0:u,tooltipImageScale:m,placement:"right",render:e=>(0,Ee.jsx)("div",{role:"button",tabIndex:0,style:w.questionIcon,onClick:e=>e.stopPropagation(),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||e.stopPropagation()},...e,children:(0,Ee.jsx)(b().I,{icon:K().questionMarkCircleSmallIcon,size:"xs",colorVariant:"secondary",style:w.questionIcon})})}):void 0]}),isChecked:l,icon:(0,Ee.jsx)(N().zB,{type:p,theme:v,icon:r,size:W().Ev.sm,style:a??w.defaultIconStyle}),buttonStyle:i})})}));function lt(e,t){for(const n in e){var o;const i=e[n];if(i&&"connectedRelation"in i&&(null===(o=i.connectedRelation)||void 0===o?void 0:o.integration_id)===t)return!0}return!1}const st=["ai_summary"];const ct=(0,R().YK)({propertyNameLabel:{defaultMessage:"Name",id:"database.viewSettings.propertyTypeSelect.propertyNameLabel"},searchPlaceholder:{defaultMessage:"Search or add new property",id:"database.viewSettings.propertyTypeSelect.searchPlaceholder"},newSearchPlaceholder:{defaultMessage:"Search types...",id:"database.viewSettings.propertyTypeSelect.newSearchPlaceholder"},searchToChangePlaceholder:{defaultMessage:"Search for property type",id:"database.viewSettings.propertyTypeSelect.searchToChangePlaceholder"},propertyNameInputPlaceholder:{defaultMessage:"Property name",id:"database.viewSettings.propertyTypeSelect.propertyNameInputPlaceholder"},suggestedSectionTitle:{defaultMessage:"Suggested",id:"database.viewSettings.propertyTypeSection.suggested"},loadingSuggestedSectionTitle:{defaultMessage:"Thinking...",id:"database.viewSettings.propertyTypeSection.loadingSuggested"},connectedRelationSectionTitle:{defaultMessage:"Connections",id:"database.viewSettings.propertyTypeSection.connected"},existingConnectedRelationSectionTitle:{defaultMessage:"{integrationName}",id:"database.viewSettings.propertyTypeSection.existingConnectedIntegrationTitle"},typesSectionTitle:{defaultMessage:"Type",id:"database.viewSettings.propertyTab.propertyType"},autofillSectionTitle:{defaultMessage:"AI autofill",id:"database.viewSettings.propertyTab.autofillProperties"},newProperty:{defaultMessage:"New property",id:"database.viewSettings.newProperty"},newPropertyWithDatabaseName:{defaultMessage:"New property on {databaseName}",id:"database.viewSettings.newPropertyOnDatabase"},changePropertyType:{defaultMessage:"Change property type",id:"database.viewSettings.changePropertyType"},selectToAddNewProperty:{defaultMessage:"Select to add",id:"database.viewSettings.selectToAdd"},newPill:{defaultMessage:"New",id:"database.viewSettings.newHighlightedFeature"},duplicateGithubPropertyTooltip:{defaultMessage:"A database can only have one GitHub Pull Requests property",id:"database.viewSettings.propertyTab.duplicateGithubProperty.tooltip"},wikiGithubPropertyTooltip:{defaultMessage:"A wiki cannot have a GitHub Pull Requests property",id:"database.viewSettings.propertyTab.wikiGithubProperty.tooltip"},syncedDatabaseGithubPropertyTooltip:{defaultMessage:"A synced database cannot have a GitHub Pull Requests property",id:"database.viewSettings.propertyTab.syncedDatabaseGithubProperty.tooltip"},nonMeetingsCronPropertyTooltip:{defaultMessage:"The Cron Calendar property can only be added to a Meetings database",id:"database.viewSettings.propertyTab.nonMeetingsCronProperty.tooltip"},duplicateCronEventPropertyTooltip:{defaultMessage:"A database can only have one Cron Calendar event property",id:"database.viewSettings.propertyTab.duplicateCronEventProperty.tooltip"},upgradeRequired:{defaultMessage:"Please upgrade to use this property",id:"database.viewSettings.propertyTab.upgradeRequired"},selectType:{defaultMessage:"Select type",id:"database.viewSettings.propertyTabGrid.selectType"}}),pt=(0,R().YK)({text:{defaultMessage:"Add text that can be formatted. Great for summaries, notes, or descriptions.",id:"database.viewSettings.propertyTab.textProperty.tooltip"},number:{defaultMessage:"Accepts numbers. These can also be formatted as currency or progress bars. Useful for tracking counts, prices, and completion.",id:"database.viewSettings.propertyTab.numberProperty.tooltip"},select:{defaultMessage:"Select one option from a list of tags. Useful for categorization.",id:"database.viewSettings.propertyTab.selectProperty.tooltip"},multi_select:{defaultMessage:"Select one or more options from a list of tags. Useful for tagging items across multiple categories.",id:"database.viewSettings.propertyTab.multiSelectProperty.tooltip"},date:{defaultMessage:"Accepts a date or a date range (time optional). Useful for deadlines, especially with calendar and timeline views.",id:"database.viewSettings.propertyTab.dateProperty.tooltip"},formula:{defaultMessage:"Perform calculations based on other properties using Notion’s formula language.",id:"database.viewSettings.propertyTab.formulaProperty.tooltip"},relation:{defaultMessage:"Connect databases and mention database pages. Useful for connecting items across your workspace.",id:"database.viewSettings.propertyTab.relationProperty.tooltip"},rollup:{defaultMessage:"View and aggregate information about properties from relation properties. Useful for summarizing interconnected data.",id:"database.viewSettings.propertyTab.rollupProperty.tooltip"},person:{defaultMessage:"Tag anyone in your Notion workspace. Useful for assigning tasks or referencing relevant team members.",id:"database.viewSettings.propertyTab.personProperty.tooltip"},file:{defaultMessage:"Upload files and images for easy retrieval. Useful for storing documents and photos.",id:"database.viewSettings.propertyTab.filesProperty.tooltip"},checkbox:{defaultMessage:"Use a checkbox to indicate whether a condition is true or false. Useful for lightweight task tracking.",id:"database.viewSettings.propertyTab.checkboxProperty.tooltip"},url:{defaultMessage:"Accepts a link to a website and opens the link in a new tab when clicked.",id:"database.viewSettings.propertyTab.urlProperty.tooltip"},email:{defaultMessage:"Accepts an email address and launches your mail client when clicked.",id:"database.viewSettings.propertyTab.emailProperty.tooltip"},phone_number:{defaultMessage:"Accepts a phone number and prompts your device to call it when clicked.",id:"database.viewSettings.propertyTab.phoneNumberProperty.tooltip"},created_time:{defaultMessage:"Records the timestamp of an item’s creation. Auto-generated and not editable.",id:"database.viewSettings.propertyTab.createdTimeProperty.tooltip"},created_by:{defaultMessage:"Automatically records the person who created the item. Auto-generated and not editable.",id:"database.viewSettings.propertyTab.createdByProperty.tooltip"},last_edited_time:{defaultMessage:"Records the timestamp of an item’s last edit. Auto-updated and not editable.",id:"database.viewSettings.propertyTab.lastEditedTimeProperty.tooltip"},last_edited_by:{defaultMessage:"Records the person who edited the item last. Auto-updated and not editable.",id:"database.viewSettings.propertyTab.lastEditedByProperty.tooltip"},auto_increment_id:{defaultMessage:"Automatically creates a numerical ID for each item. IDs are unique and cannot be manually changed.",id:"database.viewSettings.propertyTab.uniqueIdProperty.tooltip"},status:{defaultMessage:"Track this item’s progress using status tags categorized by To-do, In progress, and Complete.",id:"database.viewSettings.propertyTab.statusProperty.tooltip"},verification:{defaultMessage:"Indicate whether a page has been verified by the page owner, with the option to set an expiration date.",id:"database.viewSettings.propertyTab.verificationProperty.tooltip"},content_status:{defaultMessage:"Indicate whether a page has been verified or archived by the page owner, with the option to set an expiration date.",id:"database.viewSettings.propertyTab.contentStatusProperty.tooltip"},button:{defaultMessage:"Trigger actions based on the item properties.",id:"database.viewSettings.propertyTab.buttonProperty.tooltip"},ai_summary:{defaultMessage:"Text property with AI summary set up for you. Generates a summary based on page content and properties.",id:"database.viewSettings.propertyTab.aiSummaryProperty.tooltip"},ai_translate:{defaultMessage:"Text property with AI translate set up for you. Translate a property to another language using AI. ",id:"database.viewSettings.propertyTab.aiTranslateProperty.tooltip"},ai_category:{defaultMessage:"Select property that automatically adds tags based on the page content and properties.",id:"database.viewSettings.propertyTab.aiCategoryProperty.tooltip"},ai_keywords:{defaultMessage:"Multi-select property that automatically adds tags based on the page content and properties.",id:"database.viewSettings.propertyTab.aiKeywordsProperty.tooltip"},ai_custom_prompt:{defaultMessage:"Text property with a custom AI prompt. Generate content based on the page content and properties.",id:"database.viewSettings.propertyTab.aiCustomPromptProperty.tooltip"},ai_extract:{defaultMessage:"Text property with a custom AI prompt. Extract key info based on the page content and properties.",id:"database.viewSettings.propertyTab.aiExtractProperty.tooltip"},title:{defaultMessage:"Add a title for your database item. This determines the page’s title.",id:"database.viewSettings.propertyTab.titleProperty.tooltip"},location:{defaultMessage:"Display the location of which database this item belongs to.",id:"database.viewSettings.propertyTab.locationProperty.tooltip"},last_visited_time:{defaultMessage:"Records the timestamp of the last time you visited this page. Auto-updated and not editable.",id:"database.viewSettings.propertyTab.lastVisitedTimeProperty.tooltip"},place:{defaultMessage:"Display a physical location on a map.",id:"database.viewSettings.propertyTab.placeProperty.tooltip"}});function dt({environment:e,collectionContextStore:t,appConfig:o}){const n=(0,m().K8)((()=>{const o=t.collectionStore();return Boolean(o&&(0,ce().jq)(be().A.getMode(e,o,o.getSpaceStore()),o))}),[e,t]),i=(0,m().K8)((()=>{var e,i;if(!n)return!1;if(void 0!==o)return!1;if(null===(e=t.collectionStore())||void 0===e||!e.getName())return!1;const r=null===(i=t.collectionStore())||void 0===i?void 0:i.getSchema();return!(r&&(0,V().uv)(r).length>P().Hm)&&(0,ce().QV)(t.collectionStore())}),[n,o,t]);return{hasAiEnabled:n,showAiSuggestions:i}}},960127:(e,t,o)=>{o.r(t),o.d(t,{WorkflowSettingsConfirmAddTemplate:()=>P,isWorkflowTemplateWithConfirmStep:()=>N});o(16280);var n=o(296540),i=()=>o(564884),r=()=>o(726637),a=()=>o(484714),l=()=>o(401497),s=()=>o(160432),c=()=>o(424400),p=()=>o(736847),d=()=>o(663077),u=()=>o(69708),m=()=>o(496603),y=()=>o(339798),g=()=>o(735695),f=()=>o(35091),S=()=>o(908201),h=()=>o(547149),b=()=>o(101926),v=()=>o(513349),w=()=>o(913454),T=(o(581454),()=>o(784892)),x=()=>o(100622),I=()=>o(399762),_=o(474848);function k({template:e,style:t}){const o=(0,l().IS)((()=>({container:{...t,padding:12,border:`1px solid ${x().Tj.border.secondaryTranslucent}`,borderRadius:6}})),[t]),n=function(e){if((0,d().Xq)(e,"property")&&(0,d().Io)(e)){const{options:t=[]}=e.value;if(0===t.length)return;return(0,_.jsx)(A,{options:t})}}(e);return n?(0,_.jsx)("div",{style:o.container,children:n}):null}function A({options:e}){const t=(0,l().IS)((()=>({container:{display:"flex",flexDirection:"column",gap:8}})),[]);return(0,_.jsx)("div",{style:t.container,children:e.map((e=>(0,_.jsx)("div",{children:(0,_.jsx)(I().O,{format:T().NY.Medium,isSingle:!0,value:e.value,color:e.color,showRemoveButton:!1})},e.id)))})}var C=()=>o(902842);function P({template:e,collectionSettingsStore:t}){const[o,i]=(0,n.useState)("sample"===e.propertyOptionsType),a=(0,l().IS)((()=>{const e={display:"flex",flexDirection:"column",minHeight:0};return{shrinkableHeight:e,noShrink:{flexShrink:0},featurePreviewWrapper:{...e,width:"-webkit-fill-available"},featurePreviewBody:{...e,gap:16,...r().A.isMobile?{margin:"16px 0"}:{margin:0}},featurePreview:{...e,overflow:"auto"},addButtonContainer:{...r().A.isMobile?{margin:"12px 0"}:{marginBottom:6}}}}),[]),s=(0,w().getWorkflowTemplateName)(e);return(0,_.jsxs)(g().A,{collectionSettingsStore:t,title:(0,_.jsx)(u().sA,{id:"workflowTemplateSettings.confirmAddTemplate.title",defaultMessage:"Turn on {templateName}",values:{templateName:s}}),disableScroller:!0,menuScrollerStyle:a.shrinkableHeight,innerContentWrapperStyle:a.shrinkableHeight,children:[(0,_.jsx)(p().A,{style:a.shrinkableHeight,children:(0,_.jsx)(c().Ay,{style:a.shrinkableHeight,textWrapperStyle:a.featurePreviewWrapper,bodyStyle:a.featurePreviewBody,body:(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(M,{template:e,style:a.noShrink}),(0,_.jsx)(k,{template:e,style:a.featurePreview})]})})}),(0,_.jsx)(p().A,{style:a.noShrink,children:e.value.options&&e.value.options.length>0?(0,_.jsx)(f().A,{title:(0,_.jsx)(u().sA,{id:"workflowTemplateSettings.confirmAddTemplate.propertyOptionsToggle",defaultMessage:"Set my own options"}),switcherProps:{on:o,disallowTabbing:!0},onClick:()=>{i(!o)}}):void 0}),(0,_.jsx)(p().A,{style:a.noShrink,children:(0,_.jsx)(c().Ay,{body:(0,_.jsx)(j,{template:e,startEmpty:o}),bodyStyle:a.addButtonContainer})})]})}function M({template:e,style:t}){const o=(0,l().IS)((()=>({container:{...t,display:"flex",alignItems:"center",gap:12},textWrapper:{lineHeight:r().A.isMobile?"20px":"18px"},title:{fontSize:r().A.isMobile?16:13},caption:{fontSize:r().A.isMobile?14:12,overflow:"hidden",color:"gray",whiteSpace:"nowrap",textOverflow:"ellipsis"}})),[t]),n=(0,w().getWorkflowTemplateName)(e),i=(0,d().Uy)(e);return(0,_.jsxs)("div",{style:o.container,children:[(0,_.jsx)(C().n,{template:e,backgroundSize:32}),(0,_.jsxs)("div",{style:o.textWrapper,children:[(0,_.jsx)("div",{style:o.title,children:n}),i?(0,_.jsx)("div",{style:o.caption,children:i}):void 0]})]})}function j({template:e,startEmpty:t}){const o=(0,l().IS)((()=>({button:{width:"100%"}})),[]),n=(0,a().v3)(),r=(0,S().ET)(),c=(0,w().getWorkflowTemplateName)(e),p=m().mg(e);return t&&delete p.value.options,(0,_.jsx)(s().A,{colorPalette:"blue",style:o.button,size:"lg",onClick:()=>{h().createAndCommit({userAction:"WorkflowSettingsConfirmAddTemplate.addFeatureTemplateToTarget",environment:n,canUndo:!0,perform:t=>{const o=r.collectionStore();if(!o)throw new Error("collectionStore not found");b().ai({environment:n,transaction:t,collectionStore:o,template:p,logger:new(w().WorkflowTemplateLogger),origin:"suggested_feature"});const a=r.settingsStore;y().yl({collectionSettingsStore:a});const l=o.getWorkflowTemplateId();(0,i().u)({environment:n,event:{eventName:"suggested_feature_template_added",eventProperties:{origin:"suggested_properties",template_id_added:e.templateId,collection_template_id:l}}});const s=r.collectionViewStore();s&&(0,v().UD)({template:e,environment:n,collectionStore:o,collectionViewStore:s,collectionSettingsStore:a,collectionContextStore:r})}})},children:(0,_.jsx)(u().sA,{id:"workflowTemplateSettings.confirmAddTemplate.button",defaultMessage:"Add {templateName}",values:{templateName:c}})})}function N(e){return"property"===e.type&&("select"===e.value.type||"multi_select"===e.value.type)}}}]);