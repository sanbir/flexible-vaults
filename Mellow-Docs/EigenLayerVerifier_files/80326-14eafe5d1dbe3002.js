"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[80326],{68207:(e,t,o)=>{o.d(t,{S:()=>r});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"4.67 2.67 10.66 15.64",svg:(0,o(474848).jsx)("path",{d:"M6.328 3c0-.18.145-.325.325-.325h6.694c.18 0 .325.146.325.325v.474c0 .948-.404 1.85-1.112 2.481l-.402.36.19 1.944.039.013a4.325 4.325 0 0 1 2.938 4.097V13c0 .18-.145.325-.325.325h-4.17v3.38a1.1 1.1 0 0 1-.1.46l-.44.956-.063.087a.35.35 0 0 1-.564-.103l-.432-.94a1.1 1.1 0 0 1-.1-.46v-3.38H5A.325.325 0 0 1 4.675 13v-.63a4.325 4.325 0 0 1 2.938-4.098l.039-.013.19-1.945-.402-.359a3.33 3.33 0 0 1-1.112-2.481z"})},r=(0,o(340498).wt)("pinFill",n,"fill")},142680:(e,t,o)=>{o.d(t,{A:()=>i});o(296540);var n=()=>o(69708),r=o(474848);const i=function({on:e,menuListItemProps:t,disabled:i}){return(0,r.jsx)(o(26697).m,{disableTooltip:!i,renderTooltip:()=>(0,r.jsx)(n().sA,{defaultMessage:"Only available for Count",id:"AggregationLimitToggle.disabled.tooltip"}),render:l=>(0,r.jsx)(o(574036).A,{...(0,o(383036).A)(t,l),on:!i&&e,disabled:i,style:{alignItems:"flex-start",paddingTop:8,paddingBottom:8},title:(0,r.jsx)(n().sA,{defaultMessage:"Show large counts as 99+",id:"BoardAggregations.aggregationLimitToggle.title"}),captionStyle:{marginTop:6},shouldWrapCaption:!0,caption:(0,r.jsx)(n().sA,{defaultMessage:"This improves performance for large databases.",id:"BoardAggregations.aggregationLimitToggle.description"})})})}},222334:(e,t,o)=>{o.r(t),o.d(t,{arrowChevronSingleRightIcon:()=>r,iconDefinition:()=>n});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"7.22 3.97 6.66 12.06",directional:!0,svg:(0,o(474848).jsx)("path",{d:"M13.692 10.442a.625.625 0 0 0 0-.884l-5.4-5.4a.625.625 0 1 0-.884.884L12.366 10l-4.958 4.958a.625.625 0 0 0 .884.884z"})},r=(0,o(340498).wt)("arrowChevronSingleRight",n,"default")},230979:(e,t,o)=>{o.d(t,{N:()=>r});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"4.37 2.37 11.26 15.94",svg:(0,o(474848).jsx)("path",{d:"M6.653 2.375A.625.625 0 0 0 6.028 3v.474A3.62 3.62 0 0 0 7.24 6.179l.289.258-.157 1.603a4.625 4.625 0 0 0-2.997 4.33V13c0 .345.28.625.625.625h4.13v3.08c0 .158.035.317.1.46l.433.94a.35.35 0 0 0 .565.103l.063-.087.44-.956c.065-.142.1-.3.1-.46v-3.08H15c.345 0 .625-.28.625-.625v-.63a4.625 4.625 0 0 0-2.997-4.33l-.157-1.603.289-.258a3.63 3.63 0 0 0 1.212-2.705V3a.625.625 0 0 0-.625-.625zm1.42 2.871c-.468-.417-.75-1-.79-1.621h5.434a2.38 2.38 0 0 1-.79 1.621l-.525.47a.63.63 0 0 0-.206.527l.227 2.318a.63.63 0 0 0 .422.531l.237.08a3.375 3.375 0 0 1 2.293 3.197v.006h-8.75v-.006c0-1.447.922-2.733 2.293-3.197l.237-.08a.63.63 0 0 0 .422-.531l.227-2.318a.63.63 0 0 0-.206-.528z"})},r=(0,o(340498).wt)("pin",n,"default")},236248:(e,t,o)=>{o.d(t,{b:()=>v,v:()=>f});var n=()=>o(755531),r=()=>o(484714),i=()=>o(590526),l=()=>o(79926),a=()=>o(391400),s=()=>o(732810),c=()=>o(888325),u=()=>o(187174),p=()=>o(96689),d=()=>o(769864);const g=new(l().O2)("loadWorkflowTemplateInstances",(async()=>await Promise.all([o.e(75134),o.e(35530),o.e(9773),o.e(36556),o.e(55373),o.e(36192),o.e(40537),o.e(71562),o.e(96346),o.e(27992),o.e(63452),o.e(66249),o.e(92845),o.e(87249),o.e(79022),o.e(44854),o.e(87017),o.e(46414),o.e(61165),o.e(47668),o.e(24587),o.e(67494),o.e(3651),o.e(48486),o.e(92924),o.e(71481)]).then(o.bind(o,191458))));var m=()=>o(299177);const y=!1;function v(e){var t;const o=null===(t=(0,l().fJ)(g).value)||void 0===t?void 0:t.loadWorkflowTemplateInstances;(0,i().K8)((()=>{if(!o)return;const t=function(e){return!(e instanceof s().m)}(e)?e.collectionStore():e;t&&o(t)}),[o,e])}function f(){const e=(0,r().v3)(),t=(0,i().K8)((()=>{var e;if(function(){const e=a().A.state.initialRenderCompleted;y&&!e&&console.log("Initial page render is not yet completed, delaying refresh of workflow template instances.");return e}())return null===(e=(0,n().S)())||void 0===e?void 0:e.getSpaceId()}),[]);(0,u().Yb)((async()=>{if(!t)return;(m().A.debug||y)&&console.log("Refreshing workflow template instance map for space",t);const o={table:p().NX,id:t,spaceId:t},n=await d().callApi({eventName:"getWorkflowTemplateInstances",environment:e,data:{spaceId:o.spaceId,scopeTable:o.table,scopeId:o.id,enableInstanceRobustness:!0}});if("success"===n.type){const e=(0,c()._)(o);m().A.setState({...m().A.state,[e]:n.data.instanceMap[e]})}}),[e,t])}},239529:(e,t,o)=>{o.d(t,{S:()=>c,q:()=>s});o(898992),o(672577);var n=()=>o(381175),r=()=>o(436696),i=()=>o(492414),l=()=>o(246766),a=()=>o(999140);function s(e){const{environment:t,collectionContextStore:o,event:i,buttonPopupParent:s}=e,c=(0,a().t2)(o);if(!c)return null;const u=(0,n().V)(i);(0,l().navigate)({environment:t,url:c,openInNew:u}),u||null==s||s.close(),(0,r().X)({environment:t,collectionContextStore:o,action:"click_source_view"})}function c({environment:e,collectionStore:t,pageVisitSource:o,event:r}){var a;const s=t.getParentBlockStore();if(!s)return;const c=null===(a=s.getCollectionViewStores())||void 0===a?void 0:a.find((e=>{var o;return(null===(o=e.getCollectionStore())||void 0===o?void 0:o.id)===t.id})),u=(0,i().J8)({store:s,fullyQualified:!1,pageVisitSource:o,collectionViewId:null==c?void 0:c.id});(0,l().navigate)({environment:e,url:u,openInNew:(0,n().V)(r)})}},248662:(e,t,o)=>{o.d(t,{T:()=>d});var n=()=>o(584262),r=()=>o(281948),i=()=>o(37450),l=()=>o(766854),a=()=>o(665020),s=()=>o(635462),c=()=>o(390650),u=()=>o(999140);function p(e){const{blockId:t,collectionContextStore:o}=e,r=(0,s().s)(t),i=(0,a().W)(t),l=o.isInHomeWidgetStore.state;return i?l?n().y8.PersonalHomeTileCustomDbCreate:n().y8.PersonalHomeCustomDbCreate:r?l?n().y8.PersonalHomeTileTasksCreate:n().y8.PersonalHomeTasksCreate:n().y8.Create}function d(e){const{transaction:t,store:o,collectionContextStore:n,environment:a,shouldCoerce:s,templateStore:d,showMoveTo:g,peekModeOverride:m,from:y,isKeyboard:v}=e,f=(0,l().H)({environment:a,collectionContextStore:n,groupsPointer:[],insertAtIndex:0,shouldCoerce:s,templateStore:d,transaction:t,from:y,inMemoryRecordCache:a.defaultRecordCache.inMemoryRecordCache,isKeyboard:v});if(!f)return;const h=m??u().hH(n);r().VU({environment:a,store:f.newStore,peekMode:h,showMoveTo:g,resultsStore:void 0,collectionContextStore:n,pageVisitSource:p({blockId:o.id,collectionContextStore:n})});const S="collectionTypedView"===n.contextTypeFromStoreState?f.newStore.getAssociatedCollectionId():void 0;return i().vH(a,{from:y.createBlock,type:"page",new_page_id:f.newStore.id,creating_block_id:f.newStore.id,...c().sl(n,S)}),f.newStore}},271080:(e,t,o)=>{o.d(t,{p:()=>z});o(898992),o(581454),o(737550);var n=o(296540),r=()=>o(933922),i=()=>o(726637),l=()=>o(484714),a=()=>o(590526),s=()=>o(792057),c=()=>o(295633),u=()=>o(732810),p=()=>o(31511),d=()=>o(546926),g=()=>o(160432),m=()=>o(890492),y=()=>o(449279),v=()=>o(663639),f=()=>o(736847),h=()=>o(452004),S=()=>o(764880),x=()=>o(62371),C=()=>o(898244),b=()=>o(40457),k=()=>o(799829),A=()=>o(179034),w=()=>o(69708),j=()=>o(100622),I=()=>o(496603),T=()=>o(534177),M=()=>o(284371),_=()=>o(908201),V=()=>o(552604),B=()=>o(251126),P=()=>o(419357),G=()=>o(305390),F=()=>o(862139),R=()=>o(457688),K=()=>o(594794),L=()=>o(106628),O=()=>o(361330),E=o(474848);function z(e){const{onChange:t,currentGroups:o,groupBy:l,groupFormat:s,onClose:c,schema:u,parentStore:p}=e,[g,y]=(0,n.useState)(""),v=(0,a().uB)(void 0,h().$),f=(0,n.useCallback)((()=>{W({onChange:t,currentGroups:o,groupBy:l,groupFormat:s,inputValue:g,onClose:c})}),[o,l,s,g,t,c]);let S;return(0,n.useEffect)((()=>{var e;s&&("select"===s.value.type||"multi_select"===s.value.type)&&s.value.value?y(s.value.value):s&&"status"===s.value.type&&s.value.value&&"by_option"===s.value.value.type?y(s.value.value.option):s&&(0,x().kO)(s.value)&&"exact"===(null===(e=s.value.value)||void 0===e?void 0:e.type)&&y(s.value.value.value)}),[s]),S=i().A.isMobile?{menuType:d().gu.Modal,title:s?(0,E.jsx)(w().sA,{defaultMessage:"Rename group",id:"codeBlock.databaseEditGroupMenu.renameGroupTitle"}):(0,E.jsx)(w().sA,{defaultMessage:"Add a group",id:"codeBlock.databaseEditGroupMenu.addGroupTitle"}),left:(0,E.jsx)(w().sA,{defaultMessage:"Cancel",id:"codeBlock.databaseEditGroupMenu.cancelButton.label"}),right:(0,E.jsx)(w().sA,{defaultMessage:"Done",id:"codeBlock.databaseEditGroupMenu.doneButton.label"}),onClickRight:f,onClickLeft:c}:{menuType:d().gu.Popup,width:D(l)?300:240,maxHeight:"50vh"},(0,E.jsx)(r().A,{capture:!0,render:e=>(0,E.jsx)(m().A,{...S,...e,children:(0,E.jsx)(X,{groupBy:l,schema:u,onChange:t,currentGroups:o,groupFormat:s,onClose:c,parentStore:p,inputValue:g,setInputValue:y,menuListStore:v})})})}function N(){return(0,E.jsx)(w().sA,{defaultMessage:"Group already exists.",id:"database.groupExistsAlreadyError.message"})}function D(e){return"select"===e.type||"multi_select"===e.type||(0,x().Vs)(e.type)}function H({currentGroups:e,onChange:t,groupFormat:o,onClose:r,inputValue:i,menuListStore:s}){const c=(0,l().v3)(),u=(0,w().tz)(),p=(0,a().uB)(s,h().$),[d,g]=(0,n.useState)(i);return(0,E.jsx)(B().A,{request:d,performRequest:e=>async function(e,t,o){const n=await L().T.searchActions.load();return{users:await n.searchSpaceUsers({environment:t,query:e,membersOnly:!1,limit:20}),groups:n.searchSpaceGroups({query:e,intl:o,limit:20}),type:"notionUsersAndGroups"}}(e,c,u),debounce:O().tu,render:(n,i,l)=>{i||(i={users:[],groups:[]});const a=[...I().oE(i.users.map((n=>({key:n.id,render:e=>(0,E.jsx)(R().A,{actor:(0,S().A7)(n),...e}),action:()=>{U({table:"notion_user",id:n.id},o,e,t,r)}})))),...I().oE(i.groups.map((n=>({key:n.group_id,render:e=>(0,E.jsx)(F()._,{group:n,menuListItemProps:e}),action:()=>{U(n.getGroupPointer(),o,e,t,r)}}))))];let s;return s=l&&i&&0===a.length?(0,E.jsx)(f().A,{children:(0,E.jsx)(y().u,{title:(0,E.jsx)(w().sA,{defaultMessage:"No results",id:"database.noPersonSearchResults.message"})})}):(0,E.jsx)(v().A,{type:v().O.Vertical,initialFocus:0,sections:[{key:0,render:e=>(0,E.jsx)(f().A,{...e}),items:a}],store:p}),(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(f().A,{children:(0,E.jsx)(P().Ay,{value:d,focus:!0,placeholder:u.formatMessage({defaultMessage:"Search for a person or group…",id:"database.searchPersonOrGroups.placeholder"}),onChange:e=>{g(e.target.value),p.setState({...p.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})}})}),s]})}})}function U(e,t,o,n,r){const i={type:"person",value:e};return t&&I().n4(i,t.value)?(null==r||r(),null):o.some((e=>(0,x().OF)(i,e.value)))?(s().f1((0,E.jsx)(N,{})),null):void n({newGroupValue:i})}function $(e,t,o,n,r,i){const l=o[n.property];if(!l||"relation"!==l.type)return null;const a=C().Nv(l);if(!a)return null;const s=u().m.createChildStore(t,a);return s.isDefined()&&i.length>0?{key:"new-page",render:e=>(0,E.jsx)(V().A,{targetCollectionStore:s,pageName:i,...e}),action:()=>{const t=(0,K().Z1)({environment:e,table:A().ev,spaceId:s.getSpaceId()}),o={table:A().ev,id:t,spaceId:s.getSpaceId()};r({newGroupValue:{type:"relation",value:o},newPage:{id:o.id,spaceId:o.spaceId,name:i}})}}:null}function W({onChange:e,currentGroups:t,groupBy:o,groupFormat:n,inputValue:r,onClose:i}){const l=r.trim().replace(/,/g,"");let a;"select"===o.type||"multi_select"===o.type?a={type:o.type,value:l}:"status"===o.type?a=function(e){const{groupFormat:t,value:o}=e;if("status"===(null==t?void 0:t.value.type)&&t.value.value&&"by_option"===t.value.value.type)return{type:"status",value:{type:"by_option",option:o}}}({groupFormat:n,value:l}):(0,x().Vh)(o)&&(a={type:o.type,value:{type:"exact",value:l}}),a&&l?n&&I().n4(a,n.value)?null==i||i():t.some((e=>a&&(0,x().OF)(a,e.value)))?s().f1((0,E.jsx)(N,{})):e({newGroupValue:a}):null==i||i()}function q(e,t,o,n,r,i,l,a,p){const d=null==p?void 0:p.relativeVariableStore.state,g=d&&d[t.id],m=(e,o)=>{const r=u().m.createChildStore(n,t);if(!r.isDefined())return;const i=r.getFormat().app_config_uri;return i&&o?e.formatMessage(k().n$[i][o].messageDescriptor):void 0};return e.map((e=>{const t=c().B.createChildStore(n,e);if(t.isTemplate())return;const u=g?(0,k().cE)(t.id,g):void 0;return{key:t.id,render:e=>(0,E.jsx)(G().A,{store:t,titlePrefix:m(r,u),...e}),action:()=>{let t={type:"relation",value:e};u&&(t={type:"relation",value:{type:"relative",value:{type:"builtin",variable:u}}}),l&&I().n4(t,l.value)?null==a||a():o.some((e=>(0,x().OF)(t,e.value)))?s().f1((0,E.jsx)(N,{})):i({newGroupValue:t})}}}))}function Q({onChange:e,currentGroups:t,groupBy:o,groupFormat:r,onClose:i,inputValue:a,setInputValue:s,menuListStore:c}){const u=(0,w().tz)(),d=(0,n.useCallback)((()=>W({onChange:e,currentGroups:t,groupBy:o,groupFormat:r,inputValue:a,onClose:i})),[e,t,o,r,a,i]),m=(0,n.useCallback)((n=>function(e,t,o,n,r,i,l){13===e.keyCode?W({onChange:t,currentGroups:o,groupBy:n,groupFormat:r,inputValue:i,onClose:l}):27===e.keyCode&&(null==l||l())}(n,e,t,o,r,a,i)),[e,t,o,r,a,i]),y=(0,n.useCallback)((e=>function(e,t,o){t(e.target.value),o.setState({...o.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})}(e,s,c)),[c,s]),v=(0,l().WS)(),h=r?u.formatMessage({id:"database.collectionEditGroupMenu.renameGroupLabel.placeholder",defaultMessage:"Rename group"}):u.formatMessage({id:"database.collectionEditGroupMenu.newGroupLabel.placeholder",defaultMessage:"New group"});return v?(0,E.jsx)(f().A,{children:(0,E.jsx)(P().Ay,{value:a,focus:!0,selectAll:!0,showClearButton:!1,focusInitial:!0,placeholder:h,onChange:y,onKeyDown:m})}):(0,E.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:6,width:"100%",background:j().Tj.inputBackground},children:[(0,E.jsx)(p().A,{value:a,focus:!0,selectAll:!0,focusInitial:!0,placeholder:h,onChange:y,onKeyDown:m,format:"transparent",style:{fontSize:M().J.UIRegular.desktop}}),(0,E.jsx)(g().A,{colorPalette:"blue",size:"sm",onClick:d,iconTrailing:b().arrowTurnDownLeftSmallIcon,children:(0,E.jsx)(w().sA,{defaultMessage:"Done",id:"database.collectionEditGroupMenu.submitButton.label"})})]})}function Z({parentStore:e,schema:t,groupBy:o,currentGroups:r,onChange:i,groupFormat:s,onClose:c,inputValue:p,setInputValue:d,menuListStore:g}){const m=(0,l().v3)(),y=(0,n.useMemo)((()=>{const e=t[o.property];return!(!e||"relation"!==e.type)&&C().Nv(e)}),[o.property,t]);return(0,a().K8)((()=>{if(!y)return!1;return u().m.createChildStore(e,y).isDefined()}),[y,e])&&y?(0,E.jsx)(B().A,{request:p,performRequest:n=>async function(e,t,o,n,r){const i=o[t.property];if(!i||!(0,C().nC)(i))return;const l=C().Nv(i);if(!l)return;const a=u().m.createChildStore(n,l);if(await a.load(),!a.isDefined())return;const s=a.getSpaceId(),c=await L().T.searchActions.load();return(await c.searchPagesInCollection({environment:r,query:e,collectionId:l.id,spaceId:s,excludeTemplates:!0,source:"collection_group_value",limit:20,includePublicPagesWithoutExplicitAccess:!0,boostRecentlyViewedPages:!1})).results.map((e=>({table:A().ev,id:e,spaceId:s})))}(n,o,t,e,m),debounce:O().tu,render:(n,l=[],a)=>(0,E.jsx)(Y,{ready:a,results:l,parentStore:e,schema:t,groupBy:o,currentGroups:r,onChange:i,groupFormat:s,onClose:c,inputValue:p,setInputValue:d,menuListStore:g,collectionPointer:y,environment:m})}):null}function Y({parentStore:e,schema:t,groupBy:o,currentGroups:r,onChange:i,groupFormat:l,onClose:s,inputValue:c,setInputValue:u,menuListStore:p,results:d,ready:g,collectionPointer:m,environment:h}){const S=(0,w().tz)(),x=(0,n.useContext)(_().p2),C=(0,a().K8)((()=>I().oE([...q(d,m,r,e,S,i,l,s,x),$(h,e,t,o,i,c)])),[h,x,m,r,o,l,c,S,i,s,e,d,t]);let b;return b=g&&d&&0===C.length?(0,E.jsx)(f().A,{children:(0,E.jsx)(y().u,{title:(0,E.jsx)(w().sA,{defaultMessage:"No results",id:"database.noRelationSearchResults.message"})})}):(0,E.jsx)(v().A,{type:v().O.Vertical,initialFocus:0,sections:[{key:0,render:e=>(0,E.jsx)(f().A,{...e}),items:C}],store:p}),(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(f().A,{children:(0,E.jsx)(P().Ay,{value:c,focus:!0,placeholder:S.formatMessage({defaultMessage:"Type to search...",id:"database.searchRelation.placeholder"}),onChange:e=>{u(e.target.value),p.setState({...p.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})}})}),b]})}function X({groupBy:e,schema:t,onChange:o,currentGroups:n,groupFormat:r,onClose:i,parentStore:l,inputValue:a,setInputValue:s,menuListStore:c}){var u;if(!t[e.property])return null;const p="status"===e.type&&"status"===(null==r?void 0:r.value.type)&&"by_option"===(null===(u=r.value.value)||void 0===u?void 0:u.type);return"select"===e.type||"multi_select"===e.type||p?(0,E.jsx)(Q,{onChange:o,currentGroups:n,groupBy:e,groupFormat:r,onClose:i,inputValue:a,setInputValue:s,menuListStore:c}):"person"===e.type?(0,E.jsx)(H,{currentGroups:n,onChange:o,groupFormat:r,onClose:i,inputValue:a,menuListStore:c}):"relation"===e.type?(0,E.jsx)(Z,{parentStore:l,schema:t,groupBy:e,currentGroups:n,onChange:o,groupFormat:r,onClose:i,inputValue:a,setInputValue:s,menuListStore:c}):(0,x().Vs)(e.type)?(0,E.jsx)(Q,{onChange:o,currentGroups:n,groupBy:e,groupFormat:r,onClose:i,inputValue:a,setInputValue:s,menuListStore:c}):"number"===e.type||"status"===e.type||"date"===e.type||"formula"===e.type||"checkbox"===e.type||"created_time"===e.type||"last_edited_time"===e.type||"created_by"===e.type||"last_edited_by"===e.type||"last_visited_time"===e.type||"location"===e.type?null:void(0,T().HB)(e.type)}},274375:(e,t,o)=>{o.d(t,{Q:()=>r});o(898992),o(354520),o(672577);var n=()=>o(898244);function r(e,t){const o={property:n().rn,visible:!0,width:276},r={property:t,visible:!0},i=[o,r],l=e.getCollectionViewStores().find((e=>"table"===e.getType())),a=null==l?void 0:l.getFormatStore().getKeyStore("table_properties").getValue();if(!l||!a||0===a.length)return i;const s=a.find((e=>e.property===n().rn))??o;return[s,a.find((e=>e.property===t))??r,...a.filter((e=>e.property!==n().rn&&e.property!==t))]}},278094:(e,t,o)=>{o.d(t,{y:()=>l});var n=()=>o(62371),r=()=>o(436696),i=()=>o(896628);function l(e){const{environment:t,collectionContextStore:o,transaction:l,groupByKey:a,groupsFormatKey:s,sortType:c}=e;if("chart_config"===a)return;const u=(0,n().H2)(o.normalizedFormatStore.state,a,s),p=o.collectionViewStore();if(!u||!p)return;if((0,n().Nf)(u).includes(c)){if("formula"===u.type){const e={...u,groupBy:{...u.groupBy,sort:{type:c}}};i().zA({stores:[p],update:{[a]:e},transaction:l})}else i().zA({stores:[p],update:{[a]:{...u,sort:{type:c}}},transaction:l});(0,r().X)({environment:t,collectionContextStore:o,action:"update_group_sort"})}}},287940:(e,t,o)=>{o.d(t,{A:()=>B});var n=o(296540),r=()=>o(955450),i=()=>o(484714),l=()=>o(590526),a=()=>o(543906),s=()=>o(365917),c=()=>o(807449),u=()=>o(406094),p=()=>o(761940),d=()=>o(8741),g=()=>o(69708),m=()=>o(497222),y=()=>o(300789),v=()=>o(131448),f=()=>o(712505),h=()=>o(404141),S=()=>o(205379),x=()=>o(637096),C=()=>o(395198),b=()=>o(401497),k=()=>o(148297),A=()=>o(718827),w=()=>o(100622),j=o(474848);const I=(0,g().YK)({defaultTitle:{id:"openInNotionCalendarOnboardingTooltip.header",defaultMessage:"Get Notion Calendar"},defaultContent:{id:"openInNotionCalendarOnboardingTooltip.content",defaultMessage:"View any Notion database with calendar and timeline views with your Google Calendar events"},connectCalendarTitle:{id:"openInNotionCalendarOnboardingTooltip.connectCalendarTitle",defaultMessage:"Connect Calendar"},successTitle:{id:"openInNotionCalendarOnboardingTooltip.success.header",defaultMessage:"Successfully connected"},successContent:{id:"openInNotionCalendarOnboardingTooltip.success.content",defaultMessage:"You can now view any database with calendar and timeline views in Notion Calendar"}});function T({variant:e,origin:t,onCloseClick:o,onConnectCalendarClick:n}){const r=(0,b().IS)((()=>({tooltip:{width:233},content:{opacity:1},contentInner:{display:"flex",flexDirection:"column",gap:14},contentMessage:{opacity:.8,color:w().Tj.text.inversePrimary},footer:{display:"flex",alignItems:"center",gap:12},primaryButton:{display:"flex",alignItems:"center",height:24,padding:"0 12px",marginInlineStart:"auto",borderRadius:4,background:"#FFF",color:"#1D1B16",fontSize:12,fontWeight:500,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},primaryButtonHover:{background:"rgba(255,255,255,0.9)"},primaryButtonPressed:{background:"rgba(255,255,255,0.8)"}})),[]);return(0,j.jsx)(k().k,{origin:t,placementToOrigin:"bottom",header:(0,j.jsx)(g().sA,{..."success"===e?I.successTitle:I.defaultTitle}),content:(0,j.jsxs)("div",{style:r.contentInner,children:[(0,j.jsx)("div",{style:r.contentMessage,children:(0,j.jsx)(g().sA,{..."success"===e?I.successContent:I.defaultContent})}),"default"===e?(0,j.jsx)("div",{style:r.footer,children:(0,j.jsx)(A().Ay,{style:r.primaryButton,hoveredStyle:r.primaryButtonHover,pressedStyle:r.primaryButtonPressed,onClick:n,children:(0,j.jsx)(g().sA,{...I.connectCalendarTitle})})}):void 0]}),contentStyle:r.content,onCloseClick:o,shouldDismissUponOutsideClick:!1,enableMouseCapture:!1,pointerPosition:"33%",style:{...r.tooltip}})}function M({collectionContextStore:e,entrypoint:t}){const o=(0,i().v3)(),n=(0,l().O$)(s().X),r=(0,l().K8)((()=>v().default.isVisible("open_in_calendar_tooltip")),[]),c=(0,l().K8)((()=>{const t=h().Ay.state.open||e.settingsStore.state.open,o=e.isFullScreenStore.state,n=f().default.state.open;return o&&!t&&!n&&s().A.state.loaded}),[e]);(0,a().A)((()=>{y().HH(o,"open_in_calendar_tooltip")}),c);const u=(0,x().W)({collectionContextStore:e,entrypoint:t});switch(t){case"calendar_view":case"timeline_view":return(0,j.jsx)(_,{showTooltip:r,hasConnectedCalendar:n,openNotionCalendar:u});case"view_settings":return(0,j.jsx)(V,{openNotionCalendar:u})}}function _(e){const{showTooltip:t,hasConnectedCalendar:o,openNotionCalendar:r}=e,l=(0,i().v3)(),a=(0,n.useRef)(null),[s,c]=(0,n.useState)(!1),d=(0,n.useCallback)((()=>{y().a(l,"open_in_calendar_tooltip")}),[l]),m=(0,S().N)(),v=(0,n.useCallback)((()=>{c(!0),r()}),[r]);return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(u().A,{size:"sm",ref:a,onClick:r,iconLeading:m,children:(0,j.jsx)(g().sA,{...p().PQ.manageInCalendar})}),t?(0,j.jsx)(T,{variant:s||o?"success":"default",origin:a,onCloseClick:d,onConnectCalendarClick:v}):void 0]})}function V(e){const{openNotionCalendar:t}=e;return(0,j.jsx)(m().A,{showChevron:!1,icon:()=>(0,j.jsx)(C().y,{colorVariant:"primary"}),onClick:()=>t(),right:(0,j.jsx)(c().I,{icon:d().arrowDiagonalUpRightSmallIcon,size:"sm",colorVariant:"tertiary"}),title:(0,j.jsx)(g().sA,{...p().PQ.manageInCalendar})})}function B(e){return(0,r().K)({collectionContextStore:e.collectionContextStore})?(0,j.jsx)(M,{...e}):null}},323550:(e,t,o)=>{o.d(t,{A:()=>l});o(296540);var n=()=>o(378518);o(944114),o(898992),o(908872);var r=o(474848);const i=16;function l(e){const{startPoint:t,endPoint:o,style:i,showArrowHead:l,useRightAngles:c,cornerRadiusOverride:u,handleMouseMove:p,handleMouseLeave:d}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s,{startPoint:t,startCurvePoint:c?void 0:{x:t.x+n().g_,y:t.y},endPoint:l?{x:o.x-1.5,y:o.y}:o,endCurvePoint:c?void 0:{x:o.x-n().g_,y:o.y},cornerRadiusOverride:u,style:i,handleMouseMove:p,handleMouseLeave:d,children:e.children}),l?(0,r.jsx)(a,{endPoint:o,style:i}):void 0]})}function a(e){const{endPoint:t,style:o}=e;return(0,r.jsx)("polyline",{points:`${t.x-5},${t.y-6} ${t.x},${t.y} ${t.x-5},${t.y+6}`,style:o,fill:"transparent"})}function s(e){const{startPoint:t,startCurvePoint:o,endPoint:n,endCurvePoint:l,style:a,cornerRadiusOverride:s,handleMouseMove:c,handleMouseLeave:u}=e;let p="";p=o&&l?`M ${t.x} ${t.y} L ${o.x} ${o.y} L ${l.x} ${l.y} L ${n.x} ${n.y}`:`M ${t.x} ${t.y} L ${t.x} ${n.y} L ${n.x} ${n.y}`;const d=function(e,t){function o(e,t,o){const r=t.x-e.x,i=t.y-e.y,l=Math.sqrt(r*r+i*i);return n(e,t,Math.min(1,o/l))}function n(e,t,o){return{x:e.x+(t.x-e.x)*o,y:e.y+(t.y-e.y)*o}}function r(e,t){e.length>2&&(e[e.length-2]=t.x.toString(),e[e.length-1]=t.y.toString())}function i(e){return{x:parseFloat(e[e.length-2]),y:parseFloat(e[e.length-1])}}const l=e.split(/[,\s]/).reduce(((e,t)=>{const o=t.match("([a-zA-Z])(.+)");return o?(e.push(o[1]),e.push(o[2])):e.push(t),e}),[]).reduce((function(e,t){return!isNaN(parseFloat(t))&&e.length?e[e.length-1].push(t):e.push([t]),e}),[]);let a=[];if(l.length>1){const e=i(l[0]);let s=null;"Z"===l[l.length-1][0]&&l[0].length>2&&(s=["L",e.x.toString(),e.y.toString()],l[l.length-1]=s),a.push(l[0]);for(let c=1;c<l.length;c++){const e=a[a.length-1],u=l[c],p=u===s?l[1]:l[c+1];if(p&&e&&e.length>2&&"L"===u[0]&&p.length>2&&"L"===p[0]){const l=i(e),s=i(u),c=i(p),d=o(s,l,t),g=o(s,c,t);r(u,d),a.push(u);const m=n(d,s,.5),y=n(s,g,.5),v=["C",m.x.toString(),m.y.toString(),y.x.toString(),y.y.toString(),g.x.toString(),g.y.toString()];a.push(v)}else a.push(u)}if(s){const e=i(a[a.length-1]);a.push(["Z"]),r(a[0],e)}}else a=l;return a.reduce((function(e,t){return`${e}${t.join(" ")} `}),"")}(p,s||i);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{d,style:a,fill:"transparent"}),c||u?(0,r.jsxs)("g",{onMouseMove:c,onMouseLeave:u,children:[(0,r.jsx)("path",{d,style:{strokeOpacity:0,strokeWidth:16,pointerEvents:"stroke",cursor:"default"},fill:"transparent"}),e.children]}):void 0]})}},330863:(e,t,o)=>{o.d(t,{i:()=>l});var n=o(296540),r=()=>o(388832),i=()=>o(595917);function l(e,t){const o=(0,i().a)(e);return{getWorkflowsForProperty:(0,n.useCallback)((n=>{if(o.error||!o.value||!e||!t)return[];const i=e.getParentCollectionViewBlockStore();return i?(0,r().gY)({workflowsData:o.value,collectionViewBlockStore:i,currentCollectionStore:e,property:n,spaceId:t}):[]}),[o,e,t])}}},330918:(e,t,o)=>{o.d(t,{d:()=>q});o(898992),o(672577);var n=o(296540),r=()=>o(907258),i=()=>o(726637),l=()=>o(484714),a=()=>o(590526),s=()=>o(401497),c=()=>o(295633),u=()=>o(732810),p=()=>o(718827),d=()=>o(996332),g=()=>o(250910),m=()=>o(420802),y=()=>o(26697),v=()=>o(764880),f=()=>o(584262),h=()=>o(62371),S=()=>o(898244),x=()=>o(713998),C=()=>o(784892),b=()=>o(72135),k=()=>o(799829),A=()=>o(437607),w=()=>o(69708),j=()=>o(534177),I=()=>o(284371),T=()=>o(374562),M=()=>o(554548),_=()=>o(339798),V=()=>o(480912),B=()=>o(999140),P=()=>o(187820),G=()=>o(16006),F=()=>o(448693),R=()=>o(27356),K=()=>o(399762),L=()=>o(106412),O=()=>o(635462),E=()=>o(492414),z=()=>o(58357),N=()=>o(442025),D=()=>o(934201),H=()=>o(271080),U=o(474848);const $=Object.freeze({overflow:"hidden",padding:3,borderRadius:6,fontWeight:I().Wy.medium}),W=Object.freeze({overflow:"hidden",padding:3,marginInlineEnd:3,borderRadius:6,fontWeight:I().Wy.medium}),q=n.memo((function(e){const{schema:t,groupFormat:n,collectionContextStore:r,isHiddenGroup:i,style:l,uncategorizedIconStyle:s,currentGroups:c,groupBy:u,onChange:p,onClose:d,disabled:g,source:m}=e,y=(0,a().uB)(void 0,o(118307).A),v=(0,a().K8)((()=>{const e=r.groupsStore.getGroupState(n);return null==e?void 0:e.groupUiParentStore}),[r,n]),f=(0,a().K8)((()=>{const e=t[n.property];if(e&&(0,S().nC)(e)&&v)return(0,o(113105).LQ)(e,v)}),[t,n,v]),h=t[n.property];if(!h)return null;const x=n.value;if(void 0===x.value)return(0,U.jsx)(ie,{groupFormat:n,schema:t,isHiddenGroup:i,collectionContextStore:r,style:l,uncategorizedIconStyle:s,parentStore:v});if("formula"===x.type){if("formula"!==x.type)return null;const e=x.value;return e?(0,U.jsx)(Q,{schema:t,currentGroups:c,groupBy:u,groupFormat:n,onChange:p,onClose:d,disabled:g,style:l,isHiddenGroup:i,collectionContextStore:r,buttonPopupStore:y,parentStore:v,relatedCollectionAppConfigUri:f,groupValue:e,propertySchema:h,source:m}):null}return(0,U.jsx)(Q,{schema:t,currentGroups:c,groupBy:u,groupFormat:n,onChange:p,onClose:d,disabled:g,style:l,isHiddenGroup:i,collectionContextStore:r,buttonPopupStore:y,parentStore:v,relatedCollectionAppConfigUri:f,groupValue:x,propertySchema:h,source:m})}));function Q(e){const{groupValue:t,propertySchema:o,schema:n,currentGroups:r,groupBy:i,groupFormat:l,onChange:a,onClose:s,disabled:c,style:u,isHiddenGroup:p,collectionContextStore:d,buttonPopupStore:g,parentStore:m,relatedCollectionAppConfigUri:y}=e;return"select"===t.type||"multi_select"===t.type?(0,U.jsx)(pe,{schema:n,currentGroups:r,groupBy:i,groupFormat:l,onChange:a,onClose:s,disabled:c,style:u,buttonPopupStore:g,parentStore:m}):"status"===t.type?(0,U.jsx)(J,{schema:n,currentGroups:r,groupBy:i,groupFormat:l,onChange:a,onClose:s,disabled:c,buttonPopupStore:g,parentStore:m}):(0,h().r4)(t.type)?(0,U.jsx)(de,{schema:n,currentGroups:r,groupBy:i,groupFormat:l,onChange:a,onClose:s,disabled:c,style:u,isHiddenGroup:p,buttonPopupStore:g,parentStore:m,collectionContextStore:d,groupValue:t}):"relation"===t.type?(0,U.jsx)(ae,{schema:n,groupFormat:l,collectionContextStore:d,style:u,parentStore:m,relatedCollectionAppConfigUri:y,groupValue:t}):"location"===t.type?(0,U.jsx)(le,{style:u,collectionContextStore:d,parentStore:m,groupValue:t}):(0,h()._o)(t.type)?(0,U.jsx)(ne,{style:u,groupValue:t}):(0,h().Vs)(t.type)?(0,U.jsx)(ge,{schema:n,currentGroups:r,groupBy:i,groupFormat:l,onChange:a,onClose:s,disabled:c,style:u,buttonPopupStore:g,parentStore:m,groupValue:t}):"number"===t.type?(0,U.jsx)(re,{style:u,groupValue:t,propertySchema:"number"===o.type?o:void 0}):"checkbox"===t.type?(0,U.jsx)(oe,{style:u,propertySchema:o,groupValue:t}):void(0,j().HB)(t.type)}function Z(e){const{isHiddenGroup:t}=e,o=(0,n.useCallback)((()=>(0,U.jsx)(w().sA,{id:"database.boardView.uncategorizedColumnTooltip",defaultMessage:"Any items with an empty <b>{name}</b> property will go here. This group cannot be removed.",values:{name:null,b:e=>(0,U.jsx)("span",{style:{fontWeight:I().Wy.semibold},children:e})}})),[]),r=(0,n.useCallback)((t=>(0,U.jsx)(Y,{...e,tooltipEvents:t})),[e]),i=(0,s().IS)((()=>({container:{width:240}})),[]);return t?(0,U.jsx)(Y,{...e,tooltipEvents:void 0}):(0,U.jsx)(y().m,{renderTooltip:o,render:r,style:i.container,textWrap:!0})}function Y(e){const{style:t,tooltipEvents:o,formattedLabelMessage:n}=e,r=(0,s().IS)((()=>({container:{display:"flex",alignItems:"center",lineHeight:1.2,paddingInlineEnd:4,whiteSpace:"nowrap",overflow:"hidden",fontWeight:I().Wy.medium,paddingInlineStart:0,...t},text:{marginInlineStart:4,...I().RC}})),[t]);return(0,U.jsx)("div",{style:r.container,...o,children:(0,U.jsx)("span",{style:r.text,children:n})})}function X(e){const{value:t}=e;return"other"===t.type?(0,U.jsx)(w().sA,{defaultMessage:"Other",id:"database.collectionGroupValue.textGroup.otherValue"}):"alphabet_prefix"===t.type||"exact"===t.type?(0,U.jsx)(U.Fragment,{children:t.value}):void(0,j().HB)(t)}function J(e){var t;const{schema:o,currentGroups:r,groupBy:l,groupFormat:a,onChange:c,onClose:u,disabled:d,buttonPopupStore:m,parentStore:y}=e,v=(0,s().IS)((()=>({button:{overflow:"hidden",padding:3,borderRadius:6},name:{fontWeight:500}})),[]),f=(0,n.useCallback)((e=>{const t=o[a.property];if(!t||"status"!==t.type)return null;const n=a.value;if(n.type!==t.type)return null;const{value:r}=n;if(!r)return null;const i=t.options??[],l=t.groups??[];if("by_group"===r.type){const t=l.find((e=>e.name===r.group));return t?(0,U.jsx)(p().Ay,{style:v.button,disabled:d,...e,children:(0,U.jsx)(V().RS,{group:t,style:v.name,showIcon:!0,showColor:!0})}):null}if("by_option"===r.type){const t=(0,x().jy)(i,r.option),o=t&&l.find((e=>{var o;return null===(o=e.optionIds)||void 0===o?void 0:o.includes(t.id)}));return t?(0,U.jsx)(p().Ay,{style:v.button,disabled:d,...e,children:(0,U.jsx)(K().q,{format:C().NY.Medium,isSingle:!0,value:t.value,color:t.color,showRemoveButton:!1,groupColor:null==o?void 0:o.color})}):null}(0,j().HB)(r)}),[d,a.property,a.value,o,v.button,v.name]),h=(0,n.useCallback)((()=>(0,U.jsx)(ue,{schema:o,currentGroups:r,groupBy:l,groupFormat:a,onChange:c,onClose:u,buttonPopupStore:m,parentStore:y})),[o,r,l,a,c,u,m,y]),S=a.value,b="status"===S.type&&"by_option"===(null===(t=S.value)||void 0===t?void 0:t.type)&&!d;return(0,U.jsx)(g().A,{render:h,renderOrigin:f,disabled:!b,buttonPopupStore:m,popupType:i().A.isMobile?g().z.BottomSheet:g().z.Popup,originGap:4})}function ee(e){const{value:t}=e,o=(0,w().tz)();return(0,U.jsx)(U.Fragment,{children:(0,D().nc)({intl:o,value:t})})}function te(e){const{value:t,format:o}=e,n=(0,w().tz)();return(0,U.jsx)(U.Fragment,{children:(0,D()._T)({intl:n,value:t,format:o})})}function oe(e){const{groupValue:t,propertySchema:o,style:n}=e,r=(0,s().IS)((()=>({container:{...I().RC,fontWeight:I().Wy.medium,marginInlineEnd:3,display:"flex",alignItems:"center",...n},checkboxStyle:{display:"inline-flex",marginInlineEnd:6}})),[n]);return"checkbox"!==t.type?null:(0,U.jsxs)("div",{style:r.container,children:[(0,U.jsx)(m().S,{checked:t.value,size:14,disabled:!0,style:r.checkboxStyle}),(0,U.jsx)("span",{children:null==o?void 0:o.name})]})}function ne(e){const{groupValue:t,style:o}=e,n=(0,s().IS)((()=>({container:{...W,...I().RC,...o}})),[o]);return t.value&&(0,h().DH)(t)?(0,U.jsx)("div",{style:n.container,children:(0,U.jsx)(ee,{value:t.value})}):null}function re({groupValue:e,propertySchema:t,style:o}){const n=(0,s().IS)((()=>({container:{...W,...o}})),[o]);if("number"!==e.type||!e.value)return null;const r=(null==t?void 0:t.number_format)||b().C4;return(0,U.jsx)("div",{style:n.container,children:(0,U.jsx)(te,{value:e.value,format:r})})}function ie(e){const{groupFormat:t,schema:o,isHiddenGroup:n,collectionContextStore:r,style:i,uncategorizedIconStyle:l,parentStore:s}=e,c=o[t.property],u=(0,a().K8)((()=>r.collectionStore()),[r]),p=(0,a().K8)((()=>!!(null!=u&&u.isDefined()&&c&&(0,S().nC)(c)&&s)&&(0,N().Vu)({collectionStore:u,property:t.property,propertySchema:c,parentStore:s})),[u,t,c,s]);return c?p?(0,U.jsx)(Z,{style:i,uncategorizedIconStyle:l,isHiddenGroup:n,formattedLabelMessage:(0,U.jsx)(w().sA,{...N().zX.sprintUncategorizedGroup,values:{name:c.name}})}):(0,U.jsx)(Z,{style:i,uncategorizedIconStyle:l,isHiddenGroup:n,formattedLabelMessage:(0,U.jsx)(w().sA,{...D().K0.emptyGroupLabel,values:{name:c.name}})}):null}function le(e){const{style:t,collectionContextStore:o,groupValue:r,parentStore:i}=e,l=(0,L().Zp)(),c=(0,a().K8)((()=>{var e;return null===(e=o.collectionViewBlockStore())||void 0===e?void 0:e.id}),[o]),p=(0,n.useMemo)((()=>i&&"location"===r.type&&r.value?u().m.createChildStore(i,r.value):void 0),[i,r.type,r.value]),g=(0,a().K8)((()=>null==p?void 0:p.getParentBlockStore()),[p]),m=(0,a().K8)((()=>c&&(0,O().s)(c)?o.isInHomeWidgetStore.state?f().y8.PersonalHomeTileTasks:f().y8.PersonalHomePageTasks:f().y8.LocationProperty),[c,o]),y=(0,a().K8)((()=>g?(0,E().Ay)({store:g,fullyQualified:!1,pageVisitSource:m}):void 0),[g,m]),v=(0,a().K8)((()=>null==p?void 0:p.getIcon()),[p]),h=(0,s().IS)((()=>({container:{...t,display:"flex"},icon:{marginTop:2,marginInlineEnd:6},title:{fontWeight:I().Wy.medium}})),[t]);return"location"===r.type&&r.value&&i&&p?(0,U.jsxs)(d().Q,{href:y,style:h.container,ignoreLocalHoverState:!0,disabled:null==l?void 0:l.disablePageLinks,children:[(0,U.jsx)(P().B6,{disabled:!0,icon:v,iconRecordCategory:"collection",size:20,isEmptyPage:!1,style:h.icon}),(0,U.jsx)(G().A,{store:p,underline:!0,style:h.title})]}):null}function ae(e){const{groupValue:t,schema:o,groupFormat:r,collectionContextStore:i,style:l,parentStore:s,relatedCollectionAppConfigUri:c}=e,p=o[r.property],d=(0,n.useMemo)((()=>p&&"relation"===p.type?S().Nv(p):void 0),[p]),g=(0,n.useMemo)((()=>s&&d?u().m.createChildStore(s,d):void 0),[s,d]),m=(0,a().K8)((()=>null==g?void 0:g.isDefined()),[g]);return s&&"relation"===t.type&&p&&"relation"===p.type&&d&&g&&t.value?(0,h().zx)(t.value)?c&&m?(0,U.jsx)(se,{relatedCollectionAppUri:c,groupValueInner:t.value,collectionContextStore:i,collectionPointer:d,targetCollectionStore:g,parentStore:s,style:l}):null:(0,h().WO)(t.value)?(0,U.jsx)(ce,{parentStore:s,groupValueInner:t.value,collectionContextStore:i}):null:null}function se(e){var t;const{relatedCollectionAppUri:o,groupValueInner:i,collectionContextStore:c,collectionPointer:u,targetCollectionStore:p,parentStore:g,style:m}=e,y=(0,w().tz)(),v=(0,l().v3)(),h=(0,L().Zp)(),S=i.value.variable,x=(0,a().K8)((()=>p.isDefined()),[p]),C=(0,a().K8)((()=>(0,z().ax)(c,S,u,p)),[c,S,u,p]),b=(0,a().O$)(r().AppStoreMainEditorCurrentBlockStore),A=(0,a().K8)((()=>C?(0,E().Ay)({store:C,pageVisitSource:f().y8.LinkInPage}):void 0),[C]),V=(0,a().K8)((()=>C?B().wy({environment:v,store:C,mainEditorCurrentBlockStore:b,collectionContextStore:c})??(0,E().Ay)({store:C,pageVisitSource:f().y8.LinkInPage}):void 0),[v,C,b,c]);let P;"current"===S?P=y.formatMessage(T().DZ.tasksCurrentSprintV2ViewNamePrefix):"next"===S?P=y.formatMessage(T().DZ.tasksNextSprintV2ViewNamePrefix):"last"===S?P=y.formatMessage(T().DZ.tasksLastSprintV2ViewNamePrefix):(0,j().HB)(S);const G=null===(t=k().n$[o])||void 0===t?void 0:t[S],R=(0,s().IS)((()=>({noPageStoreContainer:{fontWeight:I().Wy.medium},pageStoreContainer:{display:"flex",alignItems:"center"},text:{fontWeight:I().Wy.medium,marginBottom:.25},linkContainer:{...m,marginInlineStart:1}})),[m]),K=(0,n.useCallback)((e=>{if(A&&(e.ctrlKey||e.metaKey))return e.preventDefault(),void window.open(A,"_blank");_().os({collectionSettingsStore:c.settingsStore})}),[c.settingsStore,A]);if(x){if(!C)return(0,U.jsx)("div",{style:R.noPageStoreContainer,children:(0,U.jsx)(w().sA,{...null==G?void 0:G.messageDescriptor})});if(C)return(0,U.jsxs)("div",{style:R.pageStoreContainer,children:[(0,U.jsxs)("div",{style:R.text,children:[P,":"]}),(0,U.jsx)(d().Q,{style:R.linkContainer,innerStyle:W,href:V,onClick:K,disabled:null==h?void 0:h.disablePageLinks,children:(0,U.jsx)(M().A,{format:F().Ay.Format.Medium,blockId:C.id,isSingle:!0,shouldShrink:!0,parentStore:g,disableLinks:!0})})]})}return(0,U.jsx)("div",{style:R.text,children:(0,U.jsx)(w().sA,{...null==G?void 0:G.messageDescriptor})})}function ce(e){const{parentStore:t,groupValueInner:o,collectionContextStore:i,style:s}=e,u=(0,l().v3)(),p=(0,L().Zp)(),g=c().B.createChildStore(t,o),m=(0,a().O$)(r().AppStoreMainEditorCurrentBlockStore),y=(0,a().K8)((()=>B().wy({environment:u,store:g,mainEditorCurrentBlockStore:m,collectionContextStore:i})??(0,E().Ay)({store:g,pageVisitSource:f().y8.LinkInPage})),[u,g,m,i]),v=(0,a().K8)((()=>(0,E().Ay)({store:g,pageVisitSource:f().y8.LinkInPage})),[g]),h=(0,n.useCallback)((e=>{if(e.ctrlKey||e.metaKey)return e.preventDefault(),void window.open(v,"_blank");_().os({collectionSettingsStore:i.settingsStore})}),[i.settingsStore,v]);return(0,U.jsx)(d().Q,{style:s,innerStyle:W,href:y,onClick:h,disabled:null==p?void 0:p.disablePageLinks,children:(0,U.jsx)(M().A,{format:F().Ay.Format.Medium,blockId:o.id,isSingle:!0,shouldShrink:!0,parentStore:t,disableLinks:!0})})}function ue(e){const{schema:t,currentGroups:o,groupBy:r,groupFormat:i,onChange:l,onClose:a,buttonPopupStore:s,parentStore:c}=e,u=(0,n.useCallback)((e=>{s.reset(),null==l||l(e)}),[s,l]),p=(0,n.useCallback)((()=>{s.reset(),null==a||a()}),[s,a]);return c?(0,U.jsx)(H().p,{groupFormat:i,groupBy:r,currentGroups:o,schema:t,onChange:u,onClose:p,parentStore:c}):null}function pe(e){const{schema:t,currentGroups:o,groupBy:r,groupFormat:l,onChange:a,onClose:c,disabled:u,style:d,buttonPopupStore:m,parentStore:y}=e,v=(0,s().IS)((()=>({container:{...W,...d}})),[d]),f=(0,n.useCallback)((e=>{var o;const n=t[l.property];if(!n||!S().lx(n))return null;const r=l.value;if(null===(o=n.options)||void 0===o||!o.length||void 0===r.value||r.type!==n.type)return null;const i=(0,x().jy)(n.options,r.value);return i?(0,U.jsx)(p().Ay,{style:v.container,disabled:u,...e,children:(0,U.jsx)(K().O,{format:C().NY.Medium,isSingle:!0,value:i.value,color:i.color,showRemoveButton:!1})}):null}),[u,l.property,l.value,t,v.container]),h=(0,n.useCallback)((()=>(0,U.jsx)(ue,{schema:t,currentGroups:o,groupBy:r,groupFormat:l,onChange:a,onClose:c,buttonPopupStore:m,parentStore:y})),[t,o,r,l,a,c,m,y]);return(0,U.jsx)(g().A,{render:h,renderOrigin:f,disabled:u,buttonPopupStore:m,popupType:i().A.isMobile?g().z.BottomSheet:g().z.Popup,originGap:4})}function de(e){const{groupValue:t,schema:o,currentGroups:r,groupBy:l,groupFormat:c,onChange:u,onClose:d,disabled:m,style:y,isHiddenGroup:f,buttonPopupStore:S,parentStore:x,collectionContextStore:C}=e,b=(0,a().K8)((()=>{if(t.value&&(0,h().GG)(t)&&x)return"space_permission_group"===t.value.table?{type:"space_permission_group",value:(0,A().S4)({spacePermissionGroupId:t.value.id,spaceId:t.value.spaceId})}:{type:"actor",value:(0,v().xC)({pointer:t.value,getRecordValue:x.getRecordValue})}}),[t,x]),k=(0,a().K8)((()=>{var e;return null===(e=C.collectionStore())||void 0===e?void 0:e.getSpaceStore()}),[C]),w=(0,s().IS)((()=>({container:{...W,...y}})),[y]),j=(0,n.useCallback)((e=>b&&x?"space_permission_group"===b.type?(0,U.jsx)(p().Ay,{style:w.container,disabled:m,...e,children:(0,U.jsx)(R().UISpacePermissionGroupToken,{parentStore:x,groupPointer:b.value,format:F().Ay.Format.Medium,showRemoveButton:!1,isSingle:!0,disableAvatarTooltip:f,shouldShrink:!0},b.value.id)}):b.value.asActor?(0,U.jsx)(p().Ay,{style:w.container,disabled:m,...e,children:(0,U.jsx)(F().Ay,{format:F().Ay.Format.Medium,actor:b.value,showRemoveButton:!1,isSingle:!0,disableAvatarTooltip:f,shouldShrink:!0,hasPersonHoverCard:!0,spaceStore:k})}):null:null),[b,x,m,f,w.container,k]),I=(0,n.useCallback)((()=>(0,U.jsx)(ue,{schema:o,currentGroups:r,groupBy:l,groupFormat:c,onChange:u,onClose:d,buttonPopupStore:S,parentStore:x})),[o,r,l,c,u,d,S,x]);return(0,h().GG)(t)&&t.value&&x&&b&&("actor"!==b.type||b.value.asActor)?(0,U.jsx)(g().A,{renderOrigin:j,render:I,disabled:m,buttonPopupStore:S,popupType:i().A.isMobile?g().z.BottomSheet:g().z.Popup,originGap:4}):null}function ge(e){const{groupValue:t,schema:o,currentGroups:r,groupBy:l,groupFormat:a,onChange:c,onClose:u,disabled:d,style:m,buttonPopupStore:y,parentStore:v}=e,f=(0,s().IS)((()=>({container:{...$,...I().RC,...m}})),[m]),S=(0,n.useCallback)((e=>(0,h().kO)(t)&&void 0!==t.value?(0,U.jsx)(p().Ay,{style:f.container,disabled:d,...e,children:(0,U.jsx)(X,{value:t.value})}):null),[d,t,f.container]),x=(0,n.useCallback)((()=>(0,U.jsx)(ue,{schema:o,currentGroups:r,groupBy:l,groupFormat:a,onChange:c,onClose:u,buttonPopupStore:y,parentStore:v})),[o,r,l,a,c,u,y,v]);return(0,h().kO)(t)&&void 0!==t.value?"exact"===t.value.type?(0,U.jsx)(g().A,{renderOrigin:S,render:x,disabled:d,buttonPopupStore:y,popupType:i().A.isMobile?g().z.BottomSheet:g().z.Popup,originGap:4}):(0,U.jsx)("div",{style:$,children:(0,U.jsx)(X,{value:t.value})}):null}},359454:(e,t,o)=>{o.d(t,{P:()=>l});var n=()=>o(907258),r=()=>o(732810),i=()=>o(654774);function l(e){const{environment:t,collectionContextStore:o}=e;let l=o.collectionStore();const a=o.collectionViewBlockStore();if(!l||!a)return;const{mainEditorCurrentBlockStore:s}=n().default.state;s&&o.isFullScreenStore.state&&(l=r().m.createChildStore(s,l.pointer)),(0,i().x)({environment:t,store:l.getNameStore(),canSelectAllBlocks:!1})}},388832:(e,t,o)=>{o.d(t,{d_:()=>a,gY:()=>s,so:()=>c});o(944114),o(898992),o(354520),o(803949),o(581454);var n=()=>o(350013),r=()=>o(824862),i=()=>o(743246),l=()=>o(319625);function a(e){var t;const o=e.getDraftData()??e.getData(),n=[];return null==o||null===(t=o.modules)||void 0===t||t.forEach((e=>{var t;"notion"===e.type&&null!==(t=e.state)&&void 0!==t&&t.ownedByDatabasePropertyIds&&n.push(...e.state.ownedByDatabasePropertyIds)})),n}function s(e){const{workflowsData:t,collectionViewBlockStore:o,currentCollectionStore:r,property:l,spaceId:a}=e;if(0===t.length||!r)return[];const s=[];for(const n of t)"none"!==n.access&&n.collectionId===r.id&&s.push(n.workflowId);return s.map((e=>n().N.createChildStore(o,{table:i().C0,id:e,spaceId:a}))).filter((e=>{const t=e.getDraftData()??e.getData(),o=null==t?void 0:t.modules;for(const r of o??[]){var n;if("notion"===r.type)return(null===(n=r.state)||void 0===n||null===(n=n.ownedByDatabasePropertyIds)||void 0===n?void 0:n.includes(l))??!1}return!1}))}function c(e){const{collectionStore:t,spaceId:o}=e,i=t.getParentStore(),a=null==i?void 0:i.getFormat(),s=a&&"database_agent_ids"in a&&Array.isArray(a.database_agent_ids)?a.database_agent_ids:[];if(!i||!a||0===s.length)return{value:[]};const c=s.map((e=>{const t={id:e,table:"workflow",spaceId:o};return n().N.createChildStore(i,t)})).filter((e=>e.isDefined()&&void 0===e.getMovedToTrashTime()));try{return{value:c.map((e=>{const o=e.getData();let n;const l=null==o?void 0:o.runtime_actor_pointer;l&&l.table===r().GP&&(n=l.id);return{...{blockId:i.id,collectionId:t.id,workflowId:e.id,botId:n},access:"write"}}))}}catch(u){return{error:(0,l().A)(u)}}}},396671:(e,t,o)=>{o.d(t,{d:()=>i});o(944114),o(898992),o(672577),o(803949),o(581454);var n=()=>o(590526),r=()=>o(62371);function i({reducerResult:e,groupBy:t,subGroupBy:o}){return(0,n().K8)((()=>{const n=[],i=[];if(!e)return{version:"v2",currentGroups:[],visibleGroups:[],hiddenGroups:[],pinnedGroups:{groups:[],aggregations:{}},hasMore:!1};if(t){var l,a;e.results.forEach((o=>{var l;const a=null===(l=e.pinnedResults)||void 0===l?void 0:l.groupResults.find((e=>(0,r().AC)(e.value)===(0,r().AC)(o.value)));o.visible?n.push({property:t.property,value:o.value,pinned:!!a||void 0,hidden:!1}):i.push({property:t.property,value:o.value,hidden:!0,pinned:!!a||void 0})}));const o=(null===(l=e.pinnedResults)||void 0===l?void 0:l.groupResults.map((e=>({property:t.property,value:e.value,pinned:!0,hidden:!e.visible}))))??[];return{version:"v2",currentGroups:[...n,...i],visibleGroups:n,hiddenGroups:i,pinnedGroups:{groups:o,aggregations:(null===(a=e.pinnedResults)||void 0===a?void 0:a.aggregationResults)??{}},hasMore:e.hasMore}}var s;return o?(null===(s=e.subGroupResults)||void 0===s||s.forEach((e=>{e.visible?n.push({property:o.property,value:e.value}):i.push({property:o.property,value:e.value,hidden:!0})})),{version:"v2",currentGroups:[...n,...i],visibleGroups:n,hiddenGroups:i,pinnedGroups:{groups:[],aggregations:{}},hasMore:Boolean(e.hasMoreSubGroups)}):{version:"v2",currentGroups:[],visibleGroups:[],hiddenGroups:[],pinnedGroups:{groups:[],aggregations:{}},hasMore:!1}}),[e,t,o],{useDeepEqual:!0})}},414822:(e,t,o)=>{o.d(t,{U:()=>l});var n=()=>o(491848),r=()=>o(248662),i=()=>o(547149);function l({environment:e,collectionContextStore:t,collectionViewBlockStore:o,templateStore:l,isKeyboard:a,from:s,shouldCoerce:c,showMoveTo:u,peekModeOverride:p,userAction:d}){i().createAndCommit({userAction:"collectionTemplatePickerActions.updatePreferredDatabase",environment:e,canUndo:!0,perform:e=>{(0,n().w)({collectionContextStore:t,transaction:e})}});const{performResult:g}=i().createAndCommit({userAction:d??"collectionTemplatePickerActions.createPageFromCollectionTemplate",environment:e,canUndo:!0,perform:n=>(0,r().T)({transaction:n,store:o,collectionContextStore:t,environment:e,shouldCoerce:c,templateStore:l,from:s,isKeyboard:a,showMoveTo:u,peekModeOverride:p})});return g}},424599:(e,t,o)=>{o.d(t,{M:()=>u});o(581454);var n=()=>o(594013),r=()=>o(901610),i=()=>o(384944),l=()=>o(999140),a=()=>o(306499),s=()=>o(547149),c=()=>o(339798);async function u(e){var t;const{environment:o,collectionStore:u,collectionContextStore:p,collectionSettingsStore:d,shouldSkipViewSelection:g}=e,m=p.collectionViewBlockStore(),y=p.collectionViewStore(),v=u.getParentBlockStore();if(!m||!v||!y)return;const f=null===(t=u.getModel())||void 0===t?void 0:t.getNormalizedSchema();if(!p.getIsInDashboardBuildMode()&&"chart"===y.getType()&&f){const e=y.getFormat(),t=e.chart_config;if(!t)return;const l="placeholder"===t.type?t.placeHolderType:t.type;let a;return(0,r().I)(l)?a=(0,n().EZ)({collectionSchema:f,axisChartType:l}):"donut"===l&&(a=(0,n().ZS)({collectionSchema:f})),s().createAndCommit({userAction:"slashMenu.create.chartViewExistingSource",environment:o,canUndo:!0,perform:t=>{i().zv({store:y.getFormatStore(),transaction:t,data:{...e,hide_linked_collection_name:!0,subitem_display_mode:"flattened",chart_config:a||null}})}}),void d.setState({open:!0,stack:[{type:"main"}]})}if(g)c().a2({collectionSettingsStore:d,item:{type:"main"}});else{await Promise.all([...v.getCollectionViewStores().map((e=>e.load())),...m.getCollectionViewStores().map((e=>e.load()))]);(0,l().Mf)({collectionStore:u,sourceCollectionViewBlockStore:v,currentCollectionViewBlockStore:m,currentCollectionViewStore:y,constraints:(0,a().v)(y.id)}).length>0?c().a2({collectionSettingsStore:d,item:{type:"duplicateExistingView"}}):c().a2({collectionSettingsStore:d,item:{type:"createView",analytics:void 0}})}}},437578:(e,t,o)=>{o.d(t,{D:()=>w});o(898992),o(823215),o(354520),o(581454);var n=o(296540),r=()=>o(726637),i=()=>o(484714),l=()=>o(590526),a=()=>o(401497),s=()=>o(546926),c=()=>o(663639),u=()=>o(736847),p=()=>o(584262),d=()=>o(69708),g=()=>o(100622),m=()=>o(160568),y=()=>o(284371),v=o(474848);const f=n.memo((function(e){const{prefix:t,collectionName:o}=e,n=(0,a().IS)((()=>({container:{display:"flex",alignItems:"center",fontWeight:y().Wy.medium,color:g().Tj.text.secondary,paddingInlineStart:8,paddingInlineEnd:8},databaseTitle:{...y().RC}})),[]);return(0,v.jsxs)("div",{style:n.container,children:[t,(0,v.jsxs)("span",{style:n.databaseTitle,children:[" ",o]})]})}));var h=()=>o(419357),S=()=>o(492414),x=()=>o(547149),C=()=>o(649813);const b=n.memo((function(e){const t=(0,i().v3)(),r=(0,d().tz)(),l=(0,a().IS)((()=>({link:{borderRadius:6,height:24,width:24,display:"flex"},button:{height:24,width:24,fill:g().Tj.icon.tertiary},icon:{width:20,height:20}})),[]),s=(0,n.useCallback)((()=>{o(148024).FH(t,{from:e.helpButtonContext})}),[t,e.helpButtonContext]);return(0,v.jsx)(o(552712).N,{href:e.href,external:!0,style:l.link,onClick:s,children:(0,v.jsx)(o(695115).A,{icon:o(406533).questionMarkCircleIcon,style:l.button,iconStyle:l.icon,ariaLabel:r.formatMessage({id:"helpButton.ariaLabel",defaultMessage:"Help"})})})}));var k=()=>o(160632);const A=(0,d().YK)({filterPlaceholder:{id:"collectionPicker.searchBarFilter.text",defaultMessage:"Filter…"}}),w=n.memo((function(e){const{collectionStore:t,isOverlay:i,onEmptyEnter:c,onEmptyPageClick:p,onCancelClick:m,canConfigureCollection:y,locked:f,onTemplateClick:h}=e,[S,x]=(0,n.useState)(""),C=(0,l().uB)(void 0,o(452004).$),b=(0,l().K8)((()=>t.getTemplatePageStores().filter((e=>e.getAlive()))),[t]),k=(0,l().K8)((()=>b.every((e=>e.isReady()))),[b]),A=(0,l().K8)((()=>i&&null!=S&&S.length?(0,o(778078).Ay)(S,b,(e=>String(e.getProperties().title||""))):b),[b,S,i]),w=(0,a().IS)((()=>({container:{fontSize:14,padding:r().A.isMobile?"12px 16px":"0 12px 4px 12px",color:g().Tj.text.tertiary,wordBreak:"keep-all",...r().A.isMobile&&{background:g().Tj.background.primary,boxShadow:`0 1px 0 ${g().Tj.border.secondaryTranslucent}`,marginBottom:1}}})),[]);if(!k)return null;if(i){const e=b.length>6,n=r().A.isMobile?{menuType:s().gu.Modal,title:(0,v.jsx)(d().sA,{defaultMessage:"Database templates",id:"database.mobileTemplatesMenu.title"})}:{menuType:s().gu.Popup,width:360};return(0,v.jsxs)(o(890492).A,{...n,header:(0,v.jsx)(j,{collectionStore:t}),children:[0===b.length?(0,v.jsx)(u().A,{children:(0,v.jsx)("div",{style:w.container,children:(0,v.jsx)(d().sA,{defaultMessage:"Create a reusable page template for this database.",id:"database.emptyTemplatesList.info"})})}):void 0,e?(0,v.jsx)(I,{templateInputValue:S,setTemplateInputValue:x}):null,(0,v.jsx)(T,{collectionStore:t,onEmptyEnter:c,onEmptyPageClick:p,onCancelClick:m,canConfigureCollection:y,isOverlay:i,locked:f,onTemplateClick:h,menuListStore:C,templateInputValue:S,filteredTemplatePageStores:A,draggable:!(e&&S)})]})}return(0,v.jsx)(T,{collectionStore:t,onEmptyEnter:c,onEmptyPageClick:p,onCancelClick:m,canConfigureCollection:y,isOverlay:i,locked:f,onTemplateClick:h,menuListStore:C,templateInputValue:S,filteredTemplatePageStores:A,draggable:!0})})),j=n.memo((function(e){const{collectionStore:t}=e,n=(0,d().tz)(),i=(0,l().K8)((()=>(0,o(562969).getCollectionNameOrDefault)({collectionStore:t,intl:n})),[t,n]),s=(0,a().IS)((()=>({container:{marginTop:6}})),[]);return r().A.isMobile?null:(0,v.jsx)(o(424400).Ay,{style:s.container,title:(0,v.jsx)(f,{prefix:(0,v.jsx)(d().sA,{id:"database.templatesList.templatesFor",defaultMessage:"Templates for"}),collectionName:i}),right:(0,v.jsx)(b,{helpButtonContext:"collection_templates_menu",href:(0,o(232930).x)("guides.databaseTemplates")})})})),I=n.memo((function(e){const{templateInputValue:t,setTemplateInputValue:l}=e,{isAndroid:s}=(0,i().Y0)(),c=(0,d().tz)(),u=(0,n.useCallback)((e=>l(e.currentTarget.value)),[l]),p=(0,a().IS)((()=>({container:{margin:r().A.isMobile?0:"10px 0"},input:{...s&&{borderBottom:"none"}}})),[s]);return(0,v.jsx)("div",{style:p.container,children:(0,v.jsx)(h().Ay,{value:t,focusInitial:!r().A.isMobile||void 0,placeholder:c.formatMessage(A.filterPlaceholder),showClearButton:!0,inputLeft:(0,v.jsx)(h().Zf,{icon:o(344417).magnifyingGlassSmallIcon}),onChange:u,style:p.input})})})),T=n.memo((function(e){const{filteredTemplatePageStores:t,draggable:a,collectionStore:s,onEmptyEnter:d,onEmptyPageClick:g,onCancelClick:y,canConfigureCollection:f,isOverlay:h,locked:b,onTemplateClick:A,menuListStore:w,templateInputValue:j}=e,I=(0,i().v3)(),T=(0,n.useContext)(o(908201).p2),_=(0,n.useContext)(o(110525).n),V=(0,l().K8)((()=>(0,o(957763).E)(I,(0,o(135168).f)(s))),[I,s]),B=(0,n.useCallback)((e=>{w.unsetFocus(),x().createAndCommit({userAction:"CollectionTemplatePicker.handleCollectionTemplatesReorder",environment:I,canUndo:!0,perform:t=>C().lU({collectionStore:s,newTemplateIds:e,transaction:t})})}),[I,s,w]),P=(0,n.useCallback)((()=>{var e;V&&(d(),m().ki(I,{template_type:"empty_page",from:"collections_template_picker",is_keyboard:!0,collection_id:s.id,collection_view_id:null==T||null===(e=T.collectionViewStore())||void 0===e?void 0:e.id}))}),[I,s,d,T,V]),G=(0,n.useCallback)((e=>{V&&(g(e.event),m().ki(I,{template_type:"empty_page",from:"collections_template_picker",is_keyboard:"keydown"===e.event.type,...T&&(0,o(390650).sl)(T)}))}),[V,T,I,g]),F=(0,n.useCallback)((()=>{var e;if(!V)return;const{performResult:t}=x().createAndCommit({userAction:"CollectionTemplatePicker.newPage",environment:I,canUndo:!0,perform:e=>C().bI({environment:I,collectionStore:s,transaction:e,title:j})});if(t){const{mainEditorCurrentBlockStore:e}=o(907258).default.state,n=e?(0,S().Ay)({store:e,peekViewBlockId:t.id,fullyQualified:!1,pageVisitSource:p().y8.Create}):(0,S().Ay)({store:t,fullyQualified:!1,pageVisitSource:p().y8.Create});_?_(n):(0,o(246766).navigate)({environment:I,url:n})}m().er(I,{collection_id:s.id,collection_view_id:null==T||null===(e=T.collectionViewStore())||void 0===e?void 0:e.id}),null==y||y()}),[V,I,s,T,j,y,_]),R=(0,n.useMemo)((()=>({key:"create-template",render:e=>(0,v.jsx)(M,{isOverlay:h,locked:b,menuListItemProps:e}),action:F})),[F,h,b]),K=(0,l().K8)((()=>{var e;return null==T||null===(e=T.defaultPageTemplateStore.state)||void 0===e?void 0:e.id}),[T]),L=(0,l().K8)((()=>({key:"empty",render:e=>0===t.length||""!==j?null:(0,v.jsx)(k().K,{collectionStore:s,canConfigureCollection:f,isOverlay:h,templateStore:void 0,isMobile:r().A.isMobile,locked:b||!f,draggable:!0,isDefault:void 0===K,onCancelClick:y,...e}),action:G})),[f,s,K,G,h,b,y,j,t.length]),O=(0,n.useCallback)((e=>{const t=e.getAutomationStore(),o=null!=t&&t.isActive()?t.getRecurrence():void 0,i=t&&!t.canEdit(),l="disabled_duplication"===(null==t?void 0:t.getStatus())||"disabled_inactive_space"===(null==t?void 0:t.getStatus()),c={key:e.id,render:t=>(0,n.createElement)(k().K,{...t,key:e.id,isOverlay:h,collectionStore:s,canConfigureCollection:f,templateStore:e,isMobile:r().A.isMobile,locked:b,onCancelClick:y,draggable:a,isDefault:K===e.id,recurrence:o,recurrenceDisabled:l,recurrenceButtonDisabled:i}),action:t=>{V&&A({templateStore:e,isKeyboard:"keydown"===t.event.type})}};return c}),[f,V,s,K,a,h,b,y,A]),E=(0,l().K8)((()=>{const e=t.map((e=>e.id)),n=[0!==t.length?{key:"templates",render:t=>{if(0===t.children.length)return null;const n=t.children.slice(0,t.children.length-1),i=t.children[t.children.length-1];return(0,v.jsx)(u().A,{...t,disableDesktopPadding:!h,disableMobileBorders:!0,children:(0,v.jsxs)(v.Fragment,{children:[r().A.isMobile||b||!f?n.map(((e,t)=>n[t])):(0,v.jsx)(o(271205).Ay,{direction:"vertical",keys:e,disabled:!a,renderKey:t=>n[e.indexOf(t)],onDrop:B}),i]})})},items:[...t.map(O),L]}:null,f?{key:"create-template",render:e=>(0,v.jsx)(u().A,{topBorder:h,disableDesktopPadding:!h,disableMobileBorders:!0,...e}),items:[R]}:null];return n.filter((e=>null!==e))}),[t,O,L,f,R,h,b,a,B]);return(0,v.jsx)(c().A,{type:c().O.Vertical,store:w,sections:E,onEmptyEnter:P,initialFocus:void 0,disableInitialScroll:!0,disableCommandEnter:!0,resetFocusOnMouseOut:!0})})),M=n.forwardRef((function(e,t){const{menuListItemProps:n,isOverlay:r,locked:i}=e,l=(0,v.jsx)(d().sA,{defaultMessage:"New template",id:"database.templateView.newTemplateButton"});return r?(0,v.jsx)(o(274652).o,{title:l,color:"secondary",...n}):(0,v.jsx)(o(896464).J,{title:l,icon:(0,v.jsx)(o(807449).I,{icon:o(617668).plusIcon}),type:"new_template",format:r?"collection-overlay":"page-menu-item",locked:i,...n})}))},442025:(e,t,o)=>{o.d(t,{$6:()=>s,Vu:()=>a,zX:()=>l});var n=()=>o(433337),r=()=>o(799829),i=()=>o(113105);const l=(0,o(69708).YK)({sprintUncategorizedGroup:{defaultMessage:"Backlog (No {name})",id:"database.sprintDatabaseView.uncategorizedGroupLabel"}});function a(e){const{collectionStore:t,property:o,propertySchema:r,parentStore:l}=e;let a=!1;if(null!=t&&t.isDefined()){const e=t.getPropertyMapping();a=(null==e?void 0:e[n().yx.TaskToSprintRelation])===o}return(0,i().LQ)(r,l)===n().av||a}function s(e){return(0,r().wy)({appUri:e.getFormatStore().getKeyStore("app_config_uri").getValue(),collectionSchema:e.getSchema()})}},468397:(e,t,o)=>{o.d(t,{O:()=>l,q:()=>i});var n=()=>o(564884);class r extends(()=>o(757695))().Store{getInitialState(){return{type:"closed"}}}function i(e,t){var o;l.setState({type:"open",collectionContextStore:t});const r=null===(o=t.collectionViewStore())||void 0===o?void 0:o.id;r&&(0,n().u)({environment:e,event:{eventName:"my_tasks_limited_source_picker_modal_opened",eventProperties:{collection_view_id:r}}})}const l=new r},491761:(e,t,o)=>{o.d(t,{J:()=>a,z:()=>l});var n=()=>o(79926);const r=new(n().O2)("CollectionSettingsUpsell",(async()=>o.e(9243).then(o.bind(o,263427)))),i=new(n().O2)("CollectionSettingsUpsellMaybe",(async()=>o.e(9243).then(o.bind(o,263427)))),l=(0,n()._h)(r,(e=>e.CollectionSettingsUpsell)),a=(0,n()._h)(i,(e=>e.CollectionSettingsUpsellMaybe))},534239:(e,t,o)=>{o.d(t,{Zr:()=>v,e8:()=>h});var n=o(296540),r=()=>o(484714),i=()=>o(590526),l=()=>o(401497),a=()=>o(732810),s=()=>o(807449),c=()=>o(98126),u=()=>o(898244),p=()=>o(617871),d=()=>o(187174),g=()=>o(532940),m=()=>o(100622),y=o(474848);function v({propertyId:e,propertySchema:t,collectionContextStore:o}){return"relation"!==t.type&&"rollup"!==t.type?null:(0,y.jsx)(f,{collectionContextStore:o,propertyId:e,propertySchema:t})}function f(e){const{propertySchema:t}=e,o=(0,i().K8)((()=>{if(t&&(0,u().UU)(t)&&t.connectedRelation.integration_id===p().mn)return t.collection_pointer}),[t]),{format:r,loading:a}=h(o,{debugName:"ConnectedRelationSyncStateBadge"}),d=(0,n.useMemo)((()=>{var e;return r?{hasError:Boolean(r.error),isSyncing:Boolean(null===(e=r.sync_state)||void 0===e?void 0:e.syncing)}:null}),[r]),v=(0,l().eP)(),f=(0,l().IS)((()=>({container:{fontSize:11,padding:"1px 4px",borderRadius:4,display:"inline-flex",flexDirection:"row",alignItems:"center",gap:4,marginTop:1,color:"light"===v?m().Tj.palette.blue[500]:m().Tj.palette.blue[600]},icon:{padding:2}})),[v]);return d?d.isSyncing?(0,y.jsx)("span",{style:f.container,children:(0,y.jsx)(c().A,{size:"md"})}):d.hasError?(0,y.jsx)("span",{style:f.container,children:(0,y.jsx)(s().I,{icon:g().exclamationMarkTriangleIcon,colorPalette:"yellow",colorVariant:"accentPrimary",style:f.icon})}):null:null}function h(e,t={}){const o=(0,r().v3)(),[{status:n,value:l,error:s}]=(0,d().Yb)((async()=>{if(!e)return null;const t=new(a().m)(o,e);return await t.load(),t}),[o,e],{debugName:t.debugName||"useExternalCollectionFormat"});return{format:(0,i().K8)((()=>(null==l?void 0:l.getFormat())??null),[l]),loading:"pending"===n,error:s}}},552604:(e,t,o)=>{o.d(t,{A:()=>l});var n=o(296540),r=o(474848);function i(e){const{pageName:t,targetCollectionStore:n,...i}=e,l=(0,o(484714).Y0)(),a=(0,o(590526).K8)((()=>n.getIcon()),[n]),s=(0,o(401497).IS)((()=>({medium:{color:o(100622).Tj.text.secondary},dbName:{display:"flex",alignItems:"center",marginInlineStart:4},title:{marginInlineStart:o(352153).g1*(l.isRetina?.5:1)}})),[l.isRetina]),c=(0,r.jsxs)("div",{style:s.dbName,children:[(0,r.jsx)(o(187820).B6,{disabled:!0,icon:a,iconRecordCategory:"collection",isEmptyPage:!1,size:o(726637).A.isMobile?24:20}),(0,r.jsx)(o(16006).A,{store:n,style:s.title})]});return(0,r.jsx)(o(81068).A,{title:(0,r.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,r.jsx)(o(69708).sA,{id:"database.searchRelation.createNewPageFooter",defaultMessage:"<medium>New</medium> {pageName} <medium> in</medium> {databaseNameWithIcon}",values:{medium:e=>(0,r.jsx)("span",{style:s.medium,children:e}),pageName:(0,r.jsx)("span",{style:{marginInlineStart:4,marginInlineEnd:4},children:t}),databaseNameWithIcon:c}})}),icon:(0,r.jsx)(o(807449).I,{icon:o(617668).plusIcon,colorVariant:"secondary"}),...i})}const l=n.memo(i)},595917:(e,t,o)=>{o.d(t,{a:()=>i});var n=()=>o(590526),r=()=>o(388832);function i(e){const t=(0,n().K8)((()=>{if(e)return e.getSpaceId()}),[e]);return(0,n().K8)((()=>e&&t?(0,r().so)({collectionStore:e,spaceId:t}):{value:[]}),[e,t])}},604656:(e,t,o)=>{o.d(t,{m:()=>a});o(898992),o(354520),o(581454);var n=()=>o(62371),r=()=>o(436696),i=()=>o(547149),l=()=>o(800002);function a(e){var t;const{environment:o,collectionContextStore:a,currentGroups:s,groupsFormatKey:c,groupFormat:u,action:p}=e,d="toggle_group_pin"===p&&"board_columns"!==c,g=(null===(t=a.collectionViewStore())||void 0===t?void 0:t.getFormatStore().getKeyStore(c).getValue())??[],m=new Map;for(const r of g)m.set((0,n().Ix)(r),r);const y=new Map;for(const r of s)y.set((0,n().Ix)(r),r);const v=s.filter((e=>!m.has((0,n().Ix)(e)))),f=v.length>0?[...g,...v]:g;if(!a.permissionScopesStore.state.canConfigureBlock||d)return f;const h=m.get((0,n().Ix)(u))??y.get((0,n().Ix)(u))??(0,n().QF)(u.property,u.value),S=f.map((e=>(0,n().Mn)(e,h)?"toggle_group_pin"===p?{...h,pinned:!h.pinned||void 0}:"toggle_group_visibility"===p?{...h,hidden:!h.hidden}:h:e));return i().createAndCommit({userAction:"CollectionSettingsViewGroup.handleToggleGroupFormat",environment:o,canUndo:!0,perform:e=>{(0,l().o)({collectionContextStore:a,newGroups:S,groupsFormatKey:c,transaction:e})}}),(0,r().X)({environment:o,collectionContextStore:a,action:"toggle_group_pin"}),S}},610101:(e,t,o)=>{o.d(t,{A:()=>r});class n extends(()=>o(757695))().Store{getInitialState(){return{isOpen:!1,from:void 0,collectionContextStore:void 0}}}const r=new n},680341:(e,t,o)=>{o.d(t,{v:()=>A});o(944114),o(898992),o(803949),o(581454),o(296540);var n=()=>o(726637),r=()=>o(383036),i=()=>o(484714),l=()=>o(30537),a=()=>o(546926),s=()=>o(26697),c=()=>o(890492),u=()=>o(81068),p=()=>o(663639),d=()=>o(736847),g=()=>o(356246),m=()=>o(67657),y=()=>o(568063),v=()=>o(69708),f=()=>o(496603),h=()=>o(525955),S=()=>o(662971),x=()=>o(478184),C=()=>o(142680),b=o(474848);const k=(0,v().YK)({noneText:{defaultMessage:"None",id:"database.propertyAggregationMenu.noneText"},systemShowValuesText:{defaultMessage:"Show values",id:"database.rollupProperty.aggregate.showValues"},tableAggregationTooltip:{defaultMessage:"Table aggregation",id:"database.propertyAggregationMenu.tableAggregationTooltip"}});function A({onClose:e,property:t,schema:o,currentAggregation:r,source:s,noneText:f,onChange:x}){const C=(0,i().v3)(),A=(0,v().tz)();let w;w=n().A.isMobile?{menuType:a().gu.Modal,title:A.formatMessage(k.tableAggregationTooltip),onClickRight:e}:{menuType:a().gu.Popup,width:200};const[M,_]=function({property:e,schema:t,source:o,intl:r,onChange:i,environment:s,currentAggregation:v,noneText:f}){const x=[];let C=0,A=0;const w=null==v?void 0:v.aggregator,M=({aggregationType:e,enforceMaxAggregationLimit:t})=>i({aggregationType:e,enforceMaxAggregationLimit:t});if((0,y().cl)(e)){const e=[];e.push({key:"none",render:e=>(0,b.jsx)(u().A,{...e,isChecked:!v,title:r.formatMessage(k.systemShowValuesText)}),action:()=>i({aggregationType:void 0})}),e.push(j("count"===w,"count",M,!0));return[e,"count"===w?1:0]}const _=function({property:e,schema:t,currentAggregationType:o,onChangeWithLimit:n,environment:r,currentAggregation:i}){const l={},a=t[e];if(!a)return{};for(const s of m().VD)l[s]=j(s===o,s,n);if((0,m().wG)(a))for(const s of m().CG)l[s]=j(s===o,s,n);if((0,m().OC)(a))for(const s of m().Sn)l[s]=j(s===o,s,n);if((0,m().fo)(a))for(const s of m().zE)l[s]=j(s===o,s,n);if((0,m().s_)(a))for(const s of g().QO)l[s]=j(s===o,s,n);if((0,m().q0)(a))for(const s of m().nJ)l[s]=I(e,s,i,t,n);if((0,m().pe)(a))for(const s of m().A3)l[s]=j(s===o,s,n);return l}({property:e,schema:t,currentAggregationType:w,onChangeWithLimit:M,environment:s,currentAggregation:v});x.push({key:"none",render:e=>(0,b.jsx)(u().A,{...e,isChecked:!v,title:f||r.formatMessage(k.noneText)}),action:()=>i({aggregationType:void 0})});let V="tableAggregation"===o?1:2;return Object.entries(m().Kn).forEach((([e,t])=>{const r=[];for(const n of t)if(_[n]){if("show_unique"===n)switch(o){case"tableAggregation":continue;case"rollupPropertyMenu":x.splice(1,0,_[n]),(null==v?void 0:v.aggregator)===n&&(C=1);continue}r.push(_[n]),(v&&(0,m().ET)(null==v?void 0:v.aggregator)&&v.aggregator.operator===n||(null==v?void 0:v.aggregator)===n)&&(C=V,A=r.length-1)}const i=[];if("count_aggregations"===e&&"tableAggregation"===o&&i.push({key:"limitToggleSection",render:e=>(0,b.jsx)(d().A,{...e}),items:[T(v,M)]}),i.push({key:"aggregations",render:e=>(0,b.jsx)(d().A,{topBorder:!0,...e}),items:r}),r.length>0){V++;const t=h().jA[e],o={key:t,render:(e,o)=>(0,b.jsx)(S().A,{...e,onFocus:o.onFocus,popupTypeOverride:n().A.isMobile?l().n.BottomSheet:void 0,bottomSheetInitialState:"half",disableDefaultClick:!0,renderOrigin:(e,o)=>(0,b.jsx)(u().A,{...e,ref:o,title:t}),renderExtension:(e,r)=>{let l;return l=n().A.isMobile?{menuType:a().gu.Modal,title:t,onClickRight:r.close,...e}:{menuType:a().gu.Popup,width:250,...e},(0,b.jsx)(c().A,{...l,children:(0,b.jsx)(p().A,{type:p().O.Vertical,initialFocus:A,sections:i,onAccept:(e,t,n)=>{"aggregationLimitToggle"!==e.key&&(r.close(),o.onAccept&&o.onAccept(e,t,n))}})})}}),action:()=>null};x.push(o)}})),[x,C]}({property:t,schema:o,source:s,intl:A,onChange:x,environment:C,currentAggregation:r,noneText:f});return(0,b.jsx)(c().A,{...w,children:(0,b.jsx)(p().A,{type:p().O.Vertical,initialFocus:_??0,sections:[{key:0,render:e=>(0,b.jsx)(d().A,{...e}),items:M}],onAccept:e})})}function w({isSelected:e,aggregationType:t,label:o,props:n}){const i=h().cx[t];return(0,b.jsx)(s().m,{placement:"right",delayThreshold:0,render:t=>(0,b.jsx)(u().A,{title:o,isChecked:e,...(0,r().A)(t,n)}),renderTooltip:()=>(0,b.jsxs)("div",{style:{width:140,whiteSpace:"normal"},children:[i?(0,b.jsx)("img",{src:(0,x().L)(i),style:{borderRadius:4,width:140,marginTop:4}}):void 0,h().fp[t]]})},n.key)}function j(e,t,o,n){const i=h().zY[t],l=h().cx[t];return{key:i,render:o=>(0,b.jsx)(s().m,{placement:"right",delayThreshold:0,render:t=>(0,b.jsx)(u().A,{title:i,isChecked:e,...(0,r().A)(t,o)}),disableTooltip:n,renderTooltip:e=>(0,b.jsxs)("div",{...e,style:{width:140,whiteSpace:"normal"},children:[l?(0,b.jsx)("img",{src:(0,x().L)(l),style:{borderRadius:4,width:140,marginTop:4}}):void 0,h().fp[t]]})},o.key),action:()=>{o({aggregationType:t})}}}function I(e,t,o,r,i){const s=h().zY[t],g=f().oE(function(e,t,o,n,r){const i=n[t];if(!i||"status"!==i.type)return;const l=i.groups;return l?l.map((t=>{const n=(e&&(0,m().ET)(e.aggregator)&&e.aggregator.operator===o&&e.aggregator.groupName===t.name)??!1;return{key:`${o}${t.name}`,render:e=>(0,b.jsx)(w,{isSelected:n,aggregationType:o,label:t.name,props:e}),action:()=>{r({aggregationType:{operator:o,groupName:t.name}})}}})):void 0}(o,e,t,r,i));let y=0;if(o&&(0,m().ET)(null==o?void 0:o.aggregator)&&o.aggregator.operator===t){const e=o.aggregator.groupName,n=g.findIndex((o=>o.key===`${t}${e}`));-1!==n&&(y=n)}return{key:t,render:(e,t)=>(0,b.jsx)(S().A,{...e,onFocus:t.onFocus,popupTypeOverride:n().A.isMobile?l().n.BottomSheet:void 0,bottomSheetInitialState:"half",renderOrigin:e=>(0,b.jsx)(u().A,{...e,title:s}),renderExtension:(e,o)=>{let r;return r=n().A.isMobile?{menuType:a().gu.Modal,title:s,onClickRight:o.close,...e}:{menuType:a().gu.Popup,width:200,...e},(0,b.jsx)(c().A,{...r,children:(0,b.jsx)(p().A,{type:p().O.Vertical,initialFocus:y,sections:[{key:"groups",render:e=>(0,b.jsx)(d().A,{...e}),items:g}],onAccept:t.onAccept})})}}),action:()=>null}}function T(e,t){const{enforceMaxAggregationLimit:o,disabled:n}=e?(0,h().NT)(e):{enforceMaxAggregationLimit:!1,disabled:!1};return{key:"aggregationLimitToggle",render:e=>(0,b.jsx)(C().A,{on:o,disabled:n,menuListItemProps:e}),action:()=>{t(e?{aggregationType:e.aggregator,enforceMaxAggregationLimit:!o}:{aggregationType:"count",enforceMaxAggregationLimit:!0})}}}},701311:(e,t,o)=>{o.d(t,{Q:()=>d,d:()=>g});o(898992),o(354520);var n=()=>o(564884),r=()=>o(907258),i=()=>o(636081),l=()=>o(214388),a=()=>o(62371),s=()=>o(416504),c=()=>o(390650),u=()=>o(274375),p=()=>o(681445);function d(e){return`${a().RO}_${e}`}function g(e){var t,o,a;const{collectionContextStore:d,environment:g,groupFormat:m,groupBy:y,temporaryViewState:v,title:f}=e,h=d.collectionViewBlockStore();if(!h)return;const S=d.normalizedSchemaStore.state,x=d.normalizedFormatStore.state,C=d.normalizedQueryStore.state,b=(null===(t=r().default.state.currentUserSettingsStore)||void 0===t?void 0:t.getSettingsStore().getKeyStore("time_zone").getValue())||(0,s().P)(),k=(0,i().K8)({schema:S,groupBy:y,group:m,propertyMapping:void 0,timeZone:b});if(!k)return;const A=y.property,w=(0,u().Q)(h,A),j=(null===(o=v.combinatorFilter)||void 0===o?void 0:o.value)??(null==C?void 0:C.filter),I={type:"table",parent_id:h.pointer.id,parent_table:h.pointer.table,alive:!0,space_id:h.getSpaceId(),format:{is_unlisted:!0,collection_pointer:x.collection_pointer,table_properties:w,property_filters:(null==v||null===(a=v.propertyFilters)||void 0===a?void 0:a.value)??(null==x?void 0:x.property_filters)},query2:{...C,filter:j?(0,l().GV)([j,k]):(0,l().GV)([k])}},T=(0,c().sl)(d);(0,n().u)({environment:g,event:{eventName:"collection_chart_drilldown_click",eventProperties:{...T,drilldown_type:"grouped",from:"board_pinned_group"}}}),p().Q.openCollectionDrilldownView({collectionViewValue:I,collectionViewBlockStore:h,viewsModuleContext:d.viewsModuleContextStore.state,title:f})}},760077:(e,t,o)=>{o.d(t,{U:()=>l});var n=()=>o(384944),r=()=>o(547149),i=()=>o(407031);function l(e){const{viewToDuplicateStore:t,collectionContextStore:o,collectionViewStore:l,environment:a,temporaryStore:s}=e,c=o.collectionStore(),u=t.getType();if(!u||!c)return;const p=t.getName(),d=t.getPageSort(),g=t.getFormat(),m=t.getKeyStore("query2").getValue();r().createAndCommit({userAction:"CollectionSettingsDuplicateExistingView.duplicateViewSettings",environment:a,canUndo:!0,perform:e=>{n().zv({store:s??l,data:{name:p,type:u,page_sort:d,format:{...g,collection_pointer:c.pointer},query2:m},transaction:e})}}),(0,i().S)({collectionContextStore:o})}},776547:(e,t,o)=>{o.d(t,{m:()=>u});var n=o(296540),r=()=>o(484714),i=()=>o(590526),l=()=>o(414822),a=()=>o(339798),s=()=>o(908201),c=o(474848);const u=n.memo((function(e){const{store:t,popupType:l,dismissTooltip:a,renderOrigin:u,placementToOrigin:d}=e,g=(0,r().v3)(),m=(0,s().ET)(),y=(0,i().uB)(void 0,o(118307).A),v=(0,n.useCallback)((()=>{(0,o(436696).X)({environment:g,collectionContextStore:m,action:"click_topbar_templates_dropdown"}),a&&a()}),[m,g,a]);return(0,c.jsx)(o(250910).A,{popupType:l,bottomSheetInitialState:"half",placementToOrigin:d,alignmentToOrigin:"start",render:()=>(0,c.jsx)(p,{store:t,templateButtonPopupStore:y}),originGap:4,onClick:v,renderOrigin:u,buttonPopupStore:y})}));function p(e){const{store:t,templateButtonPopupStore:u}=e,p=(0,r().v3)(),d=(0,s().ET)(),g=(0,i().K8)((()=>d.collectionStore()),[d]),m=(0,i().K8)((()=>d.settingsStore),[d]),y=(0,i().O$)(o(929219).e),v=(0,i().K8)((()=>d.permissionScopesStore.state.canConfigureCollection),[d.permissionScopesStore]),f=(0,i().K8)((()=>(0,o(457419).S)(t)),[t]),h=(0,o(401497).IS)((()=>({offlineMessage:{fontSize:14,color:o(100622).Tj.text.secondary,width:280,padding:8}})),[]),S=(0,n.useCallback)((e=>{(0,l().U)({userAction:"CollectionViewBlock.handleTemplateEmptyPageClick",collectionViewBlockStore:t,collectionContextStore:d,environment:p,shouldCoerce:!1,from:{createBlock:"cvb_template_empty_page"},templateStore:void 0}),u.reset(),a().os({collectionSettingsStore:m})}),[d,p,t,u,m]),x=(0,n.useCallback)((e=>{(0,l().U)({environment:p,collectionContextStore:d,collectionViewBlockStore:t,templateStore:e.templateStore,isKeyboard:e.isKeyboard,from:{createBlock:"cvb_template",initCollection:"collection_view_block"},shouldCoerce:!0}),u.reset(),a().os({collectionSettingsStore:m})}),[p,d,t,u,m]),C=(0,n.useCallback)((()=>{u.reset()}),[u]);return g?y?(0,c.jsx)(o(437578).D,{isOverlay:!0,collectionStore:g,canConfigureCollection:v,onEmptyPageClick:S,onEmptyEnter:S,onTemplateClick:x,onCancelClick:C,locked:f}):(0,c.jsx)("div",{style:h.offlineMessage,children:(0,c.jsx)(o(69708).sA,{defaultMessage:"Please go online to use a template.",id:"collectionViewBlock.actionBar.offlineTemplatePicker.message"})}):null}},800002:(e,t,o)=>{o.d(t,{o:()=>r});var n=()=>o(896628);function r(e){const{collectionContextStore:t,newGroups:o,groupsFormatKey:r,transaction:i}=e,l=t.collectionViewStore();l&&n().zA({stores:[l],update:{[r]:o},transaction:i})}},864403:(e,t,o)=>{o.d(t,{r:()=>u});o(944114),o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(581454);var n=()=>o(62371),r=()=>o(898244),i=()=>o(496603),l=()=>o(436696),a=()=>o(547149),s=()=>o(278094),c=()=>o(800002);function u(e){var t;const{environment:o,collectionContextStore:u,groupByKey:p,groupsFormatKey:d,currentGroups:g,newGroupIds:m,containsAllGroups:y}=e,v=(0,n().H2)(u.normalizedFormatStore.state,p,d),f=u.normalizedSchemaStore.state;if(!v)return[];const h=f[v.property];if(!h||!(0,n().Eg)(h))return[];const S=(null===(t=u.collectionViewStore())||void 0===t?void 0:t.getFormatStore().getKeyStore(d).getValue())??[],x=(0,n().oH)({schema:f,groupBy:v}),C=x?new Set(x.map((e=>(0,n().AC)(e)))):new Set,b=[];for(const i of S){if((0,r().j4)(h.type)&&!C.has((0,n().Ix)(i)))continue;const e={...i};delete e.emptyHidden,b.push(e)}let k=g||b;if(!y){const e=(0,n().ro)(h),t=1===b.length&&(0,n().OF)(b[0].value,e);k=0===b.length||t?g:b}let A=i().Ul(k,(e=>{const t=m.indexOf((0,n().Ix)(e));return t>=0?t:1/0}));A=A.map((e=>b.find((t=>(0,n().Mn)(e,t)))??e));const[w,j]=i().jB(A,(e=>!e.hidden)),I=[...w,...j];a().createAndCommit({userAction:`collectionGroupActions.handleGroupReorder#${d}`,environment:o,canUndo:!0,perform:e=>{(0,s().y)({sortType:"manual",environment:o,collectionContextStore:u,groupByKey:p,groupsFormatKey:d,transaction:e}),(0,c().o)({collectionContextStore:u,newGroups:I,groupsFormatKey:d,transaction:e})}});let T="reorder_groups";return"board_columns"===d?T="board_reorder_groups":"chart_subgroups"===d&&(T="chart_reorder_groups"),(0,l().X)({environment:o,collectionContextStore:u,action:T}),I}},871151:(e,t,o)=>{o.d(t,{p:()=>r});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"3.37 2.95 13.26 14.11",svg:(0,o(474848).jsx)("path",{d:"M3.925 2.95a.55.55 0 1 0 0 1.1h12.15a.55.55 0 1 0 0-1.1zm0 7.767a.55.55 0 0 0 0 1.1h12.15a.55.55 0 1 0 0-1.1zm-.55-4.234a1 1 0 0 1 1-1h1.8a1 1 0 0 1 1 1v1.8a1 1 0 0 1-1 1h-1.8a1 1 0 0 1-1-1zm1.1.1v1.6h1.6v-1.6zm4.625-1.1a1 1 0 0 0-1 1v1.8a1 1 0 0 0 1 1h1.8a1 1 0 0 0 1-1v-1.8a1 1 0 0 0-1-1zm.1 2.7v-1.6h1.6v1.6zm3.625-1.7a1 1 0 0 1 1-1h1.8a1 1 0 0 1 1 1v1.8a1 1 0 0 1-1 1h-1.8a1 1 0 0 1-1-1zm1.1.1v1.6h1.6v-1.6zm-9.55 6.667a1 1 0 0 0-1 1v1.8a1 1 0 0 0 1 1h1.8a1 1 0 0 0 1-1v-1.8a1 1 0 0 0-1-1zm.1 2.7v-1.6h1.6v1.6zm3.625-1.7a1 1 0 0 1 1-1h1.8a1 1 0 0 1 1 1v1.8a1 1 0 0 1-1 1H9.1a1 1 0 0 1-1-1zm1.1.1v1.6h1.6v-1.6zm4.625-1.1a1 1 0 0 0-1 1v1.8a1 1 0 0 0 1 1h1.8a1 1 0 0 0 1-1v-1.8a1 1 0 0 0-1-1zm.1 2.7v-1.6h1.6v1.6z"})},r=(0,o(340498).wt)("squareGridBelowLines",n,"default")},873864:(e,t,o)=>{o.d(t,{v:()=>g});var n=()=>o(908006),r=()=>o(388821),i=()=>o(769864),l=()=>o(666144),a=()=>o(714042),s=()=>o(467676),c=()=>o(180762),u=()=>o(855801),p=()=>o(547149),d=()=>o(447453);async function g(e){const{environment:t,collectionContextStore:o,collectionViewStore:g,collectionSettingsStore:m,intl:y,from:v}=e,f=o.isFullScreenStore.state,h=o.isRootChildStore.state,S=o.isInPeekRendererStore.state,x=o.collectionViewBlockStore(),C="form_editor"===g.getType();let b,k;if(C){var A;const e=null===(A=g.getFormat().form_block_pointer)||void 0===A?void 0:A.id;if(!e)return;const[o,n]=await Promise.all([u().VI.loadLocalSubtree.load(),u().VI.localDuplicate.load()]);if(b=o,k=n,!b||!k)return;if(!b.loadLocalSubtree({environment:t,blockId:e,inMemoryRecordCache:g.inMemoryRecordCache,options:{allowCopyCollections:!1,requireFullSubtree:!0,skipTransclusionContainerChildren:!1,allowCopyExternalObjectInstances:!1}}).recordMap){const o=await i().callCellCompatibleApi({eventName:"loadBlockSubtree",environment:t,data:{block:{id:e,spaceId:g.getSpaceId()},shallow:!1},cellNavigation:{spaceId:g.getSpaceId()}});if("success"===o.type){const e=r().RecordMapWithRole.create(o.data.subtreeRecordMap);await l()._O({environment:t,inMemoryRecordCache:g.inMemoryRecordCache,recordMap:e,debugSource:"load_form_for_duplication"})}}}const{performResult:w}=p().createAndCommit({userAction:"collectionSettingsActions.newView",environment:t,canUndo:!0,perform:e=>{if(C){if(!b||!k)return;return(0,s().F)({environment:t,collectionViewBlockStore:x,collectionViewStore:g,intl:y,transaction:e,loadLocalSubtreeModule:b,localDuplicateModule:k})}return(0,s().t)({environment:t,collectionViewBlockStore:x,collectionViewStore:g,intl:y,transaction:e})}});w&&("chart"===w.getType()&&a().Z({environment:t,collectionContextStore:o,collectionViewId:w.id,from:v}),(0,c().t)({environment:t,collectionContextStore:o,collectionViewId:w.id,isFullScreen:f,isRootChild:h,isInPeekRenderer:S}),n().default.afterNextFlush((()=>{(0,d().O)({collectionContextStore:o,collectionSettingsStore:m,selectViewNameInitial:!0})})))}},956675:(e,t,o)=>{o.d(t,{p:()=>i});var n=()=>o(62371),r=()=>o(452706);function i(e){const{groupBy:t,schema:o,format:i,groupsFormatKey:a,limit:s,subGroupArgs:c}=e,u=o[t.property];if(!u||!(0,n().Eg)(u))return;const p=i[a]||[],d=(0,n().w9)(t,i),g=c&&i[c.groupsFormatKey]||[];return{type:"groups",version:"v2",returnHiddenGroups:e.returnHiddenGroups,returnPinnedGroups:e.returnPinnedGroups,groupBy:d,groupSortPreference:p,limit:Math.min(s,r().O3),subGroup:c?{groupBy:(0,n().w9)(c.groupBy,i),groupSortPreference:g,limit:c.limit}:void 0,aggregation:l({groupAggregation:e.aggregation,subGroupAggregation:null==c?void 0:c.subGroupAggregation}),blockResults:e.blockResults}}function l(e){if(!e.groupAggregation&&!e.subGroupAggregation)return;const t={type:"independent"};return e.groupAggregation&&(t.groupAggregation=e.groupAggregation),e.subGroupAggregation&&(t.subGroupAggregation=e.subGroupAggregation),t}},989992:(e,t,o)=>{o.d(t,{p:()=>r});var n=()=>o(314529);function r(e,t){(0,n().DO_NOT_USE_trackLegacy)(e,"open_collection_as_page",t)}}}]);