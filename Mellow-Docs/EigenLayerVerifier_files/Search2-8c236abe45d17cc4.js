"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[2411,32626,48486,73603,90871,99171],{24126:(e,t,n)=>{n.d(t,{c:()=>o});n(296540);const r={viewBox:"0 0 20 20",fittedViewBox:"3.9 2.75 12.18 14.49",svg:(0,n(474848).jsx)("path",{d:"M12.626 2.768a.625.625 0 0 1 0 1.224l-.126.013h-.125v4.794l3.366 5.159c.893 1.369-.03 3.17-1.623 3.281l-.156.006H6.039c-1.688 0-2.703-1.873-1.78-3.287l3.366-5.157V4.005H7.5a.625.625 0 0 1 0-1.25h5zM8.875 9.173l-.102.156-1.567 2.401h5.589l-1.569-2.403-.101-.156V4.005h-2.25z"})},o=(0,n(340498).wt)("beaker",r,"default")},59110:(e,t,n)=>{n.r(t),n.d(t,{loadLocalSubtree:()=>x});n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(354520),n(803949);var r=()=>n(726637),o=()=>n(700500),i=()=>n(175482),s=()=>n(777447),a=()=>n(792071),l=()=>n(976618),c=()=>n(388821),u=()=>n(696706),d=()=>n(912720),p=()=>n(199378),m=()=>n(179034),f=()=>n(519831),h=()=>n(869558),g=()=>n(37165),v=()=>n(144081),y=()=>n(743246),S=()=>n(201980),b=()=>n(534177);function x(e){const{environment:t,blockId:n,inMemoryRecordCache:r,options:o}=e,i=t.currentUser.id,s=c().RecordMap.create(),a=new Set,l=[{pointer:{table:m().ev,id:n},parentId:"doesn't matter"}];for(;l.length>0;){const e=l.shift();if(!e)continue;if(a.has(e.pointer.id))continue;const t=n===e.pointer.id,c=I({pointer:e.pointer,recordMap:s,inMemoryRecordCache:r,currentUserId:i,cursors:l,cursor:e,options:o,isRootRequest:t});if(c)return c;a.add(e.pointer.id)}return{type:"success",recordMap:s}}function I(e){const{pointer:t,recordMap:n,inMemoryRecordCache:c,currentUserId:x,cursors:I,cursor:k,options:M,isRootRequest:_}=e;let w;return(0,u().Yt)(t,m().ev)?w=function(e){var t,n,l,c;const{pointer:u,recordMap:p,inMemoryRecordCache:f,currentUserId:g,cursors:v,cursor:x,options:I,isRootRequest:k}=e,M=f.getRecord({pointer:u,userId:g}),_=null==M?void 0:M.value;if(!_)return I.requireFullSubtree?{type:"error",reason:"missing_record",pointer:u}:void 0;const w=I.excludeCrdtData?i().ir(_):_;if(I.includeLegacyTransclusionBlockValues){if(!k&&w.parent_id!==x.parentId&&!x.isBlockContentChild)return}else if(!k&&w.parent_id!==x.parentId)return;if(w.type===o().xd.externalObjectInstance&&!I.allowCopyExternalObjectInstances)return{type:"error",reason:"encountered_external_object_instance",pointer:u};if(p.setValue(u,w),!I.skipNavigableChildren){const e=a().Bj6.fromBlock(w).getCollectionPointers();for(const t of e){const e=f.getRecord({pointer:t,userId:g});var C,T;if(e)(null===(C=e.value)||void 0===C?void 0:C.parent_table)===m().ev&&(null===(T=e.value)||void 0===T?void 0:T.parent_id)===w.id&&v.push({pointer:t,parentId:w.id});else if(I.requireFullSubtree)return{type:"error",reason:"missing_record",pointer:t}}if(w.view_ids)for(const t of w.view_ids)v.push({pointer:{table:h().Gy,id:t,spaceId:w.space_id},parentId:w.id})}if(!(I.skipBlockContent||I.skipTransclusionContainerChildren&&"transclusion_container"===w.type||I.skipNavigableChildren&&(0,o().$I)(w.type))){const e=a().Bj6.fromBlock(w).getRenderableContentIds();for(const t of e)v.push({pointer:{table:m().ev,id:t},parentId:w.id,isBlockContentChild:!0})}const A=a().Bj6.fromBlock(w).getNonContentChildren();for(const r of A)v.push({pointer:{table:m().ev,id:r},parentId:w.id,isBlockContentChild:!0});if(w.type===o().xd.externalObjectInstance){var R,E;const e=(null===(R=w.format)||void 0===R?void 0:R.related_external_object_uris_to_instance_ids)&&Object.values(null===(E=w.format)||void 0===E?void 0:E.related_external_object_uris_to_instance_ids)||[];for(const t of e)v.push({pointer:{table:m().ev,id:t,spaceId:w.space_id},parentId:w.id})}if(!I.skipNavigableChildren&&w.properties){const e=Object.values(w.properties).filter(b().O9);for(const t of e)for(const e of t)for(const t of S().uPN(e)){if(S().jIt(t)){const e=S().v55(t);v.push({pointer:{table:m().ev,id:e},parentId:w.id})}if(S().sh$(t)){const e=S().cQR(t),n=(0,s().lX)({url:e,baseUrl:r().A.domainBaseUrl,publicDomainName:r().A.publicDomainName});n&&v.push({pointer:{table:m().ev,id:n},parentId:w.id})}if(S().N53(t)){const e=S().T$c(t);e&&v.push({pointer:{table:m().ev,id:e,spaceId:w.space_id},parentId:w.id})}}}"form"===w.type&&null!==(t=w.format)&&void 0!==t&&t.form_layout_pointer&&v.push({pointer:w.format.form_layout_pointer,parentId:w.id});null!==(n=w.format)&&void 0!==n&&n.automation_id&&v.push({pointer:{table:d().yB,id:w.format.automation_id,spaceId:w.space_id},parentId:w.id});null!==(l=w.format)&&void 0!==l&&l.workflow_id&&v.push({pointer:{table:y().C0,id:w.format.workflow_id,spaceId:w.space_id},parentId:w.id});null!==(c=w.format)&&void 0!==c&&c.ai_instructions_page_pointer&&v.push({pointer:w.format.ai_instructions_page_pointer,parentId:w.id})}({pointer:t,recordMap:n,inMemoryRecordCache:c,currentUserId:x,cursors:I,cursor:k,options:M,isRootRequest:_}):(0,u().Yt)(t,f().Vl)?w=function(e){var t,n;const{pointer:r,recordMap:o,inMemoryRecordCache:i,currentUserId:s,cursors:a,cursor:l,options:c}=e;if(!c.allowCopyCollections)return{type:"error",reason:"encountered_collection",pointer:r};const u=i.getRecord({pointer:r,userId:s});if(null==u||!u.value)return c.requireFullSubtree?{type:"error",reason:"missing_record",pointer:r}:void 0;if(u.value.parent_id!==l.parentId)return;const p=u.value;o.setValue(r,p),i.forEachRecord(s,(({model:e})=>{e.table===m().ev&&e&&e.parent_id===r.id&&e.alive&&a.push({pointer:e.pointer,parentId:r.id})}));const f=(null===(t=p.format)||void 0===t?void 0:t.automation_ids)??[];for(const m of f)a.push({pointer:{table:d().yB,id:m,spaceId:p.space_id},parentId:p.id});p.schema&&Object.values(p.schema).forEach((e=>{e&&"button"===e.type&&e.automation_id&&a.push({pointer:{id:e.automation_id,spaceId:p.space_id,table:d().yB},parentId:p.id})}));null!==(n=p.format)&&void 0!==n&&n.layout_pointer&&a.push({pointer:p.format.layout_pointer,parentId:p.id})}({pointer:t,recordMap:n,inMemoryRecordCache:c,currentUserId:x,cursors:I,cursor:k,options:M}):(0,u().Yt)(t,h().Gy)?w=function(e){var t,n;const{pointer:r,recordMap:o,inMemoryRecordCache:i,currentUserId:s,cursors:a,cursor:l,options:c}=e,u=i.getRecord({pointer:r,userId:s});if(null==u||!u.value)return c.requireFullSubtree?{type:"error",reason:"missing_record",pointer:r}:void 0;if(u.value.parent_id!==l.parentId)return;"form_editor"===u.value.type&&null!==(t=u.value.format)&&void 0!==t&&t.form_block_pointer&&a.push({pointer:u.value.format.form_block_pointer,parentId:u.value.id});null!==(n=u.value.format)&&void 0!==n&&n.dashboard_layout_pointer&&a.push({pointer:u.value.format.dashboard_layout_pointer,parentId:u.value.id});o.setValue(r,u.value)}({pointer:t,recordMap:n,inMemoryRecordCache:c,currentUserId:x,cursors:I,cursor:k,options:M}):(0,u().Yt)(t,d().yB)?w=function(e){const{pointer:t,recordMap:n,inMemoryRecordCache:r,currentUserId:o,cursors:i,cursor:s,options:a}=e,l=r.getRecord({pointer:t,userId:o});if(null==l||!l.value)return a.requireFullSubtree?{type:"error",reason:"missing_record",pointer:t}:void 0;if(l.value.parent_id!==s.parentId)return;n.setValue(t,l.value);for(const c of l.value.action_ids??[])i.push({pointer:{table:p().SC,id:c,spaceId:l.value.space_id},parentId:l.value.id})}({pointer:t,recordMap:n,inMemoryRecordCache:c,currentUserId:x,cursors:I,cursor:k,options:M}):(0,u().Yt)(t,p().SC)?w=function(e){const{pointer:t,recordMap:n,inMemoryRecordCache:r,currentUserId:o,cursors:i,cursor:s,options:a}=e,l=r.getRecord({pointer:t,userId:o});if(null==l||!l.value)return a.requireFullSubtree?{type:"error",reason:"missing_record",pointer:s.pointer}:void 0;if(l.value.parent_id!==s.parentId)return;n.setValue(t,l.value);for(const c of l.value.blocks??[])i.push({pointer:{table:m().ev,id:c,spaceId:l.value.space_id},parentId:l.value.id})}({pointer:t,recordMap:n,inMemoryRecordCache:c,currentUserId:x,cursors:I,cursor:k,options:M}):(0,u().Yt)(t,y().C0)?w=function(e){const{pointer:t,recordMap:n,inMemoryRecordCache:r,currentUserId:o,cursor:i,options:s}=e,a=r.getRecord({pointer:t,userId:o});if(null==a||!a.value)return s.requireFullSubtree?{type:"error",reason:"missing_record",pointer:i.pointer}:void 0;if(a.value.parent_id!==i.parentId)return;n.setValue(t,a.value)}({pointer:t,recordMap:n,inMemoryRecordCache:c,currentUserId:x,cursor:k,options:M}):(0,u().Yt)(t,v().zx)?w=function(e){const{pointer:t,recordMap:n,inMemoryRecordCache:r,currentUserId:o,cursors:i,options:s}=e,c=r.getRecord({pointer:t,userId:o}),u=null==c?void 0:c.value;if(!u)return s.requireFullSubtree?{type:"error",reason:"missing_record",pointer:t}:void 0;n.setValue(t,u);const d=a().Bj6.fromValue(v().zx,u);for(const a of d.getBlockChildrenPointers())i.push({pointer:a,parentId:t.id});const p=e=>{const n={id:e.collection_view_id,table:h().Gy,spaceId:u.space_id};return i.push({pointer:n,parentId:t.id}),e};(0,l().E)(u.modules,(e=>{if("formQuestion"===e.type){const n={id:e.formQuestionId,table:g().lo,spaceId:u.space_id};i.push({pointer:n,parentId:t.id})}else if("view"===e.type)p(e);else if("row"===e.type)for(const t of e.modules)"view"===t.type&&p(t)}))}({pointer:t,recordMap:n,inMemoryRecordCache:c,currentUserId:x,cursors:I,cursor:k,options:M}):(0,u().Yt)(t,g().lo)&&(w=function(e){const{pointer:t,recordMap:n,inMemoryRecordCache:r,currentUserId:o,options:i}=e,s=r.getRecord({pointer:t,userId:o});if(null==s||!s.value)return i.requireFullSubtree?{type:"error",reason:"missing_record",pointer:t}:void 0;n.setValue(t,s.value)}({pointer:t,recordMap:n,inMemoryRecordCache:c,currentUserId:x,cursors:I,cursor:k,options:M})),w}},62088:(e,t,n)=>{n.d(t,{oY:()=>T,uE:()=>C});n(944114),n(898992),n(430670);var r=n(296540),o=()=>n(106702),i=()=>n(920198),s=()=>n(907258),a=()=>n(484714),l=()=>n(590526),c=()=>n(79926),u=()=>n(187174),d=()=>n(68263),p=()=>n(69708),m=()=>n(778078),f=()=>n(496603),h=()=>n(381678),g=()=>n(47373),v=()=>n(499764),y=()=>n(673477),S=()=>n(106628),b=()=>n(534619),x=()=>n(977870),I=()=>n(271084),k=()=>n(233692);const M=75,_=75,w=4;function C(e){const{query:t,useMentionMenuStore:n}=e,o=(0,l().K8)((()=>!(!e.disabled&&!n)&&!y().Ay.state.mentionTypes.user),[e.disabled,n]),{results:i,isLoading:g}=function(e){const{query:t,disabled:n,useMentionMenuStore:o,open:i}=e,g=(0,p().tz)(),k=(0,a().v3)(),_=(0,l().K8)((()=>o?y().Ay.state.open:i),[i,o]),w=(0,l().O$)(s().AppStoreSidebarSpaceStore),C=!n&&t.length>0&&w&&_,T=(0,l().K8)((()=>{var e;const t=I().k.getSortedUserIds(),n=null===(e=(0,h()._)(k))||void 0===e?void 0:e.id;return[...(0,f().oE)([n]),...t]}),[k]),A=(0,l().K8)((()=>{const e=s().default.state.mainEditorCurrentBlockStore;return e?(0,v().i0)(e).flatMap((({permissionItem:e})=>(0,d().B2)(e)?[e.user_id]:[])):[]}),[]),R=(0,c().fJ)(S().T.searchActions),[{value:E=[],status:j}]=(0,u().Yb)((async()=>{if(!C||"resolved"!==R.status)return[];const e=(0,f().sb)([...T,...A]),n=R.value;return(await n.searchUsers({environment:k,parentStore:w,query:t,userIds:e,minFuzzyScore:m().XR,placeSelfFirst:n.isPersonalPronoun(t,g.locale)})).slice(0,3)}),[C,R.status,R.value,T,A,k,w,t,g.locale]),P=(0,l().K8)((()=>w&&x().c.state.wasGetVisibleUsersCalled[w.id]),[w]),[{value:F=[],status:O}]=(0,u().Yb)((async()=>C&&P?(0,b().searchSpaceUsers)({environment:k,query:t,membersOnly:!1,limit:20,minFuzzyScore:m().XR}):[]),[C,k,t,P],{debounce:M}),B=(0,r.useMemo)((()=>{const e=[...E,...F];return(0,f().hS)(e,(e=>e.id))}),[E,F]),D="pending"===O||"pending"===j;return{results:B,isLoading:D}}({query:t,disabled:o,...n?{useMentionMenuStore:!0}:{useMentionMenuStore:!1,open:!0}}),k=(0,l().K8)((()=>y().Ay.state.emptyQueryUserRequestStore.state.result??[]),[]);return{results:0===t.length?k.slice(0,w):i.slice(0,20),isLoading:g}}function T(e){const{query:t,environment:n,useMentionMenuStore:r,open:s}=e,a=(0,l().K8)((()=>r?y().Ay.state.open:s),[s,r]),c=(0,g().ke)(),d=(0,i().L)(),p=(0,o().$)(),m=!(0,l().K8)((()=>!(!e.disabled&&!r)&&!y().Ay.state.mentionTypes.bot),[e.disabled,r])&&c&&a&&Boolean(d)&&Boolean(p),[{value:f=[],status:h}]=(0,u().Yb)((async()=>{if(!m)return[];try{if(!d||!p)return[];const e=await S().T.customAgentSearchService.load(),{workflowStores:r}=await e.getCustomAgents({environment:n,spaceStore:d,userStore:p}),o=e.searchWorkflowStores({query:t,workflowStores:r,limit:5}),i=[];for(const t of o){const e=(0,k().m)(t);i.push({workflowStore:t,name:e.name,icon:e.icon})}return i}catch{return[]}}),[m,d,p,t,n],{debounce:_});return{results:f,isLoading:"pending"===h}}},97835:(e,t,n)=>{n.r(t),n.d(t,{iconDefinition:()=>o,inviteMemberIcon:()=>i});n(296540);var r=n(474848);const o={viewBox:"0 0 20 20",fittedViewBox:"3.68 2.37 15.82 17.13",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{d:"M10 2.375c-1.137 0-2.054.47-2.674 1.242-.608.757-.9 1.765-.9 2.824s.292 2.066.9 2.824c.62.772 1.537 1.241 2.674 1.241s2.055-.469 2.675-1.241c.608-.758.9-1.766.9-2.824 0-1.059-.292-2.067-.9-2.824-.62-.773-1.538-1.242-2.675-1.242M7.676 6.441c0-.842.233-1.554.624-2.042.38-.473.937-.774 1.7-.774s1.32.301 1.7.774c.391.488.624 1.2.624 2.042s-.233 1.554-.624 2.041c-.38.473-.937.774-1.7.774s-1.32-.3-1.7-.774c-.391-.487-.624-1.2-.624-2.041M10 11.63c-2.7 0-5.101 1.315-6.12 3.305-.361.706-.199 1.421.23 1.923.412.48 1.06.767 1.74.767h5.845a4.6 4.6 0 0 1-.28-1.25H5.85c-.342 0-.634-.148-.79-.33-.138-.162-.172-.336-.067-.54.761-1.488 2.672-2.626 5.007-2.626.83 0 1.605.144 2.294.395.269-.364.59-.688.952-.96A7.9 7.9 0 0 0 10 11.63"}),(0,r.jsx)("path",{d:"M16 19.5a3.5 3.5 0 1 1 0-7 3.5 3.5 0 0 1 0 7m2.594-3.469a.625.625 0 0 0-.625-.625h-1.375v-1.375a.625.625 0 0 0-1.25 0v1.375h-1.375a.625.625 0 0 0 0 1.25h1.375v1.375a.625.625 0 1 0 1.25 0v-1.375h1.375c.345 0 .625-.28.625-.625"})]})},i=(0,n(340498).wt)("inviteMember",o,"default")},108184:(e,t,n)=>{n.r(t),n.d(t,{COMPLETION_THROTTLE:()=>k,PREVIEW_STEP_DELAY:()=>M,maybeUpdateAIUsageEligibilityStoreV2:()=>T,maybeUpdateAiEligibility:()=>C,postProcessAICreatedStores:()=>w,showCompletionErrorWithCode:()=>_,wrapTemporaryBlocksInList:()=>A});n(18107),n(967357);var r=()=>n(242422),o=()=>n(675133),i=()=>n(128933),s=()=>n(770063),a=()=>n(878126),l=()=>n(165358),c=()=>n(179034),u=()=>n(427419),d=()=>n(720665),p=()=>n(769864),m=()=>n(722101),f=()=>n(384944),h=()=>n(274873),g=()=>n(412669),v=()=>n(556122),y=()=>n(594794),S=()=>n(668721),b=()=>n(685377),x=()=>n(661077),I=()=>n(96563);const k=300,M=250;function _(e){const t=o().A.getIntl();return 451===e?i().D6({label:t.formatMessage({id:"completionActions.moderationError",defaultMessage:"AI does not allow content that is harmful or illegal. Please revise your input and try again. (451)"})}):413===e?i().D6({label:t.formatMessage({id:"completionActions.promptOrAttachmentTooLarge",defaultMessage:"Query or attachment is too large. Please revise your input and try again. (413)"})}):502===e||503===e||504===e?i().D6({label:t.formatMessage({id:"completionActions.providerError",defaultMessage:"We’re experiencing issues with our AI provider. Try again in a few minutes. ({errorCode})"},{errorCode:e})}):void i().D6({label:t.formatMessage({id:"completionActions.genericError",defaultMessage:"AI is temporarily unavailable. Try again in a few minutes. ({errorCode})"},{errorCode:e})})}function w(e,t){for(const n of t)h().In({environment:e,blockStore:n})}async function C(e,t,n){let o;if(r().default.checkGate({gateName:"usage_based_pricing_pfa_checks_purchased_credits_enabled"}))return void(await T(e,t,n));r().default.checkGate({gateName:"usage_based_pricing_alpha_enabled"})&&T(e,t,n).catch((e=>{l().log({level:"error",from:"ai.completionActions",type:"maybeUpdateAIUsageEligibilityStoreV2Error",spaceId:t,error:e})}));const i=v().TI();if(i.debug)o=402!==i.showErrorCode;else{const r=S().o.getState();if(r&&r.isEligible&&"unlimited"===r.type&&!n){const e=r.lastUpdatedAt;if(Date.now()-e<10*d().Xb)return}const i=await p().callCellCompatibleApi({eventName:"getAIUsageEligibility",environment:e,data:{spaceId:t},cellNavigation:{cellId:void 0,spaceId:t}});if("success"===i.type){o=i.data.isEligible,o&&g().K.state&&g().K.setState(!1);const e=!1===(null==r?void 0:r.isEligible)&&(null==r?void 0:r.requestedAccess),t=i.data.researchModeUsage??0;S().o.setState({...i.data,lastUpdatedAt:Date.now(),researchModeUsage:t,...!1===i.data.isEligible&&{requestedAccess:e}})}}void 0!==o&&x().P.setState(o)}async function T(e,t,n){const r=await a().T.awaitData(e,{spaceId:t}),o=b().y.getData(e,{spaceId:t});if(r){if(o&&(0,u().Hg)(r)&&!n){const e=o.lastUpdatedAt;if(Date.now()-e<10*d().Xb)return}await(0,I().y3)(e,t)}}function A(e){var t;const{environment:n,stores:r,listId:o,inMemoryRecordCache:i,transaction:a}=e,l=(null===(t=r.at(0))||void 0===t?void 0:t.getSpaceId())??a.spaceId,u=new(s().pm)({environment:n,pointer:{table:c().ev,id:o||(0,y().Z1)({environment:n,table:c().ev,spaceId:l}),spaceId:l},recordStoreOptions:{inMemoryRecordCache:i,userId:n.currentUser.id},path:["content"]});for(const s of r)m().BC({parentStore:u,appendStore:s,transaction:a}),f().zv({store:s,data:{parent_id:u.id,parent_table:u.table,alive:!0},transaction:a});return u}},112412:(e,t,n)=>{n.r(t),n.d(t,{filterSmallIcon:()=>o,iconDefinition:()=>r});n(296540);const r={viewBox:"0 0 16 16",fittedViewBox:"1.69 3.69 12.61 8.61",svg:(0,n(474848).jsx)("path",{d:"M2.4 3.7a.7.7 0 1 0 0 1.4h11.2a.7.7 0 1 0 0-1.4zm9.5 3.594H4.1a.7.7 0 1 0 0 1.4h7.8a.7.7 0 1 0 0-1.4M5.8 10.9a.7.7 0 1 0 0 1.4h4.4a.7.7 0 1 0 0-1.4z"})},o=(0,n(340498).wt)("filterSmall",r,"small")},133043:(e,t,n)=>{n.d(t,{P:()=>o});n(296540);const r={viewBox:"0 0 20 20",fittedViewBox:"2.5 3.05 15 13.82",svg:(0,n(474848).jsx)("path",{d:"M9.08 3.341a1.625 1.625 0 0 1 1.84 0l5.875 4.035c.441.304.705.805.705 1.34v6.034a2.125 2.125 0 0 1-2.125 2.125h-2.716a1.625 1.625 0 0 1-1.625-1.625v-4.065H8.967v4.065c0 .898-.728 1.625-1.625 1.625H4.625A2.125 2.125 0 0 1 2.5 14.75V8.716c0-.535.264-1.036.705-1.34zm1.132 1.03a.375.375 0 0 0-.424 0L3.913 8.407a.38.38 0 0 0-.163.309v6.034c0 .483.392.875.875.875h2.716a.375.375 0 0 0 .375-.375v-4.19c0-.621.503-1.125 1.125-1.125h2.319c.62 0 1.124.504 1.124 1.125v4.19c0 .207.168.375.375.375h2.716a.875.875 0 0 0 .875-.875V8.716c0-.124-.06-.24-.163-.31z"})},o=(0,n(340498).wt)("home",r,"default")},135599:(e,t,n)=>{n.d(t,{W:()=>W});n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(823215),n(354520),n(581454);var r=n(296540),o=()=>n(755531),i=()=>n(242422),s=()=>n(726637),a=()=>n(395361),l=()=>n(484714),c=()=>n(590526),u=()=>n(721908),d=()=>n(79926),p=()=>n(929219),m=()=>n(711339),f=()=>n(295633),h=()=>n(732810),g=()=>n(302996),v=()=>n(591779),y=()=>n(206267),S=()=>n(519831),b=()=>n(96689),x=()=>n(620333),I=()=>n(245241),k=()=>n(496603),M=()=>n(973647),_=()=>n(534177),w=()=>n(222917),C=()=>n(769864),T=()=>n(383070),A=()=>n(518362),R=()=>n(825972),E=()=>n(466088),j=()=>n(798693),P=()=>n(487542),F=()=>n(113416),O=()=>n(470928),B=()=>n(475553),D=()=>n(106628),N=()=>n(361330),V=()=>n(499233),L=()=>n(671199),z=()=>n(326589),q=()=>n(968172),U=()=>n(558407),K=()=>n(873049),H=()=>n(770167);function W(e){var t;const{options:n,...y}=e,{overrideSearchSessionId:W,overrideSpaceStore:Q,disable:Z,debug:X,onLocalSearchBegin:J}=n,{type:ee,query:te="",source:ne,limit:re,peopleBlocksToInclude:oe}=y,ie=re??20,se=(0,l().v3)(),ae=(0,v().ZC)(te),le=(0,v().ZC)(e.filters),ce=(0,v().ZC)(e.sort),ue=(0,v().ZC)(e.options.searchExperimentOverrides),de=(0,v().ZC)(X),pe=(0,r.useRef)(0),me=(0,r.useRef)(!0),fe=(0,c().O$)(p().e),he=!fe,ge=(0,B().y)(),ve=(0,r.useRef)(ie),[ye,Se]=(0,r.useState)(G()),be=(0,c().K8)((()=>W&&W!==ye.searchSessionId?(Se((e=>({...e,searchSessionId:W}))),W):ye.searchSessionId),[ye,W]);(0,r.useEffect)((()=>{pe.current=0}),[be]);const xe=(0,r.useRef)(),Ie=(0,r.useRef)(new Map),ke=(0,r.useRef)(void 0),Me=(0,c().K8)((()=>T().zD.isSearchModalV2Enabled()),[]),_e=(0,r.useCallback)((()=>{xe.current&&(m().default.measure(xe.current,{environment:se,data:{query_length:te.length,source:ne,search_session_id:be,is_search_modal_v2:Me}}),xe.current=void 0)}),[se,te.length,ne,be,Me]),we=(0,r.useCallback)((e=>{const t=ke.current;if(void 0!==t){const n=Date.now()-t;Ie.current.set(e,n)}}),[]),Ce=(0,r.useCallback)((e=>Ie.current.get(e)),[]),{localResults:Te,serverResults:Ae,isResultsLoading:Re,numTotalLocalResults:Ee,numTotalServerResults:je}=ye,Pe=(0,c().K8)((()=>Q||(0,o().S)()),[Q]),Fe=(0,c().K8)((()=>{if(he||Re&&me.current)return Te;let e=function(e){const{localResults:t,serverResults:n}=e,r=t.map((e=>e.store.id)),o=new Set(r),i=n.filter((e=>!o.has(e.store.id)));return[...t,...i]}({localResults:Te,serverResults:Ae});return ee===I().Vz.CollectionsInSpace&&(e=Y(e)),e}),[he,Re,Te,ee,Ae]),Oe=(0,c().K8)((()=>"on"===i().default.getEligibleGroup({experimentId:"search-use-local-reranker-layered",parameter:"shouldUseLocalReranker",defaultGroup:"control"})),[]),Be=(0,r.useMemo)((()=>e.sort?e.sort:{field:"relevance"}),[e.sort]),De=(0,r.useMemo)((()=>{var t;const r=(t=>{switch(e.type){case I().Vz.BlocksInCollection:return e.collectionId;case I().Vz.BlocksInParent:return e.parentId;default:return null===(t=e.filters)||void 0===t?void 0:t.parentId}})(),o={...e.filters,navigableBlockContentOnly:void 0!==(null===(t=e.filters)||void 0===t?void 0:t.navigableBlockContentOnly)?e.filters.navigableBlockContentOnly:!0===n.isTitleOnly,parentId:r};return(0,I().N2)(o)}),[n.isTitleOnly,e]),Ne=(0,r.useCallback)(((e,t)=>{const{isSuccess:n,totalResultsCount:r,localCacheMetadata:o,query:i}=t;m().default.measure(e,{environment:se,data:{start_time:e.startTime,success:n,surface:ne,num_results:r,search_session_id:be,local_cache_metadata:o,local_cache_readiness_timings:(0,V().Yp)(),query_length:i.length}})}),[se,ne,be]),Ve=(0,r.useCallback)(((e,t)=>{const{isSuccess:n,totalResultsCount:r,query:o}=t;m().default.measure(e,{environment:se,data:{start_time:e.startTime,success:n,surface:ne,num_results:r,search_session_id:be,search_session_flow_number:pe.current,query_length:o.length}})}),[se,ne,be]),Le=(0,r.useMemo)((()=>{if(n.disableLocalSearch)return!1;const t=(0,P().B)(te),r=e.options.searchExperimentOverrides,o="on"===(null==r?void 0:r["search-no-local-blending"]);return"trash"===ne||(0,F().B)({isLocalBlendingDisabled:o,queryOperations:t,queryText:te,querySort:Be})}),[n.disableLocalSearch,e.options.searchExperimentOverrides,te,Be,ne]),ze=(0,c().K8)((()=>L().A.state.localSearchableBlocksCache),[]),qe=(0,d().fJ)(D().T.searchActions),Ue=(0,r.useCallback)((t=>{var n;const{query:r,spaceStore:o}=t;if(!Le)return Se((e=>({...e,localResults:[],numTotalLocalResults:0}))),void(null==J||J({query:r}));null==J||J({query:r});const i=m().default.mark("rum.local_quick_search_query"),s=ge&&!fe&&(0,_().Xk)(I().Iy,ne);if("resolved"!==qe.status)return;const a=ee===I().Vz.CollectionsInSpace,l=a&&0===r.length?function(e){const{spaceStore:t,environment:n}=e,r=(0,A().F)({currentUserId:n.currentUser.id,spaceId:t.id}).map((e=>{const n=h().m.createChildStore(t,{table:S().Vl,id:e}).getParentBlockStore();if(null==n?void 0:n.pathIsAccessibleAndAlive())return n}));return(0,k().oE)(r)}({environment:se,spaceStore:o}).map(((e,t)=>({store:e,originalPosition:t,id:e.id,score:0,spaceId:e.getSpaceId(),sources:[I().Ni.Local],featureGroups:[],serverEventProperties:void 0}))):[],c=(0,V().PE)({environment:se,overrideCurrentUserId:se.currentUser.id,overrideSpaceId:o.id,overrideLocalSearchableBlocksCache:ze}),u=(0,j().E)(se).hasPublicAccessPermission,{filters:d,excludedBlockIds:p}=(0,x().CT)({peopleBlocksToInclude:oe,filters:De,excludedBlockIds:void 0,spaceIdCreator:se.idCreator.getSpaceIdCreatorSync(o.id)}),f=(0,H().S6)({environment:se,parentStore:o,spaceStore:o,isOnline:fe,requestInput:{query:{text:r,filters:{...d,blockTypes:$({blockTypes:null===(n=e.filters)||void 0===n?void 0:n.blockTypes,queryType:ee}),isOfflineOnly:s},sort:{field:"relevance"}},limit:he?ie:Math.min(ie,5)},localSearchCache:ze,forceLocalCacheUsage:"trash"===ne,shouldUseNewRerankerDebugOverrideEnabled:Oe,shouldLimitLocalResultsWhenOnline:!he,hasPublicAccessPermission:u}),g=f&&M().Q.unwrapOr(f,void 0),v=(null==g?void 0:g.results)??[],b=(null==g?void 0:g.total)??0;let w=k().hS([...l,...v],(e=>(0,K().a)(e)));w=a?Y(w):w,w=w.filter((e=>!p.includes(e.id)&&!(y.excludedBlockIds??[]).includes(e.id)&&(null==Pe?void 0:Pe.id)===e.spaceId)),Se((e=>e.query!==r?e:(lt.current=w.map((e=>e.id)),Ne(i,{query:r,isSuccess:Boolean(g),totalResultsCount:b,localCacheMetadata:c}),{...e,localResults:w,isResultsLoading:!he&&e.isResultsLoading,numTotalLocalResults:b})))}),[ge,fe,ne,qe.status,ee,se,ze,De,null===(t=e.filters)||void 0===t?void 0:t.blockTypes,he,Pe,ie,Oe,Ne,y.excludedBlockIds,Le,oe,J]),Ke="quick_find"===ne?40:N().GR,He=(0,a().Y)(Ue,Ke),We=(0,r.useCallback)((t=>{var n,r,o,i,a;const{result:l,isMetaClick:c,context:u}=t,d=void 0!==l.workflowData;w().sg(se,{...l.serverEventProperties&&l.serverEventProperties["server-query"]?{"server-query":l.serverEventProperties["server-query"]}:{},queryText:l.serverEventProperties&&l.serverEventProperties["server-query"]&&l.serverEventProperties["server-query"].query?l.serverEventProperties["server-query"].query:te,sources:l.sources,localSources:Array.from(l.localSource||new Set),searchSessionId:be,aiSessionId:void 0,traceId:void 0,searchSessionFlowNumber:pe.current,context:u,queryStringLength:te.length,totalSearchResultCount:Ee+je,numLocalResults:Te.length,numTotalLocalResults:Ee,isMobile:s().A.isMobile,isMetaClick:c,hasFilters:Boolean(e.filters),originalPosition:l.originalPosition,selectedItemIndex:l.originalPosition,selectedSearchResultMetadata:{blockId:l.id,blockType:d?"workflow":l.store.getModel().type},searchSource:ne,verificationState:(0,O().i1)(l.store),numKeystrokes:null===(n=t.searchSessionMetrics)||void 0===n?void 0:n.numKeystrokes,timeToSelectMs:null===(r=t.searchSessionMetrics)||void 0===r?void 0:r.timeToSelectMs,timeFromFirstKeyStrokeToSelectMs:null===(o=t.searchSessionMetrics)||void 0===o?void 0:o.timeFromFirstKeyStrokeToSelectMs,hadMetaClick:null===(i=t.searchSessionMetrics)||void 0===i?void 0:i.hadMetaClick,timeToRenderResult:null===(a=t.searchSessionMetrics)||void 0===a?void 0:a.timeToRenderResult})}),[se,Ee,je,Te,te,be,pe,e.filters,ne]),Ge=ae===te,$e=k().n4(le,e.filters),Ye=k().n4(ce,e.sort),Qe=k().n4(ue,e.options.searchExperimentOverrides),Ze=de===X,Xe=$e&&Ge&&Ye&&Qe&&Ze,Je=(0,c().K8)((()=>{const{publicAccessPermissionAncestorBlockId:e}=(0,j().E)(se);return void 0!==e&&((0,E().w)(se)||(0,z().g)())}),[se]),et=0===te.length,tt=Boolean(ae&&et),nt=!Z&&(Pe||Je)&&!Xe,rt=!($e&&Ye&&Qe&&Ze),ot=tt||!Ge||rt,it=et||rt,st=(0,r.useRef)(!1),at=(0,r.useRef)([]),lt=(0,r.useRef)([]),ct=(0,c().K8)((()=>{if("mention_menu"!==ne)return;return U().A.getMentionedIds(se.currentUser.id)}),[se.currentUser.id,ne]),ut=(0,r.useCallback)((async t=>{xe.current=m().default.mark("time_to_render_search_results"),void 0===ke.current&&(ke.current=Date.now());const n=m().default.mark("rum.server_quick_search_query"),{query:r,spaceStore:o,size:i}=t,s=null==o?void 0:o.id;if(he)return;const a=!me.current&&$e?at.current:[],l=k().sb([...y.excludedBlockIds??[],...lt.current||[]]),{finalFilters:c,finalExcludedBlockIds:u,isPublicAncestorSearch:d,publicAccessPermissionAncestorBlockId:p}=function(e){const{environment:t,peopleBlocksToInclude:n,filters:r,serverExcludedBlockIds:o,spaceId:i}=e,{filters:s,excludedBlockIds:a}=i?(0,x().CT)({peopleBlocksToInclude:n,filters:r,excludedBlockIds:o,spaceIdCreator:t.idCreator.getSpaceIdCreatorSync(i)}):{filters:r,excludedBlockIds:o},{shouldIncludePublicPages:l,isPublicAncestorSearch:c,publicAccessPermissionAncestorBlockId:u}=(0,H().dB)({environment:t,spaceId:i}),d=l?{...s,includePublicPagesWithoutExplicitAccess:!0}:s;return{finalFilters:d,finalExcludedBlockIds:a,isPublicAncestorSearch:c,publicAccessPermissionAncestorBlockId:u}}({environment:se,peopleBlocksToInclude:oe,filters:De,serverExcludedBlockIds:l,spaceId:s}),h=ee===I().Vz.BlocksInSpace&&d&&p?{type:I().Vz.BlocksInAncestor,ancestorId:p}:s?{spaceId:s}:void 0;if(!h)return void Se((e=>({...e,isResultsLoading:!1})));pe.current+=1;const v={...y,...h,excludedBlockIds:u,query:r,sort:Be,filters:c,recentlyMentionedPageIds:ct,searchSessionFlowNumber:pe.current,searchSessionId:be,limit:i,recentPagesForBoosting:s?(0,R().cs)(q().A.getWithoutSubscribing(s)):[],ignoresHighlight:"quick_find"!==ne||!0===De.navigableBlockContentOnly,searchExperimentOverrides:e.options.searchExperimentOverrides,debug:X},S=await C().callApi({eventName:"search",environment:se,data:v});if(!S||"failed"===S.type)return void Se((e=>({...e,isResultsLoading:!1})));const M=S.data.total,w=(0,_().MU)((0,_().WP)(S.data.trackEventProperties).map((([e,t])=>[`server-${e}`,t]))),T=S.data.results.slice(0,i).map(((e,t)=>{const n=o??new(g().SpaceStore)(se,{table:b().NX,id:e.spaceId}),r=f().B.createChildStore(n,{id:e.id,spaceId:e.spaceId,table:"block"}),i=e.terms;return{store:r,originalPosition:t,...e,serverEventProperties:w,terms:i}}));st.current=!(M<i);const A=k().hS([...a,...T],(e=>(0,K().a)(e)));at.current=A,Se((e=>e.query!==r?e:(Ve(n,{query:r,isSuccess:"success"===S.type,totalResultsCount:M}),{...e,serverResults:A,isResultsLoading:!1,numTotalServerResults:M,debugInfo:S.data.debug})))}),[he,$e,y,e.options.searchExperimentOverrides,Be,De,ct,be,ne,se,Ve,X,oe,ee]),dt=(0,r.useCallback)((e=>{if(Z||!Pe||!st.current||Re||!fe)return;const t=e??20;ve.current+=t,st.current=!1,me.current=!1,Se((e=>({...e,isResultsLoading:!0}))),ut({query:te,spaceStore:Pe,size:ve.current})}),[Pe,Z,ut,fe,Re,te]),pt="quick_find"===ne?100:N().ab,mt=(0,u().d)(dt,pt),ft=(0,a().Y)(ut,N().ab);return(0,r.useEffect)((()=>{ot&&(at.current=[],Ie.current.clear(),ke.current=void 0,ve.current=ie,st.current=!0,Se((e=>{const t=it?[]:e.localResults;return{...G(),localResults:t,numTotalLocalResults:t.length,searchSessionId:e.searchSessionId}}))),nt&&(me.current=!0,Se((e=>({...e,isResultsLoading:!0,query:te}))),ke.current=Date.now(),Pe&&He({query:te,spaceStore:Pe}),ft({query:te,spaceStore:Pe,size:ve.current}))}),[Pe,He,ft,ie,te,nt,ot,ne,Ge,it]),{results:Fe,isResultsLoading:Re,searchSessionId:be,fetchAdditionalServerResultsOnChange:!Z&&!he&&st.current&&Xe?mt:void 0,searchSessionFlowNumber:pe.current,hasMoreResults:st.current,debugInfo:ye.debugInfo,searchAnalytics:{trackSelectSearchItem:We,endTimeToRenderServerResultsTiming:_e,setResultRenderTime:we,getResultRenderTime:Ce}}}function G(){return{query:void 0,localResults:[],numTotalLocalResults:0,serverResults:[],numTotalServerResults:0,searchSessionId:(0,y().JW)(),isResultsLoading:!1,debugInfo:void 0}}function $(e){const{blockTypes:t,queryType:n}=e;switch(n){case I().Vz.CollectionsInSpace:return["collection_view","collection_view_page"];case I().Vz.BlocksInCollection:return["page","collection_view_page"];case I().Vz.BlocksInSpace:default:return t??[]}}function Y(e){const t=new Set;return e.filter((e=>{const n=e.store,r=(null==n?void 0:n.getCollectionStores())??[];if(r.every((e=>t.has(e.id))))return!1;for(const o of r)t.add(o.id);return!0}))}},158115:(e,t,n)=>{n.r(t),n.d(t,{arrowChevronSingleRightFillSmallIcon:()=>o,iconDefinition:()=>r});n(296540);const r={viewBox:"0 0 16 16",fittedViewBox:"5.54 2.94 5.81 10.11",directional:!0,svg:(0,n(474848).jsx)("path",{d:"M11.13 8.53a.75.75 0 0 0 0-1.06L6.81 3.15a.75.75 0 0 0-1.06 1.06L9.54 8l-3.79 3.79a.75.75 0 0 0 1.06 1.06z"})},o=(0,n(340498).wt)("arrowChevronSingleRightFillSmall",r,"fillSmall")},170350:(e,t,n)=>{n.r(t),n.d(t,{filterIcon:()=>o,iconDefinition:()=>r});n(296540);const r={viewBox:"0 0 20 20",fittedViewBox:"2.37 4.87 15.25 10.25",svg:(0,n(474848).jsx)("path",{d:"M3 4.875a.625.625 0 1 0 0 1.25h14a.625.625 0 1 0 0-1.25zm2.125 5.742h9.75a.625.625 0 1 0 0-1.25h-9.75a.625.625 0 1 0 0 1.25m1.5 3.883c0-.345.28-.625.625-.625h5.5a.625.625 0 1 1 0 1.25h-5.5a.625.625 0 0 1-.625-.625"})},o=(0,n(340498).wt)("filter",r,"default")},200424:(e,t,n)=>{e.exports=n.p+"9ade71d75a1c0e93.png"},233692:(e,t,n)=>{function r(e,t="Untitled Agent"){return{name:e.getName()||t,icon:e.getRawIcon()||""}}n.d(t,{m:()=>r})},241319:(e,t,n)=>{n.d(t,{y:()=>i});n(898992),n(672577);var r=()=>n(534177),o=()=>n(239381);function i(e){var t;const{actionModels:n,id:i}=e,s=(0,o().y5)(i),a="action"===s.source?n.find((e=>e.id===s.action_id)):void 0,l=(0,r().O9)(a)&&a.isType("create_page")?null===(t=a.getConfig())||void 0===t?void 0:t.collection:void 0;return{automationValueInfo:s,collectionPointer:l,actionModel:a}}},253447:(e,t,n)=>{n.d(t,{F:()=>o});var r=()=>n(963575);function o(e,t){if(e)return e;switch(t){case"large":return r().A.card.desktop.large.height;case"small":return r().A.card.desktop.small.height;default:return r().A.card.desktop.medium.height}}},255043:(e,t,n)=>{n.d(t,{O:()=>x,r:()=>I});n(898992),n(672577),n(581454);var r=n(296540),o=()=>n(401497),i=()=>n(249046),s=()=>n(250910),a=()=>n(807449),l=()=>n(546926),c=()=>n(631524),u=()=>n(302501),d=()=>n(890492),p=()=>n(81068),m=()=>n(663639),f=()=>n(736847),h=()=>n(324254),g=()=>n(676510),v=()=>n(534177),y=()=>n(608346),S=()=>n(419357),b=n(474848);function x(e){return(0,b.jsxs)(i().Ye,{alignItems:"center",style:{gap:4},children:[e.icon,(0,b.jsx)(u().A,{isSmall:e.isSmall,children:e.name})]})}function I(e){const{onSelectOption:t,options:n,currentOption:i,placeHolder:d,initialFocus:m,menuProps:f,iconOnly:y,inputProps:I,searchThreshold:M,selectorButtonStyle:_}=e,[w,C]=(0,r.useState)(""),T=n.find((({key:e})=>e===i)),A=(0,o().IS)((()=>({workspaceSelectorButton:{paddingTop:8,paddingBottom:8,paddingInlineStart:8,paddingInlineEnd:8,opacity:1,width:376,border:`1px solid ${g().$.light.gray[100]}`,justifyContent:"space-between",marginTop:8,marginBottom:8},teamspacePickerButton:{maxWidth:300},menuChevronDownIcon:{marginInlineStart:4}})),[]),R={..."workspace"===_?A.workspaceSelectorButton:{},..."teamspace"===_?A.teamspacePickerButton:{}};return(0,b.jsx)(s().A,{popupType:s().z.Popup,placementToOrigin:"bottom",alignmentToOrigin:e.alignmentToOrigin,originGap:4,renderOrigin:e=>(0,b.jsxs)(c().p,{...e,style:{color:i?void 0:g().$.light.gray[300],...R},children:[(0,b.jsx)(u().A,{style:{textOverflow:"ellipsis",fontSize:"14px",font:"SF Pro Text",color:i?void 0:"#ACABA9",lineHeight:"19.6px"},children:(y?null==T?void 0:T.icon:T&&(0,b.jsx)(x,{...T}))??d}),(0,b.jsx)(a().I,{icon:h().arrowChevronSingleDownSmallIcon,size:"xs",colorVariant:"secondary",style:A.menuChevronDownIcon})]}),render:e=>{const r=(0,b.jsx)(S().Ay,{style:{width:"100%",paddingTop:8,paddingBottom:2},onChange:e=>C(e.target.value),value:w,...I}),o={menuType:l().gu.Popup,width:376,left:50,header:(0,v().O9)(M)&&n.length>M?r:null,...f},s=n.map((({key:n,name:r,icon:o,searchTerm:s})=>({key:n,keywords:s??[],action:()=>{t(n),e.close()},render:e=>(0,b.jsx)(p().A,{...e,title:(0,b.jsx)(x,{name:r,icon:o}),shouldWrapCaption:!0,isChecked:i===n})})));return(0,b.jsx)(k,{menuOptions:o,menuItems:s,filterQuery:w,initialFocus:m})}})}function k({menuOptions:e,menuItems:t,filterQuery:n,initialFocus:r}){const o=(0,y().m)({sections:[{key:"dropdown.menuList",render:e=>(0,b.jsx)(f().A,{...e}),items:t}],filterQuery:n||void 0});return(0,b.jsx)(d().A,{...e,children:(0,b.jsx)(m().A,{type:m().O.Vertical,sections:o,initialFocus:r,style:{position:"relative",alignItems:"flex-end"}})})}},271232:(e,t,n)=>{n.d(t,{t:()=>i});var r=n(296540),o=n(474848);const i=r.memo((function(e){const{coverHeight:t,coverSizeFormat:r,emptyGalleryCoverStyle:i}=e,s=(0,n(401497).IS)((()=>({container:{height:(0,n(253447).F)(t,r),...i}})),[t,r,i]);return(0,o.jsx)("div",{style:s.container})}))},278589:(e,t,n)=>{n.d(t,{N:()=>i});var r=()=>n(534177),o=()=>n(126126);function i(e){return"avatar"===e?o().eQ:"xsmall"===e?18:"xsmall_plus"===e?24:"small"===e?28:"small_plus"===e?32:"medium"===e?36:"medium_plus"===e?44:"medium_large"===e?48:"large"===e?50:"large_plus"===e?64:"xlarge"===e?94:"plans"===e?20:"deep_dive"===e?16:"upsell_banner"===e?74:"personalization_modal"===e?96:(0,r().HB)(e)}},298182:(e,t,n)=>{n.d(t,{B5:()=>c,CJ:()=>s,CO:()=>i,Sf:()=>d,md:()=>a,wb:()=>l});n(814603),n(147566),n(198721);var r=()=>n(939768);const o={dateRangeFilter:{everything:!0},excludeCreatedByFilter:{everything:!0},createdByFilter:{everything:!1,notion:!0},titleOnlyFilter:{everything:!1,notion:!0},ancestorsFilter:{everything:!1,notion:!0},teamspacesFilter:{everything:!1,notion:!0}};function i(e,t){const n=function(e){switch(e){case"notion":case"workspace":case"teamspace":case"page":case"collection":case"site":return"notion";case"slack":return"slack";case"google-drive":return"google-drive";case"github":return"github";case"jira":return"jira";case"helpdocs":return"helpdoc";case"web":return"webpage";default:return"all"}}(e);return o[t][n]||o[t].everything}function s(e,t){return!!e&&Boolean(o[t][e]||o[t].everything)}const a=(0,n(756005).xS)({page:!0,collection:!1,createPage:!1,user:!0,inviteUserToWorkspace:!1,inviteUserToPage:!1,date:!0,reminder:!1,bot:!1,group:!1,team:!0,heading:!1,templateVariable:!1,formulaContextVariable:!1,slackSpecialMention:!1,property:!1});function l(e){switch(e){case"pull-request":return"Pull Request";case"issue":return"Issue";case"code":return"Code";default:return null}}function c(e){if(!e)return e;let t=e;return t=t.replace(/<gzkNfoUU>/g,"§§HIGHLIGHT_START§§"),t=t.replace(/<\/gzkNfoUU>/g,"§§HIGHLIGHT_END§§"),t=t.replace(/<(.*?)\|([^>]*)>/g,((e,t,n)=>{try{return new URL(n),u(n)}catch{return n.length>0?n:t}})),t=t.replace(/<(\S+(?:\s+\S+)*)>/g,((e,t)=>{try{return new URL(t),u(t)}catch{return t}})),t=d(t),t=t.replace(/§§HIGHLIGHT_START§§/g,"<gzkNfoUU>"),t=t.replace(/§§HIGHLIGHT_END§§/g,"</gzkNfoUU>"),t=function(e){return e.replace(/&amp;/g,"&")}(t),t}function u(e){if(!e||""===e.trim()||e.trim().includes(" "))return e;const t=e.trim();let n=r().qg(t),o=n.host;if(n.protocol&&o||(n=r().qg(`http://${t}`),o=n.host),!o)return e;o=o.replace(/^www./i,"");const i=n.pathname||"",s=n.hash||"";if(i.length+s.length<=20)return`${o}${i}${s}`;const a=i+s;return`(${o}${a.slice(0,3)}…${a.slice(-3)})`}function d(e){let t=e;return t=t.replace(/(&gt;)/g,">"),t=t.replace(/(&lt;)/g,"<"),t}},299177:(e,t,n)=>{n.d(t,{A:()=>i});class r extends(()=>n(757695))().Store{getInitialState(){return{}}}const o=new r;n(852832).exposeDebugValue("SpaceWorkflowTemplateInstanceMapStore",o);const i=o},313171:(e,t,n)=>{n.d(t,{L:()=>s});n(296540);var r=()=>n(970236),o=()=>n(69708),i=n(474848);function s(){return(0,i.jsx)(r().E,{content:(0,i.jsx)(o().sA,{id:"spaceUserMembershipType.restrictedMember",defaultMessage:"Restricted"}),color:"yellow"})}},320865:(e,t,n)=>{n.d(t,{A:()=>o});n(296540);var r=n(474848);const o=function(){return(0,r.jsx)(n(424400).Ay,{title:(0,r.jsx)(n(98126).k,{size:"default"}),titleStyle:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%"}})}},326887:(e,t,n)=>{n.d(t,{$X:()=>i,H8:()=>s,x2:()=>o});var r=()=>n(534177);function o(e){return"event"===e||"recurrence"===e}function i(e){const t=e.getTrigger();return(0,r().O9)(t)&&o(t.type)}function s(e){return"event"===e?"event":"recurrence"===e?"recurrence":void(0,r().HB)(e)}},341694:(e,t,n)=>{n.d(t,{H:()=>c});var r=()=>n(907258),o=()=>n(590526),i=()=>n(21510),s=()=>n(673477),a=()=>n(696746);const l=["reply_menu_all_updates","reply_menu_archive","reply_menu_mentions_comments"];function c(){const e=(0,o().K8)((()=>i().A.state.open&&l.includes(i().A.state.discussionLocation)),[]),t=(0,o().K8)((()=>s().Ay.getIsMockText()),[]),n=(0,o().K8)((()=>(0,a().lU)(r().default.state.mainEditorCurrentBlockStore)),[]);return!t&&!e&&!n}},344417:(e,t,n)=>{n.r(t),n.d(t,{iconDefinition:()=>r,magnifyingGlassSmallIcon:()=>o});n(296540);const r={viewBox:"0 0 16 16",fittedViewBox:"1.97 1.97 12.46 12.46",svg:(0,n(474848).jsx)("path",{d:"M7.1 1.975a5.125 5.125 0 1 0 3.155 9.164l3.107 3.107a.625.625 0 1 0 .884-.884l-3.107-3.107A5.125 5.125 0 0 0 7.1 1.975M3.225 7.1a3.875 3.875 0 1 1 7.75 0 3.875 3.875 0 0 1-7.75 0"})},o=(0,n(340498).wt)("magnifyingGlassSmall",r,"small")},348869:(e,t,n)=>{n.d(t,{g:()=>a});n(944114);var r=()=>n(792057),o=()=>n(785728),i=()=>n(532659),s=()=>n(769864);async function a(e){const{environment:t,onResponse:n,data:a,userId:l,tracking:c,abortSignal:u}=e,d=await s().callStreamApi({eventName:"runInferenceTranscript",environment:t,data:a,userId:l,tracking:c,abortSignal:u,headers:(0,o().WS)({spaceId:a.spaceId})});if("success"!==d.type)return null!=u&&u.aborted?{error:{message:"Aborted",code:0}}:(r().Qg(d),{error:{message:d.error.message,code:d.status}});const p=[];if(i().hS.is(d.data))for await(const r of d.data){if("error"===r.type)return{error:{message:r.message,code:r.errorCode}};null==n||n(r),p.push(r)}return{value:p}}},358006:(e,t,n)=>{n.d(t,{z:()=>s});n(296540);var r=()=>n(79926),o=n(474848);const i=new(r().O2)("CollectionItemCover",(async()=>{const{CollectionItemCover:e}=await n.e(79883).then(n.bind(n,873718));return{CollectionItemCover:e}})),s=(0,r()._h)(i,(e=>e.CollectionItemCover),{renderLoading:(e,t)=>{const{coverHeight:r,coverSizeFormat:i,emptyGalleryCoverStyle:s,showEmptyGalleryCover:a}=t;return a?(0,o.jsx)(n(271232).t,{coverHeight:r,coverSizeFormat:i,emptyGalleryCoverStyle:s}):null}})},362976:(e,t,n)=>{function r(e){const t=e.getSchema();if(t)for(const[r,o]of Object.entries(t)){var n;if(o&&"text"===o.type&&"summarize"===(null===(n=o.ai_inference)||void 0===n?void 0:n.type)){const t=e.getPropertyValue(r);if(t)return t}}}n.d(t,{E:()=>r})},375555:(e,t,n)=>{function r(e,t){const{device:n}=e;n.isAndroid&&t.focus(),t.select()}n.d(t,{G:()=>r})},381379:(e,t,n)=>{n.d(t,{r:()=>w});n(898992),n(354520),n(581454);var r=n(296540),o=()=>n(907258),i=()=>n(484714),s=()=>n(590526),a=()=>n(295633),l=()=>n(732810),c=()=>n(688610),u=()=>n(179034),d=()=>n(519831),p=()=>n(245241),m=()=>n(534177),f=()=>n(807700),h=()=>n(486674),g=()=>n(825972),v=()=>n(786937),y=()=>n(135599),S=()=>n(981342),b=()=>n(311337),x=()=>n(73199);const I=20;function k(e,t){return e instanceof a().B?t?!e.isPersonProfile():!e.isPersonProfile()&&!e.isPeopleCollectionViewPage():e instanceof l().m||void(0,m().HB)(e)}function M(e){return!(e instanceof a().B)||!e.isTeamPage()}function _(e){return e instanceof l().m?!(0,f().l)(e)&&!(0,c().z)(e):e instanceof a().B||void(0,m().HB)(e)}function w(e){const{query:t,disabled:n,includeDataSources:a,blockStore:c}=e,m=(0,i().v3)(),f=(0,s().O$)(o().AppStoreSidebarSpaceStore),w=(0,s().K8)((()=>(0,b().y)(m)),[m]),{overriddenPublicShareLinkSpaceStore:C,furthestPublicShareAncestorId:T}=(0,x().W)(),A=(0,s().K8)((()=>Boolean(o().AppStoreSidebarSpaceStore||C||c)),[c,C]),R=(0,s().K8)((()=>{var e;return null===(e=(0,h().a)())||void 0===e?void 0:e.id}),[]),E=(0,s().K8)((()=>{if(n)return[];return g().NK.state.filter((e=>e.pageId!==R)).slice(0,I).map((e=>e.store))}),[R,n]),j=""===t,P=(0,r.useMemo)((()=>(0,p().N2)({isDeletedOnly:!1,excludeTemplates:!0,includePublicPagesWithoutExplicitAccess:w,navigableBlockContentOnly:!0,excludeSurrogateCollections:!a})),[w,a]),{results:F,isResultsLoading:O,debugInfo:B}=(0,y().W)({...w?{type:p().Vz.BlocksInAncestor,ancestorId:T??""}:{type:p().Vz.BlocksInSpace},source:"mention_menu",query:t,limit:I,filters:P,options:{disable:n||!A||j||w&&!T,overrideSpaceStore:w?C:void 0},peopleBlocksToInclude:"collection_view_page"}),D=(0,s().K8)((()=>(0,S().jj)(f)),[f]),N=(0,s().K8)((()=>j?E.map((e=>({store:e,serverEventProperties:void 0}))).filter((({store:e})=>k(e,D)&&M(e)&&_(e))):F.map((({store:e,collectionId:t,isSurrogateCollection:n,serverEventProperties:r})=>({store:n&&t?l().m.createChildStore(e,{table:d().Vl,id:t}):e,serverEventProperties:r}))).filter((({store:e})=>k(e,D)&&M(e)&&_(e)))),[F,E,j,D]),V=(0,r.useMemo)((()=>{const{localResults:e,serverResults:n,exposedSearchExperiments:r}=(0,v().W)(F);return{debugInfo:B,localResults:e,serverResults:n,exposedSearchExperiments:r,reportBadSearchInputRequest:{query:{text:t,filters:P,sort:{field:"relevance"}},limit:I}}}),[F,B,t,P]);return a?{results:N,isLoading:O,reportBadSearchMetadata:V}:{results:N.filter((e=>e.store.table===u().ev)),isLoading:O,reportBadSearchMetadata:V}}},381553:(e,t,n)=>{n.d(t,{Y:()=>i});n(296540);var r=n(474848);const o={viewBox:"0 0 16 16",fittedViewBox:"2.37 2.37 11.25 11.25",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{d:"M7.053 6.407a.643.643 0 1 0 0 1.286.643.643 0 0 0 0-1.286m1.894 0a.643.643 0 1 0 0 1.286.643.643 0 0 0 0-1.286m1.893 0a.643.643 0 1 0 0 1.286.643.643 0 0 0 0-1.286M5.159 8.3a.643.643 0 1 0 0 1.287.643.643 0 0 0 0-1.286M7.053 8.3a.643.643 0 1 0 0 1.287.643.643 0 0 0 0-1.286M8.947 8.3a.643.643 0 1 0 0 1.287.643.643 0 0 0 0-1.286M10.84 8.3a.643.643 0 1 0 0 1.287.643.643 0 0 0 0-1.286m-5.681 1.894a.643.643 0 1 0 0 1.286.643.643 0 0 0 0-1.286m1.894 0a.643.643 0 1 0 0 1.286.643.643 0 0 0 0-1.286m1.894 0a.643.643 0 1 0 0 1.286.643.643 0 0 0 0-1.286"}),(0,r.jsx)("path",{d:"M4.25 2.375c-1.036 0-1.875.84-1.875 1.875v7.5c0 1.036.84 1.875 1.875 1.875h7.5c1.036 0 1.875-.84 1.875-1.875v-7.5c0-1.036-.84-1.875-1.875-1.875zm-.625 9.375V5.632h8.75v6.118c0 .345-.28.625-.625.625h-7.5a.625.625 0 0 1-.625-.625"})]})},i=(0,n(340498).wt)("viewCalendarSmall",o,"small")},383567:(e,t,n)=>{n.d(t,{F:()=>i});n(296540);var r=n(474848);const o={viewBox:"0 0 20 20",fittedViewBox:"3.26 1.98 16.32 17.52",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{d:"M15.825 12a3.75 3.75 0 1 1-.001 7.501 3.75 3.75 0 0 1 0-7.501m0 1.325a.55.55 0 0 0-.55.55V15.2H13.95a.55.55 0 0 0-.001 1.1h1.326v1.325a.55.55 0 0 0 1.1 0V16.3h1.324a.55.55 0 0 0 0-1.1h-1.325v-1.325a.55.55 0 0 0-.55-.55M9.702 5.022a3.918 3.918 0 0 1 6.742.036.626.626 0 0 1-1.08.63 2.667 2.667 0 0 0-4.59-.023L5.376 14.68l4.19.678a.626.626 0 0 1-.2 1.235l-5.1-.827a.625.625 0 0 1-.437-.938z"}),(0,r.jsx)("path",{d:"M10.912 8.094a1.178 1.178 0 1 1 2.326.377 1.178 1.178 0 0 1-2.326-.377M4.7 7.087a1.178 1.178 0 1 1 2.327.377A1.178 1.178 0 0 1 4.7 7.087M3.488 2.985a3.92 3.92 0 0 1 5.572.357.625.625 0 0 1-.944.818 2.67 2.67 0 0 0-3.796-.243.625.625 0 1 1-.832-.932"})]})},i=(0,n(340498).wt)("aiFacePlus",o,"default")},390527:(e,t,n)=>{n.r(t),n.d(t,{DEFAULT_MAX_RECURRENCE_DUPLICATION_PER_TASK:()=>E,MAXIMUM_DAILY_RECURRENCES_IN_PATH:()=>k,MAXIMUM_NESTED_RECURRENCE_LEVEL:()=>I,MAX_RECURRENCE_INTERVAL:()=>v,MAX_RECURRENCE_NUMBER_OF_RUNS:()=>y,RRULE_WEEKDAYS_MAP:()=>g,adjustedStartDateIfPossible:()=>_,areRecurrenceSchedulesEqual:()=>B,convertFromUnpersistedRecurrenceConfig:()=>O,convertToUnpersistedRecurrenceConfig:()=>j,getFormattedEndCondition:()=>R,getFormattedNextRecurrenceTime:()=>A,getNewEndTimestamp:()=>P,getNextDateUtc:()=>T,getRecurrenceAfter:()=>w,isRunningBetweenMidnightAnd3AM:()=>C,isValidRecurrenceInterval:()=>S,isValidRecurrenceNumberOfRuns:()=>b,rruleFromRecurrence:()=>x,templateAncestorsViolateRecurrenceNesting:()=>M});n(898992),n(354520),n(581454);var r=()=>n(906745);n(944114);function o(e,...t){if(0===t.length)return e.map((e=>[e]));const n=[];for(const r of e)n.push(...o(t[0],...t.slice(1)).map((e=>[r,...e])));return n}var i=()=>n(496603),s=()=>n(534177),a=()=>n(720665),l=()=>n(597777),c=()=>n(869190),u=()=>n(416504),d=()=>n(402390);class p extends(()=>n(896346))().p3{constructor(e,t){super(e,t)}after(e,t){return super.after(e,t)}}var m=()=>n(912720);const f=(0,n(69708).YK)({dateAtTime:{id:"automations.recurrenceHelpers.dateAtTime",defaultMessage:"{date} at {time}"},dateBetweenMidnightAnd3AM:{id:"automations.recurrenceHelpers.dateBetweenMidnightAnd3AM",defaultMessage:"{date} between 12–3 AM"},numberEndConditionDescription:{id:"automations.recurrenceHelpers.numberEndConditionDescription",defaultMessage:"{number, plural, one {After {number} run} other {After {number} runs}}"},noEndCondition:{id:"automations.recurrenceHelpers.noEndCondition",defaultMessage:"Never"}}),h={hour:p.HOURLY,day:p.DAILY,week:p.WEEKLY,month:p.MONTHLY,year:p.YEARLY},g={MO:p.MO,TU:p.TU,WE:p.WE,TH:p.TH,FR:p.FR,SA:p.SA,SU:p.SU},v=99,y=999;function S(e){return(0,a().Et)(e)&&Number.isInteger(e)&&e>0&&e<=v}function b(e){return(0,a().Et)(e)&&Number.isInteger(e)&&e>0&&e<=y}function x(e){const{start_date:t,frequency:n,interval:r,weekdays:i,timezone:a,hour:c,minute:u}=e,d=(0,l().eU)(t);"hour"===n&&d.setUTCHours(c??0,u??0,0,0);const m="week"===n&&i?i.map((e=>g[e])):void 0,f={};return(0,s().O9)(e.end_condition)&&("date"===e.end_condition.type?f.until=(0,l().eU)(e.end_condition.end_at):"number"===e.end_condition.type?f.count=e.end_condition.number_of_occurrences:(0,s().HB)(e.end_condition)),"month"===e.frequency&&(0,s().O9)(e.monthly_restriction)&&("monthdays"===e.monthly_restriction.type?f.bymonthday=e.monthly_restriction.monthdays:"weekdays_in_month"===e.monthly_restriction.type?f.byweekday=o(e.monthly_restriction.weekdays,e.monthly_restriction.week_numbers).map((([e,t])=>g[e].nth(t))):(0,s().HB)(e.monthly_restriction)),new p({freq:h[n],dtstart:d,interval:r,byweekday:m,tzid:"hour"===n?void 0:a,..."hour"===n?{}:{byhour:c??0,byminute:u??0,bysecond:0},...f})}const I=1,k=1;function M(e){var t;if(0===e.length)return{violatesConstraint:!1,templateNestingExceedsMaxDepth:!1,ancestorHasDailyTemplate:!1,nestedDepthOfAutomationAncestors:void 0,immediateAncestorRecurrenceType:void 0};const n=e.filter((e=>{var t;return"day"===(null===(t=e.getRecurrence())||void 0===t?void 0:t.frequency)})),r=e.length,o=null===(t=e[0].getRecurrence())||void 0===t?void 0:t.frequency,i=r>I,s=n.length>=k;return{violatesConstraint:i||s,templateNestingExceedsMaxDepth:i,ancestorHasDailyTemplate:s,nestedDepthOfAutomationAncestors:r,immediateAncestorRecurrenceType:o}}function _(e){var t;const{recurrence:n,afterDate:o}=e;if("number"===(null===(t=n.end_condition)||void 0===t?void 0:t.type)||n.start_date>=o)return n;let i=r().DateTime.fromMillis(n.start_date,{zone:"utc"});const s=r().DateTime.fromMillis(o,{zone:"utc"});switch(n.frequency){case"hour":{const e=Math.floor(s.diff(i,"hours").hours/n.interval);i=i.plus({hours:e*n.interval});break}case"year":{const e=Math.floor(s.diff(i,"years").years/n.interval);i=i.plus({years:e*n.interval});break}case"month":{const e=Math.floor(s.diff(i,"months").months/n.interval);i=i.plus({months:e*n.interval});break}case"week":{const e=Math.floor(s.diff(i,"weeks").weeks/n.interval);i=i.plus({weeks:e*n.interval});break}case"day":{const e=Math.floor(s.diff(i,"days").days/n.interval);i=i.plus({days:e*n.interval});break}}return{...n,start_date:(0,l().DH)(i.toMillis())}}function w(e){const{recurrence:t,afterDate:n}=e;if((0,m().wt)(t)){const e=(0,l().l1)(n);return t.start_date>=e?new Date(t.start_date):void 0}{const e=x(_({recurrence:t,afterDate:n})).after((0,l().eU)(n));if(!e)return;return(0,l().h1)(e)}}function C(e){return 0===e.hour||1===e.hour||2===e.hour}function T(e){return x(e).after((0,l().eU)((0,l().Rz)()))||void 0}function A(e){const{recurrence:t,intl:n}=e,o=T(O(t));if(!o)return;const i=C(t),s=r().DateTime.fromJSDate(o).toUTC().setZone("local",{keepLocalTime:!0}).setLocale((0,d().H)(n)).setZone(t.timezone),a=(0,c().Yq)({date:s,dateFormat:"relative",allowRelativeDates:!0,intl:n,shortenDate:!0});if(i)return n.formatMessage(f.dateBetweenMidnightAnd3AM,{date:a});{let e=s.toLocaleString(r().DateTime.TIME_SIMPLE);return t.timezone!==(0,u().P)()&&(e+=` ${s.toFormat("ZZZZ")}`),n.formatMessage(f.dateAtTime,{date:a,time:e})}}function R(e,t){return(0,s().O9)(e)?"number"===e.type?t.formatMessage(f.numberEndConditionDescription,{number:e.number_of_occurrences}):"date"===e.type?(0,c().Yq)({date:r().DateTime.fromMillis(e.end_at),dateFormat:"relative",allowRelativeDates:!0,intl:t,shortenDate:!0}):void(0,s().HB)(e):t.formatMessage(f.noEndCondition)}const E=100;function j(e){return{...e,start_date:(0,l().l1)(e.start_date),end_condition:e.end_condition?"number"===e.end_condition.type?e.end_condition:"date"===e.end_condition.type?{type:"date",end_at:(0,l().l1)(e.end_condition.end_at)}:(0,s().HB)(e.end_condition):void 0}}function P(e,t,n){return e.plus(n-t)}function F(e,t){const n=r().DateTime.fromMillis(t.end_at).set({hour:e.hour??0,minute:e.minute??0});return{type:"date",end_at:(0,l().Rz)(n.toJSDate())}}function O(e){return{...e,start_date:(0,l().Rz)(new Date(e.start_date)),end_condition:e.end_condition?"number"===e.end_condition.type?e.end_condition:"date"===e.end_condition.type?F(e,e.end_condition):(0,s().HB)(e.end_condition):void 0}}function B(e,t){const n=i().fN(e,(e=>void 0!==e)),r=i().fN(t,(e=>void 0!==e));return i().n4(n,r)}},404905:(e,t,n)=>{n.d(t,{j:()=>c});var r=n(296540),o=()=>n(484714),i=()=>n(401497),s=()=>n(284371),a=()=>n(26697);var l=n(474848);function c(e){const{children:t,style:n,overlayContainerZIndex:c,placement:u="bottom",tooltipStyle:d}=e,{isSafari:p}=(0,o().Y0)(),m=(0,r.useRef)(null),f=function(e){const[t,n]=(0,r.useState)(!1);return(0,r.useEffect)((()=>{const{current:t}=e;if(!t)return void n(!1);const r="ResizeObserver"in window?new ResizeObserver((([e])=>{n(e.target.scrollWidth>e.target.clientWidth)})):void 0;return null==r||r.observe(t),()=>null==r?void 0:r.unobserve(t)}),[]),t}(m),h=(0,i().IS)((()=>({overflowText:{...s().RC,...n}})),[n]);return(0,l.jsx)(a().m,{delayThreshold:500,placement:u,textWrap:!0,style:d,overlayContainerZIndex:c,forceVisibleState:!(p||!f)&&void 0,renderTooltip:()=>f?t:void 0,render:e=>(0,l.jsx)("div",{ref:m,style:h.overflowText,...e,children:t})})}},419357:(e,t,n)=>{n.d(t,{Ay:()=>b,KF:()=>S,LG:()=>g,Zf:()=>y,yD:()=>v});var r=n(296540),o=()=>n(484714),i=()=>n(401497),s=()=>n(718827),a=()=>n(695115),l=()=>n(31511),c=()=>n(546926),u=()=>n(424400),d=()=>n(340498),p=()=>n(100622),m=()=>n(496603),f=()=>n(284371),h=n(474848);const g=30,v=28;function y(e){const{icon:t}=e;return t({fill:p().Tj.icon.secondary,width:d().Ev.sm,height:d().Ev.sm,flexGrow:0,flexShrink:0})}function S(e){const t=(0,o().WS)(),n=(0,i().eP)(),r=(0,i().IS)((()=>({outlineButton:{...(0,s().qq)({shape:"default",size:"sm",hasIconOnly:!0,isButtonGapEnabled:!0}),fontWeight:f().Wy.medium,lineHeight:1.2,border:`1px solid ${p().Tj.border.primaryTranslucent}`,background:e.hasBackground?p().Tj.background.primary:void 0},outlineButtonHovered:{background:p().Tj.background.secondary},outlineButtonPressed:{background:(0,s().yZ)({color:p().Tj.background.primary,mode:n})}})),[e.hasBackground,n]);return(0,h.jsx)(a().A,{size:"xs",colorVariant:"primary",...e,ariaLabel:e.ariaLabel,style:{...r.outlineButton,...e.style,height:t?g:v,width:t?g:v},hoveredStyle:r.outlineButtonHovered,pressedStyle:r.outlineButtonPressed})}const b=r.forwardRef((function({preventCaptureArrowShortcuts:e,preventCaptureDeleteWhenEmpty:t,preventCaptureClipboardShortcuts:o,preventCaptureSpacebarWhenEmpty:i,...s},a){const{left:l,right:d,inputLeft:p,inputRight:f,inputRightStyle:g,disableInput:v,inputOuterStyle:y,rightMobileEditLabel:S,mobileKeyboardOnDismiss:b,style:x,value:M,onChange:_,autosize:w,autosizeMinHeight:C,autosizeMaxHeight:T,customElementAttributes:A,disabled:R,format:E,id:j,placeholder:P,type:F,autoFocus:O,focus:B,focusInitial:D,focusAfterAnimation:N,forceShowClearButton:V,ignoreKeyboardMode:L,inputElementAttributes:z,inputStyle:q,isRightLastElementOfInput:U,maxlength:K,min:H,max:W,selectAll:G,showClearButton:$,suppressFocusRing:Y,textarea:Q,textareaSubmitOnEnter:Z,onBlur:X,onCancel:J,onClearButtonClick:ee,onClick:te,onFocus:ne,onKeyDown:re,onSubmit:oe,...ie}=s,[se,ae]=(0,r.useState)((()=>Boolean(B||D)));(0,r.useEffect)((()=>{void 0!==B&&ae(B)}),[B]);const le=e?void 0:m().D_,ce=!t||M.length>0?m().D_:void 0,ue=o?void 0:m().D_,de=!i||M.length>0?m().D_:void 0,pe=(0,c().Tf)(),me=(0,r.useContext)(c().xu),fe=(0,r.useRef)(null),he={value:M,onChange:_,autosize:w,autosizeMinHeight:C,autosizeMaxHeight:T,customElementAttributes:A,disabled:R,format:E,id:j,placeholder:P,type:F,autoFocus:O,focus:B,focusInitial:D,focusAfterAnimation:N,forceShowClearButton:V,ignoreKeyboardMode:L,inputElementAttributes:z,inputStyle:q,isRightLastElementOfInput:U,maxlength:K,min:H,max:W,selectAll:G,showClearButton:$,suppressFocusRing:Y,textarea:Q,textareaSubmitOnEnter:Z,onBlur:X,onCancel:J,onClearButtonClick:ee,onClick:te,onFocus:ne,onKeyDown:re,onSubmit:oe};return(0,h.jsx)(n(782482).N,{debugName:"InputMenuItem",capture:!0,onUntab:m().D_,onTab:m().D_,onSelectAll:m().D_,onRedo:m().D_,onUndo:m().D_,onToggleBold:m().D_,onToggleItalics:m().D_,onToggleCode:m().D_,onCut:ue,onCopy:ue,onPaste:ue,onKeypress:m().D_,onLeft:le,onRight:le,onDelete:ce,onBackspace:ce,onSpace:de,children:n(726637).A.isMobile?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(u().Ay,{ref:a,...ie,itemMarginLeft:pe?8:void 0,style:x,title:(0,h.jsx)(k,{ref:fe,left:l,right:d,inputLeft:p,inputRight:f,inputRightStyle:g,disableInput:v,inputOuterStyle:y,rightMobileEditLabel:S,isFocused:se,setIsFocused:ae,...he})}),(0,h.jsx)(n(797324).A,{show:se&&me.menuType!==c().gu.ActionSheet,onDismiss:b,inputRef:fe})]}):(0,h.jsx)(u().Ay,{ref:a,...ie,left:l,right:d,isTokenTitle:!0,title:(0,h.jsx)(I,{ref:fe,disableInput:v,inputOuterStyle:y,inputRight:f,inputRightStyle:g,inputLeft:p,...he}),style:{paddingTop:4,paddingBottom:4,...x}})})}));function x({rightMobileEditLabel:e,inputRef:t}){const i=(0,o().v3)(),a=(0,r.useCallback)((e=>{e.preventDefault();const r=t.current;r&&(0,n(375555).G)(i,r)}),[i,t]);return(0,h.jsx)(s().Ay,{onClick:a,style:{color:p().Tj.text.secondary},children:e})}const I=r.forwardRef((function(e,t){const{disabled:n,disableInput:r,inputOuterStyle:o,inputRight:i,inputRightStyle:s,inputLeft:a,min:c,textarea:u,...d}=e;return(0,h.jsx)(l().A,{...d,ref:t,disabled:n||r,style:{height:u?void 0:28,padding:"3px 6px",...o},left:a,right:i,rightStyle:s,min:c,textarea:u})})),k=r.forwardRef((function(e,t){const{left:o,right:i,inputLeft:s,inputRight:a,inputRightStyle:c,disableInput:u,inputOuterStyle:d,rightMobileEditLabel:p,isFocused:m,setIsFocused:f,disabled:g,showClearButton:v,onBlur:y,onFocus:S,...b}=e,I=(0,r.useCallback)((e=>{f(!1),y&&y(e)}),[y,f]),k=(0,r.useCallback)((e=>{f(!0),S&&S(e)}),[S,f]),M=(0,r.useRef)(null),_=(0,n(93583).A)(M,t),w=p&&!m?(0,h.jsx)(x,{rightMobileEditLabel:p,inputRef:M}):null;return(0,h.jsx)(l().A,{...b,ref:_,format:"transparent",style:{fontSize:16,...d},onFocus:k,onBlur:I,showClearButton:!1!==v,disabled:g||u,left:s||o,right:w||a||i,rightStyle:c})}))},421861:(e,t,n)=>{n.d(t,{i:()=>I});var r=n(296540),o=()=>n(907258),i=()=>n(726637),s=()=>n(590526),a=()=>n(278729),l=()=>n(807449),c=()=>n(764880),u=n(474848);const d={viewBox:"0 0 16 16",fittedViewBox:"2.49 2.19 11.01 11.97",svg:(0,u.jsx)("path",{d:"m4.145 2.922-.227-.265a.55.55 0 1 0-.836.716l1.491 1.739a3.9 3.9 0 0 0-.46 1.836v.895a2.78 2.78 0 0 1-.687 1.83l-.616.703c-.709.81-.134 2.078.942 2.078h2.2a2.081 2.081 0 0 0 4.095 0h.819l1.216 1.419a.55.55 0 0 0 .843-.707L4.153 2.931zm1.068 4.026c0-.32.054-.626.152-.912l4.558 5.318h-6.17a.153.153 0 0 1-.116-.253l.617-.705a3.88 3.88 0 0 0 .959-2.553zm1.773 5.506h2.028a1.081 1.081 0 0 1-2.028 0m6.302-.554a1.244 1.244 0 0 0-.098-1.524l-.616-.704a2.78 2.78 0 0 1-.687-1.829v-.895a3.89 3.89 0 0 0-2.124-3.465 1.85 1.85 0 0 0-3.526 0l-.112.06.738.86.062-.027.29-.121.042-.312A.75.75 0 0 1 8 3.29c.378 0 .692.281.743.653l.043.312.29.121a2.79 2.79 0 0 1 1.711 2.572v.895c0 .513.102 1.016.294 1.482z"})},p=(0,n(340498).wt)("bellSlashSmall",d,"small");var m=()=>n(848538),f=()=>n(69708),h=()=>n(100622),g=()=>n(534177),v=()=>n(284371),y=()=>n(486674),S=()=>n(231704),b=()=>n(313171);function x(e,t){const{user:r,focused:a}=e,d=(0,n(484714).v3)(),m=(0,f().tz)(),g=(0,n(401497).IS)((()=>({tooltip:{color:h().Tj.text.inverseSecondary,fontWeight:v().Wy.regular,maxWidth:240},tooltipHeader:{color:h().Tj.text.inversePrimary,fontWeight:v().Wy.medium}})),[]),S=(0,c().A7)(r),b=(0,c().lR)(m,S),x=(0,s().K8)((()=>{const e=(0,y().a)();return!(e&&(0,n(928074).Aj)({store:e}))||"none"!==(0,n(499764).om)(r.id)}),[r.id]),I=(0,s().K8)((()=>{var e;return r.id===(null===(e=o().default.state.currentUserStore)||void 0===e?void 0:e.id)}),[r.id]),_=(0,n(341694).H)(),w=(0,s().K8)((()=>{if(!_)return;if(!a)return;if(x)return;const e=(0,y().a)(),t=e&&Boolean(n(763884).K.get({userId:d.currentUser.id,key:(0,n(773706).T)(e.id)})),r=null==e?void 0:e.canAdmin();return!t&&r?(0,u.jsx)(l().I,{icon:n(97835).inviteMemberIcon,size:17,colorVariant:"secondary"}):(0,u.jsx)(l().I,{icon:p,size:17,colorVariant:"secondary"})}),[_,d.currentUser.id,x,a]),C=(0,s().K8)((()=>{if(!_)return null;const e=r.email;return(0,u.jsxs)("div",{style:g.tooltip,children:[(0,u.jsx)("header",{style:g.tooltipHeader,children:(0,u.jsx)(M,{userName:b,userHasAccessToPage:x,userIsSelf:I})}),e]})}),[_,x,I,b,r.email,g.tooltip,g.tooltipHeader]);return(0,u.jsx)(n(457688).A,{...e,ref:t,actor:S,right:w,tooltip:C,badge:(0,u.jsx)(k,{user:r}),tooltipPlacement:_?"right":void 0,useEmailAsTooltip:!_,customUserTitleStyles:i().A.isMobile?{fontSize:14}:void 0,iconSizeOverride:i().A.isMobile?24:void 0})}const I=r.forwardRef(x);function k({user:e}){const t=(0,s().O$)(o().AppStoreSidebarSpaceStore),n=(0,s().K8)((()=>{if(t)return a().V.createChildStore(t,(0,m().i1)({userId:e.id,spaceId:t.id})).getMembershipType()}),[t,e.id]);if(!n)return null;switch(n){case"none":case"member":case"membership_admin":case"owner":return null;case"page_guest":return(0,u.jsx)(S().w,{labelType:"guest"});case"restricted_member":return(0,u.jsx)(b().L,{});default:(0,g().HB)(n)}}function M({userName:e,userHasAccessToPage:t,userIsSelf:n}){return n?(0,u.jsx)(f().sA,{defaultMessage:"You",id:"activitySection.authorPhrase.forOneAuthorCurrentUser.label"}):t?null:(0,u.jsx)(f().sA,{id:"mentionMenu.UserMentionMenuItem.noAccessTooltip",defaultMessage:"{userName} won’t be notified because they don’t have page access",values:{userName:e}})}},422540:(e,t,n)=>{n.d(t,{$0:()=>v,Fx:()=>M,Ge:()=>f,I3:()=>p,Kj:()=>I,PP:()=>_,TK:()=>w,Yy:()=>d,aE:()=>C,cQ:()=>k,kH:()=>h,m7:()=>m,nq:()=>b,nv:()=>y,tj:()=>g});n(898992),n(354520),n(737550);var r=()=>n(496603),o=()=>n(534177),i=()=>n(381283),s=()=>n(898244),a=()=>n(651124),l=()=>n(349835),c=()=>n(390066);const u={checkbox:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,auto_increment_id:!1,button:!1,created_by:!1,created_time:!1,file:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1,place:!1},d={checkbox:[{type:"checkbox"}],date:[{type:"date"}],email:[{type:"text"}],multi_select:[{type:"text"},{of:{type:"text"},type:"array"}],number:[{type:"number"}],person:[{type:"person"},{of:{type:"person"},type:"array"}],phone_number:[{type:"text"}],relation:[{type:"block"},{of:{type:"block"},type:"array"}],select:[{type:"text"},{of:{type:"text"},type:"array"}],status:[{type:"text"},{of:{type:"text"},type:"array"}],text:void 0,title:void 0,url:[{type:"text"}]};function p(e){return Boolean(u[e.type]&&!(0,s().UU)(e)&&(!(0,s().$M)(e)||void 0===(0,s().om)(e)))}function m(e){const{collectionFormat:t,collectionSchema:n,filter:i,sort:l,sourcePropertyIds:u}=e,d=(u??(0,o().uv)(n)).filter(((t,r,o)=>{const a=n[t];return!(!a||!p(a))&&(("relation"!==a.type||!e.restrictCrossSpace||!(0,s().o2)(e.spaceId,a))&&(!i||i([t,a],r,n)))}));if(0===d.length)return[];if(!t||!1===l)return d;const m=(0,c().L)(t,n,void 0,a().jf.Page).collection_page_properties||[];return r().Ul(d,(e=>m.findIndex((t=>t.property===e))))}function f(e){const{collectionFormat:t,collectionSchema:n,sort:s}=e,l=(0,o().uv)(n).filter(((e,t,r)=>{const o=n[e];return!(!o||!(0,i().J)(o))}));if(0===l.length)return[];if(!t||!1===s)return l;const u=(0,c().L)(t,n,void 0,a().jf.Page).collection_page_properties||[];return r().Ul(l,(e=>u.findIndex((t=>t.property===e))))}function h(e){return e.type===l().M9.InvalidCharacter?{type:e.type,character:e.character}:e.type===l().M9.TokenExpected?{type:e.type,token:e.token}:e.type===l().uW.MissingSchemaPropertyOnThisRow||e.type===l().uW.MissingSchemaPropertyOnCollection?{type:e.type,collectionId:e.collectionId,property:e.property,errorSource:e.errorSource}:e.type===l().uW.ThisRowBlockPropertyMismatchCollection?{type:e.type,thisRowCollection:e.thisRowCollection,errorSource:e.errorSource}:e.type===l().uW.MissingContextVariable?{type:e.type,valueId:e.valueId,errorSource:e.errorSource}:e.type===l().uW.FunctionCallTooFewArguments?{type:e.type,numArguments:e.numArguments,errorSource:e.errorSource}:e.type===l().uW.FunctionCallUnexpectedArgument?{type:e.type,parameterIndex:e.parameterIndex,errorSource:e.errorSource}:e.type===l().uW.FunctionCallArgumentWrongType?{type:e.type,argumentType:e.argumentType,libraryFunctionName:e.libraryFunction.name,parameterIndex:e.parameterIndex,errorSource:e.errorSource}:e.type===l().uW.MissingDataDependencyBlock?{type:e.type,blockPointer:e.blockPointer,node:e.node,errorSource:e.errorSource}:e.type===l().uW.MissingDataDependencyPerson?{type:e.type,personPointer:e.personPointer,errorSource:e.errorSource}:e.type===l().uW.MemberPropertyMismatchCollection?{type:e.type,blockCollection:e.blockCollection,errorSource:e.errorSource}:e.type===l().uW.DownstreamParseFailure?{type:e.type,collectionId:e.collectionId,property:e.property,errorSource:e.errorSource}:e.type===l().uW.ContextVariableWrongType?{type:e.type,valueId:e.valueId,expectedType:e.expectedType,resultType:e.resultType,errorSource:e.errorSource}:e.type===l().uW.DisallowedValueType?{type:e.type,expressionValue:e.expressionValue,allowedValueTypes:e.allowedValueTypes,errorSource:e.errorSource}:e.type===l().uW.LibraryFunctionExecutionError?{type:e.type,error:e.error,libraryFunctionName:e.libraryFunction.name,errorSource:e.errorSource}:"errorSource"in e?{type:e.type,errorSource:e.errorSource}:{type:e.type}}const g={checkbox:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,button:!1,file:!1,verification:!1,auto_increment_id:!1,created_by:!1,created_time:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1,place:!1};function v(e){return Boolean(g[e.type])}function y(e){const{collectionFormat:t,collectionSchema:n,filter:i,sort:l}=e,u=(0,o().uv)(n).filter(((e,t,r)=>{var o;const a=n[e];return!(!a||!g[a.type])&&((!(0,s().$M)(a)||null===(o=(0,s().om)(a))||void 0===o||!o.auto_update_on_edit)&&(!i||i([e,a],t,n)))}));if(0===u.length)return[];if(!t||!1===l)return u;const d=(0,c().L)(t,n,void 0,a().jf.Page).collection_page_properties||[];return r().Ul(u,(e=>d.findIndex((t=>t.property===e))))}const S={checkbox:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,auto_increment_id:!1,button:!1,created_by:!1,created_time:!1,date:!1,file:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1,place:!1};function b(e){return S[e.type]}const x={checkbox:!0,created_by:!0,created_time:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,last_edited_by:!0,last_edited_time:!0,auto_increment_id:!1,button:!1,file:!1,formula:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1,place:!1};function I(e){return x[e.type]}function k(e){return 0===e}function M(e){return function(e){return"button_block"===e||"button_property"===e}(e)}function _(e){const{property:t,collectionSchema:n}=e;return!!n&&!n[t]}function w(e){const{collectionSchema:t,property:n,type:r}=e,o=null==t?void 0:t[n];return!o||("action"===r?!p(o):!g[o.type])}function C({automationTrigger:e,collectionSchema:t}){if("event"===(null==e?void 0:e.type)){const{pagesAdded:n,pagePropertiesEdited:r,source:i}=e.event;if(void 0===i)return!1;const s="some"===r.type&&r.some,a="all"===r.type&&r.all;if((s||a||[]).some((e=>_({collectionSchema:t,property:e.property})||w({collectionSchema:t,property:e.property,type:"trigger"}))))return!1;const l="some"===r.type&&(!(0,o().O9)(r.some)||0===r.some.length),c="all"===r.type&&(!(0,o().O9)(r.all)||0===r.all.length);if(!n&&("none"===r.type||l||c))return!1}else{if("recurrence"!==(null==e?void 0:e.type))return!1;if(!e.recurrence)return!1}return!0}},424641:(e,t,n)=>{n.d(t,{Gj:()=>d,Jx:()=>u,RN:()=>v,_X:()=>y,sM:()=>S,sR:()=>h,vZ:()=>p,xy:()=>x,y6:()=>g});n(944114),n(898992),n(823215),n(354520),n(672577);var r=()=>n(906745),o=()=>n(726637),i=()=>n(295633),s=()=>n(761940),a=()=>n(651784),l=()=>n(179034),c=()=>n(615234);function u(e){return"owner"===e.accessRole||"writer"===e.accessRole}function d(e){const t=r().DateTime.fromMillis(e.startUnixTimestampMS),n=e.endUnixTimestampMS?r().DateTime.fromMillis(e.endUnixTimestampMS):void 0,o=r().DateTime.fromMillis(e.startOfWeekUnixTimestampMS),i=r().DateTime.fromMillis(e.endOfWeekUnixTimestampMS),s=t.startOf("day"),a=r().DateTime.max(o,s),l=Math.ceil(a.diff(o,"days").get("days"));let c=1;if(n){const e=n.endOf("day"),t=r().DateTime.min(i,e);c=Math.ceil(t.diff(a,"days").get("days"))}return{start:t,end:n,startOfWeek:o,endOfWeek:i,startColumn:l,columnCount:c}}function p(e){const t=(e.attendees||[]).filter((e=>!e.self&&!e.resource));return e.hasParticipants&&t.length>0&&t.every((e=>"declined"===e.responseStatus))}const m={upcomingMinsThreshold:10,startingMinsThreshold:5,startedMinsThreshold:15},f={upcomingMinsThreshold:10,startingMinsThreshold:5,startedMinsThreshold:5},h={upcomingMinsThreshold:10,startingMinsThreshold:15,startedMinsThreshold:15};function g(e){const{events:t,accounts:n,thresholds:o=m,filters:i}=e,a=t.filter((e=>{if(!(e.conferencing||null!=i&&i.includeEventsWithoutConferencing))return!1;const t=n.find((t=>t.id===e.accountId));return!(null==t||!t.email)&&(!!(0,s().Ko)(e,t.email)&&(!function(e){if("declined"===e)return!0;return!1}(e.responseStatus??"declined")&&!e.isAllDay))}));if(0===a.length)return[];const{upcomingMinsThreshold:l,startingMinsThreshold:u,startedMinsThreshold:d}=o,p=r().DateTime.now(),f=void 0!==(null==i?void 0:i.maxDaysInFuture)?i.maxDaysInFuture*c().XQ:void 0,h=void 0!==(null==i?void 0:i.maxDaysInPast)?i.maxDaysInPast*c().XQ:void 0,g=[],v=[],y=[],S=[],x=[],I=[];for(const r of a){if(r.isAllDay)continue;const e=b(r),t=p.diff(e.end,"minutes").minutes;if(void 0!==h&&t>h)continue;if(null!=i&&i.excludeEventsOnDifferentDays){if(p.setZone(e.start.zone).toISODate()!==e.start.toISODate())continue}const n=e.start.diff(p,"minutes").minutes;if(!(void 0!==f&&n>f))if(n>=0&&n<=l)g.push(r);else if(n<0){const o=-n,i=t>=0?t:void 0;o>0&&o<=u?y.push(r):o>u&&o<=d?S.push(r):e.contains(p)?v.push(r):void 0!==h&&void 0!==i&&i<=h&&x.push(r)}else I.push(r)}v.sort(((e,t)=>{const n=r().DateTime.fromISO(e.start.dateTime,{zone:e.start.timeZone});return r().DateTime.fromISO(t.start.dateTime,{zone:t.start.timeZone}).diff(n).toMillis()})),x.length>1&&x.sort(((e,t)=>{const n=r().DateTime.fromISO(e.end.dateTime,{zone:e.end.timeZone});return r().DateTime.fromISO(t.end.dateTime,{zone:t.end.timeZone}).diff(n).toMillis()}));return[...g,...y,...S,...null!=i&&i.excludeInProgressEvents?[]:v,...x,...null!=i&&i.excludeUpcomingLaterEvents?[]:I]}function v(e,t){return g({events:e,accounts:t,thresholds:m,filters:void 0})[0]}function y(e,t){return S(e,t)[0]}function S(e,t,n){return g({events:e,accounts:t,thresholds:f,filters:{excludeUpcomingLaterEvents:!0,...n}})}function b(e){const t=r().DateTime.fromISO(e.start.dateTime,{zone:e.start.timeZone}),n=r().DateTime.fromISO(e.end.dateTime,{zone:e.end.timeZone});return r().IX.fromDateTimes(t,n)}function x(e){const{spaceStore:t}=e;let n=e.fileUrl;if(!t)return;const r=(0,a().parseRoute)({url:n,isMobile:o().A.isMobile,baseUrl:o().A.domainBaseUrl,publicDomainName:o().A.publicDomainName,protocol:o().A.protocol,currentUrl:window.location.href}),s="page"===r.name?r.blockId:void 0;if(!s)return;const c=i().B.createChildStore(t,{table:l().ev,id:s});return c.load(),c}},427636:(e,t,n)=>{n.d(t,{A:()=>i});n(296540);var r=()=>n(100622),o=n(474848);const i=function(e){const{botStore:t,avatarSize:i,shouldShowBadge:s,style:a,inline:l}=e,c=(0,n(69708).tz)(),u=(0,n(484714).Y0)(),d=(0,n(590526).K8)((()=>null==t?void 0:t.getDisplayName(c)),[t,c]),{outerStyle:p,avatarWrapStyle:m,badgeStyle:f}=(0,n(401497).IS)((()=>({outerStyle:{display:"flex",alignItems:"center",minWidth:0,...a},avatarWrapStyle:l?{width:"none",minHeight:"none",marginInlineEnd:6}:{marginInlineEnd:6},badgeStyle:{padding:"2px 6px",borderRadius:4,color:r().Tj.text.secondary,background:r().Tj.legacyDefaultSelectColor,fontSize:n(726637).A.isMobile?11:9,lineHeight:u.isAndroid?1.5:1,textTransform:"uppercase",letterSpacing:"0.04em",marginInlineStart:8,marginTop:1}})),[a,l,u]);return(0,o.jsxs)("div",{style:p,children:[(0,o.jsx)("div",{style:m,children:(0,o.jsx)(n(256863).A,{botStore:t,size:i})}),(0,o.jsx)("div",{style:{...n(284371).RC},children:d}),s?(0,o.jsx)("div",{style:f,children:"Bot"}):void 0]})}},448693:(e,t,n)=>{n.d(t,{Ay:()=>b,t_:()=>x,v7:()=>I});n(296540);var r=()=>n(484714),o=()=>n(590526),i=()=>n(34977),s=()=>n(457205),a=()=>n(849255),l=()=>n(764880),c=()=>n(784892),u=()=>n(534177),d=()=>n(883701),p=()=>n(427636),m=()=>n(256863),f=()=>n(848401),h=()=>n(994006),g=()=>n(453697),v=n(474848);function y(e){const t=(0,r().v3)(),{actor:n,format:l,hasTooltip:y,tooltipHeader:b,hasPersonHoverCard:x,spaceStore:I}=e,k=(0,o().K8)((()=>{const e=n.asActor;if(e)return(0,d().J)(t,e)}),[n,t]);return(0,v.jsx)(f().Ay,{...e,renderAvatar:e=>{if(k)return k instanceof s().v?l===c().NY.Inline?(0,v.jsx)(m().A,{botStore:k,size:e,style:S}):(0,v.jsx)(p().A,{botStore:k,avatarSize:e,inline:!0,style:S}):k instanceof a().L?l===c().NY.Inline?(0,v.jsx)(g().A,{userStore:k,size:e,avatarShouldShowShadow:!1,hasTooltip:y??!0,style:S,tooltipHeader:b,hasPersonHoverCard:x}):(0,v.jsx)(h().A,{userStore:k,avatarSize:e,inline:!0,hasTooltip:y,hasPersonHoverCard:x,style:S,tooltipHeader:b,spaceStore:I}):void(k instanceof i().p||(0,u().HB)(k))}})}const S={minWidth:0};y.Format=c().NY;const b=y;function x(e){const{userValue:t,...n}=e,r=(0,l().MR)(t);return(0,v.jsx)(y,{actor:r,...n})}function I(e){const{botValue:t,...n}=e;return(0,v.jsx)(y,{actor:(0,l().oC)(t),hasPersonHoverCard:!1,...n})}x.Format=f().mI,I.Format=f().mI},448801:(e,t,n)=>{n.d(t,{i:()=>o});n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698);var r=()=>n(371562);r();function o(e,t){const n=r().create({arrays:{detectMove:!1,includeValueOnMove:!0}}).diff(e,t);if(!n)return{beforeOps:{},removeOps:new Set};let o=[],i=[];for(const r in n)"_t"!==r&&("_"===r[0]?o.push(parseInt(r.slice(1),10)):1===n[r].length&&i.push({index:parseInt(r,10),value:n[r][0]}));const s={},a=new Set,l=[...e];o=o.sort(((e,t)=>e-t));for(let r=o.length-1;r>=0;r--){const e=o[r],t=l.splice(e,1)[0];a.add(t)}i=i.sort(((e,t)=>e.index-t.index));for(let r=0;r<i.length;r++){const e=i[r];s[e.value]=l[e.index],l.splice(e.index,0,e.value)}return{beforeOps:s,removeOps:a}}},460957:(e,t,n)=>{n.d(t,{E:()=>s});n(581454);var r=()=>n(201980),o=()=>n(718957),i=()=>n(29554);function s(e){const{multiSelection:t}=e;return(0,o().$W)(t).map((({store:e,selection:t})=>{const n=(0,r().RQ)(e.getValue()),o=(0,r().xbM)(n,t),{tokensInsideRange:s}=(0,r().AI5)(n,o.startIndex,o.endIndex);return(0,i().r4)(s,e)})).join("\n\n")}},482871:(e,t,n)=>{n.d(t,{z:()=>u});n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(430670),n(581454);var r=()=>n(770063),o=()=>n(898244),i=()=>n(448801),s=()=>n(179034),a=()=>n(722101),l=(n(354520),()=>n(496603));function c(e){const{collectionContextStore:t,collectionViewStore:n,transaction:i}=e,c=n.getPageSortStore(),u=c.getValue(),d=t.groupsStore.getAllGroupStates(),p=function(e){const{pageSort:t,currentResults:n}=e;if(!t||t.length<=o().WF)return[];const r=t.filter((e=>!n.has(e)));return l().sb([...r.reverse(),...l().o8(t).reverse()]).slice(0,t.length-o().WF)}({pageSort:u,currentResults:new Set(d.flatMap((e=>e.resultsStore.state.map((e=>e.id)))))});for(const o of p)a().TF({parentStore:c,childToRemoveStore:(0,r().v3)(c,{table:s().ev,id:o}),transaction:i})}function u(e){const{resultIds:t,collectionViewStore:n,collectionContextStore:l,transaction:u}=e,d=n.getPageSortStore(),p=d.getValue()||[],{beforeOps:m}=(0,i().i)(p,t.slice(0,o().WF));for(const[o,i]of Object.entries(m))if(i){const e=(0,r().v3)(n,{table:s().ev,id:i});a().nc({parentStore:d,insertStore:(0,r().v3)(n,{table:s().ev,id:o}),beforeStore:e,transaction:u})}else{const e=t.findIndex((e=>e===o)),i=t[e-1],l=i?(0,r().v3)(n,{table:s().ev,id:i}):void 0;a().WH({parentStore:d,insertStore:(0,r().v3)(n,{table:s().ev,id:o}),afterStore:l,transaction:u})}c({collectionContextStore:l,collectionViewStore:n,transaction:u})}},491848:(e,t,n)=>{n.d(t,{w:()=>o});n(898992),n(672577);var r=()=>n(541199);function o({collectionContextStore:e,transaction:t}){const n="collectionTypedView"===e.contextTypeFromStoreState,o=e.databaseTypeFromStoreState,i=e.collectionStoresStore.state,s=i.find((e=>e.canEdit()||e.canEditCollection()||e.canEditContentOnly()))||i[0];!n&&s&&(0,r().e)({transaction:t,databaseType:o,collectionId:s.id,spaceId:s.getSpaceId()})}},529099:(e,t,n)=>{n.r(t),n.d(t,{aiFaceIcon:()=>i,iconDefinition:()=>o});n(296540);var r=n(474848);const o={viewBox:"0 0 20 20",fittedViewBox:"4.13 2.52 13.27 14.61",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{d:"M12.758 9.976a1.178 1.178 0 1 0 .377-2.326 1.178 1.178 0 0 0-.377 2.326M6.547 8.97a1.178 1.178 0 1 0 .377-2.327 1.178 1.178 0 0 0-.377 2.326"}),(0,r.jsx)("path",{d:"M10.573 5.554a3.917 3.917 0 0 1 6.743.035.625.625 0 1 1-1.08.63 2.667 2.667 0 0 0-4.591-.023l-5.398 9.015 4.192.68a.625.625 0 0 1-.2 1.233l-5.102-.827a.625.625 0 0 1-.436-.938zM4.36 3.517a3.92 3.92 0 0 1 5.572.356.625.625 0 1 1-.945.818 2.67 2.67 0 0 0-3.795-.243.625.625 0 1 1-.833-.931"})]})},i=(0,n(340498).wt)("aiFace",o,"default")},546461:(e,t,n)=>{n.d(t,{K4:()=>x,To:()=>_,fi:()=>I,q8:()=>b,u:()=>S});n(16280),n(18107),n(967357);var r=n(296540),o=()=>n(484714),i=()=>n(792485),s=()=>n(590526),a=()=>n(79926),l=()=>n(140934),c=()=>n(322867),u=()=>n(69708),d=()=>n(534177),p=()=>n(813297),m=()=>n(326887),f=()=>n(862292),h=()=>n(190019),g=()=>n(76190),v=n(474848);const y=(0,r.createContext)({ancestors:[]});y.displayName="AutomationContext";y.Consumer;function S(e){const{automationStore:t,children:n,contextType:S,enableExistenceGuarantees:b}=e,x=(0,o().v3)(),I=(0,u().tz)(),{value:_}=(0,a().fJ)(f().T.formulas),{value:w}=(0,a().fJ)(p().QV.automationTypecheck),C=(0,g().n)(t),T=(0,i().S)(),A=(0,s().K8)((()=>{if(!_)return{error:new(c().N9)("Missing formulas dependency")};if(!w)return{error:new(c().N9)("Missing automation dependency")};const e=function(e){const{environment:t,automationStore:n,automationTypecheckModule:r,contextType:o,formulasModule:i,intl:s,isSubscribed:a,pageStore:c,enableExistenceGuarantees:u}=e,p=function(e,t){if(t)return k.get(e);return k.get(e)??M.get(e)}(n,u);if(p)return p;const f=new(l().ComputedStore)((()=>{const e=n.getTriggerType();let l=o;return(0,d().O9)(e)&&(0,m().x2)(e)&&(l=(0,m().H8)(e)),(0,h().Z)({environment:t,automationStore:n,automationTypecheckModule:r,contextType:l,formulasModule:i,intl:s,isSubscribed:a,pageStore:c,enableExistenceGuarantees:u})}),{debugName:"automationContextTypecheckResultCachedStore"});return function(e,t,n){n?(k.set(e,t),M.set(e,t)):M.set(e,t)}(n,f,u),f}({automationStore:t,automationTypecheckModule:w,contextType:S,environment:x,formulasModule:_,intl:I,isSubscribed:C,pageStore:"button_block"===S?null==T?void 0:T.pageStore:void 0,enableExistenceGuarantees:b});return e.state}),[x,t,w,S,_,I,C,null==T?void 0:T.pageStore,b]),R=(0,r.useContext)(y),E=(0,r.useMemo)((()=>0===R.ancestors.length?[{automationStore:t,contextType:S,typecheckResult:A}]:[...R.ancestors,{automationStore:t,contextType:S,typecheckResult:A}]),[R,t,S,A]),j=(0,r.useMemo)((()=>({ancestors:E,enableExistenceGuarantees:b})),[E,b]);return(0,v.jsx)(y.Provider,{value:j,children:n})}function b(){const e=(0,r.useContext)(y).ancestors.at(-1);if(!e)throw new Error("No automation context found!");return e}function x(){return(0,r.useContext)(y).ancestors.at(-1)}function I(){return(0,r.useContext)(y).enableExistenceGuarantees}const k=new WeakMap,M=new WeakMap;function _(e){var t;return null===(t=k.get(e))||void 0===t?void 0:t.state}},556122:(e,t,n)=>{n.d(t,{QJ:()=>m,TI:()=>c});n(944114),n(581454);var r=()=>n(726637),o=()=>n(763824);let i=0;const s="clipboard",a={debug:Boolean(r().A.isDevelopingInAirplaneMode),responseText:s,showErrorCode:!1,delayBetweenChunks:20,chunkSize:5,numLoremIpsums:3},l="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec porta auctor sem vel efficitur. Vivamus efficitur eros sed erat efficitur efficitur. Vivamus et augue vel est efficitur efficitur.";function c(){return a}function u(e){return{async*[Symbol.asyncIterator](){for(const t of e)await(0,o().wR)(a.delayBetweenChunks),yield t}}}function d(e,t){const n=Math.ceil(e.length/t),r=new Array(n);for(let o=0,i=0;o<n;++o,i+=t)r[o]=e.substr(i,t);return r}function p(e){return e.map((e=>({type:"success",p:"padding",completion:e,inferenceId:"mock"})))}async function m({environment:e,data:t}){console.log("Retrieving fake completion for data",t);const{context:n}=t,o=n.selectedText,c=[];let{responseText:m}=a;if(m===s&&(m=await async function(){try{return await navigator.clipboard.readText()}catch(e){return}}()??"Unable to retrieve clipboard text."),void 0===m&&(c.push({type:"success",p:"padding",completion:"\n",inferenceId:"mock"},{type:"success",p:"padding",completion:"this is ",inferenceId:"mock"},{type:"success",p:"padding",completion:"fake ",inferenceId:"mock"},{type:"success",p:"padding",completion:`streaming response ${i++}.`,inferenceId:"mock"}),r().A.isDevelopingInAirplaneMode&&c.push({type:"success",p:"padding",completion:"\n\nTo see a real AI response, run the server with `--airplaneMode=false`.",inferenceId:"mock"}),"string"==typeof o)){c.push({type:"success",p:"padding",completion:"\n\nHere is the text you selected:\n\n",inferenceId:"mock"});for(const e of d(o,a.chunkSize))c.push({type:"success",completion:e,p:"padding",inferenceId:"mock"})}if(a.showErrorCode)c.push({type:"error",message:"alas",errorCode:a.showErrorCode,isRetryable:!1});else if(void 0===m)for(let r=0;r<a.numLoremIpsums;r++)c.push(...p([`\n\n${r+1}. `,...d(l,0===a.delayBetweenChunks?l.length:a.chunkSize)]));else if(m.length>0){const e=d(m,a.chunkSize);c.push(...p(e))}return Promise.resolve({type:"success",data:u(c),status:200,headers:{}})}(0,n(852832).exposeDebugValue)("completionDebugSettings",a)},556927:(e,t,n)=>{n.r(t),n.d(t,{Search2:()=>po});n(898992),n(354520),n(737550);var r=n(296540),o=()=>n(664594),i=()=>n(907258),s=()=>n(242422),a=()=>n(726637),l=()=>n(484714),c=()=>n(852507),u=()=>n(118884),d=()=>n(590526),p=()=>n(401497),m=()=>n(15258),f=()=>n(107975),h=()=>n(232615),g=()=>n(127833),v=()=>n(396896),y=()=>n(791177),S=()=>n(416504),b=()=>n(992437),x=()=>n(450648),I=()=>n(245241),k=()=>n(201980),M=()=>n(69708),_=()=>n(277942),w=()=>n(383070),C=()=>n(631611),T=()=>n(251200),A=()=>n(483795),R=()=>n(850913),E=()=>n(837073),j=()=>n(798693);n(944114);function P(e){if("daterange"===e.type)return{starting:e.start_date?{type:"date",start_date:e.start_date}:void 0,ending:e.end_date?{type:"date",start_date:e.end_date}:void 0};if("date"===e.type){const t=e.start_date;if(t)return{starting:{type:"date",start_date:t},ending:{type:"date",start_date:t}}}return{starting:void 0,ending:void 0}}var F=()=>n(656975),O=()=>n(755531),B=()=>n(20022),D=()=>n(908006),N=()=>n(852273),V=()=>n(650829),L=()=>n(483730),z=()=>n(670693),q=()=>n(817443),U=()=>n(321874),K=()=>n(87573),H=()=>n(294249);function W({environment:e,closeSearch2:t}){const n=(0,r.useRef)(),o=(0,r.useRef)(),s=(0,r.useRef)(),a=(0,r.useRef)(),{mode:l,isOpen:p}=(0,d().K8)((()=>({mode:H()._.state.mode,isOpen:H()._.state.isOpen})),[]),m=(0,r.useCallback)((()=>{var t,n;const r=null===(t=(0,O().S)())||void 0===t?void 0:t.id;a.current!==r&&(a.current=r,null===(n=H()._.state.query)||void 0===n||n.setValue([]),a.current&&i().default.state.currentUserStore&&(0,K().q)(e)&&(0,z().Z)())}),[e]),f=(0,r.useCallback)((e=>{const{environment:t,openAssistant:n}=e;n&&H()._.switchToAgent(),U()._N({environment:t,analyticsFrom:"keyboard-shortcut-quick-search-hotkey",isQuickSearch:!0})}),[]),{assistantSessionId:h,assistantSessionContext:g}=(0,d().K8)((()=>{const e=L().default.getActiveSessionId();return{assistantSessionId:e,assistantSessionContext:e?L().default.getSessionContext(e):void 0}}),[]),v=(0,r.useCallback)(((n,r,o,i)=>{if("stopQueueingSubscriptions"in N().Ay&&"function"==typeof N().Ay.stopQueueingSubscriptions&&N().Ay.stopQueueingSubscriptions(e),r){let t;t="tray-icon"===o?"quick-search-tray-icon":"shortcut"===o?"quick-search-shortcut":"debug-menu"===o?"quick-search-debug-menu":"quick-search",i&&H()._.switchToAgent(),!i&&"agent"===l&&p&&(t="command_search_switching_panes",H()._.switchToSearchPane(),h&&V().assistantDependency.load().then((({assistantAnalyticsActions:t})=>{t.trackAssistantClosed(e,{from:"command_search_switching_panes",sessionContext:g})}))),U()._N({environment:e,analyticsFrom:t,isQuickSearch:!0,doNotTrackOpenSearchEvent:i}),D().default.afterNextFlush().then((()=>(0,q().L)()))}else t({shouldResetQuery:!1})}),[e,p,l,h,g,t]);(0,c().w)((()=>{var t;e.device.isElectron&&(a.current=null===(t=(0,O().S)())||void 0===t?void 0:t.id,i().default.state.currentUserStore&&(0,K().q)(e)&&(0,z().Z)(),null!==B().Ht&&void 0!==B().Ht&&B().Ht.quickSearchVisibilityState&&(i().default.addListener(m),s.current=B().JW.addListener(v),n.current=B().RS.addListener((()=>{f({environment:e,openAssistant:!1})})),o.current=B().lS.addListener((()=>{"chat"!==e.RouterStore.state.route.name&&f({environment:e,openAssistant:!0})}))))})),(0,u().X)((()=>{var t,r,a;e.device.isElectron&&(null===(t=n.current)||void 0===t||t.call(n),null===(r=o.current)||void 0===r||r.call(o),null===(a=s.current)||void 0===a||a.call(s),i().default.removeListener(m))}))}var G=()=>n(770167),$=()=>n(135599),Y=()=>n(106628),Q=()=>n(439050),Z=()=>n(73199),X=()=>n(869562),J=()=>n(654774),ee=()=>n(461131),te=()=>n(384565),ne=()=>n(287234),re=()=>n(870976),oe=()=>n(332946),ie=()=>n(344235),se=()=>n(633220),ae=()=>n(882722),le=()=>n(222917);function ce(e){var t;const n=null===(t=e.current)||void 0===t?void 0:t.getNode();if(!n)return 0;const r=n.scrollTop+n.clientHeight,o=Array.from(n.getElementsByClassName(ae().LF7));let i=0,s=0;for(const a of o){if(!(a instanceof HTMLElement))continue;if(!(r-s>a.clientHeight/2))break;i++,s+=a.clientHeight}return i}var ue=()=>n(763884),de=()=>n(671593);const pe="Search2StickyFiltersEnabled",me="Search2HideAiTopResultEnabled",fe="Search2PersistedFilters",he="Search2PersistedSort",ge={field:"relevance"};function ve(e){const t=ue().K.get({userId:e.userId,key:e.key});return"boolean"==typeof t?t:e.defaultValue}function ye(e){ue().K.set({userId:e.userId,key:e.key,value:e.value})}function Se(e){ue().K.remove({userId:e.userId,key:e.key})}function be(e){return`${fe}:${e}`}function xe(e){return`${he}:${e}`}function Ie(e){return e?{stickyFiltersEnabled:ke(e),hideAiTopResultEnabled:Me(e)}:{stickyFiltersEnabled:!1,hideAiTopResultEnabled:!1}}function ke(e){return ve({userId:e,key:pe,defaultValue:!1})}function Me(e){return ve({userId:e,key:me,defaultValue:!1})}function _e(e){const t=ue().K.get({userId:e.userId,key:be(e.spaceId)}),n=(0,de().Qq)(I().K_,t);return n?(0,I().N2)(n):void 0}function we(e){const t=ue().K.get({userId:e.userId,key:xe(e.spaceId)});return(0,de().Qq)(I().gG,t)}function Ce(e){!function(e){ye({userId:e.userId,key:be(e.spaceId),value:e.filters})}({userId:e.userId,spaceId:e.spaceId,filters:(0,I().N2)(e.filters)}),function(e){ye({userId:e.userId,key:xe(e.spaceId),value:e.sort})}({userId:e.userId,spaceId:e.spaceId,sort:e.sort??ge})}function Te(e){!function(e){Se({userId:e.userId,key:be(e.spaceId)})}(e),function(e){Se({userId:e.userId,key:xe(e.spaceId)})}(e)}var Ae=()=>n(300474),Re=()=>n(250910),Ee=()=>n(695115),je=()=>n(98126),Pe=()=>n(546926),Fe=()=>n(890492),Oe=()=>n(663639),Be=()=>n(736847),De=()=>n(24126),Ne=()=>n(100622),Ve=()=>n(574036),Le=n(474848);const ze=r.memo((function(e){const t=e.isResultsView,o=(0,l().v3)(),{localResults:i,serverResults:c,exposedSearchExperiments:u}=(0,r.useMemo)((()=>(0,n(786937).W)(e.results)),[e.results]),m=(0,d().O$)(ne().Qb),f=((0,d().K8)((()=>(0,n(499233).PE)({environment:o}).localSearchableBlocksCacheLoaded),[o]),(0,d().K8)((()=>(0,j().E)(o).hasPublicAccessPermission),[o]),(0,d().K8)((()=>(0,n(211134).PF)({env:"production",isAdminMode:a().A.isAdminMode,experimentService:s().default})),[])),h=(0,d().K8)((()=>"on"===s().default.getEligibleGroup({experimentId:"search_modal_settings_toggle",defaultGroup:"control"})),[]),g=(0,p().IS)((()=>({container:{paddingTop:8,paddingBottom:8,paddingInlineEnd:12,paddingInlineStart:16,color:Ne().Tj.text.secondary,display:"flex",justifyContent:"space-between",borderTop:`1px solid ${Ne().Tj.border.secondaryTranslucent}`,marginTop:1},leftSide:{display:"flex",alignItems:"center",gap:12},indexBuilding:{color:Ne().Tj.text.tertiary,fontSize:12,display:"flex"}})),[]);return(0,Le.jsxs)("div",{style:g.container,children:[(0,Le.jsxs)("div",{style:g.leftSide,children:[null,(0,Le.jsx)(n(127720).A,{})]}),(0,Le.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,Le.jsx)(n(254704).c,{productSurface:I().xi.searchModal,localResults:i,serverResults:c,debugInfo:e.debugInfo,exposedSearchExperiments:u,reportBadSearchInputRequest:e.reportBadSearchInputRequest,buttonStyles:{visibility:t?"visible":"hidden",pointerEvents:t?"auto":"none"}}),f?(0,Le.jsx)(qe,{isDebugSidebarOpen:m}):null,h?(0,Le.jsx)(Ue,{searchUserPreferences:e.searchUserPreferences}):null]})]})}));function qe(e){const t=(0,M().tz)(),n=(0,p().IS)((()=>({button:{fill:e.isDebugSidebarOpen?Ne().Tj.blue.text.tertiary:void 0}})),[e.isDebugSidebarOpen]);return(0,Le.jsx)(Ee().A,{onClick:()=>{ne().Ay.update((e=>({...e,isDebugSidebarOpen:!e.isDebugSidebarOpen})))},icon:De().c,ariaLabel:t.formatMessage(He.debugToggle),style:n.button})}function Ue(e){const t=(0,M().tz)();return(0,Le.jsx)(Re().A,{popupType:Re().z.Popup,enableOutsideClickDismiss:!0,disableDarkOverlayBackground:!0,placementToOrigin:"top",alignmentToOrigin:"end",originGap:8,trapFocus:!1,ariaLabel:t.formatMessage(He.settingsMenuAriaLabel),renderOrigin:e=>(0,Le.jsx)(Ee().A,{onClick:t=>e.onClick(t),icon:n(212727).gearIcon,ariaLabel:t.formatMessage(He.settingsToggle)}),render:()=>(0,Le.jsx)(Ke,{searchUserPreferences:e.searchUserPreferences})})}function Ke(e){const t=(0,M().tz)(),n=(0,o().T)(),i=(0,Ae().r)(),{searchUserPreferences:s}=e,{settings:a,setUserSettings:l,storeFilters:c,storeSort:u}=s,d=Boolean(i&&n),p=(0,r.useCallback)((()=>{if(!i||!n)return;const e=!a.stickyFiltersEnabled;l({stickyFiltersEnabled:e}),ye({userId:n,key:pe,value:e}),e?Ce({userId:n,spaceId:i,filters:c,sort:u}):Te({userId:n,spaceId:i})}),[n,l,c,u,a.stickyFiltersEnabled,i]),m=(0,r.useCallback)((()=>{if(!n)return;const e=!a.hideAiTopResultEnabled;l({hideAiTopResultEnabled:e}),ye({userId:n,key:me,value:e})}),[l,a.hideAiTopResultEnabled,n]),f=(0,r.useMemo)((()=>[{key:"settings",items:[{key:"searchFooterStickyFilters",action:p,render:e=>(0,Le.jsx)(Ve().A,{...e,title:t.formatMessage(He.stickyFilters),on:a.stickyFiltersEnabled,disabled:!d,"aria-label":t.formatMessage(He.stickyFilters),shouldWrapTitle:!0})},{key:"searchFooterAiTopResult",action:m,render:e=>(0,Le.jsx)(Ve().A,{...e,title:t.formatMessage(He.aiTopResult),on:a.hideAiTopResultEnabled,disabled:!n,"aria-label":t.formatMessage(He.aiTopResult),shouldWrapTitle:!0})}],render:e=>(0,Le.jsx)(Be().A,{...e})}]),[d,n,t,a.hideAiTopResultEnabled,a.stickyFiltersEnabled,m,p]);return(0,Le.jsx)(Fe().A,{menuType:Pe().gu.Popup,width:300,disableScroller:!0,children:(0,Le.jsx)(Oe().A,{type:Oe().O.Vertical,initialFocus:void 0,sections:f})})}const He=(0,M().YK)({debugToggle:{id:"search2.debugToggle",defaultMessage:"Search debug tools"},settingsToggle:{id:"search2.settingsToggle",defaultMessage:"Search settings"},settingsMenuAriaLabel:{id:"search2.settingsMenu.ariaLabel",defaultMessage:"Search settings menu"},stickyFilters:{id:"search2.settingsMenu.stickyFilters.label",defaultMessage:"Persist filters across sessions"},aiTopResult:{id:"search2.settingsMenu.aiTopResult.label",defaultMessage:"Hide “Search all sources with AI”"}});var We=()=>n(564884),Ge=()=>n(717137),$e=()=>n(807449),Ye=()=>n(31511),Qe=()=>n(631524),Ze=()=>n(582684),Xe=()=>n(112412),Je=()=>n(207207),et=()=>n(177148),tt=()=>n(788621),nt=()=>n(737693),rt=()=>n(435644),ot=()=>n(42583),it=()=>n(729368),st=()=>n(130119),at=()=>n(366437),lt=()=>n(311563),ct=()=>n(260850),ut=()=>n(298182),dt=()=>n(798836),pt=()=>n(203262),mt=()=>n(203031),ft=()=>n(26697),ht=()=>n(683658);function gt(e){const{currentUserId:t,isShowingHighlightPane:n,setIsShowingHighlightPane:r,explicitVisibility:o}=e,i=void 0!==o?o:!n;var s,a;t&&(s=t,a=i,ue().K.set({userId:s,key:St,value:a})),r(i)}function vt(e){const{isShowingHighlightPane:t,setIsShowingHighlightPane:n}=e,o=(0,l().v3)(),i=(0,r.useRef)(!1),s=o.currentUser.id;(0,r.useEffect)((()=>{if(!s||i.current)return;const e=function(e){const t=ue().K.get({userId:e,key:St});if("boolean"!=typeof t)return!0;return t}(s);e!==t&&n(e),i.current=!0}),[s,t,n]);const c=(0,p().IS)((()=>({container:{marginInlineEnd:4,display:"flex"}})),[]),u=(0,M().tz)(),d=t?u.formatMessage(yt.hide):u.formatMessage(yt.show),m=(0,r.useCallback)((()=>{gt({currentUserId:s,isShowingHighlightPane:t,setIsShowingHighlightPane:n})}),[s,t,n]);return(0,Le.jsx)(ft().m,{renderTooltip:()=>(0,Le.jsx)("div",{children:d}),placement:"bottom",alignment:"start",disableTooltip:a().A.isMobile,delayThreshold:400,render:e=>(0,Le.jsx)("span",{style:c.container,children:(0,Le.jsx)(Ee().A,{...e,icon:ht().q,size:"md",ariaLabel:d,onClick:m,...t?{colorPalette:"blue",colorVariant:"accentPrimary"}:{}})})})}const yt=(0,M().YK)({show:{id:"search2.highlightPane.show",defaultMessage:"Show highlight pane"},hide:{id:"search2.highlightPane.hide",defaultMessage:"Hide highlight pane"}}),St="search_highlight_pane_visibility";var bt=()=>n(302560);function xt(){const e=(0,l().v3)();return(0,d().K8)((()=>{const t=(0,bt().V)(e.device),n=(0,j().E)(e).hasPublicAccessPermission;return t&&!n}),[e])}var It=()=>n(611648),kt=()=>n(916694),Mt=()=>n(626652),_t=()=>n(465628),wt=()=>n(30537),Ct=()=>n(452004),Tt=()=>n(159506),At=()=>n(376254),Rt=()=>n(691298),Et=()=>n(354305),jt=(n(581454),()=>n(906745)),Pt=()=>n(81068),Ft=()=>n(496603),Ot=()=>n(707160),Bt=()=>n(547149);function Dt(e){const{isFirstSection:t,query:n,disabled:o=!1,searchSessionId:i,menuListStore:s}=e,a=(0,M().tz)(),c=(0,l().v3)(),[u,d]=(0,r.useState)("created"),[p,m]=(0,r.useState)({starting:void 0,ending:void 0}),f=(0,r.useMemo)((()=>[{key:"today",title:a.formatMessage(Nt.today),value:0},{key:"last_7_days",title:a.formatMessage(Nt.last7Days),value:7},{key:"last_30_days",title:a.formatMessage(Nt.last30Days),value:30}]),[a]),h=(0,r.useMemo)((()=>o?[]:f.filter((e=>e.title.toLowerCase().includes(n.toLowerCase())))),[f,n,o]);!function(e){const{disabled:t,query:n,results:o,menuListStore:i}=e,s=n.trim().length>0,a=o.length>0;(0,r.useEffect)((()=>{if(t)return;const e=s&&a?{section:0,indexLocal:1,indexGlobal:1,footerFocused:!1}:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1};i.update((t=>{const{focus:n}=t;return(0,Ft().n4)(n,e)?t:{...t,focus:e}}))}),[t,a,i,n,s])}({disabled:o,query:n,results:h,menuListStore:s});const g=(0,r.useCallback)((e=>{!e.error&&e.value&&m((t=>({...t,...e.value})))}),[]),v=(0,r.useCallback)((()=>{if(!p.starting||!p.ending)return;const e=(0,k().Ww9)({type:"daterange",start_date:p.starting.start_date,end_date:p.ending.start_date});Bt().createAndCommit({userAction:"SearchFilterMenu.dateRangeMenuClose",environment:c,canUndo:!0,perform:t=>{Tt().Ju({environment:c,annotation:(0,k().uLW)({date:e,mode:u}),transaction:t})}}),m({starting:void 0,ending:void 0})}),[p,c,u]),y=(0,r.useMemo)((()=>{if(o)return[];const e=h.map((e=>({key:e.key,render:t=>(0,Le.jsx)(Pt().A,{...t,title:e.title}),action:t=>{const n=jt().DateTime.now(),r=0===e.value?n:n.minus({days:e.value}),o=[k().BQP.Date,{type:"daterange",start_date:r.toISODate(),end_date:n.toISODate()}];Bt().createAndCommit({userAction:"SearchFilterMenu.dateRangeMenuItem",environment:c,canUndo:!0,perform:e=>{Tt().Ju({environment:c,annotation:(0,k().uLW)({date:o,mode:u}),transaction:e})}}),(0,We().u)({environment:c,event:{eventName:"search_insert_typeable_filter",eventProperties:{type:"date",search_session_id:i}}})}}))),t=()=>d("created"===u?"lastEdited":"created");return[{key:"date-mode-toggle",action:()=>t(),render:e=>(0,Le.jsx)(Ve().A,{...e,focused:e.focused,title:"created"===u?a.formatMessage(Nt.createdMode):a.formatMessage(Nt.lastEditedMode),on:"lastEdited"===u,onClick:()=>t()})},...e]}),[o,h,c,i,u,a]),S=(0,r.useMemo)((()=>{if(!o&&0!==y.length)return{key:"date range results",render:e=>(0,Le.jsx)(Be().A,{...e,title:(0,Le.jsx)(M().sA,{defaultMessage:"Add date filter",id:"searchFilterMenu.dateRangeSection.title"}),desktopTitleStyle:t?{paddingTop:4}:void 0,topBorder:!t}),items:y}}),[y,t,o]),b=(0,r.useCallback)((()=>{v()}),[v]);if(!o&&S)return{menuListSection:S,element:(0,Le.jsx)(Ot().A,{title:"Select Date Range",value:p,onUpdate:g,onDismiss:b,disableMenuWrap:!0,hideDateInputMenuItems:!0}),onDismiss:b}}const Nt=(0,M().YK)({createdMode:{id:"searchFilterMenu.dateRange.mode.created",defaultMessage:"Created"},lastEditedMode:{id:"searchFilterMenu.dateRange.mode.lastEdited",defaultMessage:"Last edited"},today:{id:"searchFilterMenu.dateRange.today",defaultMessage:"Today"},last7Days:{id:"searchFilterMenu.dateRange.last7Days",defaultMessage:"Last 7 days"},last30Days:{id:"searchFilterMenu.dateRange.last30Days",defaultMessage:"Last 30 days"}});var Vt=()=>n(778078),Lt=()=>n(649265);function zt(e){const{isFirstSection:t,query:n,disabled:o=!1,searchSessionId:i}=e,s=(0,M().tz)(),a=(0,l().v3)(),c=(0,r.useMemo)((()=>o?[]:(0,Vt().Ay)(n,Lt()._9,(e=>function(e,t){switch(e){case"lastEdited.desc":return t.formatMessage(Lt().Jq.lastEditedNewestFirst);case"lastEdited.asc":return t.formatMessage(Lt().Jq.lastEditedOldestFirst);case"created.desc":return t.formatMessage(Lt().Jq.createdNewestFirst);case"created.asc":return t.formatMessage(Lt().Jq.createdOldestFirst);default:return t.formatMessage(Lt().Jq.bestMatches)}}(e.key,s)))),[n,s,o]),u=(0,r.useMemo)((()=>o?[]:c.map((e=>({key:e.key,render:t=>(0,Le.jsx)(Pt().A,{...t,title:s.formatMessage(e.formattedName)}),action:()=>{const t=Lt().Bo[e.key];t&&(Bt().createAndCommit({userAction:"SearchFilterMenu.sortMenuItem",environment:a,canUndo:!0,perform:e=>{Tt().Ju({environment:a,annotation:(0,k().wU2)(t),transaction:e})}}),(0,We().u)({environment:a,event:{eventName:"search_insert_typeable_filter",eventProperties:{type:"sort",search_session_id:i}}}))}})))),[o,c,s,a,i]),d=(0,r.useMemo)((()=>{if(0!==u.length)return{key:"sort results",render:e=>(0,Le.jsx)(Be().A,{...e,title:s.formatMessage(qt.sortSectionTitle),desktopTitleStyle:t?{paddingTop:4}:void 0,topBorder:!t}),items:u}}),[u,t,s]);if(d)return{menuListSection:d,element:void 0}}const qt=(0,M().YK)({sortSectionTitle:{id:"searchFilterMenu.sortSection.title",defaultMessage:"Sort by"}});var Ut=()=>n(991003),Kt=()=>n(305390),Ht=()=>n(381379),Wt=()=>n(385979);function Gt({show:e}){const t=(0,Ut().A)(e,500,300);return(0,Le.jsx)(je().A,{style:{textAlign:"center",visibility:t?"visible":"hidden",display:"inline",marginInlineStart:8}})}const $t=(0,M().YK)({noPageResults:{defaultMessage:"No page results",id:"searchFilterMenu.noPageSearchResults.title"},linkToPage:{defaultMessage:"Add page filter",id:"searchFilterMenu.addPageFilter.title"}});var Yt=()=>n(723085),Qt=()=>n(710515),Zt=()=>n(187174),Xt=()=>n(854150),Jt=()=>n(763824),en=()=>n(852711),tn=()=>n(51700);const nn=(0,M().YK)({searchFilterTeamSection:{defaultMessage:"Add teamspace filter",id:"searchFilterMenu.teamSection.title"},noTeamspaceResults:{defaultMessage:"No teamspace results",id:"searchFilterMenu.teamSection.noResults"}});var rn=()=>n(421861),on=()=>n(62088);const sn=(0,M().YK)({searchFilterPeopleSection:{defaultMessage:"Add creator filter",id:"searchFilterMenu.peopleSection.title"}});function an(e){const{query:t,menuListStore:n}=e,o=(0,d().O$)(Et().D),s=o.open?o.targetSection:void 0,a=(0,d().K8)((()=>H()._.state.sessionId),[]),c="user"===s,{userResultsSection:u}=function(e){const{query:t,isFirstSection:n,disabled:o,searchSessionId:i}=e,s=(0,l().v3)(),a=(0,d().K8)((()=>Et().D.state.open),[]),c=a&&!o,{results:u,isLoading:p}=(0,on().uE)({query:t,disabled:!c,useMentionMenuStore:!1,open:a}),m=(0,r.useMemo)((()=>u.map((e=>{const t=e.id;return{key:t,render:n=>(0,r.createElement)(rn().i,{...n,key:t,user:e}),action:t=>{Bt().createAndCommit({userAction:"SearchFilterMenu.userMenuItem",environment:s,canUndo:!0,perform:t=>{Tt().Ju({environment:s,annotation:(0,k().J_S)(e.id),transaction:t})}}),(0,We().u)({environment:s,event:{eventName:"search_insert_typeable_filter",eventProperties:{type:"user",search_session_id:i}}})}}}))),[u,s,i]),f=(0,Wt().h)({resultsCount:m.length,shouldShow:p,variant:"mention-menu-people"}),h=(0,r.useMemo)((()=>{if(!c)return;const e={key:"search-filter-user-results",render:e=>(0,Le.jsx)(Be().A,{...e,title:(0,Le.jsx)(M().sA,{...sn.searchFilterPeopleSection}),topBorder:!n}),items:[...m,...f]};return{menuListSection:e,element:void 0}}),[n,c,f,m]);return{userResultsSection:h,isUserResultsLoading:p}}({query:t,isFirstSection:c,disabled:!c,searchSessionId:a}),p="page"===s,{pageResultsSection:m}=function(e){const{query:t,disabled:n,searchSessionId:o}=e,i=(0,M().tz)(),s=(0,l().v3)(),a=(0,d().K8)((()=>Et().D.state.open&&!n),[n]),{results:c,isLoading:u}=(0,Ht().r)({query:t,disabled:!a,includeDataSources:!1}),p=(0,r.useMemo)((()=>(0,Ft().oE)(c.map((({store:e,serverEventProperties:t})=>{const n=e.id;return{key:n,render:t=>(0,Le.jsx)(Kt().A,{...t,store:e,showVerifiedPageBadge:!0}),action:e=>{Bt().createAndCommit({userAction:"SearchFilterMenu.getPageResultsMenuSection",environment:s,canUndo:!0,perform:e=>{Tt().Ju({environment:s,annotation:(0,k().Umo)(n),transaction:e})}}),(0,We().u)({environment:s,event:{eventName:"search_insert_typeable_filter",eventProperties:{type:"page",search_session_id:o}}})}}})))),[s,c,o]),m=(0,Wt().h)({resultsCount:p.length,shouldShow:u,variant:"mention-menu-page"}),f=p.length>0,h=(0,r.useMemo)((()=>{const e=f||u?$t.linkToPage:$t.noPageResults;return(0,Le.jsxs)(Le.Fragment,{children:[i.formatMessage(e),(0,Le.jsx)(Gt,{show:u})]})}),[f,u,i]),g=(0,r.useMemo)((()=>{if(!a)return;const e={key:"search filter page results",render:e=>(0,Le.jsx)(Be().A,{...e,title:h,topBorder:!1}),items:[...p,...m]};return{menuListSection:e,element:void 0}}),[a,p,m,h]);return{pageResultsSection:g,isPageResultsLoading:u}}({query:t,disabled:!p,searchSessionId:a}),f="team"===s,h=function(e){const{query:t,isFirstSection:n,disabled:o,searchSessionId:s}=e,[a,c]=(0,r.useState)([]),u=(0,l().v3)(),p=(0,Ae().r)(),m=(0,d().K8)((()=>Et().D.state.open&&!o),[o]),f=(0,d().O$)(i().AppStoreSidebarSpaceStore);(0,Zt().Yb)((async()=>{if(!m||!f)return void c([]);const e=i().default.state.sidebarSpaceViewStore,n=e?(0,Qt().r)(e):[];if(!t)return void c(n);const r=await(0,tn().lx)({query:t,current:[]},u),o=await(0,Jt().lX)(r,tn().UO,(async e=>{const t=Yt().h.createChildStore(f,{table:Xt().yK,id:e,spaceId:p});return await t.load(),t}));c(o)}),[m,f,t,u,p]);const h=(0,r.useMemo)((()=>a.map((e=>{const t=e.id;return{key:t,render:n=>(0,r.createElement)(en().A,{...n,key:t,teamStore:e}),action:t=>{p&&(Bt().createAndCommit({userAction:"SearchFilterMenu.teamMenuItem",environment:u,canUndo:!0,perform:t=>{Tt().Ju({environment:u,annotation:(0,k().tPj)({teamId:e.id,spaceId:p,mentionType:"teamspace"}),transaction:t})}}),(0,We().u)({environment:u,event:{eventName:"search_insert_typeable_filter",eventProperties:{type:"team",search_session_id:s}}}))}}}))),[a,u,p,s]),g=(0,r.useMemo)((()=>{if(!m)return;const e=a.length>0?(0,Le.jsx)(M().sA,{...nn.searchFilterTeamSection}):(0,Le.jsx)(M().sA,{...nn.noTeamspaceResults});return{key:"search filter team results",render:t=>(0,Le.jsx)(Be().A,{...t,title:e,topBorder:!n}),items:h}}),[m,h,n,a.length]);if(g)return{menuListSection:g,element:void 0}}({query:t,isFirstSection:f,disabled:!f,searchSessionId:a}),g="sort"===s,v=zt({query:t,disabled:!g,isFirstSection:g,searchSessionId:a}),y="date"===s,S=Dt({query:t,isFirstSection:y,disabled:!y,searchSessionId:a,menuListStore:n}),b=(0,r.useMemo)((()=>({user:u,page:m,team:h,sort:v,date:S})),[u,m,h,v,S]);return(0,r.useMemo)((()=>{if(o.open&&s)return b[s]}),[o.open,b,s])}const ln={width:250,maxHeight:200};function cn(){const e=(0,d().O$)(Et().D),t=e.open,n=(0,d().uB)(void 0,Ct().$),o=(0,d().K8)((()=>{if(t)return(0,Mt().a)(e.inputTextStore,e.oldTextValue,dt().D)}),[e,t]),i=an({query:(0,d().K8)((()=>t?(0,kt().m)(e.inputTextStore,o)??"":""),[o,e,t]),menuListStore:n}),s=(0,r.useMemo)((()=>{const e=null==i?void 0:i.menuListSection;return e?[e]:[]}),[i]),a=null==i?void 0:i.onDismiss,l=(0,r.useCallback)((()=>{null==a||a(),Tt().VN()}),[a]),c=null==i?void 0:i.element;return function(e){const{inputSelections:t}=e,n=(0,d().O$)(Et().D),o=(0,d().K8)((()=>{var e;if(!n.open||!t)return!1;const r=null===(e=n.inputTextStore)||void 0===e?void 0:e.getValue();if(!r)return!1;const o=(0,k().qAZ)(r);return o.includes(dt().D)&&o.length>1}),[n,t]),{getSavedSelection:i}=(0,Rt().A)({shouldPreserveTextSelection:!1,shouldPreserveBlockSelection:!1,shouldRestoreSelection:!1}),s=(0,d().K8)((()=>{var e;if(!n.open)return!1;const t=i().textSelectionState,r=n.inputTextStore;return Boolean(t&&"editing"===t.mode&&(null===(e=(0,_t().H)(t.multiSelection))||void 0===e?void 0:e.store)===r)}),[n,i]),a=(0,d().K8)((()=>{if(!n.open)return!1;const e=h().default.state,t=n.inputTextStore,r="editing"===e.mode?(0,_t().H)(e.multiSelection):void 0;return(null==r?void 0:r.store)===t}),[n]),l=(0,d().K8)((()=>{if(!n.open||!a||!t)return!1;const e=h().default.state,r="editing"===e.mode?(0,_t().H)(e.multiSelection):void 0,o=null==r?void 0:r.selection;return!!o&&(o.startIndex<t.filter.startIndex||o.endIndex>t.filter.endIndex)}),[n,a,t]),c=a||s,u=!n.open||!c||l||!o;(0,r.useEffect)((()=>{u&&Tt().VN()}),[u])}({inputSelections:o}),(0,Le.jsx)(g().zD,{popupType:wt().n.Popup,open:t,originRect:t?e.selectionRect:void 0,placementToOrigin:"bottom",alignmentToOrigin:"start",originGap:12,disableMouseCapture:!1,disableContentScroll:!0,onDismiss:l,keepFocus:!0,trapFocus:!1,render:()=>(0,Le.jsxs)(At().H,{type:It().A.Y,style:c?void 0:ln,children:[(0,Le.jsx)(Oe().A,{type:Oe().O.Vertical,initialFocus:0,resetInitialFocusOnSectionChange:!0,resetInitialFocusOnSectionChangeAlways:!0,sections:s,disableKeyboardArrowWrap:!0,onEmptyEnter:()=>Tt().VN(),performHandleEnterOnTab:!0,store:n}),c]})})}function un(e){const{inputComboboxProps:t,queryText:n,scrollerRef:o,onClose:i,hasFilters:c,isShowingFilterBar:u,setIsShowingFilterBar:f,isShowingHighlightPane:h,setIsShowingHighlightPane:g}=e,v=(0,l().v3)(),y=(0,M().tz)(),S=xt(),{isNewElectronTab:b,mode:x}=(0,d().K8)((()=>({isNewElectronTab:H()._.state.isNewElectronTab,mode:H()._.state.mode})),[],{debugName:"SearchInput.miniSearchStoreState"}),I=(0,d().K8)((()=>(0,K().q)(v)),[v],{debugName:"SearchInput.isInQuickSearchMode"}),_=(0,d().K8)((()=>"two_pane_1_snippet"===s().default.getEligibleGroup({experimentId:"search_highlight_client_variant",defaultGroup:"inline_2_snippets"})),[]),w=(0,m().lW)(),C=_&&w.width>=1006,T=(0,mt().H)({intl:y,isNewElectronTab:b}),A=(0,d().K8)((()=>(0,k().q4_)(n.store.getValue()||[]).length),[n.store],{debugName:"SearchInput.userTextLength"}),R=(0,r.useMemo)((()=>0===A&&I?`min(${T.length}ch, 100%)`:"100%"),[A,I,T.length]),E=(0,r.useCallback)((()=>{var e;null===(e=o.current)||void 0===e||null===(e=e.getNode())||void 0===e||e.scrollTo({top:0,behavior:"auto"});const t=n.store.getValue();if(t){const e=(0,k().q4_)(t);if(e.includes("\n")){const t=e.replace(/[\r\n]+/g," ");n.setValue(t?[[t]]:[])}}const r=void 0===te().default.state.firstKeyStrokeTimeMs;te().default.update((e=>({...e,firstKeyStrokeTimeMs:r?Date.now():e.firstKeyStrokeTimeMs,numKeystrokes:e.numKeystrokes+1})))}),[o,n]),j=(0,r.useCallback)((e=>{if(S)return;const t=e.target.value;F(t),n.setValue(t?[[t]]:[]),E()}),[n,E,S]),[P,F]=(0,r.useState)("");(0,r.useEffect)((()=>{if(S)return;const e=(0,k().q4_)(n.store.getValue()??[]);F(e)}),[S,n.store]);const O=(0,p().IS)((()=>({searchIcon:{color:Ne().Tj.icon.secondary,width:20,height:20,marginInlineStart:4,marginInlineEnd:4},textContainer:{display:"flex",alignItems:"center",margin:10,gap:I?4:10,...I?(0,st().g)({noDrag:!0}):{}},textPlaceholder:{cursor:"text"},textInput:{overflowX:"auto",overflowY:"hidden",whiteSpace:"pre",cursor:"text"},workspaceSwitcherContainer:{display:"flex",alignItems:"center",marginInlineStart:4,marginInlineEnd:I?0:4},draggableWrapper:{display:"flex",flex:1,alignItems:"center",justifyContent:"space-between"},inputContainerWithDynamicWidth:{width:R},filterButtonContainer:{display:"flex",alignItems:"center",marginInlineEnd:10},cancelButton:{marginInlineEnd:10,color:Ne().Tj.text.secondary}})),[R,I]);return(0,r.useMemo)((()=>{const e=I?(0,Le.jsx)("div",{style:O.workspaceSwitcherContainer,children:(0,Le.jsx)(lt().L,{mode:x})}):(0,Le.jsx)($e().I,{icon:Je().magnifyingGlassIcon,colorVariant:"tertiary",style:O.searchIcon}),r=S?(0,Le.jsxs)(Le.Fragment,{children:[(0,Le.jsx)(it().A,{...t,placeholder:T,onClick:void 0,disabled:!1,store:n.store,inPageFind:at().Os.none,pasteBehavior:"inline",placeholderStyle:O.textPlaceholder,disableUpDownArrows:!0,disableSlashCommands:!0,disableMobileActionBar:!0,disableMentions:a().A.isMobile,disableEmbedMenu:!0,disableInsertedDeletedAnnotations:!0,disableEmojiCommands:!0,disabledMentionTypes:ut().md,allowSearchTypeableFilters:S,disableShiftEnter:!0,disableComment:!0,style:O.textInput,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableEnter:!0,disableStyleAnnotations:!0,disableSuggestEdit:!0,disableRichTextActions:!0,onChange:e=>E(),onEsc:i}),(0,Le.jsx)(cn,{})]}):(0,Le.jsx)(Ye().A,{...t,format:"transparent",placeholder:T,value:P,onChange:j,focus:!0,style:O.textInput,selectAll:!0,onKeyDown:e=>{"Escape"===e.key&&i()}});return(0,Le.jsxs)("div",{style:O.draggableWrapper,className:I?ae().sbV:void 0,children:[(0,Le.jsx)("div",{style:O.inputContainerWithDynamicWidth,children:(0,Le.jsx)(Ge().A,{capture:!0,debugName:"SearchInput",children:(0,Le.jsxs)("div",{style:O.textContainer,children:[e,r]})})}),a().A.isMobile?(0,Le.jsx)(Qe().p,{onClick:i,style:O.cancelButton,children:y.formatMessage(mn.cancel)}):(0,Le.jsxs)("div",{style:O.filterButtonContainer,children:[C?(0,Le.jsx)(vt,{isShowingHighlightPane:h,setIsShowingHighlightPane:g}):null,(0,Le.jsx)(dn,{hasFilters:c,queryText:n,isShowingFilterBar:u,setIsShowingFilterBar:f})]})]})}),[I,O.workspaceSwitcherContainer,O.searchIcon,O.draggableWrapper,O.inputContainerWithDynamicWidth,O.textContainer,O.textPlaceholder,O.textInput,O.filterButtonContainer,O.cancelButton,x,t,T,n,S,i,y,C,h,g,c,u,f,E,P,j])}function dn(e){const{hasFilters:t,isShowingFilterBar:n,setIsShowingFilterBar:r,queryText:o}=e;return xt()?(0,Le.jsx)(pn,{inputStore:o.store,setInput:o.setValue,hasFilters:t}):(0,Le.jsx)(pt().g,{hasFilters:t,isShowingFilterBar:n,setIsShowingFilterBar:r})}function pn(e){const{inputStore:t,setInput:n,hasFilters:o}=e,i=(0,l().v3)(),s=(0,M().tz)(),[a,c]=(0,r.useState)(!1),u=(0,d().K8)((()=>H()._.state.sessionId),[]),p=(0,r.useCallback)((()=>{const e=i.currentUser.id;if(!e)return;const r=t.getValue()||[],o=(0,k().wmz)((0,k().J_S)(e)),s=r.length>0?[...r,o]:[o];n(s),(0,ct().z)({store:t}),c(!1)}),[i.currentUser.id,t,n]),m=(0,r.useCallback)((()=>{const e=t.getValue()||[],r=(0,k().wmz)((0,k().C_C)()),o=e.length>0?[...e,r]:[r];n(o),c(!1)}),[t,n]),f=(0,r.useCallback)((e=>{dt().zU({filterType:e,inputStore:t,setInput:n,intl:s}),c(!1),(0,We().u)({environment:i,event:{eventName:"search_add_filter_via_popup",eventProperties:{type:dt().dY[e],search_session_id:u}}})}),[i,t,u,n,s]),h=(0,r.useMemo)((()=>({items:[{key:"my-docs-option",render:e=>(0,Le.jsx)(Qe().p,{...e,iconLeading:tt().personCircleIcon,children:(0,Le.jsx)("div",{children:s.formatMessage(mn.myDocsFilter)})}),action:()=>p()}],render:e=>(0,Le.jsx)(Be().A,{...e,title:s.formatMessage(mn.suggestedSectionTitle)}),key:"suggested-filter-section"})),[p,s]),v=(0,r.useMemo)((()=>({key:"filter-button-sort-section",items:[{key:"search-filters-sort-filter-option",render:e=>(0,Le.jsx)(Qe().p,{...e,iconLeading:Ze().arrowUpDownIcon,children:s.formatMessage(mn.sortSectionTitle)}),action:()=>f("sort")}],render:e=>(0,Le.jsx)(Be().A,{...e,title:s.formatMessage(mn.sortSectionTitle)})})),[f,s]),y=(0,r.useMemo)((()=>({items:[{key:"search-filters-author-filter-option",render:e=>(0,Le.jsx)(Qe().p,{...e,iconLeading:tt().personCircleIcon,children:s.formatMessage(mn.authorFilter)}),action:()=>f("by")},{key:"search-filters-in-filter-option",render:e=>(0,Le.jsx)(Qe().p,{...e,iconLeading:et().Y,children:s.formatMessage(mn.inFilter)}),action:()=>f("in")},{key:"search-filters-date-filter-option",render:e=>(0,Le.jsx)(Qe().p,{...e,iconLeading:ot().D,children:s.formatMessage(mn.dateFilter)}),action:()=>f("date")},{key:"title-only-option",render:e=>(0,Le.jsx)(Qe().p,{...e,iconLeading:rt().a,children:`${s.formatMessage(mn.titleOnlyFilter)}`}),action:()=>m()},{key:"search-filters-team-filter-option",render:e=>(0,Le.jsx)(Qe().p,{...e,iconLeading:nt().V,children:s.formatMessage(mn.teamFilter)}),action:()=>f("team")}],render:e=>(0,Le.jsx)(Be().A,{...e,title:s.formatMessage(mn.addFilterSectionTitle)}),key:"filter-section"})),[m,f,s]),S=(0,r.useMemo)((()=>(0,Le.jsx)(Oe().A,{type:Oe().O.Vertical,disableKeyboardArrowWrap:!0,initialFocus:0,sections:[v,y,h],style:{width:200}})),[h,y,v]);return(0,Le.jsx)(g().zD,{trapFocus:!0,open:a,popupType:g().nl.Popup,origin:(0,Le.jsx)(Qe().p,{iconLeading:{icon:Xe().filterSmallIcon,size:"sm"},colorPalette:o?"blue":"gray",onClick:()=>c(!0),children:s.formatMessage(mn.filterButtonCaption)}),onDismiss:()=>c(!1),render:()=>S})}const mn=(0,M().YK)({filterButtonCaption:{defaultMessage:"Filters",id:"SearchInput.filterButtonCaption"},myDocsFilter:{defaultMessage:"My docs",id:"SearchInput.myDocsFilter"},authorFilter:{defaultMessage:"Author",id:"SearchInput.authorFilter"},inFilter:{defaultMessage:"In",id:"SearchInput.inFilter"},teamFilter:{defaultMessage:"Teamspace",id:"SearchInput.teamFilter"},addFilterSectionTitle:{defaultMessage:"Add a filter",id:"SearchInput.addFilterSectionTitle"},dateFilter:{defaultMessage:"Date",id:"SearchInput.dateFilter"},suggestedSectionTitle:{defaultMessage:"Suggested",id:"SearchInput.suggestedSectionTitle"},titleOnlyFilter:{defaultMessage:"Title only",id:"SearchInput.titleOnlyFilter"},sortSectionTitle:{defaultMessage:"Sort",id:"SearchInput.sortSectionTitle"},cancel:{defaultMessage:"Cancel",id:"SearchInput.cancel"}});var fn=()=>n(920198),hn=()=>n(381175),gn=()=>n(584262),vn=()=>n(620333),yn=()=>n(913063),Sn=()=>n(534619),bn=()=>n(637307),xn=(n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(803949),()=>n(929219)),In=()=>n(493552),kn=()=>n(340498),Mn=()=>n(825972),_n=(n(672577),()=>n(392890)),wn=()=>n(761940),Cn=()=>n(130382),Tn=()=>n(615234),An=()=>n(866515),Rn=()=>n(424641),En=()=>n(488776),jn=()=>n(1330),Pn=()=>n(677169),Fn=()=>n(614016);const On=2;function Bn(){const e=(0,l().v3)(),t=(0,M().tz)(),[n,o]=(0,r.useState)(!1),[s,a]=(0,r.useState)([]),c=(0,Pn().m)(),u=(0,d().O$)(i().AppStoreSidebarSpaceStore),p=(0,d().O$)(i().AppStoreSidebarSpaceViewStore);(0,Zt().Yb)((async()=>{if(!c.botId||n)return;const t="two_days",r=(0,Fn().B7)(t),i=await(0,jn().qq)({environment:e,sidebarSpaceViewStore:p,forceRefetch:!1,reason:{reason:"background_load"},botId:c.botId,timeRange:{key:t,...r}});"success"!==i&&"skipped"!==i||o(!0)}),[c.botId,p,e,n]);const m=(0,r.useCallback)((()=>{var t;const n=null===(t=i().default.state.currentUserStore)||void 0===t?void 0:t.getEmail();if(!n)return[];const{allEligibleCalendars:r}=(0,wn().RM)({currentUserEmail:n,calendars:(0,En().Y)().getCurrentCalendars()??[],accounts:(0,En().Y)().getCurrentAccounts()});if(0===r.length)return[];const o=function(e){const{eligibleCalendarIds:t}=e,n=Date.now();return(0,En().Y)().getDateTimeEvents().filter((e=>t.includes(e.calendarId))).filter((e=>{const t=new Date(e.end.dateTime);return(0,_n().A)(t,5).getTime()>=n}))}({eligibleCalendarIds:r.map((e=>e.id))}),s=[];for(const i of o){if(s.length===On)break;const t=Dn({event:i,environment:e,spaceStore:u});t&&s.push({event:i,firstAttachmentBlockStore:t})}return s}),[e,u]);(0,An().n)((()=>{const e=m(),t=e.map((({event:e,firstAttachmentBlockStore:t})=>`${e.id}:${t.id}`)),n=s.map((({event:e,firstAttachmentBlockStore:t})=>`${e.id}:${t.id}`));!(0,Ft().n4)(t,n)&&a(e)}),12e4,n);return(0,d().K8)((()=>{const e=[];for(const{event:r,firstAttachmentBlockStore:o}of s){var n;const i=new Date(r.start.dateTime).getTime(),s=r.summary,a=r.id,l=Nn({meetingStartTime:i,intl:t}),c=Vn(i);e.push({store:o,displayableTimeUntilEvent:l,timeUntilEventAnalyticsBucket:c,eventName:s,eventId:a,numberOfAttendees:(null===(n=r.attendees)||void 0===n?void 0:n.length)??0})}return e}),[s,t])}function Dn(e){const{event:t,environment:n,spaceStore:r}=e;return(t.attachments??[]).map((e=>{const t=e.fileUrl;return(0,Rn().xy)({environment:n,fileUrl:t,spaceStore:r})})).find((e=>null==e?void 0:e.isReady()))}function Nn(e){const{meetingStartTime:t,intl:n}=e,r=t-Date.now();if(r<=0)return n.formatMessage(Ln.now);if(r<Tn().pT){return`${(0,Cn().ap)(t)}m ${n.formatMessage(Ln.fromNow)}`}if(r<Tn().nD){return`${(0,Cn().qs)(t)}h ${n.formatMessage(Ln.fromNow)}`}return`${(0,Cn().AQ)(t)}d ${n.formatMessage(Ln.fromNow)}`}function Vn(e){const t=e-Date.now();return t<=0?"now":t<Tn().pT?"less_than_1h":t<8*Tn().pT?"less_than_8h":t<Tn().nD?"less_than_24h":"more_than_1d"}const Ln=(0,M().YK)({now:{id:"search2.now",defaultMessage:"Now"},fromNow:{id:"search2.fromNow",defaultMessage:"from now"}});var zn=()=>n(38554),qn=()=>n(966509),Un=()=>n(428343),Kn=()=>n(475553),Hn=()=>n(5844),Wn=()=>n(148080),Gn=()=>n(794545);const $n="new-page";function Yn(e){const{numberOfRecentPagesToShow:t,buildMenuListItem:o,queryId:i,closeSearch:s}=e,c=(0,fn().L)(),{section:u,pageIdsFromUpcomingMeetings:p,upcomingMeetingResults:m}=function(e){const{trackSelectSearchItem:t,closeSearch:n,queryId:o}=e,i=(0,M().tz)(),s=(0,l().v3)(),c=(0,Pn().m)(),u=Bn(),p=(0,d().K8)((()=>u.map((e=>e.store.id))),[u]),m=(0,yn().o)(),f=(0,d().K8)((()=>(0,K().q)(s)&&s.device.isElectron),[s]),{isNewElectronTab:h,searchSessionId:g}=(0,d().K8)((()=>({isNewElectronTab:H()._.state.isNewElectronTab,searchSessionId:H()._.state.sessionId})),[],{debugName:"Search2.isNewElectronTab"}),y=c.botId,{upcomingMeetingSection:S,pageResultsFromUpcomingMeetings:b}=(0,r.useMemo)((()=>{if(0===p.length)return{upcomingMeetingSection:void 0,pageResultsFromUpcomingMeetings:[]};const e=u.map(((e,t)=>Qn({blockStore:e.store,idx:t,resultFeatureNames:["UPCOMING_MEETING_ATTACHMENTS"]}))),r=(e,r)=>{const l=u[r],c=l.eventName??i.formatMessage(Zn.untitledMeeting),d=l.displayableTimeUntilEvent,p=(0,Le.jsxs)(v().fI,{gap:4,children:[(0,Le.jsx)($e().I,{icon:ot().D,size:kn().Ev.sm}),(0,Le.jsx)(In().D,{colorPalette:"gray",colorVariant:"secondary",styleKey:"captionRegular",children:c})]}),S=a().A.isMobile?void 0:(0,Le.jsx)(In().D,{colorPalette:"gray",colorVariant:"secondary",styleKey:"captionRegular",children:d});return{render:t=>(0,Le.jsx)(Gn().Kr,{...t,currentView:"recents",result:e,queryId:o,rightOverride:S,captionOverride:p}),key:`search-upcoming-meeting-${e.store.id}-${r}`,action:({event:r})=>{Sn().executeSearchResultNavigation({event:r,result:e,context:"recent_pages",environment:s,queryId:o,trackSelectSearchItem:t,closeSearch:n,isCommandSearch:f,electronTabs:m,isNewElectronTab:h,source:gn().y8.SearchRecents}),(0,We().u)({environment:s,event:{eventName:"search_calendar_attachment_click",eventProperties:{search_session_id:g,number_of_attendees:l.numberOfAttendees,time_until_event_bucket:l.timeUntilEventAnalyticsBucket}}}),y&&(0,qn().R)({environment:s,data:{type:"track",payload:{event:"eventAttachmentOpened",provider:"notion",location:"notionSearchNoQueryView",method:"notionSearchNoQueryView"}},botId:y})}}};return{upcomingMeetingSection:{items:e.map(((e,t)=>r(e,t))),key:"upcoming-meeting-attachments",render:e=>(0,Le.jsx)(Be().A,{...e,title:i.formatMessage(Zn.fromCalendarEvents)})},pageResultsFromUpcomingMeetings:e}}),[p.length,u,i,o,s,t,n,f,m,h,g,y]);return{section:S,pageIdsFromUpcomingMeetings:p,upcomingMeetingResults:b}}({trackSelectSearchItem:e.trackSelectSearchItem,closeSearch:s,queryId:i}),f=(0,d().K8)((()=>(0,n(486674).a)()),[],{debugName:"Search2.currentPageStore"}),h=(0,d().K8)((()=>Mn().NK.state.filter((e=>e.pageId!==(null==f?void 0:f.id)&&!p.includes(e.pageId))).slice(0,t-p.length)),[t,p,f]),{resultsByBucket:g,recentAlivePageResults:y}=(0,d().K8)((()=>{const e=new Map,t=[];return h.forEach(((n,r)=>{const i=(0,Mn().ht)(n.visitedAt),s=Qn({blockStore:n.store,idx:r,resultFeatureNames:["RECENT_ALIVE_PAGES"]}),a=o(s);var l;(t.push(s),e.has(i))?null===(l=e.get(i))||void 0===l||l.push(a):e.set(i,[a])})),{resultsByBucket:e,recentAlivePageResults:t}}),[o,h],{debugName:"Search2.resultsByBucket"}),S=function(){const e=(0,M().tz)(),t=(0,l().v3)(),n=(0,zn().U)(),o=(0,d().K8)((()=>H()._.state.isNewElectronTab),[],{debugName:"Search2.isNewElectronTab"}),i=(0,yn().o)(),s=(0,r.useMemo)((()=>{if(o)return(0,bn().mD)({environment:t,intl:e,electronTabs:i,isNewElectronTab:o,isSlipperySlopeEnabled:n})}),[t,e,o,i,n]);return s}(),b=function(){const e=(0,M().tz)(),t=(0,l().v3)(),n=(0,zn().U)(),o=(0,d().K8)((()=>H()._.state.isNewElectronTab),[],{debugName:"Search2.isNewElectronTab"}),i=(0,r.useMemo)((()=>{if(o&&n)return(0,Hn().B)({environment:t,intl:e})}),[t,e,o,n]);return i}(),{offlinePageSection:x,isOfflineMode:I,offlinePageResults:k}=function(e){const t=(0,M().tz)(),n=Boolean((0,Kn().y)()),o=!(0,d().O$)(xn().e),i=n&&o,s=(0,Un().Q)({filterCategory:"all",availableOffline:!0,searchQuery:"",disable:!i}),{section:a,results:l}=(0,r.useMemo)((()=>{const n=s.map(((e,t)=>Qn({idx:t,blockStore:e.pageBlockStore,resultFeatureNames:["OFFLINE_PAGES"]})));return{section:{items:n.map(e),key:"offline-pages",render:e=>(0,Le.jsx)(Be().A,{...e,title:t.formatMessage(Wn().g.offlinePages)})},results:n}}),[s,e,t]);return{isOfflineMode:i,offlinePageSection:a,offlinePageResults:l}}(o),_=(0,n(297799).U)({onClick:()=>s({shouldResetQuery:!1})}),w=(0,r.useMemo)((()=>{const e=[];return Mn().Rj.forEach((t=>{const n=g.get(t);n&&0!==n.length&&e.push({items:n,key:`recent-pages-${t}`,render:e=>(0,Le.jsx)(Be().A,{...e,title:(0,Le.jsx)(bn().sg,{bucket:t})})})})),e}),[g]),{recentPageSections:C,allRecentResults:T}=(0,d().K8)((()=>{const e=[],t=[],n=[];return S&&n.push(S),b&&n.push(b),n.length>0&&e.push({items:n,key:$n,render:e=>(0,Le.jsx)(Be().A,{...e})}),u&&(e.push(u),t.push(...m)),I?(e.push(x),t.push(...k)):(e.push(...w),t.push(...y)),_&&e.push(_),{recentPageSections:e,allRecentResults:t}}),[S,b,I,u,m,x,k,w,y,_]),A=(0,n(977570).F)({buildMenuListItem:o}),R=!c&&A;return(0,r.useMemo)((()=>R?{sections:A.sections??[],recentResults:A.results}:{sections:C,recentResults:T}),[R,null==A?void 0:A.sections,null==A?void 0:A.results,C,T])}function Qn(e){const{blockStore:t,idx:n,resultFeatureNames:r}=e;return{id:t.id,score:0,spaceId:t.getSpaceId(),sources:[I().Ni.Local],featureGroups:r?[{groupName:"custom",features:r.map((e=>({name:e,value:1})))}]:[],store:t,originalPosition:n,localSource:new Set,serverEventProperties:void 0}}const Zn=(0,M().YK)({untitledMeeting:{id:"search2.untitledMeeting",defaultMessage:"Untitled meeting"},fromCalendarEvents:{id:"search2.fromCalendarEvents",defaultMessage:"From calendar events"}}),Xn=25.898+8;var Jn=()=>n(563217),er=()=>n(29037),tr=()=>n(534177),nr=()=>n(284371);const rr="experiment-selector",or=r.forwardRef((function(e,t){const{allPossibleExperiments:o,pendingOverrides:i,onExperimentChange:s,onCommitOverrides:a,isPopupOpen:l,onClosePopup:c,debugInfo:u,...d}=e,m=(0,M().tz)(),[f,h]=(0,r.useState)(""),v=(0,r.useRef)(null),[S,b]=(0,y().$)(),x=(0,p().IS)((()=>({container:{borderRadius:6,paddingInlineStart:4},titleContainer:{display:"flex",alignItems:"center",gap:4,color:Ne().Tj.text.primary,fontWeight:nr().Wy.medium,fontSize:14,...nr().RC},activeOverrideSection:{borderBottom:`1px solid ${Ne().Tj.border.primaryTranslucent}`,paddingBottom:8}})),[]),I=(0,r.useMemo)((()=>{if(!f.trim())return o;const e=f.toLowerCase();return o.filter((t=>t.experimentId.toLowerCase().includes(e)))}),[o,f]),k=(0,r.useCallback)(((e,t)=>{const n=function(e,t,n){if("control"===n||void 0===n){const{[t]:n,...r}=e;return r}return{...e,[t]:n}}(i,e,t);s(n)}),[i,s]);(0,r.useEffect)((()=>{l&&setTimeout((()=>{var e;null===(e=v.current)||void 0===e||e.focus()}),100)}),[l]);const _=(0,r.useCallback)((()=>{h(""),c(),a(i)}),[c,a,i]),{overriddenExperimentItems:w,remainingExperimentItems:C}=(0,r.useMemo)((()=>{const e=[],t=[];return I.forEach((n=>{const{experimentId:r,groups:o}=n,s=i[r],a=void 0!==s,l=(()=>{if(o.length<=2){const e=o.find((e=>"control"!==e)),t=s===e,i=n.group===e,a=void 0!==s,l=a?s:n.group;return{key:r,action:()=>{k(r,i&&t||t?void 0:e)},render:e=>(0,Le.jsx)(Pt().A,{...e,title:ar(r),caption:l,right:a?(0,Le.jsx)($e().I,{icon:er().checkmarkIcon,size:"sm",colorPalette:"blue",colorVariant:"accentPrimary"}):void 0})}}return{key:r,action:()=>{},render:e=>(0,Le.jsx)(ir,{...e,experimentId:r,groups:o,currentValue:s,experimentDefaultValue:n.group,onValueChange:k})}})();a?e.push(l):t.push(l)})),{overriddenExperimentItems:e,remainingExperimentItems:t}}),[I,i,k]),T=(0,r.useMemo)((()=>{const e=[];return e.push({key:"search-section",render:e=>(0,Le.jsx)(Be().A,{...e,title:m.formatMessage(lr.searchExperiments)}),items:[{key:"search-input",action:()=>{},render:e=>(0,Le.jsx)(n(419357).Ay,{...e,ref:v,value:f,onChange:e=>h(e.target.value),onKeyDown:e=>{if("Escape"===e.key)return e.preventDefault(),void _();"Backspace"===e.key||"Delete"===e.key?0===f.length&&e.preventDefault():"ArrowUp"!==e.key&&"ArrowDown"!==e.key||e.preventDefault()},placeholder:m.formatMessage(lr.searchPlaceholder),focusInitial:!0,showClearButton:!0,...S})}]}),w.length>0&&e.push({key:"active-overrides",render:e=>(0,Le.jsx)(Be().A,{...e,title:m.formatMessage(lr.activeOverrides),style:x.activeOverrideSection}),items:w}),C.length>0&&e.push({key:"experiments",render:e=>(0,Le.jsx)(Be().A,{...e,title:m.formatMessage(lr.availableExperiments)}),items:C}),e}),[w,C,m,x.activeOverrideSection,f,S,_]),A=Object.keys(i).length>0;return(0,Le.jsx)(g().zD,{open:l,onDismiss:_,popupType:g().nl.Popup,placementToOrigin:"bottom",alignmentToOrigin:"center",trapFocus:!0,ariaLabel:m.formatMessage(lr.searchExperimentsModalLabel),origin:(0,Le.jsx)(Pt().A,{...d,ref:t,title:(0,Le.jsx)("div",{style:x.titleContainer,children:A?Object.keys(i).map(ar).join(", "):m.formatMessage(lr.selectedExperiments)}),icon:(0,Le.jsx)($e().I,{icon:De().c,colorVariant:"primary"}),style:x.container,buttonStyle:Gn().CU,right:u?(0,Le.jsx)(sr,{debugInfo:u}):void 0}),render:()=>(0,Le.jsx)(Fe().A,{menuType:Pe().gu.Popup,width:350,minHeight:150,maxHeight:330,children:(0,Le.jsx)(Oe().A,{type:Oe().O.Vertical,initialFocus:0,sections:T,comboboxProps:b})})})}));function ir(e){const{experimentId:t,groups:r,currentValue:o,experimentDefaultValue:i,onValueChange:s,...a}=e,l=void 0!==o?o:i||"control",c=void 0!==o;return(0,Le.jsx)(n(662971).A,{...a,onFocus:()=>{},renderOrigin:(e,n)=>(0,Le.jsx)(Pt().A,{...e,ref:n,title:ar(t),caption:c?`Override: ${l}`:`Default: ${l}`,right:c?(0,Le.jsx)($e().I,{icon:er().checkmarkIcon,size:"sm",colorPalette:"blue",colorVariant:"accentPrimary"}):void 0,showExtensionArrow:!0}),renderExtension:(e,o)=>(0,Le.jsx)(Fe().A,{menuType:Pe().gu.Popup,width:200,children:(0,Le.jsx)(Oe().A,{type:Oe().O.Vertical,initialFocus:0,sections:[{key:"values",render:e=>(0,Le.jsx)(Be().A,{...e,title:ar(t)}),items:r.map((e=>{const r=e;return{key:e,action:()=>{s(t,e===i?void 0:r),o.close()},render:t=>(0,Le.jsx)(Pt().A,{...t,title:e,right:(()=>{const t=l===e;return i===e?(0,Le.jsx)($e().I,{icon:n(877788).w,size:"sm",colorVariant:"primary"}):t?(0,Le.jsx)($e().I,{icon:er().checkmarkIcon,size:"sm",colorPalette:"blue",colorVariant:"accentPrimary"}):void 0})()})}}))}]})})})}function sr(e){const{debugInfo:t}=e,o=(0,l().v3)(),i=(0,p().IS)((()=>({container:{display:"flex",gap:4,alignItems:"center"},button:{fontSize:12,padding:"2px 6px",borderRadius:4,border:`1px solid ${Ne().Tj.border.primary}`,background:Ne().Tj.background.primary,color:Ne().Tj.text.secondary,cursor:"pointer",userSelect:"none"}})),[]),s=(0,r.useCallback)((async(e,r)=>{e.stopPropagation();const i="request"===r?t.response.rawRequests:t.response.rawResponses;if(i){const e=await(0,n(212497).jd)();await e({environment:o,stringValue:JSON.stringify(i,null,2),copiedMessage:"request"===r?cr.copiedSearchRequest:cr.copiedSearchResponse})}}),[t,o]),a=Boolean(t.response.rawRequests),c=Boolean(t.response.rawResponses);return(0,Le.jsxs)("div",{style:i.container,children:[a?(0,Le.jsx)(Qe().p,{size:"sm",style:i.button,onClick:e=>s(e,"request"),children:"Request"}):void 0,c?(0,Le.jsx)(Qe().p,{size:"sm",style:i.button,onClick:e=>s(e,"response"),children:"Response"}):void 0]})}function ar(e){return e.replace(/^search-/,"")}const lr=(0,M().YK)({selectedExperiments:{id:"search2.selectedExperiments.title",defaultMessage:"Selected experiments"},searchExperiments:{id:"search2.searchExperiments.sectionTitle",defaultMessage:"Search Experiments"},searchExperimentsModalLabel:{id:"search2.searchExperimentsModal.label",defaultMessage:"Search Experiments Modal"},activeOverrides:{id:"search2.activeOverrides.title",defaultMessage:"Active Overrides"},availableExperiments:{id:"search2.availableExperiments.title",defaultMessage:"Available Experiments"},searchPlaceholder:{id:"search2.searchExperimentsModal.placeholder",defaultMessage:"Search experiments..."}}),cr=(0,M().YK)({copiedSearchRequest:{id:"search2.debugButtons.copiedSearchRequest",defaultMessage:"Copied search request"},copiedSearchResponse:{id:"search2.debugButtons.copiedSearchResponse",defaultMessage:"Copied search response"}});var ur=()=>n(40457),dr=()=>n(834474);const pr="deep-find-entry-point",mr="auto-streaming-search";function fr(e){const{query:t,filters:o,hideAiTopResultEnabled:i,searchSessionId:a,searchSessionFlowNumber:c,queryTextValueWithoutSearchFilters:u,isResultsLoading:p,onDismiss:m,results:f,currentView:h,buildMenuListItem:g,source:v,searchActionResults:y,debugConfig:S}=e,b=(0,l().v3)(),x=(0,M().tz)(),k=(0,d().K8)((()=>H()._.state.debug.enabled),[]),_=(0,d().K8)((()=>H()._.state.isNewElectronTab),[],{debugName:"Search2.isNewElectronTab"}),w=(0,yn().o)(),C=(0,r.useMemo)((()=>(0,vn().mk)({searchSessionId:a,searchSessionFlowNumber:c})),[a,c]),T=(0,r.useCallback)((e=>(0,n(5374).g)({environment:b,result:e,searchSessionId:a,source:v,action:()=>m({shouldResetQuery:!1}),queryId:C,isSearch2:!0,desktopProps:{electronTabs:w,isNewElectronTabSearch:Boolean(_)},buttonStyles:{paddingInlineStart:4}})),[w,b,_,m,C,v,a]),A=(0,r.useMemo)((()=>y.map((e=>T(e)))),[T,y]),R=(0,d().K8)((()=>f.map((e=>g(e)))),[g,f],{debugName:"Search2.resultItems"}),E=(0,Wt().h)({resultsCount:f.length,shouldShow:"results"===h&&p,variant:"search-modal-minimal"}),P=(0,d().K8)((()=>n(639919).R.isUnifiedFindDown()),[]),F=(0,Ae().r)(),O=(0,fn().L)(),B=(0,n(528093)._)({name:"ai_usage",amount:1,spaceId:F,userId:b.currentUser.id}),D=(0,d().K8)((()=>(0,n(706021).e2)(B)),[B]),N=(0,d().K8)((()=>(0,j().E)(b).hasPublicAccessPermission),[b]),V=D||null==B?void 0:B.upsell,{handleClick:L}=(0,n(408543).C)({upsell:V,source:"ai_unified_find_search_modal",spaceStore:O}),z=(0,r.useCallback)((async e=>{var t;if(!D)return void(await L());const r=(0,hn().V)(null===(t=e.menuListItemAction)||void 0===t?void 0:t.event);m({shouldResetQuery:!1});const i={type:"search",searchSessionId:a,scopeForNextSearch:{type:"everything"},filtersForNextSearch:{ancestorsFilter:null==o?void 0:o.ancestors,createdByFilter:null==o?void 0:o.createdBy,teamspacesFilter:(0,I().fg)(null==o?void 0:o.inTeams),titleOnlyFilter:null==o?void 0:o.navigableBlockContentOnly}},{agentDeepFindEnabled:s,useReadOnlyMode:l}=(0,n(962753).mq)(b,F),c=s?(0,n(844317).getWorkflowAgentConfig)({useReadOnlyMode:l,searchSessionId:a}):i,d=s?["injectSearchTool"]:void 0;(0,n(36951).Iu)({environment:b,query:u,clientStore:n(166442).defaultClientAIChatStore,config:c,openInNewTab:"tab"===r||_,surface:"search_modal",initialAgentActions:d})}),[D,L,m,b,u,a,null==o?void 0:o.ancestors,null==o?void 0:o.createdBy,null==o?void 0:o.inTeams,null==o?void 0:o.navigableBlockContentOnly,_,F]),q=(0,d().K8)((()=>function(e){const{onClick:t,intl:n,query:r}=e;return{action:t,key:pr,render:e=>(0,Le.jsx)(hr,{menuListProps:e,title:n.formatMessage(gr.deepFindTitle),query:r})}}({onClick:e=>z({menuListItemAction:e}),intl:x,query:t})),[z,x,t]),{variant:U}=(0,n(921738).O)({query:t,searchSessionId:a}),K=(0,r.useRef)(null),W=(0,d().K8)((()=>({key:mr,action:async e=>{if(P||!K.current)return;if(!D)return void(await L());const t=(0,hn().V)(null==e?void 0:e.event);void 0===t&&m({shouldResetQuery:!1});const n=Boolean("tab"===t||_);K.current.navigateToThread({openInNewTab:n})},render:e=>(0,Le.jsx)(n(576907).bF,{query:t,searchFilters:o,searchResultsStore:void 0,searchSessionId:a,menuListItemProps:e,ref:K})})),[P,D,L,m,t,a,o,_]),G=function(e){const[t,n]=(0,r.useState)(!1),[o,i]=(0,r.useState)(e.experimentOverrides??{}),a=(0,d().K8)((()=>H()._.state.debug.enabled),[]);(0,r.useEffect)((()=>{a?i(e.experimentOverrides??{}):(i({}),n(!1))}),[a,e.experimentOverrides]);const l=(0,d().K8)((()=>a?(0,tr().WP)(Jn().hH).map((([e,t])=>{const n=[...t];return{experimentId:e,experimentVersion:1,group:s().default.getEligibleGroup({experimentId:e,defaultGroup:"control"}),groups:n.includes("control")?n:["control",...n]}})):[]),[a]),c=(0,r.useCallback)((()=>n(!0)),[]),u=(0,r.useCallback)((r=>a?(0,Le.jsx)(or,{...r,allPossibleExperiments:l,pendingOverrides:o,onExperimentChange:i,isPopupOpen:t,onClosePopup:()=>n(!1),onCommitOverrides:e.onCommitOverrides,debugInfo:e.debugInfo}):null),[a,l,o,t,e.onCommitOverrides,e.debugInfo]);return(0,r.useMemo)((()=>({key:rr,action:()=>{c()},render:u})),[c,u])}({experimentOverrides:null==S?void 0:S.experimentOverrides,debugInfo:null==S?void 0:S.debugInfo,onCommitOverrides:e=>{var t;null==S||null===(t=S.onExperimentOverridesChange)||void 0===t||t.call(S,e)}}),$=(0,d().O$)(xn().e),Y=(0,d().K8)((()=>{const e=[];if(!P&&$&&!N){if(k)return{items:[G],key:"search",render:e=>(0,Le.jsx)(Be().A,{...e})};if(!i)return"auto_streaming"===U?e.push(W):e.push(q),{items:e,key:"search",render:e=>(0,Le.jsx)(Be().A,{...e})}}}),[P,$,N,k,i,U,G,W,q]),Q=(0,r.useMemo)((()=>{const e=[...A,...R,...E];if(0!==e.length)return{items:e,key:"results",render:e=>(0,Le.jsx)(Be().A,{...e,title:x.formatMessage(gr.quickMatchesSectionTitle)})}}),[x,A,R,E]);return{entrypointsSection:Y,queryBasedResultsSection:Q}}function hr(e){const{menuListProps:t,title:n,query:o}=e,{focused:i}=t,a=(0,d().K8)((()=>"two_pane_1_snippet"===s().default.getEligibleGroup({experimentId:"search_highlight_client_variant",defaultGroup:"inline_2_snippets"})),[]),l=(0,p().IS)((()=>({container:{borderRadius:6,paddingInline:0,gap:12},titleContainer:{display:"flex",alignItems:"center",gap:4,color:Ne().Tj.text.primary,fontWeight:nr().Wy.medium,fontSize:14,...nr().RC},queryText:{display:"inline",alignItems:"baseline",...a&&{minWidth:200},...a&&{maxWidth:200},...nr().RC}})),[a]),c=(0,r.useMemo)((()=>{if(i)return(0,Le.jsx)($e().I,{icon:ur().arrowTurnDownLeftSmallIcon,size:"xs",colorVariant:"secondary"})}),[i]);return(0,Le.jsx)(Pt().A,{...t,title:(0,Le.jsxs)("div",{style:l.titleContainer,children:[n,(0,Le.jsx)(dr().O,{}),(0,Le.jsx)(In().D,{styleKey:"captionRegular",colorVariant:"tertiary",style:l.queryText,children:` — "${o}"`})]}),icon:(0,Le.jsx)($e().I,{icon:Je().magnifyingGlassIcon}),style:l.container,right:c,buttonStyle:Gn().CU})}const gr=(0,M().YK)({deepFindTitle:{id:"search2.deepFind.title",defaultMessage:"Search all sources with AI"},quickMatchesSectionTitle:{id:"search2.quickMatches.sectionTitle",defaultMessage:"Best matches"}});var vr=()=>n(295633),yr=()=>n(179034),Sr=()=>n(573255),br=()=>n(720128),xr=()=>n(298697),Ir=()=>n(187820),kr=()=>n(128295),Mr=()=>n(447587),_r=()=>n(358006),wr=()=>n(618425),Cr=()=>n(751380),Tr=()=>n(71304),Ar=()=>n(993273),Rr=()=>n(970236),Er=()=>n(536504);const jr=340,Pr=82,Fr=48,Or=420;function Br(){const e=(0,p().eP)();return(0,p().IS)((()=>({cardContainer:{display:"flex",flexDirection:"column",borderRadius:12,overflow:"hidden",boxShadow:Ne().Tj.shadow.outline.lg,position:"relative",width:jr,minHeight:Or,maxHeight:Or},coverSection:{position:"relative",height:Pr,width:jr,flexShrink:0,backgroundColor:"light"===e?"#FDFDFD":Ne().Tj.gray.background.primaryTranslucent},coverPlaceholder:{width:"100%",height:"100%",backgroundColor:"light"===e?"#FDFDFD":Ne().Tj.gray.background.primaryTranslucent},iconOverlay:{position:"absolute",bottom:-Fr/2,insetInlineStart:16,zIndex:2},contentSection:{padding:24,paddingTop:Fr/2+10,display:"flex",flexDirection:"column",flexGrow:1,overflow:"hidden"},bodyTextContainer:{paddingTop:12},breadcrumbText:{color:Ne().Tj.text.tertiary,fontSize:12},title:{fontSize:20,fontWeight:nr().Wy.semibold,color:Ne().Tj.text.primary},badge:{marginInlineStart:3},badgeCaption:{color:Ne().Tj.text.secondary,fontSize:10,fontWeight:500,lineHeight:"120%"}})),[e])}function Dr(e){const{coverVariant:t="default",coverStore:n,icon:r,breadcrumb:o,badge:i,title:s,description:a,footer:l}=e,c=function(e){const{coverVariant:t}=e,n=Br(),r=(0,p().eP)();return(0,p().IS)((()=>{const e="gray"===t,o="light"===r?"#F2F2F2":Ne().Tj.gray.background.primary;return{...n,coverSection:{...n.coverSection,...e&&{backgroundColor:o}},coverPlaceholder:{...n.coverPlaceholder,...e&&{backgroundColor:o}},contentSection:{...n.contentSection,gap:8},breadcrumbRow:{display:"flex",alignItems:"center",flexWrap:"wrap",gap:4},breadcrumbText:n.breadcrumbText,title:n.title,description:{fontSize:14,color:Ne().Tj.text.secondary,lineHeight:1.5},iconCircle:{width:Fr,height:Fr,borderRadius:"50%",backgroundColor:Ne().Tj.background.primary,border:`2px solid ${"light"===r?Ne().Tj.background.primary:Ne().Tj.background.elevated}`,display:"flex",alignItems:"center",justifyContent:"center"}}}),[n,t,r])}({coverVariant:t});return(0,Le.jsxs)("div",{style:c.cardContainer,children:[(0,Le.jsxs)("div",{style:c.coverSection,children:[n?(0,Le.jsx)(_r().z,{variant:"default",store:n,coverFormat:{type:"page_cover"},allowVideoPlayback:!1,coverSizeFormat:"large",coverHeight:Pr,showEmptyGalleryCover:!1,coverContentFadedOverlay:!1,onLoadProxiedImage:()=>{},renderAdditionalBlocks:!1}):(0,Le.jsx)("div",{style:c.coverPlaceholder}),(0,Le.jsx)("div",{style:c.iconOverlay,children:r})]}),(0,Le.jsxs)("div",{style:c.contentSection,children:[o||i?(0,Le.jsxs)("div",{style:c.breadcrumbRow,children:[o?(0,Le.jsx)("span",{style:c.breadcrumbText,children:o}):void 0,i]}):void 0,(0,Le.jsx)("div",{style:c.title,children:s}),a?(0,Le.jsx)("div",{style:c.bodyTextContainer,children:(0,Le.jsx)("div",{style:c.description,children:a})}):void 0,l]})]})}const Nr=294,Vr=271,Lr=117;function zr(){const e=(0,p().eP)();return(0,p().IS)((()=>({container:{paddingTop:16,display:"flex",flexDirection:"column",gap:8},shimmerRow:{height:10,backgroundColor:"light"===e?"#F6F6F6":Ne().Tj.palette.gray[500],borderRadius:9999}})),[e])}function qr(){const e=zr();return(0,Le.jsxs)("div",{style:e.container,children:[(0,Le.jsx)("div",{style:{...e.shimmerRow,width:Nr}}),(0,Le.jsx)("div",{style:{...e.shimmerRow,width:Vr}}),(0,Le.jsx)("div",{style:{...e.shimmerRow,width:Nr}}),(0,Le.jsx)("div",{style:{...e.shimmerRow,width:Vr}}),(0,Le.jsx)("div",{style:{...e.shimmerRow,width:Lr}})]})}function Ur(e){const{workflowData:t,store:n,creatorName:r}=e,o=(0,M().tz)(),i=t.name??"",s=t.description??"",l=t.icon??(0,Er().Oy)({baseUrl:a().A.domainBaseUrl||"",shape:Er().WJ,color:Er().i}),c=o.formatMessage(Kr.agentBadge),u=r?o.formatMessage(Kr.breadcrumb,{creatorName:r}):void 0,d=Br();return(0,Le.jsx)(Dr,{coverVariant:"gray",icon:(0,Le.jsx)(Ir().B6,{disabled:!0,icon:{pointer:n.pointer,icon:l},iconRecordCategory:"workflow",isEmptyPage:!1,size:Fr,largeIcon:!0}),breadcrumb:u,badge:(0,Le.jsx)(Rr().E,{style:d.badge,content:(0,Le.jsx)("div",{style:d.badgeCaption,children:c})}),title:i,description:s||void 0,footer:(0,Le.jsx)(qr,{})})}const Kr=(0,M().YK)({agentBadge:{id:"searchModal.agentCard.badge",defaultMessage:"Agent"},breadcrumb:{id:"searchModal.agentCard.breadcrumb",defaultMessage:"Created by {creatorName}"}});var Hr=()=>n(783793),Wr=()=>n(663929);function Gr(){return(0,Le.jsx)("div",{style:{display:"flex",paddingTop:2,paddingBottom:2},children:(0,Le.jsx)(Wr().hC,{connectors:["github","slack","gmail"],maxBubbles:3,iconSize:12})})}function $r(){const e=zr();return(0,Le.jsxs)("div",{style:e.container,children:[(0,Le.jsx)("div",{style:{...e.shimmerRow,width:Nr}}),(0,Le.jsx)("div",{style:{...e.shimmerRow,width:Vr}}),(0,Le.jsx)("div",{style:{...e.shimmerRow,width:Lr}})]})}function Yr(e){const t=(0,M().tz)(),n=t.formatMessage(Qr.breadcrumb),r=t.formatMessage(Qr.title),o=t.formatMessage(Qr.description);return(0,Le.jsx)(Dr,{icon:(0,Le.jsx)(Hr().x,{variant:"medium_large",shadowVariant:"none"}),breadcrumb:n,title:r,description:o,footer:(0,Le.jsxs)(Le.Fragment,{children:[(0,Le.jsx)(Gr,{}),(0,Le.jsx)($r,{})]})})}const Qr=(0,M().YK)({breadcrumb:{id:"searchModal.aiEntrypoint.breadcrumb",defaultMessage:"Ask Notion AI"},title:{id:"searchModal.aiEntrypoint.title",defaultMessage:"Search all sources via AI"},description:{id:"searchModal.aiEntrypoint.description",defaultMessage:"Ask Notion AI to search across all your connected sources to find the best answer"}});function Zr(e){const{store:t}=e,n=(0,M().tz)(),r=(0,l().v3)(),{personName:o,personEmail:i,personIcon:s,isEmptyPage:a,iconRecordCategory:c,hasCover:u}=(0,d().K8)((()=>{const e=t.getPersonProfileUserStore(),o=(null==e?void 0:e.getEmail())??"",i=(0,Tr().Qe)(t,n,r,!w().zD.isXMLAssistantEnabled()),s=t.getIcon(),a=(0,Ir().Te)(t);return{personName:i??"",personEmail:o,personIcon:s,isEmptyPage:t.isEmptyPage(),iconRecordCategory:a,hasCover:Boolean(t.getFormatStore().getKeyValue("page_cover"))}}),[t,n,r]),p=n.formatMessage(Xr.profileBadge),m=n.formatMessage(Xr.breadcrumb,{personName:o}),f=Br();return(0,Le.jsx)(Dr,{coverStore:u?t:void 0,icon:s?(0,Le.jsx)(Ir().B6,{disabled:!0,icon:s,iconRecordCategory:c,isEmptyPage:a,size:Fr,largeIcon:!0}):void 0,breadcrumb:m,badge:(0,Le.jsx)(Rr().E,{style:f.badge,content:(0,Le.jsx)("div",{style:f.badgeCaption,children:p})}),title:o,description:i||void 0,footer:(0,Le.jsx)(qr,{})})}const Xr=(0,M().YK)({profileBadge:{id:"searchModal.peopleCard.badge",defaultMessage:"Profile"},breadcrumb:{id:"searchModal.peopleCard.breadcrumb",defaultMessage:"People / {personName}"}});function Jr(e){const{action:t}=e,n=(0,M().tz)(),{title:r,caption:o,icon:i}=t.value,s=n.formatMessage(eo.settingsBadge),a=n.formatMessage(eo.breadcrumb,{settingName:r}),l=Br(),c=(0,p().IS)((()=>({icon:{height:24,width:24,fill:Ne().Tj.icon.secondary}})),[]),u=function(){const e=(0,p().eP)();return(0,p().IS)((()=>({iconCircle:{width:Fr,height:Fr,borderRadius:"50%",backgroundColor:Ne().Tj.background.primary,border:`2px solid ${"light"===e?Ne().Tj.background.primary:Ne().Tj.background.elevated}`,display:"flex",alignItems:"center",justifyContent:"center"}})),[e])}();return(0,Le.jsx)(Dr,{icon:(0,Le.jsx)("div",{style:u.iconCircle,children:i(c.icon)}),breadcrumb:a,badge:(0,Le.jsx)(Rr().E,{style:l.badge,content:(0,Le.jsx)("div",{style:l.badgeCaption,children:s})}),title:r,description:o,footer:(0,Le.jsx)(qr,{})})}const eo=(0,M().YK)({settingsBadge:{id:"searchModal.settingsCard.badge",defaultMessage:"Settings"},breadcrumb:{id:"searchModal.settingsCard.breadcrumb",defaultMessage:"Settings / {settingName}"}});function to(e){if("entrypoint"===e.variant)return(0,Le.jsx)(Yr,{entrypointKey:e.entrypointKey});if("action"===e.variant)return(0,Le.jsx)(Jr,{action:e.action});const{result:t}=e;var n;return t.workflowData?(0,Le.jsx)(Ur,{workflowData:t.workflowData,store:t.store,creatorName:null===(n=t.highlight)||void 0===n?void 0:n.pathText}):(0,Le.jsx)(no,{result:t,onSelectResult:e.onSelectResult})}function no(e){const{result:t,onSelectResult:n}=e;return(0,d().K8)((()=>t.store.isPersonProfile()),[t.store])?(0,Le.jsx)(Zr,{store:t.store}):(0,Le.jsx)(ro,{result:t,onSelectResult:n})}function ro(e){var t,n,o;const{result:i,onSelectResult:s}=e,a=(0,M().tz)(),c=(0,l().v3)(),u=(0,d().K8)((()=>i.store),[i.store]),m=((null===(t=i.highlights)||void 0===t?void 0:t.textHighlights)??[]).slice(1),f=m.length>0;(0,r.useEffect)((()=>{f||(u.load(),async function(e){const t=e.getContentIds().slice(0,10);if(0===t.length)return;const n=t.map((t=>vr().B.createChildStore(e,{table:yr().ev,id:t})));await Jt().lX(n,10,(e=>e.load()))}(u))}),[u,f]);const h=(0,d().K8)((()=>{if(f)return!0;return(0,Sr().O)({rootStore:u,renderAdditionalBlocks:!0,tableRenderMode:"image"}).isDefined}),[u,f]),{previewIcon:g,isEmptyPage:v,hasCover:y}=(0,d().K8)((()=>({previewIcon:u.getIcon(),isEmptyPage:u.isEmptyPage(),hasCover:Boolean(u.getFormatStore().getKeyValue("page_cover"))})),[u]),S=(0,d().K8)((()=>(0,Ir().Te)(u)),[u]),b=(0,d().K8)((()=>{const e=(0,Tr().Qe)(u,a,c,!w().zD.isXMLAssistantEnabled());return e&&e.trim().length>0?e:void 0}),[u,a,c]),x=a.formatMessage({id:"search.preview.untitledPage",defaultMessage:"Untitled"}),I=function(){const e=Br(),t=(0,p().eP)();return(0,p().IS)((()=>({...e,contentSection:{...e.contentSection,gap:8},breadcrumbRow:{display:"flex",alignItems:"center",flexWrap:"wrap",gap:4},pathText:e.breadcrumbText,pathHighlight:{color:Ne().Tj.blue.text.accentPrimary},title:{...e.title,cursor:"pointer"},untitledPageColor:{color:Ne().Tj.text.tertiary},highlightItem:{fontSize:11,lineHeight:1.4,color:Ne().Tj.text.secondary,cursor:"pointer",marginBottom:8},highlight:{color:Ne().Tj.blue.text.accentPrimary,fontWeight:nr().Wy.semibold},pageContentPreview:{cursor:"pointer",overflow:"hidden",flexGrow:1},contentWrap:{height:"auto",overflow:"visible"},loadingShimmer:{backgroundColor:"light"===t?Ne().Tj.background.primary:Ne().Tj.gray.background.primaryTranslucent},emptyGalleryCover:{display:"flex",flexDirection:"column",gap:8,padding:0,backgroundColor:"light"===t?Ne().Tj.background.primary:Ne().Tj.gray.background.primaryTranslucent},rendererBlockStyle:{fontSize:11,lineHeight:1.4,color:Ne().Tj.text.secondary},fadeOutOverlay:{position:"absolute",bottom:0,insetInlineStart:0,insetInlineEnd:0,height:80,pointerEvents:"none"}})),[e,t])}(),k=(0,Cr().PO)({words:(0,Cr().oQ)(null===(n=i.highlight)||void 0===n?void 0:n.pathText),highlightText:null===(o=i.highlight)||void 0===o?void 0:o.pathText,styleOverride:I.pathHighlight}),_=i.badges??[],C=new Set(_.map((e=>e.type)));return(0,Le.jsxs)("div",{style:I.cardContainer,children:[(0,Le.jsxs)("div",{style:I.coverSection,children:[y?(0,Le.jsx)(_r().z,{variant:"default",store:u,coverFormat:{type:"page_cover"},allowVideoPlayback:!1,coverSizeFormat:"large",coverHeight:Pr,showEmptyGalleryCover:!1,coverContentFadedOverlay:!1,onLoadProxiedImage:()=>{},renderAdditionalBlocks:!1}):(0,Le.jsx)("div",{style:I.coverPlaceholder}),g?(0,Le.jsx)("div",{style:I.iconOverlay,children:(0,Le.jsx)(Ir().B6,{disabled:!0,icon:g,iconRecordCategory:S,isEmptyPage:v,size:Fr,largeIcon:!0})}):void 0]}),(0,Le.jsxs)("div",{style:I.contentSection,children:[(0,Le.jsxs)("div",{style:I.breadcrumbRow,children:[(0,Le.jsx)("span",{style:I.pathText,children:(0,Le.jsx)(kr().Ay,{store:u,showFullPathInTooltip:!0,highlighter:k})}),C.has("is_collection")?(0,Le.jsx)(Ar().se,{}):void 0,C.has("is_template")?(0,Le.jsx)(Ar().rx,{}):void 0,C.has("popular_this_week")?(0,Le.jsx)(Ar().oj,{}):void 0,C.has("most_viewed")?(0,Le.jsx)(Ar().iY,{}):void 0,C.has("agent")?(0,Le.jsx)(Ar().Kg,{}):void 0]}),(0,Le.jsx)("div",{role:"button",tabIndex:0,style:{...I.title,...!b&&I.untitledPageColor},onClick:e=>{s({result:i,event:e})},onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),s({result:i,event:e}))},children:b??x}),f?(0,Le.jsx)(Mr().A,{maxLines:15,style:{gap:8},children:m.map(((e,t)=>{const n=(0,Cr().Ay)(e.highlightedText),r=(0,Cr().fc)(e.highlightedText),o=(0,Cr().n3)(e.highlightedText);return(0,Le.jsxs)("div",{role:"button",tabIndex:0,style:I.highlightItem,onClick:e=>{s({result:i,event:e})},onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),s({result:i,event:e}))},children:[r?(0,Le.jsx)("span",{children:"..."}):void 0,(0,Le.jsx)(br().A,{text:e.highlightedText,highlighter:{tokenize:()=>(0,Cr().nB)(n),style:I.highlight}}),o?(0,Le.jsx)("span",{children:"..."}):void 0]},t)}))}):(0,Le.jsx)("div",{role:"button",tabIndex:0,style:I.pageContentPreview,onClick:e=>{s({result:i,event:e})},onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),s({result:i,event:e}))},children:h?(0,Le.jsx)(wr().wJ,{surfaceName:"search_result_preview",children:(0,Le.jsx)(_r().z,{variant:"default",store:u,coverFormat:{type:"page_content"},allowVideoPlayback:!1,coverContentFadedOverlay:!1,contentWrapStyle:I.contentWrap,showLoadingShimmer:!1,showEmptyGalleryCover:!0,emptyGalleryCoverStyle:I.emptyGalleryCover,onLoadProxiedImage:()=>{},rendererBlockStyle:I.rendererBlockStyle,renderAdditionalBlocks:!0})}):(0,Le.jsx)("div",{style:I.loadingShimmer,children:(0,Le.jsx)(xr().A,{paragraphs:[{lineHeight:11,lineMargin:6,sectionWidths:[100,100,80],repeat:3,sectionMargin:0}]})})})]}),(0,Le.jsx)("div",{style:I.fadeOutOverlay})]})}function oo(e){const{result:t,cardTopPadding:n}=e,r=(0,p().IS)((()=>({panel:{width:406,height:"100%",overflow:"hidden",display:"flex",flexDirection:"column",flexShrink:0,zIndex:1},cardContainer:{position:"relative",display:"flex",flexDirection:"column",paddingInlineStart:24,paddingInlineEnd:40,paddingTop:n}})),[n]);let o;return o="special"===t.type?(0,Le.jsx)(to,{variant:"entrypoint",entrypointKey:t.key}):"action"===t.type?(0,Le.jsx)(to,{variant:"action",action:t.action}):(0,Le.jsx)(to,{variant:"result",result:t.result,onSelectResult:e.onSelectResult}),(0,Le.jsx)("aside",{style:r.panel,children:(0,Le.jsx)("div",{style:r.cardContainer,children:o})})}var io=()=>n(496067),so=()=>n(718807);function ao(e){const{query:t,hasResults:o,isLoading:i,onDismiss:s}=e,a=(0,r.useCallback)((()=>{s({shouldResetQuery:!1}),io().A.setState({...io().A.state,open:!0}),so().Ay.setState({...so().Ay.state,filter:t})}),[s,t]),l=(0,I().N2)(e.filters);if((0,E().E)({query:t,filters:l})&&!o&&!i)return(0,Le.jsx)(n(770979).A,{error:I().yq.NoResults,handleSearchDeletedOnly:a})}const lo=r.forwardRef((function(e,t){const{onDismiss:o,currentView:i,isResultsLoading:c,searchUserPreferences:u,query:m,searchSessionId:f,searchSessionFlowNumber:h,results:g,filters:v,setCurrentView:y,debugConfig:S,searchActionResults:b,isShowingHighlightPane:x,disableSidePeek:I,searchAnalytics:k}=e,M=u.settings.hideAiTopResultEnabled,[_,w]=(0,r.useState)(ne().ZK),[C,T]=(0,r.useState)(!1),[A,R]=(0,r.useState)(!1),j=(0,l().v3)(),P=(0,fn().L)(),F=(0,E().E)({query:m,filters:v}),O=(0,d().K8)((()=>H()._.state.isNewElectronTab),[],{debugName:"Search2.isNewElectronTab"}),B=(0,yn().o)(),D=j.device.isElectron,N=(0,d().K8)((()=>(0,K().q)(j)&&D),[j,D]),V=(0,r.useCallback)((e=>{o(e),R(!1),T(!1),w(ne().ZK)}),[o]),L=(0,vn().mk)({searchSessionId:f,searchSessionFlowNumber:h}),z=(0,d().K8)((()=>H()._.state.openedTimeMs),[],{debugName:"SearchResults.openedTimeMs"}),q=(0,r.useCallback)((e=>{const t=Date.now(),n=k.getResultRenderTime(e.result.id),r=te().default.state,o=r.firstKeyStrokeTimeMs,i=z?t-z:void 0;k.trackSelectSearchItem({...e,searchSessionMetrics:{numKeystrokes:r.numKeystrokes,hadMetaClick:r.hadMetaClick,timeToSelectMs:i,timeFromFirstKeyStrokeToSelectMs:o?t-o:i,timeToRenderResult:n}})}),[k,z]),U=(0,r.useCallback)((({result:e,event:t})=>{if(!function(e){if(!("button"in e))return!0;const t=1===e.button,n=0===e.button,r="auxclick"===e.type;if(t||n&&r)return!1;return!0}(t))return;(0,hn().V)(t)&&te().default.update((e=>({...e,hadMetaClick:!0})));const n="results"===i?"query_results":"recent_pages";Sn().executeSearchResultNavigation({event:t,result:e,context:n,queryId:L,trackSelectSearchItem:q,closeSearch:V,isCommandSearch:N,environment:j,electronTabs:B,isNewElectronTab:O,source:gn().y8["results"===i?"SearchQuery":"SearchRecents"]})}),[q,V,i,B,j,N,O,L]),W=(0,d().K8)((()=>"two_pane_1_snippet"===s().default.getEligibleGroup({experimentId:"search_highlight_client_variant",defaultGroup:"inline_2_snippets"})),[]),G=(F||"recents"===i)&&W&&x&&!I,$=(0,r.useCallback)((e=>{const t=null!=S&&S.debugInfo?S.debugInfo.response.resultsDebugMap[e.id]:void 0;return{action:({event:t})=>U({result:e,event:t}),key:(0,n(873049).a)(e),render:n=>(0,Le.jsx)(Gn().Kr,{...n,currentView:i,result:e,queryId:L,analytics:{endTimeToRenderServerResultsTiming:k.endTimeToRenderServerResultsTiming,setResultRenderTime:k.setResultRenderTime},debugHits:t})}}),[U,i,L,k,S]),{sections:Y,recentResults:Q}=Yn({numberOfRecentPagesToShow:_,buildMenuListItem:$,trackSelectSearchItem:q,closeSearch:V,queryId:L}),{entrypointsSection:Z,queryBasedResultsSection:X}=fr({query:m,filters:v,hideAiTopResultEnabled:M,searchSessionId:f,searchSessionFlowNumber:h,queryTextValueWithoutSearchFilters:e.queryTextValueWithoutSearchFilters,isResultsLoading:c,onDismiss:o,results:g,currentView:i,buildMenuListItem:$,source:"quick_find",searchActionResults:b,debugConfig:S}),J=(0,r.useMemo)((()=>{const e=[];return Z&&e.push(Z),X&&e.push(X),e}),[Z,X]),ee=(0,r.useCallback)(((t,n)=>{var r,o;"results"===i&&!c&&t<200?null===(r=e.fetchAdditionalServerResultsOnChange)||void 0===r||r.call(e,ne().ZK):"recents"===i&&P&&(0,bn().fQ)({environment:j,offsetFromBottom:t,spaceStore:P,setIsLoadingRecents:T,setEndOfRecentsReached:R,numRecents:_,setNumRecents:w,endOfRecentsReached:A,isLoadingRecents:C,incrementBy:ne().ZK});n.offsetFromTop>0&&"results"===i&&(null===(o=e.onScrollInResultsView)||void 0===o||o.call(e))}),[e,i,A,j,P,C,c,_]),re=(0,r.useMemo)((()=>new(Ct().$)),[]),oe=(0,r.useCallback)((()=>{re.setState({focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})}),[re]),ie=(null==Z?void 0:Z.items.length)??0,se=(0,r.useCallback)((()=>{const e=0===ie?0:1,t=ie;re.setState({focus:{section:e,indexGlobal:t,indexLocal:0,footerFocused:!1}})}),[ie,re]),ae=(0,d().K8)((()=>{const e=re.state.focus;return F&&((null==e?void 0:e.indexGlobal)??0)>ie+((null==X?void 0:X.items.length)??0)}),[re,F,ie,null==X?void 0:X.items.length]),le=F&&0===(null==X?void 0:X.items.length)&&"results"===i&&!c,ce=ao({query:m,filters:v,hasResults:((null==X?void 0:X.items.length)??0)>0,isLoading:c,onDismiss:V}),{isNaturalLanguageQueryWithCredits:ue}=(0,n(957046).T)({query:m,searchSessionId:f}),de=(0,r.useMemo)((()=>{const e=0===(null==X?void 0:X.items.length);return"recents"===i||e?0:ie>0?ue?0:ie:0}),[null==X?void 0:X.items.length,i,ie,ue]);(0,r.useEffect)((()=>{F||"results"!==i?F&&"recents"===i&&(y("results"),se()):(y("recents"),oe()),ae?se():le&&oe()}),[oe,se,le,ae,i,F,y]);const pe=(0,p().IS)((()=>({container:{display:"flex",height:"100%",width:"100%",overflow:"hidden"},scroller:{width:"100%",position:"relative",display:"flex",flexDirection:"column"},menuList:{display:"flex",flexDirection:"column",gap:a().A.isMobile?10:void 0,paddingInline:W?10:4}})),[W]),me=(0,d().K8)((()=>{const e=re.state.focus;if(!e||e.footerFocused||void 0===e.indexGlobal)return{type:"none"};if("recents"===i&&W){const t=Y[0],n=(null==t?void 0:t.key)===$n,r=n?t.items.length:0;if(n&&e.indexGlobal<r)return{type:"special",key:$n};const o=e.indexGlobal-r,i=Q[o];return i?{type:"page",result:i}:{type:"none"}}if("recents"===i)return{type:"none"};const t=(null==Z?void 0:Z.items.length)??0;if(e.indexGlobal<t){const t=e.indexGlobal,n=null==Z?void 0:Z.items[t];if(!n)return{type:"none"};const r=n.key;return function(e){return e===pr||e===mr||e===rr||e===$n}(r)?{type:"special",key:r}:{type:"none"}}const n=e.indexGlobal-t,r=b.length;if(n<r){const e=b[n];return e?{type:"action",action:e}:{type:"none"}}const o=g[n-r];return o?{type:"page",result:o}:{type:"none"}}),[re,g,Q,Y,Z,i,W,b]),fe=(0,r.useMemo)((()=>function(e){const{currentView:t,sections:n}=e;if(0===n.length)return Xn;const r=n[0],o=null==r?void 0:r.key;return"recents"===t?o===$n?45:Xn:"search"===o?77.898:Xn}({currentView:i,sections:"recents"===i?Y:J})),[i,Y,J]);return(0,Le.jsxs)("div",{style:pe.container,children:[(0,Le.jsxs)(At().H,{ref:t,type:It().A.Y,style:pe.scroller,children:[(0,Le.jsx)(Oe().A,{comboboxProps:e.menuListComboboxProps,type:Oe().O.Vertical,initialFocus:de,sections:"recents"===i?Y:J,disableKeyboardArrowWrap:!0,store:re,style:pe.menuList}),ce||(le?ce:null),(0,Le.jsx)(n(498521).A,{onChange:ee})]}),G&&"none"!==me.type?(0,Le.jsx)(oo,{result:me,onSelectResult:U,cardTopPadding:fe}):null]})}));var co=()=>n(591779);function uo(){const e=(0,o().T)(),t=(0,Ae().r)(),n=(0,d().K8)((()=>H()._.state.isOpen),[]),[i,s]=(0,r.useState)((()=>Ie(e))),a=(0,r.useCallback)((e=>{s((t=>({...t,...e})))}),[]),l=(0,d().K8)((()=>H()._.state.filters),[],{useDeepEqual:!0}),c=(0,d().K8)((()=>H()._.state.sort),[]),u=(0,co().ZC)(e),p=(0,co().ZC)(t),m=(0,co().ZC)(n),f=n&&!m,h=void 0!==e&&e!==u,g=void 0!==t&&t!==p,v=(0,r.useMemo)((()=>({settings:i,setUserSettings:a,storeFilters:l,storeSort:c})),[i,a,l,c]);(0,r.useEffect)((()=>{e&&(h||g)&&s(Ie(e))}),[e,h,g]);const y=n&&i.stickyFiltersEnabled&&Boolean(e&&t)&&(f||g||h);(0,r.useEffect)((()=>{if(!y)return;if(!e||!t)return;const{filters:n,sort:r}={filters:_e(o={userId:e,spaceId:t}),sort:we(o)};var o;const i=(0,I().N2)(l),s=(0,I().N2)(n),a=c??ge,u=r??ge,d=!(0,Ft().n4)(i,s),p=!(0,Ft().n4)(a,u);(d||p)&&H()._.update((e=>({...e,filters:d?n:l,sort:p?r:c})))}),[y,e,t,l,c]);const S=(0,r.useCallback)((n=>{const r=(0,I().vm)((0,I().N2)(l),n);H()._.updateFilters(n),i.stickyFiltersEnabled&&e&&t&&Ce({userId:e,spaceId:t,filters:r,sort:c})}),[l,c,i.stickyFiltersEnabled,e,t]),b=(0,r.useCallback)((n=>{H()._.updateSort(n),i.stickyFiltersEnabled&&e&&t&&Ce({userId:e,spaceId:t,filters:l,sort:n})}),[l,i.stickyFiltersEnabled,e,t]);return(0,r.useMemo)((()=>({searchUserPreferences:v,handleFiltersChange:S,handleSortChange:b})),[v,S,b])}function po(){return(0,d().K8)((()=>w().zD.isSearchModalV2Enabled()),[])?(0,Le.jsx)(mo,{}):null}function mo(){const e=(0,l().v3)(),t=(0,l().Y0)(),n=(0,M().tz)(),w=(0,o().T)(),[O,B]=(0,r.useState)("recents"),[D,N]=(0,r.useState)(!0),[V,L]=(0,r.useState)(!0),[z,q]=(0,r.useState)([]),U=(0,r.useRef)(!1),ae=(0,r.useRef)(null),[ue,de]=(0,y().$)(),pe=(0,d().O$)(H()._),{searchUserPreferences:me,handleFiltersChange:fe,handleSortChange:he}=uo(),{storeFilters:ve,storeSort:ye}=me,Se=(0,d().O$)(i().AppStoreSidebarSpaceStore),{overriddenPublicShareLinkSpaceStore:be}=(0,Z().W)(),xe=Se??be,Ie=(0,A().AI)({initialValue:[]}),ke=(0,d().K8)((()=>xe),[xe]),Me=(0,r.useRef)(),_e=(0,d().K8)((()=>(0,K().q)(e)),[e],{debugName:"Search2.isInQuickSearchMode"}),we=(0,r.useCallback)((()=>{Ie.setValue([]),H()._.closeAndResetMetricsState(),te().default.reset()}),[Ie]);(0,r.useEffect)((()=>{pe.isOpen&&(clearTimeout(Me.current),U.current=!1)}),[pe.isOpen]),(0,u().X)((()=>{Me.current&&(clearTimeout(Me.current),Me.current=void 0)}));const Ce=pe.mode,Te=(0,d().K8)((()=>ee().E.state.searchExperimentOverrides),[]),Ae=(0,d().K8)((()=>ee().nS.state.searchExperimentOverrides),[]),Re=(0,d().K8)((()=>"everything"===ee().Ay.state.debug||ee().Ay.state.showDebugInfo),[]),Ee=(0,d().K8)((()=>ee().nS.state.visible&&"results"===O),[O]),je=(0,d().K8)((()=>(0,oe().bJ)({device:t,isPublicAccessPermissionForPage:(0,j().E)(e).hasPublicAccessPermission})),[t,e]),Pe=(0,r.useCallback)(((e,t)=>{("main"===e?ee().E:ee().nS).update((e=>({...e,searchExperimentOverrides:t})))}),[]);(0,c().w)((()=>{H()._.update((e=>({...e,query:Ie}))),Y().T.customAgentSearchService.load().then((({initializeWorkflowDataCache:t})=>t(e)))})),(0,r.useEffect)((()=>{pe.isOpen&&(0,J().x)({environment:e,store:Ie.store,canSelectAllBlocks:!1})}),[pe.isOpen,e,Ie.store]);const Fe=(0,m().lW)().width>=1006,Oe=V&&Fe,{query:Be,queryTextValue:De,queryTextValueWithoutSearchFilters:Ne}=(0,d().K8)((()=>{const t=Ie.store.getValue()??[],r=t.filter((e=>!(0,k().uPN)(e).some(k().RXL)));return{queryTextValue:t,query:(0,x().r4)({intl:n,textValue:r,userTimeZone:(0,S().P)(),deterministic:!1,disableAnnotationPrefix:!0,disableInsertedAnnotations:!1,getRecordModel:b().b.fromGetRecordValueFn(e.defaultRecordCache.inMemoryRecordCache.makeGetRecordValueFn(w))}),queryTextValueWithoutSearchFilters:r}}),[Ie.store,n,e.defaultRecordCache.inMemoryRecordCache,w]),Ve=(0,r.useCallback)((t=>{const n=t.query.trim();if(0===n.length)return void q((e=>0===e.length?e:[]));const r=(0,G().wn)({query:n,environment:e,searchMode:"nav-local-only"})??[];q(r)}),[e]),qe=xt(),Ue=(0,r.useMemo)((()=>qe?(0,k().lfB)({textValue:De,annotationGroupingKey:k().Ifu.TemporarySearchFilter}):[]),[qe,De]),Ke=(0,F().Q)(),{filters:He,sort:We}=(0,r.useMemo)((()=>{const e=qe?(0,I().N2)(function(e){const t=e.filter(k().RXL);if(0===t.length)return;const n=I().N2();n.inTeams=[];for(const r of t){const[e,t]=r;if((0,k().cgd)(t)){n.navigableBlockContentOnly=!0;continue}const[o,i]=t;switch(o){case"p":n.ancestors.push(i);break;case"t":n.inTeams.push(i);break;case"u":case"r":n.createdBy.push(i);break;case"sfct":{const e=i;n.createdTime=P(e);break}case"sflet":{const e=i;n.lastEditedTime=P(e);break}}}return n}(Ue)):(0,I().N2)(ve??{});void 0===e.contentStatusFilter&&Ke&&(e.contentStatusFilter=Q().T);return{filters:e,sort:(qe?function(e){const t=e.filter(k().RXL);for(const n of t){const[e,t]=n;if((0,k().qUh)(t))switch(t[1]){case"led":return{field:"lastEdited",direction:"desc"};case"lea":return{field:"lastEdited",direction:"asc"};case"ctd":return{field:"created",direction:"desc"};case"cta":return{field:"created",direction:"asc"}}}return{field:"relevance"}}(Ue)??ye:ye)??ge}}),[qe,Ue,ve,ye,Ke]),{mainPaneOverrides:Ge,secondaryPaneOverrides:$e}=(0,r.useMemo)((()=>({mainPaneOverrides:Te,secondaryPaneOverrides:Ae})),[Te,Ae]),Ye=(0,E().E)({query:Be,filters:He}),{results:Qe,searchSessionId:Ze,searchSessionFlowNumber:Xe,isResultsLoading:Je,searchAnalytics:et,fetchAdditionalServerResultsOnChange:tt,debugInfo:nt}=(0,$().W)({type:I().Vz.BlocksInSpace,query:Be,limit:ne().ZK,source:"quick_find",filters:He,sort:We,options:{disable:!Ye,isTitleOnly:void 0,overrideSearchSessionId:pe.sessionId,overrideSpaceStore:xe,searchExperimentOverrides:Object.keys(Ge).length>0?Ge:void 0,debug:Re?"explain":void 0,onLocalSearchBegin:Ve},peopleBlocksToInclude:"all"}),rt=(0,r.useCallback)((t=>{var n;if("agent"===Ce&&t.isEscapeKey)return void H()._.switchToSearchPane();!function(e){const{environment:t,sessionId:n,openedTimeMs:r,isOpen:o,results:i,scrollerRef:s,hasScrolled:l,searchSessionFlowNumber:c}=e,{selectedQueryResult:u,numKeystrokes:d,hadMetaClick:p,firstKeyStrokeTimeMs:m}=te().default.state;if(d>0&&c>0&&!u&&!p&&n&&r&&o){const e=Date.now(),o=e-r,u=i.length>0?i[0].serverEventProperties:void 0;le().mG(t,{...u,timeToAbandonMs:o,timeFromFirstKeyStrokeToAbandonMs:m?e-m:void 0,numKeystrokes:d,numResultsAboveFold:ce(s),searchSessionId:n,searchSessionFlowNumber:c,hasScrolled:l,numLocalResults:i.filter((e=>e.sources.includes(I().Ni.Local))).length,numTotalLocalResults:i.filter((e=>e.sources.includes(I().Ni.Local))).length,isMobile:a().A.isMobile})}}({environment:e,sessionId:pe.sessionId,openedTimeMs:pe.openedTimeMs,isOpen:pe.isOpen,results:Qe,scrollerRef:ae,searchSessionFlowNumber:Xe,hasScrolled:U.current});const r=null===(n=H()._.state.previousTextSelection)||void 0===n?void 0:n.multiSelection;t.shouldResetQuery&&Ie.setValue([]),H()._.update((e=>({...e,isOpen:!1,isNewElectronTab:!1,openedTimeMs:void 0,sessionId:void 0,previousTextSelection:void 0}))),te().default.reset(),_e&&(0,T().y)(),a().A.isMobile&&X().close(),Me.current&&clearTimeout(Me.current),Me.current=window.setTimeout(we,re().INACTIVE_TIMEOUT_MS),r&&"editing"!==h().default.state.mode&&h().default.setState({forceExtendAnnotations:{},mode:"editing",multiSelection:r})}),[Ce,pe.openedTimeMs,pe.sessionId,pe.isOpen,e,Ie,we,_e,Qe,ae,Xe]);W({environment:e,closeSearch2:rt});const{results:ot,searchSessionId:it,searchSessionFlowNumber:st,isResultsLoading:at,searchAnalytics:lt,fetchAdditionalServerResultsOnChange:ct,debugInfo:ut}=(0,$().W)({type:I().Vz.BlocksInSpace,query:Be,limit:ne().ZK,source:"quick_find",filters:He,sort:We,options:{disable:!Ee,isTitleOnly:!1,overrideSearchSessionId:pe.sessionId,overrideSpaceStore:xe,searchExperimentOverrides:Object.keys($e).length>0?$e:void 0,debug:Ee?"explain":void 0},peopleBlocksToInclude:"all"}),dt=function(e){const{currentView:t,shouldShowSecondaryDebugPane:n,isCommandSearchMode:r,shouldShowDebugSidebar:o,isShowingHighlightPane:i}=e,c=(0,l().v3)(),u=(0,d().K8)((()=>"two_pane_1_snippet"===s().default.getEligibleGroup({experimentId:"search_highlight_client_variant",defaultGroup:"inline_2_snippets"})),[]),m=(()=>{if(!a().A.isMobile)return u&&!r?n?1200:i?1006:600:n?1e3:755})(),f=o&&"number"==typeof m?m+380:m,h=(0,d().K8)((()=>{if(a().A.isMobile)return"100%";return(0,oe().CX)({searchContentPaneType:"recents"===t?"default_body":"search_results",quickSearchMode:r,environment:c}).maxHeight}),[t,c,r]),g=(0,p().IS)((()=>({wrapper:{display:"flex",flexDirection:a().A.isMobile?"column":"row",justifyContent:"flex-start",width:a().A.isMobile?void 0:f,height:h},container:{display:"grid",flexDirection:"column",gridTemplateColumns:"100%",gridTemplateRows:"auto auto minmax(0, 1fr) auto",width:o?m:"100%",height:"100%"}})),[f,h,o,m]);return g}({currentView:O,shouldShowSecondaryDebugPane:Ee,isShowingHighlightPane:Oe,isCommandSearchMode:_e,shouldShowDebugSidebar:je}),pt=(0,r.useMemo)((()=>({query:{text:Be,filters:He,sort:We??{field:"relevance"}},limit:ne().ZK})),[Be,He,We]),mt=_e?C().wy.commandSearch:a().A.isMobile?C().wy.mobileSearch:C().wy.searchPane,ft=(0,r.useMemo)((()=>(0,Le.jsx)(C().hP,{surface:mt,children:(0,Le.jsxs)("div",{style:dt.wrapper,children:[(0,Le.jsx)("div",{style:dt.container,"data-search-2-container":!0,className:"search-2-snapshot-container",children:"search"===Ce?(0,Le.jsxs)(Le.Fragment,{children:[(0,Le.jsx)(un,{inputComboboxProps:ue,queryText:Ie,hasFilters:(0,R().D)(He),isShowingFilterBar:D,setIsShowingFilterBar:N,scrollerRef:ae,isShowingHighlightPane:V,setIsShowingHighlightPane:L,onClose:()=>rt({shouldResetQuery:!1})}),(0,Le.jsx)("div",{children:!a().A.isMobile&&ke&&!qe&&D?(0,Le.jsx)(se().S,{filters:He,onFiltersChange:fe,sort:We,onSortChange:he,parentStore:ke}):void 0}),(0,Le.jsxs)(v().fI,{gap:12,height:"100%",children:[(0,Le.jsx)(lo,{ref:ae,currentView:O,isResultsLoading:Je,searchUserPreferences:me,fetchAdditionalServerResultsOnChange:tt,onDismiss:rt,searchAnalytics:et,results:Qe,searchActionResults:z,query:Be,searchSessionId:Ze,searchSessionFlowNumber:Xe,menuListComboboxProps:de,queryTextValueWithoutSearchFilters:Ne,filters:He,setCurrentView:B,debugConfig:{experimentOverrides:Ge,onExperimentOverridesChange:e=>Pe("main",e),debugInfo:nt},isShowingHighlightPane:Oe,disableSidePeek:Ee,onScrollInResultsView:()=>{U.current||(U.current=!0)}}),Ee?(0,Le.jsx)(lo,{ref:ae,currentView:O,isResultsLoading:at,searchUserPreferences:me,fetchAdditionalServerResultsOnChange:ct,onDismiss:rt,searchAnalytics:lt,results:ot,query:Be,searchSessionId:it,searchSessionFlowNumber:st,menuListComboboxProps:void 0,queryTextValueWithoutSearchFilters:Ne,filters:He,setCurrentView:B,searchActionResults:z,debugConfig:{experimentOverrides:$e,onExperimentOverridesChange:e=>Pe("secondary",e),debugInfo:ut},isShowingHighlightPane:Oe,disableSidePeek:!0}):void 0]}),a().A.isMobile?void 0:(0,Le.jsx)(ze,{results:Qe,debugInfo:nt,reportBadSearchInputRequest:pt,isResultsView:"results"===O,searchUserPreferences:me})]}):(0,Le.jsx)(_().Yk,{quickSearchMode:_e,searchContentPaneType:"recents"===O?"default_body":"search_results",onClose:()=>rt({shouldResetQuery:!1,isEscapeKey:!0})})}),je?(0,Le.jsx)(ie().s,{}):void 0]})})),[mt,dt,Ce,ue,Ie,me,D,V,Oe,ke,qe,He,fe,We,he,O,Je,tt,rt,et,Qe,z,Be,Ze,Xe,de,Ne,Ge,nt,Ee,at,ct,lt,ot,it,st,$e,ut,pt,_e,Pe,je]);return a().A.isMobile?(0,Le.jsx)(g().zD,{popupType:g().nl.BottomSheet,open:pe.isOpen,render:()=>ft,style:{width:"100vw"},bottomSheetDisableDrag:!0,onDismiss:()=>rt({shouldResetQuery:!1}),trapFocus:!1,ariaLabel:n.formatMessage(fo.ariaLabel)}):(0,Le.jsx)(f().a,{className:"mini-search-snapshot-container",open:pe.isOpen,onDismiss:()=>rt({shouldResetQuery:!1}),render:()=>ft,transitionAppearance:"none",isWaxPaper:!0,backgroundStyle:{background:"transparent"},ariaLabel:n.formatMessage(fo.ariaLabel),innerStyle:{width:"max-content",height:"max-content",top:_e?void 0:90},style:{alignItems:"start"}})}const fo=(0,M().YK)({ariaLabel:{defaultMessage:"Search Notion",id:"Search2.ariaLabel"}})},569243:(e,t,n)=>{n.d(t,{Pf:()=>l,QL:()=>s,Sk:()=>a});const r={1:e=>e.orange.background.accentSecondary,2:e=>e.red.background.accentSecondary,3:e=>e.red.background.accentSecondary,4:e=>e.orange.background.accentSecondary,5:e=>e.orange.background.accentSecondary,6:e=>e.orange.background.accentSecondary,7:e=>e.green.background.accentSecondary,8:e=>e.green.background.accentSecondary,9:e=>e.green.background.accentSecondary,10:e=>e.green.background.accentSecondary,11:e=>e.yellow.background.accentSecondary,12:e=>e.yellow.background.accentSecondary,13:e=>e.green.background.accentSecondary,14:e=>e.blue.background.accentSecondary,15:e=>e.blue.background.accentSecondary,16:e=>e.blue.background.accentSecondary,17:e=>e.purple.background.accentSecondary,18:e=>e.purple.background.accentSecondary,19:e=>e.gray.background.accentSecondary,20:e=>e.gray.background.accentSecondary,21:e=>e.pink.background.accentSecondary,22:e=>e.pink.background.accentSecondary,23:e=>e.purple.background.accentSecondary,24:e=>e.purple.background.accentSecondary},o={1:e=>e.purple.background.accentSecondary,2:e=>e.green.background.accentSecondary,3:e=>e.pink.background.accentSecondary,4:e=>e.red.background.accentSecondary,5:e=>e.yellow.background.accentSecondary,6:e=>e.orange.background.accentSecondary,7:e=>e.blue.background.accentSecondary,8:e=>e.gray.background.accentSecondary,9:e=>e.blue.background.accentSecondary,10:e=>e.green.background.accentSecondary,11:e=>e.red.background.accentSecondary};function i({theme:e,color:t}){if("preset"===t.type){var n,i;if("calendar"===t.colorType)return null===(n=r[t.colorId])||void 0===n?void 0:n.call(r,e);if("event"===t.colorType)return null===(i=o[t.colorId])||void 0===i?void 0:i.call(o,e)}var s;if("custom"===t.type)return null===(s=t.colorHexes)||void 0===s?void 0:s[e.mode].backgroundPrimary}function s({theme:e,calendarColor:t}){const n=t&&i({theme:e,color:t});return n||e.blue.background.accentSecondary}function a({theme:e,eventColor:t,calendarColor:n}){const r=t&&i({theme:e,color:t});return r||s({theme:e,calendarColor:n})}function l(e){const{colorType:t,color:n,colorId:r}=e;return r?{type:"preset",colorId:r,colorType:t}:n?{type:"custom",colorHexes:n}:void 0}},582684:(e,t,n)=>{n.r(t),n.d(t,{arrowUpDownIcon:()=>o,iconDefinition:()=>r});n(296540);const r={viewBox:"0 0 20 20",fittedViewBox:"2.24 3.26 15.53 13.47",directional:!0,svg:(0,n(474848).jsx)("path",{d:"M14.075 3.45a.625.625 0 0 0-.884 0l-3.497 3.5a.625.625 0 0 0 .883.884l2.431-2.431v10.705a.625.625 0 0 0 1.25 0V5.402l2.431 2.43a.625.625 0 1 0 .884-.883zM2.427 12.167a.625.625 0 0 1 .884 0l2.43 2.431V3.893a.625.625 0 0 1 1.25 0v10.705l2.431-2.43a.625.625 0 0 1 .884.883L6.81 16.55a.625.625 0 0 1-.884 0l-3.498-3.498a.625.625 0 0 1 0-.884"})},o=(0,n(340498).wt)("arrowUpDown",r,"default")},608346:(e,t,n)=>{n.d(t,{m:()=>s});n(898992),n(354520),n(672577),n(581454);var r=n.n(n(844751)),o=n(296540),i=()=>n(534177);function s({sections:e,filterQuery:t}){return(0,o.useMemo)((()=>e.map((e=>function(e,t){const{items:n,...o}=e;if(!t)return e;const i=n.filter((e=>e.keywords.find((e=>r().match(t,e)))));return i.length>0?{...o,items:i}:void 0}(e,t))).filter(i().O9)),[t,e])}},613016:(e,t,n)=>{n.d(t,{a:()=>o});var r=()=>n(907258);function o(){const{sidebarSpaceStore:e}=r().default.getState();return e?e.id:void 0}},621594:(e,t,n)=>{n.r(t),n.d(t,{exclamationMarkCircleSmallIcon:()=>i,iconDefinition:()=>o});n(296540);var r=n(474848);const o={viewBox:"0 0 16 16",fittedViewBox:"1.87 1.87 12.25 12.25",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{d:"M7.9 4.875a.625.625 0 0 0-.625.625V8a.625.625 0 1 0 1.25 0V5.5a.625.625 0 0 0-.625-.625m0 4.7a.725.725 0 1 0 0 1.45.725.725 0 0 0 0-1.45"}),(0,r.jsx)("path",{d:"M8 1.875a6.125 6.125 0 1 0 0 12.25 6.125 6.125 0 0 0 0-12.25M3.125 8a4.875 4.875 0 1 1 9.75 0 4.875 4.875 0 0 1-9.75 0"})]})},i=(0,n(340498).wt)("exclamationMarkCircleSmall",o,"small")},627503:(e,t,n)=>{n.d(t,{a:()=>o});n(296540);const r={viewBox:"0 0 16 16",fittedViewBox:"1.37 1.37 13.25 13.25",svg:(0,n(474848).jsx)("path",{d:"M3.25 1.375c-1.036 0-1.875.84-1.875 1.875v6c0 1.036.84 1.875 1.875 1.875h1.625v1.625c0 1.036.84 1.875 1.875 1.875h6c1.036 0 1.875-.84 1.875-1.875v-6c0-1.036-.84-1.875-1.875-1.875h-1.625V3.25c0-1.036-.84-1.875-1.875-1.875zM2.625 3.25c0-.345.28-.625.625-.625h6c.345 0 .625.28.625.625v1.625H6.75c-1.036 0-1.875.84-1.875 1.875v3.125H3.25a.625.625 0 0 1-.625-.625zm3.5 3.5c0-.345.28-.625.625-.625h6c.345 0 .625.28.625.625v6c0 .345-.28.625-.625.625h-6a.625.625 0 0 1-.625-.625z"})},o=(0,n(340498).wt)("duplicateSmall",r,"small")},654774:(e,t,n)=>{n.d(t,{x:()=>u});var r=()=>n(115438),o=()=>n(906536),i=()=>n(232615),s=()=>n(355110),a=()=>n(184033),l=()=>n(238121),c=()=>n(718957);function u(e){var t;(0,r().l)();const{environment:n,store:u,canSelectAllBlocks:d}=e,p=(0,a().s)(u),m={startIndex:0,endIndex:p?p.endIndex:0};d&&"empty"!==i().default.state.mode&&(0,l().G)(null===(t=(0,c().cR)("textSelectionActions",i().default.state.multiSelection))||void 0===t?void 0:t.selection,m)?(0,s().U)(n):(0,o().t)({store:u,selection:m})}},662971:(e,t,n)=>{n.d(t,{A:()=>m});var r=n(296540),o=()=>n(30537);const i=function(){const[e,t]=r.useState({x:0,y:0});return r.useEffect((()=>{const e=e=>{t({x:e.clientX,y:e.clientY})};return window.addEventListener("mousemove",e),()=>{window.removeEventListener("mousemove",e)}}),[]),e};var s=n(474848);function a({x:e,mouseX:t}){return t>e?void 0:-Math.max(e-t,10)+"px"}function l({x:e,width:t,mouseX:n}){return n>e?-Math.max(n-(e+t),10)+"px":void 0}function c({x:e,width:t,mouseX:n}){return n>e?`${Math.max(n-(e+t),10)}px`:`${Math.max(e-n,10)}px`}function u({x:e,y:t,height:n,mouseX:r,mouseY:o}){return r>e?`polygon(0% 0%, 0% 100%, 100% ${100*(o-t)/n}%)`:`polygon(100% 0%, 0% ${100*(o-t)/n}%, 100% 100%)`}function d(e){const{x:t=0,y:n=0,height:o=0,width:d=0}=e.el.getBoundingClientRect()||{},{x:p,y:m}=i(),f={x:t,y:n,height:o,width:d,mouseX:p,mouseY:m},h=(0,r.useRef)(null),g=r.useCallback((e=>{if(h.current){h.current.style.pointerEvents="none";const t=document.elementFromPoint(e.clientX,e.clientY);if(h.current.style.pointerEvents="auto",t){const n=new MouseEvent(e.nativeEvent.type,e.nativeEvent);t.dispatchEvent(n)}}}),[]),v={insetInlineEnd:l(f),insetInlineStart:a(f),height:o,width:c(f),clipPath:u(f)};return(0,s.jsx)("div",{ref:h,onClick:g,style:{cursor:"pointer",position:"absolute",pointerEvents:"auto",top:0,...v}})}function p({onClick:e,renderOrigin:t,renderExtension:i,allowOptionalExtensionMenu:a,...l},c){const{disabled:u,disableDefaultClick:p,onFocus:m,focused:f,openOnFocus:h,placementToOrigin:g,alignmentToOrigin:v,disableCloseOnEnter:y,bottomSheetInitialState:S,popupTypeOverride:b}=l,x=(0,n(484714).WS)(),I=(0,n(546926).Tf)(),[k,M]=(0,r.useState)(!1),_=(0,r.useRef)(null),w=(0,r.useRef)(null),C=(0,r.useRef)(null),T=(0,r.useRef)(null),A=(0,r.useCallback)((()=>{C.current&&window.clearTimeout(C.current),T.current&&window.clearTimeout(T.current),C.current=null,T.current=null}),[]),R=(0,r.useCallback)((()=>{A(),u||M(!0)}),[u,A]),E=(0,r.useCallback)((()=>{A(),M(!1)}),[A]),j=(0,r.useCallback)((e=>{A(),k||(e&&e.preventDefault&&e.preventDefault(),C.current=window.setTimeout(R,120))}),[k,A,R]),P=(0,r.useCallback)((()=>{A(),k&&(T.current=window.setTimeout(E,100))}),[k,E,A]),F=(0,r.useCallback)((t=>{m(),R(),a&&(null==e||e(t),E())}),[m,R,a,e,E]),O=(0,r.useCallback)((()=>{j()}),[j]),B=(0,r.useCallback)((()=>{m(),j()}),[m,j]),D=(0,r.useCallback)((e=>{if(n(726637).A.isMobile)return;const t=_.current;k&&t&&!t.contains(e.target)&&E()}),[k,E]),N=(0,r.useCallback)((e=>{13===e.keyCode&&k&&!y&&E()}),[k,E,y]);(0,r.useEffect)((()=>{if(!Boolean(p))return window.addEventListener("click",D),()=>{window.removeEventListener("click",D)}}),[p,D]),(0,r.useEffect)((()=>(window.addEventListener("keydown",N),()=>{window.removeEventListener("keydown",N)})),[N]);const V=(0,r.useRef)(f);(0,r.useEffect)((()=>{h&&!V.current&&f?j():!f&&V.current&&P(),V.current=f}),[f,h,j,P]);const L=(0,n(401497).IS)((()=>({mobilePopupStyle:{borderRadius:12,backgroundColor:n(100622).Tj.background.secondary}})),[]),z={...(0,n(383036).A)({onMouseEnter:O,onClick:F},l),showExtensionArrow:!0};let q=o().n.Popup;return b?q=b:x&&(q=I?o().n.BottomSheet:o().n.SlideUp),(0,s.jsx)(n(782482).N,{debugName:"ExtensionMenuItem",capture:f,onEnter:k?void 0:j,onRight:j,onLeft:k?P:void 0,onEsc:k?P:void 0,children:(0,s.jsx)(n(127833).zD,{popupType:q,bottomSheetInitialState:S,open:k,origin:t(z,c),placementToOrigin:g??"right",alignmentToOrigin:v??"center",originGap:0,disableMouseCapture:!0,preventBlockRenderQueueOnEnter:!0,preventScaleTransition:!x,preventCaptureEsc:!0,ref:_,render:()=>(0,s.jsxs)(s.Fragment,{children:[!x&&w.current?(0,s.jsx)(d,{el:w.current}):null,(0,s.jsx)("div",{ref:w,style:{height:"100%"},children:i({onMouseEnter:B},{close:P})})]}),style:{overflow:"visible",...x&&L.mobilePopupStyle},trapFocus:!0,onDismiss:E})})}const m=r.forwardRef(p)},671089:(e,t,n)=>{n.r(t),n.d(t,{checkmarkCircleIcon:()=>i,iconDefinition:()=>o});n(296540);var r=n(474848);const o={viewBox:"0 0 20 20",fittedViewBox:"2.37 2.37 15.25 15.26",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{d:"M12.876 7.982a.625.625 0 1 0-1.072-.644L9.25 11.595 7.815 9.92a.625.625 0 0 0-.95.813l2 2.334a.625.625 0 0 0 1.01-.085z"}),(0,r.jsx)("path",{d:"M10 2.375a7.625 7.625 0 1 0 0 15.25 7.625 7.625 0 0 0 0-15.25M3.625 10a6.375 6.375 0 1 1 12.75 0 6.375 6.375 0 0 1-12.75 0"})]})},i=(0,n(340498).wt)("checkmarkCircle",o,"default")},683658:(e,t,n)=>{n.d(t,{q:()=>o});n(296540);const r={viewBox:"0 0 20 20",fittedViewBox:"1.62 3.62 16.75 12.75",directional:!0,svg:(0,n(474848).jsx)("path",{d:"M16.25 3.625c1.174 0 2.125.951 2.125 2.125v8.5a2.125 2.125 0 0 1-2.125 2.125H3.75a2.125 2.125 0 0 1-2.125-2.125v-8.5c0-1.174.951-2.125 2.125-2.125zm-12.5 1.25a.875.875 0 0 0-.875.875v8.5c0 .483.392.875.875.875h8.7V4.875zm9.8 10.25h2.7a.875.875 0 0 0 .875-.875v-8.5a.875.875 0 0 0-.875-.875h-2.7z"})},o=(0,n(340498).wt)("sidebarRight",r,"default")},704658:(e,t,n)=>{n.r(t),n.d(t,{UpgradeButton:()=>g});n(296540);var r=()=>n(593531),o=()=>n(406094),i=()=>n(69708),s=()=>n(86269),a=()=>n(839897),l=()=>n(674482),c=()=>n(24796),u=n(474848);function d(e){var t;const{upgradeStatus:n,handleClick:r,size:d="default",width:p="fill",hoverRef:m,onMouseDown:f,upsell:h,featureName:g}=e,v=(0,i().tz)(),y=(0,a().e)(n),S=y.label.button({intl:v,upsell:h,featureName:g}),b=Boolean(y.disabledTooltip),x=(0,s().Lo)({width:p}),{animationState:I,animationTriggers:k}=(0,s().lP)(m);return(0,u.jsx)(c().T,{tooltipMessage:b&&!m?null===(t=y.disabledTooltip)||void 0===t?void 0:t.call(y,{intl:v,upsell:h,featureName:g}):void 0,children:(0,u.jsx)(o().A,{...m?{}:k,disabled:b,hoveredStyle:m?{background:"unset"}:void 0,size:l().lR[d],iconLeading:{...(0,s().e4)({icon:y.icon({upsell:h}),animationState:I}),size:l().Ud[d]},style:x,onClick:r,onMouseDown:f,children:S})})}var p=()=>n(160432);function m(e){var t;const{upsell:n,upgradeStatus:r,handleClick:o,onMouseDown:s,featureName:d}=e,m=(0,i().tz)(),f=(0,a().e)(r),h=f.label.button({intl:m,upsell:n,featureName:d}),g=Boolean(f.disabledTooltip);return(0,u.jsx)(c().T,{tooltipMessage:g?null===(t=f.disabledTooltip)||void 0===t?void 0:t.call(f,{intl:m,upsell:n,featureName:d}):void 0,children:(0,u.jsx)(p().A,{colorPalette:"blue",disabled:g,size:l().lR.default,onClick:o,onMouseDown:s,children:h})})}var f=()=>n(986321),h=()=>n(408543);function g({source:e,upsell:t,featureName:n,hoverRef:o,onMouseDown:i,postUpgradeCallback:s,onClickBeforeUpgradeAction:a,spaceStore:l,...c}){const{upgradeEligibility:p,handleClick:g}=(0,h().C)({upsell:t,source:e,buttonDisplayType:c.display,onClickBeforeUpgradeAction:a,postUpgradeCallback:s,spaceStore:l});if(!p||"not_eligible"===p.status&&"feature_not_upsellable"===p.reason)return null;switch(c.display){case"button":return(0,u.jsx)(d,{upgradeStatus:p.status,handleClick:g,upsell:t,featureName:n,hoverRef:o,onMouseDown:i,...c});case"icon":return(0,u.jsx)(r().c,{upgradeStatus:p.status,handleClick:g,upsell:t,featureName:n,hoverRef:o,onMouseDown:i,...c});case"text":return(0,u.jsx)(f().c,{upgradeStatus:p.status,handleClick:g,upsell:t,featureName:n,hoverRef:o,onMouseDown:i,...c});case"primary":return(0,u.jsx)(m,{upgradeStatus:p.status,handleClick:g,upsell:t,featureName:n,onMouseDown:i,...c})}}},709438:(e,t,n)=>{n.d(t,{m:()=>l});n(296540);var r=()=>n(401497),o=()=>n(69708),i=()=>n(100622),s=n(474848);const a=8;function l({color:e,size:t,style:n}){const l=(0,o().tz)(),c=(0,r().IS)((()=>({dot:{height:t||a,width:t||a,background:e||i().Tj.blue.icon.accentPrimary,flexShrink:0,borderRadius:"100%",pointerEvents:"none",...n}})),[t,e,n]);return(0,s.jsx)("div",{role:"img","aria-label":l.formatMessage({id:"statusDot.ariaLabel",defaultMessage:"New"}),style:c.dot})}},736767:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(296540),o=n(474848);function i(e,t){return(0,o.jsx)(n(424400).Ay,{...e,ref:t,style:{background:"none",borderBottom:"none",boxShadow:"",marginTop:2,marginBottom:6,paddingTop:4,paddingBottom:4,minHeight:"none",...e.style}})}const s=(0,r.forwardRef)(i)},738508:(e,t,n)=>{n.r(t),n.d(t,{cursorIcon:()=>i,iconDefinition:()=>o});n(296540);var r=n(474848);const o={viewBox:"0 0 20 20",fittedViewBox:"1.25 0 17.5 20",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("g",{className:"logo-light-mode",children:[(0,r.jsxs)("g",{clipPath:"url(#clip0_16020_205)",children:[(0,r.jsx)("path",{fill:"#757575",d:"m9.995 9.987 8.658 4.999a.6.6 0 0 1-.226.226l-8.092 4.672a.68.68 0 0 1-.68 0l-8.092-4.672a.6.6 0 0 1-.226-.226z"}),(0,r.jsx)("path",{fill:"#525252",d:"M9.995 0v9.987l-8.658 4.999a.6.6 0 0 1-.082-.309v-9.38c0-.22.117-.424.308-.534L9.655.09a.7.7 0 0 1 .34-.09"}),(0,r.jsx)("path",{fill:"#404040",d:"M18.652 4.989a.6.6 0 0 0-.225-.226L10.334.09A.7.7 0 0 0 9.995 0v9.987l8.658 4.999a.6.6 0 0 0 .083-.309v-9.38c0-.11-.03-.216-.083-.308"}),(0,r.jsx)("path",{fill:"#D9D9D9",d:"M18.047 5.339a.29.29 0 0 1 0 .29l-7.859 13.61c-.053.093-.193.055-.193-.05v-8.97a.4.4 0 0 0-.054-.201z"}),(0,r.jsx)("path",{fill:"#fff",d:"m18.047 5.339-8.106 4.68a.4.4 0 0 0-.147-.147L2.027 5.387c-.092-.053-.054-.193.052-.193h15.717c.111 0 .202.06.25.145"})]}),(0,r.jsx)("defs",{children:(0,r.jsx)("clipPath",{id:"clip0_16020_205",children:(0,r.jsx)("path",{fill:"#fff",d:"M1.255 0h17.49v20H1.256z"})})})]}),(0,r.jsxs)("g",{className:"logo-dark-mode",children:[(0,r.jsxs)("g",{clipPath:"url(#clip0_16020_213)",children:[(0,r.jsx)("path",{fill:"#6E6E6E",d:"m9.995 9.987 8.658 4.999a.6.6 0 0 1-.226.226l-8.092 4.672a.68.68 0 0 1-.68 0l-8.092-4.672a.6.6 0 0 1-.226-.226z"}),(0,r.jsx)("path",{fill:"#4A4A4A",d:"M9.995 0v9.987l-8.658 4.999a.6.6 0 0 1-.082-.309v-9.38c0-.22.117-.424.308-.534L9.655.09a.7.7 0 0 1 .34-.09"}),(0,r.jsx)("path",{fill:"#383838",d:"M18.652 4.989a.6.6 0 0 0-.225-.226L10.334.09A.7.7 0 0 0 9.995 0v9.987l8.658 4.999a.6.6 0 0 0 .083-.309v-9.38c0-.11-.03-.216-.083-.308"}),(0,r.jsx)("path",{fill:"#C9C9C9",d:"M18.047 5.339a.29.29 0 0 1 0 .29l-7.859 13.61c-.053.093-.193.055-.193-.05v-8.97a.4.4 0 0 0-.054-.201z"}),(0,r.jsx)("path",{fill:"#fff",d:"m18.047 5.339-8.106 4.68a.4.4 0 0 0-.147-.147L2.027 5.387c-.092-.053-.054-.193.052-.193h15.717c.111 0 .202.06.25.145"})]}),(0,r.jsx)("defs",{children:(0,r.jsx)("clipPath",{id:"clip0_16020_213",children:(0,r.jsx)("path",{fill:"#fff",d:"M1.255 0h17.49v20H1.256z"})})})]})]})},i=(0,n(340498).wt)("cursor",o,"default")},748054:(e,t,n)=>{n.d(t,{M:()=>o});n(296540);const r={viewBox:"0 0 20 20",fittedViewBox:"3.97 2.68 12.51 14.37",svg:(0,n(474848).jsx)("path",{d:"M10.282 3.66a5.39 5.39 0 0 0-5.217-.54l-.711.305a.63.63 0 0 0-.38.575v12.425a.625.625 0 1 0 1.25 0v-3.913l.333-.142a4.14 4.14 0 0 1 4.008.414 5.39 5.39 0 0 0 5.504.405l1.06-.53a.63.63 0 0 0 .346-.56V4a.625.625 0 0 0-.905-.558l-1.06.53c-1.36.68-2.983.56-4.228-.312m-5.057 7.495V4.412l.332-.142a4.14 4.14 0 0 1 4.008.413 5.39 5.39 0 0 0 5.504.406l.156-.078v6.703l-.715.357c-1.36.68-2.983.56-4.228-.312a5.4 5.4 0 0 0-5.057-.604"})},o=(0,n(340498).wt)("flag",r,"default")},766854:(e,t,n)=>{n.d(t,{H:()=>I,Q:()=>x});n(898992),n(672577);var r=()=>n(230711),o=()=>n(907258),i=()=>n(135168),s=()=>n(242422),a=()=>n(929219),l=()=>n(711339),c=()=>n(295633),u=()=>n(700500),d=()=>n(179034),p=()=>n(201980),m=()=>n(384944),f=()=>n(649813),h=()=>n(390650),g=()=>n(381678),v=()=>n(622811),y=()=>n(491848),S=()=>n(482871);function b(e,t,n){const o=(0,g()._)(e),i=null==o?void 0:o.id;if(!i||!n)return;if(!s().default.checkGate({gateName:"full_access_for_created_collection_pages"}))return;if(t.canAdmin())return;const a=t.getSpaceStore();return a&&(0,r().dp)(a,i).isMember()?[{role:"editor",type:"user_permission",user_id:i}]:void 0}function x(e){const{collectionContextStore:t,transaction:n}=e;return(0,y().w)({collectionContextStore:t,transaction:n}),I(e)}function I(e){var t,n,r;const{environment:g,collectionContextStore:y,groupsPointer:x,insertAtIndex:I,shouldCoerce:k,templateStore:M,transaction:_,from:w,tracker:C,inMemoryRecordCache:T,isKeyboard:A,title:R}=e,E=l().default.DO_NOT_USE_markLegacy("collections.add_item_lag");l().default.DO_NOT_USE_measureAfterNextFlushLegacy(E,{environment:g,getData:()=>({...h().kz(y),from:w.createBlock})});const j="collectionTypedView"===y.contextTypeFromStoreState,P=y.databaseTypeFromStoreState,F=y.collectionStoresStore.state,O=F.find((e=>e.canEdit()||e.canEditCollection()||e.canEditContentOnly()))||F[0],B=null===(t=(0,i().f)(O))||void 0===t?void 0:t.id,D=o().default.state.currentUserSettingsStore,N=j&&P&&B&&D&&[...D.getAllPreferredCollections(B),...D.getPreferredCollectionsOfType(B,P)]||[];let V;const L=x[0];if("group_header"===w.createBlock&&"location"===L.value.type){const e=L.value.value;if(e){V=F.find((t=>t.id===e.id&&(t.canEdit()||t.canEditCollection()||t.canEditContentOnly())))}}else V=function(e,t){for(const n of e){const e=t.find((e=>e.id===n&&(e.canEdit()||e.canEditCollection()||e.canEditContentOnly())));if(e)return e}}(N,F);const z=V??O,q=null==z?void 0:z.getSpaceId(),U=y.collectionViewStore(),K=y.getViewType(),H=m().Wv({environment:g,type:u().xd.page,inMemoryRecordCache:T,transaction:_,spaceId:q,tracker:C,permissions:b(g,z,q),properties:{title:(0,p().x9d)(R)}});if(!z||!U||!K)return{coercionSucceeded:!0,newStore:H};const W=null===(n=y.groupsStore.getGroupState(x))||void 0===n?void 0:n.groupUiParentStore;if(!W)return{coercionSucceeded:!0,newStore:H};const G=c().B.createChildStore(W,{table:d().ev,id:H.id});M&&a().A.state.online&&f().TB({title:"template",environment:g,store:H,templateStore:M,isKeyboard:A??!1,isCreateIn:!1,transaction:_,from:w.initCollection??"collection_group_actions"});const $=(0,v().j)({environment:g,store:H,collectionStore:z,collectionContextStore:y,groupsPointer:x,shouldCoerce:k,transaction:_}),Y=(null===(r=y.groupsStore.getGroupState(x))||void 0===r||null===(r=r.reducerResultStore.state)||void 0===r?void 0:r.blockIds)||[],Q=void 0!==I?I:Y.length,Z=y.permissionScopesStore.state;if((s().default.checkGate({gateName:"can_create_pages_in_collection_permission"})?Z.canCreatePagesInCollection:Z.canEditContent)||j){const e=[...Y.slice(0,Q),G.id,...Y.slice(Q)];(0,S().z)({resultIds:e,collectionViewStore:U,collectionContextStore:y,transaction:_})}return{coercionSucceeded:$,newStore:G}}},773706:(e,t,n)=>{n.d(t,{T:()=>o});const r="ShowMentionInvite";function o(e){return`${r}-${e}`}},783793:(e,t,n)=>{n.d(t,{o:()=>c,x:()=>l});n(296540);var r=()=>n(401497),o=()=>n(100622),i=()=>n(278589),s=()=>n(200424),a=n(474848);function l(e){const{variant:t,imgSource:n,tintColor:s,faceStyle:l,shadowVariant:u="strong",style:d,...p}=e,m=(0,r().IS)((()=>{const e=(0,i().N)(t);return{faceImgWrap:{width:e,height:e,borderRadius:"100%",background:o().Tj.assistantCornerButtonBackground,..."strong"===u&&{boxShadow:e>=90?o().Tj.shadowMDThickerOutline:o().Tj.shadowMD},..."light"===u&&{borderRadius:"50%",boxShadow:e>=90?o().Tj.shadowSMThickerOutline:o().Tj.shadowSM},overflow:"hidden",...d}}}),[t,u,d]);return(0,a.jsx)("div",{...p,children:(0,a.jsx)("div",{style:m.faceImgWrap,children:(0,a.jsx)(c,{imgSource:n,variant:t,tintColor:s,style:l})})})}function c(e){const{imgSource:t,variant:n,tintColor:o,style:l,alt:c,...u}=e,d=(0,i().N)(n),p=t??s(),m=c??"Notion AI face",f=(0,r().IS)((()=>({faceImg:{height:d,width:d,transform:"scaleX(var(--direction, 1))",...l},tintedFace:{height:d,width:d,transform:"scaleX(var(--direction, 1))",backgroundColor:o,WebkitMaskImage:`url(${p})`,maskImage:`url(${p})`,WebkitMaskRepeat:"no-repeat",maskRepeat:"no-repeat",WebkitMaskPosition:"center",maskPosition:"center",WebkitMaskSize:"contain",maskSize:"contain",...l}})),[d,l,o,p]);return void 0!==o?(0,a.jsx)("div",{style:f.tintedFace,role:"img","aria-label":m}):(0,a.jsx)("img",{...u,style:f.faceImg,src:p,alt:m})}},786937:(e,t,n)=>{n.d(t,{W:()=>o});n(944114);var r=()=>n(245241);function o(e){const t=[],n=[];let o;for(const a of e){var i;var s;if((null===(i=a.sources)||void 0===i?void 0:i.includes(r().Ni.Local))?t.push(a):n.push(a),!o&&a.serverEventProperties)o=null===(s=a.serverEventProperties)||void 0===s?void 0:s["server-searchExperiments"]}return{localResults:t,serverResults:n,exposedSearchExperiments:o}}},788621:(e,t,n)=>{n.r(t),n.d(t,{iconDefinition:()=>o,personCircleIcon:()=>i});n(296540);var r=n(474848);const o={viewBox:"0 0 20 20",fittedViewBox:"2.37 2.37 15.26 15.25",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{d:"M7.755 6.169C8.277 5.519 9.05 5.125 10 5.125s1.723.393 2.245 1.044c.51.635.75 1.474.75 2.346s-.24 1.71-.75 2.346c-.522.65-1.294 1.044-2.245 1.044-.95 0-1.723-.394-2.245-1.044-.51-.635-.75-1.474-.75-2.346s.24-1.711.75-2.346m.975.782c-.293.365-.475.909-.475 1.564s.182 1.198.475 1.564c.281.35.694.576 1.27.576s.989-.226 1.27-.576c.294-.366.475-.909.475-1.564s-.181-1.199-.475-1.564c-.281-.35-.693-.576-1.27-.576-.576 0-.989.225-1.27.576"}),(0,r.jsx)("path",{d:"M2.375 10a7.625 7.625 0 1 1 15.25 0 7.625 7.625 0 0 1-15.25 0M10 3.625a6.375 6.375 0 0 0-4.087 11.267c.789-1.397 2.333-2.33 4.087-2.33s3.298.933 4.087 2.33A6.375 6.375 0 0 0 10 3.625M13.049 15.6c-.547-1.049-1.697-1.789-3.05-1.789-1.351 0-2.501.74-3.048 1.789a6.35 6.35 0 0 0 3.049.775 6.34 6.34 0 0 0 3.049-.775"})]})},i=(0,n(340498).wt)("personCircle",o,"default")},791177:(e,t,n)=>{n.d(t,{$:()=>o});var r=n(296540);function o(){const[e,t]=(0,r.useState)({inputElementAttributes:void 0,suppressFocusRing:!1}),[n,o]=(0,r.useState)(!1),[i,s]=(0,r.useState)(!1);(0,r.useEffect)((()=>{if(n){function e(){s(!1)}function t(e){"ArrowDown"!==e.key&&"ArrowUp"!==e.key||s(!0)}return window.addEventListener("pointerdown",e),window.addEventListener("keydown",t),()=>{window.removeEventListener("pointerdown",e),window.removeEventListener("keydown",t)}}}),[n]);return[(0,r.useMemo)((()=>({inputElementAttributes:e.inputElementAttributes,suppressFocusRing:e.suppressFocusRing&&i,onFocus:()=>{o(!0)},onBlur:()=>{o(!1)}})),[e,i]),(0,r.useMemo)((()=>({setComboboxState:t,isFocusVisible:i,isComboboxFocused:n,onItemHover:()=>{s(!1)}})),[i,n])]}},797324:(e,t,n)=>{n.d(t,{A:()=>h});var r=n(296540),o=()=>n(560520),i=()=>n(484714),s=()=>n(790748),a=()=>n(581010),l=()=>n(69708),c=()=>n(100622),u=()=>n(284371),d=()=>n(396406),p=()=>n(718827),m=()=>n(843798),f=n(474848);function h(e){const{onDismiss:t,inputRef:n}=e,h=(0,i().Y0)(),g=(0,r.useRef)(null),v=h.isMobileNative&&h.isIOS,y=v&&e.show;(0,s().b)(a().A,(()=>({getNode:()=>g.current,isShown:()=>y})),[y]);const S=(0,o().n)(),b=(0,r.useCallback)((()=>{var e;null==n||null===(e=n.current)||void 0===e||e.focus(),t&&t();const r=document.activeElement;r instanceof HTMLElement&&r.blur()}),[n,t]);if(!v)return null;const x=y?-(m().j+S):0;return(0,f.jsx)(d().O,{open:!0,children:(0,f.jsx)("div",{style:{position:"fixed",top:"100vh",width:"100%",height:m().j,display:y?"flex":"none",alignItems:"center",justifyContent:"flex-end",backgroundColor:c().Tj.keyboardDoneBarBackground,transform:`translateY(${x}px)`,transition:y?"ease-out":"ease-in",boxShadow:y?`\n\t\t\t\t\t\t\t\t0 -1px 0 ${c().Tj.border.primaryTranslucent}\n\t\t\t\t\t\t\t`:void 0},ref:g,children:(0,f.jsx)(p().Ay,{style:{display:"flex",alignItems:"center",marginInlineEnd:16,color:c().oZ.blue,fontWeight:u().Wy.semibold},onTouchEnd:()=>{b()},children:(0,f.jsx)(l().sA,{defaultMessage:"Done",id:"mobile.dismissKeyboardBar.button.label"})})})})}},811979:(e,t,n)=>{n.d(t,{A:()=>l});var r=n(296540),o=()=>n(205262),i=()=>n(590526),s=n(474848);function a(e,t){const{onClose:a,persistOnClose:l,render:d,stopClickPropagation:p,onClick:m,disablePopup:f,disabled:h,forceInitialInbound:g,renderOrigin:v,originGap:y,borderRadius:S,popupWrapStyle:b}=e,x=(0,i().uB)(e.buttonPopupStore,n(118307).A);(0,r.useEffect)((()=>()=>{x.setState({open:!1})}),[x]);const I=(0,r.useCallback)((()=>c(a,l,x)),[a,l,x]),k=(0,r.useCallback)((()=>(0,s.jsx)(u,{onClose:a,persistOnClose:l,render:d,buttonPopupStore:x})),[a,l,d,x]),M=(0,r.useCallback)((e=>function(e,t,n,r,i){t&&(null==e||e.stopPropagation());if(e&&(0,o().V)(e))return;n&&n(e);r||i.setState({...i.state,open:!0})}(e,p,m,f,x)),[p,m,f,x]),_=(0,i().K8)((()=>v({...e,onClick:h?n(496603).D_:M})),[h,M,e,v]),w=(0,i().K8)((()=>x.state.open),[x]);return(0,s.jsx)(n(127833).zD,{ref:t,...e,forceInitialInbound:Boolean(g),render:k,open:w,onDismiss:I,origin:_,originGap:y,borderRadius:S,popupWrapStyle:b,trapFocus:!0})}const l=r.forwardRef(a);function c(e,t,n){e&&e(),t||n.reset()}function u({onClose:e,persistOnClose:t,render:n,buttonPopupStore:o}){const a=(0,r.useCallback)((()=>c(e,t,o)),[e,t,o]),l=(0,i().K8)((()=>n({close:a})),[n,a]);return(0,s.jsx)(s.Fragment,{children:l})}},827368:(e,t,n)=>{n.d(t,{Cd:()=>u,Wd:()=>p,yq:()=>m});var r=n(296540),o=()=>n(59226),i=()=>n(829098),s=()=>n(631611),a=n(474848);const l="bodyRegular",c="bodyLgRegular";function u(e){const{fontSize:t,lineHeight:n}=i().U[e];return{fontSize:t,lineHeight:n}}const d=(0,r.createContext)(void 0);function p({children:e,isFullPage:t}){const n=(0,o().X)("agent_larger_font"),i=(0,s().jw)(),u=(0,r.useMemo)((()=>{const e=t??i.isType("fullPage","inferenceTranscriptChatView");return{bodyStyleKey:n&&e?c:l,isLargerFontEnabled:n}}),[n,i,t]);return(0,a.jsx)(d.Provider,{value:u,children:e})}function m(){const e=(0,r.useContext)(d);return e||{bodyStyleKey:l,isLargerFontEnabled:!1}}d.displayName="AgentFontContext"},838364:(e,t,n)=>{n.d(t,{H:()=>r});const r=52},839754:(e,t,n)=>{n.d(t,{Bi:()=>_,My:()=>M,ZM:()=>C,_M:()=>w,navigateToWorkflowTemplateOnboardingModal:()=>T});n(16280),n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(354520),n(672577),n(581454);var r=()=>n(907258),o=()=>n(295633),i=()=>n(584262),s=()=>n(663077),a=()=>n(179034),l=()=>n(201980),c=()=>n(749750),u=()=>n(896628),d=()=>n(384944),p=()=>n(857783),m=()=>n(730969),f=()=>n(840153),h=()=>n(339798),g=()=>n(180762),v=()=>n(799832),y=()=>n(111379),S=()=>n(295304),b=()=>n(547149),x=()=>n(373444),I=()=>n(165592),k=()=>n(204067);function M({transaction:e,collectionStore:t,propertyTemplates:n}){var r;const o=(null===(r=t.getParentBlockStore())||void 0===r?void 0:r.getCollectionViewStores().filter((e=>"table"===e.getType())))??[];if(0===o.length)return;const i=[];for(const l of n){const e=(0,k().S1)({collectionStore:t,templateId:l.templateId,instancePointerType:"property"});e&&i.push({property:e.id,visible:!(0,s().Sz)(l),...l.tablePropertyFormat})}if(0!==i.length)for(const s of o){var a;const t=(null===(a=s.getPropertyFormatsStore("table_properties"))||void 0===a?void 0:a.getValue())??[],n=new Set(t.map((e=>e.property))),r=i.filter((e=>!n.has(e.property)));0!==r.length&&u().zA({stores:[s],update:{table_properties:[...t,...r]},transaction:e})}}function _({transaction:e,collectionStore:t,propertyTemplates:n}){const r=[];for(const a of n){const e=(0,k().S1)({collectionStore:t,templateId:a.templateId,instancePointerType:"property"});e&&r.push({property:e.id,visible:!0})}const o=t.getFormat().collection_page_properties??[],i=new Set(o.map((e=>e.property))),s=r.filter((e=>!i.has(e.property)));s.length&&u().zA({stores:[t],update:{collection_page_properties:[...o,...s]},transaction:e})}function w({environment:e,newPageStore:t,result:n}){"accepted_template"!==n.type&&"accepted_empty_collection"!==n.type||b().createAndCommit({environment:e,canUndo:!1,perform:r=>{const i=t.getTitleValue();if(d().zv({store:t,transaction:r,data:{alive:!1}}),"accepted_empty_collection"===n.type&&!(0,l().w9s)(i)){const s=o().B.createChildStore(t,{table:"block",id:n.blockId}).getTitleStore();s&&S().yr({environment:e,transaction:r,tokens:i,index:0,store:s})}const s=t.getParentStore();if((null==s?void 0:s.table)===a().ev){const e=s.getContentIds();d().zv({store:s,transaction:r,data:{content:e.filter((e=>e!==t.id))}})}},userAction:"clean_up_empty_new_page"})}function C({environment:e,userAction:t,result:n,existingCollectionViewBlockStore:r,existingCollectionStore:o}){if("canceled"!==n.type){if("accepted_empty_collection"===n.type&&o){const r=o.getKeyStore("name"),i=(0,l().x9d)(n.newCollectionTitle);r&&b().createAndCommit({userAction:t,environment:e,canUndo:!0,perform:t=>S().R9({environment:e,store:r,transaction:t,value:i})})}if(r){var i;const e=null===(i=(0,v().U)(r))||void 0===i?void 0:i.settingsStore;e&&h().os({collectionSettingsStore:e})}if("accepted_template"===n.type&&null!=r&&r.isCollectionView()&&(null==r||!r.hasSingleSourceAndNoLinkedCollections())){const t=(0,v().U)(r),o=r.getCollectionViewStores().find((e=>{var t;return(null===(t=e.getCollectionStore())||void 0===t?void 0:t.id)===n.collectionId}));if(!t||!o)return;(0,g().t)({environment:e,collectionContextStore:t,collectionViewId:o.id,isFullScreen:t.isFullScreenStore.state,isRootChild:t.isRootChildStore.state,isInPeekRenderer:t.isInPeekRendererStore.state})}}}async function T({environment:e,collectionViewBlockStore:t}){const n=t.id;if(!t.isDefined()){const r=await c().$f({environment:e,blockId:n});if(!r)return;e=await f().T({environment:e,newCurrentUserId:r}),t=new(o().B)(e,{table:a().ev,id:n}),await t.load()}const s=t.getSpaceId();if(!s)throw new Error("Space ID not found for collection block");const l=(0,y().k)(s);if(!l)throw new Error(`Space view not found for space ID: ${s}`);const{sidebarSpaceStore:u}=r().default.state;(null==u?void 0:u.id)!==s&&await(0,m().y)({environment:e,spaceViewStore:l});const d=t.getFormat();if("workflow_template_placeholder"===(null==d?void 0:d.collection_view_sub_type)&&null!=d&&d.placeholder_workflow_template_id&&t.isCollectionView()){const{getCollectionTemplateFromId:n}=await I().t.load(),r=n(d.placeholder_workflow_template_id);if(!r)throw new Error(`Collection template "${d.placeholder_workflow_template_id}" not found`);const{onNavigateToPlaceholderWorkflowTemplateBlock:o}=await x().O.load();o({environment:e,collectionTemplate:r,collectionViewBlockStore:t})}else p().uK({environment:e,store:t,pageVisitSource:i().y8.WorkflowTemplatesDeeplink})}},848401:(e,t,n)=>{n.d(t,{Ay:()=>h,mI:()=>m,vb:()=>f});n(296540);var r=()=>n(401497),o=()=>n(718827),i=()=>n(807449),s=()=>n(784892),a=()=>n(563692),l=()=>n(340498),c=()=>n(69708),u=()=>n(284371),d=n(474848);const p=(0,c().YK)({removeTokenLabel:{defaultMessage:"Remove {title}",id:"uiGenericToken.removeTokenLabel"},removeTokenLabelGeneric:{defaultMessage:"Remove Item",id:"uiGenericToken.removeTokenLabelGeneric"}}),m=s().NY,f={[s().NY.ExtremeSmall]:{height:12,fontSize:10,margin:"0 4px 0 0",marginEditState:"0 6px 0 0",closeIconSize:l().Ev.xxs,avatarSize:14},[s().NY.ExtraSmall]:{height:14,fontSize:12,margin:"0 6px 0 0",marginEditState:"0 6px 0 0",closeIconSize:l().Ev.xxs,avatarSize:14},[s().NY.Small]:{height:18,fontSize:12,margin:"0 6px 6px 0",marginEditState:"0 6px 6px 0",closeIconSize:l().Ev.xxs,avatarSize:16},[s().NY.CompactEssential]:{height:20,fontSize:14,margin:"0 10px 6px 0",marginEditState:"0 6px 6px 0",closeIconSize:l().Ev.xxs,avatarSize:20},[s().NY.Medium]:{height:20,fontSize:14,margin:"0 10px 6px 0",marginEditState:"0 6px 6px 0",closeIconSize:l().Ev.xxs,avatarSize:20},[s().NY.Inline]:{height:20,fontSize:14,closeIconSize:l().Ev.xxs,avatarSize:20,margin:"0 -5px 0 0",marginEditState:"0 6px 0 0"},[s().NY.Large]:{height:24,fontSize:16,margin:"0 8px 8px 0",marginEditState:"0 8px 8px 0",closeIconSize:l().Ev.sm,avatarSize:24}};function h({avatarSize:e,format:t,isSingle:n,onClickRemove:s,renderAvatar:l,showRemoveButton:m,shouldShrink:h,style:g,title:v}){const y=(0,c().tz)(),{height:S,fontSize:b,margin:x,marginEditState:I,closeIconSize:k,avatarSize:M}=f[t],_=e??M,w=(0,r().IS)((()=>({root:{display:"flex",alignItems:"center",flexShrink:h?1:0,minWidth:0,height:S,borderRadius:6,fontSize:b,lineHeight:"120%",margin:n?0:m?I:x,...g}})),[b,S,n,x,I,h,m,g]);return(0,d.jsxs)("div",{style:w.root,children:[null==l?void 0:l(_),(0,d.jsx)("div",{className:"notranslate",style:{...u().RC},children:v}),m?(0,d.jsx)(o().Ay,{ariaLabel:void 0!==v?y.formatMessage(p.removeTokenLabel,{title:v}):y.formatMessage(p.removeTokenLabelGeneric),onClick:s,style:{display:"flex",alignItems:"center",justifyContent:"center",width:S,height:S,marginInlineStart:2,marginInlineEnd:2,flexGrow:0,flexShrink:0,borderRadius:6},children:(0,d.jsx)(i().I,{icon:a().xMarkFillSmallIcon,size:k,style:{opacity:.5}})}):null]})}},859384:(e,t,n)=>{n.d(t,{M:()=>i});n(296540);var r=n(474848);const o={viewBox:"0 0 20 20",fittedViewBox:"3.12 2.99 13.88 13.88",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{d:"m16.774 4.341-.59.589-1.109-1.11.596-.594a.784.784 0 0 1 1.103 0c.302.302.302.8 0 1.102zM8.65 12.462l6.816-6.813-1.11-1.11-6.822 6.808a1.1 1.1 0 0 0-.236.393l-.289.932c-.052.196.131.38.315.314l.932-.288a.9.9 0 0 0 .394-.236"}),(0,r.jsx)("path",{d:"M4.375 6.25c0-1.036.84-1.875 1.875-1.875H11a.625.625 0 1 0 0-1.25H6.25A3.125 3.125 0 0 0 3.125 6.25v7.5c0 1.726 1.4 3.125 3.125 3.125h7.5c1.726 0 3.125-1.4 3.125-3.125V9a.625.625 0 1 0-1.25 0v4.75c0 1.036-.84 1.875-1.875 1.875h-7.5a1.875 1.875 0 0 1-1.875-1.875z"})]})},i=(0,n(340498).wt)("compose",o,"default")},883701:(e,t,n)=>{n.d(t,{J:()=>a});var r=()=>n(34977),o=()=>n(457205),i=()=>n(849255),s=()=>n(534177);function a(e,t){if(t&&t.asActor)switch(t.pointer.table){case"bot":return new(o().v)(e,t.pointer);case"agent":return new(r().p)(e,t.pointer);case"notion_user":return new(i().L)(e,t.pointer);default:(0,s().HB)(t.pointer)}}},888325:(e,t,n)=>{function r(e){return`${e.table}:${e.id}`}n.d(t,{_:()=>r})},890409:(e,t,n)=>{n.d(t,{Ah:()=>v,Dk:()=>f,Iv:()=>g,SF:()=>h,YO:()=>b,_f:()=>I,c_:()=>p,dW:()=>S,gW:()=>m,sp:()=>k,vN:()=>y});n(16280),n(944114),n(898992),n(354520),n(803949),n(581454),n(737550);var r=()=>n(496603),o=()=>n(973647),i=()=>n(534177),s=()=>n(842599),a=()=>n(239381),l=()=>n(179034),c=()=>n(798880),u=()=>n(201980),d=()=>n(241319);function p(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"add_automation_step",properties:t})}function m(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"delete_automation_step",properties:t})}function f(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_create",properties:t})}function h(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_update",properties:t})}function g(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_delete",properties:t})}function v(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_enable",properties:t})}function y(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_disable",properties:t})}function S(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_action_create",properties:t})}function b(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_action_delete",properties:t})}function x(e){const{formulaAnalyticsModule:t,formulasModule:n,formulaTypecheckContextValues:r,getRecordModel:s,spaceId:l,value:c,featureGates:u}=e;if("formula"===c.type){if(!(0,i().O9)(c.value))return;const e=o().Q.unwrapOr(n.parseFormulaInputToAst(c.value),void 0);if(e){const o=n.addTypesToFormulaAST(e,{handleDataRequest:(0,a().zg)(s),spaceId:l,valueTypes:r,featureGates:u});return{...t.getFormulaAnalytics(e,{getRecordModel:s,typecheckContextValues:r}),formula_return_type:o.node.type,redacted_formula:t.getRedactedFormulaAsStringSync(e,{getRecordModel:s,typecheckContextValues:r})}}}else{if("simple"===c.type){if(!(0,i().O9)(c.value))return;return t.getSimpleFormulaAnalytics(c.value,{getRecordModel:s,typecheckContextValues:r})}(0,i().HB)(c.type)}}function I(e){const{automationActionModel:t,automationActionModels:n,formulaAnalyticsModule:o,formulasModule:l,formulaTypecheckContextValues:p,getRecordModel:m,featureGates:f,simpleFormulasModule:h}=e;return t.isType("complete_sprint")?{automation_action_id:t.pointer.id,type:"complete_sprint"}:t.isType("create_page")?function(e){const{automationActionModel:t,formulaAnalyticsModule:n,formulasModule:r,formulaTypecheckContextValues:o,getRecordModel:s,featureGates:a}=e,l=t.getConfig();let c,u=[];const d=null==l?void 0:l.collection,p=null==l?void 0:l.properties;if((0,i().O9)(d)&&(0,i().O9)(p)&&p.length>0){const e=s(d),f=null==e?void 0:e.getNormalizedSchema();(0,i().O9)(f)&&(u=p.map((e=>{var t;return(null===(t=f[e])||void 0===t?void 0:t.type)??"unknown"})));const h=null==l?void 0:l.values;if(r&&(0,i().O9)(h)){c=[];for(const e of p){var m;const i=null===(m=h[e])||void 0===m?void 0:m.value;if(!i)continue;const l=x({formulaAnalyticsModule:n,formulasModule:r,getRecordModel:s,formulaTypecheckContextValues:o,spaceId:t.spaceId,value:i,featureGates:a});l&&c.push(l)}}}return{automation_action_id:t.pointer.id,property_formula_stats:c,property_types:u,type:"create_page"}}({automationActionModel:t,formulaAnalyticsModule:o,formulasModule:l,formulaTypecheckContextValues:p,getRecordModel:m,featureGates:f}):t.isType("duplicate_blocks")?{automation_action_id:t.pointer.id,type:"duplicate_blocks"}:t.isType("modal_confirmation")?function(e){const{automationActionModel:t,formulaAnalyticsModule:n,formulasModule:r,formulaTypecheckContextValues:o,getRecordModel:s,featureGates:a}=e,l=t.getConfig(),c=[];if(r&&(0,i().O9)(l)&&l.text){const e=x({formulasModule:r,formulaAnalyticsModule:n,getRecordModel:s,formulaTypecheckContextValues:o,spaceId:t.spaceId,value:l.text,featureGates:a});e&&c.push(e)}return{automation_action_id:t.pointer.id,formula_stats:c,type:"modal_confirmation"}}({automationActionModel:t,formulaAnalyticsModule:o,formulasModule:l,formulaTypecheckContextValues:p,getRecordModel:m,featureGates:f}):t.isType("open_page")?{automation_action_id:t.pointer.id,type:"open_page"}:t.isType("query_collection")?{automation_action_id:t.pointer.id,type:"query_collection"}:t.isType("send_in_app_notification")?function(e){var t;const{automationActionModel:n,formulaAnalyticsModule:r,formulasModule:o,formulaTypecheckContextValues:s,getRecordModel:a,featureGates:l,simpleFormulasModule:c}=e,d={automation_action_id:n.pointer.id,messageCharacterCount:0,type:"send_in_app_notification"},p=n.getConfig();if(!(0,i().O9)(p))return d;if((0,i().O9)(p.target))if("formula"===p.target.type&&(0,i().O9)(p.target.value)){if(d.targetData={type:"formula",numUserFormulaTargets:(0,u().Fbh)(p.target.value.value).length,numFormulaContextTargets:c.getReferencedContextValueIds(p.target.value).length},o){const e=x({formulasModule:o,formulaAnalyticsModule:r,getRecordModel:a,formulaTypecheckContextValues:s,spaceId:n.spaceId,value:p.target.value,featureGates:l});e&&(d.formula_stats??=[],d.formula_stats.push(e))}}else if("property"===p.target.type&&(0,i().O9)(p.target.propertyId)&&(0,i().O9)(p.target.collectionPointer)){const e=a(p.target.collectionPointer),t=null==e?void 0:e.getSchema();var m;(0,i().O9)(t)&&(d.targetData={type:"property",propertyType:null===(m=t[p.target.propertyId])||void 0===m?void 0:m.type})}if((0,i().O9)(null===(t=p.notification_message)||void 0===t?void 0:t.value)&&(d.messageCharacterCount=(0,u().FAw)(p.notification_message.value),o)){const e=x({formulasModule:o,formulaAnalyticsModule:r,getRecordModel:a,formulaTypecheckContextValues:s,spaceId:n.spaceId,value:p.notification_message,featureGates:l});e&&(d.formula_stats??=[],d.formula_stats.push(e))}return d}({automationActionModel:t,formulaAnalyticsModule:o,formulasModule:l,formulaTypecheckContextValues:p,getRecordModel:m,featureGates:f,simpleFormulasModule:h}):t.isType("send_gmail_notification")?function(e){var t,n,o,a,l,d,p;const{automationActionModel:m,formulaAnalyticsModule:f,formulasModule:h,formulaTypecheckContextValues:g,getRecordModel:v,featureGates:y}=e,S=m.getConfig();if(!(0,i().O9)(S))return{automation_action_id:m.pointer.id,fields:{},recipient_domains:{},type:"send_gmail_notification"};const b=Object.fromEntries(Object.entries(S||{}).map((([e,t])=>{var n;return"formula"===(null==t?void 0:t.type)?[e,Boolean(null==t||null===(n=t.value)||void 0===n?void 0:n.value)]:"simple"===(null==t?void 0:t.type)?[e,Boolean(null==t?void 0:t.value)]:[e,Boolean(t)]}))),{to:I,cc:k,bcc:M}=S,_=[...(null==I||null===(t=I.value)||void 0===t?void 0:t.value)||[],...(null==k||null===(n=k.value)||void 0===n?void 0:n.value)||[],...(null==M||null===(o=M.value)||void 0===o?void 0:o.value)||[]],w=[...(0,u().Fbh)(_).map((e=>v({table:c().oo,id:e}))).map((e=>null==e?void 0:e.email)).filter(i().O9),...(0,s().C3)((0,u().k4p)(_))],C=r().Tr(w.map((e=>e.split("@")[1]))),T=[null===(a=S.to)||void 0===a?void 0:a.value,null===(l=S.cc)||void 0===l?void 0:l.value,null===(d=S.bcc)||void 0===d?void 0:d.value,null===(p=S.reply_to)||void 0===p?void 0:p.value,S.from_name,S.email_subject,S.email_body].map((e=>{if(h&&(0,i().O9)(e))return x({formulaAnalyticsModule:f,formulasModule:h,getRecordModel:v,formulaTypecheckContextValues:g,spaceId:m.spaceId,value:e,featureGates:y})})).filter(i().O9);return{automation_action_id:m.pointer.id,fields:b,formula_stats:T,recipient_domains:C,type:"send_gmail_notification"}}({automationActionModel:t,formulaAnalyticsModule:o,formulasModule:l,formulaTypecheckContextValues:p,getRecordModel:m,featureGates:f}):t.isType("slack_notification")?{automation_action_id:t.pointer.id,type:"slack_notification"}:t.isType("update_pages")?function(e){const{automationActionModel:t,automationActionModels:n,formulaAnalyticsModule:r,formulasModule:o,formulaTypecheckContextValues:s,getRecordModel:l,featureGates:c}=e,u=t.getConfig(),p=[],m=[],f=[];if((0,i().O9)(u)&&(0,i().O9)(u.target)&&(0,i().O9)(u.properties)&&u.properties.length>0){let e;if("variable"===u.target.type){const t=(0,a().y5)(u.target.id);if("action"===t.source){const t=(0,d().y)({actionModels:n,id:u.target.id}).collectionPointer;if((0,i().O9)(t)){const n=l(t);e=null==n?void 0:n.getNormalizedSchema()}}else{if("global"!==t.source||"button_page"!==t.global)throw new Error("Failed loading property schema");{const t=(0,a().IV)(s,u.target.id);if("block"===(null==t?void 0:t.type.type)&&(0,i().O9)(t.type.collection)){const n=l(t.type.collection);e=null==n?void 0:n.getNormalizedSchema()}}}}else if("collection"===u.target.type){const t=l(u.target.collection);e=null==t?void 0:t.getNormalizedSchema()}(0,i().O9)(e)&&u.properties.forEach((n=>{const a=e[n];if((0,i().O9)(a)&&(p.push(a.type),o&&(0,i().O9)(u.values))){const e=u.values[n];if((0,i().O9)(e)&&(m.push({type:a.type,operator:e.action}),e.value)){const n=x({formulasModule:o,formulaAnalyticsModule:r,getRecordModel:l,formulaTypecheckContextValues:s,spaceId:t.spaceId,value:e.value,featureGates:c});n&&f.push(n)}}}))}return{automation_action_id:t.pointer.id,property_configs:m,property_formula_stats:f,property_types:p,type:"update_pages"}}({automationActionModel:t,automationActionModels:n,formulaAnalyticsModule:o,formulasModule:l,formulaTypecheckContextValues:p,getRecordModel:m,featureGates:f}):t.isType("define_variables")?function(e){const{automationActionModel:t,formulaAnalyticsModule:n,formulasModule:r,formulaTypecheckContextValues:o,getRecordModel:s,featureGates:a}=e,l=t.getConfig(),c=[];if(r&&(0,i().O9)(l)&&l.values)for(const i of Object.values(l.values))if(i.value){const e=x({formulasModule:r,formulaAnalyticsModule:n,getRecordModel:s,formulaTypecheckContextValues:o,spaceId:t.spaceId,value:i.value,featureGates:a});e&&c.push(e)}return{automation_action_id:t.pointer.id,formula_stats:c,type:"define_variables"}}({automationActionModel:t,formulaAnalyticsModule:o,formulasModule:l,formulaTypecheckContextValues:p,getRecordModel:m,featureGates:f}):t.isType("http_request")?{automation_action_id:t.pointer.id,type:"http_request"}:t.isType("publish_site")?{automation_action_id:t.pointer.id,type:"publish_site"}:t.isType("worker")?{automation_action_id:t.pointer.id,type:"worker"}:void(0,i().HB)(t)}function k(e){const{automationModel:t,builderType:n="sidebar",formulaAnalyticsModule:r,formulasModule:o,formulaTypecheckContextValues:s,getRecordModel:a,featureGates:c,simpleFormulasModule:u,source:d}=e,p=[],m=t.getActionPointers().map((e=>a(e))).filter(i().O9);for(const l of t.getActionPointers()){const e=a(l);(0,i().O9)(e)&&p.push(I({automationActionModel:e,automationActionModels:m,formulaAnalyticsModule:r,formulasModule:o,formulaTypecheckContextValues:s,getRecordModel:a,featureGates:c,simpleFormulasModule:u}))}const f=[];let h,g,v;if(t.isEventType()){var y;const e=t.getEventConfiguration(),n=a(t.getParentPointer());h=t.getParentId();const r=t.getEventConfiguration();if("collection_view"===(null===(y=r.source)||void 0===y?void 0:y.type)){const e=a(r.source.pointer);(null==e?void 0:e.parent_table)===l().ev&&(v=null==e?void 0:e.parent_id),g=null==r?void 0:r.source.pointer.id}const o=null==n?void 0:n.getNormalizedSchema();if((0,i().O9)(o)){const{pagesAdded:t,pagePropertiesEdited:n}=e;if(t&&f.push({type:"page"}),"any"===n.type)f.push({condition:"any",type:"property"});else if("none"===n.type)f.push({condition:"none",type:"property"});else{let e=[];"some"===n.type?e=n.some??[]:"all"===n.type&&(e=n.all??[]);const t=[],r=[];e.forEach((e=>{var n;const s=null===(n=o[e.property])||void 0===n?void 0:n.type;(0,i().O9)(s)&&(t.push({type:s,operator:e.filter.operator}),r.push(s))})),f.push({condition:n.type,property_configs:t,property_types:r,type:"property"})}}}else if(t.isButtonType())f.push({type:"button"});else if(t.isRecurrenceType()){var S;f.push({type:"recurrence",frequency:null===(S=t.getTrigger().recurrence)||void 0===S?void 0:S.frequency})}else(0,i().HB)(t);return{automation_actions:p,automation_id:t.id,automation_triggers:f,collection_id:h,collection_view_id:g,collection_view_block_id:v,builder_type:n,source:d}}},922952:(e,t,n)=>{n.d(t,{u:()=>s});var r=()=>n(295633),o=()=>n(302996),i=()=>n(723085);function s(e){return e instanceof i().h||e instanceof o().SpaceStore||e instanceof r().B}},933117:(e,t,n)=>{n.d(t,{A:()=>f});n(944114),n(898992),n(803949),n(581454);var r=n(296540),o=()=>n(245720),i=()=>n(30537),s=()=>n(546926),a=()=>n(890492),l=()=>n(663639),c=()=>n(736847),u=()=>n(69708),d=()=>n(496603),p=()=>n(534177),m=n(474848);const f=function({renderOrigin:e,onClick:t,items:r,getKey:o,renderItem:i,selectedItem:a,onSelect:l,dontCloseParentOnSelect:c,menuTypeOverride:u,menuTitle:d,width:p,minWidth:f,disabled:h,originGap:y,buttonPopupStore:S,sameWidthAsOrigin:b}){const x=(0,n(590526).uB)(S,n(118307).A),I=u??(n(726637).A.isMobile?s().gu.Modal:s().gu.Popup);return(0,m.jsx)(n(250910).A,{popupType:v(I),bottomSheetInitialState:"half",renderOrigin:e,buttonPopupStore:x,placementToOrigin:"bottom",onClick:t,render:e=>(0,m.jsx)(g,{parent:e,items:r,getKey:o,renderItem:i,selectedItem:a,onSelect:l,dontCloseParentOnSelect:c,menuType:I,menuTitle:d,width:p,minWidth:f}),disabled:h,originGap:y,sameWidthAsOrigin:b})};function h(e,t,n,o,i,s,a,l){return{key:0,render:e=>(0,r.createElement)(c().A,{...e,key:t,topBorder:t>0}),items:e.map((e=>({key:o(e),render:t=>i({...t,value:e,key:o(e),selectedItem:s}),action:()=>{!function(e,t,n){t!==e&&n(e)}(e,s,a),l||n.close()}})))}}function g({parent:e,items:t,getKey:n,renderItem:r,selectedItem:i,onSelect:c,dontCloseParentOnSelect:f,menuType:g,menuTitle:v,width:y,minWidth:S}){const b=[];if(function(e){return e.length>0&&e[0]instanceof Array}(t))t.forEach(((t,o)=>{const s=h(t,o,e,n,r,i,c,f);b.push(s)}));else{const o=h(t,0,e,n,r,i,c,f);b.push(o)}const x=(0,m.jsx)(l().A,{type:l().O.Vertical,initialFocus:d().SL(d().Bq(t),(e=>d().n4(e,i))),sections:b});let I;switch(g){case s().gu.ActionSheet:I={menuType:s().gu.ActionSheet};break;case s().gu.Modal:I={menuType:s().gu.Modal,title:v,right:(0,m.jsx)(u().sA,{...o().W.done}),onClickRight:e.close};break;case s().gu.Popup:I={menuType:s().gu.Popup,width:y||160,minWidth:S};break;default:(0,p().HB)(g)}return(0,m.jsx)(a().A,{...I,children:x})}function v(e){switch(e){case s().gu.ActionSheet:return i().n.SlideUp;case s().gu.Modal:return i().n.BottomSheet;case s().gu.Popup:return i().n.Popup}}},935432:(e,t,n)=>{n.d(t,{A:()=>s});var r=()=>n(416845),o=()=>n(357264),i=()=>n(788579);function s(e,t){if((0,r().pA8)(t)){const n=(0,i().$)(t.clientData);if(n)return"messageValues"in t.clientData?e.formatMessage(n,t.clientData.messageValues):e.formatMessage(n)}return e.formatMessage(o().k.generic_error)}},951105:(e,t,n)=>{n.d(t,{k:()=>o});n(296540);const r={viewBox:"0 0 16 16",fittedViewBox:"2.18 1.73 11.64 12.54",svg:(0,n(474848).jsx)("path",{d:"M7.435 1.735c-.875 0-1.585.71-1.585 1.585v.735H3.765c-.875 0-1.585.71-1.585 1.585v7.04c0 .875.71 1.585 1.585 1.585h4.8c.876 0 1.585-.71 1.585-1.585v-.735h2.085c.876 0 1.585-.71 1.585-1.585V5.638c0-.42-.167-.824-.464-1.121l-2.318-2.318a1.6 1.6 0 0 0-1.12-.464zM7.1 3.32c0-.185.15-.335.335-.335H9.58V4.44c0 .848.687 1.535 1.535 1.535h1.455v4.385c0 .185-.15.335-.335.335H10.15V7.958c0-.42-.167-.824-.464-1.121L7.368 4.519a1.6 1.6 0 0 0-.268-.215zm3.63 1.12v-.781l1.166 1.166h-.78a.385.385 0 0 1-.386-.385m-7.3 1.2c0-.185.15-.335.335-.335H5.91V6.76c0 .848.687 1.535 1.535 1.535H8.9v4.385c0 .185-.15.335-.335.335h-4.8a.335.335 0 0 1-.335-.335zm3.63 1.12v-.781l1.166 1.166h-.78a.385.385 0 0 1-.386-.385"})},o=(0,n(340498).wt)("docOnDocSmall",r,"small")},962753:(e,t,n)=>{n.d(t,{EH:()=>y,FO:()=>g,P$:()=>v,VA:()=>f,h0:()=>u,lM:()=>d,mq:()=>h});n(898992),n(581454),n(737550);var r=()=>n(907258),o=()=>n(242422),i=()=>n(763765),s=()=>n(613848),a=()=>n(496603),l=()=>n(534177),c=()=>n(822789);function u(e){const{currentUserRootStore:t}=r().default.state;if(!t)return!1;const n=t.getSpaceViewStores();return(0,a().oE)(null==n?void 0:n.map((e=>e.getSpaceId()))).map((t=>s().A.getData(e,{spaceId:t,userId:e.currentUser.id}))).some((e=>p(e)))}function d(e,t){return p(s().A.getData(e,{spaceId:t,userId:e.currentUser.id}))}function p(e){switch(null==e?void 0:e.membershipType){case void 0:case"none":case"page_guest":return!1;case"restricted_member":case"member":case"membership_admin":case"owner":return!0===e.is_sales_assisted;default:(0,l().HB)(e)}}function m(e,t){if(!t)return"control";if(d(e,t))return"control";const n=o().default.getEligibleGroup({experimentId:"ai_product_retention_simplified_input",defaultGroup:"control"});return"input"===n||"input_and_ask_mode"===n?n:"control"}function f(){switch(o().default.getEligibleGroup({experimentId:"ai_product_retention_agent_follow_ups",defaultGroup:"control"})){case"button_nudge":return["button","nudge"];case"button_control":return["button","default"];case"nudge":return["nudge"];default:return}}function h(e,t){const n=o().default.checkGate({gateName:"agent_deep_find"}),r=void 0!==t&&d(e,t),s=e.currentUser.id,a=!t||!s||i().t.USEWITHCAUTION_isFetchedForSpaceAndUserId({spaceId:t,userId:s}),l=n||!r&&a&&"on"===o().default.getEligibleGroup({experimentId:"ai_product_retention_deepfind",defaultGroup:"control"}),c=v(e,t);return{agentDeepFindEnabled:l,useReadOnlyMode:l&&c}}function g(e,t){if(t?(0,c().vp)(t):(0,c().hw)())return!0;return"control"!==m(e,t)}function v(e,t){return"input_and_ask_mode"===m(e,t)}function y(){return"on"===o().default.getEligibleGroup({experimentId:"ai_product_retention_agent_speculative_search",defaultGroup:"control"})}},977870:(e,t,n)=>{n.d(t,{c:()=>o});class r extends(()=>n(757695))().Store{getInitialState(){return{wasGetVisibleUsersCalled:{}}}}const o=new r;n(852832).exposeDebugValue("GetVisibleUsersStore",o)}}]);