"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[50525],{75544:(e,t,o)=>{o.d(t,{A:()=>S});o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(354520),o(672577);var r=o(296540),n=()=>o(908006),l=()=>o(951500),s=()=>o(590526),i=()=>o(62371),a=()=>o(41174),c=()=>o(336811),u=()=>o(496603),d=()=>o(183558);function p(e){const{reducerId:t,instanceId:o,reducer:r,collectionContextStore:n,groupsPointer:l}=e,s=n.reducersStore.state,a=s[t];let c,d;if(l&&l.length>0&&(c=(0,i().Hm)(l)),r){if(d={instanceIds:u().sb([...(null==a?void 0:a.instanceIds)||[],o]),reducer:r},c){n.reducerDependencies.has(c)||n.reducerDependencies.set(c,new Set);const e=n.reducerDependencies.get(c);null==e||e.add(t)}}else{if(c){const e=n.reducerDependencies.get(c);e&&(e.delete(t),0===e.size&&n.reducerDependencies.delete(c))}const e=u().FF((null==a?void 0:a.instanceIds)||[],o);d=a&&e.length>0?{instanceIds:e,reducer:a.reducer}:void 0}u().n4(a,d)||n.reducersStore.setState({...s,[t]:d})}var g=()=>o(418211);function S(e){const{id:t,reducer:o,collectionContextStore:S,groupsPointer:m,debounceWait:f,isDerivedReducer:y,resultLookupFn:v}=e,R=(0,l().l)(m),C=(0,l().l)(o),h=(0,s().K8)((()=>S.collectionViewStore()),[S]),b=(0,s().K8)((()=>S.normalizedFormatStore.state.collection_pointer),[S.normalizedFormatStore]),w=(0,s().K8)((()=>{var e;return null==h||null===(e=h.getFormatStore())||void 0===e?void 0:e.getKeyStore("collection_view_source").getValue()}),[h]),P=(0,r.useRef)(!1),_=(0,c().O)(),[V,x]=(0,r.useReducer)(((e,t)=>u().n4(e,t)?e:t),void 0),k=(0,r.useCallback)((()=>{const e=S.localResultStore.state,o=S.remoteResultStore.state,r=e&&"reducer"===e.type?(null==v?void 0:v(e.reducerResults,R))??e.reducerResults[t]:void 0,n=o&&"reducer"===o.type?(null==v?void 0:v(o.reducerResults,R))??o.reducerResults[t]:void 0;return function(e){const{reducerId:t,localReducerResult:o,remoteReducerResult:r,collectionContextStore:n,reducer:l}=e,s=n.reducersStore.state,c=n.remoteResultStore.state,d=n.isClientModeEnabledStore.state;if(d)return o;const p=n.isCreatingNewChartCollectionStore.state,S=n.wasCreatedThisSessionStore.state;if("aggregation"===l.type){if(p&&S){return Boolean(r&&"aggregation"===r.type&&"number"===r.aggregationResult.type&&0!==r.aggregationResult.value)&&n.isCreatingNewChartCollectionStore.setState(!1),o}if(r)return r;const e=Boolean(c&&"reducer"===c.type&&Object.entries(c.reducerResults).find((([e,t])=>{const o=s[e];return!!o&&Boolean("results"===o.reducer.type&&!o.reducer.searchQuery&&"results"===t.type&&!t.hasMore&&u().n4(l.filter,o.reducer.filter))})));return e?o:r}if("groups"===l.type){if(p&&S){return Boolean(r&&"groups"===r.type&&r.hasMore)&&n.isCreatingNewChartCollectionStore.setState(!1),o}if(o&&"groups"!==o.type)return;if(r&&"groups"!==r.type)return;const e=function(e){var t,o;const{reducerId:r,reducer:n,collectionContextStore:l,wasCreatedThisSession:s,localReducerResult:c,remoteReducerResult:u}=e;if(!n.blockResults&&!r.includes(i().RO))return u;let d;n.aggregation&&(u?d=u.aggregationResults:c&&(d=c.aggregationResults));const p=null===(t=l.collectionViewStore())||void 0===t?void 0:t.getCollectionSource(),g=(0,a().TR)(p)||(0,a().hJ)(p),S=Boolean(u&&u.blockResults),m=(S||s)&&!g;let f;if(n.blockResults){if(m&&c&&c.blockResults){const e=c.blockResults,t=(null==u?void 0:u.blockResults)??{},o=new Set([...Object.keys(e),...Object.keys(t)]),r={};for(const n of o){const o=e[n],l=t[n];let s=[];o?s=o.blockIds:l&&(s=l.blockIds);let i=!1;l?i=l.hasMore:o&&(i=o.hasMore),r[n]={blockIds:s,hasMore:i}}f=r}f||(f=l.forceLocalQueryCollection||g?null==u?void 0:u.blockResults:null==c?void 0:c.blockResults)}let y;c&&c.pinnedResults&&(y=c.pinnedResults);u&&u.pinnedResults&&(y={groupResults:u.pinnedResults.groupResults,...y,aggregationResults:u.pinnedResults.aggregationResults});const v=u?u.hasMore:Boolean(null==c?void 0:c.hasMore),R=u?u.hasMoreSubGroups:null==c?void 0:c.hasMoreSubGroups;let C=g?(null==u?void 0:u.results)??[]:(null==c?void 0:c.results)??(null==u?void 0:u.results)??[],h=g?(null==u?void 0:u.subGroupResults)??[]:(null==c?void 0:c.subGroupResults)??(null==u?void 0:u.subGroupResults);const b=n.groupBy;u&&("relation"===b.type||"formula"===b.type&&"relation"===b.groupBy.type)&&(C=u.results);const w=null===(o=n.subGroup)||void 0===o?void 0:o.groupBy;u&&("relation"===(null==w?void 0:w.type)||"formula"===(null==w?void 0:w.type)&&"relation"===w.groupBy.type)&&(h=u.subGroupResults);l.forceLocalQueryCollection&&(C=(null==u?void 0:u.results)??(null==c?void 0:c.results)??[],h=(null==u?void 0:u.subGroupResults)??(null==c?void 0:c.subGroupResults));return{type:"groups",version:"v2",results:C,subGroupResults:h,pinnedResults:y,hasMore:v,hasMoreSubGroups:R,blockResults:f,aggregationResults:d}}({reducerId:t,collectionContextStore:n,reducer:l,wasCreatedThisSession:S,localReducerResult:o,remoteReducerResult:r});return e}if("results"===l.type){var m;const e=n.wasCreatedThisSessionStore.state,l=Boolean(c&&"reducer"===c.type&&c.reducerResults[t]),s=null===(m=n.collectionViewStore())||void 0===m?void 0:m.getCollectionSource(),i=(0,g().c)({collectionContextStore:n}),u=(0,a().TR)(s)||(0,a().hJ)(s);if((l||e)&&(!u||i)&&o&&"results"===o.type){return{...o,hasMore:r&&"results"===r.type?r.hasMore:o.hasMore}}return r}}({reducerId:t,collectionContextStore:S,reducer:C,localReducerResult:r,remoteReducerResult:n})}),[S,R,C,t,v]),M=(0,r.useCallback)((()=>{P.current=!1,_.current||x(k())}),[k,_]),I=(0,r.useCallback)((()=>{P.current||(P.current=!0,n().default.afterNextFlush(M))}),[M]),[D]=(0,r.useState)((()=>(0,d().Ay)()));return(0,r.useEffect)((()=>{const e=f?(0,u().sg)(I,f,{leading:!0}):I;return S.remoteResultStore.addListener(I),S.localResultStore.addListener(e),()=>{S.remoteResultStore.removeListener(I),S.localResultStore.removeListener(e)}}),[S,I,f]),(0,r.useEffect)((()=>{if(!y)return p({reducerId:t,instanceId:D,reducer:C,collectionContextStore:S,groupsPointer:R}),()=>{p({reducerId:t,instanceId:D,reducer:void 0,collectionContextStore:S,groupsPointer:R})}}),[S,h,b,w,R,C,t,D,y]),(0,r.useEffect)((()=>{I()}),[]),(0,r.useEffect)((()=>(S.timingTracker.mountCollectionReducerRequest(t,C.type),()=>{S.timingTracker.unmountCollectionReducerRequest(t)})),[S,t,C]),V}},101981:(e,t,o)=>{o.d(t,{A:()=>i});var r=o(296540),n=()=>o(590526),l=o(474848);function s(e){const{resultStore:t,render:s,...i}=e,a=(0,o(75544).A)(i),c=(0,n().uB)(t,o(757695).Store.createClass(void 0)),u=(0,n().K8)((()=>e.collectionContextStore.collectionViewStore()),[e.collectionContextStore]);(0,r.useEffect)((()=>{c.setState(a);const t=e.reducer;"groups"===t.type&&"groups"===(null==a?void 0:a.type)&&e.collectionContextStore.groupsStore.setGroupBlockResults(t,a)}),[e.collectionContextStore.groupsStore,e.reducer,a,c,u]);const d=(0,n().K8)((()=>s?s(c):null),[s,c]);return(0,l.jsx)(l.Fragment,{children:d})}const i=r.memo(s)},267639:(e,t,o)=>{o.d(t,{T:()=>n});o(944114),o(898992),o(908872);var r=()=>o(94750);function n(e){const{environment:t,collectionStore:o,duplicate:n,droppedStores:l,transaction:s,duplicateActions:i}=e,{movedStores:a,reparentedStores:c}=l.reduce(((e,t)=>(n||t.getAssociatedCollectionId()!==(null==o?void 0:o.id)?e.reparentedStores.push(t):e.movedStores.push(t),e)),{movedStores:[],reparentedStores:[]});return[...a,...(0,r().M)({environment:t,droppedStores:c,duplicate:n,transaction:s,resolveTemplateVariables:!1,duplicateActions:i})]}},274652:(e,t,o)=>{o.d(t,{o:()=>s});var r=o(296540),n=()=>o(100622),l=o(474848);const s=r.forwardRef((function({color:e="primary",...t},r){const s=(0,o(401497).IS)((()=>{const o="blue"===e?n().oZ.blue:"secondary"===e?n().Tj.text.secondary:n().Tj.text.primary;return{title:{color:o,fill:o},icon:{fill:"blue"===e?n().oZ.blue:void 0},buttonMenuItem:{...t.style,...t.disabled?{cursor:"not-allowed"}:{}}}}),[t.disabled,e,t.style]),i="blue"!==e?e:void 0;return(0,l.jsx)(o(81068).A,{ref:r,...t,title:(0,l.jsx)("div",{style:s.title,children:t.title}),icon:(0,l.jsx)(o(807449).I,{icon:o(617668).plusIcon,style:s.icon,colorVariant:i}),style:s.buttonMenuItem})}))},430923:(e,t,o)=>{o.d(t,{DV:()=>a,W5:()=>s,l7:()=>i,zS:()=>l});var r=()=>o(79926);const n={CollectionNewViewPopupComponent:new(r().O2)("CollectionNewViewPopupComponent",(async()=>await Promise.all([o.e(35530),o.e(9773),o.e(36556),o.e(55373),o.e(36192),o.e(40537),o.e(96346),o.e(27992),o.e(63452),o.e(66249),o.e(92845),o.e(87249),o.e(79022),o.e(44854),o.e(87017),o.e(34877),o.e(46414),o.e(11676),o.e(61165),o.e(47668),o.e(94522),o.e(44584),o.e(24587),o.e(67494),o.e(3651),o.e(40992),o.e(88455),o.e(33893),o.e(36437),o.e(17729),o.e(49875)]).then(o.bind(o,611225)))),CollectionViewSelect:new(r().O2)("CollectionViewSelect",(async()=>await o.e(35756).then(o.bind(o,445689)))),CollectionLinkExistingModal:new(r().O2)("CollectionLinkExistingModal",(async()=>await Promise.all([o.e(35530),o.e(9773),o.e(36556),o.e(55373),o.e(36192),o.e(40537),o.e(62475),o.e(3151),o.e(98629),o.e(96711),o.e(27992),o.e(63452),o.e(66249),o.e(87249),o.e(79022),o.e(34877),o.e(11676),o.e(94522),o.e(38293),o.e(64556),o.e(55162),o.e(32370),o.e(26264),o.e(68637),o.e(74562),o.e(39986),o.e(47160),o.e(76677),o.e(68609),o.e(67720),o.e(42056),o.e(3261),o.e(82641),o.e(68643),o.e(27083),o.e(96385),o.e(5287)]).then(o.bind(o,901226)))),ModalOverlayCollectionView:new(r().O2)("ModalOverlayCollectionView",(async()=>await Promise.all([o.e(93980),o.e(22778),o.e(32413)]).then(o.bind(o,700868))))},l=(0,r()._h)(n.CollectionNewViewPopupComponent,(e=>e.CollectionNewViewPopupComponent)),s=(0,r()._h)(n.CollectionViewSelect,(e=>e.CollectionViewSelect)),i=(0,r()._h)(n.CollectionLinkExistingModal,(e=>e.CollectionLinkExistingModal)),a=(0,r()._h)(n.ModalOverlayCollectionView,(e=>e.ModalOverlayCollectionView))},465364:(e,t,o)=>{o.d(t,{$N:()=>I,D5:()=>D,GB:()=>x,M9:()=>_,Pt:()=>M,eW:()=>k,jo:()=>O,v7:()=>V});o(944114),o(898992),o(803949),o(581454);var r=()=>o(906745),n=()=>o(242422),l=()=>o(587682),s=()=>o(295633),i=()=>o(187696),a=()=>o(713998),c=()=>o(597777),u=()=>o(604995),d=()=>o(416504),p=()=>o(519831),g=()=>o(496603),S=()=>o(534177),m=()=>o(299709),f=()=>o(44729),y=()=>o(384944),v=()=>o(622811),R=()=>o(267639),C=()=>o(210552),h=()=>o(999140),b=()=>o(836724),w=()=>o(295304),P=()=>o(747671);function _(e){var t;const{environment:o,droppedStores:n,duplicate:l,calendarBy:s,transaction:a,collectionContextStore:g,duplicateActions:S}=e,y=r().DateTime.fromMillis(e.startOfDay);let C=!0;if(null!==(t=g.collectionStore())&&void 0!==t&&t.isExternalSyncedCollection())return;for(const r of n){const t=e.collectionStore?e.collectionStore:(0,h().Dj)({store:r,collectionContextStore:g});if(r.getParentTable()===p().Vl||!t){C=!1;break}f().X$({childStore:r,parentStore:t,transaction:a})||(C=!1)}const b=(0,R().T)({environment:o,droppedStores:n,duplicate:l,transaction:a,collectionStore:e.collectionStore,duplicateActions:S});for(const r of b){const t=e.collectionStore?e.collectionStore:(0,h().Dj)({store:r,collectionContextStore:g});if(!t)continue;const n=t.getMappedProperty(s),l=r.getPropertyStore(n),p=(0,i().b)(l.getValue())||u().Ec((0,d().P)()),S=u().kW(p,(0,d().P)()),f=y.toFormat(u().tr);let R;if("date"===S.type||"datetime"===S.type)R={...S,start_date:f};else{const e=u().AA(S,(0,d().P)());if(!e.end)return;const t={...S,start_date:f},o=u().AA(t,(0,d().P)()).start.diff(e.start,"days"),r=e.end.plus(o).toFormat(u().tr);R={...S,start_date:f,end_date:r}}const b=u().kW(R,c().$K(p)||(0,d().P)());(0,v().j)({environment:o,store:r,collectionStore:t,collectionContextStore:g,shouldCoerce:!0,groupsPointer:[],transaction:a,alreadyMovedToCollection:C}),D({environment:o,type:"dateValue",propertyId:n,store:r,transaction:a,dateValue:b}),(0,m().E)({environment:o,collectionContextStore:g,block_id:r.id,property:n,property_type:"date",from:"calendar"})}}function V(e){const{calendarStore:t,direction:o,targetStore:r}=e;t.setState({...t.state,isDragging:!0,targetStore:r,direction:o,temporaryValue:void 0})}function x(e){const{calendarStore:t,x:o,y:n,calendarBy:s}=e,a=t.state;if(a.isDragging){const e=(0,i().b)(a.targetStore.getPropertyStore(s).getValue());if(!e)return;const p=u().kW(e,(0,d().P)()),S=a.temporaryValue||e,m=u().kW(S,(0,d().P)()),f=[];a.dayStoreMap.forEach(((e,t)=>{f.push({store:e,timestamp:t})}));const y=f.find((({store:e})=>{const t=b().T.getRectFromStore(e);return Boolean(t&&l().ux(t,o,n))}));let v;if(y){const e=r().DateTime.fromMillis(y.timestamp),t=e.endOf("day"),o=e.toFormat(u().tr);if(p){const n=u().AA(p,(0,d().P)());if(a.direction===P().Q.Left)if(r().IX.fromDateTimes(e,t).contains(n.start))v=p;else{let e;e="datetimerange"===p.type||"daterange"===p.type?{...p,start_date:o,end_date:p.end_date}:"datetime"===p.type?{type:"datetimerange",start_date:o,start_time:p.start_time,end_date:p.start_date,end_time:p.start_time,time_zone:p.time_zone,reminder:p.reminder}:{type:"daterange",start_date:o,end_date:p.start_date,reminder:p.reminder};const t=u().AA(e,(0,d().P)());v=!n.end&&t.start>n.start||n.end&&t.start>n.end?m:e}else if(n.end?r().IX.fromDateTimes(e,t).contains(n.end):r().IX.fromDateTimes(e,t).contains(n.start))v=p;else{let e;e="date"===p.type?{...p,type:"daterange",end_date:o}:"datetime"===p.type?{...p,type:"datetimerange",end_date:o,end_time:"00:00"}:{...p,end_date:o};const t=u().AA(e,(0,d().P)());v=t.end&&t.end<t.start?m:e}}}if(v&&!g().n4(m,v)){const e=u().kW(v,c().$K(S)||(0,d().P)());t.setState({...a,temporaryValue:e})}}}function k(e){const{environment:t,calendarStore:o,calendarBy:r,transaction:n}=e,l=o.state;l.isDragging&&l.temporaryValue&&(D({type:"dateValue",environment:t,dateValue:l.temporaryValue,propertyId:r,store:l.targetStore,transaction:n}),o.setState({...o.state,isDragging:!1}))}function M(e){const{calendarStore:t}=e,o=t.state;o.isDragging&&t.setState({...o,isDragging:!1})}function I(e){const{environment:t,store:o,collectionStore:n,collectionContextStore:l,startDayOfWeek:s,transaction:i}=e,c=l.dateRangeStartStore.state,p=(0,d().P)(),g=l.normalizedQueryStore.state;if(!g||!g.calendar_by)return;const S=(null==n?void 0:n.getMappedProperty(g.calendar_by))??g.calendar_by,m=u().hp(c,s,p),f=m.startOf("month"),R=m.endOf("month"),C=r().DateTime.now().startOf("day");let h;return h=r().IX.fromDateTimes(f,R).contains(C)?u().p6(C.valueOf(),p):u().p6(u().iB(c,s,p).valueOf(),p),y().zv({store:o.getPropertiesStore(),data:{[S]:a().m5(h)},transaction:i}),(0,v().j)({environment:t,store:o,collectionStore:n,collectionContextStore:l,shouldCoerce:!0,groupsPointer:[],transaction:i}),o}function D(e){const{environment:t,store:o,propertyId:r,transaction:l}=e;let s;"timestamp"===e.type?s=u().p6(e.timestampMs.valueOf(),(0,d().P)()):"dateValue"===e.type?s=e.dateValue:(0,S().HB)(e);const i=o.getPropertyValue(r);if(s&&function(e){const{propertyId:t,oldDateValue:o,newPersistedDate:r,store:l}=e;if(o||!r||void 0!==r.reminder)return!1;if(!n().default.checkGate({gateName:"adoption_reminder_collection_default"}))return!1;const s=T(t,l);if(void 0===s)return!1;return!0}({propertyId:r,oldDateValue:i,newPersistedDate:s,store:o})){const e=T(r,o);void 0!==e&&(s={...s,reminder:e})}const c=a().m5(s);y().zv({store:o.getPropertiesStore(),data:{[r]:c},transaction:l}),C().O4({environment:t,store:o,dateProperty:{id:r,oldValue:i,newValue:c}})}function T(e,t){const o=t.getAssociatedCollectionStore();if(!o)return;const r=o.getSchema();if(!r)return;const n=r[e];return n&&"date"===n.type?n.default_reminder:void 0}function O(e){const{environment:t,collectionStore:o,calendarBy:r,store:n,insertStores:l,collectionContextStore:i,transaction:a}=e,c=n.getPropertyStore(r).getValue();for(const s of l)(0,v().j)({environment:t,store:s,collectionStore:o,collectionContextStore:i,shouldCoerce:!0,groupsPointer:[],transaction:a}),w().R9({environment:t,store:s.getPropertyStore(r),value:c,transaction:a});return l.map((e=>s().B.createChildStore(o,e.pointer)))}},747671:(e,t,o)=>{o.d(t,{Q:()=>r,a:()=>n});let r=function(e){return e[e.Left=0]="Left",e[e.Right=1]="Right",e}({});class n extends(()=>o(757695))().Store{getInitialState(){return{dayStoreMap:new Map,isDragging:!1,startingMonth:0}}}}}]);